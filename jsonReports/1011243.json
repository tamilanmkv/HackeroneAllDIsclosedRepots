{"id":1011243,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDExMjQz","url":"https://hackerone.com/reports/1011243","title":"HTTP Parameter Pollution with semicolons in iframe allows loading external Greenhouse forms","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-10-18T23:28:22.269Z","submitted_at":"2020-10-18T23:28:22.280Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackb898","url":"/jackb898","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35929,"url":"https://hackerone.com/status_im","handle":"status_im","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/929/e47e05ef1c915e815a0ce337ecde09c4457b2104_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/929/e47e05ef1c915e815a0ce337ecde09c4457b2104_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Status.im","twitter_handle":"ethstatus","website":"https://status.im","about":"Status is an open source mobile DApp browser and secure messenger built for Ethereum.  "}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-08T20:24:04.812Z","bug_reporter_agreed_on_going_public_at":"2021-02-06T20:24:04.548Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nStatus.im uses Greenhouse for job applications, specifically the older Greenhouse integration which relies on iframes. The gh_jid URL parameter is used to load the correct form in the iframe. HTML characters are escaped, but using semicolons you can inject URL parameters into the iframe via the gh_jid parameter to load any job form on the page.\n\nHere's an example job page: https://status.im/our_team/open_positions.html?gh_jid=2385338\nAnd the iframe that loads within it: https://boards.greenhouse.io/embed/job_app?for=status72\u0026token=2385338\u0026b=https%3A%2F%2Fstatus.im%2Four_team%2Fopen_positions.html\nYou cannot just add a \"for\" parameter to the job page URL because it will not pollute into the iframe, however by using a semicolon you can pollute it since it is passed with the gh_jid parameter.\n\nHere's an example of polluting it: ```https://status.im/our_team/open_positions.html?gh_jid=2223984;for=remitly``` (I put it in a code block so the semicolon is not URL encoded; for impact purposes, note that on most messaging platforms it's not encoded)\nAnd the iframe that loads: https://boards.greenhouse.io/embed/job_app?for=status72\u0026token=2223984;for=remitly\u0026b=https%3A%2F%2Fstatus.im%2Four_team%2Fopen_positions.html is clearly a job form from a different company.\n\n## Steps To Reproduce:\n\n1. Take a valid job page URL, ex. https://status.im/our_team/open_positions.html?gh_jid=2385338\n2. Get a different Greenhouse form gh_jid and corresponding company \"for\" value and put them in the URL with  a semicolon like so: ```https://status.im/our_team/open_positions.html?gh_jid=2223984;for=remitly```\n\n\n## Supporting Material/References:\n#367589 is a similar report by me in which an iframe can be polluted, leading to content injection.\n\nA crucial part that a lot of companies misconceive about this is that it's a Greenhouse problem. It is actually a problem with your implementation of Greenhouse. This issue was brought to Greenhouse's attention already and they have made a new implementation that opens jobs in a separate tab rather than an iframe. This mitigates the issue entirely.\n\nThis is what the page looks like with an external job form loaded:\n{F1041291}\n\n## Suggested Mitigation\n\n  1. Hot Fix: Remove open positions page? Not sure if there's really a quicker fix than either options below. You could also just make it redirect to the status.im job listings on Greenhouse.com.\n  2. Medium Term: Filter out semicolons from URLs, e.g. redirect home when a semicolon is present in the URL. This would prevent pollution of external job forms.\n  3.  Long Term: Implement Greenhouse's new integration that doesn't use iframes. This updated version can be seen on many sites now such as [Github](https://github.com/about/careers).\n\nIf you provide a detailed and working mitigation in the Suggested Mitigation section, your submission might become eligible for a bonus.\n\n## Impact\n\nAn attacker could sign up for Greenhouse as a 1-person company, create a phishing job form that looks like the user has been logged out and asks them to log back in or any other method to steal user data. Other forms fit seamlessly into the page so no stylistic error would expose this as a phishing form. This essentially can be leveraged in the same way as stored XSS with the attacker being able to provide a link to their own content on Status.im.","bounty_amount":"100.0","formatted_bounty":"$100","original_report_id":null,"original_report_url":null,"attachments":[{"id":1041291,"file_name":"b53e126dfae85bd210ec8494f59b0ad7.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oMyJB9497X9CYNc6nn3jftPQ?response-content-disposition=attachment%3B%20filename%3D%22b53e126dfae85bd210ec8494f59b0ad7.png%22%3B%20filename%2A%3DUTF-8%27%27b53e126dfae85bd210ec8494f59b0ad7.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131639Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8646f42efb58a0d38e0bcc23cbc4d65ec9dd89fdaa9aaff17a4e3c8d96b37cae","file_size":38385,"type":"image/png"}],"allow_singular_disclosure_at":"2021-03-08T20:24:04.637Z","allow_singular_disclosure_after":-18723154.67782635,"singular_disclosure_allowed":true,"vote_count":10,"voters":["th4nu_0x0","nikitastupin","ali","dmc3","salahhasoneh","jackb898","ning1022","cryptographer","d3dezio","pandey_alex"],"structured_scope":{"databaseId":20475,"asset_type":"URL","asset_identifier":"https://status.im/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9564603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jackb898,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@princeofpersia","automated_response":false,"created_at":"2020-10-19T14:23:11.816Z","updated_at":"2020-10-19T14:23:11.816Z","actor":{"username":"princeofpersia","cleared":false,"url":"/princeofpersia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/663/153/2664a34113403db9945207030f723e4f93a511b0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9564632,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @jackb898,\n\nCan you explain more what is the impact of the behavior you described, are you able to some how perform content injection this time, if so can you provide a POC that shows content injection?\n\nRegards,\n@princeofpersia","automated_response":false,"created_at":"2020-10-19T14:24:44.485Z","updated_at":"2020-10-19T14:24:44.485Z","actor":{"username":"princeofpersia","cleared":false,"url":"/princeofpersia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/663/153/2664a34113403db9945207030f723e4f93a511b0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9565551,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The impact of the behavior I described is that an attacker could register as a 1-person company on Greenhouse, create a job form that is actually a phishing form, and inject it in a status.im page using this parameter pollution.\n\nI do not personally have a Greenhouse account for this because that would be against their terms of service to use it for this purpose obviously, but I provided a proof of concept in the report of content injection. If you visit the link in the code block, you will see a job form from a different company that is injected into the status.im page.\n\nThank you.","automated_response":false,"created_at":"2020-10-19T15:43:52.746Z","updated_at":"2020-10-19T15:43:52.746Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9636288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @jackb898,\n\nI will check with the team to see if this is something they're interested in, according to the policy only the following in scope for https://status.im/\n\n\u003eavailability of site\nintegrity of download links for Status mobile apps\n\nRegards,\n@princeofpersia","automated_response":false,"created_at":"2020-10-26T13:51:17.295Z","updated_at":"2020-10-26T13:51:17.295Z","actor":{"username":"princeofpersia","cleared":false,"url":"/princeofpersia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/663/153/2664a34113403db9945207030f723e4f93a511b0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9637037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I missed that. Thank you for checking with the team nonetheless, I know sometimes theyâ€™d expand the scope for particularly pertinent issues.\n\nIf the team chooses not to accept this, please allow me to self-close. Thanks.","automated_response":false,"created_at":"2020-10-26T14:36:06.550Z","updated_at":"2020-10-26T14:36:06.550Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9651759,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @jackb898, \nas mentioned by princeofpersia, our website is not directly in scope of the program. Due to the quality of your report we award you with a 100$ bounty. Thanks for taking part in our bug bounty program and good luck on future bug hunts. \nRegards,\nStatus Security","automated_response":false,"created_at":"2020-10-27T18:52:56.440Z","updated_at":"2020-10-27T18:52:56.440Z","actor":{"url":"/status_im","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/929/e47e05ef1c915e815a0ce337ecde09c4457b2104_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Status.im"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"status_im","collaborator":{"username":"jackb898","url":"/jackb898"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9653972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty. Does this mean I should self-close?","automated_response":false,"created_at":"2020-10-27T22:49:14.859Z","updated_at":"2020-10-27T22:49:14.859Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9661281,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jackb898,\nwe've deployed a fix https://github.com/status-im/status.im/pull/590\nto https://dev.status.im/our_team/open_positions.html, can you quickly verify that the issue is mitigated by that? \n\nRegards,\n@0k0k","automated_response":false,"created_at":"2020-10-28T15:26:31.851Z","updated_at":"2020-10-28T15:26:31.851Z","actor":{"username":"0k0k","cleared":false,"url":"/0k0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/T2sceK3LZcRPPhG3jKFF8XCP/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9662359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@0k0k I see no reason that that fix wouldn't work when set up properly. I assume it's known that that dev version does not work currently, e.g. going to https://dev.status.im/our_team/open_positions.html?gh_jid=2385338 doesn't load the specific job page and just keeps the list of all of the jobs. As long as those links to jobs on that dev page redirect within the iframe when it's deployed that fix should work.","automated_response":false,"created_at":"2020-10-28T16:59:04.561Z","updated_at":"2020-10-28T16:59:04.561Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9715681,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jackb898,\nthx again for your report, we would appreciate if you would evaluate our fix deployed at status.im, The issue is relatively serious, so please also report it to Greenhouse, as they are maintaining a vulnerable component. \n\nRegards,\n@0k0k","automated_response":false,"created_at":"2020-11-03T16:20:21.854Z","updated_at":"2020-11-03T16:20:21.854Z","actor":{"username":"0k0k","cleared":false,"url":"/0k0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/T2sceK3LZcRPPhG3jKFF8XCP/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jackb898","url":"/jackb898"},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10599690,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello, may this be disclosed for informative purposes? Greenhouse has released a patch for this on all integrations.","automated_response":false,"created_at":"2021-02-06T20:24:04.564Z","updated_at":"2021-02-06T20:24:04.564Z","first_to_agree":true,"actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10922855,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-08T20:24:04.850Z","updated_at":"2021-03-08T20:24:04.850Z","actor":{"url":"/status_im","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/929/e47e05ef1c915e815a0ce337ecde09c4457b2104_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Status.im"}},"genius_execution_id":null,"team_handle":"status_im","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}