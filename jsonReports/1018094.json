{"id":1018094,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE4MDk0","url":"https://hackerone.com/reports/1018094","title":"Staff Member can Get POS Access Without User Interaction","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-10-25T00:54:23.928Z","submitted_at":"2020-10-25T00:54:24.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngalog","url":"/ngalog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-19T22:08:27.893Z","bug_reporter_agreed_on_going_public_at":"2020-11-19T22:08:27.798Z","team_member_agreed_on_going_public_at":"2020-11-19T19:11:43.124Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found that it is possible for a staff member to grant themselves POS access without user interaction from admin.\n\n## Steps to reproduce\n- Login as a staff member with `Manage Locations` permission only, in a shop that has POS channel up and running (Could be Lite)\n- Make sure your staff member account didn't have POS enabled \n- Make this GraphQL call\n\n```json\n{\"query\":\"mutation {retailUserDataUpdate(id:\\\"gid://shopify/StaffMember/63779504283\\\",retailUserData:{posAccess:true,pin:\\\"1423\\\"}){staffMember{name canAccessPrivateApps authenticationSettings{tfaEnabled}}userErrors{message}}}\"}\n```\n\nReplace `63779504283` with your personal staff member id, you can find it in `https://your-store.myshopify.com/admin/settings/account/` and click your account name, then you staff member id is in the url.\n\n- Now your staff member account has POS enabled, and pin is set.\n\n## Impact\n\nIt will allow to a staff member to POS takeover without user interaction.","bounty_amount":"1100.0","formatted_bounty":"$1,100","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":16,"voters":["xploiterr","drsniper","mashoud1122","th4nu_0x0","mirhat","bibekshah","capdegarde_","powerjacobb1","yinvi777","joe_glueck","and 6 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9648290,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @ngalog!\nThank you for your report! We have reproduced this and our engineering team is investigating.","automated_response":false,"created_at":"2020-10-27T13:34:28.072Z","updated_at":"2020-10-27T13:34:28.072Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685733,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @ngalog, thanks again for the report.\n\nOur engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\n\nThanks for helping make Shopify more secure. We hope you'll continue to do so.\n\nHappy Hacking!","automated_response":false,"created_at":"2020-10-30T17:01:16.367Z","updated_at":"2020-10-30T17:01:16.367Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ngalog","url":"/ngalog"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey again @ngalog.\n\nI just wanted to quickly also let you know we'll be following up on a bounty amount soon.\n\nCheers.","automated_response":false,"created_at":"2020-10-30T17:03:05.732Z","updated_at":"2020-10-30T17:03:05.732Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9685953,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ngalog,\n\nThanks again for your report! During our investigation, we determined that the implications of having POS access are limited to physical access to a device that is already logged in as a full-permissions user. However, our plan is to eventually remove this barrier. For this reason, weâ€™re awarding a $600 bounty for the current impact of this behaviour, with a $500 bonus to account for potential future impact. Please find below our rationale generated using our [CVSS calculator](https://shopify.github.io/appsec/cvss_calculator/).\n\n## Base Score CVSS:3.0/AV:P/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N 3.2\n## Environment: Core\n\n#### Attack Complexity: L\n* Specific conditions to exploit?: Yes\n* Extensive effort to exploit?: No\n\n#### Privileges Required: L\n* Requires privileged account (not self-registered)?: Yes\n* Does the attacker need extensive permissions?: No\n\n#### User Interaction: N\n* Requires victim to perform some action during exploit?: No\n\n#### Scope: U\n* Can the attacker impact a separate service?: No\n\n#### Confidentiality: L\n* How much data could be accessed?: Some\n* How much of Shopify is impacted?: Some\n\n#### Integrity: L\n* How much data could be changed?: Some\n* How much of Shopify is impacted?: Some\n\n#### Availability: N\n* Level of disruption to network service?: None","automated_response":false,"created_at":"2020-10-30T17:20:13.009Z","updated_at":"2020-10-30T17:20:13.009Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"600.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ngalog","url":"/ngalog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9698672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds great! Thanks!","automated_response":false,"created_at":"2020-11-02T04:52:21.970Z","updated_at":"2020-11-02T04:52:21.970Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9871533,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-19T19:11:43.140Z","updated_at":"2020-11-19T19:11:43.140Z","first_to_agree":true,"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9872981,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-19T22:08:27.832Z","updated_at":"2020-11-19T22:08:27.832Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9872982,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-19T22:08:27.925Z","updated_at":"2020-11-19T22:08:27.925Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}