{"id":1024668,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI0NjY4","url":"https://hackerone.com/reports/1024668","title":"Brave Browser potentially logs the last time a Tor window was used","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-11-02T17:48:48.745Z","submitted_at":"2020-11-02T17:48:49.018Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sickcodes","url":"/sickcodes","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8276"],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-04T18:36:48.681Z","bug_reporter_agreed_on_going_public_at":"2020-11-04T18:36:48.602Z","team_member_agreed_on_going_public_at":"2020-11-04T18:34:19.618Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nA vulnerability in the Brave Browser allows an attacker to view the last time a Tor session was used in incognito mode. A local, on-disk attacker could read the Brave Browser's \"Local State\" json file and identify the last time a Tor session was used, affecting the confidentiality of a user's Tor session.\n\nFor example, the \"Local State\" file of a user who has recently used a Tor session would list a key value pair with a timestamp as accurate as \"13248493693576042\". This allows an attacker to fingerprint, or prove beyond reasonable doubt, that a user was using Tor at that very specific moment in time.\n\n## Products affected: \n\nBrave 1.18.27 and below\n\n## Steps To Reproduce:\n\n Start a Tor session in Brave Browser\n\n## Supporting Material/References:\n\nAs discussed with security@ team in email chain titled:\n\nRe: [Security] CVE Request 981386 - Brave Browser (All) - Exposure of\n Sensitive Information to an Unauthorized Actor While Using Tor Feature\n\nAnd fixed in PR 7010:\nhttps://github.com/brave/brave-core/pull/7010\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nViolate the confidentiality of a user's Tor session.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["pat_ventuzelo","sickcodes","ali","nilu93","h1-qualys-scan","planetx0rt"],"severity":{"rating":"low","score":3.5,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":7934,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/brave-core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9705677,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-11-02T18:17:36.379Z","updated_at":"2020-11-02T18:17:36.379Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9705683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"my response from the email thread:\n\nI think this is a sec-low issue given that someone who has access to the local disk cannot tell if the timestamp corresponds to a Tor session (rather than a regular incognito session). Also, the value that actually gets sent to the Brave metrics server is bucketed into the following values (so the timestamp isn't a fingerprinting vector):\n\n```\nUsed in last 24h\nUsed in last week but not 24h\nUsed in last 28 days but not week\nEver used but not in last 28 days\nNever used\n```","automated_response":false,"created_at":"2020-11-02T18:18:36.509Z","updated_at":"2020-11-02T18:18:48.145Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9705687,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-11-02T18:19:00.193Z","updated_at":"2020-11-02T18:19:00.193Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"sickcodes","url":"/sickcodes"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9705709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very very much! Feel free to adjust the title/description as appropriate.","automated_response":false,"created_at":"2020-11-02T18:21:47.566Z","updated_at":"2020-11-02T18:21:47.566Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9726522,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed in nightly. CVE request submitted.","automated_response":false,"created_at":"2020-11-04T18:33:43.962Z","updated_at":"2020-11-04T18:33:43.962Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sickcodes","url":"/sickcodes"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9726526,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Report needs to be public before CVE request is approved.","automated_response":false,"created_at":"2020-11-04T18:34:19.647Z","updated_at":"2020-11-04T18:34:19.647Z","first_to_agree":true,"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9726537,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-11-04T18:35:06.460Z","updated_at":"2020-11-04T18:35:06.460Z","additional_data":{"old_title":"Brave Browser Tor Session Logging via Timestamp in Local State File Stored On-Disk","new_title":"Brave Browser potentially logs the last time a Tor window was used"},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9726543,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-04T18:36:48.634Z","updated_at":"2020-11-04T18:36:48.634Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9726544,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-04T18:36:48.716Z","updated_at":"2020-11-04T18:36:48.716Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9729160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again @diracdeltas, regarding the comment about whether a Tor session was used at a timestamp.\n\nIn GNU/Linux, the following JSON is stored (permanently) until another Tor session overwrites it, in the file\n\n```bash\njq '.core_p3a_metrics' \u003c ~/.config/BraveSoftware/Brave-Browser/Local\\ State\n```\nReturns\n```bash\n{\n  \"incognito_used_timestamp\": \"13248495136836403\",\n  \"tor_used\": true\n}\n```\n\nFeel free to upgrade the severity of this report if this changes perspective.","automated_response":false,"created_at":"2020-11-05T03:55:35.522Z","updated_at":"2020-11-05T03:55:35.522Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1065667,"filename":"Screenshot_2020-11-05_03-51-42.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3igiZcePgBxma4T3S8xx7njJ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-11-05_03-51-42.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-11-05_03-51-42.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131725Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=271d5630331363945eacfae85251e2b888f0ddd5db361c876aaa9631a5ac4fe8"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9729166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sickcodes tor_used is just whether tor was ever used (since you downloaded brave), not necessarily whether the last incognito session was a tor session","automated_response":false,"created_at":"2020-11-05T03:57:42.178Z","updated_at":"2020-11-05T03:57:42.178Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9729181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for pointing that out; I confirm that is true:\n\n\n\nOpen incognito with Tor:\n```json\n{\n  \"incognito_used_timestamp\": \"13249022386728896\",\n  \"tor_used\": true\n}\n```\n\nOpen incognito without Tor:\n```json\n{\n  \"incognito_used_timestamp\": \"13249022400646476\",\n  \"tor_used\": true\n}\n```\n\nOn a related note, is there any particular reason why logging (in general) requires nanosecond accuracy?","automated_response":false,"created_at":"2020-11-05T04:04:51.494Z","updated_at":"2020-11-05T04:04:51.494Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9729256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Published on https://sick.codes/sick-2020-013/\nPublished on https://github.com/sickcodes/security/blob/master/advisories/SICK-2020-013.md\n","automated_response":false,"created_at":"2020-11-05T04:36:20.634Z","updated_at":"2020-11-05T04:36:20.634Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9909911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all, NIST scored this one a medium 5.5 https://nvd.nist.gov/vuln/detail/CVE-2020-8276\n\nNot sure if you wanted to update the score of the report above, but it would cool on my HackerOne profile if this was a medium as I know you have different internal scores. Otherwise, happy to leave as-is!","automated_response":false,"created_at":"2020-11-24T09:32:24.966Z","updated_at":"2020-11-24T09:32:24.966Z","actor":{"username":"sickcodes","cleared":false,"url":"/sickcodes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yhqjS3Lp1zFH9fw8UdN1WUFh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}