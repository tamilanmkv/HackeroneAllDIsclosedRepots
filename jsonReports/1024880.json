{"id":1024880,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI0ODgw","url":"https://hackerone.com/reports/1024880","title":"SSL expired subdomain leads to API swap with main and flagged cookies. Unable to log device ids and certain session tokens. ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-03T00:13:30.328Z","submitted_at":"2020-11-03T00:13:30.387Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"babykeem","url":"/babykeem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/kCyTR74BvT13FynjQ2rmh46M/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":67,"url":"https://hackerone.com/basecamp","handle":"basecamp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Basecamp","twitter_handle":"basecamp","website":"https://basecamp.com/about/policies/security/response","about":"Basecamp is the leading online project manager and the birthplace of Ruby on Rails. Creators of the HEY email service."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-03T22:48:42.920Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-11-03T22:48:42.763Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**SUMMARY**\n\n- Replacing the login page of **launchpad.37signals.com** with subdomain **help-basecamphq.37signals.com** greats you to a login page in which is unsecure and with header (**sec-fetch-site: same-origin**) injected into your headers you can disable cookies such as .\n\n**STEPS TO REPRODUCE** \n\n1. Visit *https://help-basecamphq.37signals.com/signin?login_hint* and continue to sign in while capturing the request\n\n2. Compare to launchpad.37signals.com login...\n\n**help-basecamphq.37signals.com SIGN-IN LOGS + RESPONSE**\n ```\nCalling URL: https://help-basecamphq.37signals.com/session\nPost Data: utf8=%E2%9C%93\u0026authenticity_token=\u0026product=bcx\u0026account_id=2479412\u0026username=VALIDCREDENTIALS\u0026password=VALIDCREDENTIALS\u0026commit=Log+in\nSent Headers:\nsec-fetch-dest: document\nsec-fetch-mode: navigate\nsec-fetch-site: same-origin\nsec-fetch-user: ?1\nupgrade-insecure-requests: 1\nuser-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Mobile Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nSent Cookies:\n\nAddress: https://3.basecamp.com/4888641/\nResponse code: 200 (OK)\nReceived headers:\nServer: openresty\nDate: Mon, 02 Nov 2020 23:32:48 GMT\nContent-Type: text/html; charset=utf-8\nConnection: keep-alive\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: strict-origin-when-cross-origin\nAccept-CH: DPR,Width,Viewport-Width,Downlink,Save-Data\nPublic-Key-Pins-Report-Only: max-age=3600; includeSubdomains; pin-sha256=\"6X0iNAQtPIjXKEVcqZBwyMcRwq1yW60549axatu3oDE=\"; pin-sha256=\"Slt48iBVTjuRQJTjbzopminRrHSGtndY0/sj0lFf9Qk=\"; pin-sha256=\"LCa0a2j/xo/5m0U8HTBBNBNCLXBkg7+g+YpeiGJm564=\"; report-uri=\"https://zapier.com/hooks/catch/3b7uh7/\"\nX-Robots-Tag: none\nETag: W/\"da919800df1367ee83ad09a4e8fe78c2\"\nCache-Control: max-age=0, private, must-revalidate\nX-Release: bc5cc4f1db8d95d854d5363d908bb0be30245a88\nX-Ratelimit: {\"name\":\"General\",\"period\":60,\"limit\":1000,\"remaining\":999,\"until\":\"2020-11-02T23:33:00Z\"}\nX-Request-Id: a4e1be70-ecb8-4320-9fa5-08a2b4007558\nX-Runtime: 0.696588\nX-Request-Path: /4888641/\nStrict-Transport-Security: max-age=15552000; includeSubDomains; preload\nX-Queue-Time: 0.00046443939208984375\nTiming-Allow-Origin: *\nVary: Accept-Encoding\nContent-Encoding: gzip\nContent-Length: 15634\nReceived cookies:\nidentity_id: BAhpBJz5SQE%3D--c110fcda2f9ee0d25cbb9ebea290070e022da703\nsession_token: 054bc465dea644def06f\ndevice_id: BAhpA5Qtlg%3D%3D--e1a66b59f23ea1bccfd0e310927e0dc706d4dbce\n_launchpad_session: 5P%2FfNTAmA5cclQ1dBfPhXtvXOpm%2BaxyiJLJ8VqLD95GHNA0jbTQdu9cGszq8mtCqhmdZg%2BUA03yzs6RSQ9dnDS5PfwtV1oEHHHfhtWvGUnc2oLVlKJ8dOK7s581jQ9LSOuYOCv4GvLaGGDGDDOlvrj%2FIppMx6I9k5gi6Ibhpib7DqRuktM83tuasg36MFmve55MY1dGccBMNDd6FqKNviEM9t8zthz6ow0H3K3%2Fovme591IU%2BQ%3D%3D--%2FUz7acgdurSFzVU4--AogFxSLfddRsqIaZzI5J6g%3D%3D\nX-Release: bc5cc4f1db8d95d854d5363d908bb0be30245a88\n_mkra_stck: db%3A1604359968.4249594\nbc3_identity_id: BAhpBJz5SQE%3D--b6e61bb3f8a17a66d662d5b3e43bd70afaf466fa\nbc3_session_verification_token: 054bc465dea644def06f\n_bc3_session: 2w4ATDX9GM4pdfRmBxqvSTpR%2FoGr0h4u4zmMb8meRZGblBiAk4rdULGqlBMjKq8AJTXRqU50SqWbfPzGAKRDxhBLLqBZNs23JWUhGrGItTuSJG1WxLd3GcncYX0IinK4fz8VUEXcH6SsLxEv87n0lwjOc7TD5jZwsWDMY9ksYIkzKAwVseRZ7PLP3HYiuPW%2BtucDPZNR4KTauOJFoExRE2F9ZcbLQova0vQJYJiWBlSq2zEgwO16n0gDeb7lVzpoBkHGo8NjjJjnbFhQc1%2BvJIW843ExsAScMhBEhK8njOAGYqTHs65WFpYtWyzHHoegyU6JfDc%3D--8n%2FHProwiptDpUSX--Oz0NifYBBD0HPkKVs44RKQ%3D%3D\nX-Request-Id: a4e1be70-ecb8-4320-9fa5-08a2b4007558\nX-Runtime: 0.696588\n```\n\n**launchpad.37signals.com SIGN-IN LOGS + RESPONSE**\n```\nCalling URL: https://launchpad.37signals.com/session\nPost Data: utf8=%E2%9C%93\u0026authenticity_token=\u0026product=bcx\u0026account_id=2479412\u0026username=VALIDCREDENTIALS\u0026password=VALIDCREDENTIALS\u0026commit=Log+in\nSent Headers:\nsec-fetch-dest: document\nsec-fetch-mode: navigate\nsec-fetch-site: same-origin\nsec-fetch-user: ?1\nupgrade-insecure-requests: 1\nuser-agent: Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Mobile Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nSent Cookies:\n\nAddress: https://launchpad.37signals.com/basecamp/2479412/signin\nResponse code: 200 (OK)\nReceived headers:\nServer: openresty\nDate: Tue, 03 Nov 2020 00:04:38 GMT\nContent-Type: text/html; charset=utf-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nStatus: 200 OK\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: strict-origin-when-cross-origin\nX-Robots-Tag: noindex\nETag: W/\"dc3b5ec708ae44cc631cdf4e5bcd6d07\"\nCache-Control: max-age=0, private, must-revalidate\nX-Request-Id: 8b45d3f2-5977-4d3c-b016-202865d4e134\nX-Runtime: 0.007610\nStrict-Transport-Security: max-age=63072000; includeSubDomains; preload\nTiming-Allow-Origin: *\nReceived cookies:\n_launchpad_session: Upml5Bl1Hh0jrE7qcFRh5OMw22YOsNQp4p0BOLKEOlI5YgGcHC0po4BpNCGnNK8GRISr3Omfn3hvkoFx9U3%2B1TRcz27e%2FZHLANAyMaqvIKUKXYKdDRvpUjAqiRvbe8RYbZuuNe9YbdRfngx4ABu6FNnQS%2BcsvWhdEqtPDWXPK0ZEuUmIO3d03bU2dtz9t1XqRGzhgwDF8tALeqUd5MzWNe5uY2u9zuCMFs9zBh5OTGISLNJV9JcvIlN2NIAKfb6eSII8g0XK1LM%2FeSx47S7dYFEU9XlSo7HkrbocB%2BSWfDbqauZRWh6%2FwIHHv%2FiuCxgHoNjuWgWj9E9vLTkAS22bExBinfLfvqHssvEeJqNoCwCi--qm6qML%2BXUGcwR4kD--rT7LCfzseLJcC72KjPIYbw%3D%3D\nResponse Source:\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\" class=\"full_height\" \u003e\n\u003chead\u003e\n  \u003cmeta name=\"robots\" content=\"noarchive\" /\u003e\n  \u003cmeta name=\"viewport\" content=\"width=100%, initial-scale=1.0, maximum-scale=1.0\"\u003e\n  \u003cmeta name=\"referrer\" content=\"origin-when-cross-origin\"\u003e\n```\n\n**OVERVIEW**\n- Both logins were made with no past connections or requests. You can see that help-basecamp went through with the login and launchpad.37signals.com did not and classified my request as a robot. Not only this but help-basecamp also does not record or properly distribute cookies (identity_id, devide_id, session_token, and _launchpad_session were **ALL** flagged during the login). No other requests were trailed with this subdomain but I will be further investigating with this if consented. \n\n**CONCLUSION**\n- *https://help-basecamphq.37signals.com/* is a vulnerable and expired subdomain in which shares all attributes with launchpad.37signals.com except it fails to flag important cookies and fails to flag robotic requests and stop credential stuffing.\n\n**PS**: as you can also see I was able to exempt the authenticity_token from both logins with the request still going through.\n\n## Impact\n\nAttackers can bypass SSL verification and important cookies to access an unauthorized login page.","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":31,"name":"Brute Force"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-03T22:48:42.829Z","allow_singular_disclosure_after":-26922524.440336913,"singular_disclosure_allowed":true,"vote_count":11,"voters":["fqdn","prophet","ali","nich","codeur","kingbenaiah","cryptographer","prashantjadon","sirtopramen","stormofbytes","and 1 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":4656,"asset_type":"URL","asset_identifier":"launchpad.37signals.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9717404,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-03T19:40:30.950Z","updated_at":"2020-11-03T19:40:30.950Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":895304,"new_severity_id":896097},"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9717408,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report! We use this domain in CNAME records and didn’t intend for it to hit Launchpad when accessed directly. We’ll get it fixed up.","automated_response":false,"created_at":"2020-11-03T19:41:36.903Z","updated_at":"2020-11-03T19:41:36.903Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"bounty_amount":"350.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"babykeem","url":"/babykeem"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9717422,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-11-03T19:43:19.111Z","updated_at":"2020-11-03T19:43:19.111Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9717861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We’ve pointed this domain at our legacy app help site instead of Launchpad. Can you confirm this is fixed?","automated_response":false,"created_at":"2020-11-03T20:16:26.321Z","updated_at":"2020-11-03T20:16:26.321Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9718066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes! 404 Not found on login swap. Thanks for your time \u003c3","automated_response":false,"created_at":"2020-11-03T20:34:52.626Z","updated_at":"2020-11-03T20:34:52.626Z","actor":{"username":"babykeem","cleared":false,"url":"/babykeem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kCyTR74BvT13FynjQ2rmh46M/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9718109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again!","automated_response":false,"created_at":"2020-11-03T20:41:52.449Z","updated_at":"2020-11-03T20:41:52.449Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"babykeem","url":"/babykeem"},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9719276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This can be disclosed please and thanks!","automated_response":false,"created_at":"2020-11-03T22:45:33.754Z","updated_at":"2020-11-03T22:45:33.754Z","actor":{"username":"babykeem","cleared":false,"url":"/babykeem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kCyTR74BvT13FynjQ2rmh46M/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9719295,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-03T22:48:42.780Z","updated_at":"2020-11-03T22:48:42.780Z","first_to_agree":true,"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9999764,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-03T22:48:42.967Z","updated_at":"2020-12-03T22:48:42.967Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}