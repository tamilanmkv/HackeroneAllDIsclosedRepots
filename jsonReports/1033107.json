{"id":1033107,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDMzMTA3","url":"https://hackerone.com/reports/1033107","title":"DNS Max Responses for DOS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-11-12T18:32:25.883Z","submitted_at":"2020-11-12T18:32:25.903Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zeus1999","url":"/zeus1999","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8277"],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-16T22:08:53.517Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-11-16T22:08:50.421Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"See Github (my issue): https://github.com/nodejs/node/issues/36063\n\n\nWhen i try to fetch the A Dns records of following domain: ticbrasil.com.br I dont get any response.\nI think thats the case because there are over 1300 responses.\n\nVersion: v12.18.4, v14.15.0\nPlatform: 64-bit Windows 10 Pro \u0026 Enterprise\n\nWhat steps will reproduce the bug?\nvar dns = require('dns'); dns.resolve4('ticbrasil.com.br', function (err, addresses, family) { console.log(err); console.log(addresses); console.log(family); });\n\nHow often does it reproduce? Is there a required condition?\nIt happends everytime\n\nWhat is the expected behavior?\nhttps://pastebin.com/Tv53Na89\n\nWhat do you see instead?\nNothing/No output\n\n## Impact\n\nmmomtchev commented 3 hours ago\n@mhdawson someone should contact Mitre or whoever you usually contact, this is a confirmed remote security vulnerability. If an attacker can trigger a DNS resolution for an address chosen by him, then it is exploitable for DoS. It is a very high-risk vulnerability. I don't think a remote access is possible, but this should probably be evaluated by an expert.\n\n@jasnell\n \nMember\njasnell commented 2 hours ago\nWe can look into this further but I have to point out: we have a defined process for properly reporting and investigating potential security vulnerabilities. As soon as this issue was suspected as being a security issue, that process should have been followed with investigation and fixes investigated in the private Node.js repo we use for that purpose, otherwise this ends up risking a zero-day for all Node.js users.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-16T22:08:50.521Z","allow_singular_disclosure_after":-25801753.988197397,"singular_disclosure_allowed":true,"vote_count":2,"voters":["hackernaut","z3rod3x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9805960,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-12T18:35:41.765Z","updated_at":"2020-11-12T18:35:41.765Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":904748},"actor":{"username":"zeus1999","cleared":false,"url":"/zeus1999","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9805998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zeus1999 do you have some scenarios in mind where an attacker could drigger DNS resolution for an address of their choosing? It would be good to understand how hard/practical this is.\n","automated_response":false,"created_at":"2020-11-12T18:40:50.152Z","updated_at":"2020-11-12T18:40:50.152Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"drigger -\u003e trigger ","automated_response":false,"created_at":"2020-11-12T18:44:36.230Z","updated_at":"2020-11-12T18:44:36.230Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't really understand how this is a security vulnerability, or how it could be exploited.\n\nRunning the code I get:\n\n```\n\\Error: queryA ENODATA ticbrasil.com.br\n    at QueryReqWrap.onresolve [as oncomplete] (node:dns:203:19) {\n  errno: undefined,\n  code: 'ENODATA',\n  syscall: 'queryA',\n  hostname: 'ticbrasil.com.br'\n}\n```\n\nWhere is the Denial of Service attack?\n\nIt is a bug, I just do not see the exploit.","automated_response":false,"created_at":"2020-11-12T18:59:54.567Z","updated_at":"2020-11-12T18:59:54.567Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can recreate a crash on Linux with 14.10.0 from the Download site, about 1/4 runs with the test provided.\n\nuser1@user1-VirtualBox:~/testvuln/node-v14.15.0-linux-x64/bin$ ./node ../../test.js\nSegmentation fault (core dumped)","automated_response":false,"created_at":"2020-11-12T20:02:47.680Z","updated_at":"2020-11-12T20:02:47.680Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry that should have  been Linux with v14.15.0","automated_response":false,"created_at":"2020-11-12T20:03:16.517Z","updated_at":"2020-11-12T20:03:16.517Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9808248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zeus1999 as an FYI I moved your issue to a private repo to limit visibility while we line up fixes/release. We an restore one we've got releases out.","automated_response":false,"created_at":"2020-11-13T01:00:52.005Z","updated_at":"2020-11-13T01:00:52.005Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9834860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This was part of the recent security releases: https://nodejs.org/en/blog/vulnerability/november-2020-security-releases/","automated_response":false,"created_at":"2020-11-16T16:57:00.497Z","updated_at":"2020-11-16T16:57:00.497Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837741,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-11-16T22:05:01.981Z","updated_at":"2020-11-16T22:05:01.981Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837743,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-11-16T22:05:28.103Z","updated_at":"2020-11-16T22:05:28.103Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zeus1999","url":"/zeus1999"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837754,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-16T22:08:50.447Z","updated_at":"2020-11-16T22:08:50.447Z","first_to_agree":true,"actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10126500,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-16T22:08:53.573Z","updated_at":"2020-12-16T22:08:53.573Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11005211,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-03-16T07:04:12.062Z","updated_at":"2021-03-16T07:04:12.062Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Node.js"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nodejs","collaborator":{"username":"zeus1999","url":"/zeus1999"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}