{"id":1040047,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQwMDQ3","url":"https://hackerone.com/reports/1040047","title":"Email Verification bypass on signup","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-11-21T09:29:57.927Z","submitted_at":"2020-11-21T09:29:57.967Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haqsek2","url":"/haqsek2","profile_picture_urls":{"small":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxOako0TmpKZUJqc0hWRG9KWTNKdmNFa2lEall5ZURZeUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--5a32c5e1066e20d71d20163dc760c4822febc2cd/farhan.webp%22"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-03T08:43:26.221Z","bug_reporter_agreed_on_going_public_at":"2020-12-01T11:39:41.323Z","team_member_agreed_on_going_public_at":"2020-12-03T08:43:26.125Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThis bug is related to wordpress.com. There is feature in wordpress.com which allow users to invite people. We have to enter email address to invite that particular person but the invite link and invite key is also available to the person who invited. This allow attackers to create the profile without having access to the email address and they can make account on behalf of any people who  is not already signed up in wordpress.com\n\n## Platform(s) Affected:\nwordpress.com\npublic-api.wordpress.com\n\n## Steps To Reproduce:\nThis issue can be reproduced by following these easy steps: \n* Login to your account on wordpress.com\n* Setup burpsuite proxy with browser.\n* Select your site and navigate to manage\u003epeople\n* Enter any email address which is not already registered in wordpress.com and invite\n* Open this url in browser: https://wordpress.com/people/invites/yoursite.wordpress.com   [change yoursite.wordpress.com with your site]\n* See the burp suite proxy tab and find the GET request to this endpoint [https://public-api.wordpress.com/rest/v1.1/sites/siteId_here/invites?http_envelope=1\u0026status=all\u0026number=100]     [there will be a number instead of siteId_here]\n* In response of this GET request you will see JSON which will be consisting of the details about the invitations sent and there you will find \"invite_key\" and \"link\".\n* Copy the link and open this in another browser.\n* You can create account on behalf of this email without having access to the email and email verification is bypassed :)\n\n**See the attached video for POC**\n\n## Mitigation:\nThis is the pure violation of secure design principles, this can be mitigated by just removing the [invite_key] and [link] from the response in [https://public-api.wordpress.com/rest/v1.1/sites/siteId_here/invites?http_envelope=1\u0026status=all\u0026number=100]. Because this invite key and link is the property of the person being invited, showing these creds to other people will result this type of issue.\n\n## Impact\n\nThis issue can be used to bypass email verification on signup. Attackers can create account on behalf on any person without having access to the email account. This issue is affecting integrity of the wordpress.com","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1088626,"file_name":"wordpresscom-2020-11-21_01.21.40.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yqqnv8ni0se62te3yyxnmot4ef2x?response-content-disposition=attachment%3B%20filename%3D%22wordpresscom-2020-11-21_01.21.40.mp4%22%3B%20filename%2A%3DUTF-8%27%27wordpresscom-2020-11-21_01.21.40.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY5I5ZOTN%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131841Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQCqf43kV8RTzzmWR1TXeEdpx%2Fd5zGOFNpfZDgSM2xJuCQIhAMLYAxjZR7PGO9btJ9wGFbOqf%2FTbE2pC%2FdkQgyPDWZD8KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzmKazqBIClFAMqc2Iq1wNPV39BSW59qP%2ByHsmBjxY6m%2Fb7a6U5448PKOSe8dVf6ZB9c%2BLac%2F0Gz8ADXdDYKsvWZv%2FAmBj5%2FhHzWjVphb45t9jx%2BhpJI0AITzRmRN5aq7TLFOZDfehY6xr7qR34eKZAu9XJrbi4QdAu%2BNSUgERhmM4muMj19K4msZk8sFVbAKLF%2BU6gGnywSDktUJmbSxfnY6ZesCS5elWm1qPvYsKCbrl5y57ovXEaa7NAn6XfLDrVTRtpY8qRzPQbURfe%2FnNfBCEGQCwCuB8zQszv%2B2O4z6L6fFCLSm2gccXmLLJqlgBN7EwqRjH0XLKpn1vWKBfmNtQJMcfcBOgesSBjohFRDqs9VtzSm8Ar%2FZ3tQRyj3E5FFBVh7SFXfbH0zIPhcJnR7J%2Ft20n0T0BoFfeC4Lh04EDdGi1xF35UayBRbz0euxaVcKV0UA%2BktOyHmbRzgaonWDeZCOaJtjFZCGnWooRLI6KrYUmAIMrnyQoKS2q8DQKxvweDK7%2FuWfo1ovNRy%2BMy3v8N%2B%2B6q1M2DXNkYeXZoalrKF%2BzGC2C%2FRVd1z2LoHJiVHopIG7T4Lyax%2BX9LY1Z9oVqxPxTo9SgiI1kD69%2Bl5MKWzogETScQuH%2Bvi36SPh1QbdmYvwgw5O6QiwY6pAEabkl2EyHSmga%2FQVBclzYljmd0Pvwag9ITi%2BNlOViZyzeqV8k%2F8Q8ny0OOVtCp3iCSdWDf1LHd%2BqKtTjKS7CIODHKRsg4m3sx7QNZBHT5H00n5U2ZVgN4N9m3YxiNqVHw1I0Jv0KF1%2BS2XFhkFHuxBokXIzihowuz57pmo5yGw3bX16HVqCrlEZdpJDLSrVWPAr55aHcggcNaCjNyYlZGc9VtWCw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3a9e6bf200f41ee829364561bd5f5023a237fd8593442b319b79e6ccb2ff7ad5","file_size":7223798,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-12-31T11:39:41.410Z","allow_singular_disclosure_after":-24543539.687174913,"singular_disclosure_allowed":true,"vote_count":112,"voters":["sw33tlie","mashoud1122","prophet","bibekshah","bombon","dhakal_ananda","yogesh_ojha","ali","yassinek3ch","ayman3os","and 102 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":42402,"asset_type":"URL","asset_identifier":"*.tumblr.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9894440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nIs this program really dead? or just pretending to be dead. Anyone out there?","automated_response":false,"created_at":"2020-11-23T06:46:40.900Z","updated_at":"2020-11-23T06:46:40.900Z","actor":{"username":"haqsek2","cleared":false,"url":"/haqsek2","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/farhan.webp%22"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9895650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. Your report will be reviewed and we'll get back to you shortly.","automated_response":false,"created_at":"2020-11-23T09:08:05.402Z","updated_at":"2020-11-23T09:08:05.402Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9900081,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @haqsek2. I confirmed this issue. We will start working on a fix. I'll let you know once this will be deployed to production.","automated_response":false,"created_at":"2020-11-23T15:08:32.144Z","updated_at":"2020-11-23T15:08:32.144Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9901678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the acknowledgement.","automated_response":false,"created_at":"2020-11-23T17:07:00.439Z","updated_at":"2020-11-23T17:07:00.439Z","actor":{"username":"haqsek2","cleared":false,"url":"/haqsek2","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/farhan.webp%22"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9924991,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update?","automated_response":false,"created_at":"2020-11-25T14:27:46.024Z","updated_at":"2020-11-25T14:27:46.024Z","actor":{"username":"haqsek2","cleared":false,"url":"/haqsek2","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/farhan.webp%22"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9959360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @haqsek2, this should be now fixed for new invitations. Can you please see if you are still able to reproduce this issue?","automated_response":false,"created_at":"2020-11-30T09:12:22.452Z","updated_at":"2020-11-30T09:12:22.452Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9959436,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I have tried to reproduce it and I confirm that this issue has been fixed.\nThanks","automated_response":false,"created_at":"2020-11-30T09:22:14.029Z","updated_at":"2020-11-30T09:22:14.029Z","actor":{"username":"haqsek2","cleared":false,"url":"/haqsek2","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/farhan.webp%22"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9972470,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-12-01T10:33:20.171Z","updated_at":"2020-12-01T10:33:20.171Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"haqsek2","url":"/haqsek2"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9972475,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi, we would like thank you again for your submission and helping make Automattic a safer place. We look forward to more reports from you in the future.","automated_response":false,"created_at":"2020-12-01T10:33:45.332Z","updated_at":"2020-12-01T10:33:59.175Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"haqsek2","url":"/haqsek2"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9972988,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this report?","automated_response":false,"created_at":"2020-12-01T11:39:41.340Z","updated_at":"2020-12-01T11:39:41.340Z","first_to_agree":true,"actor":{"username":"haqsek2","cleared":false,"url":"/haqsek2","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBMFh0RWc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c79048a9326abf726f3d468e62be51fa317fdd5e/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/farhan.webp%22"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9991913,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-03T08:43:26.145Z","updated_at":"2020-12-03T08:43:26.145Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9991914,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-03T08:43:26.247Z","updated_at":"2020-12-03T08:43:26.247Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}