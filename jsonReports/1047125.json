{"id":1047125,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQ3MTI1","url":"https://hackerone.com/reports/1047125","title":"Non-revoked API Key Disclosure in a Disclosed API Key Disclosure Report on Stripo","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-30T15:28:22.895Z","submitted_at":"2020-11-30T15:28:22.960Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whoisbinit","url":"/whoisbinit","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-04T14:14:43.670Z","bug_reporter_agreed_on_going_public_at":"2020-12-04T10:16:10.340Z","team_member_agreed_on_going_public_at":"2020-12-04T14:14:43.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nCan you imagine discovering an API key disclosure vulnerability in a disclosed API key disclosure report? The same thing is what I came across while going through the disclosed reports at Stripo Inc. Plus, the disclosed API key isn't even revoked, and therefore I am still able to use the same API key to fetch response from the target.\n\nI am talking about #983331 where a security researcher reported secret API key leakage vulnerability in a JavaScript file at Stripo. This report is disclosed on HackerOne, and the team at Stripo have forgotten to blur the API keys from the report before disclosing it to the public. The API keys from Aviary and YouTube are disclosed in that report, and I tried using these API keys, and found out that they can still be used to fetch response from YouTube's API using Stripo's disclosed API key. I didn't check on Aviary though since I found out that Aviary is already a defunct image editor.\n\n## Steps To Reproduce:\n\n### API Key Disclosure:\nTo reproduce the API Key Disclosure vulnerability, you can perform the following steps:\n  1. Visit https://hackerone.com/stripo/hacktivity?filter=type%3Apublic\u0026type=team\n  2. You will see a disclosed report entitled \"**Public and secret api key leaked in JavaScript source**\". Visit this report: https://hackerone.com/reports/983331\n  3. You will see the following two lines in the report:\n\n```\naviaryApiKey: \"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\",\nyoutubeApiKey: \"â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\",\n```\n\nYou can see the API keys from Aviary and YouTube are disclosed in this report.\n\n### API Key Validation:\nJust because an API key is disclosed in a disclosed report, it doesn't mean that the API key actually works. Therefore, I decided to check whether the YouTube API Key is still working or not. For this purpose, you can follow these steps:\n  1. Visit https://developers.google.com/youtube/v3/docs,\n  2. Start looking for different services on how you can use the disclosed API key against YouTube Data API! I decided to check this one: https://youtube.googleapis.com/youtube/v3/search?key=\u003cValid-API-Key-Here\u003e\n  3. Replace the value of the **`key`** parameter in the URL with the Stripo's disclosed API key; i.e. **`â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`**. Therefore, the URL will become: https://youtube.googleapis.com/youtube/v3/search?key=â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\n  4. Now, visit the URL you crafted in Step 3, and you will see that the YouTube Data API responds back with the results it should show for this particular API endpoint.\n\n## Supporting Material/References:\n\n  * I have attached a screenshot of the API keys being disclosed in the disclosed report along with this report.\n  * I have also attached a sample Proof-of-Concept response that YouTube Data API showed for one of the YouTube API requests made using the Stripo's YouTube API Key.\n\n## Impact\n\nBy taking an advantage of this vulnerability, an attacker would be able to use Stripo's YouTube API Key for calling different API endpoints in services provided in the YouTube Data API.","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["najeh_halawani","prophet","dhakal_ananda","sakshamguruji","powerjacobb1","akashhamal0x01","sa1tama0","rutrut","donfi","sirtopramen","and 4 more..."],"severity":{"rating":"medium","score":4.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":38701,"asset_type":"URL","asset_identifier":"stripo.email","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9963244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## How to Fix?\nIn case you are interested in a permanent fix to this vulnerability, the best way is to revoke the disclosed API keys and generate new keys. If this is done, then even if the API keys are disclosed, an attacker wouldn't be able to use those keys to fetch valid response from the API provider service (in this case, Aviary and YouTube Data API).\n\nYou can also fix this vulnerability by doing a partial disclosure of the #983331 report, or blurring the API keys in that report. However, I would highly recommend you to revoke the API Keys, because the disclosed report might have been scraped already by several web crawling and scraping services.","automated_response":false,"created_at":"2020-11-30T15:36:02.213Z","updated_at":"2020-11-30T15:36:02.213Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9982689,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you!","automated_response":false,"created_at":"2020-12-02T09:24:03.503Z","updated_at":"2020-12-02T09:24:03.503Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9982696,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed by blurring API key","automated_response":false,"created_at":"2020-12-02T09:24:31.911Z","updated_at":"2020-12-02T09:24:31.911Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"whoisbinit","url":"/whoisbinit"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9983048,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nThat's awesome! I just witnessed the fastest fix among all the vulnerabilities I have ever reported to several companies.\n\nI noticed that you have now blurred the API keys in the particular report, and I really appreciate the super quick fix. You are really great.\n\nHowever, I can still see the same YouTube API key is being used, and it hasn't been revoked yet; i.e. it is still giving valid response while using that API key for YouTube Data API services. Therefore, I would suggest you to revoke access to this API key, because the disclosed report might have been scraped by third-party platforms already, and they could make bad use of the API key.\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-12-02T09:57:16.513Z","updated_at":"2020-12-02T09:57:16.513Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10002014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This API key is used for staging env, so that's fine) Thank you!","automated_response":false,"created_at":"2020-12-04T08:45:28.522Z","updated_at":"2020-12-04T08:45:28.522Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10003464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh, then that's fine, @artem_nefedov!\n\nThank you for the information!","automated_response":false,"created_at":"2020-12-04T10:15:19.834Z","updated_at":"2020-12-04T10:15:19.834Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10003569,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello there,\n\nCan we disclose this report? I hope you would blur the API keys from this report too.\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-12-04T10:16:10.364Z","updated_at":"2020-12-04T10:16:10.364Z","first_to_agree":true,"actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10005758,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-04T14:14:43.594Z","updated_at":"2020-12-04T14:14:43.594Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10005759,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-04T14:14:43.701Z","updated_at":"2020-12-04T14:14:43.701Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10005813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nThank you for playing a super active role throughout the overall phase of reporting this issue to the final disclosure!\n\nI am looking forward to collaborating with you and the **[Stripo Inc](https://hackerone.com/stripo)** team further through other reports in the near future.\n\nHave a great day!\n\nThanks, and regards,\n@binit","automated_response":false,"created_at":"2020-12-04T14:19:36.573Z","updated_at":"2020-12-04T14:19:36.573Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10038812,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you too, @binit !","automated_response":false,"created_at":"2020-12-08T11:27:54.056Z","updated_at":"2020-12-08T11:27:54.056Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":25685,"category":"researcher","content":"***\n### Imagine finding non-revoked API key disclosure in disclosed API key disclosure report! ðŸ˜€ðŸ˜€\n\n#### ðŸ“• Make sure to check whether the API keys still work or they have already been revoked in full-disclosed reports! ðŸ˜ŠðŸ˜Š\n***","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":204685,"username":"whoisbinit","name":"Binit Ghimire","bio":"I am a Tech Enthusiastic full-stack web developer, programmer and web/network penetration tester from Nepal.","cleared":false,"website":"https://WHOISbinit.me/","location":"Bharatpur-9, Milanchowk, Chitwan","created_at":"2017-10-02T06:42:57.263Z","url":"https://hackerone.com/whoisbinit","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}