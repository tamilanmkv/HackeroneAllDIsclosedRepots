{"id":1051431,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDUxNDMx","url":"https://hackerone.com/reports/1051431","title":"Blind SSRF on infodesk.engelvoelkers.com via proxy.php","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2020-12-06T02:20:45.001Z","submitted_at":"2020-12-06T02:20:45.042Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mikkocarreon","url":"/mikkocarreon","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":40276,"url":"https://hackerone.com/engel_volkers","handle":"engel_volkers","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uc1uE7T18XNNBt7cpjrGoxFk/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/uc1uE7T18XNNBt7cpjrGoxFk/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Engel \u0026 Völkers Technology GmbH","twitter_handle":"euvtechnology","website":"https://www.engelvoelkers.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-06-30T13:37:50.656Z","bug_reporter_agreed_on_going_public_at":"2021-06-17T05:55:55.326Z","team_member_agreed_on_going_public_at":"2021-06-30T13:37:50.534Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe application has a proxy.php file which basically accepts a parameter via `url` query parameter and passes it to `fopen()`. However, it doesn't validate the parameter value prior to passing it to `fopen`- making it possible to influence what's being done. That said, because of code following the `fopen`, it throws error with `filesize()`. Yet, we can still send requests to any arbitrary URL and confirm the existence of files in the system.\n\n## Steps To Reproduce:\nFor easier reproduction, let's just confirm the existence of a file;\nOpen https://infodesk.engelvoelkers.com/proxy.php?url=proxy. You should receive the following warning message;\n\u003e fopen(proxy): failed to open stream: No such file or directory in \u003cb\u003e/var/www/html/proxy.php\u003c/b\u003e on line \u003cb\u003e3\u003c/b\u003e\n\nNow, open https://infodesk.engelvoelkers.com/proxy.php?url=proxy.php which we know exists and as such, it passes the `fopen` check and goes on to next line (i.e. 4) and gives another warning, confirming the existence of the file;\n\u003e filesize() expects parameter 1 to be a valid path, resource given in \u003cb\u003e/var/www/html/proxy.php\u003c/b\u003e on line \u003cb\u003e4\u003c/b\u003e\u003cbr /\u003e\n\nSimilarly, we can send arbitrary requests to external as well as internal URL with `http` URL Scheme. It may be possible to use other schemes like `gopher://` to exfiltrate contents or send emails with SMTP which I haven't tested yet. The response also returns the HTTP status of the requested endpoint. So, we can basically determine response status as well. For example, opening https://infodesk.engelvoelkers.com/proxy.php?url=http://cm2.pw/xxx would give the following warning;\n\u003e  fopen(http://cm2.pw/xxx): failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found  in \u003cb\u003e/var/www/html/proxy.php\u003c/b\u003e on line \u003cb\u003e3\u003c/b\u003e\n\n## Supporting Material/References:\n{F1105547}\n{F1105548}\n\n## Impact\n\n- Internal hosts and service enumeration is possible at minimum.\n- Confirm the existence of file within the system and its filepath\n\nIt might be possible to exfiltrate contents with other URL scheme like `gopher` or send emails with SMTP. Or it could be possible to bypass `filesize` altogether which I'm yet to explore.","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1105547,"file_name":"Screen_Capture_select-area_20201206080201.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/28vo3zc1vfni2mymio0ui7g6syhh?response-content-disposition=attachment%3B%20filename%3D%22Screen_Capture_select-area_20201206080201.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Capture_select-area_20201206080201.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ77TMTAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131944Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCICucm0jzvD3QISJcdxs15I345d%2Bix4EPkAt2aiYpOpdLAiEA4nsHwmQauYXeRj2fqr%2FRPQvyF0GdJ2cF06PXfZnVZHUqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDCcz%2F%2BsEiqWc0DUpwirXA2k6GtLMgoAsl9NCZ55wDpMp4kgwISr3ljm%2B8a7xcwiicQhhIArUvgh3L3TswkYJ7UwHTth8qcnjo%2B0r0ur2DG7VqYFOsB64ZJK%2B50np3hTJAOjcnuao2VJ3aNvW7aI3KOGWa9X70WTRmIF9l7hp%2FuS34OIwkvWCOwRjM5OjQVXbjQFM7laXpxh%2FIMPjqWNU12tk0AE8sHkU5ZHji%2FHsjdATutxCfSVF2F9AqVHQb1cooNHKpvHPZ7cWy1PI1ti9jcQSmw2nWXaHgo03WL%2FbvWsJE5sINQQTBsbPtj6HkRi2DYtMUj%2FCwp1gWWtqmj%2BE9KFI3Up9F2XHSiQl%2F%2FzvBzvGobU%2BJanerONSlBFtZCzzuGYQKKlCaEiQWQaAep2w06bdqL74pk%2F%2F7Z%2FblDV2PQiXH9DA8gZWJ35R3Kx1O181tMdE6GlimskssWXw3T7FKDxBjdE5vIrvXULIPEGMcgt9OkzBWdkBye6JbTUwFlu91n75BywzEPJrwt7Axf59f%2B6xTHJQWcV5WQInKY66J1ACrRORDwto1eqasXN39woy8OtaG3C9ZjySQvFJBGILbK0TxCvZgofoxTM%2BVXaA%2BUgCUR5fD0zOrI%2FNOjIZ9FF4dCOawt3PTDCV0ZCLBjqlAZ9nw3V49gsDLsG7%2Bwjmt2rtA8gTy2t9ICg%2FUFq98yLSqBNvcZCLsRE1tJ%2FV5%2Brm7vi2mQ%2B%2F2k8CjaKIz6e%2BFbIVE0ufGQllyLCGU9w2IZ5XgnrOKkujdYvP046TFXIFjhpPmRttoV7G0BUQ4Yi%2FArYY6hOa%2FLO2yvUEgyWWfJzu8mIECYte5aLcfXi6bl%2BN6EUD9LibMaoGMQJod0PL6A98fU3YOQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d14302b34be377189d26dee777e70b659d00fdd7994602b700e181ccec296463","file_size":99609,"type":"image/png"},{"id":1105548,"file_name":"Screen_Capture_select-area_20201206080331.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/txxjbx5an42tn533f0hb2ukvxi69?response-content-disposition=attachment%3B%20filename%3D%22Screen_Capture_select-area_20201206080331.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Capture_select-area_20201206080331.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ77TMTAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131944Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCICucm0jzvD3QISJcdxs15I345d%2Bix4EPkAt2aiYpOpdLAiEA4nsHwmQauYXeRj2fqr%2FRPQvyF0GdJ2cF06PXfZnVZHUqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDCcz%2F%2BsEiqWc0DUpwirXA2k6GtLMgoAsl9NCZ55wDpMp4kgwISr3ljm%2B8a7xcwiicQhhIArUvgh3L3TswkYJ7UwHTth8qcnjo%2B0r0ur2DG7VqYFOsB64ZJK%2B50np3hTJAOjcnuao2VJ3aNvW7aI3KOGWa9X70WTRmIF9l7hp%2FuS34OIwkvWCOwRjM5OjQVXbjQFM7laXpxh%2FIMPjqWNU12tk0AE8sHkU5ZHji%2FHsjdATutxCfSVF2F9AqVHQb1cooNHKpvHPZ7cWy1PI1ti9jcQSmw2nWXaHgo03WL%2FbvWsJE5sINQQTBsbPtj6HkRi2DYtMUj%2FCwp1gWWtqmj%2BE9KFI3Up9F2XHSiQl%2F%2FzvBzvGobU%2BJanerONSlBFtZCzzuGYQKKlCaEiQWQaAep2w06bdqL74pk%2F%2F7Z%2FblDV2PQiXH9DA8gZWJ35R3Kx1O181tMdE6GlimskssWXw3T7FKDxBjdE5vIrvXULIPEGMcgt9OkzBWdkBye6JbTUwFlu91n75BywzEPJrwt7Axf59f%2B6xTHJQWcV5WQInKY66J1ACrRORDwto1eqasXN39woy8OtaG3C9ZjySQvFJBGILbK0TxCvZgofoxTM%2BVXaA%2BUgCUR5fD0zOrI%2FNOjIZ9FF4dCOawt3PTDCV0ZCLBjqlAZ9nw3V49gsDLsG7%2Bwjmt2rtA8gTy2t9ICg%2FUFq98yLSqBNvcZCLsRE1tJ%2FV5%2Brm7vi2mQ%2B%2F2k8CjaKIz6e%2BFbIVE0ufGQllyLCGU9w2IZ5XgnrOKkujdYvP046TFXIFjhpPmRttoV7G0BUQ4Yi%2FArYY6hOa%2FLO2yvUEgyWWfJzu8mIECYte5aLcfXi6bl%2BN6EUD9LibMaoGMQJod0PL6A98fU3YOQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=845a47cf83e43045992b87179ab2ed7be530918a97c582b571479826ca1750fd","file_size":111188,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["brumens","3x3s","sa1tama0","ekgaribadmi"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":44209,"asset_type":"URL","asset_identifier":"*.engelvoelkers.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10018921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mikkocarreon,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@staple","automated_response":false,"created_at":"2020-12-06T23:53:00.055Z","updated_at":"2020-12-06T23:53:00.055Z","actor":{"username":"staple","cleared":false,"url":"/staple","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/426/626/5be8ff38188fdc44b801e26c3fa0311ac59dc701_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10049032,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey @mikkocarreon,\n\nAfter review, there doesn’t seem to be any security risk and/or security impact as a result of the behavior you are describing.\n\nIf you are able to leverage this into a practical exploitation scenario, we will be happy to reevaluate this report, but at this time, it does not present a significant security risk. \n\nAs a result, we will be closing this report as informative. This will not have any impact on your Signal or Reputation score. We appreciate your effort and look forward to seeing more reports from you in the future. \n\nKind regards,\n@beagle","automated_response":false,"created_at":"2020-12-09T08:50:01.333Z","updated_at":"2020-12-09T08:50:01.333Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10049071,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@beagle ,\nIsn't being able to enumerate open ports an issue? I can find a lot of reports just sending pingbacks to Burp Collaborator. Here, in my case, I'm able to enumerate open ports (plus other internal hosts within the network) as well as existence of files within the system.\nIf not, I just want a little justification why not.\n","automated_response":false,"created_at":"2020-12-09T08:55:08.643Z","updated_at":"2020-12-09T08:55:08.643Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12149869,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-17T05:55:55.355Z","updated_at":"2021-06-17T05:55:55.355Z","first_to_agree":true,"actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12300466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-30T13:37:50.563Z","updated_at":"2021-06-30T13:37:50.563Z","actor":{"username":"evjh","cleared":false,"url":"/evjh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12300467,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-30T13:37:50.697Z","updated_at":"2021-06-30T13:37:50.697Z","actor":{"username":"evjh","cleared":false,"url":"/evjh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}