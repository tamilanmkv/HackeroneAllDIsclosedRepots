{"id":1057531,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDU3NTMx","url":"https://hackerone.com/reports/1057531","title":"GET /api/v2/url_info endpoint is vulnerable to Blind SSRF","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2020-12-12T17:01:03.464Z","submitted_at":"2020-12-12T17:01:03.517Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"atc_h1h1","url":"/atc_h1h1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/XdLRnHdz17EXjNHGVBybifpc/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-15T13:03:15.978Z","bug_reporter_agreed_on_going_public_at":"2020-12-15T02:48:28.266Z","team_member_agreed_on_going_public_at":"2020-12-15T13:03:15.915Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nGET /api/v2/url_info endpoint is vulnerable to Blind SSRF. I am able to hit both Internal and External services via **url** parameter by replacing with internal and external url.\n\n## Platform(s) Affected:\nhttps://www.tumblr.com/\n\n## Steps To Reproduce:\n\n  1. Login to https://www.tumblr.com/\n  2. Follow any blog and intercept request via Proxy\n\nRequest :\n\nGET /api/v2/url_info?url={{}}\u0026fields%5Bblogs%5D=avatar%2Cname%2Ctitle%2Curl%2Cdescription_npf%2Ctheme%2Cuuid%2Ccan_be_followed%2C%3Ffollowed%2C%3Fis_member%2Cshare_likes%2Cshare_following%2Ccan_subscribe%2Ccan_message%2Csubscribed%2Cask%2C%3Fcan_submit%2C%3Fis_blocked_from_primary%2C%3Fadvertiser_name%2C%3Ftop_tags%2C%3Fprimary HTTP/1.1\nHost: www.tumblr.com \n\nResponse:\nHTTP/1.1 200 OK\nContent-Type: application/json; charset=utf-8\n\n3. Now replace **url** parameter to your controller server url and send it.\n4. You will get request to your server.\n\nI could get verify it via IP Address: **74.114.154.11**\nNetRange:       74.114.152.0 - 74.114.155.255\nCIDR:           74.114.152.0/22\nNetName:        AUTOMATTIC\nNetHandle:      NET-74-114-152-0-1\nParent:         NET74 (NET-74-0-0-0-0)\nNetType:        Direct Assignment\nOriginAS:       AS2635\nOrganization:   Automattoque (AU-187)\nRegDate:        2017-04-20\nUpdated:        2017-04-21\nRef:            https://rdap.arin.net/registry/ip/74.114.152.0\n\nOrgName:        Automattoque\nOrgId:          AU-187\nAddress:        P.O. Box 997\nCity:           Halifax\nStateProv:      NS\nPostalCode:     B3J 2X2\nCountry:        CA\nRegDate:        2015-11-25\nUpdated:        2017-04-21\nRef:            https://rdap.arin.net/registry/entity/AU-187\n\n5. Now replace it with localhost url -\u003e http://127.0.0.1:9090 and see response will be 404 but based on response time, port status can be identified.\n\nLimited Internal and External SSRF is performed. Attacker can target internal services by sending requests in bulk via mentioned endpoint.\nAttacker can get ports status by fuzzing or intruder attacker based on response time.\nAttacker would be able to target internal services and try to exhaust/target internal infrastructure.\n\n**Remediation Strategies :**\n\n1. **Only white listed URLs should be allowed for this endpoint. As user can only follow tumblr blogs, there would be some sort of filter mechanism to whitelist tumblr blogs. Any other URLs should be blocked.**\n2. **Not only for this API endpoint, any localhost URLs provided by user should be blocked.**\n2. **Any Out-of-band request from tumblr should be sent via CLIENT only. Here  in this case, server is requesting user controller URL input and requesting resource which is exposing internal IP details.**\n\n## Impact\n\nAttacker can get ports status by fuzzing or intruder attacker based on response time.\nAttacker would be able to target internal services and try to exhaust/target internal infrastructure.","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["prophet","realtess","ms-13","h1-qualys-scan","hallbryght","z3rod3x","mraldersonn"],"severity":{"rating":"high","score":8.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":42403,"asset_type":"URL","asset_identifier":"www.tumblr.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10093748,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. Your report will be reviewed and we'll get back to you shortly.","automated_response":false,"created_at":"2020-12-14T08:59:39.693Z","updated_at":"2020-12-14T08:59:39.693Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10094224,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @atc_h1h1, We offer an internal SSRF-testing endpoint, `ssrf-server.tumblr.net`, for you to use in your reproduction steps and Proof-of-Concepts. It has the following assets:\n- https://ssrf-server.tumblr.net\n- https://ssrf-server.tumblr.net/mp3_audio.mp3\n- https://ssrf-server.tumblr.net/mp4_video.mp4\n- https://ssrf-server.tumblr.net/gif_image.gif\n- https://ssrf-server.tumblr.net/png_image.png\n- https://ssrf-server.tumblr.net/html_document.html\n- https://ssrf-server.tumblr.net/javascript_document.js\n- https://ssrf-server.tumblr.net/text_document.txt\n- https://ssrf-server.tumblr.net/xml_document.xml\n","automated_response":false,"created_at":"2020-12-14T09:11:01.708Z","updated_at":"2020-12-14T09:11:01.708Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10097323,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @xknown,\n\nThank you for the additional information. \n\nHere is the update:\n1. I am not able to hit internal domain (**ssrf-server.tumblr.net**) shared by you. However I am able to hit **tumblr.com**.  So I am not sure how it is not able to hit **tumblr.net**. Not sure how to confirm internal SSRF based on domain **tumblr/net** as it is able to hit **tumlr.com**.\n2. I am able to hit external URLs, so external SSRF is confirmed based on automatic IP address details(74.114.154.11). IP address related details shouldn't be exposed. External SSRF is confirmed.\n\nRegards","automated_response":false,"created_at":"2020-12-14T14:43:34.798Z","updated_at":"2020-12-14T14:44:30.627Z","actor":{"username":"atc_h1h1","cleared":false,"url":"/atc_h1h1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XdLRnHdz17EXjNHGVBybifpc/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10101889,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @atc_h1h1, based on the information you provided, there do not appear to be any security implications as a direct result of this behavior. Furthermore, after speaking with our product team, we have determined that this is the correct product behavior.","automated_response":false,"created_at":"2020-12-14T20:50:39.422Z","updated_at":"2020-12-14T20:50:39.422Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10104868,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @xknown, Thanks for the update. Shall we disclose it!","automated_response":false,"created_at":"2020-12-15T02:48:28.287Z","updated_at":"2020-12-15T02:48:28.287Z","first_to_agree":true,"actor":{"username":"atc_h1h1","cleared":false,"url":"/atc_h1h1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XdLRnHdz17EXjNHGVBybifpc/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10109376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Lets disclose this to help other researchers! I am also planning to put this on my blog. ","automated_response":false,"created_at":"2020-12-15T10:15:11.192Z","updated_at":"2020-12-15T10:15:11.192Z","actor":{"username":"atc_h1h1","cleared":false,"url":"/atc_h1h1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XdLRnHdz17EXjNHGVBybifpc/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10110935,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-15T13:03:15.931Z","updated_at":"2020-12-15T13:03:15.931Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10110936,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-15T13:03:15.998Z","updated_at":"2020-12-15T13:03:15.998Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}