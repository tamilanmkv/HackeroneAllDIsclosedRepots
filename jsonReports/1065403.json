{"id":1065403,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY1NDAz","url":"https://hackerone.com/reports/1065403","title":"Java: QL Query Detector for JHipster Generated CVE-2019-16303","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-12-23T18:42:39.279Z","submitted_at":"2020-12-23T18:42:39.271Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jlleitschuh","url":"/jlleitschuh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":45140,"url":"https://hackerone.com/github-security-lab","handle":"github-security-lab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nE5ZXynECGkNTp3JXDoVJdMD/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/nE5ZXynECGkNTp3JXDoVJdMD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"api_only","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitHub Security Lab","twitter_handle":"ghsecuritylab","website":"https://securitylab.github.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":true,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-23T18:46:20.605Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-12-23T18:46:13.967Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This bug was reported directly to GitHub Security Lab.","bounty_amount":"1800.0","formatted_bounty":"$1,800","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-01-22T18:46:14.035Z","allow_singular_disclosure_after":-22617285.31996687,"singular_disclosure_allowed":true,"vote_count":1,"voters":["ali"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10191640,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":true,"created_at":"2020-12-23T18:42:39.279Z","updated_at":"2020-12-23T18:42:39.279Z","actor":{"username":"api_smut0r5kkc73wyh0oqg0snmj3j","cleared":false,"url":"/api_smut0r5kkc73wyh0oqg0snmj3j","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jlleitschuh","url":"/jlleitschuh"},"genius_execution_id":null,"team_handle":"github-security-lab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10193316,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":true,"created_at":"2020-12-23T18:42:39.339Z","updated_at":"2020-12-23T18:42:39.339Z","actor":{"url":"/github-security-lab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nE5ZXynECGkNTp3JXDoVJdMD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitHub Security Lab"}},"bounty_amount":"1800.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"github-security-lab","collaborator":{"username":"jlleitschuh","url":"/jlleitschuh"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10191685,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-23T18:46:13.977Z","updated_at":"2020-12-23T18:46:13.977Z","first_to_agree":true,"actor":{"username":"xcorail","cleared":false,"url":"/xcorail","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kjmuFCd99F4AumWDUtToLki6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"github-security-lab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10191687,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-12-23T18:46:20.537Z","updated_at":"2020-12-23T18:46:20.537Z","actor":{"username":"xcorail","cleared":false,"url":"/xcorail","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kjmuFCd99F4AumWDUtToLki6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"github-security-lab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":26001,"category":"team","content":"https://github.com/github/securitylab/issues/180","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":1357667,"username":"api_smut0r5kkc73wyh0oqg0snmj3j","name":"9a766df0a0dfef6008f8f222a4888204850cecef9aef8ca7352735156f82d491bd2b7036d2","bio":"","cleared":false,"website":"","location":"","created_at":"2020-10-14T21:16:45.867Z","url":"https://hackerone.com/api_smut0r5kkc73wyh0oqg0snmj3j","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":null,"profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":26006,"category":"researcher","content":"# Discovery\n\nIn September of 2019 I was looking through GitHub's open source projects for uses of insecure random number generation in security sensitive locations.\n\nWhat I quickly discovered was interesting and confusing. I kept finding uses of `RandomStringUtils.randomAlphanumeric` from the apache commons library in use in the exact same way across thousands of projects on GitHub.\n\n```java\n     /** \n      * Generate a password. \n      * \n      * @return the generated password. \n      */ \n     public static String generatePassword() { \n         return RandomStringUtils.randomAlphanumeric(DEF_COUNT); \n     } \n  \n     /** \n      * Generate an activation key. \n      * \n      * @return the generated activation key. \n      */ \n     public static String generateActivationKey() { \n         return RandomStringUtils.randomNumeric(DEF_COUNT); \n     } \n  \n     /** \n      * Generate a reset key. \n      * \n      * @return the generated reset key. \n      */ \n     public static String generateResetKey() { \n         return RandomStringUtils.randomNumeric(DEF_COUNT); \n     } \n```\n\nThe problem with this code is that `RandomStringUtils` relies upon an insecure random number generator for it's source of randomness. Thus, if an attacker is able to determine one password reset key, they can determine what other randomness the server will also generate.\n\nI tracked down the source of this vulnerability to a code generation project called [JHipster Generator](https://www.jhipster.tech/). After reporting this vulnerability to them, the JHipster team awarded me a [$500 bounty for my vulnerability disclosure](https://github.com/jhipster/generator-jhipster/issues/10401). This was and continues to be the first and only time that a fully open source project not actively maintained by a parent company has awarded me directly for my open source security research. \n\nFor that vulnerability, a CVE was assigned and the vulnerability was disclosed.\n\n# Enter CodeQL and the GitHub Security Lab\n\nGitHub acquires Semmle in September of 2019 and soon after announces the beginning of this BB program.\n\nSince a code generator created this vulnerability, writing a CodeQL query to detect this vulnerability didn't seem all that difficult. It was something that was kicking around my head for a while but took me until earlier this year to finally get around to writing the query. The query and accompanying PR for this submission can be found on [GitHub here](https://github.com/github/codeql/pull/4312).\n\n\n# Part 1 or 2\n\nThis story continues on this [second hacker one report ](https://hackerone.com/reports/1065402).","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":388267,"username":"jlleitschuh","name":"Jonathan Leitschuh","bio":"Software Engineer @ Gradle Inc.","cleared":false,"website":"https://twitter.com/JLLeitschuh","location":"New England","created_at":"2018-10-27T03:04:35.078Z","url":"https://hackerone.com/jlleitschuh","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}