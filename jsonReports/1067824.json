{"id":1067824,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY3ODI0","url":"https://hackerone.com/reports/1067824","title":"Database error shown to the user when using a long guest name in richdocuments","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-12-28T22:33:09.651Z","submitted_at":"2020-12-28T22:33:09.675Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hitman_47","url":"/hitman_47","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-02-07T07:55:38.116Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-01-08T07:55:29.958Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When sharing a file to a guest and the file is allow for editing, the user is asked to enter a guestname if you enter a really long value for that name you get a database error that displays sensitive information:\n\nAn exception occurred while executing 'INSERT INTO `oc_richdocuments_wopi`(`fileid`,`owner_uid`,`version`,`canwrite`,`server_host`,`token`,`expiry`,`guest_displayname`,`template_destination`,`hide_download`,`direct`,`is_remote_token`,`template_id`,`share`) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?)' with params [8606022, \"8JaQyYP5xM7w2PJ6\", 0, true, \"https:\\/\\/demo2.nextcloud.com\\/\", \"hUYL4uh9Dals51BoAT2YA7WZ1IJMaCLp\", 1609196332, \"reallylongnameeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee (Guest)\", 0, false, false, false, 0, \"c4A53CW6wAN2ZZa\"]: SQLSTATE[22001]: String data, right truncated: 1406 Data too long for column 'guest_displayname' at row 1\n\nDemo\n{F1133198}\n\n## Impact\n\nInformation Disclosure","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1133198,"file_name":"recording-1609194562161.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dw81hzxfgm7t0cff2var6rlx1jhm?response-content-disposition=attachment%3B%20filename%3D%22recording-1609194562161.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1609194562161.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ76PP2BUX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132141Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGHP7cIwt2Tsf8KjliDyT5Lb7ly0JskiaYe2ChAX3AmbAiAqtHMw8uLFecT9g9U5UE%2FCxE1a%2BtPZJAnSYYnH2BI8piqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMzMSFx2nvHLNo5SLgKtcDcW%2FgFn8cU0mgC1%2FVdGfTPYSBsMiGZbBVEFWLz7BIkAjvx1Yl0xNwccsia5mxGh5Pof1BmLOj%2FPbfN0yxfjTbBvX%2BtxFisFe4lleD7sAfIMQHgrItYYlJlrAkcGTOF0hj5oy17q8C901VMWg1M3Oq1DUHqNUDjNiOuNs3pYI8%2F%2FpJPSaJwkT0kt%2FgzY3%2FaZ0aVY4K5doqZxp2VxJBM6CwnM47o6IbMvH%2F6hCdkC2dfUYQhPAa%2FygUp%2Fmm%2FrBM1LnDwRHK5mENZHzc9lNN77yHKCN1H3z9bi6t%2FdgHvkJFjucgPEBep99zqb1GTqjJfJh62po7%2FS6VgiubeoT%2ByWP%2FtbqeYVZAMxxgiX1mB4dTzOp9zUHuTJ5nixo2KbV6zjXbuM3CsrhUAywRCeq1ysa5sihESBZMzWy4KTeSnnVgA3YGSpb6bjYVcuyXShrdtMdh%2Bi%2Fut350eVReQuhtta9UeSQASWy1DEqou8oW6%2BWrK%2Fu8ty%2Bdy03u84XY3jIFi15g20CivixBXwDrJq5GMnahFYcvlzz%2FNfvLxBKnaZyOEiCkM%2BOhX4C4%2BLxcdNS1%2B%2FJZkMdX5isJd3PLZxJ0Za4ah4jaZUkoTXoWEByAePJ%2FcQ2oGnMS56ZNMLTgkIsGOqYBDJcz6RvFiMKVMfgvSf0yaXoPP4o%2BD%2Fa8JI%2BvkanDoFK0GH2rrIW6QMEbvg1sbDA%2B9VmM8kFxkCwfS%2F888Z5ykzUXec2dE5NYyugHVg5stjEJdkzVfFm30TsJCuULkIUdUPpiclOA72MSSbJsTlChJhjuLyQb8nARpH6iLndWaVXQjXW0hsGl9kRoYIkectIjPcMElLSYn47zPkurLskrWPNIcaHBlw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9e314240d1797991ac8f0fdf42b66cbd4fc0f0b9a01cc7ae7b15634c0c1e39be","file_size":9273290,"type":"video/webm"}],"allow_singular_disclosure_at":"2021-02-07T07:55:30.041Z","allow_singular_disclosure_after":-21273971.22019566,"singular_disclosure_allowed":true,"vote_count":28,"voters":["bibekshah","ali","yassinek3ch","0xelkomy","1337fenrir","dilawer01","demonia","dastan_9408","khizer47","h4x0r_dz","and 18 more..."],"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10223576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2020-12-28T22:33:10.147Z","updated_at":"2020-12-28T22:33:10.147Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10223667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So to be clear the error is showing all the content for that row in the table plus the database columns and the name of the table. ","automated_response":false,"created_at":"2020-12-28T22:53:45.632Z","updated_at":"2020-12-28T22:53:45.632Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10223791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually, it seems this only applies to odt files or rich text files, not just any file. The prompt for the user to enter a guest name will only happen with those files. ","automated_response":false,"created_at":"2020-12-28T23:39:53.939Z","updated_at":"2020-12-28T23:40:50.865Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10263941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, Happy new year!, what do you think about this issue? , I don't think in this case there's anything critical or high severity being disclosed but it does seem like information a guest user shouldn't know ","automated_response":false,"created_at":"2021-01-04T15:09:54.816Z","updated_at":"2021-01-04T15:09:54.816Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10264013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah the bug is from the office editor, so it only happens with files that are opened with that.\n\nAlso note that the demo servers run in debug mode and error details should‚Ñ¢Ô∏è only be revealed while debug mode is on, but I will check that in a second.","automated_response":false,"created_at":"2021-01-04T15:14:11.971Z","updated_at":"2021-01-04T15:14:11.971Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10264401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, seems to always print the exception message because it is catching it before.\nPR is at https://github.com/nextcloud/richdocuments/pull/1303\n","automated_response":false,"created_at":"2021-01-04T15:48:12.159Z","updated_at":"2021-01-04T15:48:12.159Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10264413,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2021-01-04T15:48:54.458Z","updated_at":"2021-01-04T15:48:54.458Z","additional_data":{"old_title":"Information disclosure on database error","new_title":"Database error shown to the user when using a long guest name in richdocuments"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10264433,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-01-04T15:50:08.522Z","updated_at":"2021-01-04T15:50:08.522Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10264448,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"The richdocuments app is not within the scope of this program, so we can not offer rewards.","automated_response":false,"created_at":"2021-01-04T15:50:43.362Z","updated_at":"2021-01-04T15:50:43.362Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10264494,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update. No problem about the rewards.","automated_response":false,"created_at":"2021-01-04T15:53:38.647Z","updated_at":"2021-01-04T15:53:38.647Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10272350,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our next maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2021-01-05T09:23:55.571Z","updated_at":"2021-01-05T09:23:55.571Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hitman_47","url":"/hitman_47"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10275120,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, I can be credited as Tommy Suriel","automated_response":false,"created_at":"2021-01-05T14:00:07.290Z","updated_at":"2021-01-05T14:00:07.290Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10302389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh sorry I mixed it up. The richdocuments app is not part of the program, so we don't write an SA üôà","automated_response":false,"created_at":"2021-01-08T07:55:03.739Z","updated_at":"2021-01-08T07:55:03.739Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10302390,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-08T07:55:29.980Z","updated_at":"2021-01-08T07:55:29.980Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10305695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh ok, no problem.","automated_response":false,"created_at":"2021-01-08T13:49:28.205Z","updated_at":"2021-01-08T13:49:28.205Z","actor":{"username":"hitman_47","cleared":false,"url":"/hitman_47","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KKToEm4ceuWpEmuv6Lh1SXpn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10601221,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-02-07T07:55:38.146Z","updated_at":"2021-02-07T07:55:38.146Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}