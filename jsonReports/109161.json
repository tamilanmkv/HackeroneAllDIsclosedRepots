{"id":109161,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDkxNjE=","url":"https://hackerone.com/reports/109161","title":"protect against tabnabbing in statement","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-01-07T23:47:57.495Z","submitted_at":"2016-01-07T23:47:57.495Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"atom","url":"/atom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/825/0abb184a7c4a17d1a1bf2ef242c7d5d9d5fbba50_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-01T12:39:17.527Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-09-13T18:11:33.572Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nwhen we include a link on statement in our profile, it just create an html tag like this:\n``` \u003ca href=\"http://google.com\"\u003ehttp://google.com\u003c/a\u003e ```\n^ That's vulnerable. How? Once the owner of the profile added a malicious url it is possible that the link has a referral link thingy that will open a tab that has a phishping page of  gratipay.\n\nFix:\n``` \u003ca href=\"http://google.com\" rel=\"nofollow\"\u003ehttp://google.com\u003c/a\u003e ```\n\nAllan","bounty_amount":"10.0","formatted_bounty":"$10","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-13T18:11:33.769Z","allow_singular_disclosure_after":-126040345.60439461,"singular_disclosure_allowed":true,"vote_count":7,"voters":["sameerphad72","cuso4","akaash_pantherdefence","eveeez","r3y","khizer47","flex0geek"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":748743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @atom,\n\nThank you for the report.\nWe are discussing this internally. I'll let you know once i have something for you.\n\nRegards,","automated_response":false,"created_at":"2016-01-08T08:52:13.537Z","updated_at":"2016-01-08T08:52:13.537Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":748751,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-01-08T08:57:39.664Z","updated_at":"2016-01-08T08:57:39.664Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":749208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@atom Thanks for the report!\n\n\u003e Once the owner of the profile added a malicious url it is possible that the link has a referral link thingy that will open a tab that has a phishping page of gratipay.\n\nCan you explain more, please? What is \"a referral link thingy\" and how does `rel=\"nofollow\"` mitigate it?","automated_response":false,"created_at":"2016-01-08T14:26:30.293Z","updated_at":"2016-01-08T14:26:30.293Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":749990,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the scenario of this attack and how the tabnabbing works:\n\n1. Attacker put a malicious link on his statement.\n2. Once the victim clicks the link, it will be redirected to the malicious link but the malicious link has a malicious code inside that makes an action that it should do something to referral(where it came from before redirection) then the referral is gratipay. Using the malicious code, the malicious code will refresh the gratipay site to a fake gratipay site that will ask for sign in details like that.\n\n``` rel=\"nofollow\" ``` is not fix for this issue (sorry)\nIt is ```rel=\"noreferrer\"``` \nSetting this on user provided links provides protection against this kind of attack. The cost of this solution is that the referring site won't show up as referrer in analytics on the referred sites.","automated_response":false,"created_at":"2016-01-08T21:01:13.344Z","updated_at":"2016-01-08T21:01:13.344Z","actor":{"username":"atom","cleared":false,"url":"/atom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/825/0abb184a7c4a17d1a1bf2ef242c7d5d9d5fbba50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":844491,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Classifying as mild severity, which carries a $10 bounty per [our policy](https://hackerone.com/gratipay).","automated_response":false,"created_at":"2016-03-17T03:54:35.932Z","updated_at":"2016-03-17T03:54:35.932Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"bounty_amount":"10.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"atom","url":"/atom"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883390,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-04-01T17:45:26.404Z","updated_at":"2016-04-01T17:45:26.404Z","additional_data":{"old_title":"Statement on Profile is vulnerable to TabNabbing","new_title":"protect against tabnabbing in statement"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1072326,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-07-16T23:29:42.827Z","updated_at":"2016-07-16T23:29:42.827Z","additional_data":{"duplicate_report_id":151831},"actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340136,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-04T19:22:44.058Z","updated_at":"2016-12-04T19:22:44.058Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":11555},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1994957,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The main issue has been resolved in https://github.com/gratipay/gratipay.com/pull/4620#issuecomment-329243737.","automated_response":false,"created_at":"2017-09-13T18:11:23.283Z","updated_at":"2017-09-13T18:11:23.283Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"atom","url":"/atom"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1994958,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-13T18:11:33.693Z","updated_at":"2017-09-13T18:11:33.693Z","first_to_agree":true,"actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2036446,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-10-01T12:39:17.507Z","updated_at":"2017-10-01T12:39:17.507Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}