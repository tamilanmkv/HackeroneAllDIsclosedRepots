{"id":1101882,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTAxODgy","url":"https://hackerone.com/reports/1101882","title":"CVE-2021-22876: Automatic referer leaks credentials","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2021-02-12T01:08:34.999Z","submitted_at":"2021-02-12T01:08:35.028Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vsz","url":"/vsz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-22876"],"singular_disclosure_disabled":false,"disclosed_at":"2021-04-30T06:02:48.552Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-03-31T06:02:48.058Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nWhen using the `--referer ';auto'` feature the current URL is copied as-is to the referrer header of the subsequent request. The recommendation [1] is to strip these (along with the URL fragment). I can imagine this may, in rare cases, result in unwanted/unexpected disclosure of credentials (e.g. them appearing in 3rd party web server logs), though the overall chances seem low (also considering that ';auto', by hunch, is likely not a widely used curl feature).\n\n[1] https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer#directives\n\n## Steps To Reproduce:\n```\n$ curl -svLe ';auto' 'https://user:pass@curl.haxx.se#frag'  2\u003e\u00261 \u003e/dev/null | grep -i Referer:\n```\n\n## Supporting Material/References:\n```\n$ curl -V                                                                                                \ncurl 7.64.1 (x86_64-apple-darwin19.0) libcurl/7.64.1 (SecureTransport) LibreSSL/2.8.3 zlib/1.2.11 nghttp2/1.39.2\nRelease-Date: 2019-03-27\nProtocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtsp smb smbs smtp smtps telnet tftp \nFeatures: AsynchDNS GSS-API HTTP2 HTTPS-proxy IPv6 Kerberos Largefile libz MultiSSL NTLM NTLM_WB SPNEGO SSL UnixSockets\n```\n\n## Patch that fixes it\n```diff\ndiff --git a/lib/transfer.c b/lib/transfer.c\nindex c3b2d11a2..f63aadbaf 100644\n--- a/lib/transfer.c\n+++ b/lib/transfer.c\n@@ -1567,6 +1567,9 @@ CURLcode Curl_follow(struct Curl_easy *data,\n       data-\u003estate.followlocation++; /* count location-followers */\n \n       if(data-\u003eset.http_auto_referer) {\n+        CURLU *h;\n+        char *url;\n+\n         /* We are asked to automatically set the previous URL as the referer\n            when we get the next URL. We pick the -\u003eurl field, which may or may\n            not be 100% correct */\n@@ -1576,7 +1579,40 @@ CURLcode Curl_follow(struct Curl_easy *data,\n           data-\u003echange.referer_alloc = FALSE;\n         }\n \n-        data-\u003echange.referer = strdup(data-\u003echange.url);\n+        /* Make a copy of the URL without the crenditals and fragment */\n+        h = curl_url();\n+        if(!h)\n+          return CURLE_OUT_OF_MEMORY;\n+\n+        uc = curl_url_set(h, CURLUPART_URL, data-\u003echange.url, 0);\n+        if(uc) {\n+          curl_url_cleanup(h);\n+          return CURLE_OUT_OF_MEMORY;\n+        }\n+        uc = curl_url_set(h, CURLUPART_FRAGMENT, NULL, 0);\n+        if(uc) {\n+          curl_url_cleanup(h);\n+          return CURLE_OUT_OF_MEMORY;\n+        }\n+        uc = curl_url_set(h, CURLUPART_USER, NULL, 0);\n+        if(uc) {\n+          curl_url_cleanup(h);\n+          return CURLE_OUT_OF_MEMORY;\n+        }\n+        uc = curl_url_set(h, CURLUPART_PASSWORD, NULL, 0);\n+        if(uc) {\n+          curl_url_cleanup(h);\n+          return CURLE_OUT_OF_MEMORY;\n+        }\n+        uc = curl_url_get(h, CURLUPART_URL, \u0026url, 0);\n+        if(uc) {\n+          curl_url_cleanup(h);\n+          return CURLE_OUT_OF_MEMORY;\n+        }\n+\n+        curl_url_cleanup(h);\n+\n+        data-\u003echange.referer = url;\n         if(!data-\u003echange.referer)\n           return CURLE_OUT_OF_MEMORY;\n         data-\u003echange.referer_alloc = TRUE; /* yes, free this later */\n```\n\nI'm ready to continue this in a public PR if it seems more fitting.\n\n## Impact\n\nThe best I can think of is if an attacker gets hold of web server logs that includer referrer info with credentials leaked into them. It's a privacy/sensitive info-leak vulnerability at best. Can't readily think of a way to actively exploit this.","bounty_amount":"800.0","formatted_bounty":"$800","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-04-30T06:02:48.131Z","allow_singular_disclosure_after":-14196108.805288026,"singular_disclosure_allowed":true,"vote_count":5,"voters":["demonia","sa1tama0","meispi","krishanusharma123","ekgaribadmi"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10651973,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2021-02-12T01:09:04.159Z","updated_at":"2021-02-12T01:09:04.159Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"https://github.com/curl/curl","genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10652973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report. I think I agree that this needs to be treated as a security issue.","automated_response":false,"created_at":"2021-02-12T07:10:06.487Z","updated_at":"2021-02-12T07:10:06.487Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10653037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To reduce the number of cleanup + returns in that code, maybe it could be written like this:\n\n~~~c\n  uc = curl_url_set(h, CURLUPART_URL, data-\u003echange.url, 0);\n  if(!uc)\n    uc = curl_url_set(h, CURLUPART_FRAGMENT, NULL, 0);\n  if(!uc)\n    uc = curl_url_set(h, CURLUPART_USER, NULL, 0);\n  if(!uc)\n    uc = curl_url_set(h, CURLUPART_PASSWORD, NULL, 0);\n  if(!uc)\n    uc = curl_url_get(h, CURLUPART_URL, \u0026url, 0);\n  if(uc) {\n    curl_url_cleanup(h);\n    return CURLE_OUT_OF_MEMORY;\n  }\n\n  curl_url_cleanup(h);\n ","automated_response":false,"created_at":"2021-02-12T07:33:53.506Z","updated_at":"2021-02-12T07:33:53.506Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10654228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for looking into this. This is indeed a much cleaner way to code it. Also made a successful test with it.","automated_response":false,"created_at":"2021-02-12T10:47:55.344Z","updated_at":"2021-02-12T10:47:55.344Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10658740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This flaw was introduced here: https://github.com/curl/curl/commit/f30ffef477, landed in curl 7.1.1. Released on August 21 2000...","automated_response":false,"created_at":"2021-02-12T16:30:15.147Z","updated_at":"2021-02-12T16:30:15.147Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10658975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since this issue has been around for two decades and is in a fairly unused feature, I don't think we need to rush out a fix for this. I propose we publish the fix and advisory coordinated with the scheduled 7.76.0 release on March 31, 2021.","automated_response":false,"created_at":"2021-02-12T16:34:10.205Z","updated_at":"2021-02-12T16:34:10.205Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10659789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agreed, this sounds reasonable.\n\nSlighly (un)related (and not a security issue), it may also make sense to skip setting the initial referrer value if it is empty, e.g. with the input value ';auto'. Not sure if this counts as breaking change, but assigning an empty value to the referrer header doesn't seem to give much benefit over just omitting it. Patch:\n```\ndiff --git a/src/tool_getparam.c b/src/tool_getparam.c\nindex d187643a7..0e82b3c8b 100644\n--- a/src/tool_getparam.c\n+++ b/src/tool_getparam.c\n@@ -1545,7 +1545,8 @@ ParameterError getparameter(const char *flag, /* f or -long-flag */\n       }\n       else\n         config-\u003eautoreferer = FALSE;\n-      GetStr(\u0026config-\u003ereferer, nextarg);\n+      if(*nextarg)\n+        GetStr(\u0026config-\u003ereferer, nextarg);\n     }\n     break;\n     case 'E':\n```\n","automated_response":false,"created_at":"2021-02-12T17:21:07.720Z","updated_at":"2021-02-12T17:21:07.720Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10659833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, I think that's sensible.","automated_response":false,"created_at":"2021-02-12T17:24:47.392Z","updated_at":"2021-02-12T17:24:47.392Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10669117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vsz the blank referer thing can probably be taken as a separate PR using the usual methods\n\nIf/when you have a complete patch for this security issue, feel free to attach it here and I can merge that to master when the time comes. (48 hours before release, according to our process)\n\nI'll get a first draft of a security advisory done soonish and post here.","automated_response":false,"created_at":"2021-02-14T10:50:14.089Z","updated_at":"2021-02-14T10:50:14.089Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10687695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's my first take at an advisory for this issue.\n\n----\n\nAutomatic referer leaks credentials\n===================================\n\nProject curl Security Advisory, March 31st 2021 -\n[Permalink](https://curl.se/docs/CVE-2021-XXXX.html)\n\nVULNERABILITY\n-------------\n\nlibcurl does not strip off user credentials from the URL when automatically\npopulating the `Referer:` HTTP request header field in outgoing HTTP requests,\nand therefore risks leaking sensitive data to the server that is the target of\nthe second HTTP request.\n\nlibcurl automatically sets the `Referer:` HTTP request header field in\noutgoing HTTP requests if the `CURLOPT_AUTOREFERER` option is set. With the\ncurl tool, it is enabled with `--referer \";auto\"`.\n\nWe are not aware of any exploit of this flaw.\n\nINFO\n----\n\nThis flaw has existed in libcurl since commit\n[f30ffef477](https://github.com/curl/curl/commit/f30ffef477) in libcurl 7.1.1,\nreleased on August 21, 2000.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\nCVE-2021-XXXX to this issue.\n\nCWE-359: Exposure of Private Personal Information to an Unauthorized Actor\n\nSeverity: Low\n\nAFFECTED VERSIONS\n-----------------\n\n- Affected versions: libcurl 7.1.1 to and including 7.75.0\n- Not affected versions: libcurl \u003c 7.1.1 and libcurl \u003e= 7.76.0\n\nAlso note that libcurl is used by many applications, and not always\nadvertised as such.\n\nTHE SOLUTION\n------------\n\nIf a provided URL contains credentials, they will be blanked out before the\nURL is used to populate the header field.\n\nA [fix for CVE-2021-XXXX](insert link)\n\nRECOMMENDATIONS\n--------------\n\nWe suggest you take one of the following actions immediately, in order of\npreference:\n\n A - Upgrade libcurl to version 7.76.0\n\n B - Apply the patch to your local version\n\n C - Avoid `CURLOPT_AUTOREFERER` and `--referer \";auto\"`,\n \nTIMELINE\n--------\n\nThis issue was reported to the curl project on February 12, 2021.\n\nThis advisory was posted on March 31st 2021.\n\nCREDITS\n-------\n\nThis issue was reported and patched by Viktor Szakats.\n\nThanks a lot!\n","automated_response":false,"created_at":"2021-02-16T16:06:51.415Z","updated_at":"2021-02-16T16:06:51.415Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10689604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @bagder!\n\nI've committed the empty-referrer patch:\nhttps://github.com/curl/curl/commit/cdb630655db39ff1a319ace871e75389072deeb9\n\nRegarding this one, here an updated (slightly further simplified) patch\n```diff\ndiff --git a/lib/transfer.c b/lib/transfer.c\nindex ae414cfc5..2ad79a57c 100644\n--- a/lib/transfer.c\n+++ b/lib/transfer.c\n@@ -1581,6 +1581,9 @@ CURLcode Curl_follow(struct Curl_easy *data,\n       data-\u003estate.followlocation++; /* count location-followers */\n \n       if(data-\u003eset.http_auto_referer) {\n+        CURLU *u;\n+        char *referer;\n+\n         /* We are asked to automatically set the previous URL as the referer\n            when we get the next URL. We pick the -\u003eurl field, which may or may\n            not be 100% correct */\n@@ -1590,9 +1593,27 @@ CURLcode Curl_follow(struct Curl_easy *data,\n           data-\u003echange.referer_alloc = FALSE;\n         }\n \n-        data-\u003echange.referer = strdup(data-\u003echange.url);\n-        if(!data-\u003echange.referer)\n+        /* Make a copy of the URL without crenditals and fragment */\n+        u = curl_url();\n+        if(!u)\n+          return CURLE_OUT_OF_MEMORY;\n+\n+        uc = curl_url_set(u, CURLUPART_URL, data-\u003echange.url, 0);\n+        if(!uc)\n+          uc = curl_url_set(u, CURLUPART_FRAGMENT, NULL, 0);\n+        if(!uc)\n+          uc = curl_url_set(u, CURLUPART_USER, NULL, 0);\n+        if(!uc)\n+          uc = curl_url_set(u, CURLUPART_PASSWORD, NULL, 0);\n+        if(!uc)\n+          uc = curl_url_get(u, CURLUPART_URL, \u0026referer, 0);\n+\n+        curl_url_cleanup(u);\n+\n+        if(uc || referer == NULL)\n           return CURLE_OUT_OF_MEMORY;\n+\n+        data-\u003echange.referer = referer;\n         data-\u003echange.referer_alloc = TRUE; /* yes, free this later */\n       }\n     }\n```\n\nIt checks out okay in a limited local test, but I'd appreciate taking a critical eye on it.","automated_response":false,"created_at":"2021-02-16T18:50:34.592Z","updated_at":"2021-02-16T18:50:34.592Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10689637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your write-up looks spot on to me.üëç","automated_response":false,"created_at":"2021-02-16T18:53:42.868Z","updated_at":"2021-02-16T18:53:42.868Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10754622,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vsz do you have a test case that verifies the strip-credentials-from-referer functionality after this fix or do you want me to make one?","automated_response":false,"created_at":"2021-02-23T13:54:19.977Z","updated_at":"2021-02-23T13:54:19.977Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10773119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bagder: Hi Daniel, please find my attempt attached. It does the job of testing this, but it's quite possibly not the most minimal or ideal/perfect iteration. Tried to change '1080' (the test I used as a base for this) to other numbers, but got failures, so I'm still missing some details here). I hope it helps anyway!\n","automated_response":false,"created_at":"2021-02-24T21:17:07.162Z","updated_at":"2021-02-24T21:17:07.162Z","actor":{"username":"vsz","cleared":false,"url":"/vsz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/643/721/fde2d78348b717d0e9e169e1803f95a73bdb21b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1208224,"filename":"test9999","type":"application/octet-stream","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/n9okhwlbie33ox4zj5j38enyfk9v?response-content-disposition=attachment%3B%20filename%3D%22test9999%22%3B%20filename%2A%3DUTF-8%27%27test9999\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132437Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=538b28ade9705fe1b09e514a92c945722b6b262b0115f962b999b5a7f4e90311"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10786272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks excellent to me. Thanks!","automated_response":false,"created_at":"2021-02-25T12:00:28.320Z","updated_at":"2021-02-25T12:00:28.320Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10809747,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I made it into test2081 in my local branch and updated it slightly to use that number internally as well. Works with the patch, fails without it.","automated_response":false,"created_at":"2021-02-26T07:05:45.992Z","updated_at":"2021-02-26T07:05:45.992Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1209820,"filename":"test2081","type":"application/octet-stream","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hs54twog0vlfk0g8y636jry78j1r?response-content-disposition=attachment%3B%20filename%3D%22test2081%22%3B%20filename%2A%3DUTF-8%27%27test2081\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132437Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=74a1710ae6ba772aa660f053f196221818ae930e6b983ef278ecc42a92b19123"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10910960,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-03-08T08:34:23.487Z","updated_at":"2021-03-08T08:34:23.487Z","cve_ids":["CVE-2021-22876"],"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10910974,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2021-03-08T08:34:49.426Z","updated_at":"2021-03-08T08:34:49.426Z","additional_data":{"old_title":"curl -L --referer ';auto' https://user:pass@example.com includes credentials in referrer when following redirects","new_title":"CVE-2021-22876: Automatic referer leaks credentials"},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10923623,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The curl security team has decided to reward hacker @vsz  with the amount of 800 USD for finding and reporting this issue. Many thanks for your great work!","automated_response":false,"created_at":"2021-03-08T21:49:04.446Z","updated_at":"2021-03-08T21:49:04.446Z","actor":{"url":"/curl","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"curl"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"curl","collaborator":{"username":"vsz","url":"/vsz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10945801,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is now just waiting for publication.","automated_response":false,"created_at":"2021-03-10T13:41:01.130Z","updated_at":"2021-03-10T13:41:01.130Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11193235,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-03-31T06:02:37.518Z","updated_at":"2021-03-31T06:02:37.518Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"vsz","url":"/vsz"},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11193237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-31T06:02:48.072Z","updated_at":"2021-03-31T06:02:48.072Z","first_to_agree":true,"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSH757YA2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132436Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIF9aqUhLetvML58mN4ogxy%2B6UPAqSKeMxtrKXgCruxpyAiAZA4LyH08LiK63%2BX3j%2FL%2BE8K04lFCAfpkj2U3L%2F%2BQ0JiqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMPZUukqFla3jg3W%2FAKtcDd88OJINrkl7oo%2BDUkLwt6ub0eHL%2FOpOUpfWlA1Tbc4efx1n1oBI%2B782zqkT%2FldKyEkGMp9Cul2tobYxJfnwMz94jkctq%2FsU%2F%2FsKu2u4wJOSL%2FhvUUC%2B9dp45qZlfD69Bsxw4jQBxwq9J8VXp7mEHR0cbPtfww3zed%2BrCOrnLZ6WBmxu6LKSVMCkUhYQm4EiPnez%2F%2BYYVx4AE2%2BbmbWrewptlfyoDdDbyAyfrq8ppNQP%2BSsMbx3AzwuED6a4C5Ya%2Fdm4tvhTG%2F0BUmosdYLHOziWnvsJpEceS7siWOsUUfupiOHUkWueayqYg0pmTBcnvdmB5rtzHIj0f2kXDYFsf9IfYISyRCniiEFFT6gEnN8n6KJJe%2B5kjqIxzIeZnI0Em9oDQCZNpEcFyD5U%2BzPSV1Pbpjn%2BlPGwKacEk1aO6qQjd%2FHZxtQwWd4GzIN6emwVGDYc1paF8W2MQmpSdcXM5T2QlwouBtY1bW61Q%2BNePDl1OQXIhUF5ROSV%2BKnJ1I49w5PGrTXPk9zOCQ0kt%2BJHgSxdAVo5zPOiGwk6FxcOMM%2BSM%2BhB4T29cxb8GeuOCIC9TRrVbKKZ6XDPDM2WqvCWH6Jjp9Hd9yDZiOP%2FWzkaVd82x0UOYQxT3MOPSkIsGOqYBz3ul30JH9OvCSPYzPeCTIBpZTInOnLX5bhiDKmHJWhMstXLQTLPoVlUbg9pGF3Y%2Bn1xSdW1bFES8JWXDl9x82qGMnPWOSQ54RiaN4omqCUXa4mFgetTXSuxwLVSJ%2Fi7QI9UyvZ9RwnLX5Flf8%2FJDbb6PDowZ5LaC786wrj6gOPmdLWaLB1lp13l%2BSWHU7pqATocJ2a%2B0QX99cjPRF0McSf7VWk%2Fbfw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=278d40a780e22a872653cd1c7e7054c39da8464431b1627fa32b6a881f7f60df"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11573874,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-30T06:02:48.591Z","updated_at":"2021-04-30T06:02:48.591Z","actor":{"url":"/curl","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"curl"}},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}