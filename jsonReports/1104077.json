{"id":1104077,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA0MDc3","url":"https://hackerone.com/reports/1104077","title":"Round-trip instability in REXML","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-02-16T08:10:08.579Z","submitted_at":"2021-02-16T08:10:08.618Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jupenur","url":"/jupenur","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-28965"],"singular_disclosure_disabled":false,"disclosed_at":"2021-04-15T09:44:48.486Z","bug_reporter_agreed_on_going_public_at":"2021-04-15T09:44:48.396Z","team_member_agreed_on_going_public_at":"2021-04-07T11:43:45.991Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Submitted previously via email to security@ruby-lang.org due to REXML not being listed under in-scope assets here. Explicitly requested by @hsbt to re-submit through HackerOne.**\n\n**CVSS rating calculated based on confirmed downstream impact.**\n\n---\n\nHi Ruby Security Team,\n\nI'm reaching out to you to report a vulnerability in REXML that renders downstream use-cases susceptible to varying degrees of tampering.\n\nConceptually the vulnerability is similar to Go encoding/xml bugs publicly disclosed in December. For context, high-level descriptions of those vulnerabilities can be found in the blog post at https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/ and in the advisories it references.\n\nIn the case of REXML, the specific vulnerability is best explained using a code example:\n\n```Ruby\nrequire 'rexml/document'\n\ndoc = REXML::Document.new \u003c\u003cXML\n\u003c!DOCTYPE x [ \u003c!NOTATION x SYSTEM 'x\"\u003e]\u003e\u003c!--'\u003e ]\u003e\n\u003cX\u003e\n  \u003cY/\u003e\u003c![CDATA[--\u003e\u003cX\u003e\u003cZ/\u003e\u003c!--]]\u003e--\u003e\n\u003c/X\u003e\nXML\n\nputs \"First child in original doc: \" + doc.root.elements[1].name\ndoc = REXML::Document.new doc.to_s\nputs \"First child after round-trip: \" + doc.root.elements[1].name\n```\n\nThis program prints two lines of text:\n\n```\nFirst child in original doc: Y\nFirst child after round-trip: Z\n```\n\nThe output demonstrates how the structure of an XML document can change when parsed and serialized using REXML. The expected output from a well-behaving parser would be such where both lines end with \"Y\".\n\nRegards,\n\nJuho Nurminen\nStaff Product Security Engineer, Mattermost, Inc.\n\n## Impact\n\nThe impact of XML round-trip issues can vary significantly depending on context. SAML implementations affected by such issues can allow authentication bypasses and privilege escalation. SOAP endpoints can allow circumventing business logic or access controls. And in general XML processing loses integrity guarantees.\n\n**We are aware of a major SAML implementation affected by this vulnerability**, resulting in critical impact in all applications that rely on it. The vulnerability has not been reported to the downstream maintainers since it is an issue in REXML.","bounty_amount":"500.0","formatted_bounty":"$500","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-05-07T11:43:46.111Z","allow_singular_disclosure_after":-13570862.48523172,"singular_disclosure_allowed":true,"vote_count":19,"voters":["joernchen","battle_angel","foobar7","prakash142","nikitastupin","demonia","xaleraf4ra","t3chnophil3","sg_1","white_evil","and 9 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10681210,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-02-16T08:11:47.849Z","updated_at":"2021-02-16T08:11:47.849Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10692276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report!\nCould you try the attached patch?","automated_response":false,"created_at":"2021-02-17T00:52:45.947Z","updated_at":"2021-02-17T00:52:45.947Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1198177,"filename":"sec-1104077.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2f6tdcjsmktodizow5yzdga78oni?response-content-disposition=attachment%3B%20filename%3D%22sec-1104077.diff%22%3B%20filename%2A%3DUTF-8%27%27sec-1104077.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0ee8aa2349c272f32b4c130f8597e11cd061b56391cf88dfbe247495f8380390"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10694489,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\nI think you missed a couple of cases. These tests fail:\n\n```Ruby\n    def test_pubid_double_quote_roundtrip\n      doc = REXML::Document.new(\u003c\u003c-XML)\n      \u003c!DOCTYPE x [ \u003c!NOTATION x PUBLIC 'x\"\u003e]\u003e\u003c!--'\u003e ]\u003e\n      \u003cX\u003e\n        \u003cY/\u003e\u003c![CDATA[--\u003e\u003cX\u003e\u003cZ/\u003e\u003c!--]]\u003e--\u003e\n      \u003c/X\u003e\n      XML\n      \n      assert_equal(\"Y\", doc.root.elements[1].name)\n      doc = REXML::Document.new doc.to_s\n      assert_equal(\"Y\", doc.root.elements[1].name)\n    end\n\n    def test_system_apostrophe_double_quote_roundtrip\n      doc = REXML::Document.new(\u003c\u003c-XML)\n      \u003c!DOCTYPE x [ \u003c!NOTATION x SYSTEM 'x'\"\u003e]\u003e\u003c!--'\u003e ]\u003e\n      \u003cX\u003e\n        \u003cY/\u003e\u003c![CDATA[--\u003e\u003cX\u003e\u003cZ/\u003e\u003c!--]]\u003e--\u003e\n      \u003c/X\u003e\n      XML\n      \n      assert_equal(\"Y\", doc.root.elements[1].name)\n      doc = REXML::Document.new doc.to_s\n      assert_equal(\"Y\", doc.root.elements[1].name)\n    end\n```\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-02-17T08:44:37.861Z","updated_at":"2021-02-17T08:44:37.861Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10694633,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.\nIt seems that we need to improve parser too. Both of them should be rejected because they are invalid.","automated_response":false,"created_at":"2021-02-17T09:00:15.886Z","updated_at":"2021-02-17T09:00:15.886Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10715367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you try the attached patch again?\nIt also includes changes in the first patch.","automated_response":false,"created_at":"2021-02-19T00:48:37.150Z","updated_at":"2021-02-19T00:48:37.150Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1201108,"filename":"sec-1104077-v2.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xinvyvddvik8yyaewktlbuvg0xq1?response-content-disposition=attachment%3B%20filename%3D%22sec-1104077-v2.diff%22%3B%20filename%2A%3DUTF-8%27%27sec-1104077-v2.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5887a4be264e707f53266142a803ac56ecf6ba89ab1db3e4442b1c60adf9a872"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10721122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\nThe new patch looks good. While testing, however, I found some additional related behaviors, demonstrated here:\n\n```Ruby\nrequire 'rexml/document'\n\ndoc = REXML::Document.new \u003c\u003cXML\nx\u003c?x\n \u003e\n\u003c!DOCTYPE foo [ \u003c!--?\u003e\u003cX\u003e\u003cY/\u003e\u003c?x --\u003e]\u003e\u003cX\u003e\u003cZ/\u003e?\u003e\n\u003c/X\u003e\nXML\n\nputs \"First child in original doc: \" + doc.root.elements[1].name\ndoc = REXML::Document.new doc.to_s\nputs \"First child after round-trip: \" + doc.root.elements[1].name\n```\n\nOutput:\n\n```\nFirst child in original doc: Y\nFirst child after round-trip: Z\n```\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-02-19T15:06:56.256Z","updated_at":"2021-02-19T15:06:56.256Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10728805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\nJust to clarify, there are several ways of crafting the XML document to reach this behavior. Here's a few:\n\n```XML\nx\u003c?x\n \u003e\n\u003c!DOCTYPE foo [ \u003c!--?\u003e\u003cX\u003e\u003cY/\u003e\u003c?x --\u003e]\u003e\u003cX\u003e\u003cZ/\u003e?\u003e\n\u003c/X\u003e\n```\n\n```XML\nx\u003c?x\n x\n\u003c!--?\u003e\u003cX\u003e\u003cY/\u003e\u003c?x --\u003e\u003cX\u003e\u003cZ/\u003e?\u003e\n\u003c/X\u003e\n```\n\n```XML\nx\u003cX\n \u003e\u003cY/\u003e\u003c?x\n y\n\u003c!-- --\u003e\u003cX\u003e\u003cZ/\u003e\u003c?x y?\u003e\n\u003c/X\u003e\n```\n\nThe root cause seems to be incorrect anchoring -- using `^` for beginning of line instead of `\\A` for beginning of string. There are also multiple places in code where the incorrect anchor is used.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-02-20T12:44:41.587Z","updated_at":"2021-02-20T12:44:41.587Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10733395,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. You're right.\nWe should use `\\A`. We need to fix it carefully to avoid introducing regressions or other problems.","automated_response":false,"created_at":"2021-02-21T11:48:07.754Z","updated_at":"2021-02-21T11:48:07.754Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10749252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm working on this but not completed yet. Sorry.\nI found more related problems while I'm fixing these cases.\nFor example, `REXML::DocType` also has quote related problem.\nI hope that I fix this problem in a week.","automated_response":false,"created_at":"2021-02-23T05:00:49.887Z","updated_at":"2021-02-23T05:00:49.887Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10751942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\n\u003e For example, `REXML::DocType` also has quote related problem.\n\nJust in case you're referring to the fact that the `IDENTITY` regexp in the `:start_doctype` parser accepts mismatched quotes: that doesn't seem to have any security impact since the quantifier between the quotes is non-greedy, always matches the minimal length, and so doesn't cause any round-trip mutations. The parsing is incorrect, but in a consistent way.\n\nI would heavily prioritize the bugs with a confirmed downstream security impact and ideally leave everything else for a later release. Of course if this is referring to something that you've confirmed to be a security issue, then never mind.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-02-23T09:26:40.307Z","updated_at":"2021-02-23T09:26:40.307Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10760316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hmm, do you think that the following case has a security issue?\n\n```ruby\n#!/usr/bin/env ruby\n\nrequire \"rexml/document\"\n\nxml = \u003c\u003c-XML\n\u003c!DOCTYPE foo SYSTEM 'x\"\u003e\u003c!--'\u003e\n\u003cX\u003e\n  \u003cY/\u003e\u003c![CDATA[--\u003e\u003cX\u003e\u003cZ/\u003e\u003c!--]]\u003e--\u003e\n\u003c/X\u003e\nXML\ndoc = REXML::Document.new(xml)\n\nputs \"First child in original doc: \" + doc.root.elements[1].name # Z not Y\n```\n\nTo release a fix of this problem as soon as possible, could you help us? For example:\n\n```ruby\nloop do\n  bad_cases = jupenur.find_bad_cases\n  break if bad_cases.empty?\n  bad_cases.each do |bad_case|\n    ktou.fix(bad_case)\n  end\nend\nruby_team.release\n````\n\nIf I do both finding bad cases and fixing them, I need more time. If you can take over all finding task, I can work on only fixing task. It'll be helpful to release sooner.","automated_response":false,"created_at":"2021-02-23T21:57:58.884Z","updated_at":"2021-02-23T21:57:58.884Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10760684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\n\u003e do you think that the following case has a security issue?\n\nI don't think there's a security issue there. It's exactly the case I was referring to in my previous comment: The parsing is incorrect and `'x\"` (with mixed quotes) is treated as the system identifier, when a better-conforming parser would parse it as `'x\"\u003e\u003c!--'`. This leads to the entire document being parsed incorrectly, *but*... the key point here is that the parsing error always happens on the first round of processing. That means that a program that inspects the document using REXML always sees the *same* incorrect data.\n\nSecurity issues are only introduced when a parsing or serialization error causes changes in a later processing step, and an application consuming the document sees multiple differing variants of the content.\n\n\u003e  you can take over all finding task, I can work on only fixing task\n\nI don't have unlimited time to spend on this, and we're not a Ruby shop so I might not have all the expertise necessary. That said, I've already done a fair amount of testing and will continue to test all patches you prepare. I'm not aware of any further bad cases and as long as the incorrect anchoring is fixed, I don't see any particularly fragile parts in the code (other than the whole general approach of parsing XML with regular expressions, but I guess you're stuck with that). So I'd be fairly comfortable with you focusing on just fixing the issues I point you to.\n\nWhat I am a little bit concerned about is whether you understand the security implications of the bugs correctly. You jumped on fixing the issues very quickly after our initial report -- which is great (!) -- but you're not the first ones we're reporting these types of issues to, and with *literally everyone else* it's taken quite a bit of time and back-and-forth emails, even a few Zoom calls, before the impact has sunk in. Your concern regarding the mixed quotes case above also suggests there might be some confusion.\n\nI don't know how Ruby and REXML are maintained, whether there's a Foundation or a Board or a set of core contributors, but if you can find a couple of people on your team you can discuss these security issues with in confidence, I'd suggest you do that before deciding whether you're happy with just me looking for the bad cases or if you need to do more work on your side. I don't want to be the person deciding on that as a total outsider :)\n\nHappy to help in any way I can, of course, and if you feel like you need more details or want to discuss this face-to-face over a Zoom call, just let me know and I'll hook you up.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-02-23T22:36:02.774Z","updated_at":"2021-02-23T22:36:02.774Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10827599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for my late response. I didn't have enough time to work on this recent days.\nI appreciate your help so far. And it's enough for me. Sorry for confusing you.\n\nCould you try the attached patch that fixes https://hackerone.com/reports/1104077#activity-10728805 cases?\n\nThe patch includes changes in v2.\n\nNote that the patch is for the master branch. You may fail applying the patch to released version or bundled in Ruby version. But the failure will be related to test files. You can ignore patch apply failures for test files.\n\nI think that I understand this round-trip issue but I don't have enough skill to consider \"there is no bad case here\" rapidly. So I tried to fix all may-be-bad cases. Sorry.\n","automated_response":false,"created_at":"2021-02-27T22:35:53.742Z","updated_at":"2021-02-27T22:35:53.742Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1211792,"filename":"sec-1104077-v3.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/g55xbkdtuuje3qx9o182c3okacxp?response-content-disposition=attachment%3B%20filename%3D%22sec-1104077-v3.diff%22%3B%20filename%2A%3DUTF-8%27%27sec-1104077-v3.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b1e20b1f40de9be95a9e11e9d4fec7334a83bdb92d0900a61ff699fb8b8c9e4a"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10833714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shyouhei Could you take a look at this if you can?\nYou may be good at finding bad cases.\n\nSummary:\n\nWe want to confirm that there are no more bad cases (*) with the latest patch ( https://hackerone.com/reports/1104077#activity-10827599 ).\n\n(*) Bad cases:\n\n```ruby\nrequire \"rexml/document\"\n\nbad_xml = \"...\" \ndoc = REXML::Document.new(bad_xml)\ndoc  != (logically not equal) REXML::Document.new(doc.to_s) # =\u003e true\n```\n\nBad case examples (that are already fixed):\n\n* https://hackerone.com/reports/1104077#activity-10694489\n* https://hackerone.com/reports/1104077#activity-10728805\n\nWe know that REXML accepts some invalid XMLs. But it's acceptable in this issue if `doc.to_s` is also parsed as the same wrong document. We'll fix it later.","automated_response":false,"created_at":"2021-03-01T03:32:10.477Z","updated_at":"2021-03-01T03:32:10.477Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10839331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\nPatch 3 looks good. There are some more issues around anchoring (in `SYSTEMENTITY` and `ENTITYDECL` for instance), but none of the remaining ones seem to have any security impact. So all good now as far as I can tell.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-03-01T13:36:16.445Z","updated_at":"2021-03-01T13:36:16.445Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10844045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jupenur Thanks for confirming the new patch.\n\nSome members of the Ruby team are also finding more bad cases. If they can't find any more bad cases, we'll release a new version that fixes this issue. Please wait for a while.","automated_response":false,"created_at":"2021-03-01T20:17:19.345Z","updated_at":"2021-03-01T20:17:19.345Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11012151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ktou,\n\nI thought I'd check in with you since it's been a couple of weeks with no visible activity. Did the team find any additional cause for concern? Are there further changes coming to the patch?\n\nIs there an ETA for the release, and how are you otherwise handling it? My understanding is that REXML was split off from Ruby in Ruby 3.0 -- I suppose that means fixes will be made available for both Ruby 2.x and the REXML gem?\n\nDo you need any help coordinating the release with affected downstreams? We are aware of one major SAML implementation, several active forks, and a large number of downstream applications that are vulnerable to this. We also have existing relationships with some of the bigger application vendors affected. If you'd like us to reach out to any of them and give them a heads-up about the upcoming release, just let me know.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-03-16T15:36:31.355Z","updated_at":"2021-03-16T15:36:31.355Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11037248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for not sharing our status with you.\n\nWe'll release this fix in this month. We'll share details with you later. Please wait for a while.","automated_response":false,"created_at":"2021-03-18T01:56:38.017Z","updated_at":"2021-03-18T01:56:38.017Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11084912,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-03-23T00:41:26.370Z","updated_at":"2021-03-23T00:41:26.370Z","cve_ids":["CVE-2021-28965"],"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11084918,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-03-23T00:42:02.134Z","updated_at":"2021-03-23T00:42:02.134Z","additional_data":{"old_severity":"Critical (9.8)","new_severity":"High (7.1)","old_severity_id":986811,"new_severity_id":1019487},"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11084920,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-03-23T00:42:11.857Z","updated_at":"2021-03-23T00:42:11.857Z","additional_data":{"old_severity":"High (7.1)","new_severity":"Medium","old_severity_id":1019487,"new_severity_id":1019488},"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11085327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We'll use https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28965 for this case.\n\nWe'll release Ruby 2.5, 2.6, 2.7 and REXML gem.\nRuby 2.5 users must update their Ruby. But Ruby 2.5 reaches EOL at 2021-03-31. Ruby 2.5 users should update their Ruby to 2.6 or later.\nRuby 2.6 and 2.7 users can choose updating their Ruby or updating just REXML gem.\nRuby 3.0 or later users must update REXML gem.","automated_response":false,"created_at":"2021-03-23T02:27:31.890Z","updated_at":"2021-03-23T02:27:31.890Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11101220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Patches.","automated_response":false,"created_at":"2021-03-24T07:47:27.276Z","updated_at":"2021-03-24T07:47:27.276Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1240904,"filename":"ruby-2.7-hackerone-1104077.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9cmm1aihi5koh4ppt9jllvbvnp3f?response-content-disposition=attachment%3B%20filename%3D%22ruby-2.7-hackerone-1104077.diff%22%3B%20filename%2A%3DUTF-8%27%27ruby-2.7-hackerone-1104077.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=98ad7cad059a019d86aaba6355ca3d11e4ba3885897ae7d612cd2113f7a5a8f2"},{"id":1240902,"filename":"ruby-2.6-hackerone-1104077.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bzzfdrphfhqj8yjt60xqrfmdakf7?response-content-disposition=attachment%3B%20filename%3D%22ruby-2.6-hackerone-1104077.diff%22%3B%20filename%2A%3DUTF-8%27%27ruby-2.6-hackerone-1104077.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6cfc7fc9f9b502852a04c57e8cb90ce88c9772aa29747e582db3fbf62f68df94"},{"id":1240900,"filename":"ruby-2.5-hackerone-1104077.diff","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cc84k4d2grobdqf42efu3nrmr7j4?response-content-disposition=attachment%3B%20filename%3D%22ruby-2.5-hackerone-1104077.diff%22%3B%20filename%2A%3DUTF-8%27%27ruby-2.5-hackerone-1104077.diff\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cf99170ab0b5b0354b9aa2b94f67d99135d876489f711170f8f64b8afc9aef90"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11101269,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Check script.","automated_response":false,"created_at":"2021-03-24T07:55:03.185Z","updated_at":"2021-03-24T07:55:03.185Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1240920,"filename":"check-hackerone-1104077.rb","type":"application/x-ruby","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jm42nv5ni6d0lqlgv3lsmfxzoe73?response-content-disposition=attachment%3B%20filename%3D%22check-hackerone-1104077.rb%22%3B%20filename%2A%3DUTF-8%27%27check-hackerone-1104077.rb\u0026response-content-type=application%2Fx-ruby\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5cf2ccd3c74e549e27575c1bcad226e638b4f294b8c9100be1a7db948a5ec39b"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11103656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @ktou, the patches look good.","automated_response":false,"created_at":"2021-03-24T11:00:43.321Z","updated_at":"2021-03-24T11:00:43.321Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11110994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for confirming them.\nOur branch maintainers will also confirm them.","automated_response":false,"created_at":"2021-03-24T21:17:44.329Z","updated_at":"2021-03-24T21:17:44.329Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11207387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry. We have a trouble to release new versions.\nWe'll try releasing new versions at 2021-04-05 again.","automated_response":false,"created_at":"2021-04-01T07:43:00.946Z","updated_at":"2021-04-01T07:43:00.946Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11221227,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How to release rexml gem:\n\n```bash\ngit clone git@github.com:ruby/rexml.git\n# (Download the attached rexml-patches.tar.gz)\ntar xvf rexml-patches.tar.gz\ncd rexml\n../rexml-patches/apply.sh\nrake release\n```\n\nNote: You will see the following warnings while running `apply.sh`:\n\n```text\n.git/rebase-apply/patch:309: trailing whitespace.\n```\n\nBut we can ignore them. I confirmed that we can apply patches correctly with them.","automated_response":false,"created_at":"2021-04-02T08:02:00.649Z","updated_at":"2021-04-02T08:02:00.649Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1251325,"filename":"rexml-patches.tar.gz","type":"application/gzip","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/77hgyrc7u6lz1ge14vdb4eqq0xqx?response-content-disposition=attachment%3B%20filename%3D%22rexml-patches.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27rexml-patches.tar.gz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d240dcba3a9e16aac1cf760fbefe88ff14245517ac85699118b7d32f12de69d9"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11275591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've released new versions that fix this problem: https://www.ruby-lang.org/en/news/2021/04/05/xml-round-trip-vulnerability-in-rexml-cve-2021-28965/\n\n @jupenur Thanks for your report!","automated_response":false,"created_at":"2021-04-06T08:44:42.090Z","updated_at":"2021-04-06T08:44:42.090Z","actor":{"username":"ktou","cleared":false,"url":"/ktou","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11275610,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-04-06T08:47:04.631Z","updated_at":"2021-04-06T08:47:04.631Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jupenur","url":"/jupenur"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11297150,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-04-07T11:43:35.018Z","updated_at":"2021-04-07T11:43:35.018Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ruby"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"jupenur","url":"/jupenur"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11297151,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-07T11:43:46.013Z","updated_at":"2021-04-07T11:43:46.013Z","first_to_agree":true,"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11297486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @hsbt,\n\nThanks for the bounty. Can we do limited disclosure instead of full? I don't see the option on my end, but I assume you have that available to you as program staff.\n\nFull disclosure may be an unnecessary risk, since I'm aware of some prominent downstream apps that have not been able to immediately apply the patch despite verified critical impact. While the source code and unit tests are already public, some of my code examples here do go a step or two further by demonstrating how the doctype issues can cause changes further down in the markup. Turning them into a complete exploit is already significantly easier than working out one based on the currently available information.\n\nOr if you'd really prefer full disclosure, I would suggest we wait for the 30-day timer to run out instead of disclosing immediately.\n\nRegards,\n\nJuho Nurminen","automated_response":false,"created_at":"2021-04-07T12:13:39.193Z","updated_at":"2021-04-07T12:13:39.193Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11297996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Juho.\n\nI understood. Your suggestion is reasonable.\nCan you disclose this by your convenience?","automated_response":false,"created_at":"2021-04-07T12:49:23.109Z","updated_at":"2021-04-07T12:49:23.109Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c9b028ec4e8a04174f943d20c1393a534bc5f007926bb46cfcd8bef590b2642"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11298023,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will do. Thanks.","automated_response":false,"created_at":"2021-04-07T12:51:48.862Z","updated_at":"2021-04-07T12:51:48.862Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11401276,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-15T09:44:48.418Z","updated_at":"2021-04-15T09:44:48.418Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11401277,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-15T09:44:48.531Z","updated_at":"2021-04-15T09:44:48.531Z","actor":{"username":"jupenur","cleared":false,"url":"/jupenur","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}