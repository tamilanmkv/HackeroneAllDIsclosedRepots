{"id":112935,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTI5MzU=","url":"https://hackerone.com/reports/112935","title":"Unintended HTML inclusion as a result of https://hackerone.com/reports/110578","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-26T19:30:00.753Z","submitted_at":"2016-01-26T19:30:00.753Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-02-24T00:13:38.166Z","bug_reporter_agreed_on_going_public_at":"2016-02-24T00:13:37.681Z","team_member_agreed_on_going_public_at":"2016-02-23T23:37:23.784Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nI was just reading https://hackerone.com/reports/110578 and testing out the changes. I had previously noticed that the editor would take something like:\n\n    [test](http://www.torontowebsitedeveloper.com \"test ismap=\"yes\"')\n\nand turn it into :\n\n    \u003ca title=\"test ismap=\"yes\"' href=\"http://www.torontowebsitedeveloper.com\"\u003etest\u003c/a\u003e\n\nIn other words, the code would recursively look at what should be the title string and use the first single or double quote, matching it to the last single or double quote, including all others within it as the actual \" or ' as was noted in the report (I was actually looking at the git repo to try and see if there was any vulnerability in the recursive flow from an overflow perspective but couldn't find one...).\n\nAnyways, I noticed after the report, with your change, I can get some arbitrary html included in anchor tags now. Admittedly, I'm just starting out with all of this so I don't know yet how/if this could be exploited but now when I add the above\n\n    [test](http://www.torontowebsitedeveloper.com \"test ismap=\"alert xss\" yyy=\"test\"\")\n\nIt gets turned into:\n\n    \u003ca title=\"'test\" ismap=\"alert xss\" yyy=\"test\" \u0026#39; href=\"http://www.torontowebsitedeveloper.com\"\u003etest\u003c/a\u003e\n\nTwo things to I would flag:\n\n1. the single quote at the beginning of what should be title=\"test\" and \n2. I was able to add ismap= and yyy= as html attributes\n\nThis reminded me of the yahoo mail xss injection recently disclosed so I thought I'd make you aware. If you don't agree it's a vulnerability, please let me close the issue.\n\nThanks!\n","bounty_amount":"500.0","formatted_bounty":"$500","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-24T23:37:24.239Z","allow_singular_disclosure_after":-175096150.272401,"singular_disclosure_allowed":true,"vote_count":16,"voters":["drsniper","akaash_pantherdefence","varlynx","safisec","franciny","dyabla","jonanv","ulisesgascon","ivrez","kondratenko","and 6 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":773038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additionally, still playing with this now in firefox to see if it rendered the html differently and it looks like the following ends up rendering a single quote with no closing single quote:\n\n    [test](http://www.torontowebsitedeveloper.com \"test\" ismap= script= \"\"\")\n\n\u003ca title=\"'test\u0026quot;\" ismap=\"script=\" \"\"\u0026#39;=\"\" href=\"http://www.torontowebsitedeveloper.com\" rel=\"nofollow\" target=\"_blank\"\u003e\u003cspan\u003etest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\nThe single quote comes right after the first double quote in the title.... If I understand the other report properly, this is still a vulnerability as the single quote is left hanging with no closing single quote. I don't think that \u0026#39 mitigates that but admittedly am not 100% sure.","automated_response":false,"created_at":"2016-01-26T20:07:25.134Z","updated_at":"2016-01-26T20:07:25.134Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773203,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Yes, nice catch, this seems to have slipped through the cracks so we will be rolling back while we investigate other solutions.","automated_response":false,"created_at":"2016-01-26T22:34:39.078Z","updated_at":"2016-01-26T22:34:39.078Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great to hear I wasn't wasting your time.\n\nFor what it's worth, it seemed like the original implementation was close. I think you guys are using the redcarpet repo on github (https://github.com/vmg/redcarpet) -- that assumption is based on a previous disclosed report re: your implementation of markdown.\n\nWhen I was looking through that code for buffer overflow vulnerabilities, I noticed that the title rendering for links has a flag to denote when it is within a single or double quote (line 1105 of markdown.c). Is it better within that loop just to escape any quotes that are found which searching for the end of the title tag? The implementation I'm looking at enters the loop based on either a /' or a /\" -- if there is a flag to denote which was found, then you'd know what you are looking for to close off the title tag with and could escape the other...\n\nJust a thought, hope it helps in some way.","automated_response":false,"created_at":"2016-01-27T00:05:20.819Z","updated_at":"2016-01-27T00:05:20.819Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, it's possible we can modify this code in Redcarpet to escape the contents of the link `title` and then change the outer quotes back to double quotes. Then our original fix to #110578 should be fine. We'll consider this when continuing our investigation.\n\nAnyways, our breaking change has been rolled back. Can you verify the issue you've reported here is no longer an issue?\n\nThanks!","automated_response":false,"created_at":"2016-01-27T00:30:24.100Z","updated_at":"2016-01-27T00:30:24.100Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup, looks like the revert is good. Just to confirm, entering\n\n    [test](http://www.torontowebsitedeveloper.com \"test ismap=\"yes\"'')\n\n[test](http://www.torontowebsitedeveloper.com \"test ismap=\"yes\"'')\n\nResults in the following which looks to be the same as before [#110578](https://hackerone.com/reports/110578):\n\n    \u003ca title=\"test ismap=\u0026quot;yes\u0026quot;'\" href=\"http://www.torontowebsitedeveloper.com\" rel=\"nofollow\" target=\"_blank\"\u003e\u003cspan\u003etest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e","automated_response":false,"created_at":"2016-01-27T01:31:59.725Z","updated_at":"2016-01-27T01:31:59.725Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @yaworsk,\n\nThanks for the confirmation! Unfortunately this means we're back to trying to figure out a new way to fix the issue from #110578, so I think we'll be keeping this bug open as we dig into that once more.\n\n\n\nEvan","automated_response":false,"created_at":"2016-01-27T22:35:06.953Z","updated_at":"2016-01-27T22:35:06.953Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774655,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ebrynne,\nNo worries, figured it meant a trip back to the drawing board. Happy to help out with any testing once you've got a solution. Hopefully it isn't too bad given the inner double quotes are being converted.","automated_response":false,"created_at":"2016-01-28T00:22:10.602Z","updated_at":"2016-01-28T00:22:10.602Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":784609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ebrynne / @andrewone,\nJust checking in to see if there is any update? I was going to submit another report to Hackerone but can't given I'm so new and my Signal is low. The new report isn't serious and I'm happy to summarize it here but I didn't want to confuse the two issues.\n\nThanks","automated_response":false,"created_at":"2016-02-04T13:47:46.774Z","updated_at":"2016-02-04T13:47:46.774Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":792369,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @yaworsk,\n\nSorry for the delay! I think this should be resolved in the next day or so, which hopefully will give you enough of a signal boost to submit whatever other vulnerabilities you've found.\n\nThanks for your patience! \n\n\nEvan","automated_response":false,"created_at":"2016-02-10T01:15:06.433Z","updated_at":"2016-02-10T01:15:06.433Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":792863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ebrynne,\nno problem! I followed up with support@hackerone anyways. At a minimum, just looking forward to to the fix for a bit of validation to the old bruised ego.\n\nPete","automated_response":false,"created_at":"2016-02-10T13:42:06.013Z","updated_at":"2016-02-10T13:42:06.013Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":796543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @yaworsk,\n\nJust a quick update; it took me a little longer to get a fix that I was happy with, but hopefully this'll go out by Monday. \n\nThanks again for your patience!\n\n\nEvan","automated_response":false,"created_at":"2016-02-13T01:28:17.036Z","updated_at":"2016-02-13T01:28:17.036Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":796546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries, thanks for the update. Makes sense to take the time to get things right. Have a good weekend.","automated_response":false,"created_at":"2016-02-13T01:47:44.421Z","updated_at":"2016-02-13T01:47:44.421Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":802129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ebrynne, sorry to pester, just wondering if theres any update on timing?","automated_response":false,"created_at":"2016-02-17T21:59:45.114Z","updated_at":"2016-02-17T21:59:45.114Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":808291,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yaworsk,\n\nI'm happy to say that I just landed the fix for this. It should be deployed tomorrow and then we can verify that everything's working alright. \n\nThanks again for all your patience! \n\n\nEvan","automated_response":false,"created_at":"2016-02-23T02:25:29.590Z","updated_at":"2016-02-23T02:25:29.590Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":808292,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ebrynne,\nthat's awesome, great to hear. Looking forward to testing. Thanks for the heads up.\n\nTalk soon,\npete","automated_response":false,"created_at":"2016-02-23T02:26:32.899Z","updated_at":"2016-02-23T02:26:32.899Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @yaworsk - We've released the fix earlier today. Could you please verify it? ","automated_response":false,"created_at":"2016-02-23T19:11:15.159Z","updated_at":"2016-02-23T19:11:15.159Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @pei, \nI was actually playing with it for the last while. I'm not entirely sure I see the fix, it looks like the single quote is still be rendered without encoding.\n\nI'm using the following string: \n````[test](http://www.torontowebsitedeveloper.com \"test ismap=\"yes\"'')````\n\nwhich creates: [test](http://www.torontowebsitedeveloper.com \"test ismap=\"yes\"'')\n\nHere is what I get from inspecting that link in the preview, using firefox, right click inspect element, right click edit as html:\n\n````\u003ca title=\"test ismap=\u0026quot;yes\u0026quot;'\" href=\"http://www.torontowebsitedeveloper.com\" rel=\"nofollow\" target=\"_blank\"\u003e\u003cspan\u003etest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e````\n\nNotice the single quote. \n\nAlternatively, on this actual page, ctrl-a, right click view selection source and i see:\n\n````\n\u003cp\u003ewhich creates: \u003ca title=\"test ismap=\u0026quot;yes\u0026quot;'\" href=\"http://www.torontowebsitedeveloper.com\" rel=\"nofollow\" target=\"_blank\"\u003e\u003cspan\u003etest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n````\n\nIf I look at the response from Burp Suite for the POST /preview call, it is encoded but looks like the JS is decoding the #39: \n\n````\n{\"preview_body\":\"\\u003cp\\u003e\\u003ca title=\\\"test ismap=\\u0026quot;yes\\u0026quot;\\u0026#39;\\\" href=\\\"http://www.torontowebsitedeveloper.com\\\" rel=\\\"nofollow\\\" target=\\\"_blank\\\"\\u003e\\u003cspan\\u003etest\\u003c/span\\u003e\\u003ci class=\\\"icon-external-link\\\"\\u003e\\u003c/i\\u003e\\u003c/a\\u003e\\u003c/p\\u003e\\n\"}\n````\n\nI also tried saving the comment and looking at it after on a test store/ticket but same result. Does all that make sense?","automated_response":false,"created_at":"2016-02-23T19:39:09.528Z","updated_at":"2016-02-23T19:51:29.222Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, was still playing around. If i just enter double and single quotes, I don't see them escaped in the HTML the same way \u003c \u003e are.\n\nSo entering:\n' \" ' \u003c\u003e\n\ngives me the following when I highlight it and inspect source:\n````\u003cp\u003eSo entering:\u003cbr\u003e\n' \" ' \u0026lt;\u0026gt;\u003c/p\u003e````\n\nI'm not 100% confident in how I'm examining the source HTML given it is being rendered by JS but based on a quick google search, the way to do it with firefox is highlighting the text, right clicking and viewing the selection source.\n\nAlso, here's the burp preview response if it helps:\n````{\"preview_body\":\"\\u003cp\\u003eAlso, was still playing around. If i just enter double and single quotes, I don\\u0026#39;t see them escaped in the HTML the same way \\u0026lt; \\u0026gt; are.\\u003c/p\\u003e\\n\\n\\u003cp\\u003eSo entering:\\u003cbr\\u003e\\n\\u0026#39; \\u0026quot; \\u0026#39; \\u0026lt;\\u0026gt;\\u003c/p\\u003e\\n\\n\\u003cp\\u003ereturns:\\u003cbr\\u003e\\n\\u003ccode\\u003e\\u0026lt;p\\u0026gt;So entering:\\u0026lt;br\\u0026gt;\\u003cbr\\u003e\\n\\u0026#39; \\u0026quot; \\u0026#39; \\u0026amp;lt;\\u0026amp;gt;\\u0026lt;/p\\u0026gt;\\u003c/code\\u003e\\u003c/p\\u003e\\n\"````\n\nThoughts?","automated_response":false,"created_at":"2016-02-23T21:28:33.667Z","updated_at":"2016-02-23T21:28:33.667Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yaworsk,\n\nI've verified that the fix is good, so there is no issue here anymore.\n\nIf you read the summary of #110578, it explains that the vulnerability is in the way Markdown is displayed. The issue that existed before was that quotes weren't escaped *at the time of HTML rendering*, so they could potentially be used in text content to break out of the HTML tag. React usually defends against this issue for us, except when we bypass this with `dangerouslySetInnerHTML`, which we use only for our Markdown rendering (since we need to generate our own rich HTML).\n\nSo to verify the fix, we only care about the `markdown_message` portion of the report JSON, which now looks like this:\n```\n\"markdown_message\":\"\\u003cp\\u003eAlso, was still playing around. If i just enter double and single quotes, I don\\u0026#39;t see them escaped in the HTML the same way \\u0026lt; \\u0026gt; are.\\u003c/p\\u003e\\n\\n\\u003cp\\u003eSo entering:\\u003cbr\\u003e\\n\\u0026#39; \\u0026quot; \\u0026#39; \\u0026lt;\\u0026gt;\\u003c/p\\u003e\\n\\n\\u003cp\\u003egives me\n```\nHere you can see that the single quotes will remain as `\u0026#39;` after the Markdown is processed, which means it is now safe when passed into `dangerouslySetInnerHTML`.","automated_response":false,"created_at":"2016-02-23T22:01:31.403Z","updated_at":"2016-02-23T22:02:26.138Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @andrewone,\nok. I probably misunderstood #110578 - in short, what I thought was the actual rendering of the single ' could lead to a situation where a meta tag was injected at the beginning of the page also with a single '. As a result, these two could be combined by the browser to submit the full html between both as a parameter to a malicious site. I took the concept from filedescriptor's discussion here: http://blog.innerht.ml/page/2/ - three quarters down he discusses the twitter case study, also disclosed on hackerone.\n\nSorry for the confusion - didn't realize it was just about the markdown_message portion of the json.\n\npete","automated_response":false,"created_at":"2016-02-23T22:31:30.195Z","updated_at":"2016-02-23T22:31:30.195Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it's easy to get confused here. The `\u003cp\u003e{{injection point}}\u003c/p\u003e` described by filedescriptor isn't possible in our case thanks to React, but it *was* possible in the Markdown scenario where React's built-in security is bypassed.","automated_response":false,"created_at":"2016-02-23T22:44:35.032Z","updated_at":"2016-02-23T22:44:35.032Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ahhh, gotcha. Thanks for clarifying.","automated_response":false,"created_at":"2016-02-23T22:58:17.838Z","updated_at":"2016-02-23T22:58:17.838Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809568,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Both the regression and the original issue have been addressed.","automated_response":false,"created_at":"2016-02-23T23:14:28.593Z","updated_at":"2016-02-23T23:14:28.593Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for the report. We really do appreciate the assistance here and the creativity in poking at our markdown renderer.\n\nI do feel it would be worthwhile to open an issue against redcarpet for the single/double quote issue you mentioned above (affecting https://github.com/vmg/redcarpet/blob/4e640dd471c08df350373a79327302f1add19d00/ext/redcarpet/markdown.c#L1104-L1130). I agree it would be better if it tracked which type of quote was used.\n\nPlease continue to poke at us and at redcarpet. I'm sure there's still some other issues lurking, just waiting to be discovered, and we look forward to any reports for things you might find. Happy hacking!","automated_response":false,"created_at":"2016-02-23T23:36:58.129Z","updated_at":"2016-02-23T23:36:58.129Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809605,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-02-23T23:37:11.908Z","updated_at":"2016-02-23T23:37:11.908Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809606,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-23T23:37:23.822Z","updated_at":"2016-02-23T23:37:23.822Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for that feedback @reed, will do on both counts. And thanks for the bounty!!","automated_response":false,"created_at":"2016-02-24T00:13:28.247Z","updated_at":"2016-02-24T00:13:28.247Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809665,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-24T00:13:37.717Z","updated_at":"2016-02-24T00:13:37.717Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809666,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-02-24T00:13:38.195Z","updated_at":"2016-02-24T00:13:38.195Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}