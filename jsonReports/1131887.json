{"id":1131887,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTMxODg3","url":"https://hackerone.com/reports/1131887","title":"CSV injection in the credentials export","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2021-03-21T18:11:36.375Z","submitted_at":"2021-03-23T08:10:55.216Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"muon4","url":"/muon4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-09-22T19:33:42.956Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-08-23T19:33:38.480Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHello team!\n\nWe have found out that a hacker can inject malicious excel formulas into the credentials details which will be executed when program user exports the credentials details via `https://hackerone.com/hackerone_h1p_bbp3/credentials` -\u003e export credentials and opens this CSV using MS excel. This how an attacker could execute abritary commands in the program user's windows machines throught the malicious CSV files. However, since this attack vector requires an older windows machine the impact is pretty low so we decided to report this as best practice instead of vulnerabilitys (severity none).\n\n## Steps To Reproduce:\n\n- Login to the system as a program user\n- Add credentials to the program at `https://hackerone.com/hackerone_h1p_bbp3/credentials`\n- Now login as a hacker user of this program and request your credentials using *show credentials* button\n- Set value of the account details to the `;=1+1;`\n- As a program user navigate to the `https://hackerone.com/hackerone_h1p_bbp3/credentials` and export the credentials\n\nNote: The program user does not see the account details in this phase so s/he won't expect anything harmless.\n\n- Once you open the CSV in the MS excel the formula has been executed and there is a new cell with value `2` instead of `;=1+1`\n \n\n## Recommendation:\n\nMake sure that the payload can't start with the following characters: `;`, `=`, `-`, `@` or `+`.\n\n \n\n## References:\n\n`https://owasp.org/www-community/attacks/CSV_Injection`\n\n## Impact\n\nPossible command execution in the victim's windows machines","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-09-22T19:33:38.751Z","allow_singular_disclosure_after":-1619593.249782834,"singular_disclosure_allowed":true,"vote_count":4,"voters":["tk0","alp","chal13w1zz","meispi"],"severity":{"rating":"none","score":0.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":70334,"asset_type":"URL","asset_identifier":"hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11070584,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2021-03-21T18:11:36.498Z","updated_at":"2021-03-21T18:11:36.498Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11070585,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2021-03-21T18:11:36.533Z","updated_at":"2021-03-21T18:11:36.533Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11098160,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-03-23T21:40:52.891Z","updated_at":"2021-03-23T21:40:52.891Z","actor":{"username":"eduardo_h1","cleared":false,"url":"/eduardo_h1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11794302,"is_internal":false,"editable":false,"type":"Activities::BugRetesting","message":"","automated_response":false,"created_at":"2021-05-18T17:57:58.034Z","updated_at":"2021-05-18T17:57:58.176Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","report_retest":{"id":5679,"retest_subscription":{"handled_by_triage":false}},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11809682,"is_internal":false,"editable":false,"type":"Activities::UserCompletedRetest","message":"Yup, now the export contains the character `'` before attack payloads.","automated_response":false,"created_at":"2021-05-19T17:03:26.297Z","updated_at":"2021-05-19T17:03:26.297Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11810127,"is_internal":false,"editable":false,"type":"Activities::ReportRetestApproved","message":"Thanks for retesting!","automated_response":false,"created_at":"2021-05-19T17:51:43.991Z","updated_at":"2021-05-19T17:51:43.991Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","report_retest_user":{"user":{"username":"muon4"},"report_retest":{"retest_subscription":{"tag":"pentest","handled_by_triage":false,"awarding_retesters":false}}},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11810128,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-05-19T17:51:44.175Z","updated_at":"2021-05-19T17:51:44.175Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"muon4","url":"/muon4"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13133245,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This report was a pentest finding and therefore no bounty was awarded.","automated_response":false,"created_at":"2021-08-23T19:33:38.522Z","updated_at":"2021-08-23T19:33:38.522Z","first_to_agree":true,"actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13584367,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-22T19:33:43.139Z","updated_at":"2021-09-22T19:33:43.139Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}