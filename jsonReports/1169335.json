{"id":1169335,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY5MzM1","url":"https://hackerone.com/reports/1169335","title":"Password policy changes not enforced for existing passwords","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2021-04-20T07:30:49.057Z","submitted_at":"2021-04-20T07:30:49.167Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-26T14:07:13.486Z","bug_reporter_agreed_on_going_public_at":"2021-04-20T13:43:15.014Z","team_member_agreed_on_going_public_at":"2021-04-26T14:07:13.342Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"So this is two reports in one. Sort of. But they are the same issue, or at least related.\n\n1. When you setup your nextcloud there is no password policy at all. There is the strength indicator.\n\nI get the password policy app is not yet active at that point. But a minimum length would not be that insane or hard to enforce.\nI noticed this when setting up my test setup with admin/admin\n\n\n2. Now afterwards the password policy app was active. And I enabled the HaveIBeenPwned check. So now I have an admin password that doesn't pass any of the my criteria\n\n* min password length (defaults to 8)\n* no common passwords (admin is in there)\n* not in HIBP (admin is also in there)\n\n\nI would expect that if I set a stronger password policy all passwords have to follow that. Now since the passwords are stored hashed you can't do this at policy change time. However at login time you do have the password. And checking against the criteria is possible.\n\nThere should at the very least be a warning to the user that their password is not meeting the password criteria. And possibly even a warning to the administrators that a user is using a password that is not meeting the requirements.\nBut one could even argue that a mandatory password change is in order.\n\n## Impact\n\nAdministrators of the system can feel like they have everything pretty well in check when they update the password policy to the latest standards. But in reality all the users that setup their accounts before could use very weak and insecure passwords.","weakness":{"id":25,"name":"Weak Cryptography for Passwords"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["0xssrf","wi11","recon_ninja","ekgaribadmi","david001","chakane","adass"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":68,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/password_policy","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11448981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-04-20T07:30:49.766Z","updated_at":"2021-04-20T07:30:49.766Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11453328,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We've discussed this issue internally, and consider this for now accepted behaviour.\n\nHowever, we do understand that this is something that should be improved in the future, and in the meantime the limitation should be documented in our documentation.\n\nCould you open a ticket at https://github.com/nextcloud/password_policy and mention me? (@LukasReschke). If you prefer, we can also open this ticket for you :)","automated_response":false,"created_at":"2021-04-20T12:56:29.680Z","updated_at":"2021-04-20T12:56:29.680Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11453682,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Feel free to do so","automated_response":false,"created_at":"2021-04-20T13:43:08.563Z","updated_at":"2021-04-20T13:43:08.563Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11453683,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-20T13:43:15.036Z","updated_at":"2021-04-20T13:43:15.036Z","first_to_agree":true,"actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11514786,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We've filed a ticket for this at https://github.com/nextcloud/password_policy/issues/159","automated_response":false,"created_at":"2021-04-26T14:07:13.358Z","updated_at":"2021-04-26T14:07:13.358Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11514787,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-26T14:07:13.513Z","updated_at":"2021-04-26T14:07:13.513Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}