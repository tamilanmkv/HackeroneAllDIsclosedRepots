{"id":117097,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTcwOTc=","url":"https://hackerone.com/reports/117097","title":"Email Forgery through Mandrillapp SPF","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-02-18T07:11:14.654Z","submitted_at":"2016-02-18T07:11:14.654Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugdiscloseguys","url":"/bugdiscloseguys","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-19T19:16:58.197Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-18T19:16:49.496Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description :-\nThe SPF record of gratipay.com include Mandrillapp which you are not using right now, i'm able to add gratipay.com in my account, although a further verification of domain is required but you should know that Mandrillapp allow to send email from a domain if its SPF records point Mandrill server.\nI have attached a screenshot to proof my concept\n1 SPF record found for the domain gratipay.com :\n\"\"  v=spf1 include:email.freshdesk.com include:spf.mandrillapp.com include:_spf.google.com -all  \"\nThis is useful in phishing, and this type of vulnerability is news worthy (http://bits.blogs.nytimes.com/2015/04/09/sendgrid-email-breach-was-used-to-attack-coinbase-a-bitcoin-exchange/)\nVulnerability Impact Scenario :-\nUsing my own mandrill account I can send email which appears to originate from @gratipay.com\nPatch :-\nThe patch is pretty simple. Complete your mandrill registration process. This will lock out other mandrill users from sending email that originates from *@gratipay.com.\nLet me know if you have any other questions.\nCheck Screenshot.\nThanks.","bounty_amount":"10.0","formatted_bounty":"$10","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":74045,"file_name":"Screen_Shot_2016-02-18_at_12.40.48_pm.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/074/045/93c2d8e619364168e7187fcd5bb344ed7558e78e/Screen_Shot_2016-02-18_at_12.40.48_pm.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-02-18_at_12.40.48_pm.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-02-18_at_12.40.48_pm.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132930Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=83a307cbc3e87731994fedbf4e2f89458847d23d5c5c8bab4aed3a3e09e79cc2","file_size":26008,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-19T19:16:49.624Z","allow_singular_disclosure_after":-175543961.3739489,"singular_disclosure_allowed":true,"vote_count":5,"voters":["zayn1337","silv3rpoision","spetr0x","dyabla","saurabhmeher"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":802640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @guyfromindia,\n\nThanks for the report.\n\nwere you able to send emails from @gratipay.com ?\n\nRegards,\nHammad","automated_response":false,"created_at":"2016-02-18T10:18:33.138Z","updated_at":"2016-02-18T10:18:33.138Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":802662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess you need to read that article once .","automated_response":false,"created_at":"2016-02-18T11:02:32.203Z","updated_at":"2016-02-18T11:02:32.203Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":802878,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report, @guyfromindia.\n\nI've verified our domain at Mandrill. I'm now reading through these resources to understand the situation further:\n\nhttps://hackerone.com/reports/56742\n\nhttps://mandrill.zendesk.com/hc/en-us/articles/205582247-What-is-domain-verification-\n\nhttps://sendgrid.com/blog/update-on-security-incident-and-additional-security-measures./\n\nhttp://bits.blogs.nytimes.com/2015/04/09/sendgrid-email-breach-was-used-to-attack-coinbase-a-bitcoin-exchange/","automated_response":false,"created_at":"2016-02-18T15:02:38.465Z","updated_at":"2016-02-18T15:02:38.465Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":74095,"filename":"mandrill-domain.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/074/095/3174d34b009531eb7289d6f13ca74e148d02554f/mandrill-domain.png?response-content-disposition=attachment%3B%20filename%3D%22mandrill-domain.png%22%3B%20filename%2A%3DUTF-8%27%27mandrill-domain.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132931Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=da279efeead570d035feacc45f9d160782644943179a57ae3fd2a05e08aa44d4"}],"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Keep Me Updated please.","automated_response":false,"created_at":"2016-02-18T17:33:12.875Z","updated_at":"2016-02-18T17:33:12.875Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":803219,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Alright, I think we're good here. Closing and discussing bounty internally ...","automated_response":false,"created_at":"2016-02-18T19:16:29.541Z","updated_at":"2016-02-18T19:16:29.541Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803220,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-18T19:16:49.519Z","updated_at":"2016-02-18T19:16:49.519Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks But Keep Me Updated With The Bounty :P\n","automated_response":false,"created_at":"2016-02-18T19:21:49.407Z","updated_at":"2016-02-18T19:25:06.538Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":803258,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@guyfromindia Awarding $10. Please see https://github.com/gratipay/inside.gratipay.com/issues/510 for discussion.\n\nAlso please note that both @hammad and I are volunteers as is our entire internal team, that's why we can't offer as much as other companies. Thanks for understanding.\n\nAnd thanks for your reports! :-)","automated_response":false,"created_at":"2016-02-18T19:40:44.530Z","updated_at":"2016-02-18T19:40:44.530Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"bounty_amount":"10.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":803262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No Problem Sir.\nIt Was Nice Helping You.","automated_response":false,"created_at":"2016-02-18T19:41:27.905Z","updated_at":"2016-02-18T19:41:27.905Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":804898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537 The Issue Mail Looks Serious And You Paid Them $20 Sir What I Reported Was Far Much Serious And I Deserved 10 . Please Have A Look","automated_response":false,"created_at":"2016-02-19T19:07:21.769Z","updated_at":"2016-02-19T19:07:21.769Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":850240,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-19T19:16:58.251Z","updated_at":"2016-03-19T19:16:58.251Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340036,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-04T18:23:39.034Z","updated_at":"2016-12-04T18:23:39.034Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":11507},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}