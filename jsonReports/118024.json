{"id":118024,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTgwMjQ=","url":"https://hackerone.com/reports/118024","title":"Markdown based stored XSS (IE only)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-22T19:58:40.720Z","submitted_at":"2016-02-22T19:58:40.720Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"a0xnirudh","url":"/a0xnirudh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-03T22:28:08.622Z","bug_reporter_agreed_on_going_public_at":"2017-04-27T08:35:40.815Z","team_member_agreed_on_going_public_at":"2017-05-03T22:28:08.571Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nMy other report #116697 deals with any browser even through its not a direct XSS as it doesn't execute in the context of the site. But here is another type of XSS using `vbscript:` which affects only IE users but executes on the context of the site (check the screenshot for POC alert(document.domain)).\n\n### POC:\n\n`[clickme](vbscript:alert(document.domain))`\n\n`vbscript:` is not supported in Microsoft EDGE and updated versions of IE 11 (as per [this link](http://stackoverflow.com/questions/17483782/vbscript-support-in-internet-explorer-11) but it do works if people are working in the compatibility mode (I have read the gitlab instruction which specifically says users to turm off compatibility mode but if IE detects that the incoming webpages has some contents which is supported only on compatibility mode, it recommends that to the users I guess.).\n\nFor example, I comment the above link on one of the project/issues and then when I reloaded the page, IE detects that the incoming webpage contains scripts that might not be compatible and hence it told me to enable compatibility options by clicking a button. Usually if people see a warning like that from a browser, they will tend to enable it.\n\n### Mitigation\n\nOther then updated versions of IE 11, it works on IE10, 9, 8, 7. Also fixing this issue is so trivial by just blocking the keyword `vbscript` and since it executes on the context of the site, I believe this should be fixed.","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":74791,"file_name":"gitlab_vbscript_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/074/791/6e2329985f88d277743e2cffd47afd6dd2248868/gitlab_vbscript_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22gitlab_vbscript_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27gitlab_vbscript_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133011Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=12ed3ebe581d991f4ae4354ecb894a5517169d49b7fdbbcb29e3b519de636ca1","file_size":69012,"type":"image/png"}],"allow_singular_disclosure_at":"2017-05-27T08:35:40.848Z","allow_singular_disclosure_after":-138084870.88917485,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","japz","a0xnirudh","sumit7","vishnuraj","spetr0x","jugno","safisec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":809650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the new report. I've created an internal issue for this and I'll report back on it. \n\nFeel free to get in touch with us at security@gitlab.com for additional followup or attention to a report.\n\nBest regards,\n\nJose","automated_response":false,"created_at":"2016-02-24T00:03:08.553Z","updated_at":"2016-02-24T00:03:08.553Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822624,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Issue has been resolved https://gitlab.com/gitlab-org/gitlab-ce/issues/13625. Thank you.","automated_response":false,"created_at":"2016-03-03T14:54:26.783Z","updated_at":"2016-03-03T14:54:26.783Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"a0xnirudh","url":"/a0xnirudh"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you'd like to be listed at our site https://about.gitlab.com/vulnerability-acknowledgements/ please send me your name and URL.","automated_response":false,"created_at":"2016-03-03T14:59:54.693Z","updated_at":"2016-03-03T14:59:54.693Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822660,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jose \n\nThanks for the quick bug fix and resolving it. Really appreciate it.\n\nName: \u003ca href = \"https://twitter.com/a0xnirudh\"\u003eAnirudhAnand\u003c/a\u003e\nCompany: \u003ca href = \"https://www.0daylabs.com/\"\u003e0daylabs\u003c/a\u003e","automated_response":false,"created_at":"2016-03-03T15:06:10.422Z","updated_at":"2016-03-03T15:06:10.422Z","actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Got it. I'll probably have to strip away the twitter link as per our internal conventions but everything else looks good. I've got this update scheduled for Tuesday. I'll report back here.","automated_response":false,"created_at":"2016-03-03T15:11:35.437Z","updated_at":"2016-03-03T15:11:35.437Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":822667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right, its ok. Thanks, in the mean time, I will play with the application more and let you know if I come across more bugs.\n\nThanks !","automated_response":false,"created_at":"2016-03-03T15:13:04.357Z","updated_at":"2016-03-03T15:13:04.357Z","actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAgain just a quick update to let you know that a MR for the vulnerability acknowledgment has been posted here https://gitlab.com/gitlab-com/www-gitlab-com/merge_requests/1676.\n\nBest regards,\n\nJosé Torres\nGitLab B.V.","automated_response":false,"created_at":"2016-03-10T06:42:06.221Z","updated_at":"2016-03-10T06:42:06.221Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1639389,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-27T08:35:40.833Z","updated_at":"2017-04-27T08:35:40.833Z","first_to_agree":true,"actor":{"username":"a0xnirudh","cleared":false,"url":"/a0xnirudh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/891/b9be8d32dadcaa814c6bf85eceef7fdf9fa38f41_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652673,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-03T22:28:08.590Z","updated_at":"2017-05-03T22:28:08.590Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652674,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-03T22:28:08.638Z","updated_at":"2017-05-03T22:28:08.638Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}