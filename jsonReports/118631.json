{"id":118631,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTg2MzE=","url":"https://hackerone.com/reports/118631","title":"XSSI (Cross Site Script Inclusion)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-24T23:00:33.343Z","submitted_at":"2016-02-24T23:00:33.343Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-22T22:38:07.744Z","bug_reporter_agreed_on_going_public_at":"2017-07-23T22:37:48.492Z","team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nhttps://www.coinbase.com/pusher/auth returns sensetive  a json auth-token response that can be parsed by \n```javascript\nJSON.parse()\n```\nfrom external site. this can easily be mitigated by putting /**/ or // chars at the beginning of the json response and thus making functions like JSON.parse unable to get the data extracted because of parsing errors.\n\nI do know the url takes 2 post parameters and one of them being a **channel name** to properly get the json response. but if an attacker get access to that parameter, just once. he will forever be able to use it. \n\nfor instance:\n```html\n\u003cform action=\"https://www.coinbase.com/pusher/auth?callback=tothis\" method=\"POST\"\u003e\n\u003cinput type=\"hidden\" name=\"socket_id\" value=\"1.266427\"\u003e\n\u003cinput type=\"hidden\" name=\"channel_name\" value=\"private-549850166bb03f3b19000147-QPCIGVGojmUh1w\"\u003e\n\u003cinput type=\"submit\"\u003e\n\u003c/form\u003e\n```\nif I visit that URL I will get the json response, now persumably the channel_name would reset over time or when I log out. unfortunatly, that isn't true. if I log back in, that private channel_name would still result a token, in other words, never expiring and reusable. combining this with json parsing, it is possible for an attacker who knows the channel_name to steal the tokens, over and over.\n\nThanks,\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-22T22:37:48.547Z","allow_singular_disclosure_after":-130517566.3411006,"singular_disclosure_allowed":true,"vote_count":13,"voters":["bogdantcaciuc","bl4de","spam404","eveeez","r0p3","securitybreaker","t4ym","paulos_","japz","barakat","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":811661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you explain how exactly an attacker would be able to intercept the response from https://www.coinbase.com/pusher/auth?","automated_response":false,"created_at":"2016-02-24T23:22:52.754Z","updated_at":"2016-02-24T23:22:52.754Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":811727,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coinbase2 this will be helpful, I think: https://www.mbsd.jp/Whitepaper/xssi.pdf the UTF16BE , the proxy bug in Firefox and the IE bug leaks written in that paper will show how some browsers will be able to do that\n\nFor instance, in IE9 (example (B) in the paper): \n```javascript\n\u003cscript\u003ewindow.onerror=function(err){alert(err)}\u003c/script\u003e\n\u003cscript src=\"https://www.coinbase.com/accounts/549850166bb03f3a19000148/receive_address\" chartset=\"UTF-16BE\"\u003e\u003c/script\u003e\n```\nwill get the address of that account. not a serious bug, but you get the idea. can simply be mitigated by including things like })while(1){ like Google does on its sensetive JSON replies to mess with the response and thus make it unparsable.\n\nThanks,","automated_response":false,"created_at":"2016-02-24T23:47:55.016Z","updated_at":"2016-02-24T23:47:55.016Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":813453,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I'm going to do an audit of our JSON endpoints and ensure that all cookie-authenticated JSON endpoints are accessible exclusively via the POST method (with CSRF protection enabled).\n\nThat should fix this entire class of vulnerabilities.\n","automated_response":false,"created_at":"2016-02-25T23:53:52.897Z","updated_at":"2016-02-25T23:53:52.897Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":870648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coinbase2 ping.","automated_response":false,"created_at":"2016-03-25T08:41:54.791Z","updated_at":"2016-03-25T08:41:54.791Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":871390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The endpoint you pointed out is actually the only one I could find that could conceivably leak information. It has since been modified to use the POST method, which should fix the issue you reported.\n\nCan you confirm this resolves the report?\n","automated_response":false,"created_at":"2016-03-25T18:28:14.627Z","updated_at":"2016-03-25T18:28:14.627Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":871759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes. Fixed.","automated_response":false,"created_at":"2016-03-25T21:34:23.828Z","updated_at":"2016-03-25T21:34:23.828Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":871837,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-03-25T22:19:38.952Z","updated_at":"2016-03-25T22:19:38.952Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"paulos_","url":"/paulos_"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":871842,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-03-25T22:22:31.901Z","updated_at":"2016-03-25T22:22:31.901Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"paulos_","url":"/paulos_"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coinbase2 @coinbase thanks. btw, this can be exploited in all browsers, not just the once mentioned in above papers. if you'd like a poc, please revert the fix and I give you a poc working in all browsers. thanks,","automated_response":false,"created_at":"2016-04-15T13:39:00.304Z","updated_at":"2016-04-15T13:39:00.304Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1861271,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-07-23T22:37:48.528Z","updated_at":"2017-07-23T22:37:48.528Z","first_to_agree":true,"actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1947336,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-22T22:38:07.789Z","updated_at":"2017-08-22T22:38:07.789Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2514722,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2018-03-21T14:47:53.074Z","updated_at":"2018-03-21T14:47:53.074Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}