{"id":1195593,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTk1NTkz","url":"https://hackerone.com/reports/1195593","title":"Talk discloses turn server to anybody","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2021-05-13T13:16:08.787Z","submitted_at":"2021-05-13T13:16:08.844Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-05-26T10:52:32.962Z","bug_reporter_agreed_on_going_public_at":"2021-05-18T09:31:59.639Z","team_member_agreed_on_going_public_at":"2021-05-26T10:52:32.882Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The attack is straight forward.\n\n1. send a request to\n\n```bash\ncurl -H 'OCS-APIREQUEST: true' https://server/ocs/v2.php/apps/spreed/api/v2/signaling/settings\n```\n\nAnd you get back a lot of information.\n\n* signaling server\n* stun server\n* turn server (inc credentials)\n\nThe stun server is harmless enough. I did not look at the signaling server.\nHowever the Turn server (esp inc credentials). Can be used by the attacker to proxy their web traffic trough.\nEsp in combination with your docs: https://github.com/nextcloud/spreed/blob/master/docs/TURN.md\n\nThis would allow the access internal network on the turn server.\n\n## Impact\n\nAnybody (they do not even have to have a valid talk room) can request the turn server credentials of a Nextcloud server running Talk.\nIn combination with your guides on how to set those things up this can result in dangerous situations.\n\nI would furthermore advise to as a start only hand out turn credentials to guests that at least have access to a room.\nAnd to improve the documentation.","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["wi11","3x3s","nshcysec","ekgaribadmi","adass"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":14804,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/spreed","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11733086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-05-13T13:16:09.230Z","updated_at":"2021-05-13T13:16:09.230Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11769199,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for your report.\nWe filled an internal ticket and will get back to you after our findings.","automated_response":false,"created_at":"2021-05-17T06:30:33.349Z","updated_at":"2021-05-17T06:30:33.349Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11786691,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I think this was reported before but anyway:\nTickets are valid 24h only: https://github.com/nextcloud/spreed/blob/d1b6143b6bbd0b7c33fe298b63d2a74c06b012e6/lib/Config.php#L247-L251\nbut yeah you could script it to replace it all 20h and abuse it but that's just how it is for now.\n\nThe issue is mobile clients don't join the room before getting signaling info. But yeah maybe we only allow it for logged in users or guests with a valid \"joined a conversation\" session at some point. For now this is accepted risk and intended behaviour.","automated_response":false,"created_at":"2021-05-18T09:26:38.535Z","updated_at":"2021-05-18T09:26:38.535Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11786736,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Fair enough. I would still recommend to update the documentation to avoid issues with customers here.","automated_response":false,"created_at":"2021-05-18T09:31:59.666Z","updated_at":"2021-05-18T09:31:59.666Z","first_to_agree":true,"actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11890708,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-26T10:52:32.903Z","updated_at":"2021-05-26T10:52:32.903Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11890709,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-26T10:52:33.001Z","updated_at":"2021-05-26T10:52:33.001Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}