{"id":1202590,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjAyNTkw","url":"https://hackerone.com/reports/1202590","title":"Webauthn tokens are not removed on user deletion","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-05-19T12:07:33.341Z","submitted_at":"2021-05-19T12:07:33.427Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-32726"],"singular_disclosure_disabled":false,"disclosed_at":"2021-08-07T14:28:53.107Z","bug_reporter_agreed_on_going_public_at":"2021-07-08T14:28:48.766Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. userA has an account on serverA\n2. userA enables passwordless login (webauthn) and registers a key/device\n3. userA is removed from the system\n4. a new user comes along and gets assigned userA as id\n5. the old userA tries to login with their key\n6. the old userA can see all data of the new userA\n\n## Impact\n\nThis can lead to an unauthorized actor gaining full access to the data of another user.\nAs suggested in https://hackerone.com/reports/1200700 a blocklist of old userids would help here. However the data should all be cleaned up as well of course!","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-08-07T14:28:48.826Z","allow_singular_disclosure_after":-5612595.420751904,"singular_disclosure_allowed":true,"vote_count":6,"voters":["h4x0r_dz","akashhamal0x01","cryptographer","bathos","rooshan","userinput"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11805745,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-05-19T12:07:33.820Z","updated_at":"2021-05-19T12:07:33.820Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11805785,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. I've filed an internal issue.","automated_response":false,"created_at":"2021-05-19T12:13:00.521Z","updated_at":"2021-05-19T12:13:00.521Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11810058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschkenc general question is it worth it to look for more things like this? Since the solution is pretty similar everywhere.","automated_response":false,"created_at":"2021-05-19T17:46:15.029Z","updated_at":"2021-05-19T17:46:15.029Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11810177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think there are two components here:\n\n1. Gaining access to other peoples data\n2. Lack of deletion which may potentially be a compliance concern\n\nOur current thought is to bundle #1 inside one bounty, as the technical fix can likely always be: \"Disallow reusing of usernames\". (and issue a combined bounty) - So more occurrences here would likely not increase a bounty.\n\nWith regard to not deleting data this may still be independently bounty worthy (and for sure we'd like to know!), but here it also depends on what precisely and the impact. (and generally would be a significantly lower bounty)","automated_response":false,"created_at":"2021-05-19T17:55:29.495Z","updated_at":"2021-05-19T17:55:29.495Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11810267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the honest reply. I'll see if I have some time to dig a little deeper one of these days. ","automated_response":false,"created_at":"2021-05-19T18:03:20.129Z","updated_at":"2021-05-19T18:03:20.129Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11895922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are currently exploring how we can disallow the reuse of usernames. The changes are however non-trivial due to the fact that this affects a lot of our testing infrastructure (https://github.com/nextcloud/server/pull/27105).\n\n","automated_response":false,"created_at":"2021-05-26T19:30:01.791Z","updated_at":"2021-05-26T19:30:01.791Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11900124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As mentioned this is indeed the best approach I think!\nBut judging from the code I saw this is probably no easy undertaking as your code base is not as decoupled as one would like. Good luck.","automated_response":false,"created_at":"2021-05-27T09:26:25.386Z","updated_at":"2021-05-27T09:26:25.386Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11900133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"██████","automated_response":false,"created_at":"2021-05-27T09:27:25.733Z","updated_at":"2021-06-28T13:27:27.028Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12143782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The WebAuthn specific issue has been handled at https://github.com/nextcloud/server/pull/27532","automated_response":false,"created_at":"2021-06-16T15:08:32.106Z","updated_at":"2021-06-16T15:08:32.106Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12223842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That looks like a proper fix indeed. I take it the blocking of username reuse is proving more problematic than anticipated?","automated_response":false,"created_at":"2021-06-23T18:19:13.016Z","updated_at":"2021-06-23T18:19:13.016Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12223912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did you reach an agreement on the bounty btw? As https://hackerone.com/reports/1200700 is also closed without one.","automated_response":false,"created_at":"2021-06-23T18:28:39.539Z","updated_at":"2021-06-23T18:28:39.539Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12271997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Draft advisory is at https://github.com/nextcloud/security-advisories/security/advisories/GHSA-6qr9-c846-j8mg\n\n\u003e I take it the blocking of username reuse is proving more problematic than anticipated?\n\nThis is unfortunately the case, as the code is historically quite a bit grown and we need to invest more time in this. I hope we'll be able to include this in Nextcloud 23.","automated_response":false,"created_at":"2021-06-28T13:33:56.043Z","updated_at":"2021-06-28T13:33:56.043Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12272000,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This will be resolved in our next maintenance releases and we're working on the advisories at the moment.","automated_response":false,"created_at":"2021-06-28T13:34:12.223Z","updated_at":"2021-06-28T13:34:12.223Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rtod","url":"/rtod"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12272003,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"We are going to merge this award with #1200700.","automated_response":false,"created_at":"2021-06-28T13:34:39.910Z","updated_at":"2021-06-28T13:34:39.910Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12289300,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-06-29T15:57:24.278Z","updated_at":"2021-06-29T15:57:24.278Z","cve_ids":["CVE-2021-32726"],"actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12401842,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-08T14:28:48.795Z","updated_at":"2021-07-08T14:28:48.795Z","first_to_agree":true,"actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12871901,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-08-07T14:28:53.152Z","updated_at":"2021-08-07T14:28:53.152Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}