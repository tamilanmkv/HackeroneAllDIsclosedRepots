{"id":123125,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjMxMjU=","url":"https://hackerone.com/reports/123125","title":"XSS on hardware.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-15T01:03:38.664Z","submitted_at":"2016-03-15T01:03:38.664Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"virtualhunter","url":"/virtualhunter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-09T00:03:05.637Z","bug_reporter_agreed_on_going_public_at":"2016-04-09T00:03:05.408Z","team_member_agreed_on_going_public_at":"2016-04-04T22:47:31.507Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This is stored vulnerability for all your users, not only registered or signed in.\n\nVulnerable parameter: properties[builder_id] at *.shopify.com/cart/add\nThe vulnerability is in array levels. When you try something like \nproperties[builder_id][second_parameter]=value,\nyou will see many corrupted tags in HTML because 2-level array will return as \n\"builder_id\":{\"second_parameter \":\"value\"} instead of \"builder_id\":\"shapp_options_421549285_1455208671885\" in cart.js\n\nSo you could inject your code in tr,div,a,insert  tags. All you need - is redirect a victim to special url. For example, you cold try this: properties[builder_id][%20onmouseover%3dalert(1)%20]=value \nScript will strike when victim will move a coursor over product.\n\nHere is a link with your cookies in a harware store for example:\nhttp://hardware.shopify.com/cart/add?\u0026id=1106494145\u0026iPad%20Stand=1120276481\u0026Cash%20Drawer=1120176153\u0026Receipt%20Printer=1120166789\u0026attributes[cart_exists]=true\u0026properties[builder_id][%20onmouseover%3dalert(document.cookie)%20]=shapp_options_421549285_1455208671885\u0026properties[master_builder][]=1\u0026properties[test]=test\u0026properties[value]=11\u0026add\n\nI recommend you to check incoming parameters for arrays like here:\nhttp://php.net/manual/en/function.is-array.php","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":78845,"file_name":"shopify.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/078/845/797e9ac5983f4f4e163ca1ec78428578f85ef582/shopify.jpg?response-content-disposition=attachment%3B%20filename%3D%22shopify.jpg%22%3B%20filename%2A%3DUTF-8%27%27shopify.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJIO5LUY%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133330Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJGMEQCIDSzlg00hmiY8SKrGreVtNoMLQjEiCw6t6oEyA%2FsmU%2BXAiBpyUu02MMoiYLrZvREKmQg5iFaXBaQDOAfdsodU%2FdTzyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMt%2BNu9EHH6F1YrtDrKtcDlxN7DtwGfMbt4FPWDeJ%2Bv9c5rbIcX9cAEEqxJYLzJL7XQby13DWG5FPcm6FyEelS9pS99w608bFzjC3LswJsF3ziB00J0zddGDnpoT1EleYU3VzD3ULK1rar1tG4vFfsR40ftI4fxgz8xygldUPfGmR6yoOKn3s0gewUOGtFb48fR93fy%2BhyDsoMniu93hqO3QsrTYxgXAMOyZYH4KWCax6nWcKcVM97S1TSOm8t9SZ0HgbWWC46ZBj1pAotwtOa4CfLOrRYqmRpEQ4W%2BXz69nDHRZrLiyfHJRB1AfQla3UZmjt27KLWN2H9qRHZ0bgVCnxPnDLifs2wCJG%2FEGhEDB0romYWRi2gNFBtMkZv0GGsq0ZOWswyvgfzoVbJJdTeWGaYGRZo8I8u4pA%2BY4ESQTGVdcUMDVdV%2Bb3JJTvFZY4EkMEQ32hDhw8FFMRAksf7L2TRHc1bldE8HF7rc%2Fj9%2FV2JFNqie6zPYkKlg6yVUO%2Ff0hgwHlvWGpYo%2FB8wnvZIpuQqzfqMbiz9kmutD4jbKXpteFa8z%2BwK3GVY%2FueaXvEW06A3Nb0cHPdu7HPOe71hzSq47V89FBmfHgFBtMypOO%2BW0bmvb9v7eDmUbX7YY%2B%2BMsmyl1tehMMvEkIsGOqYBH3NvJOPeh%2FYCJz529hl3JFXiZ4mIrcvr4pynox0h4Mp1nIPFOWMxUGxA%2FVzT%2BE178l8UQb%2BPYHhLxS5Eirk9gIzgjO%2FbybMlO0U6498Dz8lERZ3gNZVXPq4Pqfzhsb1Cnp4vQTuTTBGNHQUXRg78H56AMeStnoBGp9yuAWo2l5Y3GyRZ0XiMw%2Fi3C2ml9dQKwQ1QZs5b03K5hnqatzca0ZPYcMaJeQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=14d5c59e2ccc26cbfea6ce2ce9a7832a397c31545145eb5e44cb502d07026b8e","file_size":167693,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-05-04T22:47:31.705Z","allow_singular_disclosure_after":-171557158.84593695,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mashoud1122","b6117130df17feef13481e3","sameerphad72","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":840617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You should understand, that not only one parameter affected. It is a whole vector, reducing to malformed code, depends on input parameters. So you should include better checking for all your data input.","automated_response":false,"created_at":"2016-03-15T10:36:42.069Z","updated_at":"2016-03-15T10:36:42.069Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":841719,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2016-03-15T19:37:18.991Z","updated_at":"2016-03-15T19:37:18.991Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":848451,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has now been resolved.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2016-03-18T14:56:46.166Z","updated_at":"2016-03-18T14:56:46.166Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"virtualhunter","url":"/virtualhunter"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":849835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to hear! Looks fixed :)","automated_response":false,"created_at":"2016-03-19T10:53:25.922Z","updated_at":"2016-03-19T10:53:25.922Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888705,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved","automated_response":false,"created_at":"2016-04-04T22:47:18.764Z","updated_at":"2016-04-04T22:47:18.764Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"virtualhunter","url":"/virtualhunter"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":888706,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-04T22:47:31.532Z","updated_at":"2016-04-04T22:47:31.532Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":896917,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you! Disclosing :)","automated_response":false,"created_at":"2016-04-09T00:03:05.444Z","updated_at":"2016-04-09T00:03:05.444Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":896918,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-09T00:03:05.656Z","updated_at":"2016-04-09T00:03:05.656Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164662,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2016-08-31T13:05:59.439Z","updated_at":"2018-02-28T13:10:45.720Z","additional_data":{"added_weaknesses":[],"removed_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}