{"id":124889,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjQ4ODk=","url":"https://hackerone.com/reports/124889","title":"Websites opened from reports can change url of report page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-21T23:47:18.780Z","submitted_at":"2016-03-21T23:47:18.780Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-21T11:00:26.198Z","bug_reporter_agreed_on_going_public_at":"2016-04-21T11:00:26.123Z","team_member_agreed_on_going_public_at":"2016-04-21T04:23:19.376Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Websites opened from the a hackerone report can change the url of the report page. For example, clicking on a link set to \"http://d214mfsab.org/same.html\" (including this one) will change the still-open report page to http://example.com. This works on current versions of Safari (including mobile) and possibly other browsers.\n\nThis vulnerability can lead to phishing attacks, where the user changes the url of the report page to a similar-looking page. Users would trust the tab with the report open to remain the same, and would be unsuspecting.\n\nThis is due to mishandling of the 'target=\"_blank\"' option.\n\nTo reproduce:\n\n1. In any html page (does not need to be the same origin), add the javascript \"opener.location = 'http://example.com'\". For this, I created http://d214mfsab.org/same.html\n2. Add this url to a hackerone report.\n3. When a user clicks on this url, the original report page's url will be changed to a potentially malicious url.\n\nA malicious user could modify the report page to an extremely similar page, which a user would be unlikely to notice. An attacker could duplicate the entire report page, and present a login form, which would steal the user's password.\n\nAlthough the user is warned about following links, this is not sufficient protection, as hackerone should ensure that pages cannot modify the report url.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-21T04:23:19.432Z","allow_singular_disclosure_after":-170154674.16858655,"singular_disclosure_allowed":true,"vote_count":5,"voters":["cablej","eveeez","temmyscript","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":861427,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Which specific fields are you able to do this in? You state \"Websites opened from the a hackerone report\", but when you have an external link in a report it will open our interstitial redirect page in a new tab which exposes the url on the proceed button link without `target='_blank'`. Please provide what fields you are referring to.","automated_response":false,"created_at":"2016-03-22T00:41:39.028Z","updated_at":"2016-03-22T00:41:39.028Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":861445,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"This occurs as a combination of clicking a link in a report and clicking the \"proceed\" button on the redirect page. This is possible as the \"window.opener\" variable is set to the tab with the report open, allowing a malicious user to change the url of the open tab. In order to prevent this, the \"window.opener\" variable must be set to null. Oddly enough, in the redirect page, the variable *is* null, but is set to the original report tab when the external page is opened.\n\nAs an example, clicking the following link in Safari on iOS or Mac and proceeding on the redirect page will change this page to example.com:\n\nhttp://d214mfsab.org/same.html","automated_response":false,"created_at":"2016-03-22T01:16:55.111Z","updated_at":"2016-03-22T01:16:55.111Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":861921,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-03-22T13:30:15.856Z","updated_at":"2016-03-22T13:30:15.856Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":877840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cablej,\n\nI noticed it's been a while since you got a last public reply, sorry about that. We're looking into this report, and trying decide what the best solution is here. Please stay tuned!","automated_response":false,"created_at":"2016-03-30T11:44:15.109Z","updated_at":"2016-03-30T11:44:15.109Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":879360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the response! Looking forward to hearing back.","automated_response":false,"created_at":"2016-03-31T02:32:58.297Z","updated_at":"2016-03-31T02:32:58.297Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cablej,\n\nWe attempted to fix this by using `target: \"_blank\"` if the browser is Safari. The issue doesn't exist on either Chrome nor Firefox.\n\nCould you please confirm that this resolves the issue?","automated_response":false,"created_at":"2016-04-01T11:50:13.967Z","updated_at":"2016-04-01T11:50:13.967Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":882588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've tested this on Safari for iOS, and can confirm that it is fixed. I will verify this later today on Safari for Mac.","automated_response":false,"created_at":"2016-04-01T13:24:05.526Z","updated_at":"2016-04-01T13:24:05.526Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":889318,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-04-05T08:57:07.784Z","updated_at":"2016-04-05T08:57:07.784Z","actor":{"username":"rso","cleared":false,"url":"/rso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/031/bad304b45f09b089c121de18c65d91d226f0aeea_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":896603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, I'm wondering if this report is eligible for a bounty.\n\nThanks,\nJack","automated_response":false,"created_at":"2016-04-08T20:55:00.813Z","updated_at":"2016-04-08T20:55:00.813Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @cablej!\n\nSo sorry for the delay, it's been a hectic week. We're looking into this, and will get back to you soon!\n\n\nEvan","automated_response":false,"created_at":"2016-04-19T18:30:16.048Z","updated_at":"2016-04-19T18:30:16.048Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":919465,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks, @cablej, for this report. We appreciate your finding, and we welcome future reports like this in the future.\n\nHappy hacking!","automated_response":false,"created_at":"2016-04-21T04:22:59.824Z","updated_at":"2016-04-21T04:22:59.824Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"cablej","url":"/cablej"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":919466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-21T04:23:19.401Z","updated_at":"2016-04-21T04:23:19.401Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":920014,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-21T11:00:26.144Z","updated_at":"2016-04-21T11:00:26.144Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":920015,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-21T11:00:26.217Z","updated_at":"2016-04-21T11:00:26.217Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1732,"category":"team","content":"This issue is similar to #23386, though only exploitable via Safari.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":3132,"username":"reed","name":"Reed Loden","bio":"The guy who does the thing. Security @ HackerOne.","cleared":false,"website":"https://reedloden.com","location":"San Francisco, CA","created_at":"2014-02-27T22:34:29.323Z","url":"https://hackerone.com/reed","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}