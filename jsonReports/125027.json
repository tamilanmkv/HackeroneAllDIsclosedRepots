{"id":125027,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjUwMjc=","url":"https://hackerone.com/reports/125027","title":"Reflected XSS on developer.uber.com via Angular template injection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-22T17:35:37.948Z","submitted_at":"2016-03-22T17:35:37.948Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-04T22:24:46.843Z","bug_reporter_agreed_on_going_public_at":"2016-03-31T17:39:41.756Z","team_member_agreed_on_going_public_at":"2016-04-04T22:24:46.363Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"developer.uber.com is vulnerable to reflected XSS via Angular template injection.\n\nThe following url demonstrates the root issue using a trivial payload: https://developer.uber.com/docs/deep-linking?q=wrtz{{7*7}}\n\nIf you view the rendered source of the resulting page, you'll find the string 'wrtz49', showing the input has been evaluated.\n\nThis URL uses an Angular sandbox escape to obtain arbitrary JavaScript execution and execute alert(1). It's designed to work in Internet Explorer 11, but the technique could probably be used to target other browsers given sufficient effort. I've attached a screenshot of the result.\n`https://developer.uber.com/docs/deep-linking?q=wrtz{{(_=\"\".sub).call.call({}[$=\"constructor\"].getOwnPropertyDescriptor(_.__proto__,$).value,0,\"alert(1)\")()}}zzzz`\n\n\nClient-side template injection vulnerabilities arise when applications using a client-side template framework dynamically embed user input in web pages. When a web page is rendered, the framework will scan the page for template expressions, and execute any that it encounters. An attacker can exploit this by supplying a malicious template expression that launches a cross-site scripting (XSS) attack. For further information on this technique, please refer to http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html\n\nIf possible, avoid using server-side code to dynamically embed user input into client-side templates. If this is not practical, consider using the ng-non-bindable directive or filtering out { and } from user input. Upgrading Angular may prevent this particular sandbox escape from working, but is not a robust fix as Angular maintain that the sandbox isn't a security feature and can't be trusted.\n\nThis vulnerability could be used to hijack developer accounts and associated apps.\n\n\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":80391,"file_name":"Screen_Shot_2016-03-22_at_16.51.13.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/080/391/2b7e7114b53c85300ad7415e7c194467ba9747cf/Screen_Shot_2016-03-22_at_16.51.13.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-03-22_at_16.51.13.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-03-22_at_16.51.13.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133441Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3f3eec54a0205aecbb7129708c481f9dcd2d97a761b8ad23e033e4823f694ef4","file_size":80095,"type":"image/png"}],"allow_singular_disclosure_at":"2016-04-30T17:39:42.277Z","allow_singular_disclosure_after":-171921299.33862415,"singular_disclosure_allowed":true,"vote_count":28,"voters":["albinowax","michiel","dawgyg","spam404","remonsec","mak","glc","brodie_codie","harry_mg","apapedulimu","and 18 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":863212,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, thanks for your report. \n\nWe're having trouble reproducing the findings that you've reported. In our testing, we're not seeing any JavaScript being executed. If you think we've missed something, please let us know. Any additional images, or a video, that demonstrates the issue would also help us to evaluate this report. \n\nThanks and good luck in your future bug hunting. ","automated_response":false,"created_at":"2016-03-22T21:07:49.988Z","updated_at":"2016-03-22T21:07:49.988Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":863417,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Are you using Internet Explorer 11? If so,  I'm not sure why it wouldn't work. I've tested it on both windows 7 and 10.  I've attached a video showing what you should see.","automated_response":false,"created_at":"2016-03-22T22:14:42.013Z","updated_at":"2016-03-22T22:14:42.013Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":80517,"filename":"uberxss.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/080/517/3544a6152f9bbd299fe458cae7b894c30ea49cb5/uberxss.mp4?response-content-disposition=attachment%3B%20filename%3D%22uberxss.mp4%22%3B%20filename%2A%3DUTF-8%27%27uberxss.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133441Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=057f3bdc72763037b3a43b1f5d36934cc7ccdcb349a8c4a6818c4e041ff4275b"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":863861,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @albinowax, thanks for the report!\n\nYep, we forward through to https://uber.readme.io/docs/ for the documentation, and it looks like they're doing some templating on their Angular templates before serving them. I'm going to reach out to them to get this fixed!","automated_response":false,"created_at":"2016-03-23T02:35:59.126Z","updated_at":"2016-03-23T02:35:59.126Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":866263,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"[readme.io](https://readme.io) just released a fix for this, and I can verify that user input is no longer reflected on the page and your PoC no longer reproduces. Can you verify that it's no longer vulnerable?","automated_response":false,"created_at":"2016-03-23T23:40:45.472Z","updated_at":"2016-03-23T23:40:45.472Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":869077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks good to me.","automated_response":false,"created_at":"2016-03-24T11:12:41.326Z","updated_at":"2016-03-24T11:12:41.326Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":873250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you clarify whether this is in scope for a bounty? I had assumed that it was, because developer.uber.com is explicitly listed as being in scope on https://eng.uber.com/bug-bounty/","automated_response":false,"created_at":"2016-03-27T17:26:24.282Z","updated_at":"2016-03-27T17:26:24.282Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":875666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Sorry, I should have clarified. This is definitely in scope for the bounty. Even though the vulnerable code wasn't written by us, the payload executes on `developer.uber.com` and doesn't rely on an unpatched browser.\n\nWe do payouts in batches, but once we've determined an amount for the bounty you should get a notification via HackerOne.\n\nThanks again for the report!\n-Jordan","automated_response":false,"created_at":"2016-03-29T00:42:13.525Z","updated_at":"2016-03-29T00:42:13.525Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, good good.\n\nI've got a payload which will work on all browsers now. The reason the original payload didn't work on Firefox/Chrome is that those browsers URL-encode \" and ' which breaks the sandbox escape. We've now managed to concoct a sandbox escape that doesn't rely on \" or ': http://jsfiddle.net/8jd84f44/","automated_response":false,"created_at":"2016-03-29T13:39:15.686Z","updated_at":"2016-03-29T13:39:15.686Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":880355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-31T17:39:41.782Z","updated_at":"2016-03-31T17:39:41.782Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888649,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-04T22:24:46.391Z","updated_at":"2016-04-04T22:24:46.391Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888650,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-04T22:24:46.861Z","updated_at":"2016-04-04T22:24:46.861Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome - payload that works on all browsers is great. Will get this paid out in our next batch which should be in the next week or two","automated_response":false,"created_at":"2016-04-04T22:28:53.796Z","updated_at":"2016-04-04T22:28:53.796Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901684,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @albinowax,\n\nThanks again for the great bug and good luck bug hunting in the future!","automated_response":false,"created_at":"2016-04-12T16:58:17.444Z","updated_at":"2016-04-12T16:58:17.444Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}