{"id":125594,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU1OTQ=","url":"https://hackerone.com/reports/125594","title":"CSRF on eng.uber.com may lead to server-side compromise","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-24T01:49:54.915Z","submitted_at":"2016-03-24T01:49:54.915Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jouko","url":"/jouko","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-26T16:08:57.530Z","bug_reporter_agreed_on_going_public_at":"2016-04-12T08:56:18.368Z","team_member_agreed_on_going_public_at":"2016-04-26T16:08:57.449Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The site *eng.uber.com* uses a WordPress plugin called Fluid Responsive Slideshow. The plugin doesn't implement any CSRF check for AJAX requests. Some of these AJAX requests can be used to modify posts and pages on the system. An attacker could use this bug to inject arbitrary JavaScript in any page or post on eng.uber.com.\n\nThe attack requires that an administrator of the site can be tricked to view an attacker-controlled website. If the attack succeeds, it would normally lead to server-side compromise via the administrative WordPress functions (plugin/theme editor).\n\n#Reproducing#\nThe following HTML snippet should be a non-destructive way to test this bug. \n~~~~\n\u003cform method=post action=\"https://eng.uber.com/wp-admin/admin-ajax.php?action=frs_show_modal\"\u003e\n\u003cinput type=text name=\"post_id\" value=\"zzz\"\u003e\n\u003cinput type=submit\u003e\n\u003c/form\u003e\n~~~~\nIf a logged-in WordPress user clicks the submit button, the browser should do a POST request and get a JSON response (it doesn't matter that the post_id is bogus). This shows that it's possible to access the AJAX functions of the plugin without any CSRF token or nonce. A non-logged-in user receives just a \"0\".\n\nAn attacker could use the following HTML to arbitrarily modify any page or post on the system (**destructive**):\n~~~~\n\u003cform method=post action=\"https://eng.uber.com/wp-admin/admin-ajax.php?action=frs_save\"\u003e\n\u003cinput type=text name=\"post_id\" value=\"(ANY POST/PAGE ID)\"\u003e\n\u003cinput type=text name=\"title\" value=\"new title for the page\"\u003e\n\u003cinput type=text name=\"content\" value=\"Any HTML content, e.g. \u003cscript\u003ealert('hello');\u003c/script\u003e\"\u003e\n\u003cinput type=submit\u003e\n\u003c/form\u003e\n~~~~\nAn attacker would have to persuade a logged-in administrator to this form. It can be automatically submitted with JavaScript so a real-world attack wouldn't require a click on the button. \n\nThe frs_save AJAX action would update the post/page with the supplied ID. For example if the latest posting ID is used, the attacker-supplied JavaScript would be embedded on the \"front page\" and evaluated by any viewer. \n\nA more stealth attack might update an old or password-protected page/post and embed JavaScript that redirects the victim administrator  to that page after updating (an invisible iframe might be possible). This kind of attack wouldn't be easily detected. In this case the JavaScript, now executing with administrator privileges, could be used to execute attacker-supplied PHP on the server via the plugin or theme editor.\n\nAn example of such attack payload (different vector): https://www.youtube.com/watch?v=OCqQZJZ1Ie4\n\n\n#Details#\n\nThe problem is in the file wp-content/plugins/fluid-responsive-slideshow/ajax.php:\n\n~~~~\n/**\n * Ajax Save, Edit / Create new is the same, depend on the post id (null/not null)\n */\nadd_action('wp_ajax_frs_save', 'frs_save' ); /* for logged in user */\n\nfunction frs_save() {\n    global $wpdb; // this is how you get access to the database\n    unset($_POST['action']);\n    $id = htmlspecialchars($_POST['post_id']);\n~~~~\nThe AJAX handler function doesn't attempt to reject cross-site request forgeries which would typically happen in the beginning of the function. Later in the same function, the POST parameters are used to update any post or page:\n~~~~\n       //edit post\n        $slide_type = htmlspecialchars($_POST['slide_type']);\n        $title = htmlspecialchars($_POST['title']);\n        $content = $_POST['content'];\n        // Create post object\n        $my_post = array(\n          'post_title'    =\u003e $title,\n          'post_content'  =\u003e $content,\n          'ID'=\u003e$id\n        );\n        // Insert the post into the database\n        wp_update_post( $my_post );\nÌƒ~~~~\n\nI've tested this with the latest version of the plugin, and version 2.2.0 which seems to be the one used on eng.uber.com. I haven't reported this to the plugin author yet.","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-12T08:56:18.930Z","allow_singular_disclosure_after":-170915924.50410104,"singular_disclosure_allowed":true,"vote_count":3,"voters":["japz","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":875367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, as an update we're working on getting admin accounts for our Wordpress instances so we can validate this. Please be patient with us during this process :)","automated_response":false,"created_at":"2016-03-28T21:43:26.202Z","updated_at":"2016-03-28T21:43:26.202Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jouko I just tried your proof of concept and I get a `0` as the response which I think indicates this didn't work based off of this statement:\n\u003eA non-logged-in user receives just a \"0\".\n\nHere's the full request:\n```http\nPOST /wp-admin/admin-ajax.php?action=frs_show_modal HTTP/1.1\nHost: eng.uber.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:45.0) Gecko/20100101 Firefox/45.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: [REDACTED]\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 11\n\npost_id=zzz\n```\n```http\nHTTP/1.1 200 OK\nServer: nginx\nVary: Accept-Encoding\nCache-Control: no-cache, must-revalidate, max-age=0\nContent-Type: text/html; charset=UTF-8\nDate: Tue, 29 Mar 2016 17:56:27 GMT\nKeep-Alive: timeout=20\nExpires: Wed, 11 Jan 1984 05:00:00 GMT\nPragma: no-cache\nX-Type: default\nX-Content-Type-Options: nosniff\nConnection: close\nX-Robots-Tag: noindex\nX-Frame-Options: SAMEORIGIN\nContent-Length: 1\n\n0\n```\n\nLet me know if I'm missing something here! Thanks :)","automated_response":false,"created_at":"2016-03-29T18:03:00.948Z","updated_at":"2016-03-29T18:03:00.948Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876705,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The plugin appears to have been disabled after I filed this report. Instead of the slideshow presentation there's just a static image now. If you view the source of the page in question, there are no references to Fluid Responsive Slideshow any more. Archive.org's version earlier in March has it. I confirmed the plugin was in use before submitting the report.\nhttp://web.archive.org/web/20160304012340/https://eng.uber.com/rescued-by-octopus/","automated_response":false,"created_at":"2016-03-29T18:14:41.334Z","updated_at":"2016-03-29T18:14:41.334Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876739,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah shoot, the Wordpress admin for this site may have deleted it - looking into this now.","automated_response":false,"created_at":"2016-03-29T18:27:26.021Z","updated_at":"2016-03-29T18:27:26.021Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876751,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ah! I think it was removed because of this other bug you submitted: #125441. Since that is the case I'm going to close this as `Resolved`. It appears there is some debate on if we want to renable this plugin (because we want the functionality it provides) so this plugin may come back. \n\nMarking as `Resolved` for now, as an aside have you made the author aware of this vulnerability?","automated_response":false,"created_at":"2016-03-29T18:33:00.108Z","updated_at":"2016-03-29T18:33:00.108Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jouko","url":"/jouko"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":876757,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Right. I haven't reported these to the author yet, will do it today.","automated_response":false,"created_at":"2016-03-29T18:35:30.223Z","updated_at":"2016-03-29T18:35:30.223Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":900588,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Hey @jouko! Thanks again for the report. Sorry about being a bit slow in responding, we've had a lot of reports to go through recently! Since the cause of and fix for this issue is the same as your other report #125441 the team has decided to consider them duplicates with regard to reward. We hope this is understandable. Good luck with future research!","automated_response":false,"created_at":"2016-04-12T00:46:35.451Z","updated_at":"2016-04-12T00:46:35.451Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901003,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Bugs #125441 and this one are completely separate bugs with different causes, and XSS and a CSRF. Their impacts are also very different - this CSRF allows the attacker to fully control the content on the site to cause \"brand damage\". It's also possible to store any HTML and JavaScript and thus target all users who view the site. As I also demonstrated, this leads to RCE if a site administrator is targeted.\n\nThe only thing in common is that the bugs happen in the same WordPress plugin. The fix is the same because you've chosen to remove the software package altogether. With the same logic, shutting down an entire site with several bugs would combine the cause and fix of all bugs there and you could reward only one bug with the lowest impact.","automated_response":false,"created_at":"2016-04-12T08:56:00.381Z","updated_at":"2016-04-12T08:56:00.381Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901004,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-12T08:56:18.401Z","updated_at":"2016-04-12T08:56:18.401Z","first_to_agree":true,"actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928839,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jouko, to clarify on this:\n\n\u003eWith the same logic, shutting down an entire site with several bugs would combine the cause and fix of all bugs there and you could reward only one bug with the lowest impact.\n\nWe did not reward the bug with the lowest impact, we rewarded the bug which had the highest impact. The flip side of this is that we could have one plugin with 20 different Cross-site Scripting (XSS) and Cross-site Request Forgery (CSRF) vulnerabilities. Paying out all of these separately would be unrealistic because the fix is the same for all of them - remove the bad plugin. For this reason paying out separately for each bug when the fix is the same can be dangerous and we usually lump the payments together (often bumping it up, as we did in your case).\n\n\u003eAs I also demonstrated, this leads to RCE if a site administrator is targeted.\n\nRemote code execution is only possible (as far as I'm aware) if the Wordpress administrator can edit plugins for the blog. This was not possible on eng.uber.com (I just checked by logging in as an admin) so I don't think RCE was possible. Let me know if I'm missing something on this.\n\nApologies for the confusion, we hope you will continue with our program. Either way we wish you luck in your future hacking and appreciate your well written report!","automated_response":false,"created_at":"2016-04-26T16:08:48.320Z","updated_at":"2016-04-26T16:08:48.320Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928840,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-26T16:08:57.485Z","updated_at":"2016-04-26T16:08:57.485Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928841,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-26T16:08:57.552Z","updated_at":"2016-04-26T16:08:57.552Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, publicly disclosed per your request. Thanks!","automated_response":false,"created_at":"2016-04-26T16:09:24.240Z","updated_at":"2016-04-26T16:09:24.240Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But on April 12 at #125441 (same plugin XSS) you explained you're \"paying out the maximum amount we would consider for a reflected XSS because our policy previously didn't make it clear the the stated amounts were maximums.\" Now you say the bounty was **not** for XSS, but this CSRF after all. Which of these conflicting explanations is true?\n\nThe fact that you \"just checked\" the RCE, weeks after the bounty was issued, also raises a question or two. This makes it clear the bug was just lumped together with the XSS and the bounty was decided without knowing the impact. How could the test you just made today explain the low bounty you issued weeks ago?\n\nWriting to the plugin directory is just one possible way to achieve code execution. If you had assessed the bug impact and told me it's lower than I reported, I could have tried giving other alternatives.","automated_response":false,"created_at":"2016-04-26T17:11:35.434Z","updated_at":"2016-04-26T17:11:35.434Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929190,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eNow you say the bounty was not for XSS, but this CSRF after all. Which of these conflicting explanations is true?\n\nI'm not sure I understand, where did I say that it was for CSRF? Perhaps I misspoke?\n\n\u003eThis makes it clear the bug was just lumped together with the XSS and the bounty was decided without knowing the impact.\n\nIIRC we did check the impact when we awarded the previous bounty. I was just verifying that our previous assessment was indeed valid (because if it was actually RCE then the bounty might've been inaccurate which is why I checked).\n\n\u003eWriting to the plugin directory is just one possible way to achieve code execution. If you had assessed the bug impact and told me it's lower than I reported, I could have tried giving other alternatives.\n\nCould you state some possible alternatives? I suppose I've just not heard of another way to achieve RCE when plugin editing is disabled in Wordpress. As stated before this could've been an incorrect assumption - which we'd be open to hearing more about.","automated_response":false,"created_at":"2016-04-26T21:01:07.414Z","updated_at":"2016-04-26T21:01:07.414Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's certainly a bit confusing. You explained that the #125441 bounty was the maximum you'd consider for a reflected XSS ($3k) because the policy didn't make it clear that the stated sums were maximums. That bounty was consistent with the original policy and your other bounties for reflected XSS's. This CSRF wasn't mentioned in that context.  I think I understood until that point.\n\nNow for CSRF+stored XSS (+RCE?) the logic no longer applies and the bounty is *not* the maximum for the bug type. Even without RCE the bug would seem to fit the description of \"significant issues\" ($5k) quite spot-on. Instead, there was no bounty at all in addition to the separate reflected XSS bug.\n\nHow CSRF+stored XSS (+RCE?) PLUS an unspecified bump-up bonus, PLUS a separate reflected XSS worth $3k still equals $3k remains elusive.\n\nIf there was a problem with my report and the impact wasn't what I stated, and *that's* why the second bug was worth nothing... then why didn't I hear about it until 15 days after the report was closed and the bounty issued? Disabling plugin editing most definitely doesn't prevent RCE if you can run JS with WP administrator privileges.\n","automated_response":false,"created_at":"2016-04-26T23:04:16.879Z","updated_at":"2016-04-26T23:04:16.879Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One way to escalate admin XSS to server-side execution seems to be via the \"wpengine-common\" plugin (I'm pretty sure there are other ways too). The details haven't probably been publicly discussed before and since it might have some implications, I'm not sure this is the right place to do it? I think it works on your other WP sites as well, so if there was a similar assumption behind the other bounties, maybe you can reconsider them too. I'll file a separate bug report about it.","automated_response":false,"created_at":"2016-04-27T01:49:58.482Z","updated_at":"2016-04-27T01:49:58.482Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929635,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"bug #134907","automated_response":false,"created_at":"2016-04-27T02:21:41.015Z","updated_at":"2016-04-27T02:22:08.925Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":930597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just as a quick note, a lot of this discussion has made us much more aware of some points of our bug bounty scoping page which are likely confusing to our submitters. I've drafted an update to our scoping page to more clearly explain how we do impact-based rewarding. The basic idea there is we reward based off of impact and don't reward less if an exploit \"wasn't clever\", etc (as some other bug bounty programs do). So this is why we would reward an exploit in a datacenter host more that a host on WPEngine, for example. At the end of the day we care about protecting our user's information, so any exploit which allows you to get that is something we are very concerned about. I apologize for the confusion here, we thought our impact-based rewarding would be obvious but clearly this isn't the case.\n\n\u003eIt's certainly a bit confusing. You explained that the #125441 bounty was the maximum you'd consider for a reflected XSS ($3k) because the policy didn't make it clear that the stated sums were maximums. \n\u003eInstead, there was no bounty at all in addition to the separate reflected XSS bug.\n\nSo this is two things put together:\n\n* We rewarded the maximum for the XSS because we weren't clear that 3K was the maximum amount in our first attempt at bug bounty scope\n* In the case of \"this plugin has 20 CSRF and 10 XSS bugs\" we reward for the highest impact bug (in this case XSS - which was 3K max). The idea here is that we could have a plugin with 20 different XSS bugs but it would be silly to reward 3K for each (60K!) when the end fix is the same - removing the plugin.\n\n\u003eHow CSRF+stored XSS (+RCE?) PLUS an unspecified bump-up bonus, PLUS a separate reflected XSS worth $3k still equals $3k remains elusive.\n\nI think the \"bumping\" statement was mispoken because it wasn't \"bumped\" up because it was already at the XSS maximum payout (as you noted).\n\n\u003eIf there was a problem with my report and the impact wasn't what I stated, and that's why the second bug was worth nothing... then why didn't I hear about it until 15 days after the report was closed and the bounty issued? Disabling plugin editing most definitely doesn't prevent RCE if you can run JS with WP administrator privileges.\n\nWe determined the impact at the time of the reward meeting. Generally researcher-provided impact is problematic because it makes a lot of assumptions about our internal infrastructure which is often incorrect. Debating impact back and forth is something we generally don't do because it eats up all of our time and wouldn't leave us with any time to process new submissions. Obviously this is a non-perfect process but the other option being us teaching every bug bounty submitter how all of our internal systems interact. That being said, with this statement:\n\n\u003eDisabling plugin editing most definitely doesn't prevent RCE if you can run JS with WP administrator privileges.\n\nAs I previously stated I am open to hearing how RCE could have been achieved here. If we missed something we are more than happy to take additional stated impact into account. It seems you have provided another possible exploit scenario which we will evaluate and get back to you on.","automated_response":false,"created_at":"2016-04-27T18:10:20.243Z","updated_at":"2016-04-27T18:10:20.243Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1260317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I demonstrated RCE with plugin editing disabled e.g. at #136169 which you also confirmed. The lack of bounty here was based on the misassumption that RCE would be impossible. The question was addressed about half a year ago - have you had a change to re-evaluate this yet?","automated_response":false,"created_at":"2016-10-21T16:00:32.617Z","updated_at":"2016-10-21T16:00:32.617Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}