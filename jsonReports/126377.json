{"id":126377,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjYzNzc=","url":"https://hackerone.com/reports/126377","title":"Changing Driver Passwords With Only an Authenticated Session (no password, no email)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-27T20:40:16.011Z","submitted_at":"2016-03-27T20:40:16.011Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T22:21:38.390Z","bug_reporter_agreed_on_going_public_at":"2016-03-28T14:01:35.919Z","team_member_agreed_on_going_public_at":"2016-06-13T22:21:38.271Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible to completely take over a driver's account with only an authenticated session. If a driver is logged on and wants to change their password, they will be asked for their current password (```changePassword.png```), but when they want to change their email, they are not asked for their current password (```changeEmail.png```).  Once a driver's email has been changed, it is trivial to reset their password through the password reset page (which only requires access to the driver's email account). \n\nSo the steps to take over a driver's account from an authenticated session are: \n\n1. Change the driver's email to something that is attacker controlled\n2. Log out\n3. Use the forgot your password page to have a reset link sent to the attacker controlled email\n4. Use the link to reset the driver's password\n\nIn order to fix this, you have to add password authentication for changing the email associated with the account (or do what you do for riders and not allow changing the email). \n\nThanks,\nDavid Dworken","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":81609,"file_name":"changePassword.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/609/c21b0832dc27d1f8d8f1702b308deb21dd2d2001/changePassword.png?response-content-disposition=attachment%3B%20filename%3D%22changePassword.png%22%3B%20filename%2A%3DUTF-8%27%27changePassword.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJF6VFL6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133534Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCID1So1KYRjOmBFJqLsqO1j9SSUCF9kJ%2FHqahOyDLmrnJAiAr2q5Z8bAgCyaCmyDSz7xwtmUTDOoz04myJOluBHRCeyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMvFUMWX6P00RsVarQKtcDflFFNScU3coA1YbnKy4lPXtwGDNsJcqhfcCTaePuAuK6nWvl5xRbjzjOBPvBHaTAnb2Iw%2B6Jdj2uyjmRMn%2F5%2F5AzD5di2wWOcC0am9iLaFmORG4VIVXTc8aAiiwqjNAu7dH2hTUNL9bwPzYUBq3%2FjwvNZUM%2FmpdXfugOwAP%2FP3w9e9PqozA16XzrwGIunimlg58HKZfOM0xp%2FESLFXRHAssX6DaYqQQyV5%2F0triAQeOx328GOBUjfGTiAl1aoS1J0%2FqN%2BmywXW%2FqqkEfAQ2n2f18dX2dkbwMnyQ4F47zR6jJw3CdBkeCPRDbbhcu8YGu2%2F%2BzzM9B4uguhR76M3KYB3dr919eRp%2F%2BcOfUxc8TC3gXMmp1jh0ywwC27sBrzUgZdh%2B2g4artPxRaRZPHbQvC%2F1OZ0MxZYsQmEItbUc65WqfO6PSdLbymEFDMyN5ona14j%2BaQHfp1MWNaO02I2WPYO5mZIsPuHjCO5MYUldcsrZMP7pydKVo87gkO2fPB2orxw1RGazxVwGy5R2PDIV7HsKH4KSOqhGLTTYcSjZvxzmTWIy013yrXhU3CEdFUoB7QifSN1bUli2cMIaUe7sr75onhlaNnQxqLv%2By7jqQ9RiOHvcMM4XIMInwkIsGOqYBzgDHFUI%2FtkToYUBHsGsXyI9vGkS81IUV4PSjgSfvCFIGR%2BPjro3EYi30Oc%2FQZijhik3H1oI82Vno5zo%2BVnueR7%2BkGCloKvMkJAe%2F77e%2BPPRDClquvRG9ERm7ELsd6WvljYOJTmuP4pWPW%2B2d%2BQu26lThNein0I5abJKiu%2FYvnXDmBeYAgLMwbyg9Lq3qT5qMKsr3i1aOgHcGHtYldnzNcLqwaNJYhw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8d50e62877308dbddedab2721e39a4238ac220c27415bfdf42d42a7c7e43fd80","file_size":20581,"type":"image/png"},{"id":81611,"file_name":"changeEmail.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/611/c659b269192aa6d46c47dd83c74d5cee34663723/changeEmail.png?response-content-disposition=attachment%3B%20filename%3D%22changeEmail.png%22%3B%20filename%2A%3DUTF-8%27%27changeEmail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJF6VFL6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133534Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCID1So1KYRjOmBFJqLsqO1j9SSUCF9kJ%2FHqahOyDLmrnJAiAr2q5Z8bAgCyaCmyDSz7xwtmUTDOoz04myJOluBHRCeyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMvFUMWX6P00RsVarQKtcDflFFNScU3coA1YbnKy4lPXtwGDNsJcqhfcCTaePuAuK6nWvl5xRbjzjOBPvBHaTAnb2Iw%2B6Jdj2uyjmRMn%2F5%2F5AzD5di2wWOcC0am9iLaFmORG4VIVXTc8aAiiwqjNAu7dH2hTUNL9bwPzYUBq3%2FjwvNZUM%2FmpdXfugOwAP%2FP3w9e9PqozA16XzrwGIunimlg58HKZfOM0xp%2FESLFXRHAssX6DaYqQQyV5%2F0triAQeOx328GOBUjfGTiAl1aoS1J0%2FqN%2BmywXW%2FqqkEfAQ2n2f18dX2dkbwMnyQ4F47zR6jJw3CdBkeCPRDbbhcu8YGu2%2F%2BzzM9B4uguhR76M3KYB3dr919eRp%2F%2BcOfUxc8TC3gXMmp1jh0ywwC27sBrzUgZdh%2B2g4artPxRaRZPHbQvC%2F1OZ0MxZYsQmEItbUc65WqfO6PSdLbymEFDMyN5ona14j%2BaQHfp1MWNaO02I2WPYO5mZIsPuHjCO5MYUldcsrZMP7pydKVo87gkO2fPB2orxw1RGazxVwGy5R2PDIV7HsKH4KSOqhGLTTYcSjZvxzmTWIy013yrXhU3CEdFUoB7QifSN1bUli2cMIaUe7sr75onhlaNnQxqLv%2By7jqQ9RiOHvcMM4XIMInwkIsGOqYBzgDHFUI%2FtkToYUBHsGsXyI9vGkS81IUV4PSjgSfvCFIGR%2BPjro3EYi30Oc%2FQZijhik3H1oI82Vno5zo%2BVnueR7%2BkGCloKvMkJAe%2F77e%2BPPRDClquvRG9ERm7ELsd6WvljYOJTmuP4pWPW%2B2d%2BQu26lThNein0I5abJKiu%2FYvnXDmBeYAgLMwbyg9Lq3qT5qMKsr3i1aOgHcGHtYldnzNcLqwaNJYhw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=62956362713ceccdbf50af236a551f5308b5301c536fcbef43a5cfc3499cf57e","file_size":30803,"type":"image/png"}],"allow_singular_disclosure_at":"2016-04-27T14:01:36.340Z","allow_singular_disclosure_after":-172193638.26956764,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":873958,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for your report.\n\nWhile different methods of reauth may be something we consider in the future, \"best practice\" suggestions like this one are not eligible for our bug bounty program. Please see full program rules here: https://hackerone.com/uber\n\nThanks and we hope you'll continue to report security-related issues you find to us!","automated_response":false,"created_at":"2016-03-28T07:53:54.918Z","updated_at":"2016-03-28T07:53:54.918Z","actor":{"username":"bugtriage-david","cleared":false,"url":"/bugtriage-david","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":874366,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi David, \n\nThank you for the prompt reply. I'm not sure that this qualifies as a best practice but that is fine. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-03-28T14:01:35.942Z","updated_at":"2016-03-28T14:01:35.942Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we please disclose this?\n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-05-12T14:37:16.500Z","updated_at":"2016-05-12T14:37:16.500Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @ddworken, this is a best practice we are revamping across the organization. As you can probably see many of these endpoints no longer exist since we revamped the entire Partner's website. Thanks for the report, pushing it into public disclosure now.","automated_response":false,"created_at":"2016-06-13T22:21:38.297Z","updated_at":"2016-06-13T22:21:38.297Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012076,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-13T22:21:38.416Z","updated_at":"2016-06-13T22:21:38.416Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}