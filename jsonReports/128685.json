{"id":128685,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjg2ODU=","url":"https://hackerone.com/reports/128685","title":"SSRF on testing endpoint","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-06T10:39:49.602Z","submitted_at":"2016-04-06T10:39:49.602Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"agarri_fr","url":"/agarri_fr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":10543,"url":"https://hackerone.com/apitest","handle":"apitest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"APITest.IO","twitter_handle":"apitest_io","website":"https://www.apitest.io","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-14T20:32:06.836Z","bug_reporter_agreed_on_going_public_at":"2016-08-15T20:31:57.338Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Synopsis\n\nThe form at https://www.apitest.io/request accepts (among others) the \"url\" parameter. This feature allows to reach internal services (like the OpenStack metadata server) or services running on loopback.\n\n# Identified services\n\nhttp://0x7f.1/ (nginx) =\u003e \"If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.\"\n\nhttp://169.254.169.254/meta-data (OpenStack metada) =\u003e directoty listing (instance-id, mac, local-ipv4, public-ipv4, network_config/content_path, SUBID, ipv6-addr, ipv6-prefix)\n\nhttp://0x7f.1:8081/ (vestacp admin panel) =\u003e \u003ca href=\"http://vestacp.com/\"\u003ePowered by VESTA\u003c/a\u003e\n\n# Impacts\n\nThe metadata server does't seem to host any sensitive data. However, access to port 8081 may allow to reconfigure the OS or services (untested). Additional services may exist, but it seems that my IP address (81.56.184.117) was just blacklisted on your side.","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-14T20:31:57.510Z","allow_singular_disclosure_after":-160074286.72253892,"singular_disclosure_allowed":true,"vote_count":12,"voters":["th4nu_0x0","johndoe1492","ngalog","glc","dilawer01","bugdiscloseguys","jimeno","khizer47","paresh_parmar","nigba","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":891750,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, thanks! We have created some fix. Requests to 0x7f.1, localhost, 169.254.169.254 are blocked.\nQuick fix in live version, better fix in next release.","automated_response":false,"created_at":"2016-04-06T12:06:15.032Z","updated_at":"2016-04-06T12:06:15.032Z","actor":{"username":"tjebbeke","cleared":false,"url":"/tjebbeke","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"agarri_fr","url":"/agarri_fr"},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":892260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixing this kind of vulnerability isn't trivial (IP addresses encoded in exotic formats, DNS re-binding, ...). I'd love to test your fix but I reached my daily number of requests.\n\nIs it possible to relax the request limitation or to temporary upgrade my account? If yes, UserID=69, UserName=\"nicolas.gregoire@agarri.fr\"\n","automated_response":false,"created_at":"2016-04-06T17:05:51.587Z","updated_at":"2016-04-06T17:06:13.188Z","actor":{"username":"agarri_fr","cleared":true,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":892771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You have now the basic package till 2016-04-15.","automated_response":false,"created_at":"2016-04-06T21:42:02.940Z","updated_at":"2016-04-06T21:42:02.940Z","actor":{"username":"tjebbeke","cleared":false,"url":"/tjebbeke","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":893616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the upgrade!\n\nHere's some bypasses that I found when trying to reach the URL http://127.0.0.1:8081/server-status with different encodings and tricks. Accessing this page reveals, among others, the exact Apache version: \"Apache/2.2.15 (Unix) DAV/2 mod_fcgid/2.3.9 PHP/5.4.36 mod_ssl/2.2.15 OpenSSL/1.0.0-fips\"\n\n# Octal encoding\n\nhttp://0177.0000000000001:8081/server-status\n\n# DWORD encoding\n\nhttp://2130706433:8081/server-status\n\n# Hexadecimal encoding\n\nhttp://0x7f000001:8081/server-status\n\n# The ANY_IP address\n\nhttp://0.0.0.0:8081/server-status\n\nI made some public talks regarding this familly of vulnerabilities, known as SSRF (Server Side Request Forgery). You may find this one useful: http://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf","automated_response":false,"created_at":"2016-04-07T10:37:30.556Z","updated_at":"2016-04-07T10:37:30.556Z","actor":{"username":"agarri_fr","cleared":true,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1127876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-15T20:31:57.437Z","updated_at":"2016-08-15T20:31:57.437Z","first_to_agree":true,"actor":{"username":"agarri_fr","cleared":true,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1194446,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-14T20:32:06.933Z","updated_at":"2016-09-14T20:32:06.933Z","actor":{"url":"/apitest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"APITest.IO"}},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}