{"id":129862,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjk4NjI=","url":"https://hackerone.com/reports/129862","title":"Stored XSS on [your_zendesk].zendesk.com in Facebook Channel","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-11T16:27:13.292Z","submitted_at":"2016-04-11T16:27:13.292Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-01T21:16:03.496Z","bug_reporter_agreed_on_going_public_at":"2016-05-30T12:42:28.011Z","team_member_agreed_on_going_public_at":"2016-06-01T21:16:03.405Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have found a stored XSS in the Facebook Channel options at ```https://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth```.\n\nThe XSS is a result of improperly escaping Facebook Page names.\n\nSteps to reproduce\n-------------------------\n\n1. Create a facebook page with the following title/page name:\n\n    ```Foobar\" onmouseover=location\u0026#x3d;'javascript:alert\\x28document.domain\\x29'```\n\n    (I had to play around with this a bit to get it working correctly as Facebook has strict policies on the page name. If the page already exists, try to replace `Foobar` with any other random string)\n2. Create your own zendesk account and then go to ```https://[your_zendesk].zendesk.com/agent/admin/facebook/facebook_auth``` to add a facebook page.\n3. After adding the page created in Step 1, hover over the \"Unlink\" button to trigger the XSS. See also attached screenshot.\n\nAttack scenario\n--------------------\nObviously anyone with the permissions to add facebook pages can trigger this stored XSS and attack the admins with the usual XSS attacks. \n\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":84649,"file_name":"zendesk_stored_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/084/649/55a3ee1b8ccb74fa058764a08b5c515c11245c1a/zendesk_stored_xss.png?response-content-disposition=attachment%3B%20filename%3D%22zendesk_stored_xss.png%22%3B%20filename%2A%3DUTF-8%27%27zendesk_stored_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133717Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b037c8c6eec87778361c664dc4841421c9535208dcd2e3b95861f75b6d6ed91f","file_size":50312,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["fantam1","spetr0x","anik","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":899743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @eboda,\n\nThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","automated_response":false,"created_at":"2016-04-11T17:03:49.685Z","updated_at":"2016-04-11T17:03:49.685Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912264,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @eboda,\n\nCongratulations! Your submitted vulnerability has been validated and is in process for remediation. You will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nThis was a good find and a creative exploit. Unfortunately because the channels settings page is restricted to admins, the risk of the vulnerability decreases considerably.Furthermore, as mentioned in our bug bounty program we award based on risk. \n\nHaving said that, we enjoyed reading your report and would like to extend an invite into our private bug-bounty program for [BIME](https://hackerone.com/bime). Happy Hacking!\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","automated_response":false,"created_at":"2016-04-18T16:40:29.951Z","updated_at":"2016-04-18T16:40:29.951Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912266,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-04-18T16:40:40.991Z","updated_at":"2016-04-18T16:40:40.991Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zendesk @noops43 ,\n\nThanks for the bounty and the invite to your private program!\n\nYeah I realize its implied risk is very low, but I didn't see a way to exploit it further and thought I would just report it as is.\n\nBest of luck to you!","automated_response":false,"created_at":"2016-04-18T19:03:53.798Z","updated_at":"2016-04-18T19:03:53.798Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":933253,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zendesk @noops43 ,\nI noticed, that this bug is fixed now. Could you mark this issue as resolved?\n\nI would like to submit some bugs to @BIME, but I don't have yet 5 resolved reports, so my Signal calculation is \"pending\" and hence I don't meet the minimum requirement of having a Signal \u003e 1.\n\nThanks!","automated_response":false,"created_at":"2016-04-29T08:50:14.441Z","updated_at":"2016-04-29T08:50:14.441Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":961931,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @eboda,\n\nYour submitted issue has been remediated. Thank you for participating in the [Zendesk Bug Bounty program](https://hackerone.com/zendesk). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","automated_response":false,"created_at":"2016-05-17T18:59:10.339Z","updated_at":"2016-05-17T18:59:10.339Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":990785,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Do you mind disclosing?","automated_response":false,"created_at":"2016-05-30T12:42:28.062Z","updated_at":"2016-05-30T12:42:28.062Z","first_to_agree":true,"actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995682,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-01T21:16:03.445Z","updated_at":"2016-06-01T21:16:03.445Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995683,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-01T21:16:03.517Z","updated_at":"2016-06-01T21:16:03.517Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}