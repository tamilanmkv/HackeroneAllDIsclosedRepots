{"id":131052,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzEwNTI=","url":"https://hackerone.com/reports/131052","title":"XSS in uber oauth","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-04-15T10:57:56.042Z","submitted_at":"2016-04-15T10:57:56.042Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-26T00:27:22.726Z","bug_reporter_agreed_on_going_public_at":"2016-06-29T17:10:40.292Z","team_member_agreed_on_going_public_at":"2016-07-26T00:27:22.596Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found that when setting a `redirect_uri` for an application you validate for the presence of `://` in the beginning of the url , but you don't validate for the protocol and you don't block malicious protocols such as `javascript:` pseudo protocol and `data:` URIs.\nAlthough the redirecting is done through `location` header , there still some cases in which this can be harmful to users and can be used to hijack users' accounts , moreover , `data:` URIs work on some modern browsers such as firefox. \nThis also can be very harmful to users who chose to disable 302 redirection on their browser.\n\n#PoC:\n\nThis PoC will work on latest version of opera mini mobile browser and it will also work on firefox with 302 redirection disabled. \n\n- Go to https://login.uber.com/oauth/authorize?client_id=MXeE1dl-5R3yTCbufMHsfz3KhfY2UGyS\u0026response_type=code\u0026scope=profile\u0026redirect_uri=javascript:%2F%2Fgoog.com%2F%250Aalert%28document.domain%29%3B%2F%2F\n- Click the Allow or the Deny button\n- The response will be:\n \n```\n\u003c!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\"\u003e\n\u003ctitle\u003eRedirecting...\u003c/title\u003e\n\u003ch1\u003eRedirecting...\u003c/h1\u003e\n\u003cp\u003eYou should be redirected automatically to target URL: \u003ca href=\"javascript://goog.com/%0Aalert(document.domain);//?error=access_denied#_\"\u003ejavascript://goog.com/%0Aalert(document.domain);//?error=access_denied#_\u003c/a\u003e.  If not click the link.\n```\n- As you can see , this will trigger XSS . \nI have attached a screenshot of XSS triggered on firefox (latest version) with 302 redirection disabled. \n\nThe PoC will also work on old Mozilla and opera browsers , in browsers Mozilla 1.7.x (and previous versions) and Mozilla Firefox 3.0.12 , The browser will show “Object Moved” page. click on the link “here” and the code will execute.\n\nThanks\n\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":85789,"file_name":"uber_oauth_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/789/b3e6edc589f267e162083fa958443cc3da10cdb9/uber_oauth_xss.png?response-content-disposition=attachment%3B%20filename%3D%22uber_oauth_xss.png%22%3B%20filename%2A%3DUTF-8%27%27uber_oauth_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8805ff1ef5282bac06554ace18ea00159fb8f9c8a31fa602212158ba1038b86d","file_size":80158,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["leet-boy","sumit7","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":908419,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thank you for your report.\n\nAs mentioned in our [program rules](https://hackerone.com/uber) issues that only affect non-current browsers or browsers with security features disabled are not in scope for this bounty program.  We appreciate the report however, and if you can get this work in an unaltered, current browser version, please let us know, but for now, we will be closing this report.\n\nThanks, and good luck with your future bug hunting.","automated_response":false,"created_at":"2016-04-15T18:38:58.349Z","updated_at":"2016-04-15T18:38:58.349Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":935581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bugtriage-josh , thanks for the reply. \nThis does actually affect some latest versions of mobile browsers such as opera mini and some others.\nAlso , `data` URIs work on latest firefox version ( the payload will trigger outside uber.com , but it still has some impact) . \n\nAlso , 302 redirect isn't a security feature , some developers do disable it , I do it :D . \nThis will work on all browsers if someone could get a Null byte character in the `location` header , but I couldn't get that because your application blocks it. \n\nThere is also another issue within oauth which allows it to be used as an open redirector which is the same as #55525 reported to @shopify . \n\nWhen the scope or the response type is invalid , then the authorize url redirects to the site mentioned in redirect_uri So, attacker can create an app and use it as open redirector to redirect victims to fake sites , which can be used to trigger the XSS (if the user has 302 redirect disabled or if he is using an affected mobile browser) without the need of clicking `DENY` or `ALLOW` .\nExample: \n```\nhttps://login.uber.com/oauth/authorize?client_id=p2Onb3CmBMMx9bJU5nfmRao-0cpZ8pWV\u0026response_type=invalid\u0026scope=profile\u0026redirect_uri=javascript%3A%2F%2Fx.com%2F%250Aalert(1)%3B%2F%2F\n```\n\nThanks.","automated_response":false,"created_at":"2016-05-01T20:48:46.332Z","updated_at":"2016-05-01T20:48:46.332Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":957279,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello?","automated_response":false,"created_at":"2016-05-14T11:45:18.814Z","updated_at":"2016-05-14T11:45:18.814Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1045643,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since you guys consider this informative , I guess you have no problem with public disclosure.","automated_response":false,"created_at":"2016-06-29T17:10:40.356Z","updated_at":"2016-06-29T17:10:40.356Z","first_to_agree":true,"actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1056891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54,\n\nWe typically have meetings a few times a month to discuss public disclosure requests, I believe the next one is 7/11, after that we will let you know.\n\nThank you and good luck with future bug hunting.","automated_response":false,"created_at":"2016-07-07T05:55:51.196Z","updated_at":"2016-07-07T05:55:51.196Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065760,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's 7/12 today! \nHave you guys missed this one ?\nAre you willing to fix it ?\nThanks!","automated_response":false,"created_at":"2016-07-12T19:40:11.548Z","updated_at":"2016-07-12T19:40:11.548Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1081362,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys , did you fix this ? \nFor some reason , I can no longer reproduce it!!!\nThanks! ","automated_response":false,"created_at":"2016-07-22T01:35:32.056Z","updated_at":"2016-07-22T01:35:32.056Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1082669,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zombiehelp54, we haven't made any changes as a result of your report however it is possible that the relevant team made changes unrelated to your report which changed the behavior of the endpoint. Sorry about the delayed response regarding public disclosure, it looks like this one slipped by during our last meeting, I'll bring it up at the next one. Thanks!","automated_response":false,"created_at":"2016-07-22T17:54:12.836Z","updated_at":"2016-07-22T17:54:12.836Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1086985,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sorry for the delay @zombiehelp54!","automated_response":false,"created_at":"2016-07-26T00:27:22.649Z","updated_at":"2016-07-26T00:27:22.649Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1086986,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-26T00:27:22.753Z","updated_at":"2016-07-26T00:27:22.753Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}