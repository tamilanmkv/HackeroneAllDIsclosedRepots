{"id":136221,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzYyMjE=","url":"https://hackerone.com/reports/136221","title":"Denial of service in account statistics endpoint","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-04T14:35:14.691Z","submitted_at":"2016-05-04T14:35:14.691Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"apok","url":"/apok","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-31T21:32:00.979Z","bug_reporter_agreed_on_going_public_at":"2016-05-26T15:37:17.770Z","team_member_agreed_on_going_public_at":"2016-05-31T21:32:00.872Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Mapbox,\nI know that your guidelines explicitly say that Denial of Service coinditions are not in scope and should not be attempted, but I maintained the testing between adequate parameters so as to not to create excessive load on your backend. I also sent an email to security@mapbox.com prior to submitting this report and Alex Ulsh and he or she (Sorry, can't know which since Alex is a unisex name hahaha) told me that this could be an exception.\n\nThe vulnerability relies on the https://www.mapbox.com/core/statistics/v1/apokh11/account endpoint, it seems that by modifying the \"period\" parameter to an arbitrary value, the amount of data returned increases probably without any limit, furthermore, if the interval is set to \"hour\" instead of \"day\", it is possible to increase the amount of data returned even further. To avoid affecting the availability of the server, I limited my testing to a small period, which still returned around 350 kb of data.\n\nThe amount of data can also be increased if the end date of the period requested is set to a point in the future.\n\nTo reproduce:\n1) Create an account or login to an existing account.\n2) Access this URL: https://www.mapbox.com/core/statistics/v1/apokh11/account?interval=day\u0026period=1461766083142%2C1462370883143\u0026metrics=countries%2Cbrowsers%2Chosts%2Cmaps%2Cversion\u0026services=mapview%2Ctile%2Cstatic%2Cgeocode%2Cpermanentgeocode%2Cdirections%2Csurface\u0026_=1462370883155\n3) Observe that the amount of data returned is around 2.5 Kb.\n4) Modify the \"interval\" parameter to \"hour\" and the \"Period\" parameter to, for example \"1451766083142,1462370883143\" \n5) Observe that the amount of data returned increased to 372 Kb. \n\nNot tested: If the period is long enough, the amount of time taken to answer the request will probably be increased as well.\n\nImplication: A malicious individual could leverage this feature by asking for extended periods to cause high loads on the backend, which in turn could affect the availiability of the service.\n\nRecommendation: Limit the period length to an amount established by the business logic, so as to mitigate the possibility of using this functionality with malicious intent.\n\nLet me know if you require any additional tests and/or information.\nKind Regards,\nApok.","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":91460,"file_name":"Denial_of_Service_Condition_First_request.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/460/ad8d5a4f197907efdf32642c75f00c124f8bd0b4/Denial_of_Service_Condition_First_request.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_First_request.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_First_request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133922Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=84fcef4277091a4a0c87bf5f2ece456b7265a265d9e0a81f331f0f5f3104caf9","file_size":5791,"type":"image/png"},{"id":91461,"file_name":"Denial_of_Service_Condition_First_response.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/461/532a779a062de9cb97c8ec98d18c7af9d9aca4b8/Denial_of_Service_Condition_First_response.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_First_response.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_First_response.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133922Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e01074248b9189bb663fa0b7693824c45b9957c08d81dbdaeb7bc3651bbef771","file_size":51051,"type":"image/png"},{"id":91462,"file_name":"Denial_of_Service_Condition_Second_request.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/462/bbece7650459934d504360aaadb8ea9798cc8da3/Denial_of_Service_Condition_Second_request.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_Second_request.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_Second_request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133922Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2c841377c4f423df9e30c5dba6c6dd0f65b1fe0cd375fbba3c53c32205c1beab","file_size":6488,"type":"image/png"},{"id":91463,"file_name":"Denial_of_Service_Condition_Second_response.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/463/b34d83eda0c06c2dac2c63d36c99bb64cc8cb500/Denial_of_Service_Condition_Second_response.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_Second_response.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_Second_response.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133922Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1541d71022f36173e85af048249928734b1bab8fec758b9069f6aef428170cb7","file_size":53017,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-25T15:37:17.880Z","allow_singular_disclosure_after":-167090525.02215934,"singular_disclosure_allowed":true,"vote_count":2,"voters":["w2w","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":941054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, I forgot to tell you that the username in the URL must be modified. Sorry about that!","automated_response":false,"created_at":"2016-05-04T21:10:46.779Z","updated_at":"2016-05-04T21:10:46.779Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":943115,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-05-05T23:20:05.275Z","updated_at":"2016-05-05T23:20:05.275Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":947081,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, hope you had a nice weekend any news regarding this report??\nKind Regards,\nApok","automated_response":false,"created_at":"2016-05-09T14:43:55.450Z","updated_at":"2016-05-09T14:43:55.450Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":949021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, how is this going??","automated_response":false,"created_at":"2016-05-10T16:26:20.179Z","updated_at":"2016-05-10T16:26:20.179Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":949557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@apok - we have triaged and validated this issue but are still deciding as a team the best way to implement a fix. Thank you for your patience!","automated_response":false,"created_at":"2016-05-10T20:22:38.040Z","updated_at":"2016-05-10T20:22:38.040Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":949954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh okay then just wanted to check in.\nThanks!","automated_response":false,"created_at":"2016-05-11T00:49:50.419Z","updated_at":"2016-05-11T00:49:50.419Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":950709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, if I may offer a suggestion on how to approach this fix, I think the best thing would to implement the following server-side controls:\n- Eliminate the option \"hour\" (which is not accessible from the client-side application).\n- Restrict the lower bound of the period being asked for to the account creation date.\n- Restrict the upper bound of the period being asked for to now()\n- As a final safeguard, restrict the number of records returned to a fixed number you are comfortable with, that is big enough not to mess with the stats GUI, but small enough that it can't be used as a DoS tool. This should be an arrangement between both the infraestructure guys and the programmers, so that everyone is happy.\n- Additionally but optionally agressive rate-limiting is also a thing to look into.\n\nHope this helps.\nKind Regards,\nApok.","automated_response":false,"created_at":"2016-05-11T13:58:05.099Z","updated_at":"2016-05-11T13:58:48.594Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":950975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the suggestions @apok! We will take these into consideration.","automated_response":false,"created_at":"2016-05-11T15:37:19.061Z","updated_at":"2016-05-11T15:37:19.061Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":959342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! Any updates? Thanks!","automated_response":false,"created_at":"2016-05-16T15:56:02.786Z","updated_at":"2016-05-16T15:56:02.786Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":965779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, any updates?","automated_response":false,"created_at":"2016-05-19T23:53:54.306Z","updated_at":"2016-05-19T23:53:54.306Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":970209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@apok - Thank you again for your patience. We have written and tested a patch for this report and will be deploying it soon.\n\nAfter we deploy it to production we will update you and ask you to confirm the fix. Thanks again for your report!","automated_response":false,"created_at":"2016-05-23T15:34:46.546Z","updated_at":"2016-05-23T15:34:46.546Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":970483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@apok, we've just deployed the fix to production. Could you confirm the fix? Thank you!","automated_response":false,"created_at":"2016-05-23T17:46:32.523Z","updated_at":"2016-05-23T17:46:32.523Z","actor":{"username":"xrwang","cleared":false,"url":"/xrwang","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":970588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that:\n- I cannot ask for information with an hourly interval.\n- I cannot ask for information farther than a year in the future.\n\nHowever, I asked for information starting on epoch 863422973706 (Mon, 12 May 1997 07:42:53.706 GMT) and after 45 seconds I got the error shown on the screenshot. Is this by design?","automated_response":false,"created_at":"2016-05-23T18:28:21.048Z","updated_at":"2016-05-23T18:28:21.048Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":95375,"filename":"Denial_of_Service_Condition_Fixed_request.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/095/375/edfd6b973cf09f9cdb0e1f8a3e0bfdf361f0a575/Denial_of_Service_Condition_Fixed_request.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_Fixed_request.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_Fixed_request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=03a174bc8da76efaa2d9a6a966973ebd878c9bfe83872da5c4797b6290af85d4"},{"id":95376,"filename":"Denial_of_Service_Condition_Fixed_response.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/095/376/1a272a335635a6b1080062852380f092b1a97103/Denial_of_Service_Condition_Fixed_response.png?response-content-disposition=attachment%3B%20filename%3D%22Denial_of_Service_Condition_Fixed_response.png%22%3B%20filename%2A%3DUTF-8%27%27Denial_of_Service_Condition_Fixed_response.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=777a7950ef00aba75a39dd344d936495fd4a63c6d253cd5fac59c1d1c9425ba9"}],"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":983526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, any news regarding this issue?","automated_response":false,"created_at":"2016-05-25T18:02:57.219Z","updated_at":"2016-05-25T18:02:57.219Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":983559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @apok, we're working on this and will let you know when we have the fix on production for you to test. Thanks!","automated_response":false,"created_at":"2016-05-25T18:20:52.138Z","updated_at":"2016-05-25T18:20:52.138Z","actor":{"username":"xrwang","cleared":false,"url":"/xrwang","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":985225,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@apok we've deployed the fix to production and time periods are now restricted to a year. If you could confirm, that'd be great. Thanks!","automated_response":false,"created_at":"2016-05-26T15:15:51.225Z","updated_at":"2016-05-26T15:15:51.225Z","actor":{"username":"xrwang","cleared":false,"url":"/xrwang","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":985242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes! Seems to be fixed, shouldn't be an issue anymore.","automated_response":false,"created_at":"2016-05-26T15:25:59.150Z","updated_at":"2016-05-26T15:25:59.150Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":985246,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-05-26T15:27:30.586Z","updated_at":"2016-05-26T15:27:30.586Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"apok","url":"/apok"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":985252,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-05-26T15:30:31.102Z","updated_at":"2016-05-26T15:30:31.102Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mapbox"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"apok","url":"/apok"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":985255,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-05-26T15:32:29.828Z","updated_at":"2016-05-26T15:32:29.828Z","additional_data":{"old_title":"Denial of service condition in stats functionality","new_title":"Denial of service in account statistics endpoint"},"actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":985263,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome thanks for the bounty shall we disclose?","automated_response":false,"created_at":"2016-05-26T15:37:17.817Z","updated_at":"2016-05-26T15:37:17.817Z","first_to_agree":true,"actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993802,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-05-31T21:32:00.918Z","updated_at":"2016-05-31T21:32:00.918Z","actor":{"username":"xrwang","cleared":false,"url":"/xrwang","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993803,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-05-31T21:32:01.005Z","updated_at":"2016-05-31T21:32:01.005Z","actor":{"username":"xrwang","cleared":false,"url":"/xrwang","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2017,"category":"team","content":"On May 4th, 2016, [apok](https://hackerone.com/apok) reported a Denial of Service condition on our [user account statistics endpoint](https://www.mapbox.com/studio/stats/), which returns information about a user's map views over a specified period of time.\n\nAn attacker could trigger a potential denial of service condition by changing the value of the `interval` query string parameter from `day` to `hour` then requesting a time period of several years. We decided to first remove the `hour` interval option to resolve this issue. After [apok](https://hackerone.com/apok) reported a DoS condition when requesting an early start period of May 1997 with `interval=day`, we then implemented a limit of one year for all requests to the statistics endpoint.\n\nOn May 26th, 2016 we closed this report after deploying the fix to our production servers. \n\nNormally, Mapbox does not issue bounties on DoS related reports as we have rate limiting measures in place as well as automated monitoring alerts for potential DoS and brute force attacks. By contrast, this potential DoS condition would have been caused by a single request and would have evaded our rate limiting and monitoring measures. As a result, we decided to triage, fix, and award a bounty for this report.\n\nNote that [apok](https://hackerone.com/apok) deleted their test accounts in order to invalidate the session cookies in the screenshots included in this report.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":79064,"username":"xrwang","name":"xrwang","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2016-05-20T18:16:30.791Z","url":"https://hackerone.com/xrwang","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":null,"profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}