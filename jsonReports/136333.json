{"id":136333,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzYzMzM=","url":"https://hackerone.com/reports/136333","title":"Persistent XSS on public wiki pages","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-05T02:55:10.735Z","submitted_at":"2016-05-05T02:55:10.735Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-27T21:44:23.111Z","bug_reporter_agreed_on_going_public_at":"2016-07-27T21:28:16.391Z","team_member_agreed_on_going_public_at":"2016-07-27T21:44:23.023Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Details\nThere's a persistent cross-site scripting (XSS) vulnerability in the wiki pages. This can lead to an account take over via the leaked API token.\n\n# Proof of concept\nAs an attacker, create a new public repository. Make sure you have a client that is allowed to push to that repository. For this PoC, lets say the repository is located at `git@gitlab.com/dummy/test.git`. On the client, execute the following commands:\n\ngit clone git@gitlab.com/dummy/test.git\ncd test\necho \"\u003cscript\u003ealert('Hello world!');\u003c/script\u003e\" \u003e index.html\ngit add index.html\ngit commit -m \"This message is super important\"\ngit push\n\nNow go to https://gitlab.com/dummy/test/wikis/index.html. As you will see, this executes the JavaScript that is stored in the file.\n\n{F91538}\n\n# Impact\nGitLab doesn't have a content security policy, which means that clients allow inline Javascript to be executed. This gives access to the current user its API token. The API token can be used to access the user its projects, do actions as the user, give access to potential confidential information, etc.","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":91538,"file_name":"Screen_Shot_2016-05-04_at_19.52.50.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/538/f6e1c94bbd052bc9da07fba6e4fdd62abcaaa8b4/Screen_Shot_2016-05-04_at_19.52.50.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-04_at_19.52.50.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-04_at_19.52.50.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133924Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c059f895c485d13be1b61497079bd825cd7795663229e7c9770902360efd57a8","file_size":82276,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-26T21:28:16.504Z","allow_singular_disclosure_after":-161712668.32606024,"singular_disclosure_allowed":true,"vote_count":13,"voters":["michiel","sameerphad72","s_p_q_r","skansing","mdv","eveeez","gopi","sumit7","spetr0x","dyabla","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":941425,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@jobert Thanks! Opened confidential issue at https://gitlab.com/gitlab-org/gitlab-ce/issues/17298 and will keep you updated here.","automated_response":false,"created_at":"2016-05-05T02:58:53.662Z","updated_at":"2016-05-05T02:58:53.662Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":942336,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert I think the PoC was wrong -- you need to clone and push to the *wiki* repository (i.e., `test-wiki.git`), right?\n\nYou're fired! ;)","automated_response":false,"created_at":"2016-05-05T16:31:01.174Z","updated_at":"2016-05-05T16:31:01.174Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":942344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh lol, my bad. Thanks for reminding me that I shouldn't edit commands after I ran them locally... :')","automated_response":false,"created_at":"2016-05-05T16:35:53.589Z","updated_at":"2016-05-05T16:35:53.589Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":950553,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"@jobert It looks like we had a communication breakdown at some point, and this was already reported by another user on HackerOne but not properly posted internally.\n\nClosing as duplicate. A fix should be live shortly. Sorry for the confusion.","automated_response":false,"created_at":"2016-05-11T12:10:32.176Z","updated_at":"2016-05-11T12:10:32.176Z","original_report_id":120369,"actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":950581,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Damn it, this one wasn't the duplicate.","automated_response":false,"created_at":"2016-05-11T12:31:51.820Z","updated_at":"2016-05-11T12:31:51.820Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":954372,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rspeicher Right back at ya: you're fired! ;)","automated_response":false,"created_at":"2016-05-12T20:39:07.106Z","updated_at":"2016-05-12T20:39:07.106Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1016058,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@jobert: We'll be releasing a number of security patches today or tomrrow, and a fix for this issue is included.\n\nHope you're enjoying your vacation!","automated_response":false,"created_at":"2016-06-15T22:02:49.694Z","updated_at":"2016-06-15T22:02:49.694Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1091811,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-27T21:28:16.458Z","updated_at":"2016-07-27T21:28:16.458Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091831,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-27T21:44:23.050Z","updated_at":"2016-07-27T21:44:23.050Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1091832,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-27T21:44:23.135Z","updated_at":"2016-07-27T21:44:23.135Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}