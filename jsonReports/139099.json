{"id":139099,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkwOTk=","url":"https://hackerone.com/reports/139099","title":"Lack of account link warning enables dropbox hijacking","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-16T11:30:42.184Z","submitted_at":"2016-05-16T11:30:42.184Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-27T12:21:56.002Z","bug_reporter_agreed_on_going_public_at":"2016-05-28T12:21:52.431Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When I install dropbox on linux via the CLI, I get given a URL containing a token:\nhttps://www.dropbox.com/cli_link_nonce?nonce=blah\n\nI can give this token to another user and pretend it's a link to a dropbox file. If they aren't logged in when they click it, they will land on the login page. If they log in, my server will instantly be linked to their dropbox account, giving me read/write access all their files. This attack involves a little user interaction but I think faced with a login page on the real dropbox.com, most users will log in. Please review the attached screenshot to see what I mean.\n\nThe account linking page that is displayed to users who are already logged in also fails to give an adequate warning, but I think less people would fall for this.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":94074,"file_name":"Screen_Shot_2016-05-16_at_12.15.50.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/074/0078a52604d131e334ef8b4f0b2d3ecf75b3c490/Screen_Shot_2016-05-16_at_12.15.50.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-05-16_at_12.15.50.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-05-16_at_12.15.50.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVDBASJ4Q%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134022Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQDMdOR8DzxdsM%2B6Nk%2BzXUgAoPrxENIVmPciK7W1QkTEBAIhAPZfGsC3rMFHuNTCed2J3zTsoLVhq74QDkDUqwaAjmKbKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igws83MXdHvRQdFvESMq1wMqxEsLwoOZjIVt8a3wfYXFAiCeqeu8AhIJ6Q7Gntu36a0%2Blks6a5lEO%2FYz77dG0sIpLYJ92lhokB43YiQ7PkQCfXpRFTl9ereVcz8C%2Ba%2B6ghwT05v12IJECBf189h3nq1I64rxvZIjtN0BImUDg10QomFml6x8R3iLnCYd%2BLAEiGAatULKrnyAIAqUluvo7wOm%2Br90IqmVB75trWkwZcISqhUy3kQvSoTg%2Fsd1zrhvp96u7V9CbvWMDgw50GUylR80KcMhS8pMk07p2NCJVpFXvli9CcdErLq3atydz1iEYs3wmS%2FxGo5ybz%2BFBSBrGAwGQOnYxhYrDiVwepytoLlc0A1YwGzvc%2BhkK7ughwOXGyiEKlYNhpv2iUGk%2FoPAwW9VnMiQ4LHLaf2z%2FxFIC%2FfPgJBsV5dn%2BlvlcrXTNgUone9y6c7%2BBn1eqR2LMzvU8Ycy553Ru%2Fkm%2FBzMexK1Hyt%2Fhdt%2FQQXlD1cuP5rMTD42svdfgSWDAQudumXSmBAH2X7ZE74Gaw2h4JQmynzGH%2FOFS6Lmlo%2Bofjpji8JaNzh4GW2JXmbTgsUVdFELkd37rtrSORTYe8Y8rrt1akUkkcNu6DMm%2FyGhDUPJ%2FxK7RrGHOug4ufna%2BIIw6s%2BQiwY6pAFb0ppMhwpE1Uun0MFKa8So8GqZEnxDHG9kJkScDGktuYxZAg1a2hM6HfHooNOwO3ShyPn3yIRD1SLYdgBYVYgQjezJJsVSMNj3BNuqf0DS%2Bf73xIul9mOcsJPW3HwfDOsCUstdfVvyIllvZucN31%2BOA6uE6BxOAGvrA0Zq5Z%2Fv3289%2BB9Q2%2F0GwwsZ1qBhJjETaZ%2BiY8WDpCmp7t5KzvM1us%2F6Eg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6071dc4d5c79a8d4dfd608c1d211e4536343033ed7e6056ef1ee453b12e9f93c","file_size":133912,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-27T12:21:52.540Z","allow_singular_disclosure_after":-166929510.05509472,"singular_disclosure_allowed":true,"vote_count":8,"voters":["albinowax","dejavuln","paresh_parmar","spetr0x","akash_9021","dolph1n","dyabla","pei"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":958977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To effectively target users who are currently logged in, I can first sign them out via CSRF: https://www.dropbox.com/logout","automated_response":false,"created_at":"2016-05-16T12:27:04.907Z","updated_at":"2016-05-16T12:27:04.907Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":959540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks! what sort of warning do you think we should provide that will be clearer?","automated_response":false,"created_at":"2016-05-16T17:22:43.195Z","updated_at":"2016-05-16T17:22:43.195Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":959624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think for many people logging in is a reflexive action, so changing the text on the login page itself wouldn't achieve very much. If a user is unauthenticated, after getting them to log in you could redirect them to the \"Would you like to connect\"...[confirm/cancel] account linking page. \n\nThe wording on the account linking page could be changed to something like \"Are you trying to connect your DropBox account to a new computer? If you didn't request this, please click cancel.\" \n\nA more extreme version would be \"Please re-enter your password to confirm you wish to connect your DropBox account to a new computer\"","automated_response":false,"created_at":"2016-05-16T18:12:58.804Z","updated_at":"2016-05-16T18:12:58.804Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":960637,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"still triaging.","automated_response":false,"created_at":"2016-05-17T06:22:12.298Z","updated_at":"2016-05-17T06:22:12.298Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":967876,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have updated the warning text. thanks!","automated_response":false,"created_at":"2016-05-21T19:00:58.591Z","updated_at":"2016-05-21T19:00:58.591Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":967877,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2016-05-21T19:01:06.534Z","updated_at":"2016-05-21T19:01:06.534Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":988970,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-05-28T12:21:52.480Z","updated_at":"2016-05-28T12:21:52.480Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could we publicly disclose this?","automated_response":false,"created_at":"2016-06-14T13:28:17.394Z","updated_at":"2016-06-14T13:28:17.394Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you don't mind, we prefer you don't since it is a lot more work and interruption for us.","automated_response":false,"created_at":"2016-06-15T15:46:07.739Z","updated_at":"2016-06-15T15:46:07.739Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ping @albinowax if you really want disclosure, let me know.","automated_response":false,"created_at":"2016-06-20T15:10:39.959Z","updated_at":"2016-06-20T15:10:39.959Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The context is that I'm writing a blog post reviewing all the bug bounty programs I've used, and I think it would be helpful for readers if they could view the full details of this report. It isn't critical to the overall post though.","automated_response":false,"created_at":"2016-06-20T15:32:40.321Z","updated_at":"2016-06-20T15:32:40.321Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024735,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To be honest, I think we will likely want to summarize the post and not disclosure the full post. I am sorry and it is really unfortunate; but previous experience tells us that honest interactions between researchers and teams are misconstrued by the wrong people :(","automated_response":false,"created_at":"2016-06-20T15:46:35.993Z","updated_at":"2016-06-20T15:46:35.993Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1024737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"also, I would love to read the post once its out: please do share it :)","automated_response":false,"created_at":"2016-06-20T15:46:57.889Z","updated_at":"2016-06-20T15:46:57.889Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1040564,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-27T12:21:56.056Z","updated_at":"2016-06-27T12:21:56.056Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}