{"id":141463,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDE0NjM=","url":"https://hackerone.com/reports/141463","title":"Stored XSS via AngularJS Injection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-27T16:01:41.237Z","submitted_at":"2016-05-27T16:01:41.237Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1492,"url":"https://hackerone.com/drchrono","handle":"drchrono","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"drchrono","twitter_handle":"drchrono","website":"https://www.drchrono.com","about":"EHR, Practice Management, Medical Billing \u0026 Revenue Cycle Management available on iPad, iPhone, web ... and a healthcare API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-13T19:02:06.315Z","bug_reporter_agreed_on_going_public_at":"2016-06-13T18:16:48.528Z","team_member_agreed_on_going_public_at":"2016-06-13T19:02:06.205Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI've found a stored XSS vulnerability via an Angular Template Injection in the messages referral address field.\n\n##Description\nAfter visiting ``https://1337test.drchrono.com/messages/referrals/contacts/```, you can enter new contact information. In the field for the address, if enter [[5*5]], when the referrals contact overview will show the address as 25. This indicates an injection. \n\nOpening the browser console and using the command angular.version, we can see you are using 1.1.5. So, entering the address for a contact as ```[[constructor.constructor('alert(document.cookie)')()]]```, saving and reloading the page, an stored XSS is executed {F96481}\n\n##Steps to reproduce\n1. Create a doctors account\n2. Visit ```https://1337test.drchrono.com/messages/referrals/contacts/```\n3. Add a new contact\n4. In the address field, enter ```[[constructor.constructor('alert(1)')()]]```\n\nConfirm the alert pop up with **1** in it.\n\n##Vulnerability\nThe stored xss could be used for a complete account take over if an admin visited this contact page. An attacker only needs permission to create a referral contact to store the payload. In the example image, I've printed all cookies to the screen but this could easily be sent to a remote endpoint.\n\nPlease let me know if you have any questions.\nPete","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":96481,"file_name":"angular_injection_contacts.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/481/99058a96bf24c5d76fe7b2f559160e4722315a94/angular_injection_contacts.png?response-content-disposition=attachment%3B%20filename%3D%22angular_injection_contacts.png%22%3B%20filename%2A%3DUTF-8%27%27angular_injection_contacts.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR4FQPWNR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134105Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQCqPrnmIM9wXCdiARyRx5Ax4KzkUTX%2BAA9yp0xp0y3hpwIhAJK%2BGpTIPJ74OaDkXCOQ%2BpTihtprvqS4V5mSUh1y2wU%2FKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy0%2FlqLwuvawX3UvDsq1wNbthFe3Azfq%2BVrGAAwOW8v13OVbNefIJYMQ5kDsdlb5HJ08yM0BsqcWahF7IL7L7TYky4BDMksLsE9wim6VKGfrGDkJ2xqf6UemXKLHJTFQYvHptU%2F3szZKR%2FC8LR7%2B6tRZxpqeGaKto06xRg8SdPXPwQ5CCa3sr9z%2FRmk5muNSDIunhQbQtOQkGLdzMqVk6VVPeOXhqlyzAfgT3e83vUfoaaCwfF%2FmCbKBDohDMfithPIZLVroT9vBesKP4IjDlzzfZIO7DWiMOSLRzcTHppAapAKQrTx1YmME3lbOKb0RTUhLkV7At9vcRO6%2FkbRxqMqOEJXCe%2BVL%2BrE6bHoa9n8eWt30xCcMDYrLw%2BgUNiWBz8a2WpzU2sJrhEjHnblMQuWDILIalYkMM7YJoCj0JDvimbFcx%2F8UVUXt3vpIX5YNFVB51MFFGtDIlsnHK31GKw%2BwfgWXHTLxmfkdgOmVicYoRI3iUQD%2BjUHVCHtG%2FOyyW6Jh5Ak5SkV4EnucCAmKjnYxfYTVHvx%2F2qHha2gE7PzO9S1%2F2RLePd%2FBkPMLWvvWtpXghc8EXbG%2FOcrKChbXt0T0mlkm27MvkNDjxxQNHnexQvh%2FlyuMHSSQOsIkoZOkQVEAyb5lyww%2FNOQiwY6pAGOxBpxoNSZNy2UBY4lVVkbrwne8yRQlwxEU8lrQJyCH4OggAZ%2By54oO2xX0ZphtYPfkO82%2FzIZHhgLijH2QZ577nmbTN71zYTVaaML3DYqRqLSP9C1%2F2P5bqIcLRlJSM4rutBebgnwegaTqBmzBoQRinHGD5EkmFos1mfkXnqKw3NLMPoOGBtwvSmsJGplUQJI0wq%2BrRsXTMf9szojjKVaxpuAeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=af9e2f2b2fd04813eaa9cee186421b074285e38eb42dfd5e41fb6a4069af8fd4","file_size":137866,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-13T18:17:03.298Z","allow_singular_disclosure_after":-165525842.0682757,"singular_disclosure_allowed":true,"vote_count":12,"voters":["tomdev","muon4","spam404","yaworsk","eboda","peeper35","absshax","temmyscript","swaysthinking","sa1tama0","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":993315,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-05-31T18:39:49.770Z","updated_at":"2016-05-31T18:39:49.770Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995320,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-06-01T18:25:38.997Z","updated_at":"2016-06-01T18:25:38.997Z","actor":{"url":"/drchrono","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"drchrono"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"drchrono","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011482,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-06-13T18:14:52.561Z","updated_at":"2016-06-13T18:14:52.561Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Mind if we disclose @kgarcia?","automated_response":false,"created_at":"2016-06-13T18:16:48.557Z","updated_at":"2016-06-13T18:16:48.557Z","first_to_agree":true,"actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011612,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-13T19:02:06.247Z","updated_at":"2016-06-13T19:02:06.247Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1011613,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-13T19:02:06.343Z","updated_at":"2016-06-13T19:02:06.343Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}