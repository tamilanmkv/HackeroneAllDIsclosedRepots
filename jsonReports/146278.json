{"id":146278,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDYyNzg=","url":"https://hackerone.com/reports/146278","title":"Log pollution can lead to HTML Injection.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-21T17:45:54.187Z","submitted_at":"2016-06-21T17:45:54.187Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"apok","url":"/apok","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-9459"],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-19T11:52:30.229Z","bug_reporter_agreed_on_going_public_at":"2016-07-19T11:52:30.053Z","team_member_agreed_on_going_public_at":"2016-07-19T09:54:08.099Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\nI was looking around in your app and on the log part (accessed by the admin), I noticed that the log file is downloaded as an HTML file. Naturally I started trying to inject code I noticed that when HTML code is inserted, a HTML comment start tag is inserted. But I was able to bypass this protection by inserting a comment end tag and then the HTML code, which resulted in HTML injection.\n\nTo reproduce this behaviour I started looking where a user is able to inject data onto the log file, and I noticed that when the \"Host\" header is different from the one configured for the app, a warning is injected onto the app. There likely many other sections that could serve to inject into the log, but I've just started to analyze the app so I couldn't find any yet.\n\nProof of Concept:\n1) Generate the following request to the server:\nGET /nextcloud/index.php HTTP/1.1\nHost: --\u003etest\"\u003cimg src=a onerror=alert('xss')\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.7,es-AR;q=0.3\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: keep-alive\n2) Download the log file.\n3) Observe that the code is executed properly.\n\nWhy is this a vulnerability?\nA malicious individual could use this to execute malicious code on an administrator that happened to open the downloaded Log file. \n\nHow to fix?: We can defeat this attack by adding an additional filter on the log file which escapes html special characters.\n\nI'm sending a couple of screenshots. I'll keep digging and if I find anything else I'll send you another report.\n\nKind Regards,\nApok.","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":100806,"file_name":"Request.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/806/382806c8241da8abc543373ca2d6677eeeba42de/Request.png?response-content-disposition=attachment%3B%20filename%3D%22Request.png%22%3B%20filename%2A%3DUTF-8%27%27Request.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b2f7ddcb4f5c879e6001ff77bcc1f5af80ad38b25faeddd726b7f01216c4509","file_size":13742,"type":"image/png"},{"id":100807,"file_name":"Executed_code.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/807/b2de6c70a6a54b9bbb1bc30addc46d7901e3e24c/Executed_code.png?response-content-disposition=attachment%3B%20filename%3D%22Executed_code.png%22%3B%20filename%2A%3DUTF-8%27%27Executed_code.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2020f0f5d32ec4e3a8d883998d6e854dcefe278906c4eae5f7f2405180900bbd","file_size":102291,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-18T09:54:08.171Z","allow_singular_disclosure_after":-162445731.11018947,"singular_disclosure_allowed":true,"vote_count":18,"voters":["lukasreschke","michiel","yaworsk","muhammad_uwais","jaypatel","t4ym","ebelties","drstache","secbughunter","rammarj","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1026905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2016-06-21T17:45:54.958Z","updated_at":"2016-06-21T17:45:54.958Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027099,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for your report, while trying to verify this the file has always been downloaded with a `.log` extension, this can also be observed when looking at [the source code](https://github.com/nextcloud/server/blob/aba539703c0b0388f5ebf8757067bafab56774ce/settings/Controller/LogSettingsController.php#L99-L110):\n\n```php\n\t/**\n\t * download logfile\n\t *\n\t * @NoCSRFRequired\n\t *\n\t * @return StreamResponse\n\t */\n\tpublic function download() {\n\t\t$resp = new StreamResponse(\\OC\\Log\\Owncloud::getLogFilePath());\n\t\t$resp-\u003eaddHeader('Content-Disposition', 'attachment; filename=\"owncloud.log\"');\n\t\treturn $resp;\n\t}\n```\n\nThere the file name is set to `owncloud.log` with an attachment disposition of `attachment`. Would it be possible for you to share detailled reproduction steps to us as on how to trigger this? On your screenshot I see that the file is named `owncloud.log-2.htm`, did you rename the file yourself to that name? ","automated_response":false,"created_at":"2016-06-21T19:52:38.802Z","updated_at":"2016-06-21T19:52:38.802Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, actually I noticed it, but for some reason Firefox 47.0 default behaviour is to let you open it as an html file, i'm adding an extra screenshot with the dialog. My system default (Windows Seven) is to open .log files with notepad.\n","automated_response":false,"created_at":"2016-06-21T20:02:07.086Z","updated_at":"2016-06-21T20:02:41.149Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":100836,"filename":"Firefox.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/836/d5d2b752ce362a8e4723fb73e42878ba7c7f3e1d/Firefox.png?response-content-disposition=attachment%3B%20filename%3D%22Firefox.png%22%3B%20filename%2A%3DUTF-8%27%27Firefox.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=265c730e02fad17fe59d2bc2a03aceb0464f9949adec68a2af530886ee726586"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This behaviour is not observed on Xubuntu 16.04, maybe it is restricted to that configuration?","automated_response":false,"created_at":"2016-06-21T20:03:12.591Z","updated_at":"2016-06-21T20:03:12.591Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027138,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I'll check back what the default behaviour on Firefox on Windows is and how we might need to adjust some of our endpoints.\n\nThanks for reporting this back to us!","automated_response":false,"created_at":"2016-06-21T20:14:10.727Z","updated_at":"2016-06-21T20:14:10.727Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not a problem! Sorry for the confusion.","automated_response":false,"created_at":"2016-06-21T20:30:01.346Z","updated_at":"2016-06-21T20:30:01.346Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there, out of curiosity, are you receiving reports on the next cloud platform? So far I've only seen disclosures on reports of your main website, which is bounty ineligible according to your guidelines. \n\nBtw, just a recommendation to reduce the amount of invalid reports you receive (if and when that becomes an issue), @Phabricator uses a keyword that is included on the bug bounty guidelines, which must be included on the reports, or they will be closed as invalid.\n\nAnd last but not least, I was checking out apps/files_external/ajax/oauth1.php and I noticed that you are using Dropbox_OAuth_Curl, but you've also included Dropbox_OAuth_Zend which is not used anywhere in the code. Be very careful if you ever implement that class, because if the information passed on line 58 is not sanitized, it goes directly to an unserialize() which will cause a very dangerous object injection.\n\nLet me know if these helps!","automated_response":false,"created_at":"2016-06-22T13:27:07.223Z","updated_at":"2016-06-22T13:27:07.223Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1035458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there! Are there any updates on this report? \nThanks!","automated_response":false,"created_at":"2016-06-24T13:44:04.973Z","updated_at":"2016-06-24T13:44:04.973Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1043844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any updates?","automated_response":false,"created_at":"2016-06-28T19:21:08.566Z","updated_at":"2016-06-28T19:21:08.566Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1047034,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No updates on this one yet. We should have some updates by tomorrow. ","automated_response":false,"created_at":"2016-06-30T09:18:27.576Z","updated_at":"2016-06-30T09:18:27.576Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1047214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have done some internal investigation about this and this seems to be caused by Firefox on MS Windows ignoring the fact that we set the download disposition to \"attachment\" and still opening the choice to open the file.\n\nSince the `OCP\\AppFramework\\Http\\StreamResponse` class is used for downloading data the Content-Type was still set to `text/html`, effectively Firefox was thus offering to open the file with a program that is suited for this content-type. Usually itself.\n\nI've authored a patch at https://github.com/nextcloud/server/commit/26aba88f2 that will set the content-type to \"application/octet-stream\". In our testing Firefox offers then to open it in Notepad. Unless you manually associated files of that mimetype with Firefox, but that's something that we consider out of our control.\n\nSee also attached for the behaviour with patch and without patch. As a remark: The JS is executed within the local file scope and not within the one Nextcloud. This can be seen in the picture `without-patch.png` where the alert shows nothing since we were using `document.domain`.\n\n@apok We'd appreciate if you could give this patch a test as well, we're at the moment aiming to have it in our release included for next week.","automated_response":false,"created_at":"2016-06-30T10:57:03.616Z","updated_at":"2016-06-30T10:57:03.616Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":102626,"filename":"with-patch.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/626/0f5d3bc1d33c3b92a981111b0cada52dfd87c0fb/with-patch.png?response-content-disposition=attachment%3B%20filename%3D%22with-patch.png%22%3B%20filename%2A%3DUTF-8%27%27with-patch.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3241155b974cce9356db5deb340c8c4e09a6bbafc39e07797f4169e2d038c141"},{"id":102627,"filename":"without-patch.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/627/e40535de39e55a3b4bd0f14f6bb5231168812f17/without-patch.png?response-content-disposition=attachment%3B%20filename%3D%22without-patch.png%22%3B%20filename%2A%3DUTF-8%27%27without-patch.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=89caa36df93079a58b6fdcdc98fbf0a99e195e912f42f06eab10d6bf24737269"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1047538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Give me half an hour and I'll test it ;) btw, could you read what I posted earlier? The thing about the keyword is very useful (according to the phabricator team) and the thing about oauth could be dangerous. Just covering all the bases.","automated_response":false,"created_at":"2016-06-30T15:03:06.654Z","updated_at":"2016-06-30T15:03:06.654Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1047597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That seemed to do the trick! It's fixed. Firefox defaulted to notepad.","automated_response":false,"created_at":"2016-06-30T15:32:19.925Z","updated_at":"2016-06-30T15:32:19.925Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":102668,"filename":"Fix.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/668/8a7ed1ed97434e821b3bec56d493d02d01be3562/Fix.png?response-content-disposition=attachment%3B%20filename%3D%22Fix.png%22%3B%20filename%2A%3DUTF-8%27%27Fix.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c8ed2c869d4ed52f8ec6d155b8263f7a7b9b4d2f667f32873ba44ced4a5d70b0"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1047886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Hey there, out of curiosity, are you receiving reports on the next cloud platform? So far I've only seen disclosures on reports of your main website, which is bounty ineligible according to your guidelines.\n\nIt depends. Looking at our reports we got 287 reports until now whereas only 10 of them would qualify for any bounty.  \n\n\u003e Btw, just a recommendation to reduce the amount of invalid reports you receive (if and when that becomes an issue), @Phabricator uses a keyword that is included on the bug bounty guidelines, which must be included on the reports, or they will be closed as invalid.\n\nThat's a neat idea. I'm not super comfortable with it though since I don't want to risk to annoy people that actually found a security bug with some negative penalty for not spending all the time to read the policy.\n\nI'd rather be nicer than nasty ;-)\n\n\u003e And last but not least, I was checking out apps/files_external/ajax/oauth1.php and I noticed that you are using Dropbox_OAuth_Curl, but you've also included Dropbox_OAuth_Zend which is not used anywhere in the code. Be very careful if you ever implement that class, because if the information passed on line 58 is not sanitized, it goes directly to an unserialize() which will cause a very dangerous object injection.\n\nGood point. At the moment we're luckily not planning to use the Zend related code. In fact, we plan to replace that whole library with something more modern :-)\n\n\u003e That seemed to do the trick! It's fixed. Firefox defaulted to notepad.\n\n Thanks a lot. Much appreciated that you tested this!","automated_response":false,"created_at":"2016-06-30T18:08:12.702Z","updated_at":"2016-06-30T18:08:12.702Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I totally agree with the \"being nice not nasty\" I started doing full bug bounty 8 to 5 but honestly I moved on to some independent contracts because the security teams I encountered were rude, dismissing, unappreciative and altogether unpleasant. Not to mention that they took literally weeks to answer.\n\nWell, whenever I get a chance I'll keep testing your software and I'll report back if I find something. Let me know when you have any news in regards of the reward.\n\nAll the best,\nAlex","automated_response":false,"created_at":"2016-07-01T11:56:24.750Z","updated_at":"2016-07-01T11:56:24.750Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I totally agree with the \"being nice not nasty\" I started doing full bug bounty 8 to 5 but honestly I moved on to some independent contracts because the security teams I encountered were rude, dismissing, unappreciative and altogether unpleasant. Not to mention that they took literally weeks to answer.\n\nThat sounds like a bad experience. Sorry that you had to encounter this!\n\n\u003e Well, whenever I get a chance I'll keep testing your software and I'll report back if I find something. \n\nAwesome! :-)\n\n\u003e Let me know when you have any news in regards of the reward.\n\nYup. Actually we wanted already to award something to this but apparently we have hit the monthly limit for bounty rewards when paying via bank transfer (apparently limited to $1,500 a month then). We have reached out to HackerOne yesterday to get this resolved… See attachment for the error message we encounter.","automated_response":false,"created_at":"2016-07-01T12:00:20.597Z","updated_at":"2016-07-01T12:00:20.597Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":102798,"filename":"2016-06-30_20-19-07.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/798/9e384810dde3d95fdf0d80d0e06545f4f7e682cc/2016-06-30_20-19-07.png?response-content-disposition=attachment%3B%20filename%3D%222016-06-30_20-19-07.png%22%3B%20filename%2A%3DUTF-8%27%272016-06-30_20-19-07.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134259Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=74b11b8b25134e064a8acec4c7afffc6b8fa1a7ab461959b9edb74b5481226cb"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1050503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, you've been responsive, professional, polite and altogether nice. No rush ;)","automated_response":false,"created_at":"2016-07-02T16:09:06.751Z","updated_at":"2016-07-02T16:09:06.751Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053570,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report. We believe to have resolved this problem in the [just released 9.0.52 release](https://nextcloud.com/nextcloud-9-update-brings-security-open-source-enterprise-capabilities-and-support-subscription-ios-app/).\n\nWe'd greatly appreciate it if you could take a second to confirm this patch. We'd then proceed as following:\n\n1. In 14 days we will release a detailed advisory describing this vulnerability\n2. We'll request public disclosure of this report at the same time\n\nOur advisories will contain a CVE identifier and credit you for the finding. If you want to be credited differently than written on your HackerOne profile please leave a comment with:\n\n1. Name / Pseudonyme\n2. Company (optional)\n3. Website (optional)\n4. Mail address (optional)\n\nFor obvious reasons we'd appreciate if you would not disclose any information about these vulnerability until the 19th of July 2016.\n\nWith reward to the reward decision we're still in the progress to converting to HackerOne's new payment model. I'll keep you updated.","automated_response":false,"created_at":"2016-07-05T13:04:19.482Z","updated_at":"2016-07-05T13:04:19.482Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"apok","url":"/apok"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1054140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I installed the new version from scratch and I can confirm that the issue is patched. In regards of the CVE identifier, please use my hackerone information \"Alejo Popovici\", I won't disclose until you authorize and thanks for the update on the reward.\n\nKind Regards,\nAlex","automated_response":false,"created_at":"2016-07-05T17:22:33.966Z","updated_at":"2016-07-05T17:22:33.966Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, do we have any updates on the reward?\nThanks","automated_response":false,"created_at":"2016-07-12T00:02:13.057Z","updated_at":"2016-07-12T00:02:13.057Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still sorting out the new payment model. No worries, this one is in the \"Pending bounty\" tab :-)","automated_response":false,"created_at":"2016-07-12T10:32:17.866Z","updated_at":"2016-07-12T10:32:17.866Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1065843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just checking in ;) Thanks!","automated_response":false,"created_at":"2016-07-12T20:30:47.278Z","updated_at":"2016-07-12T20:30:47.278Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075614,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We've published an advisory at https://nextcloud.com/security/advisory/?id=nc-sa-2016-002 and are awaiting the CVE assignment. Thanks a lot again, @apok for pointing out this vulnerability!\n\nAbout the bounty we're still waiting for some external party to solve the payment process. But we're likely to assign you a $350 bounty. (due to the fact that the impact is very limited) – I'll get that done once the problems have been sorted out.","automated_response":false,"created_at":"2016-07-19T09:54:08.131Z","updated_at":"2016-07-19T09:55:14.255Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075764,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The bounty seems fair and I'll gladly accept public disclosure. Please take into account the recommendations I posted earlier! \nKind Regards,\nApok","automated_response":false,"created_at":"2016-07-19T11:52:30.090Z","updated_at":"2016-07-19T11:52:30.090Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075765,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-19T11:52:30.263Z","updated_at":"2016-07-19T11:52:30.263Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1088645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, any news about payment?\nThanks!","automated_response":false,"created_at":"2016-07-26T16:24:30.073Z","updated_at":"2016-07-26T16:24:30.073Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1099440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello? Are there any news?","automated_response":false,"created_at":"2016-08-01T11:50:46.511Z","updated_at":"2016-08-01T11:50:46.511Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1104049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello?","automated_response":false,"created_at":"2016-08-03T14:14:03.558Z","updated_at":"2016-08-03T14:14:03.558Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1127278,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"I understand that this team has had problems with the bounty payment system, but it's been almost a month since the public disclosure and they still haven't assigned a bounty. Please reach out to the team and ask them to inform about their current situation.\n\nThanks","automated_response":false,"created_at":"2016-08-15T16:12:58.578Z","updated_at":"2016-08-15T16:12:58.578Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152223,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Apologize for the delay on this one, we had some trouble getting our account adjusted to new pre-payment model of HackerOne. We were on post-payment before) and had reached the $1,800 limitation.\n\nWe've now finally sorted out the new payment process and the bank transfer got through now.\n\nThanks again for reporting this back to us, and apologize for the delay.","automated_response":false,"created_at":"2016-08-24T18:04:30.887Z","updated_at":"2016-08-24T18:04:30.887Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"apok","url":"/apok"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152230,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2016-08-24T18:05:30.183Z","updated_at":"2016-08-24T18:05:30.183Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"apok","url":"/apok"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1153686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","automated_response":false,"created_at":"2016-08-25T12:42:17.647Z","updated_at":"2016-08-25T12:42:17.647Z","actor":{"username":"apok","cleared":true,"url":"/apok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zTh9rvWndX5ZwoyaucB9eBoV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2236,"category":"team","content":"The \"download log\" functionality in the admin screen is delivering the log in JSON format to the end-user. The file was delivered with an attachment disposition forcing the browser to download the document. However, Firefox running on Microsoft Windows would offer the user to open the data in the browser as HTML document. Thus any injected data in the log would be executed.\n\nWhile the document would only be executed locally (thus on another scope) we have decided to fix this to protect our users.\n\nA detailed advisory can be found at https://nextcloud.com/security/advisory/?id=nc-sa-2016-002.\n\n------\nThanks a lot, @apok  for pointing out this vulnerability!","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":37891,"username":"lukasreschke","name":"Lukas Reschke","bio":"","cleared":false,"website":"https://statuscode.ch","location":"Switzerland","created_at":"2015-08-05T13:37:40.660Z","url":"https://hackerone.com/lukasreschke","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBaFlXIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--247fe95a40e99ca7d18708743afb883e8a4441f1/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/878997_(1).png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}