{"id":147260,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDcyNjA=","url":"https://hackerone.com/reports/147260","title":"Weak HSTS age","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-25T17:54:16.638Z","submitted_at":"2016-06-25T17:54:16.638Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ketankumar_godhani","url":"/ketankumar_godhani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/874/e9b72b6e524a8c77c96f2ec22126600f56b1095e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":12707,"url":"https://hackerone.com/fantasytote","handle":"fantasytote","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/707/bfa35769e5098520d860ba829dce4d1089ce4971_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/707/bfa35769e5098520d860ba829dce4d1089ce4971_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"FantasyTote","twitter_handle":"","website":"https://www.fantasytote.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-14T18:51:09.750Z","bug_reporter_agreed_on_going_public_at":"2016-07-08T03:06:09.696Z","team_member_agreed_on_going_public_at":"2016-07-14T18:51:09.539Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Send this request:\n\nhttps://www.fantasytote.com/login\n\nGET /login HTTP/1.1\nHost: www.fantasytote.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nCookie: __cfduid=d8a2061ca9ed456b3696715a5f068a5731466869224; _session_id=838eb8d660cd138f1b7fab029187cc9a; _ga=GA1.2.321412493.1466869396; _gu=732e6098-8746-4c7d-be39-fd7fb86290d3; _gw=2.69166(sc~7,s~o9c97z)u[~0,~0,~0,~0,~0]v[~ek05j,~5,~1]a(); _gs=2.s(src=https://www.fantasytote.com/login); _gat=1\nConnection: keep-alive\n\nHTTP/1.1 200 OK\nDate: Sat, 25 Jun 2016 17:50:24 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nCache-Control: no-cache, no-store, private, must-revalidate, max-age=0, max-stale=0, post-check=0, pre-check=0\nsurrogate-control: max-age: 0\nPragma: no-cache\nExpires: 0\nVary: *\nSet-Cookie: _session_id=8b128154bdaf0790aa1120cc4f5d8b4e; path=/; expires=Mon, 27 Jun 2016 17:50:24 -0000; secure; HttpOnly\nx-request-id: 72a13e25-b3fb-4a60-9260-c2e9c9ef373b\nx-runtime: 0.045696\nStrict-Transport-Security: max-age=0; includeSubDomains; preload\nx-ua-compatible: IE=Edge,chrome=1\nServer: cloudflare-nginx\ncf-ray: 2b8a42f9e2122dcd-BOM\nContent-Length: 27864\n\n\n\n\n\n\n\n==\u003e\u003eStrict-Transport-Security: max-age=0\n==\u003e\u003e Directs the browser to delete the entire HSTS policy.\n\nhttps://blog.qualys.com/securitylabs/2016/03/28/the-importance-of-a-proper-http-strict-transport-security-implementation-on-your-web-server","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-07T03:06:09.864Z","allow_singular_disclosure_after":-163420635.3681141,"singular_disclosure_allowed":true,"vote_count":3,"voters":["ketankumar_godhani","hackworld","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1037058,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"No attack vector mentioned","automated_response":false,"created_at":"2016-06-25T17:56:10.903Z","updated_at":"2016-06-25T17:56:10.903Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1037065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attack vector:\n\nSecure websites that do not use HSTS are trivial to attack if the attacker can hijack a victim's web traffic, but it is even easier to defeat such attacks by implementing an HSTS policy.\n\n\n\nhttps://tools.ietf.org/html/rfc6797\n\n\nHow to mitigate issue:\n\nJust set max age as \nStrict-Transport-Security: max-age=31536000; includeSubDomains\n\n-The HSTS policy is applied to the domain of the issuing host as well as its subdomains and remains in effect for one year.\n","automated_response":false,"created_at":"2016-06-25T18:03:55.366Z","updated_at":"2016-06-25T18:03:55.366Z","actor":{"username":"ketankumar_godhani","cleared":false,"url":"/ketankumar_godhani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/874/e9b72b6e524a8c77c96f2ec22126600f56b1095e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1037922,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-06-26T12:06:20.999Z","updated_at":"2016-06-26T12:06:20.999Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1037923,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-06-26T12:06:33.063Z","updated_at":"2016-06-26T12:06:33.063Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1054734,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delay. This is a very simple change, but for some strange reason, the change is not been applied to live site, so still trying to track it down","automated_response":false,"created_at":"2016-07-05T23:18:52.780Z","updated_at":"2016-07-05T23:18:52.780Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1058168,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Many thanks, resolved now","automated_response":false,"created_at":"2016-07-07T21:39:03.973Z","updated_at":"2016-07-07T21:39:03.973Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ketankumar_godhani","url":"/ketankumar_godhani"},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1058581,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"disclose?","automated_response":false,"created_at":"2016-07-08T03:06:09.752Z","updated_at":"2016-07-08T03:06:09.752Z","first_to_agree":true,"actor":{"username":"ketankumar_godhani","cleared":false,"url":"/ketankumar_godhani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/874/e9b72b6e524a8c77c96f2ec22126600f56b1095e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1069261,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-14T18:51:09.599Z","updated_at":"2016-07-14T18:51:09.599Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1069262,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-14T18:51:09.779Z","updated_at":"2016-07-14T18:51:09.779Z","actor":{"username":"fantasytoteuser","cleared":false,"url":"/fantasytoteuser","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"fantasytote","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}