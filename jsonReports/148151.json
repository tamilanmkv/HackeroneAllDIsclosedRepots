{"id":148151,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDgxNTE=","url":"https://hackerone.com/reports/148151","title":"SMB User Authentication Bypass and Persistence","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-29T06:53:24.816Z","submitted_at":"2016-06-29T06:53:24.816Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rhinosecuritylabs","url":"/rhinosecuritylabs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-9463"],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-26T15:29:24.618Z","bug_reporter_agreed_on_going_public_at":"2016-10-27T15:29:23.771Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Authentication Bypass\n==================\n\nThe external user authentication app in OwnCloud does not properly authenticate against an SMB server. In it's current implementation, the file (owncloud/apps/user_external/lib/smb.php, line 46-47) uses the command `smbclient -L //host/dummy -Uuser%pass`, where the variables `user` and `pass` are escaped for shell characters. However, default Samba SMB servers set \"map to guest\" to the value \"bad user\". This allows for the listing of shares regardless of user, but not further information. \n\nThe image shows the command `smbclient -L //localhost/dummy -Utest%test` succeeding with an invalid user \"test\" using password \"test\", yet the user does not exist as shown by the second command `smbclient //localhost/dummy -Utest%test`.\n\n{F102413}\n\nWhen the default \"map to guest\" parameter is changed to \"never\" in the smb.conf for the SMB server, both commands fail as required.\n\n{F102414}\n\nTo properly validate the user the command should simply be `smbclient //host -Uuser%pass`. This properly authenticates the user and returns a valid error message the the script can interpret. In it's current implementation, providing any username to the application will log you in as that user - even creating a new one if necessary.\n\nTo Replicate\n------------------\n1. Set up a Samba SMB server like detailed on this page:\n\nhttps://help.ubuntu.com/community/How%20to%20Create%20a%20Network%20Share%20Via%20Samba%20Via%20CLI%20(Command-line%20interface/Linux%20Terminal)%20-%20Uncomplicated,%20Simple%20and%20Brief%20Way!\n\n2. Login to the OwnCloud application and enable the external user authentication app.\n\n3. Edit the config and add:\n'user_backends' =\u003e \n  array (\n    0 =\u003e \n    array (\n      'class' =\u003e 'OC_User_SMB',\n      'arguments' =\u003e \n      array (\n        0 =\u003e 'SMBHOST',\n      ),\n    ),\n  ),\n\n3. If a user already exists and you have the username, you can login using any password (including the administrator account!). If user doesn't exist, it will create said user and log you in.\n\n\nUntrusted Parameter Host\n======================\n\nIn the same php file (owncloud/apps/user_external/lib/smb.php, line 46-47) the parameter `host` is not properly escaped. This allows for code execution every time a user logs into the application if they were able to edit the owncloud/config/config.php file. This could allow for a valid persistence mechanism within the application.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102413,"file_name":"Screen_Shot_2016-06-28_at_11.45.08_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/413/bd6ad1e590346403092f322c9256d706614ac515/Screen_Shot_2016-06-28_at_11.45.08_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-28_at_11.45.08_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-28_at_11.45.08_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134337Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c4f461c5febb29fde1d780500ea4a48140fac529caa405ef2bfba36bf0136c25","file_size":196762,"type":"image/png"},{"id":102414,"file_name":"Screen_Shot_2016-06-28_at_11.46.11_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/414/ee218050665c73c0c15040502fa350f1e75b481b/Screen_Shot_2016-06-28_at_11.46.11_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-06-28_at_11.46.11_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-06-28_at_11.46.11_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134337Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e73a08a8523cd0ec86f55c21bfe1a2556a377429e5799c4e3d7590a0f0e8c1ce","file_size":83565,"type":"image/png"}],"allow_singular_disclosure_at":"2016-11-26T15:29:23.808Z","allow_singular_disclosure_after":-153785653.82584995,"singular_disclosure_allowed":true,"vote_count":8,"voters":["lukasreschke","mpz","eveeez","sodium_","lordjerry0x01","linkks","sumit7","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1044699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","automated_response":true,"created_at":"2016-06-29T06:53:25.019Z","updated_at":"2016-06-29T06:53:25.019Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1048994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the detail report. Would you mind submitting the \"Untrusted Parameter Host\" that leads to code execution in a separate entry ?\n\nAnd we'll keep this ticket here for the \"Authentication Bypass\" only.","automated_response":false,"created_at":"2016-07-01T10:53:59.649Z","updated_at":"2016-07-01T10:53:59.649Z","actor":{"username":"pvince81","cleared":false,"url":"/pvince81","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049008,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-07-01T10:56:24.748Z","updated_at":"2016-07-01T10:56:24.748Z","actor":{"username":"pvince81","cleared":false,"url":"/pvince81","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just tried this locally and when I remove the \"-L\" I always get NT_STATUS_BAD_NETWORK_NAME for both existing and non-existing users. My smb.conf has \"map to guest = Bad User\"\n\n% smbclient //localhost/dummy -Utest%test\nDomain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.4.2-3659-SUSE-oS13.3-x86_64]\ntree connect failed: NT_STATUS_BAD_NETWORK_NAME\n\n% smbclient //localhost -Utest%test\n\\\\localhost: Not enough '\\' characters in service\n\nSame result with valid credentials.\n\nMaybe the behavior is different depending on Samba versions ?","automated_response":false,"created_at":"2016-07-01T13:35:46.114Z","updated_at":"2016-07-01T13:35:46.114Z","actor":{"username":"pvince81","cleared":false,"url":"/pvince81","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Regarding the \"untrusted host\" part, a regular user cannot edit config/config.php. This file is only accessible to admins on the command line. So this isn't a critical issue.\nI've still created a ticket internally to properly escape this part for hardening.\n","automated_response":false,"created_at":"2016-07-01T13:41:55.568Z","updated_at":"2016-07-01T13:41:55.568Z","actor":{"username":"pvince81","cleared":false,"url":"/pvince81","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will indeed move the Untrusted Parameter Host to a separate entry!","automated_response":false,"created_at":"2016-07-01T16:09:16.272Z","updated_at":"2016-07-01T16:09:16.272Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"When removing the -L, you should then add to the end of the host the valid share to which users have access to. The reason you're getting a bad network name is because the share you're trying to access does not exist. The first image confirms your results (of NT_STATUS_BAD_NETWORK_NAME), then shows that when connecting to the valid share no error is returned.\n","automated_response":false,"created_at":"2016-07-01T16:15:03.767Z","updated_at":"2016-07-01T16:15:03.767Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":102832,"filename":"Screen_Shot_2016-07-01_at_9.11.51_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/832/01a553bf9619e2bab7e0eed69f439e61b7efae21/Screen_Shot_2016-07-01_at_9.11.51_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-07-01_at_9.11.51_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-07-01_at_9.11.51_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134337Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fb8b32d559983c77009038a2351d4a9ff603e81721435abce05065e6792234b2"}],"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Further, the smb.conf file dictates valid users and shares. Would a potential solution be to specify a share name in the config file along with the SMB Server? Then the command could connect using `//host/share_name` instead of the `/dummy` share. Or would this be an inadequate solution?","automated_response":false,"created_at":"2016-07-01T16:17:15.258Z","updated_at":"2016-07-01T16:17:15.258Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":102833,"filename":"Screen_Shot_2016-07-01_at_9.11.51_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/833/fff8dd5d9551f0baa9dff23d3e16aa64d661f444/Screen_Shot_2016-07-01_at_9.11.51_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-07-01_at_9.11.51_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-07-01_at_9.11.51_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134337Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5f57350bdacaa5682ba8cab4d86b0f1f29122eebe64566c14a44ea42e9a58e56"}],"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there,\n\nAny update on this ticket? We were hoping to release a blog post detailing some of these vulnerabilities but don't want to do so until a fix has been issued.","automated_response":false,"created_at":"2016-07-27T16:20:17.407Z","updated_at":"2016-07-27T16:20:17.407Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1102736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just wanted to reach out and say we plan to make a post by Tuesday of next week and make sure everything was resolved before we push.","automated_response":false,"created_at":"2016-08-02T18:05:14.734Z","updated_at":"2016-08-02T18:05:14.734Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117362,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-08-10T16:12:31.926Z","updated_at":"2016-08-10T16:12:31.926Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117373,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @rhinosecuritylabs \n\nApologize for the delay on this. This just got escalated to me on request of ownCloud GmbH and I'm happy to be of help here to resolve this issue. \n\nCan I ask you to delay your blogpost a little bit? I'll look into this right away and hopefully we can work together on a quick resolution.\n\nThanks a lot!\nLukas","automated_response":false,"created_at":"2016-08-10T16:15:37.967Z","updated_at":"2016-08-10T16:29:46.894Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117507,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again, @rhinosecuritylabs for your very detailed report. This is very much appreciated. Please do apologise the delay on this on the ownCloud end.\n\nI was able to reproduce the authentication bypass using the [Ubuntu tutorial](https://help.ubuntu.com/community/How%20to%20Create%20a%20Network%20Share%20Via%20Samba%20Via%20CLI%20%28Command-line%20interface/Linux%20Terminal%29%20-%20Uncomplicated%2C%20Simple%20and%20Brief%20Way%21) you've linked. For future reproduction steps I've created an Ubuntu based Docker image that will reproduce the problem. The valid user would be \"root\" with the password \"1234\".\n\n------\n`Dockerfile:`\n```\nFrom ubuntu\n\nRun apt-get -y update\nRUN apt-get -y install samba vim smbclient\nRUN bash -c \"echo -e '1234\\n1234\\n'\" | smbpasswd -a root\nRUN mkdir -p /root/smb_share/\nADD /smb_config_addition.conf /\nRUN cat /smb_config_addition.conf \u003e\u003e /etc/samba/smb.conf\nEXPOSE 137 138 139 445\nCMD [\"/usr/sbin/smbd\", \"-FS\"]\n```\n------\n`smb_config_addition.conf:`\n```\n[smb_share]\npath = /root/smb_share/\nvalid users = root\nread only = no\n```\n------\n\nBuilding the docker then is as simple as running `docker build .` and then executing it with `docker run -p 137-139:137-139 -p 445:445 $CONTAINERID`. SMB will then listen on localhost.\n\nI'll look into some mitigations possibilities here and get back to you soon. ","automated_response":false,"created_at":"2016-08-10T17:07:41.841Z","updated_at":"2016-08-10T17:08:38.263Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Lukas,\n\nThanks so much for getting back with us. Absolutely we can hold off until a patch has been issued. Let us know if you need anything from our end!","automated_response":false,"created_at":"2016-08-10T17:11:01.804Z","updated_at":"2016-08-10T17:11:01.804Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117587,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have been thinking about the possibilities here a bit. At the moment those options come to my head:\n\n**1.  Have administrators configure an existing share and check permissions there**\n\nI'm personally not a great fan of this as it is an additional administrative task that is error-prone. Another administrator may reconfigure the share, resulting in the same problem we have now.\n\n**2. Require administrators to disable anonymous access and have a check in the PHP code**\n\nWe could require administrators to configure their server in a way that no anonymous nor guest login is permitted. This would be possible by simply performing something like `smbclient -L '//127.0.0.1/dummy' --no-pass`.\n\nThis seems like a straight forward possibility. However, it won't wake with the `map to guest` config switch. Here would simply have to be guest access forbidden globally, such as with:\n\n```\nrestrict anonymous = 2\n```\n\n**3. Check on login with another random password as well**\n\nSomething that came to my mind that certainly isn't the most cleanest solution but seems to mitigate this problem is: Just check twice for the password.\n\nSo basically once the user has authenticated in `\\OC_User_SMB::checkPassword` we perform another password check with a different password. If the login works also with the invalid password (which could simply be a ROT-13) then we cancel the login. If the login fails with the wrong password then we proceed.\n\nAt the moment this is something that I personally would be in favour of. It doesn't require any SMB server configuration changes.\n\n---\n\nAs a remark, deprecating this component considering that LDAP auth is possible would probably also a good action. But for existing versions I suppose a patch has to be delivered.\n\n@rhinosecuritylabs Do you have any thoughts on these three options? Do you see any problems with one of these approaches?","automated_response":false,"created_at":"2016-08-10T17:41:58.305Z","updated_at":"2016-08-10T17:41:58.305Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perhaps a combination of both 2 and 3 is best. If a password is passed through, and we can verify the account is not a guest or anonymous, try to additionally login with the securely generated password (8-12 characters). If then both passwords succeed (user passed and machine generated), fail the login. Otherwise login the user.","automated_response":false,"created_at":"2016-08-10T18:23:58.868Z","updated_at":"2016-08-10T18:23:58.868Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1145343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update in terms of time frame, fixes, etc?","automated_response":false,"created_at":"2016-08-22T17:52:36.597Z","updated_at":"2016-08-22T17:52:36.597Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1145840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our disclosure policy itself is 45 days and want to ensure this issue is patched before releasing a statement regarding the vulnerability.","automated_response":false,"created_at":"2016-08-22T20:39:38.363Z","updated_at":"2016-08-22T20:39:38.363Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1179637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As far as I'm aware of there is a release of ownCloud scheduled for September 20 2016.\n\n@deepdiver @pvince81 Would it be possible to include patches for that one as well? – I'd advocate for that.","automated_response":false,"created_at":"2016-09-07T09:19:13.484Z","updated_at":"2016-09-07T09:19:13.484Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1179662,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are seriously considering to drop that app which is anyhow not used that much.\n\nFurthermore I have to be honest with you I fail to understand the impact of this.","automated_response":false,"created_at":"2016-09-07T09:29:57.706Z","updated_at":"2016-09-07T09:29:57.706Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1179685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e We are seriously considering to drop that app which is anyhow not used that much.\n\nACK. It may be considerable though to deprecate that properly and deliver a patch for older releases anyhow.\n\n\u003e Furthermore I have to be honest with you I fail to understand the impact of this.\n\nBasically you can authenticate without a valid password in case your SMB share is accepting anonymous access. (which usually is the case)\n\nFixing this should be the matter of the following diff: https://gist.github.com/LukasReschke/5d9079523ee30d3c1be6f09dd20c25af/revisions","automated_response":false,"created_at":"2016-09-07T09:40:24.971Z","updated_at":"2016-09-07T09:40:24.971Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1179722,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Basically you can authenticate without a valid password in case your SMB share is accepting anonymous access. (which usually is the case)\n\nWell - anonymous access is there to get access to what ever you want with(out) any password.\nWhats the deal? Public visible files will be publicly visible?\n\nWhere is the issue?\n","automated_response":false,"created_at":"2016-09-07T09:55:09.492Z","updated_at":"2016-09-07T09:55:09.492Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1179789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Well - anonymous access is there to get access to what ever you want with(out) any password.\nWhats the deal? Public visible files will be publicly visible?\n\nAnonymous access in this case does not mean you have access to any data. What it means, is that the SMB server returns you a list of resources that you have access to as anonymous user. That doesn't have to be any share at all.\n\nThe ownCloud SMB authentication backend works the following:\n\n1. Ask the SMB server for authentication with specific credentials\n2. If the return value doesn't indicate `NT_STATUS_LOGON_FAILURE` or `NT_STATUS_BAD_NETWORK_NAME` or another error: Login the user.\n\n`NT_STATUS_LOGON_FAILURE` however does only really make sense if the connection attempt goes to a valid share. At the moment it is simply done at the root where most SMB servers will simply give you an anonymous auth then.\n\nUltimately, this means that someone can bypass authentication in case the SMB server behaves that way. Since this is the default configuration in modern Samba, I would consider this myself an issue that should get fixed. It's simply against any user expectation and an auth bypass.","automated_response":false,"created_at":"2016-09-07T10:35:52.088Z","updated_at":"2016-09-07T10:35:52.088Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1188709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For full transparency, the [Nextcloud](https://nextcloud.com/about/) security team considers this a valid vulnerability. Great catch and thanks a lot for reporting that responsibly.\n\nAs we would like to protect our users as soon as possible, the Nextcloud releases coming this week will include patches for this. \n\n@rhinosecuritylabs, we'll create advisories on https://nextcloud.com/security/advisories/ and publish them as per our policy 14 days after the release. Please let us know how you want to be credited on that one. Our advisory system supports the following information:\n- Name / Pseudonym\n- Email address\n- Web site\n\nI am not clear on if ownCloud considers this a security issue or plans to deal with it as such. As it is my understanding they aim to do a release this week as well, the timeframe above will leave them with enough time to include a fix. \n\nThis is of course not my decision, I have neither any control over nor affiliation with them. But in any case I would like to ask both them and you to be so kind  not disclose this publicly before at least this Thursday.","automated_response":false,"created_at":"2016-09-12T14:42:17.167Z","updated_at":"2016-09-12T14:42:17.167Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Absolutely, we can wait until the advisory is released. For accreditation we'll use:\n\nName / Pseudonym: Dwight Hohnstein / Rhino Security Labs\nEmail address: dwight.hohnstein@rhinosecuritylabs.com\nWeb site: www.rhinosecuritylabs.com\n\nThanks for fighting for us and patching this vulnerability!","automated_response":false,"created_at":"2016-09-12T17:09:42.540Z","updated_at":"2016-09-12T17:09:42.540Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did you create the advisory by chance? I've been watching the security advisories page and didn't see it go by.","automated_response":false,"created_at":"2016-09-29T20:48:04.938Z","updated_at":"2016-09-29T20:48:04.938Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The release unfortunately got delayed a bit since Engineering was tasked to also include a new updater that needed proper regression testing. That has been done now and the release has been released yesterday.\n\nI'll make sure to put out advisories within the next week and send you a draft to review. Is above email (dwight.hohnstein@rhinosecuritylabs.com) a channel you prefer? Or should I post it here?\n\nApologize for the delay on that one.","automated_response":false,"created_at":"2016-09-29T21:07:29.780Z","updated_at":"2016-09-29T21:07:40.285Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem! And either communication channel is fine for me, whichever is easiest for you. Look forward to the new release!\n\nCheers,\nDwight","automated_response":false,"created_at":"2016-09-29T21:12:18.264Z","updated_at":"2016-09-29T21:12:18.264Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1236806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rhinosecuritylabs Please review below advisory, it is scheduled for Tuesday next week, 12:00 AM CET at https://nextcloud.com/security/advisory/?id=nc-sa-2016-006. If you wish any changes, please let us know.\n\nIf you plan to do a blog post about this, we'd appreciate if you can hand us the URL so we can reference it from our advisory as well. We'd be happy to do that!\n\nJust for clarification, this issue will be fixed in the ownCloud fork, [Nextcloud](https://nextcloud.com/). I didn't hear yet any feedback from ownCloud in this issue so I guess they consider this a won't fix. (also related: https://central.owncloud.org/t/anybody-using-samba-authentication/1564)\n\n---\n\n# SMB User Authentication Bypass (NC-SA-2016-006)\n- 11th October 2016\n- Risk Level: **High**\n- CVSS v3 Base Score: 7.4 ([AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N))\n- CWE: [Incorrect Implementation of Authentication Algorithm (CWE-303)](https://cwe.mitre.org/data/definitions/303.html)\n- HackerOne Report: [148151](https://hackerone.com/reports/148151)\n\n##Description\n\nNextcloud includes an optional and not by default enabled SMB authentication component that allows to authenticate users against an SMB server. \n\nThis backend is implemented in a way that it tries to connect to a SMB server and if that succeeded consider the user logged-in.\n\nThe backend did not properly take into account SMB servers that any kind of anonymous auth configured. This is the default on SMB servers nowadays and allows an unauthenticated attacker to gain access to an account without valid credentials. \n\n**Note:** The SMB backend is disabled by default and requires manual configuration in the Nextcloud config file. If you have not configured the SMB backend then you're not affected by this vulnerability. \n\n##Affected Software\n\n- Nextcloud Server \u003c 9.0.54 (CVE assignment pending)\n  - [apps/decb91fd31f4ffab191cbf09ce4e5c55c67a4087](https://github.com/nextcloud/apps/commit/decb91fd31f4ffab191cbf09ce4e5c55c67a4087)\n- Nextcloud Server \u003c 10.0.1 (CVE assignment pending)\n  - [apps/b85ace6840b8a6704641086bc3b8eb8e81cb2274](https://github.com/nextcloud/apps/commit/b85ace6840b8a6704641086bc3b8eb8e81cb2274)\n\n##Action taken\nThe SMB backend is now performing an additional authentication attempt with invalid credentials. If that succeeds as well it assumes that anonymous authentications are enabled and denies the login attempt. \n\n##Acknowledgements\nThe Nextcloud team thanks the following people for their research and responsible disclosure of the above advisory:\n\n- [Dwight Hohnstein (dwight.hohnstein@rhinosecuritylabs.com) - Rhino Security Labs](www.rhinosecuritylabs.com) - Vulnerability discovery and disclosure.","automated_response":false,"created_at":"2016-10-07T08:43:06.011Z","updated_at":"2016-10-07T08:43:17.364Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1237689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Lukas,\n\nEverything looks great to me! I believe the URL for the blog post will be: https://rhinosecuritylabs.com/2016/08/operation-ownedcloud-exploitation-post-exploitation-persistence. We'll make sure to include the disclosure timeline, along with who took the proactive action to patch. We'll publish next Tuesday so we will be in sync for release. Thank you once again!","automated_response":false,"created_at":"2016-10-07T18:18:26.068Z","updated_at":"2016-10-07T18:18:26.068Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\njust to let you know we applied the patch to ownCloud as well - https://github.com/owncloud/apps/pull/2199\n\nI'm sorry for the lack in communication at this point.\n\nThanks,\n\nThomas","automated_response":false,"created_at":"2016-10-13T08:06:03.375Z","updated_at":"2016-10-13T08:06:03.375Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Judging from the GitHub PR list on the owncloud/apps repo this only targets 9.1 and *NOT* older branches. So this patch is effectively _not_ included in most supported versions.\n\nFrom https://github.com/owncloud/core/wiki/Maintenance-and-Release-Schedule it seems to miss the following supported versions:\n\n- 9.0.x\n- 8.2.x\n- 8.1.x\n- 8.0.x","automated_response":false,"created_at":"2016-10-13T08:10:34.308Z","updated_at":"2016-10-13T08:10:34.308Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks Lukas - we will analyse the situation and see what we can do.\n","automated_response":false,"created_at":"2016-10-13T08:18:10.998Z","updated_at":"2016-10-13T08:18:10.998Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've updated the article to indicate a patch has been issued for 9.1 and (as of yet) not older versions.","automated_response":false,"created_at":"2016-10-13T16:30:29.413Z","updated_at":"2016-10-13T16:30:29.413Z","actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1263886,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-10-24T09:01:07.894Z","updated_at":"2016-10-24T09:01:07.894Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rhinosecuritylabs","url":"/rhinosecuritylabs"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1271074,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-27T15:29:23.787Z","updated_at":"2016-10-27T15:29:23.787Z","first_to_agree":true,"actor":{"username":"rhinosecuritylabs","cleared":false,"url":"/rhinosecuritylabs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/014/87f51a075923b3ca98dee6380644f9f008ae96fc_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1320842,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-11-26T15:29:24.637Z","updated_at":"2016-11-26T15:29:24.637Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572406,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-03-30T08:02:42.357Z","updated_at":"2017-03-30T08:02:42.357Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"owncloud","collaborator":{"username":"rhinosecuritylabs","url":"/rhinosecuritylabs"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}