{"id":148467,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg0Njc=","url":"https://hackerone.com/reports/148467","title":"Паблики: Модератор паблика может удалять добавленные редакторами материалы с таймером на публикацию.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-30T13:48:22.355Z","submitted_at":"2016-06-30T13:48:22.355Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"povargek","url":"/povargek","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nS7rNaLQVwztSp3zfcDqNCHF/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-12-04T21:33:52.598Z","bug_reporter_agreed_on_going_public_at":"2016-11-04T21:33:49.143Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Модератор паблика может удалять добавленные редакторами материалы с таймером на публикацию.\nДля начала можно посмотреть какие ранги есть у пользователей сообщества: https://new.vk.com/page-2158488_44367987\nТут написано: \"Не может удалять контент, добавленный другими руководителями.\". Да, это действительно так, но есть одна проблема, модератор может удалять материалы, которые другие руководители поставили на таймер публикации. Теперь можно перейти к тому, как воспроизвести этот баг.\nНам необходимо: модераторские права в паблике, ID поста на отложенную запись.\n1. https://new.vk.com/dev/wall.delete - прописываем в owner_id ID паблика, а в post_id ID поста-жертвы, выполняем запрос.\n2. В случае удачи нам вернет \"response: 1\", отложенный на публикацию пост будет удален.\nДля поиска \"жертв\" можно использовать метод перебора, проверять пропуски между постами и тд. Замечу то, что wall.delete вернет в любом случае (ранг \"модератор\", речь не о подписчиках) \"response: 1\", если по этому ID был когда-то пост с отложенной публикацией.\n\n\nКакой вред это может нанести пользователям? Приведу пример. Есть какой-либо крупный паблик, руководители: создатель, один редактор и и один модератор. Модератор \"в тихую\" удаляет данным багом посты на отложенную публикацию, тут создатель замечает что посты пропадают, проверяет свой аккаунт на взлом - всё чисто, и подозрения сразу у него упадут на редактора паблика, т.к. создатель паблика знает что модератор их не может удалять - ему эта функцию просто напросто недоступна, и невинного редактора увольняют с его поста.\n\nP.S. Мой первый PoC, опыта в баг-репортах ранее не имел.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-04T21:33:49.190Z","allow_singular_disclosure_after":-153072593.12140113,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","testsmush"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1073802,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Здравствуйте! \n\nСпасибо за репорт. Мы его исследуем и сообщим Вам о результатах.","automated_response":false,"created_at":"2016-07-18T13:40:59.826Z","updated_at":"2016-07-18T13:40:59.826Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1266620,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Проверил сегодня, картина такая: через API запись удалить больше нельзя, но можно обычным способом - нужно иметь токен удаления (/al_wall.php act:delete), но чтобы его получить надо быть редактором или выше. Пример: сейчас мы редакор, для нас отобразился раздел \"Отложенные записи\", мы ничего не трогаем и ждем пока нас понизят до модератора, и тогда можно удалить запись. Но так как чтобы получить токен надо побыть редактором, думаю это уже можно считать фичей.","automated_response":false,"created_at":"2016-10-25T13:00:27.052Z","updated_at":"2016-10-25T13:00:27.052Z","actor":{"username":"povargek","cleared":false,"url":"/povargek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nS7rNaLQVwztSp3zfcDqNCHF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268200,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Отлично!","automated_response":false,"created_at":"2016-10-26T08:03:19.860Z","updated_at":"2016-10-26T08:03:19.860Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"povargek","url":"/povargek"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1284149,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-11-04T10:55:33.330Z","updated_at":"2016-11-04T10:55:33.330Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"povargek","url":"/povargek"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1285252,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Покажем миру?","automated_response":false,"created_at":"2016-11-04T21:33:49.166Z","updated_at":"2016-11-04T21:33:49.166Z","first_to_agree":true,"actor":{"username":"povargek","cleared":false,"url":"/povargek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nS7rNaLQVwztSp3zfcDqNCHF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340311,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-12-04T21:33:52.612Z","updated_at":"2016-12-04T21:33:52.612Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}