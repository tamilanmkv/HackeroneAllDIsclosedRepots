{"id":148517,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg1MTc=","url":"https://hackerone.com/reports/148517","title":"Possible CSRF during joining report as participant ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-30T18:31:38.561Z","submitted_at":"2016-06-30T18:31:38.561Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ehsahil","url":"/ehsahil","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-12T00:55:05.163Z","bug_reporter_agreed_on_going_public_at":"2016-07-12T00:55:05.055Z","team_member_agreed_on_going_public_at":"2016-07-12T00:50:12.737Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, \n\nI think i found a possible csrf issue with joining report as participant endpoint, Actually one of the bug got duplicated and the company added me into the original bug as a participant. then, I got invitation from hackerone to joing the report. \n\nAfter opening the invitation link, there was two options and i click on **accept** and intercepted the request using **Brup Suit**. \n\n**Request:**\n\n```\nPOST /invitations/8384c8086579f27de853ac43f5a16508/accept HTTP/1.1\nHost: hackerone.com\nConnection: close\nContent-Length: 246\nCache-Control: max-age=0\nOrigin: https://hackerone.com\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: https://hackerone.com/invitations/8384c8086579f27de853ac43f5a16508\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en-US,en;q=0.8,nl;q=0.6,pt;q=0.4,ru;q=0.2,ar;q=0.2\nCookie: __cfduid=d11785aca5486bba2f496b5a95dfcd7b91467310209; _gat=1; _ga=GA1.2.1403918044.1467310439; session=M3JIWXZtVVBURmtsUHlNWEJmUFNuREhCQ1FRMG43cUNiU2E4V3NOTFdzVUF4cW0xQlAxUlQrNDRRb0VUbjZuNnF2OHRWMFVWa0txVmwySGNMLzBralZPTzBRY3IxY0sybDArbXpDVXZOZEtCTWhvcWlyZjhJWU13K3VYSW5mbURGcXpFWXRrZHlJN0ZVbUMzMFM1QS9OYnh1VkFMZXg1WFdVWEhEWE1QclkxZG5acWRYMXp1SExVQ2pMTUpYdXgwejQvWitkOW9jMW9pelBxZ3plUEEwYmp5NGwwZ0RGUFlDZXo1ODZ5UU9OKzdIL0VVNVZZRE5kUHN4c1krYWM3K2VvZmNkRzAyNzdxa3ZkS05UZ0k2Mi8xZGp5THdHSkFPdWFKbTA0ZHdiME9LN1E5VUovK0lPYzBpVW5MS3FwRFpTZGQzeFZybEQrU2VIVUhmSEd6Uy9Db0xYSFY2YTh1ck1XWXovYXZKc3J2RS9Rc0RBLzRVdGJZUXN0MUUrSHR1aUJkUVJmSE44Tkl0RHdRbGZZRTlCTVlvZDhWMGhxS1NVbUVYS1FMZGdkd2Q4cTBNZlFjVHVSWjdOZW04c0Eyb2tzVGJsMGRhcm82NDVKVm9FZWF6UFFCS0lGNGxsTDNPL0tpbE4yL1pETTN4eVdqeHBac0dvem9STXF5TFhIcEIzcFB4cXZ1TGkzNkt5R3dWUjE0TFlyTHlDRkpjSG5HZGZKM3VCSmkxNjEzWkdWNCsyalJqWXBFUENjYjNLNm12LS1jeWJVOXBYRVgvRmNiWGNNNXI4Q25RPT0%3D--42d7ae5303507856efd269530433939e6b6e9422\n\nauthenticity_token=cBxHPkMuHJVVZPUuPuh%2FJW6kbIPlUaWgvc5VYtd5%2FsEqLxd0pQTZj52MtIbSHVlIMEVhfwkYC4FEoTBitGzUdQ%3D%3D\u0026utf8=%E2%9C%93\u0026authenticity_token=cBxHPkMuHJVVZPUuPuh%2FJW6kbIPlUaWgvc5VYtd5%2FsEqLxd0pQTZj52MtIbSHVlIMEVhfwkYC4FEoTBitGzUdQ%3D%3D```\n```\n\n\nSee, There are two authenticity_token in the POST request. When i deleted the first **Authenticity_token** from the Request and forwarded it, then i was able to join the report without the first authenticity token. \n\nI think application is not validating the presence of the first **authenticity_token** during adding users to the particular report. \n\nAccording to me, There is no way to exploit it because there authenticity token is getting properly validated. \n\nbut.. \n\nI was thinking, you might want to hear about it. Please let me know what you think. \n\nThanks \n@gone","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-11T00:50:12.827Z","allow_singular_disclosure_after":-163083209.98205224,"singular_disclosure_allowed":true,"vote_count":16,"voters":["wkcaj","robd4k","eveeez","kieran","ehsahil","daniyal_nasir","linkks","japz","ethicalhacker","egyptghost1","and 6 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1048317,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @gone,\n\nI've verified that there are no security implications to this (the duplicate `authenticity_token` params will always be identical, and are being validated properly) so it won't be eligible for a bounty, but I'm triaging the report while we attempt to write a fix since the duplicate tokens look a bit ridiculous. I'll provide an update when available. Thanks for letting us know!","automated_response":false,"created_at":"2016-06-30T22:06:55.793Z","updated_at":"2016-06-30T22:06:55.793Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome !\n\n@gone ","automated_response":false,"created_at":"2016-07-01T14:31:54.288Z","updated_at":"2016-07-01T14:31:54.288Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can i get update on this issue?\n\nthanks \n@gone ","automated_response":false,"created_at":"2016-07-05T14:10:38.208Z","updated_at":"2016-07-05T14:10:38.208Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1059667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \n\nCan i get update on this issue ? \n\nThanks \n@gone","automated_response":false,"created_at":"2016-07-08T15:07:30.412Z","updated_at":"2016-07-08T15:07:30.412Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @gone,\n\nI have been quite busy with some other work, but I finally had a chance to put a fix up for review late today. So you can expect this to be resolved some time in the next week. We'll provide you with an update when that happens.","automated_response":false,"created_at":"2016-07-09T01:24:54.800Z","updated_at":"2016-07-09T01:24:54.800Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064074,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @gone,\n\nThe fix has been released. Can you confirm that it addresses the issue?","automated_response":false,"created_at":"2016-07-11T22:59:53.048Z","updated_at":"2016-07-11T22:59:53.048Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ehsahil","url":"/ehsahil"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064075,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As mentioned previously, there are no security implications to this issue (the duplicate authenticity_token params were always identical, and also being validated properly) so it isn't eligible for a bounty.","automated_response":false,"created_at":"2016-07-11T23:01:35.216Z","updated_at":"2016-07-11T23:01:35.216Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \n\nThe issue has been fixed. \n\nAt least Award me some H1 swags for this issue. \n\nThanks\n@gone","automated_response":false,"created_at":"2016-07-12T00:30:03.044Z","updated_at":"2016-07-12T00:30:03.044Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064221,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-07-12T00:49:01.324Z","updated_at":"2016-07-12T00:49:01.324Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064224,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"@gone You got it! Thanks again!","automated_response":false,"created_at":"2016-07-12T00:49:26.289Z","updated_at":"2016-07-12T00:49:26.289Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"reporter":{"username":"ehsahil","url":"/ehsahil"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064225,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-07-12T00:49:45.450Z","updated_at":"2016-07-12T00:49:45.450Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ehsahil","url":"/ehsahil"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064226,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-12T00:50:12.770Z","updated_at":"2016-07-12T00:50:12.770Z","first_to_agree":true,"actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewone Thanks :)","automated_response":false,"created_at":"2016-07-12T00:51:03.550Z","updated_at":"2016-07-12T00:56:23.856Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure :)","automated_response":false,"created_at":"2016-07-12T00:55:05.098Z","updated_at":"2016-07-12T00:55:05.098Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064238,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-12T00:55:05.195Z","updated_at":"2016-07-12T00:55:05.195Z","actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1130846,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2016-08-17T00:43:06.149Z","updated_at":"2016-08-17T00:43:06.149Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}