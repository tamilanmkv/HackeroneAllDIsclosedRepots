{"id":148609,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg2MDk=","url":"https://hackerone.com/reports/148609","title":"Register multiple users using one invitation (race condition)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T06:08:23.751Z","submitted_at":"2016-07-01T06:08:23.751Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"franjkovic","url":"/franjkovic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-11T19:46:48.257Z","bug_reporter_agreed_on_going_public_at":"2016-07-11T19:46:48.110Z","team_member_agreed_on_going_public_at":"2016-07-06T12:52:30.948Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nIt is possible to create multiple accounts using a single invitation_id due to a race condition bug in `/_/api/1.0/signup.json`. \nI have successfully created 8 accounts using invitation with id = 37c5a121adf23e90b875500d\nThe account usernames: novijosiptest[1,2,4,5,6,8,9,10] (you can delete them, I will not use them).\n\nSteps:\n1. Generate an invitation and get the link, click on the blue \"I accept - join Keybase!\" button\n2. Input your data - email, username and passwords\n3. When you click Join, a POST request is made to `/_/api/1.0/signup.json`. Quickly repeat this POST request while changing the `email` and `username` to desired values\n4. Hopefully more than one account will be registered\n\nIt is also worth checking if there is a race condition when registering and cancelling an invite at the same time. I will test this out in a couple days.\n\nBest regards,\n\nJosip FranjkoviÄ‡","bounty_amount":"350.0","formatted_bounty":"$350","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-05T12:52:31.570Z","allow_singular_disclosure_after":-163558272.84911978,"singular_disclosure_allowed":true,"vote_count":17,"voters":["wkcaj","ras-it","spam404","lucky_sen","xsam","dudez","supernatural","peeper35","franjkovic","fantam1","and 7 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1050360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\ntried registering and canceling at the same time, was unsuccessful. I screwed up the script a bit, but couldn't trigger race condition after fixing it. Still worth checking in the source code, as I might have been unlucky. \n\nBest regards,\n\nJosip","automated_response":false,"created_at":"2016-07-02T10:15:47.951Z","updated_at":"2016-07-02T10:16:02.753Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @franjkovic - I believe we previously closed an issue with race condition on sending multiple invites, so I doubt there is an issue there.\n\nre: your multiple signup with the same invitation code...can you confirm this race loophole is closed now?  You can keep those extra accounts for testing purposes btw.\n\nthanks!\n","automated_response":false,"created_at":"2016-07-05T14:22:29.219Z","updated_at":"2016-07-05T14:22:29.219Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1053694,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(oh, I see, that was you who had posted the invitation send race condition 5 months ago..)\n\nanyway, thanks for this one - any chance you can you confirm it is fixed now?\n\n","automated_response":false,"created_at":"2016-07-05T14:23:42.333Z","updated_at":"2016-07-05T14:23:42.333Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1053699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nconfirming this is fixed, tested two times, both failed. \n\nBest regards,\n\nJosip","automated_response":false,"created_at":"2016-07-05T14:30:05.535Z","updated_at":"2016-07-05T14:30:05.535Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053705,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks!","automated_response":false,"created_at":"2016-07-05T14:34:30.931Z","updated_at":"2016-07-05T14:34:30.931Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Keybase"}},"bounty_amount":"350.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"franjkovic","url":"/franjkovic"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1055276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nCan we close this? I will be requesting public disclosure in a couple weeks, am making a blog post about race conditions and I plan on including both Keybase bugs. \n\nWhat I meant with \"It is also worth checking if there is a race condition when registering and cancelling an invite at the same time\" is:\nsay there are `regsiter` and `cancelInvite` functions.\nregister checks if invite is valid, registers user, sets invite to used\ncancelInvite checks if invite is valid, deletes the invite, does a +1 to user invite count\nThere is a small time window where you can both register and cancel an invite, but chance of this working on Keybase is pretty much impossible :-).\n\nAnyways, thanks for the fast fix and bounty.\n\nBest regards,\n\nJosip","automated_response":false,"created_at":"2016-07-06T09:46:53.341Z","updated_at":"2016-07-06T09:55:27.760Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1055537,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-07-06T12:52:00.395Z","updated_at":"2016-07-06T12:52:00.395Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"franjkovic","url":"/franjkovic"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1055539,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-06T12:52:31.127Z","updated_at":"2016-07-06T12:52:31.127Z","first_to_agree":true,"actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1063726,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Blog posted here: https://www.josipfranjkovic.com/blog/race-conditions-on-web","automated_response":false,"created_at":"2016-07-11T19:46:48.140Z","updated_at":"2016-07-11T19:46:48.140Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1063727,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-11T19:46:48.281Z","updated_at":"2016-07-11T19:46:48.281Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}