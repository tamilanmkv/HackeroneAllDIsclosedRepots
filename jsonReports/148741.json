{"id":148741,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg3NDE=","url":"https://hackerone.com/reports/148741","title":"Stored Cross-Site-Scripting in CMS Airship's  authors profiles","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T18:39:17.554Z","submitted_at":"2016-07-01T18:39:17.554Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lukasreschke","url":"/lukasreschke","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-01T18:59:30.269Z","bug_reporter_agreed_on_going_public_at":"2016-07-01T18:59:30.205Z","team_member_agreed_on_going_public_at":"2016-07-01T18:55:47.638Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I'm just checking out CMS Airship and some of the security features look pretty nice. Awesome job on that!\n\nAfter clicking around a bit I stumbled however upon a stored XSS vulnerability in the Bridge.  As per `/bridge/help` I use 1.1.0 version (installed via Docker), as I couldn't find any reference with regard to this in the 1.1.1 changelog from https://github.com/paragonie/airship/commit/29dc60a1b0178222c3c984915f2eda6322ca3453 I believe that it probably is affected as well.\n\nTo reproduce this:\n\n1. Install CMS Airship\n2. Make sure to use the default settings (or at least do not uncheck \"Enable registration\")\n3. Take another browser tab and go to http://localhost:8081/bridge/board to register a new account\n4. Login with that account at http://localhost:8081/bridge/login\n5. Go to http://localhost:8080/bridge/author/new\n6. Create a new author with the name \"\u003cscript\u003ealert(1)\u003c/script\u003e\"\n7. Send the author edit link to another user, such as the captain user (e.g. http://localhost:8080/bridge/author/edit/3)\n8. Open it as captain\n\nThen you see the XSS executed, or well, if your browser supports CSP a decent CSP warning in your browser console :-)\n\n{F102848}\n\nThe HTML in question is:\n\n```\n    \u003cdiv id=\"bridge_main\"\u003e    \u003ch2\u003eEdit Author \"\u003cscript\u003ealert(1)\u003c/script\u003e\" Details\u003c/h2\u003e\n\u003cform method=\"post\"\u003e\u003cinput type=\"hidden\" name=\"_CSRF_TOKEN\" value=\"ijYiRqBM1DKBw9Kevvn4zjEw:frKdBMZxXK3VUgI0ZEuQHdHerw9NnVwTx8a62QiJhiY3\" /\u003e\n    \u003cdiv class=\"table full-width table-pad-1\"\u003e\n        \u003cdiv class=\"table-row\"\u003e\n            \u003cdiv class=\"table-cell table-label\"\u003e\n                \u003clabel for=\"author_name\"\u003eAuthor Name:\u003c/label\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"table-cell\"\u003e\n                \u003cinput class=\"full-width\" id=\"author_name\" name=\"name\" placeholder=\"e.g.\u0026#x20;Information\u0026#x20;Technology\u0026#x20;Department\" value=\"\u0026lt;script\u0026gt;alert\u0026#x28;1\u0026#x29;\u0026lt;\u0026#x2F;script\u0026gt;\" type=\"text\" /\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n```\n\nSince I don't have libsodium and PECL installed locally on my dev machine I couldn't include a tested patch for this. Sorry :-)","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102848,"file_name":"2016-07-01_20-37-23.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/848/4bd8a3edb1386791985f901f3e111b0b2fa35792/2016-07-01_20-37-23.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-01_20-37-23.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-01_20-37-23.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134345Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=243004eb862f3a03fbcc58967f000be8d5741a6b6b6959616117f62e7470ae76","file_size":380220,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-31T18:55:47.718Z","allow_singular_disclosure_after":-163968477.78233683,"singular_disclosure_allowed":true,"vote_count":23,"voters":["lukasreschke","jobert","michiel","akkilion","supernatural","ibram","paresh_parmar","jens","avicoder_","sumit7","and 13 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1049748,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Wow, nevermind. Not only did I find the problem, I found out *why*: `sprintf()` wasn't applying Twig's auto-escape rules.\n\nhttps://github.com/paragonie/airship/commit/6718a8ca27a78643f274c24bb1fc126facb3db10\n\nThis should fix it.\n","automated_response":false,"created_at":"2016-07-01T18:55:28.762Z","updated_at":"2016-07-01T18:55:28.762Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Paragon Initiative Enterprises"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"paragonie","collaborator":{"username":"lukasreschke","url":"/lukasreschke"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049750,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-07-01T18:55:41.284Z","updated_at":"2016-07-01T18:55:41.284Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lukasreschke","url":"/lukasreschke"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049751,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-01T18:55:47.669Z","updated_at":"2016-07-01T18:55:47.669Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049767,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-01T18:59:30.228Z","updated_at":"2016-07-01T18:59:30.228Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049768,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-01T18:59:30.296Z","updated_at":"2016-07-01T18:59:30.296Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049777,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let's get the bounty donated somewhere :-)\n\nI did file a support request to HackerOne to get this bounty donated to Doctors without Borders.","automated_response":false,"created_at":"2016-07-01T19:02:52.304Z","updated_at":"2016-07-01T19:02:52.304Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for reporting this.\n\nLesson learned:\n\n1. If you rely on autoescaping, make *sure* it's being applied everywhere. Where it's not applied, escape manually.\n2. Be more skeptical of patterns intended to promote i18n.\n3. Turn off `Content-Security-Policy` headers when testing locally so it's easier to catch these failures..","automated_response":false,"created_at":"2016-07-01T19:44:42.319Z","updated_at":"2016-07-01T19:44:42.319Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2155,"category":"team","content":"For an in-depth analysis, check out the **[post-mortem posted on CSPR.NG](https://cspr.ng/blog/2016/07/cms-airship-1-1-2-stored-xss-post-mortem)**.\n\nLessons learned:\n\n1. If you rely on auto-escaping, make *sure* it's being applied everywhere. Where it's not applied, escape manually.\n2. Be more skeptical of patterns intended to promote i18n.\n3. Turn off `Content-Security-Policy` headers when testing locally so it's easier to catch these failures.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":51441,"username":"paragonie-scott","name":"Scott Arciszewski","bio":"@CiPHPerCoder on Twitter","cleared":false,"website":"https://paragonie.com/blog/author/scott-arciszewski","location":"Orlando, FL","created_at":"2016-01-17T06:06:42.628Z","url":"https://hackerone.com/paragonie-scott","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcndjIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--48e805bcd9d1c48bfef880bf59cee9b034b26f2f/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/Helper410.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}