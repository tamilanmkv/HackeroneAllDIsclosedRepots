{"id":151831,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTE4MzE=","url":"https://hackerone.com/reports/151831","title":"User Supplied links on profile page is not validated and redirected via gratipay.","state":"Closed","substate":"duplicate","severity_rating":"none","readable_substate":"Duplicate","created_at":"2016-07-16T22:35:05.883Z","submitted_at":"2016-07-16T22:35:05.883Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"roshanpty","url":"/roshanpty","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-24T09:01:14.578Z","bug_reporter_agreed_on_going_public_at":"2016-07-24T01:31:30.677Z","team_member_agreed_on_going_public_at":"2016-07-24T09:01:14.505Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"User Supplied links on profile page is not validated and redirected via gratipay.\n====================\n\nDescription\n---------------------\nThe user profiles on gratipay has a profile statement section which is supported by markdown. An adversary can update the profile section with a hyper link URL to a malicious website. As gratipay doesn't redirect the request via a 302 redirect response if the adversary register a similar phishing website the user won't be aware that he/she is going out of the trusted site (gratipay)\n\nDetailed Steps\n---------------------\n**Step 1:** Update the profile statement with a URL hyperlink.\n**Step 2:** Click on the hyperlinked URL on the updated profile. It can be observed that the server issues no warning that the user is being redirected out of gratipay.\n\nSolution\n---------------------\n* All user supplied URL's in the website must be redirected via the server only. \n* On implementing URL redirection, care should be taken that it is not vulnerable to Open Redirection [OWASP Open Redirection](https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet)\n* A warning should be issued when a user is clicking on a website outside the host website. For example in the below line I am hyperlinking SecVibe website to the text of URL of hackerone.com. It can be observed that on clicking the same, hackerone verifies if the same is in fact a site outside hackerone and issues a warning.\n[http://hackerone.com](https://secvibe.com)\n{F105371}\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":109161,"original_report_url":"https://hackerone.com/reports/109161","attachments":[{"id":105371,"file_name":"2016-07-16_15_32_55-Leaving_HackerOne..._-_HackerOne.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/105/371/11077450ac85a88ba7971768a023dc9758d7bdf2/2016-07-16_15_32_55-Leaving_HackerOne..._-_HackerOne.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-16_15_32_55-Leaving_HackerOne..._-_HackerOne.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-16_15_32_55-Leaving_HackerOne..._-_HackerOne.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134457Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bfedcb0928bfa8acb643454e58062deada4406475be996e8b64e8d9638b19d65","file_size":51890,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["dyabla","michielprins3","michielprins4","michielprins9","michielprins5","michielprins6","michielprins8","michielprins2","michielprins7","michielprins10","and 2 more..."],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1072327,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi roshanpty ,\n\nThanks for your report. However, the exploitation scenario (URLs in the statement linking to phishing pages) is very similar to one issue that has already been reported by another researcher. I have added you to the original report. Let us know if you think the other one is different. \n\nThanks for making Gratipay a safer place!","automated_response":false,"created_at":"2016-07-16T23:29:42.976Z","updated_at":"2016-07-16T23:29:42.976Z","original_report_id":109161,"actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1072339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nashe_ That report identifies a different issue. The fix mentioned by @atom would only avoid the cross domain referer leakage. \nie, It would deny the visiting website any idea about where the request originated. My point is that it is unsafe to give direct links to external websites especially when it is a user supplied data. The request should be redirected via gratipay server only using a 302 redirection. Similar implementation is used by hackerone. \n\nCheck the source of the following link and you can see how hackerone has made it possible. ALso if you click the below link, hackerone would warn you that you are moving out of hackerone website.\n\n[This is an external link to my blog](https://secvibe.com)","automated_response":false,"created_at":"2016-07-17T00:03:16.844Z","updated_at":"2016-07-17T00:03:16.844Z","actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1072624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To my mind, the impact of the two reports is the same. In the report #109161, since no \"token\" or secret data can be leaked through the Referer, the only think that the Referer can help to achieve would be to display a customized phishing page. The remediation is to use `noreferer` or a gateway page to avoid this leakage.\n\nIn your report, you explain that: *\"if the adversary register a similar phishing website the user won't be aware that he/she is going out of the trusted site\"*, which has basically the same impact: leading the user to go on a phishing page. However, *\"Findings derived primarily from social engineering (e.g. phishing, vishing)\"* are not part of our scope, and there are thousands of ways to make an user click on something linking to a phishing page (a tweet on a account linked to a profile on Gratipayâ€¦)\n\nIf you prefer, I can close this issue as \"Informative\" rather than \"Duplicate\".","automated_response":false,"created_at":"2016-07-17T11:32:20.802Z","updated_at":"2016-07-17T11:32:20.802Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1083983,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-24T01:31:30.723Z","updated_at":"2016-07-24T01:31:30.723Z","first_to_agree":true,"actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084254,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-24T09:01:14.538Z","updated_at":"2016-07-24T09:01:14.538Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084255,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-24T09:01:14.607Z","updated_at":"2016-07-24T09:01:14.607Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340067,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-04T18:33:13.221Z","updated_at":"2016-12-04T18:33:13.221Z","additional_data":{"old_severity":null,"new_severity":"None","old_severity_id":null,"new_severity_id":11530},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}