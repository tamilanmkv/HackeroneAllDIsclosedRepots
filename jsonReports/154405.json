{"id":154405,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTQ0MDU=","url":"https://hackerone.com/reports/154405","title":"Read access to hidden orders,products,customers etc. by limited access Staff member through reference page in Comments (Information disclosure )","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-27T17:41:29.157Z","submitted_at":"2016-07-27T17:41:29.157Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-12-06T15:04:05.384Z","bug_reporter_agreed_on_going_public_at":"2017-07-18T20:44:09.632Z","team_member_agreed_on_going_public_at":"2018-12-06T15:04:05.268Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team ,\n\nNote : I have reported multiple issues related to information which were closed a N/A due to some information lack. But this issue will look similar by title but it's different then other issues. Before testing anything i have insured that all other permissions are limited for the account so by any way he should not be able to get these information. \nDescription : Any staff member with limited access can view the details of it's limited area. \nEx: If staff member have limited access to orders , He can still view orders. If he has limited access to customers , he can still view customers details like name, email etc. \nThis can be possible by comment section in products ,orders etc. In comment section you will see the # sign by which you can refer any page. Now you won't have access to the pages where your access is limited. Suppose you have access to products but no access to orders. When you will see # sign you can only find pages of products but you won't find the order related pages.\nNow while commenting you need to add the ID of that order and you will be able to see details of that order in the comment . \n\n\nSteps to reproduce : \nLet's say a staff member has limited access to products and orders but he has access to products.\n*Access details : No access to order, order_creation, customers , reports ,discount etc. \n\n1. Now open any transfer from product menu and and you will see the comment section where you will see the # sign by which you can refer any page of orders,products,customers etc. \n2. When you will click on this # you will notice that it will only show the products related reference pages. But it won't show the orders and customers pages because of your access issue. It means you don't access to it and you can't refer these pages.\n3. Now put any product page and add some comment to it and save it. Intercept this request and change the product ID to order ID and the order details will be posted.Instead of order ID if you put customer ID , you will get the customers name and it's email address. \n\nSo this is how any user who has limited access to any feature can access it by this method. \n\nPOC : \n\nsuppose a staff member have limited access to orders , draft_order and customers then he should not be able to access these information. \n\nHTTP request  Modified : \n\nPOST /admin/transfers/774529/timeline_comments HTTP/1.1\nHost: vijaygangani1110store.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-CSRF-Token: RZIoZCcT7SGMNDwD6wl0gHzb1ACcOm1uSXy/NbItuXwQr/95Jzg+24HCWIM4Wzc0Z/F76VYd4iuPF1jj7X0zrQ==\nX-Requested-With: XMLHttpRequest\nReferer: https://vijaygangani1110store.myshopify.com/admin/transfers/774529\nContent-Length: 187\nContent-Type: multipart/form-data; boundary=---------------------------191772538514734\nCookie:[cookie_values]\nConnection: keep-alive\n\n-----------------------------191772538514734\nContent-Disposition: form-data; name=\"timeline_comment[body]\"\n\n[#O3599995137|Order #1005]\n-----------------------------191772538514734--\n\n\nI changed product ID to order ID here. In the timeline_body you have to add order ID to get the order details. If you want to retrieve the customers details you need to add the customer ID in the following format  : [#C3502872769| anyword] \n\nHere you will be able to get the email address ,name and profile photo of the customer. \n\n\nImpact : \nIf any shopify owner wants to hire a expert in such a way that he should not be accessing customer details, orders ,order_creation and related items then staff member should not access these things from any where. But by this way the staff member can get access to all these information. \n\nLet me know of you need any other help from my side to reproduce this issue. I can provide VIdeo POC if needed. \n\n\nBest Regards !\nVijay Kumar \n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["sp1d3rs","drsniper","sameerphad72","s_p_q_r","ali","geeknik","mobius07","ak1t4","t4ym","cyberunit","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1091233,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2016-07-27T17:41:29.485Z","updated_at":"2016-07-27T17:41:29.485Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1095479,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2016-07-29T16:07:04.508Z","updated_at":"2016-07-29T16:07:04.508Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1141829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@clayton  : Can i get any ETA to Resolve this issue ?","automated_response":false,"created_at":"2016-08-20T02:41:56.275Z","updated_at":"2016-08-20T02:41:56.275Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1143188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Unfortunately we can't provide ETAs. Thank you for your patience.","automated_response":false,"created_at":"2016-08-21T14:05:51.048Z","updated_at":"2016-08-21T14:05:51.048Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1242628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@clayton : It's been 3 months i have reported the issue but still no resolution for this one. I request you to Update me the status of the issue and let me know if you need any help from my side. \n\nBest Regards !\nVijay Kumar ","automated_response":false,"created_at":"2016-10-11T18:20:20.104Z","updated_at":"2016-10-11T18:20:20.104Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1242691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are still investigating this, and will contact you when we have an update. Thank you for your patience.","automated_response":false,"created_at":"2016-10-11T18:55:10.875Z","updated_at":"2016-10-11T18:55:10.875Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1456707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@clayton : Hope you are good ! It's been 6 months i have reported this issue and asked for update 2 times . Both the times i got response saying that we are still investigating this issue and we'll update you when you will have more information about it. I have reported many issues earlier and i got response and resolution very fast but this report has been pending for past 6 months . I would request you to look at this issue and resolve it ASAP or provide me any update regarding this. \n\nLet me know if you need any other help from my side .\n\nBest Regards !\nVijay Kumar ","automated_response":false,"created_at":"2017-02-01T18:00:12.052Z","updated_at":"2017-02-01T18:00:12.052Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1489090,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"It's been 6 months to this issue. Still the issue is not resolved and bounty hasn't been awarded. Not getting any response of my comment. \nKindly Resolve the issue ASAP and let me know if you need any help from my side. \n\nBest Regards !\nVijay Kumar ","automated_response":false,"created_at":"2017-02-16T12:54:43.440Z","updated_at":"2017-02-16T12:54:43.440Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1489242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vijay_kumar1110 We still plan to resolve this issue, however we cannot guarantee a timeline. Issues are resolved based on priority, and there are other more urgent issues that need to be resolved first.\n\nOur policy is to award a bounty only after an issue is resolved, so unfortunately you'll have to wait a while longer until this is fixed. Thank you for your patience.","automated_response":false,"created_at":"2017-02-16T14:18:03.930Z","updated_at":"2017-02-16T14:18:03.930Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1756229,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report! This issue is resolved.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2017-06-14T20:12:52.341Z","updated_at":"2017-06-14T20:12:52.341Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1766345,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","automated_response":false,"created_at":"2017-06-19T19:27:40.564Z","updated_at":"2017-06-19T19:27:40.564Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847975,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this please !!","automated_response":false,"created_at":"2017-07-18T20:44:09.652Z","updated_at":"2017-07-18T20:44:09.652Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3775704,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-12-06T15:04:05.301Z","updated_at":"2018-12-06T15:04:05.301Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3775705,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-12-06T15:04:05.411Z","updated_at":"2018-12-06T15:04:05.411Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4481,"category":"team","content":"This report demonstrated that an admin user without having corresponding resource permissions can reveal summary of resources by adding a reference to  the resources (products, orders, inventory etc) in timeline comments. This can be achieved by posting a comment [#O3103227907|foobar] which reveals summary of the order in the comment.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":89976,"username":"lalith-shopify","name":"Lalith Rallabhandi","bio":"","cleared":false,"website":null,"location":"","created_at":"2016-07-04T17:52:35.589Z","url":"https://hackerone.com/lalith-shopify","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}