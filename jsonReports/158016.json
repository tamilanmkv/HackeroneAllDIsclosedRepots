{"id":158016,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTgwMTY=","url":"https://hackerone.com/reports/158016","title":"Server side request forgery on image upload for lists","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-09T23:44:41.943Z","submitted_at":"2016-08-09T23:44:41.943Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-12T21:11:01.088Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-09-12T21:10:57.759Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary\n----------\n\nThere is a Server-side request forgery when updating the image for a list.\n\nSteps to reproduce\n-----------------\n\n1. Create a list and change its image. That will send a POST request to https://beta.instacart.com/api/v2/lists/[LIST_ID] with the following parameters:\n\n    ```\nlist[remote_image_url]=https://example.com/yourimage.jpg\n```\n\n2. Change the  url to http://127.0.0.1:21 and you will get as response:\n\n    ```{json}\n{\n\t\"meta\":\n\t{\n\t\t\"code\": 400,\n\t\t\"error_type\": \"List Error\",\n\t\t\"error_message\": \"There was an error while updating this list\",\n\t\t\"errors\": [\"Image could not download file: wrong status line: \\\"SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2.3\\\"\"]\n\t}\n}\n```\n    Which shows that it tried to connect to the SSH port on localhost.  \n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-10-12T21:10:57.843Z","allow_singular_disclosure_after":-157653352.52809644,"singular_disclosure_allowed":true,"vote_count":19,"voters":["peace_life","hunter","gamliel","supernatural","zuh4n","ak1t4","kiraak-boy","exception","fantam1","japz","and 9 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1127776,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks! We'll look into this and get back to you when we have an update.","automated_response":false,"created_at":"2016-08-15T20:04:46.363Z","updated_at":"2016-08-15T20:04:46.363Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1146256,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the report,\n\nThis should now be fixed.","automated_response":false,"created_at":"2016-08-22T22:52:01.125Z","updated_at":"2016-08-22T22:52:01.125Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1146257,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-08-22T22:52:18.550Z","updated_at":"2016-08-22T22:52:18.550Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Instacart"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1156506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty. \n\nYou  might also want to limit access to 169.254.169.254 which is the multicast address used by EC2 to distribute instance metadata and could potentially contain sensitive information. Since I don't see any way to extract information using this SSRF at this point, it is obviously a minor issue as well, but doesn't hurt to be on the safe side I guess.","automated_response":false,"created_at":"2016-08-26T18:56:20.562Z","updated_at":"2016-08-26T18:56:20.562Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189633,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-09-12T21:10:57.808Z","updated_at":"2016-09-12T21:10:57.808Z","first_to_agree":true,"actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244846,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-12T21:11:01.103Z","updated_at":"2016-10-12T21:11:01.103Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}