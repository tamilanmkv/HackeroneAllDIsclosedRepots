{"id":159391,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkzOTE=","url":"https://hackerone.com/reports/159391","title":"Record payment for any invoice by PM (Access control Issue)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-15T01:53:11.383Z","submitted_at":"2016-08-15T01:53:11.383Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:02:34.680Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:02:34.393Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Project Manager(Full access ) With Access to limited projects also have limited access to Invoices. So Project manager is assigned to limited project by Admin and he have access to limited Invoices related to assigned project. But Project manager can Actually Record payment of any invoice in the company.The HTTP request of Recording payment is Vulnerable to Privilege Escalation where server doesn't check whether Project manager have access to corresponding Invoice or not.\n\nVulnerable HTTP request : \n\nPOST /invoices/[Invoice_ID]/payments HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani.harvestapp.com/invoices/10392603\nCookie: [Cookie_values]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 228\n\nutf8=%E2%9C%93\u0026authenticity_token= [Oauth_token]\u0026payment%5Bpaid_at_human_format%5D=08%2F15%2F2016\u0026payment%5Bamount%5D=0.00\u0026payment%5Bnotes%5D= \n\nSteps to reproduce : \n1.Create a Invoice by project manager account and record the payment for that Invoice.\n2.The HTTP request of recording payment would look something like the above mentioned request.\n3.Change the Invoice ID in the Request to any other Invoice ID which the project manager doesn't have access to and send the request tot the server.\n4.You will see that the Payment will be recorded for your mentioned Invoice ID.\n\n\nLet me know if you need any further assistance or Video POC to understand the issue.\n\nBest Regards !\nVijay Kumar ","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:02:34.626Z","allow_singular_disclosure_after":-158769881.62699658,"singular_disclosure_allowed":true,"vote_count":10,"voters":["thisishrsh","dmatrix","vijay_kumar","dilawer01","jens","kaito","jbbbkj","sumit7","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1147181,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Vijay,\n\nThis issue should be fixed now. Could you check if you are able to reproduce it?\n\nThanks,\nJorge","automated_response":false,"created_at":"2016-08-23T10:01:05.457Z","updated_at":"2016-08-23T10:01:05.457Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162668,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","automated_response":false,"created_at":"2016-08-30T16:49:48.619Z","updated_at":"2016-08-30T16:49:48.619Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163620,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-30T23:02:34.441Z","updated_at":"2016-08-30T23:02:34.441Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223848,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-09-29T15:52:49.330Z","updated_at":"2016-09-29T15:52:49.330Z","additional_data":{"old_title":"Record payment for any invoice by limited access project Manager(Access control Issue)","new_title":"Record payment for any invoice by PM (Access control Issue)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224813,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-29T23:02:34.729Z","updated_at":"2016-09-29T23:02:34.729Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}