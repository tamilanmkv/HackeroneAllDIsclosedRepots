{"id":163067,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjMwNjc=","url":"https://hackerone.com/reports/163067","title":"Stealing users password (Limited Scenario)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-24T13:53:40.337Z","submitted_at":"2016-08-24T13:53:40.337Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-29T20:13:31.430Z","bug_reporter_agreed_on_going_public_at":"2016-09-22T20:27:16.903Z","team_member_agreed_on_going_public_at":"2016-09-29T20:13:31.301Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Hello Team,__\n\n####Description :\n\u003e This is report is about an interesting scenario where an user's password can be steal while password reset process due to wired user controlled redirection take place after password reset process.\n\nBy accepting the fact that URL redirect is not in scope for uber but this one is interesting on reset page that something need to look.\n\n\n####Step To Reproduce : \n+ Go [Here](https://login.uber.com/forgot-password?source=auth\u0026next_url=data:text/html;base64,PGlmcmFtZSBzcmM9aHR0cDovL2dvby5nbC92TkE3RHYgaGVpZ2h0PTEwMCUgd2lkdGg9MTAwJSBmcmFtZWJvcmRlcj0wPjwvaWZyYW1lPg==)\n+ Where __`next_url`__ is user controlled on password reset page __`https://login.uber.com/forgot-password?source=auth\u0026next_url=user_controlled_url`__ . \n+ Request password reset token for your account !\n+ Get the reset link and change the password and will be redirected to supplied `next_url` url.\n+ Where an well crafted form will ask to confirm your password !\n+ And this is how someone can steal the password of someone !\n\n####Impact :\n\u003ethough impact is not very direct here , but still critical enough if any attacker succeeded to exploit this \u0026 that will allow him to access victim account , so this should be fixed !  \n\n####Video POC (Tested in Mozilla) : https://dl.dropboxusercontent.com/u/62765113/ShareX/16/2016-08-24_19-18-20.mp4\n\n####Possible Fix :\n+ `next_url` should not be reflect after password reset also should not be user controlled .\n\nPlease let me know if any more info needed !\n\n-------------\n**Regards**\n*Geekboy !*","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":35,"voters":["bogdantcaciuc","sameerphad72","spam404","parth","geekboy","mdv","bugdiscloseguys","0xdeadpool","dreadpiraterobertt","mpz","and 25 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1152162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy,\n\nThanks so much for the report and participation in our bug bounty program! We're looking into this now and will update ASAP as we have more details.\n\nThanks,\nRob","automated_response":false,"created_at":"2016-08-24T17:43:49.542Z","updated_at":"2016-08-24T17:43:49.542Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152934,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-08-24T23:38:36.772Z","updated_at":"2016-08-24T23:38:36.772Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1187866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"do we have any update for this ?","automated_response":false,"created_at":"2016-09-12T04:51:58.205Z","updated_at":"2016-09-12T04:51:58.205Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189072,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @geekboy, thanks for checking in, we're currently working on this internally and will update you as soon as it gets fixed.","automated_response":false,"created_at":"2016-09-12T17:15:27.516Z","updated_at":"2016-09-12T17:15:27.516Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Team, \n\ni can see some fix is implemented here, now that URL giving following error : \n\n`````\n{\"error\":\"Invalid next_url\"}\n`````","automated_response":false,"created_at":"2016-09-22T03:08:44.891Z","updated_at":"2016-09-22T03:09:26.351Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210929,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @geekboy, I believe this issue has been fixed so I am closing this report as `Resolved`. Please take a moment to confirm and let us know if you do not agree. We have meetings every few weeks to discuss `Resolved` reports and we will follow up after the next one to determine if this submission was eligible under our bug bounty program. Thank you!","automated_response":false,"created_at":"2016-09-22T15:32:08.062Z","updated_at":"2016-09-22T15:32:08.062Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1211587,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure np in that, can we do now ? ","automated_response":false,"created_at":"2016-09-22T20:27:16.945Z","updated_at":"2016-09-22T20:27:16.945Z","first_to_agree":true,"actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1216965,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy the team will discuss this in next bounty payout meeting and get back to you.","automated_response":false,"created_at":"2016-09-26T19:25:07.516Z","updated_at":"2016-09-26T19:25:07.516Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1220020,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report, @geekboy! We appreciate the submission, and wish you the best of luck in your future bug hunting. ","automated_response":false,"created_at":"2016-09-27T20:15:52.736Z","updated_at":"2016-09-27T20:15:52.736Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"geekboy","url":"/geekboy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1220052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thing, Thank u for the surprised bounty though :)","automated_response":false,"created_at":"2016-09-27T20:32:54.421Z","updated_at":"2016-09-27T20:33:07.571Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1220844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can we go public now if okay ? and will request for full disclosure if we doing as m going to blog about this interesting n rare issue :) \n\nThanks !","automated_response":false,"created_at":"2016-09-28T10:22:33.553Z","updated_at":"2016-09-28T10:24:19.298Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224437,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-09-29T20:13:31.361Z","updated_at":"2016-09-29T20:13:31.361Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224438,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-29T20:13:31.465Z","updated_at":"2016-09-29T20:13:31.465Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2703,"category":"team","content":"The Forgot Password page accepts a next_url URL parameter when it's loaded.  Due to the fact that this is user-controllable and permits any url, it is possible for an attacker to perform a convincing phishing attack, designed to steal an Uber user's credentials, by getting a victim to reset their password via a custom Forgot Password link.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":95301,"username":"tno","name":"Tony Ngo","bio":"","cleared":false,"website":null,"location":"","created_at":"2016-07-25T22:07:55.163Z","url":"https://hackerone.com/tno","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":2726,"category":"researcher","content":"Hey all :)\n\nhere is blog for the same : http://www.geekboy.ninja/blog/uber-exploiting-stored-url-redirect-in-password-reset-token","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":3547,"username":"geekboy","name":"Geekboy!","bio":"Full time bug bounty hunter :)","cleared":true,"website":"https://www.geekboy.ninja","location":"❤ From India 💪","created_at":"2014-03-11T16:43:45.018Z","url":"https://hackerone.com/geekboy","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}