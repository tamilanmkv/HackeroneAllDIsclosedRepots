{"id":166849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY4NDk=","url":"https://hackerone.com/reports/166849","title":"IDOR(indirect object references) on add friend,complement and send message ","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-09-08T14:14:07.347Z","submitted_at":"2016-09-08T14:14:07.347Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"w3b7ricks73r","url":"/w3b7ricks73r","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":545,"url":"https://hackerone.com/yelp","handle":"yelp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Yelp","twitter_handle":"","website":"https://www.yelp.com","about":"Connecting people to great local businesses in communities around the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-09T20:15:26.577Z","bug_reporter_agreed_on_going_public_at":"2016-09-09T18:41:50.836Z","team_member_agreed_on_going_public_at":"2017-11-09T20:15:26.400Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi security ,\n\nDescription:\nI found user id in encrypted form from there profile url \nhttps://www.yelp.com/user_details?userid=\u003cuser id's\u003e\n\non intercepting request of add friend, complement and send message i can identify user id ..\nwhen i change identified user ID to other user's ID then request of add friend is send to other user without any token and secession validation .. scenario for the complement and send message is same.\n\nImpact:\n-\u003ean attacker can add the authenticated user to his account or any others accounts ..\n-\u003ecan send message to any one by user's account \n-\u003ecan complement on other users by victim user \n\nMore information about this issue is available here:\n\nhttps://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References\nhttps://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_(OTG-AUTHZ-004)\n\nReproduction Steps:- for add friend \n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on add friend on user one \n4.\u003eintercepting request \n5.\u003eidentify user id and change it to second user's id on each request \n6.\u003eclick on send\n7.\u003eintercept request and change user id \n8.\u003echeck the screen with the message od request is send to second user \n(request is send to another user)\n\nReproduction Steps:- for complement\n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on complement of user one\n4.\u003eintercepting request \n5.\u003eidentify user id and change it to other user's id on each request \n6.\u003etype the complement\n7.\u003eintercept request and change user id \n8.\u003echeck the screen with message that complement is send to second user\n(complement is send to second user)\n\nReproduction Steps:- for send message \n1.\u003elogin to your test account \n2.\u003evisit any two user's profile \n3.\u003eclick on send message of user one \n4.\u003eintercepting request \n5.\u003eidentify user id and change it to other user's id on each request \n6.\u003etype the message \n7.\u003eintercept request and change user id \n8.\u003echeck the screen with message that complement is send to second user\n(message is send to second user)\n\nPlease Find the video POC from the links\n\nhttps://mega.nz/#!FR5CxSrD!wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\n\nhttps://mega.nz/#!UQBBWY7C!85q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\n\n\nRegards \nAaysha Khilji\n\n\n\n\n    ","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["rashedul_css","khokho1986","b4155f7c29acd42c27d007a"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1182330,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting your report to us! We just launched our public bug-bounty program on HackerOne. Please expect a response within a week.\n\n- The Yelp Security Team\n","automated_response":true,"created_at":"2016-09-08T14:14:07.575Z","updated_at":"2016-09-08T14:14:07.575Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1183533,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @w3b7ricks73r,\n\nTo add another friend on Yelp, instead of intercepting the request and change the user_id in the request, there's a better way to do that- you could just go to the second user's profile page and click \"Add friend\". Same applies to compliment and messaging.\n\nThis is working as intended and there are no security implications.\n\nBest, \nThe Yelp Security Team","automated_response":false,"created_at":"2016-09-09T00:44:24.356Z","updated_at":"2016-09-09T00:44:24.356Z","actor":{"username":"luqipan","cleared":false,"url":"/luqipan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1185211,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @luqipan.\nyes! user can do that directly....\n    but what if an attacker wants to add (receive message or complement ) user to his account then he can do this very easily by changing the user id into the request  ..\nThanks \nAaysha Khilji","automated_response":false,"created_at":"2016-09-09T18:41:50.862Z","updated_at":"2016-09-09T18:41:50.862Z","first_to_agree":true,"actor":{"username":"w3b7ricks73r","cleared":false,"url":"/w3b7ricks73r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147278,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-09T20:15:26.462Z","updated_at":"2017-11-09T20:15:26.462Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147279,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-09T20:15:26.620Z","updated_at":"2017-11-09T20:15:26.620Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}