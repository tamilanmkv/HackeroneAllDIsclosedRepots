{"id":167631,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjc2MzE=","url":"https://hackerone.com/reports/167631","title":"Host header poisoning leads to account password reset links hijacking","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2016-09-11T20:05:24.016Z","submitted_at":"2016-09-11T20:05:24.016Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yassineaboukir","url":"/yassineaboukir","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1453,"url":"https://hackerone.com/boozt","handle":"boozt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Boozt Fashion AB","twitter_handle":"","website":"http://www.boozt.com","about":"E-Commerce shop"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-17T19:19:13.007Z","bug_reporter_agreed_on_going_public_at":"2016-09-16T08:55:32.238Z","team_member_agreed_on_going_public_at":"2016-09-17T19:19:12.867Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n**Issue Summary :**\nWhile conducting my regular testing I discovered that the mobile version of boozt.com application relies on the host header when constructing password reset links emailed to the user. Thus, an attacker can inject a arbitrary host header which leads to password reset leakage.\n\n**Impact :** The attacker will receive the leaked user password reset link and, as a consequence, take over user's account.\n\n**Proof Of Concept :**\n1. Browse to https://m.boozt.com/eu/en/customer/forgot_password\n2. Enter the victim's address mail (Easily enumerated abusing #165894).\n3. Click to reset the password.\n4. Intercept the HTTP request and tamper the host header to a domain name controlled by the atatcker as you can see below :\n\n{F119118}\n\nOtherwise, you can simply use the following CURL command to reproduce the request after replacing `\u003cTOKEN\u003e` and `\u003cSESSION\u003e` with a valid values:\n\n```\ncurl -i -s -k  -X 'POST' \\\n    -H 'Host: yassineaboukir.com' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:48.0) Gecko/20100101 Firefox/48.0' -H 'DNT: 1' -H 'Referer: https://m.boozt.com/eu/en/customer/forgot_password' -H 'cookie: \u003cSESSION\u003e;' -H 'Upgrade-Insecure-Requests: 1' -H 'Content-Type: application/x-www-form-urlencoded' \\\n    --data-binary $'forgot_password%5Bemail%5D=yaaboukir@gmail.com\u0026forgot_password%5B_token%5D=\u003cTOKEN\u003e' \\\n    'https://m.boozt.com/eu/en/customer/forgot_password'\n```\n\nNow, the victim will receive a password reset e-mail with a poisoned link as you can see below :\n\n{F119124}\n\nOnce the user clicks on it, he/she will be taken to :\n\n\u003ehttps://yassineaboukir.com/eu/en/customer/reset_password/c2eca9c2b4160c94c884faa529e7ae4c\n\nThe token is now leaked and the attacker now can simply go to the server logs and browse all the incoming HTTP requests to retrieve the password reset link. Consequently, the token is still valid and will be able to reset password of the victim's boozt account : GAME OVER!\n\n**Mitigation :** The web application should use the SERVER_NAME instead of the Host header as is the case in the main app boozt.com.\n\n**References :**\n- http://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html\n \nKind regards.\nYassine ABOUKIR\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":166311,"original_report_url":"https://hackerone.com/reports/166311","attachments":[{"id":119118,"file_name":"Capture_d_e_cran_2016-09-11_a__20.32.44.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/118/d8493799ffb87a77630f35208a35fde30e966c92/Capture_d_e_cran_2016-09-11_a__20.32.44.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.32.44.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.32.44.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134958Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5731957ec40964d8aa7c806f810b79d9b8c0ee9fdcc7e39e37f440519ab6bc61","file_size":28275,"type":"image/png"},{"id":119124,"file_name":"Capture_d_e_cran_2016-09-11_a__20.53.08.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/119/124/5e3e45bc7a9336bed67da2f6d95c12180ba2b11f/Capture_d_e_cran_2016-09-11_a__20.53.08.png?response-content-disposition=attachment%3B%20filename%3D%22Capture_d_e_cran_2016-09-11_a__20.53.08.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d_e_cran_2016-09-11_a__20.53.08.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134958Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e87a5b44e5c3a0adb59e39b45f479ad8d63506e6591b2f31a92d730836d602d2","file_size":47232,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":43,"voters":["derision","cdl","smiegles","albinowax","bogdantcaciuc","yaworsk","flashdisk","zombiehelp54","ngalog","yassineaboukir","and 33 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1188367,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi,\nThanks for the report, though someone beat you to reporting this.\nI know domain is different, but as per our program guidelines different domains share the same system, so the same bugs are counted as duplicate.","automated_response":false,"created_at":"2016-09-12T11:08:52.540Z","updated_at":"2016-09-12T11:08:52.540Z","original_report_id":166311,"actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1188600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @aurelijus,\nThank you for getting back to me. I read your guidelines, but I thought boozt and shopeu.ecco.com does not have the same system because boozt.com is not vulnerable to it, only the mobile web app is vulnerable.","automated_response":false,"created_at":"2016-09-12T13:47:27.562Z","updated_at":"2016-09-12T13:47:27.562Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1199988,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Shall we disclose ?","automated_response":false,"created_at":"2016-09-16T08:55:32.305Z","updated_at":"2016-09-16T08:55:32.305Z","first_to_agree":true,"actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202196,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-09-17T19:19:12.944Z","updated_at":"2016-09-17T19:19:12.944Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202197,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-17T19:19:13.036Z","updated_at":"2016-09-17T19:19:13.036Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}