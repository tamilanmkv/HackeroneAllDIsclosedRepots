{"id":171398,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzEzOTg=","url":"https://hackerone.com/reports/171398","title":"(HackerOne SSO-SAML) Login CSRF, Open Redirect, and Self-XSS Possible Exploitation","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-09-23T09:17:18.019Z","submitted_at":"2016-09-23T09:17:18.019Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whhackersbr","url":"/whhackersbr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-27T05:01:49.129Z","bug_reporter_agreed_on_going_public_at":"2016-10-27T05:01:49.074Z","team_member_agreed_on_going_public_at":"2016-10-19T01:01:32.521Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Summary:###\n\nLogin CSRF, Open Redirect, and Self-XSS Possible Exploitation through HackerOne SSO-SAML\n\n###PoC###\n\n- Go to █████;\n\nUse a browser window with clear cookies.\n\nSource-code:\n\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\t\u003ciframe id=\"login_csrf_frame\" src=\"████████\" style=\"width:0;height:0;border:0;border:none;\"\u003e\u003c/iframe\u003e\n\t\u003cscript\u003e\n\t\tsetTimeout(function(){document.location.href = \"https://hackerone.com/users/saml/sign_in?email=████\u0026remember_me=true\";}, 5000);\n\t\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n###Impact:###\n\n1) Information Leak\n\nAn attacker can use Logout CSRF + Login CSRF against a victim to steal all information sent by the victim to the HackerOne website while using the malicious session, including confidential bug reports.\n\n2) Open Redirect\n\nSince the SSO-SAML l​ogin flow can be started automatically (`GET https://hackerone.com/users/saml/sign_in?email=███`) by an attacker and it redirects to external URLs, the attacker can redirect the user to anywhere.\n\n3) Self-XSS Possible Exploitation​\n\nSome stored Self-XSS's (internal areas accessed just by the victim, etc.) can be exploited through Login CSRF.\n\n```\nMalicious page -\u003e HackerOne Login CSRF -\u003e Self-XSS triggers -\u003e Logout -\u003e Wait user actions\n```\n\nIf the user interacts with the page (sign in with his account, etc.), the attacker can exploit the Self-XSS.\n\nP.S.:\n\nAn attacker can add extra dots to the SAML Email Domain in the config dialog.\nI didn't test all the implications, but registering a very similar domain could be a bad thing, like `hackerone..com`, `hackerone.com.`, `.hackerone.com` or even `gmail..com` because of typing mistakes (`victim@hackerone..com would redirect the victim to the attacker external login flow`).","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-18T01:01:32.572Z","allow_singular_disclosure_after":-154529383.2087637,"singular_disclosure_allowed":true,"vote_count":41,"voters":["whhackersbr","bogdantcaciuc","sameerphad72","spam404","bytehope","aryan2808","bugdiscloseguys","gamliel","xsam","madrobot","and 31 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1213007,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @whhackersbr, thanks for your submission, we appreciate it! While investigating your submission, we couldn't figure out what the `iframe` element does exactly. Consider this: if Uber has SAML enabled through ███████, would any Uber employee be able to pull this off? Or do you need your own IDP or have really low security settings? Please elaborate how it works and we'll take another look. Thanks again!","automated_response":false,"created_at":"2016-09-23T17:40:53.834Z","updated_at":"2016-10-27T00:01:07.712Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1213566,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @bencode,\n\n\u003e (...) if Uber has SAML enabled through █████, would any Uber employee be able to pull this off?\n\nNo, just employees with privileges to change the Uber SAML IDP settings.\n\n\u003e (...) Please elaborate how it works and we'll take another look.\n\n```\n\nHackerOne starts SAML login flow without CSRF protection (opens ████████)\n█████ starts another SAML login flow for corporate accounts (██████) without CSRF protection (opens ████)\n███████ automatically signs in any user without password (returns to ██████)\n██████████ Login CSRF (returns to HackerOne)\nHackerOne Login CSRF\n\n```","automated_response":false,"created_at":"2016-09-23T23:46:35.984Z","updated_at":"2016-10-27T00:01:07.698Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bencode @reed @dirk @security,\n\nPlease tell me once you have been able to reproduce.\nAnyone can sign in with my HackerOne account without password and I need to lock it again ASAP, just in case.\n;-)","automated_response":false,"created_at":"2016-09-25T20:52:06.011Z","updated_at":"2016-09-25T20:56:14.272Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr,\n\nYes we were able to reproduce, you can set a password back on your account again-thanks!","automated_response":false,"created_at":"2016-09-25T23:18:38.386Z","updated_at":"2016-09-25T23:18:38.386Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1217327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed,\n\nI saw that we need to pass through a review every time we change the config of the SSO-SAML.\nWhat is done/considered in this review?\nDepending on the answer I can or can not have more issues to report.","automated_response":false,"created_at":"2016-09-26T20:59:03.167Z","updated_at":"2016-09-26T20:59:03.167Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr,\n\nI want to make sure I answered all your questions, let me know if I missed any!\n\n\u003e 1) Information Leak \u0026 3) Self-XSS Possible Exploitation\n\nWe were unaware that you could create an account that has no password and that would auto-login without requiring user intervention, which does make it possible to achieve the CSRF. However, it seems that this isn't a great password strategy for a company to use. The reason we accept this risk is for the convenience of [IdP initiated SSO](https://docs.pingidentity.com/bundle/pf_sm_browserBasedSso_topic/page/task/idpInitiatedSsoPOST.html) as defined in the standard.\n\n\u003e 2) Open Redirect \u0026 PS extra dots in SAML email domain\n\nThe SAML URL and extra dots in the email domain is mitigated by (currently) a manual approval process. Our team verifies the SAML URLs before approving.\n\n\u003e What is done/considered in this review?\n\nWe do a few manual checks: \n\n**Domain** verification to ensure that the domain is valid and one that would only be controlled by the team.\n\n**URL** checks that it's a recognized public service (ones [we support](https://support.hackerone.com/hc/en-us/articles/205587379)) or if it's an internal instance-for a team we trust, \n\n**Certificates** are looked at for expiration, ownership, etc.\n","automated_response":false,"created_at":"2016-09-27T01:28:44.817Z","updated_at":"2016-09-27T01:28:44.817Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1217903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bencode @reed @security\n\nHey @bencode,\n\n\u003e I want to make sure I answered all your questions, let me know if I missed any!\n\nNo, you didn't miss anything.\nThanks.\n=)\n\n\u003e 1) Information Leak \u0026 3) Self-XSS Possible Exploitation\n\u003e (...) However, it seems that this isn't a great password strategy for a company to use. (...)\n\nI agree, but this is a great strategy for an attacker, exactly to achieve the Info Leak and/or Self-XSS exploitation.\n\n\u003e (...) The reason we accept this risk is for the convenience of IdP initiated SSO as defined in the standard. (...)\n\nBut you can protect the users against the Login CSRF without breaking the feature.\n\n\u003e 2) Open Redirect \u0026 PS extra dots in SAML email domain\n\u003e The SAML URL and extra dots in the email domain is mitigated by (currently) a manual approval process. Our team verifies the SAML URLs before approving.\n\nPerfect, the extra dots stuff are not exploitable.\n\nI disagree about the Open Redirect mitigation since the review team would not know about it.\n\n```\n1) The attacker creates the following flow:\nhackerone.com --(redirect)--\u003e ████ --(redirect)--\u003e corp.attacker.com asks for the password \n--(redirect)--\u003e ██████ --(redirect)--\u003e HackerOne\n\n2) The attacker submits the application for approval.\n\n3) The review team accepts the application.\n\n4) The attacker changes the flow to:\nhackerone.com --(redirect)--\u003e ██████ --(redirect)--\u003e corp.attacker.com --(redirect)--\u003e Any Site\n```\n\nAll the consequences of this Login CSRF (Info Leak, Open Redirect, and Self-XSS Exploitation) could be mitigated with CSRF protections, without breaking the SSO feature.\n\n\u003e We do a few manual checks:\nDomain verification to ensure that the domain is valid and one that would only be controlled by the team.\n\nHow do you decide if a domain is only controlled by a team?\nThis is very important to me.\n\nThank you very much.","automated_response":false,"created_at":"2016-09-27T02:30:55.724Z","updated_at":"2016-10-27T00:01:07.672Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1222713,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @whhackersbr,\n\nWe've discussed have some questions:\n\n - How do you propose we protect against the login CSRF without breaking IdP initiated SSO?\n - How would we validate that an IdP (malicious or not) doesn't change to a malicious redirect?\n\n\u003e How do you decide if a domain is only controlled by a team?\n\nWe use a mixture of OSINT, e-mail validation, domain validation and website validation.\n\nThanks,\n@bencode","automated_response":false,"created_at":"2016-09-28T23:01:11.761Z","updated_at":"2016-09-28T23:01:11.761Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1223092,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @bencode,\n\nI will provide a protection, but I am sorry because I am not a developer, so I will probably commit a lot of conceptual mistakes.\n=(\n\nPlease guide me to the correct approach (security vs. usability).\n\n###PoC Video###\n\n * https://youtu.be/████\n\n###SCENARIO 1###\n\n1) User inserts his corporate email in the HackerOne login form and clicks on \"Sign in\";\n\n2) HackerOne performs a POST request with CSRF protection;\n\n3) If everything is right, HackerOne sets a​ SAML SSO short life cookie with the user's email and redirects him to `/users/saml/sign_in?email=user@domain.com`;\n\n4) `/users/saml/sign_in?email=user@domain.com` tests the cookie and the user's email, and if they are right, the user will be redirected to the regular SAML SSO flow, but ​if the cookie is missing or is wrong, user gets an error;\n\n5) After the SAML SSO flow inside user's corporate network, he ends in `/users/saml/auth`;\n\n6) `/users/saml/auth` tests the cookie, the user's email, and the SAML SSO credentials:\n\n * If everything is right, login successful (no friction);\n * If the credentials are right but cookie and email, a warning screen is shown asking if he wants to sign in with that email, and the login is performed through a POST with CSRF protection after the user's consent/click (small friction);\n * If nothing is right, the ​user gets an error (nothing changes).\n\n###SCENARIO 2###\n\n1) User goes to a malicious website;\n2) The attacker sends a direct request to `/users/saml/sign_in?email=attacker@domain.com`;\n3) `/users/saml/sign_in` returns an error because the SAML SSO cookie is missing or wrong​;\n\n###SCENARIO 3###\n\n1) User starts the SAML SSO flow outside the HackerOne platform;\n2) User ends in `/users/saml/auth`;\n3) The SAML SSO cookie is missing, so a warning screen is shown asking if he really wants to sign in with that email, and the login is performed through a POST with CSRF protection after the user's consent/click (small friction);\n\nThanks and sorry in anticipation for all the conceptual mistakes.\nI know it is easy to find bugs but hard to fix accordingly.\n\nPoC source code attached.​","automated_response":false,"created_at":"2016-09-29T06:52:13.335Z","updated_at":"2016-10-26T23:52:46.522Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":123760,"filename":"hackerone.com.zip","type":"application/zip","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/760/4c1292d4034de1a52f8af65319e7f9306209c454/hackerone.com.zip?response-content-disposition=attachment%3B%20filename%3D%22hackerone.com.zip%22%3B%20filename%2A%3DUTF-8%27%27hackerone.com.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135115Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2885d77fa57f5c40fd70f469c35d536051ea80cc9d4874343a41ccd4c7930b6a"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S.: For the \"warning screen\", you can create a `Remember me for X months` option to reduce the friction, using a cookie to know all accepted emails on that computer.","automated_response":false,"created_at":"2016-09-29T19:33:19.478Z","updated_at":"2016-09-29T19:33:19.478Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233032,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey @whhackersbr,\n\nWe've discussed this again internally and have decided this is a not fix and we're happy to accept the risk. However, we were impressed by your reporting and PoC so we've decided we are going to award you some swag! Make sure your address is up to date in HackerOne so you receive it :)\n\nCheers,\n@asuka","automated_response":false,"created_at":"2016-10-05T11:32:48.887Z","updated_at":"2016-10-05T11:32:48.887Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233033,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2016-10-05T11:32:57.954Z","updated_at":"2016-10-05T11:32:57.954Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"reporter":{"username":"whhackersbr","url":"/whhackersbr"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233872,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @asuka,\n\nSince you changed something after this report, can you please close it as resolved at least?\n\nNow I can not set SAML with a test team anymore:\n\n\u003e SAML is not available until launch.\n\nThanks.","automated_response":false,"created_at":"2016-10-05T18:41:29.506Z","updated_at":"2016-10-05T18:41:39.966Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245405,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@security,\n\nP.S.:\n\nJust keep in mind that with the Open Redirector, an attacker can bypass the `External Link Warning`, you could fix at least this bad behavior for now.\n;-)\n\n[External Link Warning](https://google.com)\n\n[External Link Warning Bypass](https://hackerone.com/users/saml/sign_in?email=teste@snapchat.com\u0026remember_me=true)","automated_response":false,"created_at":"2016-10-13T08:07:14.294Z","updated_at":"2016-10-13T08:08:25.591Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @whhackersbr,\n\nI'm not sure that was changed as a direct result of your report, but we'll investigate and get back to you. The open redirect is mitigated against because we check all SAML links before launching a programme. \n\nCheers\n-@asuka","automated_response":false,"created_at":"2016-10-13T09:08:29.867Z","updated_at":"2016-10-13T09:08:29.867Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @asuka,\n\n\u003e I'm not sure that was changed as a direct result of your report, but we'll investigate and get back to you.\n\nOk, thanks.\n\n\u003e The open redirect is mitigated against because we check all SAML links before launching a programme.\n\nLike I said before:\n\n\u003eI disagree about the Open Redirect mitigation since the review team would not know about it.\n\n```\n1) The attacker creates the following flow:\nhackerone.com --(redirect)--\u003e ████ --(redirect)--\u003e corp.attacker.com asks for the password \n--(redirect)--\u003e █████████ --(redirect)--\u003e HackerOne\n\n2) The attacker submits the application for approval.\n\n3) The review team accepts the application.\n\n4) The attacker changes the flow to:\nhackerone.com --(redirect)--\u003e ███████ --(redirect)--\u003e corp.attacker.com --(redirect)--\u003e Any Site\n```\n\n;-)","automated_response":false,"created_at":"2016-10-13T18:42:17.543Z","updated_at":"2016-10-27T00:01:07.631Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whhackersbr,\n\nJust to follow-up, we changed the SAML sign-up flow unrelated to your issues, as we're currently improving how we handle product edition changes, and SAML set-up was changed as a result of that work.\n\nSecondly, we accept the risk of that for open redirect, as we require a company to sign-up and pay for Profesional edition or above before they can sign-up for SAML. How would we fix this issue anyway? We cannot control the third-party IdP.","automated_response":false,"created_at":"2016-10-13T19:06:42.624Z","updated_at":"2016-10-13T19:06:42.624Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1247078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @security,\n\n\u003e Just to follow-up, we changed the SAML sign-up flow unrelated to your issues, as we're currently improving how we handle product edition changes, and SAML set-up was changed as a result of that work.\n\nOh, understood.\n;-)\n\n\u003e How would we fix this issue anyway? We cannot control the third-party IdP.\n\nThis specific​ behavior can be fixed if you send `https://hackerone.com/users/saml/*` through the `External Link Warning`, currently, this URL bypasses the warning. You will still have the Open Redirector bug, but reports inside the H1 platform would not have URLs to malicious code that bypasses the warning.\n\n\u003e (...) this is a not fix (...)\n\nCan you please tell me why my fix (Anti Login CSRF for SAML Login) doesn't work?\nSometimes I can fix the problem, who knows, hehehe.\n=)","automated_response":false,"created_at":"2016-10-14T02:30:50.571Z","updated_at":"2016-10-14T02:30:50.571Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1253991,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-10-18T19:49:14.491Z","updated_at":"2016-10-18T19:49:14.491Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1254007,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-18T19:55:04.383Z","updated_at":"2016-10-18T19:55:04.383Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":2922},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1254070,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @whhackersbr,\n\nWhile we feel the risk of the open redirect being abused in URL comments is minimal at best, we do strive to go above and beyond and fix issues that could possibly be used in the future to chain exploits together (defense-in-depth strategy). We've ensured all auth-related endpoints are no longer exempt from the external link warning interstitial, as per your last comment, which should alleviate this concern.\n\nWe also discussed the Login CSRF inherit in IdP-initiated sessions with several other companies, and we continue to feel that bypassing CSRF checks is an accepted risk for the user experience of SSO via SAML. This may change in the future if this begins to be exploited somehow.\n\nI think this covers everything you've mentioned, so let me know if I've missed something.","automated_response":false,"created_at":"2016-10-18T20:12:49.668Z","updated_at":"2016-10-18T20:12:49.668Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"whhackersbr","url":"/whhackersbr"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1254440,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @reed,\n\n\u003e While we feel the risk of the open redirect being abused in URL comments is minimal at best, we do strive to go above and beyond and fix issues that could possibly be used in the future to chain exploits together (defense-in-depth strategy). We've ensured all auth-related endpoints are no longer exempt from the external link warning interstitial, as per your last comment, which should alleviate this concern.\n\nNice strategy, I am happy with the result.\n\n\u003e We also discussed the Login CSRF inherit in IdP-initiated sessions with several other companies, and we continue to feel that bypassing CSRF checks is an accepted risk for the user experience of SSO via SAML. This may change in the future if this begins to be exploited somehow.\n\nUnderstood.\n\nThank you very much as always, I am here to help.\n;-)","automated_response":false,"created_at":"2016-10-18T23:38:11.832Z","updated_at":"2016-10-18T23:38:11.832Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1254845,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for poking around at this code! We really appreciate it. I'm requesting public disclosure. Let me know if anything in your PoCs you want censored/removed, since I know it includes some of your personal accounts.","automated_response":false,"created_at":"2016-10-19T01:01:32.539Z","updated_at":"2016-10-19T01:01:32.539Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1255080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed @security,\n\nI don't want to bother you even more with this subject, but the fix is incomplete:\n\n[Working](https://hackerone.com/users/saml/sign_in?email=teste@hackerone.com)\n[Working](https://hackerone.com/./users/saml/sign_in?email=teste@hackerone.com)\n[Working](https://hackerone.com/blaaah/../users/saml/sign_in?email=teste@hackerone.com)\n[Not Working](https://hackerone.com/%2E/users/saml/sign_in?email=teste@hackerone.com)\n[Not Working](https://hackerone.com/blaaah/.%2E/users/saml/sign_in?email=teste@hackerone.com)\n\nJust let me know your decision of fixing​ it or not, so I will know if I need to wait or not to accept the public disclosure.​\n\n\u003e Let me know if anything in your PoCs you want censored/removed, since I know it includes some of your personal accounts.\n\nPlease remove​ the following strings:\n\n```\n██████\n██████\nhttps://youtu.be/█████\n█████\n█████\n███████\n```","automated_response":false,"created_at":"2016-10-19T06:03:02.503Z","updated_at":"2016-10-27T00:01:07.596Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whhackersbr, took a little longer than I would have liked, but fixed the other cases you mentioned as well.\n\nI've also redacted all the strings you mentioned. Anything else you've noticed before disclosure?","automated_response":false,"created_at":"2016-10-27T00:01:26.066Z","updated_at":"2016-10-27T00:01:26.066Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270326,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@reed,\n\n\u003e Anything else you've noticed before disclosure?\n\nNo.\nThanks.\n=)","automated_response":false,"created_at":"2016-10-27T05:01:49.096Z","updated_at":"2016-10-27T05:01:49.096Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270327,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-27T05:01:49.176Z","updated_at":"2016-10-27T05:01:49.176Z","actor":{"username":"whhackersbr","cleared":true,"url":"/whhackersbr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/529/88a70e872d0b669249b3ef2269fb7ec7eaab85f7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270329,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2016-10-27T05:04:39.617Z","updated_at":"2016-10-27T05:04:39.617Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}