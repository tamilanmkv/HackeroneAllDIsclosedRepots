{"id":172837,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI4Mzc=","url":"https://hackerone.com/reports/172837","title":"password less login token expiration issue","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-29T07:28:23.083Z","submitted_at":"2016-09-29T07:28:23.083Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-19T15:44:17.559Z","bug_reporter_agreed_on_going_public_at":"2016-10-19T15:44:17.508Z","team_member_agreed_on_going_public_at":"2016-10-19T15:38:13.114Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Log into Shopify iOS app as Alice and grab the token.\n2. Send the below request to generate the password less login token (The token expires after a single use. So don't use the token).\n\n    Request:\n    POST /admin/api/graphql HTTP/1.1\n    Host: seclearn.myshopify.com\n    Content-Type: application/graphql\n    Connection: close\n    X-Shopify-Access-Token: f263fb8c544a4cb965d63635a2e1c772\n    Accept: application/json\n    User-Agent: Shopify Mobile/iPhone OS/5.0 (iPhone6,2/com.jadedpixel.shopify)\n    Content-Length: 66\n    Accept-Language: en-us\n    Accept-Encoding: gzip, deflate\n\n    mutation{adminPasswordlessLogin(input:{}){passwordlessLoginToken}}\n\n    Response:\n    {\"data\":{\"adminPasswordlessLogin\":{\"passwordlessLoginToken\":\"bd7ffa6c5bf2969fa15753f8fb8cb427-1475133135\"}}}\n\n3. From desktop browser, login as Alice and revoke access to Shopify iOS app. It is revoking the access token but password less login token still works. \n\n    Replace the above login token in the below URL and it logs you in.\nhttps://seclearn.myshopify.com/admin?login_token=bd7ffa6c5bf2969fa15753f8fb8cb427-1475133135\n\nAttack scenario:\n1. User gave access to an app.\n2. App used the request and kept an unused login token. \n3. User revoked access to the app.\n4. App can still use the unused login token and access user's data.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["drsniper","yaworsk","eveeez","jbbbkj","sumit7","spetr0x","gopalsingh112"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1223105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2016-09-29T07:28:23.454Z","updated_at":"2016-09-29T07:28:23.454Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another attack scenario, \n\n1. User logged into iOS app on an iPhone.\n2. User lost the phone. \n3. Attacker, who found the phone generated the login token using the above request.\n4. User realized that his phone is lost and used the desktop website to logout from all the devices. It logout from all the devices but does not expire the previously generated login token.\n5. Attacker uses the login token and login again.\n\nFix: \nExpire the all the login tokens associated with an access token, when the access token is expired.","automated_response":false,"created_at":"2016-09-29T09:14:42.093Z","updated_at":"2016-09-29T09:14:42.093Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1235687,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2016-10-06T15:18:26.250Z","updated_at":"2016-10-06T15:18:26.250Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244758,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Passwordless login tokens were only intended to be valid for five minutes, which we consider to be a short enough validity period that a revocation mechanism is not required. However, there was a bug which resulted in a much longer validity period. We have corrected this issue, so passwordless login tokens now expire quickly, as intended.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2016-10-12T20:19:05.254Z","updated_at":"2016-10-12T20:19:05.254Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244759,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2016-10-12T20:19:45.106Z","updated_at":"2018-02-28T13:10:48.370Z","additional_data":{"added_weaknesses":[{"id":27,"name":"Improper Authentication - Generic"}],"removed_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}]},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255940,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","automated_response":false,"created_at":"2016-10-19T15:38:08.308Z","updated_at":"2016-10-19T15:38:08.308Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255942,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-19T15:38:13.131Z","updated_at":"2016-10-19T15:38:13.131Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1255953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-19T15:44:17.530Z","updated_at":"2016-10-19T15:44:17.530Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1255954,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-19T15:44:17.579Z","updated_at":"2016-10-19T15:44:17.579Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}