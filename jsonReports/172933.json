{"id":172933,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI5MzM=","url":"https://hackerone.com/reports/172933","title":"IDNs displayed in unicode in messages/about/talk sections (Homograph Attack)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-29T15:37:28.605Z","submitted_at":"2016-09-29T15:37:28.605Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hk755a","url":"/hk755a","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":545,"url":"https://hackerone.com/yelp","handle":"yelp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Yelp","twitter_handle":"","website":"https://www.yelp.com","about":"Connecting people to great local businesses in communities around the world."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-09T19:54:03.237Z","bug_reporter_agreed_on_going_public_at":"2017-10-16T15:01:22.218Z","team_member_agreed_on_going_public_at":"2017-11-09T19:54:03.119Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Yelp,\n\nPlease refer https://en.wikipedia.org/wiki/Internationalized_domain_name to know more about IDNs.\n\nThe IDN (Internationalized Domain Name) : http://ebаy.com/\nis a homograph for the latin ebay.com. if you click that first link, you might think that you are going to ebay.com but in fact, you are going to a homograph url http://xn--eby-7cd.com/\n\nWhen such an IDN is posted on Yelp (for ex at the about me page,Talk section,Messages etc.). ,it displays IDN in Unicode. It would be safer to represent the Punycode version of the URL so that it would be apparent to the users that something wierd is going on. i.e show  http://xn--eby-7cd.com/ instead of http://ebаy.com/\n\nA bad guy can exploit this vulnerability by putting up a spoof site behind one of these IDN links,posting the link anywhere on yelp (The talk section can be a nice place) and the user or the yelp moderator/admin opens and carelessly enters his credentials there.\n\nFacebook,hackerone,crowdcurity and many major sites have implemented code to block such attacks.They show the punycode version of the IDN url.\n\nMore info:\nhttp://www.charset.org/punycode.php?encoded=http%3A%2F%2Fxn--eby-7cd.com%2F\u0026decode=Punycode+to+normal+text\n\nFew more Examples:\n1) https://www.уelp.com/\n2) https://www.yelp.com/\n\nThey both appear to be same when posted on yelp but actually 2nd is the original one and the 1st is actually https://www.xn--elp-cfd.com/\n\nFor reproduction paste https://www.xn--elp-cfd.com/ anywhere on yelp and post it.It would appear as yelp.com only\n\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":123889,"file_name":"yelp.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/889/6f79e9ae6a9be9c10eb71848372f723618997cfd/yelp.png?response-content-disposition=attachment%3B%20filename%3D%22yelp.png%22%3B%20filename%2A%3DUTF-8%27%27yelp.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135156Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=19bfd46d5ba21f13a23c18fbb8ae8f1e3703c75be7d2e6db2c0fafe9c56bd09b","file_size":95332,"type":"image/png"}],"allow_singular_disclosure_at":"2017-11-15T15:01:22.261Z","allow_singular_disclosure_after":-123202234.709497,"singular_disclosure_allowed":true,"vote_count":11,"voters":["jensec","brahim_boufakri01","gamliel","eveeez","japz","dolph1n","test0401","thejaguar","b4155f7c29acd42c27d007a","interface","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1223782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting your report to us! We just launched our public bug-bounty program on HackerOne. Please expect a response within a week.\n\n- The Yelp Security Team\n","automated_response":true,"created_at":"2016-09-29T15:37:29.030Z","updated_at":"2016-09-29T15:37:29.030Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Mobile users are more likely to be a victim of such an attack.\n","automated_response":false,"created_at":"2016-09-29T16:20:01.137Z","updated_at":"2016-09-29T16:20:01.137Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224228,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi there!\n\nThanks for submitting your report to us!\n\nWe are investigating the reported issue and will update this thread once we have further details.\n\nBest,\nThe Yelp Security Team","automated_response":false,"created_at":"2016-09-29T18:37:45.431Z","updated_at":"2016-09-29T18:37:45.431Z","actor":{"username":"5a37bf56c8","cleared":false,"url":"/5a37bf56c8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1239643,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\nAny updates on this?","automated_response":false,"created_at":"2016-10-10T07:26:13.608Z","updated_at":"2016-10-10T07:26:13.608Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1285383,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello YELP security team\nIs there any update on the status of the bug?  \nPlease respond as soon as possible.\nThank you for your valuable time.","automated_response":false,"created_at":"2016-11-04T22:54:02.848Z","updated_at":"2016-11-04T22:54:02.848Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1342588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello\nJust wondering whether there has been any action or progress made on this report?\n\nThanks","automated_response":false,"created_at":"2016-12-05T22:06:33.188Z","updated_at":"2016-12-05T22:06:33.188Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1434480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yelp \nAny updates ? It has been a really long time! Atleast a simple response would be appreciable.\nThank You","automated_response":false,"created_at":"2017-01-21T10:53:39.529Z","updated_at":"2017-01-21T10:53:39.529Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1434481,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its been thrice the average time taken by yelp for resolution. When can i expect an update ? ","automated_response":false,"created_at":"2017-01-21T10:55:06.745Z","updated_at":"2017-01-21T10:55:06.745Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944792,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi there!\n\nWe have deployed a fix to address the reported issue.\n\nBest,\nThe Yelp Security Team","automated_response":false,"created_at":"2017-08-21T21:56:57.720Z","updated_at":"2017-08-21T21:56:57.720Z","actor":{"username":"5a37bf56c8","cleared":false,"url":"/5a37bf56c8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hk755a","url":"/hk755a"},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944796,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-08-21T21:57:35.674Z","updated_at":"2017-08-21T21:57:35.674Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Yelp"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"yelp","collaborator":{"username":"hk755a","url":"/hk755a"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944801,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-08-21T21:59:21.278Z","updated_at":"2017-08-21T21:59:21.278Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Yelp"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"yelp","collaborator":{"username":"hk755a","url":"/hk755a"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1946124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks Yelp Team","automated_response":false,"created_at":"2017-08-22T12:46:58.707Z","updated_at":"2017-08-22T12:46:58.707Z","actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2069213,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-10-16T15:01:22.238Z","updated_at":"2017-10-16T15:01:22.238Z","first_to_agree":true,"actor":{"username":"hk755a","cleared":false,"url":"/hk755a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/054/44d1e9a7b1a6fa6f52f711a490258303d86267f9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147187,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-09T19:54:03.160Z","updated_at":"2017-11-09T19:54:03.160Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147188,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-09T19:54:03.271Z","updated_at":"2017-11-09T19:54:03.271Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}