{"id":173721,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzM3MjE=","url":"https://hackerone.com/reports/173721","title":"Bad content-type in response header when getting document can lead to html injection","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-03T21:13:23.868Z","submitted_at":"2016-10-03T21:13:23.868Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"unknowns132","url":"/unknowns132","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-01-12T20:45:39.433Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-12-13T20:45:31.434Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Bug\nWhen request document by genesis_id or filename, the content-type field in response header is 'text/html'.\nAnd the document content can be anything. So if we upload an odt file with html format and share with other users, it can lead to html injection when others request that file.\n\n## PoC\n- img1 via es_id\n- img2 via filename (share with others)\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":125253,"file_name":"img1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/125/253/8d36ebb06144e0968a6a77da12eaa1e62593e92e/img1.png?response-content-disposition=attachment%3B%20filename%3D%22img1.png%22%3B%20filename%2A%3DUTF-8%27%27img1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135216Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e853477a1da5bbce89423a642276b8c2687e0d72f04bf491fb6e2e0d23037a4c","file_size":71929,"type":"image/png"},{"id":125254,"file_name":"img2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/125/254/9c859123e2bc6b88de629396816bef8f70b2d427/img2.PNG?response-content-disposition=attachment%3B%20filename%3D%22img2.PNG%22%3B%20filename%2A%3DUTF-8%27%27img2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135216Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=453732618816597a68336eed56349aca42a51264a05b62cabda38aebcafbf841","file_size":72945,"type":"image/png"}],"allow_singular_disclosure_at":"2017-01-12T20:45:31.476Z","allow_singular_disclosure_after":-149706404.89982295,"singular_disclosure_allowed":true,"vote_count":7,"voters":["madrobot","eveeez","khizer47","japz","spetr0x","dolph1n","bbisawdr"],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1230042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2016-10-03T21:13:13.161Z","updated_at":"2016-10-03T21:13:13.161Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1236156,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2016-10-06T19:42:04.414Z","updated_at":"2018-02-28T13:10:47.435Z","additional_data":{"added_weaknesses":[{"id":60,"name":"Cross-site Scripting (XSS) - Generic"}],"removed_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}]},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1236157,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-06T19:42:30.522Z","updated_at":"2016-10-06T19:42:30.522Z","additional_data":{"old_severity":null,"new_severity":"Medium (6.5)","old_severity_id":null,"new_severity_id":511},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1236159,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. While actually a duplicate of an internal finding this is the first external report.\n\nWe'll work together with Collabora to speed up the resolution.","automated_response":false,"created_at":"2016-10-06T19:43:50.950Z","updated_at":"2016-10-06T19:43:50.950Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1241674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, just an additional.\nThere's a way to bypass Content-Security-Policy when load script from src by using shared link (from public javascript file)\n\n## PoC\n### shared js file\n`http://192.168.200.117/nextcloud/index.php/s/dFZ44cotNhREbAl`\n### test.odt file\n```\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n\u003ctitle\u003eBypass CSP\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ch1\u003eNextCloud CSP\u003c/h1\u003e\n\u003cscript src=\"/nextcloud/index.php/s/dFZ44cotNhREbAl/download\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```","automated_response":false,"created_at":"2016-10-11T08:10:54.816Z","updated_at":"2016-10-11T08:10:54.816Z","actor":{"username":"unknowns132","cleared":false,"url":"/unknowns132","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":127155,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/127/155/e7d749e31679cd7fdda6f939942d5ddb3b6e486b/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135216Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cafdf33290ac036276cdc80d8787e527bd2618e55e9d78aaaeb66ff572376a16"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1362580,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved with the newest richdocuments app available from https://apps.nextcloud.com/apps/richdocuments – sadly we cannot control any apps hosted on apps.owncloud.com which is used by versions before 11. Thus this patched version is only available for people using the newest Nextcloud release.","automated_response":false,"created_at":"2016-12-13T20:44:53.711Z","updated_at":"2016-12-13T20:44:53.711Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"unknowns132","url":"/unknowns132"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1362584,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Since this is not part of the bundled release this unfortunately at the moment doesn't qualify for a monetary reward, as per our bounty brief:\n\n\u003e Bugs in the latest published Nextcloud server software (Download / Source Code) (**note that \"apps\" you enable from the appstore are not necessarily bundled. Only the one from the \"Not enabled\" category**)\n\nWe anyways appreciate the report and would like to thank you for reporting this to us! Thank you! :)","automated_response":false,"created_at":"2016-12-13T20:45:27.822Z","updated_at":"2016-12-13T20:45:27.822Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1362585,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-13T20:45:31.455Z","updated_at":"2016-12-13T20:45:31.455Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1416888,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-12T20:45:39.450Z","updated_at":"2017-01-12T20:45:39.450Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}