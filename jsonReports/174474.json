{"id":174474,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQ0NzQ=","url":"https://hackerone.com/reports/174474","title":"Cookie Injection at 'harvestapp.com'","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-07T09:52:01.624Z","submitted_at":"2016-10-07T09:52:01.624Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zuh4n","url":"/zuh4n","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-24T11:03:01.958Z","bug_reporter_agreed_on_going_public_at":"2017-02-22T11:02:52.770Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello guys,\n\n**_Details:_**\nWell, initially I was testing for CRLF (Carriage Return Line Feed) Injection, but how turned out, I was able to inject cookie without CRLF, just via # value at HTTP Request.\n\n**_PoC:_**\nAttacker able to inject new cookie from any application place, e.g.\n`https://testerovusera.harvestapp.com/people/1412277/edit#NewLocalCookieKey=NewLocalCookieValue`\nin this case cookie will be created to following path, and will be valid only there: _/people/1412277/_\n**but**, it could be bypassed, if append root application path, e.g.\n`https://testerovusera.harvestapp.com/people/1412277/edit#NewGlobalCookieKey=NewGlobalCookieValue;path=/;/`\n{F126502}\n\n**_Attacking scenario:_**\nThis vulnerability perfectly could be used in combination with other vulnerabilities:\n- XSS thru Cookie;\n- Session Fixation;\n- CSRF protection bypass\n\n**_Recommendation:_**\nProperly validate what is going to cookie jar\n\nThank you,\nStas","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":126502,"file_name":"NewCookie.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/126/502/939698b356e4cdc87ee7d275b3580dfb1db47f06/NewCookie.png?response-content-disposition=attachment%3B%20filename%3D%22NewCookie.png%22%3B%20filename%2A%3DUTF-8%27%27NewCookie.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135228Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8c6616ac3e738a4b8064ed5ec4adb6811f34707867f81fe27c96a7c5e6f2cc5b","file_size":17577,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-24T11:02:52.804Z","allow_singular_disclosure_after":-143606975.5711548,"singular_disclosure_allowed":true,"vote_count":14,"voters":["drsniper","b6117130df17feef13481e3","bugdiscloseguys","madrobot","eveeez","ak1t4","r0t","alfredsaonoy","japz","spetr0x","and 4 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1237297,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi Stas,\n\nVery nice finding! I'm trying to understand the extend and implications of this and how it might affect us. Could you elaborate a bit more when you say?:\n\n\u003e XSS thru Cookie;\n Session Fixation;\nCSRF protection bypass\n\nI'm not able to overwrite the session cookie and I'm not sure how it might be used in combination with a XSS or CSRF attack.\n\nBest regards,\nJorge","automated_response":false,"created_at":"2016-10-07T14:52:45.412Z","updated_at":"2016-10-07T14:52:45.412Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1237459,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @jorgeleria \nSo, here is my result after short investigation: I was able to inject `production_access_token` and `_harvest_sess` cookies to specific page (in my case it's projects page), but after my injection, I'm not able to visit this page any more :D. To solve this issue - need to clean all (or just injected) cookie.\n\n**_PoC Request:_**\n`https://testerovusera.harvestapp.com/people#_harvest_sess=testValue;path=/projects/;/\u0026production_access_token=testValue;path=/projects/;/`\n\nAbout XSS, it's hard to say you now, because I need to find some particular place (page / event / action) where cookie passes thru the code, and there break the code, and create XSS PoC.\n\nLet me know if you need more info :)\n\nThank you,\nStas","automated_response":false,"created_at":"2016-10-07T16:19:59.779Z","updated_at":"2016-10-07T16:19:59.779Z","actor":{"username":"zuh4n","cleared":false,"url":"/zuh4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":126562,"filename":"NewCookie_harvest.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/126/562/d88a3e8dc4eba0f37bbac83e17f509c56c039298/NewCookie_harvest.png?response-content-disposition=attachment%3B%20filename%3D%22NewCookie_harvest.png%22%3B%20filename%2A%3DUTF-8%27%27NewCookie_harvest.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135228Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=644903bfb51a70dba6d1f26ca55cc05bb8261321cc6f90670109e4b04fa22d6e"}],"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1237497,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for the additional info! I'm moving it to triage.\nI'll contact you as soon as I have some news or we deploy a fix.\n\nCheers,\nJorge","automated_response":false,"created_at":"2016-10-07T16:44:39.175Z","updated_at":"2016-10-07T16:44:39.175Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1280671,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Stas,\n\nThanks for your patience, this one should be fixed! \nCould you check if you are able to reproduce it?\n\nRegards,\nJorge","automated_response":false,"created_at":"2016-11-02T16:29:42.568Z","updated_at":"2016-11-02T16:29:42.568Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zuh4n","url":"/zuh4n"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1280982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Jorge,\n\nYes, I confirm that issue no longer reproducible!\n\nStas","automated_response":false,"created_at":"2016-11-02T19:27:30.214Z","updated_at":"2016-11-02T19:27:30.214Z","actor":{"username":"zuh4n","cleared":false,"url":"/zuh4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1351230,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","automated_response":false,"created_at":"2016-12-08T17:00:17.981Z","updated_at":"2016-12-08T17:00:17.981Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"zuh4n","url":"/zuh4n"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1351266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello guys. \nReally appreciate bounty. But to be honest a bit confused due to amount.. Especially because of impact..\n\nStas","automated_response":false,"created_at":"2016-12-08T17:16:24.841Z","updated_at":"2016-12-08T17:16:24.841Z","actor":{"username":"zuh4n","cleared":false,"url":"/zuh4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1351324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi zuh4n,\n\nMy bad, I missed the smily face when you said:\n\n\u003e I was able to inject production_access_token and _harvest_sess cookies to specific page (in my case it's projects page), but after my injection, I'm not able to visit this page any more :D\n\nWhen you said `I'm not able to visit this page any more` it is because the injection worked for that path, and this means that a session injection was possible.\n\nWe are going to discuss the bounty amount having in mind the info that was missing. I'll be back to you soon.\n\nBest regards,\nJorge\n","automated_response":false,"created_at":"2016-12-08T17:38:34.994Z","updated_at":"2016-12-08T17:38:34.994Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1351671,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"After thinking about the risks we decided to duplicate the amount, thanks!","automated_response":false,"created_at":"2016-12-08T19:28:11.708Z","updated_at":"2016-12-08T19:28:11.708Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"zuh4n","url":"/zuh4n"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1353306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok. Thanks a lot.\n\nStas","automated_response":false,"created_at":"2016-12-09T09:07:10.609Z","updated_at":"2016-12-09T09:07:10.609Z","actor":{"username":"zuh4n","cleared":false,"url":"/zuh4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1498911,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Don't you mind?","automated_response":false,"created_at":"2017-02-22T11:02:52.784Z","updated_at":"2017-02-22T11:02:52.784Z","first_to_agree":true,"actor":{"username":"zuh4n","cleared":false,"url":"/zuh4n","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/842/23cf96d3ed0a861ab4eb6e09baea9be0e58f8a8f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1561200,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-24T11:03:01.982Z","updated_at":"2017-03-24T11:03:01.982Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}