{"id":175397,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzUzOTc=","url":"https://hackerone.com/reports/175397","title":"Subdomain Takeover of Brave.com","state":"Closed","substate":"duplicate","severity_rating":"none","readable_substate":"Duplicate","created_at":"2016-10-12T14:49:13.371Z","submitted_at":"2016-10-12T14:49:13.371Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sahiltikoo","url":"/sahiltikoo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-14T17:33:23.573Z","bug_reporter_agreed_on_going_public_at":"2016-10-12T18:40:35.530Z","team_member_agreed_on_going_public_at":"2016-10-14T17:33:23.545Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nHey!\n\nI want to inform you about sub domain takeover issue i.e. when I did your DNS enumeration i came across :-\n\nIp Address        Target Name\n----------        -----------\n151.101.9.7       www.brave.com\n151.101.9.7       prod.p.ssl.global.fastly.net\n151.101.9.7       prod.p.ssl.global.fastlylb.net\n\nExcept the first domain name , the rest two CName point to an unclaimed domain on fastly.com(CDN) that when opened show :-\n\nFastly error: unknown domain: prod.p.ssl.global.fastly.net. Please check that this domain has been added to a service\n\nthe above error indicates that the above address is not in use and can be claimed by an attacker by making an account on fastly.com . \n\n\n\n## Products affected: \n\n *  Brave's sub domain \n\n## Steps To Reproduce:\n\n * Steps:- Open the above CName ( prod.p.ssl.global.fastly.net.) , as the error is thrown , it indicates the above address can be claimed by creating an account on fastly and giving this as the Cname for your own domain.\n\n## Supporting Material/References:\n\n  * I have added POC image for the DNS enumeration i did. just have a look .\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":127440,"file_name":"poc(brave).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/127/440/3ca081fb239265deacac5fc298af96b55f5f5802/poc%28brave%29.png?response-content-disposition=attachment%3B%20filename%3D%22poc%2528brave%2529.png%22%3B%20filename%2A%3DUTF-8%27%27poc%2528brave%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY5I5ZOTN%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135254Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQCqf43kV8RTzzmWR1TXeEdpx%2Fd5zGOFNpfZDgSM2xJuCQIhAMLYAxjZR7PGO9btJ9wGFbOqf%2FTbE2pC%2FdkQgyPDWZD8KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzmKazqBIClFAMqc2Iq1wNPV39BSW59qP%2ByHsmBjxY6m%2Fb7a6U5448PKOSe8dVf6ZB9c%2BLac%2F0Gz8ADXdDYKsvWZv%2FAmBj5%2FhHzWjVphb45t9jx%2BhpJI0AITzRmRN5aq7TLFOZDfehY6xr7qR34eKZAu9XJrbi4QdAu%2BNSUgERhmM4muMj19K4msZk8sFVbAKLF%2BU6gGnywSDktUJmbSxfnY6ZesCS5elWm1qPvYsKCbrl5y57ovXEaa7NAn6XfLDrVTRtpY8qRzPQbURfe%2FnNfBCEGQCwCuB8zQszv%2B2O4z6L6fFCLSm2gccXmLLJqlgBN7EwqRjH0XLKpn1vWKBfmNtQJMcfcBOgesSBjohFRDqs9VtzSm8Ar%2FZ3tQRyj3E5FFBVh7SFXfbH0zIPhcJnR7J%2Ft20n0T0BoFfeC4Lh04EDdGi1xF35UayBRbz0euxaVcKV0UA%2BktOyHmbRzgaonWDeZCOaJtjFZCGnWooRLI6KrYUmAIMrnyQoKS2q8DQKxvweDK7%2FuWfo1ovNRy%2BMy3v8N%2B%2B6q1M2DXNkYeXZoalrKF%2BzGC2C%2FRVd1z2LoHJiVHopIG7T4Lyax%2BX9LY1Z9oVqxPxTo9SgiI1kD69%2Bl5MKWzogETScQuH%2Bvi36SPh1QbdmYvwgw5O6QiwY6pAEabkl2EyHSmga%2FQVBclzYljmd0Pvwag9ITi%2BNlOViZyzeqV8k%2F8Q8ny0OOVtCp3iCSdWDf1LHd%2BqKtTjKS7CIODHKRsg4m3sx7QNZBHT5H00n5U2ZVgN4N9m3YxiNqVHw1I0Jv0KF1%2BS2XFhkFHuxBokXIzihowuz57pmo5yGw3bX16HVqCrlEZdpJDLSrVWPAr55aHcggcNaCjNyYlZGc9VtWCw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=18747717e80ddebf37084c2995484bf7c2c8bc5b00cd393fad67b130d1d6dd2f","file_size":14022,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["sameerphad72","bugdiscloseguys","japz","spetr0x","prospere","dyabla"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1244104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FIX?\n\n    You can delete the CNAME entry for  prod.p.ssl.global.fastly.net\n\nor..\n\n    You can have make it point to the actual site, in short use it.\n","automated_response":false,"created_at":"2016-10-12T14:55:24.477Z","updated_at":"2016-10-12T14:55:24.477Z","actor":{"username":"sahiltikoo","cleared":false,"url":"/sahiltikoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1244579,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"already reported","automated_response":false,"created_at":"2016-10-12T18:32:11.338Z","updated_at":"2016-10-12T18:32:11.338Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1244601,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"can you?","automated_response":false,"created_at":"2016-10-12T18:40:35.548Z","updated_at":"2016-10-12T18:40:35.548Z","first_to_agree":true,"actor":{"username":"sahiltikoo","cleared":false,"url":"/sahiltikoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/101/bb9810dfd97d2b1ffaac9911d7d6fbc72aad9e2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bridiver your call on whether to disclose this. if so, please add a comment explaining why this isn't an issue.","automated_response":false,"created_at":"2016-10-13T19:20:48.557Z","updated_at":"2016-10-13T19:20:48.557Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not an unclaimed domain on fastly.com, it is a shared endpoint for the CDN. When you go to brave.com the browser sends a Host header that allows Fastly to map the request to our configured service for brave.com. This is how CDNs work and allows Fastly to manage the the actual IP that is returned to the client based on the location of the request. You cannot claim prod.p.ssl.global.fastly.net and we clearly are using it because it responds with the brave.com website when you access it by going through brave.com","automated_response":false,"created_at":"2016-10-14T08:07:17.002Z","updated_at":"2016-10-14T08:07:17.002Z","actor":{"username":"bridiver","cleared":false,"url":"/bridiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247309,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-14T08:08:09.828Z","updated_at":"2016-10-14T08:08:09.828Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":1766,"new_severity_id":2113},"actor":{"username":"bridiver","cleared":false,"url":"/bridiver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247970,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-14T17:33:23.561Z","updated_at":"2016-10-14T17:33:23.561Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1247971,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-14T17:33:23.586Z","updated_at":"2016-10-14T17:33:23.586Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300383,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-11-15T14:11:39.852Z","updated_at":"2016-11-15T14:11:39.852Z","additional_data":{"duplicate_report_id":182241},"actor":{"username":"mvbk1991","cleared":false,"url":"/mvbk1991","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}