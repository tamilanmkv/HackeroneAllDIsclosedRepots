{"id":189378,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODkzNzg=","url":"https://hackerone.com/reports/189378","title":"Unauthenticated Stored XSS on \u003cany\u003e.myshopify.com via checkout page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-12-08T02:57:40.937Z","submitted_at":"2016-12-08T02:57:40.937Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-16T21:19:38.691Z","bug_reporter_agreed_on_going_public_at":"2016-12-16T21:19:38.657Z","team_member_agreed_on_going_public_at":"2016-12-16T21:07:17.299Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nI have found a stored cross site scripting vulnerability on `\u003cany\u003e.myshopify.com` through customer's first name in the checkout page after the order is completed.\n\n#Details:\nWhile processing an order on `checkout.shopif.com` customers are asked to enter their first name , last name , address details ..etc.\nIt's been found that the mentioned fields does not accept any HTML tags , so if you entered something like `\u003cscript\u003ealert(2);\u003c/script\u003e` , it will be rejected and you'll see a message saying `cannot contain HTML tags` . \nHowever, for some reason the only tag that you can include and it won't be rejected is `\u003chtml\u003e` tag itself :D \nSo , something like `\u003chtml onmouseover=alert(1)\u003e` will be accepted.\n\nAfter completing the order you'll land at a **thank** page saying that the order was confirmed , the XSS vulnerability lies in that page due to not sanitizing the first name of the customer inside the `\u003ctitle\u003e` tag.\n\n#Steps to reproduce:\n1. As an admin create a product with $0 price and $0 taxes on shipping so that you don't have to to enter any credit card details (the price doesn't matter , it's just to make testing easier).\n2. As a user go to the product you created and buy it.\n3. You'll be redirected to a page in `checkout.shopify.com` asking you to enter your details.\n4. In the first name field enter `\u003c/title\u003e\u003c/head\u003e\u003chtml onmouseover=alert(2)\u003e` .\n5. Fill the other fields then click **Continue to shipping method** --\u003e **Continue to payment method** --\u003e **Complete order** \n6. XSS will trigger on `checkout.shopify.com` , to get the payload executed on `\u003cyour_store\u003e.myshopify.com` , just go to `\u003cyour_store\u003e.myshopify.com/0/checkouts/\u003ccheckout_id\u003e/thank_you`\n\nHere is a live PoC: `https://zh5402.myshopify.com/14372648/checkouts/5e566284338e71d6adc542b6567b4cf0/thank_you`\n{F141546}\n\n\n#Impact:\nThrough this vulnerability an attacker is able to execute arbitrary JavaScript at `\u003cany\u003e.myshopify.com` on admins and any other users to perform malicious actions such as fetching the CSRF token and using it to perform malicious requests , stealing sensitive information ..etc.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":141546,"file_name":"xss_shopify.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/141/546/fa27d6a4d9449a2ea7364e8ba5930261a7ae427c/xss_shopify.png?response-content-disposition=attachment%3B%20filename%3D%22xss_shopify.png%22%3B%20filename%2A%3DUTF-8%27%27xss_shopify.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135715Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6c50e191e416350c34c6fdc528c54cde5a632b476e490cfbd919bc7feeb0c266","file_size":60421,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["drsniper","bogdantcaciuc","flashdisk","mpz","eveeez","malcolmx","faisalahmed","xhzeem","japz","spetr0x","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1352252,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.\n\n","automated_response":false,"created_at":"2016-12-08T22:28:19.552Z","updated_at":"2016-12-08T22:28:19.552Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1358369,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently deployed a fix for this issue.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2016-12-12T12:48:47.620Z","updated_at":"2016-12-12T12:48:47.620Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1370274,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","automated_response":false,"created_at":"2016-12-16T21:07:06.523Z","updated_at":"2016-12-16T21:07:06.523Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370275,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-16T21:07:17.317Z","updated_at":"2016-12-16T21:07:17.317Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370301,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-16T21:19:38.672Z","updated_at":"2016-12-16T21:19:38.672Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1370302,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-12-16T21:19:38.704Z","updated_at":"2016-12-16T21:19:38.704Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}