{"id":191884,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTE4ODQ=","url":"https://hackerone.com/reports/191884","title":"Remote Unrestricted file Creation/Deletion and Possible RCE.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-17T06:45:02.720Z","submitted_at":"2016-12-17T06:45:02.720Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zigoo0","url":"/zigoo0","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/225/337418e0c96cd26a1216020da6829f78411881f6_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-26T21:13:08.032Z","bug_reporter_agreed_on_going_public_at":"2017-01-27T21:13:03.813Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Gents,\n\nDuring my research on Twitter BBP, I found below domain name: **Reverb.twitter.com**\n\n###Background:\n\u003eWe worked with Twitter to develop TwitterReverb, an application that reveals how conversations arise and reverberate across the entire Twitter landscape. The custom application allows visitors to reveal patterns in Twitter activities related to keywords, hashtags, topics, people, and individual tweets through the use of a backend administrative tool that dynamically generates a custom data visualization.\n\u003e\"TheRealPeriscopic\" -\u003e https://www.youtube.com/watch?v=bm5eyTeBBDE\n\n###Description:\nReverb.twitter.com (also uses **reverb.guru**) is vulnerable to unauthenticated remote file Creation/Deletion and Possible RCE vulnerability.\nBelow URL is an API file used to generate png images based on 3 given inputs:\nhttps://reverb.twitter.com/api/actions/saveImage.php\n\nThe 3 given inputs are: **image**=SomeContent\u0026**filename**=test\u0026**extension**=png\n\nIt was found that the file doesn't require authentication or authorization in order to be able to initiate the API call to generate a new png file. it doesn't even validate the created file name.\n\nIn normal scenario, to use the file you have to send a POST request as below:\nhttps://reverb.twitter.com/api/actions/saveImage.php\n**POST:**\nimage=SomeContent\u0026filename=test\u0026extension=png\n\nthe a/m example should create a png file named as \"preview-test.png\" in below directory:\n/var/www/html/view/data/image/preview-test.png\n\n**Example of normal file operation output:**\nhttps://go.reverb.guru/view/data/image/preview-069772811858678284.png\n\nSince I've the ability to choose the file name \u0026 ext, i've manipulated the file ext to be php and the file name to be /../../zigo (Directory Traversal) which allowed me escape the \"preview-\" added to the filename and to escape the uploads directory to create a file as below:\n\nhttps://reverb.twitter.com/api/actions/saveImage.php\n**POST:**\nimage=SomeContent\u0026filename=/../../zigoo\u0026extension=php\n\n**POC:** https://reverb.twitter.com/view/data/zigoo.php\n**PATH:** /var/www/html/view/data/zigoo.php\n\nIt is noticed that user input under the parameter \"image\" is passed to some function that would treat it as image stream and convert it as well to a png image. I imagine that backend code that handles the input of parameter \"image\" looks like:\n\n\u003e\u003c?php\n $data = $_POST['image'];\n $im = imagecreatefromstring($data);\n if ($im !== false) {\n    imagepng($im);\n    imagedestroy($im);\n }\n else {\n    exit;\n }\n\u003e ?\u003e\n\nI've wrote a python script (Attached as: F144335) to simulate the same scenario, unfortunately i couldn't trigger the RCE. BUT ......\n\n**Vulnerability Consequences:**\n1. Since i can control the filename, ext, and file content, the RCE is still possible if given enough time to research and try, but i always thought that FileDescriptor would have reported it if i delayed :D\n2. An attacker can submit the same request over and over with large file size, even if the files contents are not understood, it is still consuming the server space which would cause the server to go down (Space Exhaustion, refer to function **DDOS()** in the attached python file)\n3. File deletion and defacement is also possible since Directory traversal were found. for example, an attacker can submit the file name as: **../../../../index.php** which will replace the main page of the vulnerable site!\n4. The above mentioned scenario could also be used to cause the **TwitterReverb** application to stop working permanently by overwriting the file **\"api/twitter/twitterLogin.php\"** which is responsible for the authentication of application users.\n5. Also directory traversal scenario could be used to create \".htaccess\" file at any directory which would cause all the pages inside that directory to stop working!\n\n**How to Fix:**\n1. Set proper authentication/authorization on the affected file.\n2. Filename, ext \u0026 input content should be validated before being submitted to the backend server. for example the file ext should be restricted to '.png' only \u0026 filename should never contain dots or other special characters.\n3. A filesize limit must be applied on the created files to avoid DDOS attacks via exhausting the server disk space.\n\nKindly note that the affected server holds large amount of Twitter users authentication tokens for the TwitterRiverb application.\n\nAnd finally, below is a POC video to demonstrate the vulnerability and how to reproduce it.\n\n**POC:** https://youtu.be/OPlexp-1XxU\n\nThank you and have a nice day.\n","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":144335,"file_name":"RCE-Tester.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/144/335/e14f3a0267584f426384a7072cd27c6e5bb7c4fe/RCE-Tester.py?response-content-disposition=attachment%3B%20filename%3D%22RCE-Tester.py%22%3B%20filename%2A%3DUTF-8%27%27RCE-Tester.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bcd28eab06888c2ae8783f2bea7c53d7034829c0b74ec2550ea45d63052665c6","file_size":2318,"type":"text/x-python"},{"id":144341,"file_name":"Screen_Shot_2016-12-17_at_8.09.12_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/144/341/6316099747a4c583bbab4f33e511a7dc8f8505a4/Screen_Shot_2016-12-17_at_8.09.12_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-12-17_at_8.09.12_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-12-17_at_8.09.12_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135753Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a1312da9aa755228a0b05de861ca8afbcbf0ecf200d725c2f2cfcb679c1e7c72","file_size":186798,"type":"image/png"}],"allow_singular_disclosure_at":"2017-02-26T21:13:03.862Z","allow_singular_disclosure_after":-145817089.25536022,"singular_disclosure_allowed":true,"vote_count":81,"voters":["zoom7","delimitry","sp1d3rs","mohamed-magdi","secator","bobrov","hunter","bogdantcaciuc","bl4de","badcracker","and 71 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1374603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe are looking into this and will update you when we have more informatoin.","automated_response":false,"created_at":"2016-12-19T18:41:40.398Z","updated_at":"2016-12-19T18:41:40.398Z","actor":{"username":"bugtriage-jason","cleared":false,"url":"/bugtriage-jason","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1375188,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-12-19T21:11:43.726Z","updated_at":"2016-12-19T21:11:43.726Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1378339,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-21T01:12:56.807Z","updated_at":"2016-12-21T01:12:56.807Z","additional_data":{"old_severity":"Critical (10.0)","new_severity":"Low","old_severity_id":14365,"new_severity_id":15205},"actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1385630,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI know you still need time to investigate this report which is fine of course, but may i ask why the report severity were changed to \"Low\"?\nThank you.","automated_response":false,"created_at":"2016-12-26T02:55:01.040Z","updated_at":"2016-12-26T02:55:01.040Z","actor":{"username":"zigoo0","cleared":false,"url":"/zigoo0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/225/337418e0c96cd26a1216020da6829f78411881f6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1424022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nKind reminder, Any updates?\nThanks.","automated_response":false,"created_at":"2017-01-17T01:51:56.293Z","updated_at":"2017-01-17T01:51:56.293Z","actor":{"username":"zigoo0","cleared":false,"url":"/zigoo0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/225/337418e0c96cd26a1216020da6829f78411881f6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1425471,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-01-17T18:45:11.955Z","updated_at":"2017-01-17T18:45:11.955Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zigoo0","url":"/zigoo0"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1425481,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zigoo0, the severity was set to 'low' because of a few factors. First, the service itself is not in scope for our program. Second, we were unable to produce an RCE on this system. Third, the system itself is isolated from any high sensitivity data.\n\nThank you for bringing this issue to our attention. Unfortunately, this report does not fall in scope for a monetary reward at this time. However, you will still be listed in our Hall of Fame. Thanks again.","automated_response":false,"created_at":"2017-01-17T18:46:52.310Z","updated_at":"2017-01-17T18:46:52.310Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1431261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, regarding 'the system itself is isolated from any high sensitivity data.' i thought you already noticed from the video POC that the system is responsible of handling an official twitter application and the system holds all the application users tokens!! Even if you can't reproduce an RCE the bug still able to replace files on the server including the index files or the application files itself!!\n","automated_response":false,"created_at":"2017-01-19T21:21:25.818Z","updated_at":"2017-01-19T21:21:25.818Z","actor":{"username":"zigoo0","cleared":false,"url":"/zigoo0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/225/337418e0c96cd26a1216020da6829f78411881f6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1439951,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-01-24T00:57:49.614Z","updated_at":"2017-01-24T00:57:49.614Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1448755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-27T21:13:03.831Z","updated_at":"2017-01-27T21:13:03.831Z","first_to_agree":true,"actor":{"username":"zigoo0","cleared":false,"url":"/zigoo0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/225/337418e0c96cd26a1216020da6829f78411881f6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1506875,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-26T21:13:08.049Z","updated_at":"2017-02-26T21:13:08.049Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}