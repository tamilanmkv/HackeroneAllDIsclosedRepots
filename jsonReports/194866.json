{"id":194866,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTQ4NjY=","url":"https://hackerone.com/reports/194866","title":"Deleting Key-value pair from Frozen HASH or Clearing a Frozen HASH","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2016-12-30T19:24:05.402Z","submitted_at":"2016-12-30T19:24:05.402Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"an0n-j","url":"/an0n-j","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-01-05T16:49:46.236Z","bug_reporter_agreed_on_going_public_at":"2017-01-05T16:49:46.200Z","team_member_agreed_on_going_public_at":"2017-01-05T16:19:50.472Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey!\n\nwhile reviewing mruby for vulnerabilities, I stumble onto a snippet that allow an attacker to delete \"key-value Pair\" from a \"Frozen\" Hash or to clear the \"Frozen\" HASH.\n\nReproduction Step\n=============\n1.) Create a __Hash__ like  h = { \"a\" =\u003e 100, \"b\" =\u003e 200 }\n2.) __Freeze__ this hash\n3.) Now call ___delete___ method with __\"KEY\"__ (the case if you don't know the KEY then you can call ___.keys___ method to obtaine all available KEYS in the HASH) ( or call ___.clear___ method to clear the HASH )\n\nPOC\n===\n\nh = { \"a\" =\u003e 100, \"b\" =\u003e 200 }\nh.freeze\nh.delete(\"a\")\n@output = h\n\nLook at ___h___ you will get remaining values after deletion even if the HASH has been frozen. ( in case of ___h.clear___ you will get empty HASH ).\n\nExplanation\n========\n\nBug is happened because there is no method calling to check weather the HASH is frozen or not in both methods  *mrb_hash_delete*   [hash.c#552](https://github.com/mruby/mruby/blob/master/src/hash.c#L552)  and  *mrb_hash_clear*  [hash.c#619](https://github.com/mruby/mruby/blob/master/src/hash.c#L619)  in https://github.com/mruby/mruby/blob/master/src/hash.c\n\n\nThis bug may come handy to delete details to cause data corruption.\n\nFix\n==\nJust apply   mrb_hash_modify(mrb, self);  \u0026  mrb_hash_modify(mrb, hash);   on line  [555](https://github.com/mruby/mruby/blob/master/src/hash.c#L555)  and  on line  [622](https://github.com/mruby/mruby/blob/master/src/hash.c#L622) respectively.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":148306,"file_name":"Hash.c_BUG.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/148/306/2dab58948f2049138c4a681acf977b81822793e2/Hash.c_BUG.rb?response-content-disposition=attachment%3B%20filename%3D%22Hash.c_BUG.rb%22%3B%20filename%2A%3DUTF-8%27%27Hash.c_BUG.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135858Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7fcd2e394f4149e1fb228238b17479d1e3d0d61b8ccfc515b1b3828595bd2cd3","file_size":65,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-02-04T16:19:50.506Z","allow_singular_disclosure_after":-147735547.73311496,"singular_disclosure_allowed":true,"vote_count":12,"voters":["mpz","supernatural","eveeez","an0n-j","exception","japz","sumit7","spetr0x","muhaddix","0619","and 2 more..."],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1392489,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","automated_response":true,"created_at":"2016-12-30T19:24:05.568Z","updated_at":"2016-12-30T19:24:05.568Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1398877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update ?","automated_response":false,"created_at":"2017-01-04T16:21:08.641Z","updated_at":"2017-01-04T16:21:08.641Z","actor":{"username":"an0n-j","cleared":false,"url":"/an0n-j","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1398940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Due to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","automated_response":false,"created_at":"2017-01-04T16:40:09.668Z","updated_at":"2017-01-04T16:40:09.668Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1399772,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We have opened an issue upstream: https://github.com/mruby/mruby/issues/3370\n\nThis issue does not appear to have any security implications in our environment (where users have full control over the scripts that are executed), and so this issue will most likely not be eligible for a bounty.","automated_response":false,"created_at":"2017-01-04T20:50:58.854Z","updated_at":"2017-01-04T20:50:58.854Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1399774,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-04T20:51:05.393Z","updated_at":"2017-01-04T20:51:05.393Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":16754,"new_severity_id":17465},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1401390,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has been fixed upstream.","automated_response":false,"created_at":"2017-01-05T12:55:43.194Z","updated_at":"2017-01-05T12:55:43.194Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"an0n-j","url":"/an0n-j"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1401391,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-01-05T12:55:49.530Z","updated_at":"2017-01-05T12:55:49.530Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1401460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can we disclose ?","automated_response":false,"created_at":"2017-01-05T13:35:53.902Z","updated_at":"2017-01-05T13:35:53.902Z","actor":{"username":"an0n-j","cleared":false,"url":"/an0n-j","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1401833,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-05T16:19:50.491Z","updated_at":"2017-01-05T16:19:50.491Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1401896,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-05T16:49:46.215Z","updated_at":"2017-01-05T16:49:46.215Z","actor":{"username":"an0n-j","cleared":false,"url":"/an0n-j","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1401897,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-05T16:49:46.251Z","updated_at":"2017-01-05T16:49:46.251Z","actor":{"username":"an0n-j","cleared":false,"url":"/an0n-j","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/099/222/8fb256358976ee24d8bc993c42822d8476f5d816_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}