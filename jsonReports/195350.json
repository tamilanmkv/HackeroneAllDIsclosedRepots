{"id":195350,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUzNTA=","url":"https://hackerone.com/reports/195350","title":"Subdomain takeover on podcasts.slack-core.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-02T19:10:40.111Z","submitted_at":"2017-01-02T19:10:40.111Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"michiel","url":"/michiel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-01-04T21:01:06.238Z","bug_reporter_agreed_on_going_public_at":"2017-01-04T10:44:12.317Z","team_member_agreed_on_going_public_at":"2017-01-04T21:01:06.191Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I noticed `slack-core.com` is used for Slack's call infrastructure. I had never seen that domain before, so I decided to find out what else was running on it. It turned out `podcasts.slack-core.com` was pointing to a Podcast and RSS hosting service called Feed.Press. However, there was no Feed.Press account associated with `podcasts.slack-core.com`, which allowed me to register it and start serving my content from this domain. \n\nNote that since it is not on Slack's root domain, the impact of this vulnerability seems pretty minimal.\n\n# Proof of Concept\nHere we can see `podcasts.slack-core.com` is CNAME'd to `redirect.feedpress.me`:\n\n```plain\nmichiel@msp ~ $ dig podcasts.slack-core.com                                                                                         [2.1.9]\n\n; \u003c\u003c\u003e\u003e DiG 9.10.3-P4-Ubuntu \u003c\u003c\u003e\u003e podcasts.slack-core.com\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 1307\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 512\n;; QUESTION SECTION:\n;podcasts.slack-core.com.\tIN\tA\n\n;; ANSWER SECTION:\npodcasts.slack-core.com. 299\tIN\tCNAME\tredirect.feedpress.me.\nredirect.feedpress.me.\t3599\tIN\tA\t5.135.16.40\n\n;; Query time: 253 msec\n;; SERVER: 8.8.8.8#53(8.8.8.8)\n;; WHEN: Mon Jan 02 14:02:07 EST 2017\n;; MSG SIZE  rcvd: 103\n```\n\nBy creating my own account on [Feed.Press](https://feed.press), I was able to register `podcasts.slack-core.com` as my \"custom domain\" under my Feed.Press account. After it propagated through Feed.Press' systems, I was able to fully control the contents served as http://podcasts.slack-core.com.\n\nSince the domain was dormant, I decided to redirect `/` to https://hackerone.com as a proof of concept. We can see that happening using this `curl` command (note the `Location` header):\n\n```plain\nmichiel@msp ~ $ curl -vv http://podcasts.slack-core.com\n* Rebuilt URL to: http://podcasts.slack-core.com/\n*   Trying 5.135.16.40...\n* Connected to podcasts.slack-core.com (5.135.16.40) port 80 (#0)\n\u003e GET / HTTP/1.1\n\u003e Host: podcasts.slack-core.com\n\u003e User-Agent: curl/7.47.0\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 301 Moved Permanently\n\u003c Server: nginx\n\u003c Date: Mon, 02 Jan 2017 19:06:18 GMT\n\u003c Content-Type: text/html\n\u003c Content-Length: 178\n\u003c Location: https://hackerone.com\n\u003c X-Backend-Server: 172.16.0.53\n\u003c\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e301 Moved Permanently\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ccenter\u003e\u003ch1\u003e301 Moved Permanently\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003enginx\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n* Connection #0 to host podcasts.slack-core.com left intact\n```\n\n# Remediation\nSince the domain is not used anymore, it is recommended to remove the CNAME of `podcasts.slack-core.com` to `redirect.feedpress.me`. \n\nIf you need me to release the domain in Feed.Press itself, let me know and I'll remove it from my account.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-03T10:44:12.368Z","allow_singular_disclosure_after":-147842098.15482837,"singular_disclosure_allowed":true,"vote_count":25,"voters":["philip","jobert","sameerphad72","spam404","hat_mast3r","mpz","global4g","madrobot","supernatural","harry_mg","and 15 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1397055,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-01-03T19:41:58.234Z","updated_at":"2017-01-03T19:41:58.234Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe're looking into this and will keep you updated when we have additional information.","automated_response":false,"created_at":"2017-01-03T21:03:03.180Z","updated_at":"2017-01-03T21:03:03.180Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1397353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys - this was fixed really fast! :) The domain no longer resolves, and therefore this issue is resolved.","automated_response":false,"created_at":"2017-01-03T21:20:54.791Z","updated_at":"2017-01-03T21:20:54.791Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397846,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-04T00:56:20.768Z","updated_at":"2017-01-04T00:56:20.768Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":17062,"new_severity_id":17277},"actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397847,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We've resolved this issue, and are going to issue you a bounty!  Thanks for your report, and happy bug hunting in the future!  \n\nCheers,\nSlack","automated_response":false,"created_at":"2017-01-04T00:57:02.382Z","updated_at":"2017-01-04T00:57:02.382Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Slack"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"michiel","url":"/michiel"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1397848,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-01-04T00:57:08.195Z","updated_at":"2017-01-04T00:57:08.195Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"michiel","url":"/michiel"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1398340,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the fast turnaround!  ","automated_response":false,"created_at":"2017-01-04T10:44:12.340Z","updated_at":"2017-01-04T10:44:12.340Z","first_to_agree":true,"actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399802,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-04T21:01:06.209Z","updated_at":"2017-01-04T21:01:06.209Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399803,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-04T21:01:06.256Z","updated_at":"2017-01-04T21:01:06.256Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}