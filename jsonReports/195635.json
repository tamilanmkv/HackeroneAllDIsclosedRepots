{"id":195635,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTU2MzU=","url":"https://hackerone.com/reports/195635","title":"Video player on ███ allows arbitrary remote videos to be played","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-04T01:53:28.404Z","submitted_at":"2017-01-04T01:53:28.404Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomnomnom","url":"/tomnomnom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-02T17:54:17.966Z","bug_reporter_agreed_on_going_public_at":"2017-08-14T20:22:46.828Z","team_member_agreed_on_going_public_at":"2019-12-02T17:54:17.827Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** A Flash video player hosted on ███████ can be provided with an arbitrary remote XML file via the `url` query string parameter.\n\n**Description:**\nThe Flash video player (http://█████/shared/widgets/popup.asp) uses the `url` query string parameter as an address to fetch an RSS feed type XML document that specifies a video to play, and meta data about that video.\n\nAlthough some restrictions are in place to prevent the use of arbitrary URLs (e.g. a request to `http://████/shared/widgets/popup.asp?url=http://█████████/rss.xml` results in a 403 response code), those restrictions are bypassable by replacing `http://` with `//` in the URL.\n\n## Impact\n\n1. An abitrary video can be played in the player, appearing as though the US Air Force is the source of that video\n2. The title and description of that video are controllable, again appearing as though the US Air Force is the source of that content\n3. The URL pointed to by the 'DOWNLOAD (WMV)' link in the lower left of the player is controllable, and as the download link is in a Flash object there is no 'hover-over' prompt telling the user where the file will be downloaded from. This could be used to trick users into downloading a malicious file under the assumption that it is provided by the US Air Force.\n\n## Step-by-step Reproduction Instructions\n\nA web server has been configured at http://████/ to aid in a proof of concept, and a working PoC can be seen at this URL: http://███████/shared/widgets/popup.asp?url=//████/rss.xml\n\nNote that the video is of a mobility scooter race, the title is set to 'Any title you want', the description is set to 'Any description you want' and clicking the 'DOWNLOAD (WMV)' link downloads a file called `bad.bat` (which is actually harmless in this case).\n\nThe webroot of the server contains the following files:\n\n* http://██████/crossdomain.xml - a permissive crossdomain settings file\n* http://█████████/rss.xml - the XML file containing the video URL and meta data\n* http://████████/video.flv - the video file itself\n* http://████/bad.bat - a placeholder for a malicious file\n\nThese are the only files required for an attacker to exploit this vulnerability. Copies of the `crossdomain.xml` and `rss.xml` are attached, as is a screen recording of the problem being demonstrated.\n\n## Suggested Mitigation/Remediation Actions\n\nWithout seeing the source code it's difficult to know how the `url` parameter is currently being checked, but the workaround's existence suggests some kind of substring checking. It's often a good idea to use a well-tested URL parsing library - which, in theory, should be immune to tricks like using `//` - and compare the domain of the URL to a whitelist instead.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":20,"voters":["daehee","oxecho","jensec","rez0","powerjacobb1","d3f4u17","eveeez","dastan_9408","domssilva","00gway","and 10 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1397909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2017-01-04T01:53:28.542Z","updated_at":"2017-01-04T01:53:28.542Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399633,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-01-04T20:04:50.509Z","updated_at":"2017-01-04T20:04:50.509Z","actor":{"username":"jland","cleared":false,"url":"/jland","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1399634,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-04T20:04:58.901Z","updated_at":"2017-01-04T20:04:58.901Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":17457},"actor":{"username":"jland","cleared":false,"url":"/jland","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello!\n\nIs there anything I can do to help out with this? If possible I'd like to take down the web server used in the POC soon, lest I get hacked myself!\n\nMany thanks,\n\nTomH","automated_response":false,"created_at":"2017-02-09T11:00:03.641Z","updated_at":"2017-02-09T11:00:03.641Z","actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1574664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nI'm afraid I've had to take down the server hosting the files in the example.\n\nPlease let me know if you need me to re-host them somewhere else.\n\nThanks,\n\nTomH","automated_response":false,"created_at":"2017-03-31T07:36:11.581Z","updated_at":"2017-03-31T07:36:11.581Z","actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1760864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello!\n\nIt looks like the page with the problem is now gone/a 404, so does that mean this is resolved?\n\nSorry to be a pest, I really want that spooky badge for my H1 profile :D\n\nMany thanks,\n\nTomH","automated_response":false,"created_at":"2017-06-16T12:54:35.410Z","updated_at":"2017-06-16T12:54:35.410Z","actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1893333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings @tomnomnom,\n\nWe have been advised that the vulnerability you reported has been resolved. Before we close this report, we would appreciate it if you could confirm that the vulnerability no longer exists.\n\nIf we do not receive a response within two weeks, we will send you a second request. If we do not receive a response from you within two weeks of the second notice, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-08-04T15:35:43.832Z","updated_at":"2017-08-04T15:35:43.832Z","actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1893347,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello!\n\nI can confirm that the problem has been resolved. The page in question has been completely removed so the problem no longer exists!\n\nMany thanks,\n\nTomH","automated_response":false,"created_at":"2017-08-04T15:41:28.659Z","updated_at":"2017-08-04T15:41:28.659Z","actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1893352,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported is considered resolved and this report is now closed. If you have any questions, please let me know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-08-04T15:42:17.423Z","updated_at":"2017-08-04T15:42:17.423Z","actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"tomnomnom","url":"/tomnomnom"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1927492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there any chance you'd be willing to disclose this report publicly? No worries if not :)","automated_response":false,"created_at":"2017-08-14T17:56:36.305Z","updated_at":"2017-08-14T17:56:36.305Z","actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1927562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tomnomnom There should be an option for you to request public disclosure, and then someone on the team will handle the request","automated_response":false,"created_at":"2017-08-14T18:17:49.296Z","updated_at":"2017-08-14T18:17:49.296Z","actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1927976,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Whoops! I didn't see that there; it's my first time, so to speak. Thank you","automated_response":false,"created_at":"2017-08-14T20:22:46.866Z","updated_at":"2017-08-14T20:22:46.866Z","first_to_agree":true,"actor":{"username":"tomnomnom","cleared":true,"url":"/tomnomnom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/33kQ4k8aTbTYCQnYQrz2c3dD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6450009,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved for disclosure. Thanks for your participation in the DoD Vulnerability Disclosure Program (VDP). Please follow us on Twitter @DC3VDP.","automated_response":false,"created_at":"2019-12-02T17:54:17.843Z","updated_at":"2019-12-02T17:54:17.843Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6450010,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-02T17:54:17.980Z","updated_at":"2019-12-02T17:54:17.980Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}