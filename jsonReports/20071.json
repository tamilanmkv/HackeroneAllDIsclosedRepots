{"id":20071,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA3MQ==","url":"https://hackerone.com/reports/20071","title":"Missing HSTS header in https://public-api.wordpress.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-07-15T03:53:06.223Z","submitted_at":"2014-07-15T03:53:06.223Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mohaab007","url":"/mohaab007","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/196/6e6b487989347681ee2571abce6ea209f0e2b724_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-08-28T16:02:38.147Z","bug_reporter_agreed_on_going_public_at":"2014-07-29T16:02:29.762Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\n\r\nVulnerable Website:\r\n\r\nhttps://public-api.wordpress.com/oauth2/authorize?client_id=930\u0026response_type=code\u0026blog_id=0\u0026state=05f9c401dedcb9b3f33d82e8b335d1128d24d4cbc4a73903374f952acdfd34f6\u0026redirect_uri=https%3A%2F%2Fvaultpress.com%2Flogin%2F%3Faction%3Drequest_access_token\r\n\r\nI tested the website using firefox add-on called:  Strict Transport Security Detector\r\n\r\nhttps://addons.mozilla.org/en-US/firefox/addon/strict-transport-security-d/\r\n\r\n\r\nHSTS addresses the following threats:\r\n\r\nUser bookmarks or manually types http://example.com and is subject to a man-in-the-middle attacker:\r\n\r\n     HSTS automatically redirects HTTP requests to HTTPS for the target domain\r\n\r\nWeb application that is intended to be purely HTTPS inadvertently contains HTTP links or serves content over HTTP:\r\n\r\n     HSTS automatically redirects HTTP requests to HTTPS for the target domain\r\n\r\nA man-in-the-middle attacker attempts to intercept traffic from a victim user using an invalid certificate and hopes the user will accept the bad certificate:\r\n\r\n     HSTS does not allow a user to override the invalid certificate message\r\n\r\nmore :\r\n\r\nHSTS mitigates the following threats.\r\n\r\n1. HTTP request to an HTTPS site\r\n\r\nFor example: \r\n\r\n1. User wants to visit SecureSite.com\r\n2. User types SecureSite.com into the address bar\r\n3. Browser automatically appends \"http://\" making the following request: http://SecureSite.com\r\n4. Server responds with 301 (permanent redirect) to the following location: https://SecureSite.com\r\n5. Browser makes request to above URL\r\n\r\nThe above scenario allows for a man-in-the-middle attack as a result of the unintentional HTTP request to SecureSite.com. An attacker can leverage a tool such as ssltrip to transparently hijack the HTTP request prior to the 301 redirect. HSTS eliminates this attack window as long as the user previously accessed SecureSite.com over HTTPS and obtained the HSTS header.\r\n\r\nEven with HSTS enabled, a user's initial request to SecureSite.com would remain unprotected from attacks. As a result, both Chrome and Mozilla introduced HSTS preload lists. If SecureSite.com is on Chrome's HSTS preload list, a freshly installed Chrome browser will only allow secure connections to that site, even if the user never accessed it before.\r\n2.  Insecure link referencing an HSTS enabled site\r\n\r\nFor example:\r\n1. Forum.com includes a link to http://SecureSite.com\r\n2. HSTS will automatically convert the link to HTTPS for the HSTS-enabled site\r\n3. Invalid Certificate\r\n\r\nThe following would be considered invalid certificates:\r\n- Self-signed and/or untrusted CA signed certificate\r\n- Expired\r\n- Wrong name specified\r\n\r\n\r\n\r\nreferences:\r\n\r\nhttp://blog.nvisium.com/2014/04/is-your-site-hsts-enabled.html\r\n\r\nhttps://www.owasp.org/index.php/HTTP_Strict_Transport_Security#Threats\r\n\r\nhttp://www.chromium.org/sts\r\n\r\nhttps://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security\r\n\r\nhttps://www.owasp.org/index.php/Test_HTTP_Strict_Transport_Security_(OTG-CONFIG-009)","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-28T16:02:30.436Z","allow_singular_disclosure_after":-224719122.39595824,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":97558,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi - \n\nThanks for the report.  While we agree that adding HSTS headers is the best thing to do, it's not widely supported on WordPress.com.  We should be able to resolve this in the future, but for the time being we will not be adding them. ","automated_response":false,"created_at":"2014-07-29T15:58:08.109Z","updated_at":"2014-07-29T15:58:08.109Z","actor":{"username":"bazza","cleared":false,"url":"/bazza","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/920/2f930cad1bfd0c7db0b313a818033aa6f69dec13_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":97561,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"can we disclose it?\n\nthanks","automated_response":false,"created_at":"2014-07-29T16:02:29.778Z","updated_at":"2014-07-29T16:02:29.778Z","actor":{"username":"mohaab007","cleared":false,"url":"/mohaab007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/196/6e6b487989347681ee2571abce6ea209f0e2b724_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":116744,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-08-28T16:02:38.174Z","updated_at":"2014-08-28T16:02:38.174Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}