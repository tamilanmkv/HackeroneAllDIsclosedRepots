{"id":202781,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDI3ODE=","url":"https://hackerone.com/reports/202781","title":"Chained Bugs to Leak Victim's Uber's FB Oauth Token","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-02-02T06:30:03.484Z","submitted_at":"2017-02-02T06:30:03.484Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngalog","url":"/ngalog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-01-25T17:56:43.040Z","bug_reporter_agreed_on_going_public_at":"2017-04-06T23:42:36.373Z","team_member_agreed_on_going_public_at":"2019-01-25T17:56:42.853Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"7500.0","formatted_bounty":"$7,500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":381,"voters":["danielmgm","pmnh","delimitry","whoareme","j4v40n654n","canarinho_pistola","nytr0gen","arneswinnen","checkm50","msultan","and 371 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1459870,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-02-02T23:18:28.189Z","updated_at":"2017-02-02T23:18:28.189Z","actor":{"username":"alexg-uber","cleared":false,"url":"/alexg-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471886,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-02-08T17:19:05.489Z","updated_at":"2017-02-08T17:19:05.489Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ngalog","url":"/ngalog"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1473356,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-02-09T01:49:54.269Z","updated_at":"2017-02-09T01:49:54.269Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-02-09T15:11:44.185Z","updated_at":"2017-02-09T15:11:44.185Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1486117,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-02-15T00:34:40.897Z","updated_at":"2017-02-15T00:34:40.897Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"bounty_amount":"7500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"ngalog","url":"/ngalog"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1486120,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-02-15T00:37:43.704Z","updated_at":"2017-02-15T00:37:43.704Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1500870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-02-23T06:56:55.875Z","updated_at":"2017-02-23T06:56:55.875Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1588252,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-06T23:42:36.395Z","updated_at":"2017-04-06T23:42:36.395Z","first_to_agree":true,"actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4038365,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-25T17:55:19.939Z","updated_at":"2019-01-25T17:55:19.939Z","additional_data":{},"actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4038375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-25T17:56:32.037Z","updated_at":"2019-01-25T17:56:32.037Z","actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4038378,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-25T17:56:42.936Z","updated_at":"2019-01-25T17:56:42.936Z","actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4038379,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-01-25T17:56:43.065Z","updated_at":"2019-01-25T17:56:43.065Z","actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4041423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-25T22:02:34.064Z","updated_at":"2019-01-25T22:16:21.335Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":13900,"category":"team","content":"The Facebook OAuth application was misconfigured to allow any URL that followed the `https://auth.uber.com/login?*` format to be provided as a `redirect_uri`. By taking advantage of this, @ngalog was able to discover that the `next_url` parameter could be added to the `redirect_uri` allowing it to be chained further. Next, @ngalog found that the `https://login.uber.com/logout` endpoint would redirect based on the Referer header, making it possible to chain together another redirect. By piecing this together, @ngalog was able to provide us with an awesome single-URL PoC which would:\n\n1. Prompt OAuth authorization on `facebook.com`\n2. Redirect to `https://auth.uber.com/login?next_url=https://login.uber.com/logout` from Facebook\n3. Redirect to `https://login.uber.com/logout` from `auth.uber.com`\n4. Redirect to attacker site from Referer header and return the token\n\nWhen combined, this would have allowed for a full account takeover and was a very creative and cool bug.\n\nNice work, @ngalog!","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":280708,"username":"joel-uber","name":"Joel Margolis","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-05-21T22:39:17.047Z","url":"https://hackerone.com/joel-uber","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}