{"id":203658,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDM2NTg=","url":"https://hackerone.com/reports/203658","title":"Restricted file access when it exists in old versions of task or wiki document","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2017-02-05T20:01:34.759Z","submitted_at":"2017-02-05T20:01:34.759Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"denispugachev","url":"/denispugachev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-06T12:04:20.169Z","bug_reporter_agreed_on_going_public_at":"2017-02-06T12:02:12.489Z","team_member_agreed_on_going_public_at":"2017-02-06T12:04:20.126Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"mongoose\n\nHey! I think there is strange access rules for restricted file.\n\n### Steps to reproduce:\n1. Load by User1 file and set it access level \"No one\" (file Id for example 12)\n2. Make wiki with text `{F12}` by User1\n3. Edit new wiki page (change all text or delete) by User1\n4. Try to access file from User2: http://phabricator.dev/F12 - User2 has access to file even if it has \"No\n one\" access level.\n\nIt happens because `{F12}` exists in old versions of wiki page and User1 can't do anything to hide his file only if he will restrict view access to entire wiki page. I think access level to file should be evaluated by current version of document, not older.\n\nIt can be reproduced also in tasks.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["denispugachev","spetr0x","mr_seven"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1464165,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This is expected. Old versions of the wiki page (or task description, or whatever else) can always be viewed, and might not make sense if you couldn't see files embedded on them.\n\nYou can review which objects a file is attached to in the \"Attached\" tab of the file in the Files application.","automated_response":false,"created_at":"2017-02-05T20:17:56.294Z","updated_at":"2017-02-05T20:17:56.294Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the answer!\n\nWhere can I report the simple bugs (not security) found in Phabricator?","automated_response":false,"created_at":"2017-02-06T05:37:20.220Z","updated_at":"2017-02-06T05:37:20.220Z","actor":{"username":"denispugachev","cleared":false,"url":"/denispugachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1464803,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On `secure.phabricator.com`: this guide should get you started:\n\nhttps://secure.phabricator.com/book/phabcontrib/article/bug_reports/","automated_response":false,"created_at":"2017-02-06T12:01:43.061Z","updated_at":"2017-02-06T12:01:43.061Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464805,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-06T12:02:12.506Z","updated_at":"2017-02-06T12:02:12.506Z","first_to_agree":true,"actor":{"username":"denispugachev","cleared":false,"url":"/denispugachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1464813,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-06T12:04:20.148Z","updated_at":"2017-02-06T12:04:20.148Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464814,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-06T12:04:20.209Z","updated_at":"2017-02-06T12:04:20.209Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}