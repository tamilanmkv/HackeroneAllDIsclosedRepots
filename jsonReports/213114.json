{"id":213114,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTMxMTQ=","url":"https://hackerone.com/reports/213114","title":"Gitlab.com is vulnerable to reverse tabnabbing via AsciiDoc links. (#3)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-13T16:17:14.804Z","submitted_at":"2017-03-13T16:17:14.804Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-09T19:11:56.301Z","bug_reporter_agreed_on_going_public_at":"2017-05-09T16:35:14.168Z","team_member_agreed_on_going_public_at":"2017-05-09T19:11:56.273Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear GitLab bug bounty team,\n\n# Summary\n---\nGitlab.com is vulnerable to reverse tabnabbing in AsciiDoc files. \n\n# Why does this vulnerability exist?\n---\n\nIn AsciiDoc the following `http://example.com[Reverse Tabnabbing^]` is equivalent to `\u003ca href=\"http://example.com\" target=\"_blank\"\u003eReverse Tabnabbing\u003c/a\u003e`.\n\n# How can this exploited?\n---\n\nSame scenario as https://hackerone.com/reports/211065. ;)\n\nBest regards,\nEd\n\n","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-08T16:35:14.219Z","allow_singular_disclosure_after":-137021358.70757464,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","b3nac","japz","hacklad","spetr0x"],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1538624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have opened an issue and submitted a patch to Asciidoctor:\n\nIssue: https://github.com/asciidoctor/asciidoctor/issues/2071\nPR: https://github.com/asciidoctor/asciidoctor/pull/2072\n\n~~~diff\n@@ -1031,7 +1031,7 @@ -1031,7 +1031,7 @@ def inline_anchor node\n        end\n        attrs \u003c\u003c %( title=\"#{node.attr 'title'}\") if node.attr? 'title', nil, false\n        attrs \u003c\u003c %( target=\"#{node.attr 'window'}\") if node.attr? 'window', nil, false\n-       %(\u003ca href=\"#{target}\"#{attrs.join}\u003e#{node.text}\u003c/a\u003e)\n+       %(\u003ca href=\"#{target}\"#{attrs.join} rel=\"noopener noreferrer\"\u003e#{node.text}\u003c/a\u003e)\n      when :bibref\n        %(\u003ca id=\"#{target}\"\u003e\u003c/a\u003e[#{target}])\n      else\n~~~","automated_response":false,"created_at":"2017-03-13T20:27:58.825Z","updated_at":"2017-03-13T20:28:24.788Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1538638,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi again @edio!\n\nThanks for the report. I've verified the vulnerability and opened a confidential issue to discuss a patch: https://gitlab.com/gitlab-org/gitlab-ce/issues/29413\n\nOnce we've patched the vulnerability the confidential flag will be removed from that issue, I'll update you here, and credit you in the release post and our vulnerability acknowledgements page.\n\nBtw, this will likely also be true of other markup languages such as RDoc, Textile, etc. We'll be patching those as well.","automated_response":false,"created_at":"2017-03-13T20:31:59.861Z","updated_at":"2017-03-13T20:31:59.861Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1538759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\n\u003e Btw, this will likely also be true of other markup languages such as RDoc, Textile, etc. We'll be patching those as well.\n\nI had a quick look to see whether I could spot any issues and here are my results:\n\n| Language  | Built in target=\"_blank\" feature? | Am I able to inject target=\"_blank\"? |\n|-----------|-----------------------------------|--------------------------------------|\n| RDoc      | NO                                | NO                                   |\n| Textile   | NO                                | NO                                   |\n| Creole    | NO                                | NO                                   |\n| MediaWiki | NO                                | NO                                   |\n\nCan you name any others?\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-03-13T21:20:15.825Z","updated_at":"2017-03-13T21:20:15.825Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1543148,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nope, that's about it.","automated_response":false,"created_at":"2017-03-15T15:40:09.784Z","updated_at":"2017-03-15T15:40:09.784Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1589773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nI have some good news, it appears as though the developers behind Asciidoctor are interested in solving this issue: https://github.com/asciidoctor/asciidoctor/issues/2071#issuecomment-286683303\n\nIf you need any help patching this issue please let me know.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-04-07T17:42:53.313Z","updated_at":"2017-04-07T17:42:53.313Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1589807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nThat's good news. We're still working on a patch for our next security release in any case, as we've found at least one other vulnerable location.","automated_response":false,"created_at":"2017-04-07T18:00:17.234Z","updated_at":"2017-04-07T18:00:17.234Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nWe have a security release scheduled for tomorrow the will include a patch for this vulnerability. I'll contact you again here when it has gone public. Thanks again!","automated_response":false,"created_at":"2017-05-03T22:24:05.440Z","updated_at":"2017-05-03T22:24:05.440Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nGreat timing, because the Asciidoctor team have resolved the issue too: https://github.com/mojavelinux/asciidoctor/commit/adbbcf16220d57c03393480913a9403bcf071422.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-05-04T14:47:35.730Z","updated_at":"2017-05-04T14:47:35.730Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1655604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm sorry to say this security release has been delayed _one more_ day. I promise it will be ready tomorrow, however. Thanks!","automated_response":false,"created_at":"2017-05-05T01:31:54.840Z","updated_at":"2017-05-05T01:31:54.840Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I should have known better than to promise a release date. Unfortunately due to some changes in our infrastructure the security release has been delayed again. Because we don't publish security releases on weekends we won't be able to get this one out until at least Monday. Sorry for the confusion.","automated_response":false,"created_at":"2017-05-06T02:51:59.116Z","updated_at":"2017-05-06T02:51:59.116Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658107,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries @briann.","automated_response":false,"created_at":"2017-05-06T12:03:34.629Z","updated_at":"2017-05-06T12:03:34.629Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1661751,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @edio,\n\nA patch for this vulnerability has been included in today's security release: https://about.gitlab.com/2017/05/08/gitlab-9-dot-1-dot-3-security-release/\n\nVulnerability acknowledgements will be updated soon. Thanks again!","automated_response":false,"created_at":"2017-05-08T22:51:24.656Z","updated_at":"2017-05-08T22:51:24.656Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1663638,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @briann,\n\nCan we disclose this report publicly?\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-05-09T16:35:14.188Z","updated_at":"2017-05-09T16:35:14.188Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1664191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-09T19:11:56.285Z","updated_at":"2017-05-09T19:11:56.285Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1664192,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-09T19:11:56.313Z","updated_at":"2017-05-09T19:11:56.313Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}