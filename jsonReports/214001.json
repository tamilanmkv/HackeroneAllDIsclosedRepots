{"id":214001,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQwMDE=","url":"https://hackerone.com/reports/214001","title":"File access controls incorrectly enforced for files shared via QuickLink - Unshared files can be accessed","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-16T19:53:39.798Z","submitted_at":"2017-03-16T19:53:39.798Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eboda","url":"/eboda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13031,"url":"https://hackerone.com/files","handle":"files","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Files.com","twitter_handle":"","website":"https://www.files.com/","about":"Files.com is a unique cloud platform that empowers your data with tools for organization, collaboration, and file logistics."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-16T19:43:18.314Z","bug_reporter_agreed_on_going_public_at":"2017-03-17T19:43:12.915Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Enter the support PIN from your test site (if applicable): **305056**\nEnter the name of your test site (if applicable): **pwn.brickftp.com**\nEnter the subdomain from your test site (if applicable): **pwn.brickftp.com**\n\n## Summary\n\nThis is a bug in the file sharing feature QuickLink. The file access control is flawed which allows an attacker to download not just the shared file, but any file that has the same name prefix as the shared file.\n\n## Steps to reproduce\nI have created the following files and folders:\n\n```\nbar\nfoo\nfoobar/secret\nfooter.php  \n```\n\nLet's say I want to share `foo` with some friends, so I use the *Copy Public QuickLink* action and it will create a bundle (see https://pwn.brickftp.com/f/23a17148e ) with just that file: {F169390}.\n\nNow when I try to download `foo` a GET request is sent to https://pwn.brickftp.com/bundles/download?code=23a17148e\u0026path=foo\u0026x=767de6540 . \n\nNotice that the `path` variable contains foo, if we change it to `bar`, it will tell us: *Invalid path for bundle*.\n\nHowever, any other path starting with `foo` can be downloaded. For example https://pwn.brickftp.com/bundles/download?code=23a17148e\u0026path=footer.php\u0026x=767de6540\n\nThis would also allow to download any file in `foobar/`: https://pwn.brickftp.com/bundles/download?code=23a17148e\u0026path=foo\u0026x=767de6540\n\n### Final Remark\nPlease note that the above links will most likely not work for if you click on them because the `x` parameter is session specific. But you can still download my files if you go to the QuickLink: https://pwn.brickftp.com/f/23a17148e and then simply replace the `path` variable yourself like I did above.\n\n---\nIf something is unclear or you have any questions please let me know.","bounty_amount":"600.0","formatted_bounty":"$600","original_report_id":null,"original_report_url":null,"attachments":[{"id":169390,"file_name":"foo.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/390/eb707a76fb82baa508b6b31b3f70633221edd254/foo.png?response-content-disposition=attachment%3B%20filename%3D%22foo.png%22%3B%20filename%2A%3DUTF-8%27%27foo.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140448Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=91fce6d4c051fadbd5d9e2dc42056fcd44a9e9443f88ac544d16caa45a3cd834","file_size":33044,"type":"image/png"}],"allow_singular_disclosure_at":"2017-04-16T19:43:12.946Z","allow_singular_disclosure_after":-141589295.71073344,"singular_disclosure_allowed":true,"vote_count":23,"voters":["delimitry","ramsexy","bogdantcaciuc","skavans","sudi","gamliel","vishalchauhan2212","muhammad_uwais","eveeez","prinzhorn","and 13 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1547663,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\n\nThank you for your report. This bug has been confirmed, and we will be back in touch shortly.\n\n—Michael","automated_response":false,"created_at":"2017-03-17T14:12:26.726Z","updated_at":"2017-03-17T14:12:26.726Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1547951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nThis issue should be fixed now. Please test if you have a chance.\n\nWe should have a decision on the bounty today as well.\n\nCheers,\n—Michael","automated_response":false,"created_at":"2017-03-17T16:00:49.598Z","updated_at":"2017-03-17T16:00:49.598Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548015,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-03-17T16:23:29.447Z","updated_at":"2017-03-17T16:23:29.447Z","actor":{"url":"/files","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Files.com"}},"bounty_amount":"600.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"files","collaborator":{"username":"eboda","url":"/eboda"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey  Michael,\n\nthat was a fast fix! And it looks to be correct, I didn't manage to bypass it.\n\nThanks,\nEdgar","automated_response":false,"created_at":"2017-03-17T16:23:52.024Z","updated_at":"2017-03-17T16:23:52.024Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548017,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","automated_response":false,"created_at":"2017-03-17T16:24:13.493Z","updated_at":"2017-03-17T16:24:13.493Z","actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548337,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-03-17T18:15:26.639Z","updated_at":"2017-03-17T18:15:26.639Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eboda","url":"/eboda"},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1548614,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would you mind disclosing?","automated_response":false,"created_at":"2017-03-17T19:43:12.929Z","updated_at":"2017-03-17T19:43:12.929Z","first_to_agree":true,"actor":{"username":"eboda","cleared":true,"url":"/eboda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/247/a6446792be4fa0fc962bcba2811ef801ddff87be_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1614177,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-16T19:43:18.326Z","updated_at":"2017-04-16T19:43:18.326Z","actor":{"url":"/files","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Files.com"}},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}