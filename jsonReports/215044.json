{"id":215044,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTUwNDQ=","url":"https://hackerone.com/reports/215044","title":"[iOS] URL can be replaceState by blob URL in iOS Brave","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-03-21T08:02:27.496Z","submitted_at":"2017-03-21T08:02:27.496Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"xifengweiyu","url":"/xifengweiyu","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-10T05:08:59.263Z","bug_reporter_agreed_on_going_public_at":"2017-08-09T02:13:44.861Z","team_member_agreed_on_going_public_at":"2017-08-10T05:08:59.209Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nURL can be replace by blob URL using function history.replaceState()\n\n## Products affected: \n\niOS brave version 1.3.1(17.02.14.11)\n\n## Steps To Reproduce:\n\n- Add a html named \"blob.html\" which link is \"http://192.168.1.111/blob.html\"\n\n- And its source is:\n```\n\u003cscript\u003e\nhistory.replaceState('','','blob:http://192.168.1.111/xxxx')\n\u003c/script\u003e\n```\n- then visit this page,you will find that URL has been replace by blob URL successfully!\n\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":170267,"file_name":"IMG_3124.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/170/267/f0ccde7017d3066d68ed004e7528a8a48ec2a6db/IMG_3124.PNG?response-content-disposition=attachment%3B%20filename%3D%22IMG_3124.PNG%22%3B%20filename%2A%3DUTF-8%27%27IMG_3124.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140509Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=91b89536e09dcc9d0dd5df6abaf0e4d38aba326a1d2cf655e90aafc7d1237e1e","file_size":37120,"type":"image/png"}],"allow_singular_disclosure_at":"2017-09-08T02:13:44.898Z","allow_singular_disclosure_after":-129124284.68263626,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","khizer47","linkks","spetr0x","christiansomo","sahidan"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1554264,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\n","automated_response":false,"created_at":"2017-03-21T11:44:46.601Z","updated_at":"2017-03-21T11:44:46.601Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1554289,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello asuka,\n\nBecause this behaviour is not allowed in chrome and brave desktop version.This issue is regarded as a security issue by chromium team(I also send a similar report to chromium about iOS chrome)\n\nhistory.replaceState need two url is the same origin according to https://developer.mozilla.org/en-US/docs/Web/API/History_API\n\nso the iOS brave has a different behaviour with brave desktop.","automated_response":false,"created_at":"2017-03-21T11:54:25.127Z","updated_at":"2017-03-21T11:54:25.127Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":170282,"filename":"Screen_Shot_2017-03-21_at_7.49.24_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/170/282/171de58a9ce6a699fefd0e74ae4ebb48bae88843/Screen_Shot_2017-03-21_at_7.49.24_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-03-21_at_7.49.24_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-03-21_at_7.49.24_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140509Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d967fc1710a8d64115a9ea1230dca8ae7704ef1c8cb208c150ec98e2d30363ed"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1555698,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"does this work on iOS firefox?","automated_response":false,"created_at":"2017-03-21T20:51:10.287Z","updated_at":"2017-03-21T20:51:10.287Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1555699,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-03-21T20:51:28.399Z","updated_at":"2017-03-21T20:51:28.399Z","additional_data":{"old_title":"URL can be replaceState by blob URL in iOS Brave","new_title":"[iOS] URL can be replaceState by blob URL in iOS Brave"},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1556236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It doesn't work on iOS firefox,perhaps firefox has taken measures to this.","automated_response":false,"created_at":"2017-03-22T03:56:43.319Z","updated_at":"2017-03-22T03:56:43.319Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571150,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Fixed by https://github.com/brave/browser-ios/commit/431226b99a773ce9f0e67aa89d822b208feae538","automated_response":false,"created_at":"2017-03-29T18:12:29.734Z","updated_at":"2017-03-29T18:12:29.734Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"xifengweiyu","url":"/xifengweiyu"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1571151,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-03-29T18:12:44.711Z","updated_at":"2017-03-29T18:12:44.711Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"xifengweiyu","url":"/xifengweiyu"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty.","automated_response":false,"created_at":"2017-04-04T14:14:13.937Z","updated_at":"2017-04-04T14:14:13.937Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915434,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-09T02:13:44.878Z","updated_at":"2017-08-09T02:13:44.878Z","first_to_agree":true,"actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-10T05:08:59.233Z","updated_at":"2017-08-10T05:08:59.233Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1918397,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-10T05:08:59.278Z","updated_at":"2017-08-10T05:08:59.278Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}