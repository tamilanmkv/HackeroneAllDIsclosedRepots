{"id":215625,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTU2MjU=","url":"https://hackerone.com/reports/215625","title":"A HackerOne employee's GitHub personal access token exposed in Travis CI build logs","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-23T16:47:49.041Z","submitted_at":"2017-03-23T16:47:49.041Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sainaen","url":"/sainaen","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-23T07:15:00.708Z","bug_reporter_agreed_on_going_public_at":"2017-05-15T16:09:47.166Z","team_member_agreed_on_going_public_at":"2017-05-23T07:15:00.639Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\nA HackerOne employee Reed Loden ([GitHub:reedloden](https://github.com/reedloden)) exposed their personal access token twice in build logs of the [rubysec/rubysec.github.io](https://github.com/rubysec/rubysec.github.io) project:\n1. [2015-12-10](https://travis-ci.org/rubysec/rubysec.github.io/jobs/95954424#L258)\n2. [2016-03-01](https://travis-ci.org/rubysec/rubysec.github.io/jobs/112766749#L319)\n\n**Description**\nThe token has `public_repo` [scope](https://developer.github.com/v3/oauth/#scopes), which means that it allows access to any *public* repos the owner account has access to, with the same permissions. This includes all public repositories under [Hacker0x01](https://github.com/Hacker0x01), for which Reed has full access: pull, push, as well as admin permissions.\n\n**Cause**\nThe cause of this as far as I can tell is incorrect  use of `git push` command in [the script](https://github.com/rubysec/ruby-advisory-db/blob/master/scripts/post-advisories.sh#L18):  passing a`-q`/`--quiet` option is not enough, as according to help it *“Suppresses all output \u003c…\u003e unless an error occurs”*, which happened in those two cases, in turn because of missing `--force` option.\n\n**Other**\nIn addition to revoking the token, you might want to review *any* commits to your repositories since the first exposure. The token allows to push from the Reeds account, but commit's author/committer can be set to anything. As far as I know, there's no UI on GitHUb to see what commits were *pushed* from the particular account.\n\nAlso, please, make sure not to disclose this issue publicly (including by accident, with a commit message, for example) at least for some time. Revoking/rotating token with a generic “updating the token” commit should be fine though, as generally nobody pays attention to them.\n\nNote, that I've contacted GitHub to perform mass revocation of credentials that I found, but they aren't as fast as I hoped, so meanwhile I'm trying to notify affected parties individually.","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":82,"name":"Information Exposure Through an Error Message"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-14T16:09:47.251Z","allow_singular_disclosure_after":-136504532.38215995,"singular_disclosure_allowed":true,"vote_count":72,"voters":["tomdev","sp1d3rs","gevakun","secator","ramsexy","bogdantcaciuc","adn","bl4de","spam404","flashdisk","and 62 more..."],"severity":{"rating":"medium","score":6.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1559819,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @sainaen. That would be me. :(\n\nI've revoked the GitHub Personal Access Token for now, and I'll work on correcting the `post-advisories.sh` script to not leak the token.\n\nWe're reviewing the audit log now to make sure that token hasn't been used for any other purposes.\n\nThanks for the report!","automated_response":false,"created_at":"2017-03-23T16:58:54.819Z","updated_at":"2017-03-23T16:58:54.819Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reed! Sorry to bring you the bad news. I can only say that you're not the only one hit by this, if that helps. There are almost a small town of affected people, actually.\n\nBy the way, I should say, that I've used the token to identify the owner (simple GET to `api.github.com/user`) and list their repositories (GET to `api.github.com/user/repos`) If you see those – that's probably me.\n\n\u003e I've revoked the GitHub Personal Access Token for now, and I'll work on correcting the post-advisories.sh script to not leak the token.\n\nGreat! I should warn though, redirecting stdout to `/dev/null` doesn't help, git prints errors to stderr!","automated_response":false,"created_at":"2017-03-23T17:18:40.889Z","updated_at":"2017-03-23T17:18:40.889Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559856,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm going to see if I can use the `GIT_ASKPASS` env variable or something with git's built-in credential store to make the token never visible at all.","automated_response":false,"created_at":"2017-03-23T17:23:17.409Z","updated_at":"2017-03-23T17:23:17.409Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, that's an option too.\nThere's also this great tutorial on using deployment keys by Domenic Denicola: https://gist.github.com/domenic/ec8b0fc8ab45f39403dd. This will allow you to avoid using tokens at all. And the deployment key is specific to a single repository, which is a nice bonus.","automated_response":false,"created_at":"2017-03-23T17:31:47.424Z","updated_at":"2017-03-23T17:31:47.424Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569664,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-03-29T07:51:07.633Z","updated_at":"2017-03-29T07:51:07.633Z","additional_data":{"old_title":"A HackerOne employee exposed their GitHub access token","new_title":"A HackerOne employee's GitHub personal access token exposed in Travis CI build logs"},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569665,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @sainaen,\n\nThanks for the great tutorial link. I'll keep that in mind next time I need to do automated git operations.\n\nI reviewed the audit logs for that token, and nothing seems to have been misused. As such, I'm going to go ahead and resolve this, but I won't disclose it yet until GitHub / Travis CI have dealt with the issue successfully.\n\nDo let me know if you need contacts at Travis CI or GitHub.","automated_response":false,"created_at":"2017-03-29T07:53:20.532Z","updated_at":"2017-03-29T07:53:20.532Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sainaen","url":"/sainaen"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1579982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @reed,\n\nGreat to hear! I suppose nobody is reading those logs. :)\n\nWell, Travis didn't respond to the email on security@travis-ci.org (there's no bounce response either), but since I've managed to contact GitHub I asked them to refer me to someone at Travis. And now again I'm waiting.","automated_response":false,"created_at":"2017-04-03T09:47:49.818Z","updated_at":"2017-04-03T09:47:49.818Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sainaen, can I help connect you with anybody at Travis, or did you finally get in touch with somebody?","automated_response":false,"created_at":"2017-05-01T15:15:39.851Z","updated_at":"2017-05-01T15:15:39.851Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646652,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the offer! I'm sorry I should've followed up on my rather pessimistic ”waiting again.”\n\nAfter ping from GitHub, Travis responded (they just didn't cc me in their previous emails) that they're looking into this.\n\nIn related news, GitHub told me they *will* revoke exposed tokens (which is awesome!) but there's still no timeline.","automated_response":false,"created_at":"2017-05-01T16:04:11.382Z","updated_at":"2017-05-01T16:06:13.730Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1661721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been publicly disclosed.\n\nhttps://blog.travis-ci.com/2017-05-08-security-advisory\n\nAs such, we plan to disclose this report shortly as well.","automated_response":false,"created_at":"2017-05-08T22:38:22.974Z","updated_at":"2017-05-08T22:38:22.974Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1666219,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e As such, we plan to disclose this report shortly as well.\n\nSure. Do you want me to “Request Public Disclosure”?\n\nI'm writing a blog post on this issue with more details and some analysis, but it'll show only generalized stats and list some high-profile affected repos, without naming users that had their tokens exposed. So if you prefer not to reveal yourself as an employee mentioned in the title, just not disclose the details and comments. From my side, I'd certainly like to avoid blaming (even unintentionally) anyone except, perhaps, `git` :)","automated_response":false,"created_at":"2017-05-10T17:24:28.217Z","updated_at":"2017-05-10T17:26:10.968Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674744,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Well, from the docs it looks like I'll need to agree to disclose anyway, so doing it preemptively.","automated_response":false,"created_at":"2017-05-15T16:09:47.182Z","updated_at":"2017-05-15T16:09:47.182Z","first_to_agree":true,"actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694077,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@sainaen -- first of all, we really do appreciate you notifying us of this issue, and thank you for the detailed report that showed exactly what the problem was and how the token was leaked. We're glad you were able to finally get in touch with GitHub and Travis CI and get this addressed for everybody.\n\nWhile the token leakage could not have directly caused RCE (as any commits made maliciously would have had to have been imported as part of a ruby gem or node.js package update), it could have led to malicious code being committed to several of our GitHub repositories, which could have been missed and eventually imported into our private codebase.\n\nWe welcome future reports from you, and happy hacking!","automated_response":false,"created_at":"2017-05-23T07:11:31.742Z","updated_at":"2017-05-23T07:11:31.742Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"sainaen","url":"/sainaen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694079,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-05-23T07:14:37.140Z","updated_at":"2017-05-23T07:14:37.140Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.7)","old_severity_id":32842,"new_severity_id":44179},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694081,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'm ok being blamed publicly. Nobody's perfect! ;)","automated_response":false,"created_at":"2017-05-23T07:15:00.662Z","updated_at":"2017-05-23T07:15:00.662Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694082,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-23T07:15:00.726Z","updated_at":"2017-05-23T07:15:00.726Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1699609,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-05-25T01:53:56.389Z","updated_at":"2017-05-25T01:53:56.389Z","additional_data":{"old_severity":"Medium (5.7)","new_severity":"Medium (6.8)","old_severity_id":44179,"new_severity_id":44772},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1703249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad I could help. Thanks for the bounty!\n\n@reed\nOh, no, I didn't mean to imply that you should cover up the issue! :)\nIt's just blame is unnecessary/unhelpful exactly because nobody is perfect.","automated_response":false,"created_at":"2017-05-26T11:51:44.394Z","updated_at":"2017-05-26T11:51:44.394Z","actor":{"username":"sainaen","cleared":false,"url":"/sainaen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}