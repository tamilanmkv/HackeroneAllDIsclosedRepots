{"id":216243,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTYyNDM=","url":"https://hackerone.com/reports/216243","title":"CSV injection in gitlab.com via issues export feature.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-26T15:58:04.615Z","submitted_at":"2017-03-26T15:58:04.615Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-21T06:14:48.309Z","bug_reporter_agreed_on_going_public_at":"2017-07-21T06:14:48.260Z","team_member_agreed_on_going_public_at":"2017-07-20T05:27:26.499Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear GitLab bug bounty team,\n\n# Summary\n---\n\nGitLab allows users to export issues as a .csv file. By injecting a payload into an issue title an attacker could exfiltrate data or execute code on the target machine. For instance, by naming an issue `=cmd|' /C calc'!A0` I am able to open up calc.exe on Windows.\n\n# Steps to reproduce\n---\n\n1) Create an issue with `=cmd|' /C calc'!A0` as the title;\n2) Export all issues (The file is sent as an email attachment);\n3) Open the .csv file on a Windows machine.\n\n**Result:** calc.exe pops up.\n\n# Fix\n---\n\nPrefix `=`, `+`, `-` and `@` symbols with a `'` in issues when exporting them to a .csv file.\n\nIf you require any further information, feel free to contact me.\n\nBest regards,\nEd","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-19T05:27:26.556Z","allow_singular_disclosure_after":-130840677.83925761,"singular_disclosure_allowed":true,"vote_count":19,"voters":["bl4de","tungpun","leet-boy","eveeez","r3y","b1t","faisalahmed","khizer47","ronygigi","mr_r3boot","and 9 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1565237,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @edio,\n\nI'm tagging this as informative, because it really is informative, and because I don't think there's much GitLab can do to prevent these types of exploits. This is also restricted to project masters only and is effectively something that can be duplicated by emailing someone a malicious CSV or modifying the export CSV after it's created. If we start trying to act as anti-virus for Microsoft products we'll be opening ourselves up for a ton of misery.\n\nI will bring this up to the development team though and see how they want to handle things. I'm open to persuasion if you think this is something other products try to handle. AFAIK there are no security best practices for creating or distributing CSV files.","automated_response":false,"created_at":"2017-03-27T13:47:11.850Z","updated_at":"2017-03-27T13:47:11.850Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1565601,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"H @briann,\n\nThanks for the prompt response.\n\n\u003e [This is] effectively something that can be duplicated by emailing someone a malicious CSV or modifying the export CSV after it's created\n\nThis is not quite the same thing, since the project master exports the issues directly from GitLab I assume they are more likely to trust the file.\n\n\u003e I'm open to persuasion if you think this is something other products try to handle.\n\nCSV injections are usually taken very seriously by numerous companies.\n\n- Uber: https://hackerone.com/reports/126109\n- HackerOne: https://hackerone.com/reports/72785\n- HackerOne: https://hackerone.com/reports/124223\n- New Relic: https://hackerone.com/reports/127032\n\nIn all cases the fix was simply to prefix `=`, `+`, `-` and `@` symbols with a single quote.\n\n\u003e This is also restricted to project masters only\n\nThe target may only be project masters (since they are the only ones that can export issues), but attackers can create issues with a payload.\n\nI hope this helps reevaluating the risk of this issue.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-03-27T16:32:27.937Z","updated_at":"2017-03-27T16:32:27.937Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571304,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hi @edio,\n\nI'm re-opening this report and will update you on the progress of our fix. Thanks again for the report. Sorry for doubting you. ;)","automated_response":false,"created_at":"2017-03-29T19:18:00.002Z","updated_at":"2017-03-29T19:18:00.002Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571312,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-03-29T19:20:50.300Z","updated_at":"2017-03-29T19:20:50.300Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nThank you very much for being so open-minded. It is a pleasure to work with you. :)\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-03-29T19:28:46.909Z","updated_at":"2017-03-29T19:28:46.909Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1765566,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nWe're working for a fix for this as we speak. Hopefully we'll get that out soon. As with HackerOne we'll probably be exempting applications like Excel from our bug bounty in the future but we still plan to fix this issue. I'll update you when a fix is ready. Sorry for the delay!","automated_response":false,"created_at":"2017-06-19T15:44:39.664Z","updated_at":"2017-06-19T15:44:39.664Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1831890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nI was checking on the status of this report and I was wondering if you could give me an update. Is there anything that I can do to help?\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-07-13T11:19:45.980Z","updated_at":"2017-07-13T11:19:45.980Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1832722,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nThe patch has been written and should go out with our next security release, ideally within the next week.","automated_response":false,"created_at":"2017-07-13T16:05:07.357Z","updated_at":"2017-07-13T16:05:07.357Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1848813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @edio,\n\nA patch for this will be included with our critical security release tomorrow (July 19th). Thanks again!","automated_response":false,"created_at":"2017-07-19T04:03:57.384Z","updated_at":"2017-07-19T04:03:57.384Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1851959,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @edio,\n\nA patch for this vulnerability was included with our 9.3.8 release today: https://about.gitlab.com/2017/07/19/gitlab-9-dot-3-dot-8-released/\n\nThanks again!","automated_response":false,"created_at":"2017-07-20T05:27:14.111Z","updated_at":"2017-07-20T05:27:14.111Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1851961,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-07-20T05:27:26.533Z","updated_at":"2017-07-20T05:27:26.533Z","first_to_agree":true,"actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1855732,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-07-21T06:14:48.282Z","updated_at":"2017-07-21T06:14:48.282Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1855733,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-07-21T06:14:48.325Z","updated_at":"2017-07-21T06:14:48.325Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1859696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nThank you, @briann! On a side note, would it be possible to contact you directly by other means than HackerOne? I have a couple questions for you.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-07-22T14:37:20.158Z","updated_at":"2017-07-22T14:37:20.158Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1859860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, you can contact me using normal email: brian@gitlab.com.","automated_response":false,"created_at":"2017-07-22T17:24:31.151Z","updated_at":"2017-07-22T17:24:31.151Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}