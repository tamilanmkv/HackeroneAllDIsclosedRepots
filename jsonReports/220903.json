{"id":220903,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA5MDM=","url":"https://hackerone.com/reports/220903","title":"Authenticated Cross-site Scripting in Template Name","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-04-14T02:10:04.808Z","submitted_at":"2017-04-14T02:10:04.808Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zurke","url":"/zurke","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-18T15:26:23.050Z","bug_reporter_agreed_on_going_public_at":"2017-10-19T15:26:20.826Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Explanation\nDuring my research on latest WordPress I found that `$file_description`  and `$description` from `wp-admin/theme-editor.php`  are not filtering name of the template allowing attacker to do XSS attack.\n\n```\n...\n\t\t$file_description = get_file_description( $filename );\n\n\t\tif ( $filename !== basename( $absolute_filename ) || $file_description !== $filename ) {\n\t\t\t$file_description .= '\u003cbr /\u003e\u003cspan class=\"nonessential\"\u003e(' . $filename . ')\u003c/span\u003e';\n\n\t\t}\n\n\t\tif ( $absolute_filename === $file ) {\n\t\t\t$file_description = '\u003cspan class=\"highlight\"\u003e' . $file_description . '\u003c/span\u003e';\n\n\t\t}\n\n\t\t$previous_file_type = $file_type;\n?\u003e\n\t\t\u003cli\u003e\u003ca href=\"theme-editor.php?file=\u003c?php echo urlencode( $filename ) ?\u003e\u0026amp;theme=\u003c?php echo urlencode( $stylesheet ) ?\u003e\"\u003e\u003c?php echo $file_description; ?\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c?php\n\tendforeach;\n?\u003e\n```\nFrom this code we can see that `$file_description = get_file_description( $filename );` is getting declared and later on under \u003cli\u003e\u003ca\u003e tags template name is printed on the page `...\u003c?php echo $file_description; ?\u003e\u003c/a\u003e\u003c/li\u003e`\n\n`$file_description` variable should be filtered before displayed to the user. For example using `htmlspecialchars()` function (example:  F175759 )\n\nHowever, if victim click on the file that contain XSS payload, XSS will be executed because `$description = get_file_description( $relative_file );` is displaying name of the active file you are editing.\n\n###Steps to replicate\n1. Go to Appearance \u003e Editor\n2. Select file you want to edit (don't select files that already have name - Archives, Theme Footer for example). I used \"back-compat.php\" F175758\n3. At the very top of the file add following comment:\n```/* Template Name: \u003cscript\u003econfirm(document.cookie);\u003c/script\u003e */``` Like this: F175758\n4. Click on Update File.\n5. XSS Popup will be prompted. F175757\n\n###Technology used: \nGoogle Chrome 57.0.2987.133 (64-bit) - Latest","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":175757,"file_name":"Wordpress_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/175/757/76774aabff1b7d779c0c93fa67532048e38abdba/Wordpress_1.png?response-content-disposition=attachment%3B%20filename%3D%22Wordpress_1.png%22%3B%20filename%2A%3DUTF-8%27%27Wordpress_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140646Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=47b9d35d94c09f72672a7a834011f085b4c1b310e2d51d6bbfbf273019b1ef19","file_size":92466,"type":"image/png"},{"id":175758,"file_name":"Wordpress_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/175/758/1a089e1196f783390fdfef948789635acc3012f2/Wordpress_2.png?response-content-disposition=attachment%3B%20filename%3D%22Wordpress_2.png%22%3B%20filename%2A%3DUTF-8%27%27Wordpress_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140646Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=defa49ee6642b1f8de9f4cf4a455b665d883b2d3ad5bd8fe214e40c1b559df46","file_size":172290,"type":"image/png"},{"id":175759,"file_name":"Wordpress_3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/175/759/cf3d9e476255edcfc539e411d223ccff37ecf147/Wordpress_3.png?response-content-disposition=attachment%3B%20filename%3D%22Wordpress_3.png%22%3B%20filename%2A%3DUTF-8%27%27Wordpress_3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140646Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4b10c29220ca304b44ae3b1272885cc2d5f20331bf631369e26a2b1d7a5d1fb5","file_size":13584,"type":"image/png"}],"allow_singular_disclosure_at":"2017-11-18T15:26:20.890Z","allow_singular_disclosure_after":-122942425.67810576,"singular_disclosure_allowed":true,"vote_count":15,"voters":["jokebookservice1","jensec","ali","eveeez","r3y","cr4xerbik4sh","sup3r-b0y","japz","tanzanian__hacker","kinso","and 5 more..."],"severity":{"rating":"medium","score":6.1,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1616744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, I'll forward this to the WordPress security team for review.","automated_response":false,"created_at":"2017-04-17T22:52:52.065Z","updated_at":"2017-04-17T22:52:52.065Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1616806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright, thank you!","automated_response":false,"created_at":"2017-04-17T23:37:21.639Z","updated_at":"2017-04-17T23:37:21.639Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1637106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates on this one?","automated_response":false,"created_at":"2017-04-26T10:31:07.773Z","updated_at":"2017-04-26T10:31:07.773Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1648826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, sorry for the delay, we're still reviewing this one. We'll let you know once we've had a chance to dig into it.","automated_response":false,"created_at":"2017-05-02T13:32:05.184Z","updated_at":"2017-05-02T13:32:05.184Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1651431,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-05-03T14:09:53.134Z","updated_at":"2017-05-03T14:09:53.134Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1690145,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. did you got a chance to dig into it? Just a gentle reminder.","automated_response":false,"created_at":"2017-05-21T20:17:00.196Z","updated_at":"2017-05-21T20:17:00.196Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nThank you for your patience. Although we have created a first patch that should fix the issue you reported, we're still looking into it as we want to make sure we don't miss any similar issues.","automated_response":false,"created_at":"2017-05-23T06:32:07.093Z","updated_at":"2017-05-23T06:32:07.093Z","actor":{"username":"swissspidy","cleared":false,"url":"/swissspidy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oih6s4aMvxSc16ooEJvwGiLC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1694055,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for this update.","automated_response":false,"created_at":"2017-05-23T06:57:26.749Z","updated_at":"2017-05-23T06:57:26.749Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1729271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nSorry for bothering you guys, is there any updates regarding this report?","automated_response":false,"created_at":"2017-06-04T21:39:04.638Z","updated_at":"2017-06-04T21:39:04.638Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1763869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nWe're currently working through a large backlog, so it took us a little longer to respond. We definitely haven't forgotten about this though.\n\nI just realised I didn't attach the patch I mentioned last time. Can you please test it to see if it resolves the issue? Again, we want to make sure we don't miss any similar issues as well.","automated_response":false,"created_at":"2017-06-18T10:19:54.115Z","updated_at":"2017-06-18T10:19:54.115Z","actor":{"username":"swissspidy","cleared":false,"url":"/swissspidy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oih6s4aMvxSc16ooEJvwGiLC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":195209,"filename":"220903.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/195/209/4f27e6f2315af1d35b8d2aa77e8341cc836a4e5f/220903.diff?response-content-disposition=attachment%3B%20filename%3D%22220903.diff%22%3B%20filename%2A%3DUTF-8%27%27220903.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140646Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3622ab3d9da48c596553841ccb19badac7e696a3a99c252762351ef0942663f3"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1763893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @swissspidy ,\nThanks for the patch, I just updated my testing environment and I can confirm this patched it, also tried different payloads to bypass the filter, but no luck. Nice job, I can confirm the patch from my side.","automated_response":false,"created_at":"2017-06-18T11:31:31.745Z","updated_at":"2017-06-18T11:31:31.745Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1849567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys, any update(s) regarding this issue? ","automated_response":false,"created_at":"2017-07-19T12:19:43.608Z","updated_at":"2017-07-19T12:19:43.608Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1926042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sikic,\n\nApparently this issue was publicly reported [7 years ago](https://core.trac.wordpress.org/ticket/13377). There wasn't much traction because template names are set by themes and themes can do much worse stuff than that.\n\nThis fix for extra hardening is now considered for the next security and maintenance release, which has no date set yet. We'll keep you posted when there's any news about the fix, possible bounties, etc.","automated_response":false,"created_at":"2017-08-14T10:24:48.602Z","updated_at":"2017-08-14T10:24:48.602Z","actor":{"username":"swissspidy","cleared":false,"url":"/swissspidy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oih6s4aMvxSc16ooEJvwGiLC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1927337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just perfect! 🙄","automated_response":false,"created_at":"2017-08-14T17:05:30.077Z","updated_at":"2017-08-14T17:05:30.077Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2006066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello again @sikic .\n\nJust to let you know that this is due to be fixed in WordPress 4.8.2 which is scheduled for release within the next 24 hours.\n\nWe'll close this ticket and arrange for a bounty in due course.\n\nRegards\nJohn","automated_response":false,"created_at":"2017-09-19T14:54:33.778Z","updated_at":"2017-09-19T14:54:33.778Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2006109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @johnbillion .\nI'm glad to hear that!\n\nCheers,\nLuka.","automated_response":false,"created_at":"2017-09-19T15:11:12.639Z","updated_at":"2017-09-19T15:11:12.639Z","actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2008432,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed in WordPress 4.8.2 and backported to all branches.","automated_response":false,"created_at":"2017-09-20T12:08:40.074Z","updated_at":"2017-09-20T12:08:40.074Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zurke","url":"/zurke"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2065226,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-13T22:25:08.966Z","updated_at":"2017-10-13T22:25:08.966Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"zurke","url":"/zurke"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2084714,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty, can we do public disclosure with hidden comments? :)","automated_response":false,"created_at":"2017-10-19T15:26:20.851Z","updated_at":"2017-10-19T15:26:20.851Z","first_to_agree":true,"actor":{"username":"zurke","cleared":false,"url":"/zurke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/196/e8a53aaddc9bf0c1a36bb97691c35c553a18a62f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2167453,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-18T15:26:23.076Z","updated_at":"2017-11-18T15:26:23.076Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}