{"id":221558,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjE1NTg=","url":"https://hackerone.com/reports/221558","title":"Private Grab Messages on Android App can be accessed and cached by Search Engines","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-04-17T12:51:11.969Z","submitted_at":"2017-04-17T12:51:11.969Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-14T02:59:28.642Z","bug_reporter_agreed_on_going_public_at":"2017-08-21T23:45:19.138Z","team_member_agreed_on_going_public_at":"2017-09-14T02:59:28.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHello. Today i discovered, that Search Engines can access the private users messages (OTP pins, Group invites information etc.)\nIt happens because the `https://grab-attention.grabtaxi.com` host allows search indexing, and can leak the auth_token to the Search Engines which also can lead to privilege escalation.\nWhen vieving \"Notifications\" section on the app, i noticed the unsecure GET request to the `https://grab-attention.grabtaxi.com/passenger/passenger.html?auth_token=[my_token]\u0026view=268435456`. I was surprised, when tried to repeat it in the browser - it gave me access to my messages.\n\n##POC\n{F176465}\n{F176466}\n\n## Steps To Reproduce:\n1. Cheking the private messages of other user (me):\nhttps://grab-attention.grabtaxi.com/passenger/passenger.html?auth_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJQQVNTRU5HRVIiLCJleHAiOjQ2NDUyMzk1NDUsImlhdCI6MTQ5MTYzOTU0NSwianRpIjoiZWI0YmFiMjUtYzA2Yi00MGIzLWJiZTctMzZkYzFmMWRkZTMyIiwibG1lIjoiU1lTVEVNIiwibmFtZSI6IiIsInN1YiI6IjM2NWE0NjY0LTY1MGEtNDBjZC05YWU2LTQ4YWQwN2Q2NGY2OSJ9.eTX2dWnooTxm50Dv1VYoIZanOqCe073_AmVk97VE4p7m4e26mcWtnZzQz5IR1EwuWbs52qJLzzAIZ5KcpWoKCvadu6zuRQzy2xRk8BcFDUXGl8w8doPJbuSIHMY0K-x8Q-█████████ZTdgxLI\u0026view=268435456#/\n2. Checking that search engines can crawl it:\nUse this Google DORK (search text):\n`passenger site:grab-attention.grabtaxi.com`\nand press Search.\nYou will see this cached page with auth_token (actually it was cutted due to big query length) - but it is still a huge information disclosure.\n\n\n## Suggested fix\n1. Disable Search indexing on `https://grab-attention.grabtaxi.com`\n2. For the better security you can change the request method to the `https://grab-attention.grabtaxi.com/passenger/passenger.html` endpoint from GET to POST (or encrypt it) due to that fact that auth_token are leaked in the query parameters.\n","bounty_amount":"200.0","formatted_bounty":"$200","original_report_id":null,"original_report_url":null,"attachments":[{"id":176465,"file_name":"test.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/465/4b2b436558a9ac8c90a4805e6032c4814210057d/test.PNG?response-content-disposition=attachment%3B%20filename%3D%22test.PNG%22%3B%20filename%2A%3DUTF-8%27%27test.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJF6VFL6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140707Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCID1So1KYRjOmBFJqLsqO1j9SSUCF9kJ%2FHqahOyDLmrnJAiAr2q5Z8bAgCyaCmyDSz7xwtmUTDOoz04myJOluBHRCeyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMvFUMWX6P00RsVarQKtcDflFFNScU3coA1YbnKy4lPXtwGDNsJcqhfcCTaePuAuK6nWvl5xRbjzjOBPvBHaTAnb2Iw%2B6Jdj2uyjmRMn%2F5%2F5AzD5di2wWOcC0am9iLaFmORG4VIVXTc8aAiiwqjNAu7dH2hTUNL9bwPzYUBq3%2FjwvNZUM%2FmpdXfugOwAP%2FP3w9e9PqozA16XzrwGIunimlg58HKZfOM0xp%2FESLFXRHAssX6DaYqQQyV5%2F0triAQeOx328GOBUjfGTiAl1aoS1J0%2FqN%2BmywXW%2FqqkEfAQ2n2f18dX2dkbwMnyQ4F47zR6jJw3CdBkeCPRDbbhcu8YGu2%2F%2BzzM9B4uguhR76M3KYB3dr919eRp%2F%2BcOfUxc8TC3gXMmp1jh0ywwC27sBrzUgZdh%2B2g4artPxRaRZPHbQvC%2F1OZ0MxZYsQmEItbUc65WqfO6PSdLbymEFDMyN5ona14j%2BaQHfp1MWNaO02I2WPYO5mZIsPuHjCO5MYUldcsrZMP7pydKVo87gkO2fPB2orxw1RGazxVwGy5R2PDIV7HsKH4KSOqhGLTTYcSjZvxzmTWIy013yrXhU3CEdFUoB7QifSN1bUli2cMIaUe7sr75onhlaNnQxqLv%2By7jqQ9RiOHvcMM4XIMInwkIsGOqYBzgDHFUI%2FtkToYUBHsGsXyI9vGkS81IUV4PSjgSfvCFIGR%2BPjro3EYi30Oc%2FQZijhik3H1oI82Vno5zo%2BVnueR7%2BkGCloKvMkJAe%2F77e%2BPPRDClquvRG9ERm7ELsd6WvljYOJTmuP4pWPW%2B2d%2BQu26lThNein0I5abJKiu%2FYvnXDmBeYAgLMwbyg9Lq3qT5qMKsr3i1aOgHcGHtYldnzNcLqwaNJYhw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=493167b9e89cce1a74ff038e16499bb4fb31e69334a5131afc1e8d975232faf2","file_size":75256,"type":"image/png"},{"id":176466,"file_name":"test2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/466/3c9830b08c4859b7ef0dfe8baa289aa9a7af6476/test2.PNG?response-content-disposition=attachment%3B%20filename%3D%22test2.PNG%22%3B%20filename%2A%3DUTF-8%27%27test2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJF6VFL6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140707Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCID1So1KYRjOmBFJqLsqO1j9SSUCF9kJ%2FHqahOyDLmrnJAiAr2q5Z8bAgCyaCmyDSz7xwtmUTDOoz04myJOluBHRCeyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMvFUMWX6P00RsVarQKtcDflFFNScU3coA1YbnKy4lPXtwGDNsJcqhfcCTaePuAuK6nWvl5xRbjzjOBPvBHaTAnb2Iw%2B6Jdj2uyjmRMn%2F5%2F5AzD5di2wWOcC0am9iLaFmORG4VIVXTc8aAiiwqjNAu7dH2hTUNL9bwPzYUBq3%2FjwvNZUM%2FmpdXfugOwAP%2FP3w9e9PqozA16XzrwGIunimlg58HKZfOM0xp%2FESLFXRHAssX6DaYqQQyV5%2F0triAQeOx328GOBUjfGTiAl1aoS1J0%2FqN%2BmywXW%2FqqkEfAQ2n2f18dX2dkbwMnyQ4F47zR6jJw3CdBkeCPRDbbhcu8YGu2%2F%2BzzM9B4uguhR76M3KYB3dr919eRp%2F%2BcOfUxc8TC3gXMmp1jh0ywwC27sBrzUgZdh%2B2g4artPxRaRZPHbQvC%2F1OZ0MxZYsQmEItbUc65WqfO6PSdLbymEFDMyN5ona14j%2BaQHfp1MWNaO02I2WPYO5mZIsPuHjCO5MYUldcsrZMP7pydKVo87gkO2fPB2orxw1RGazxVwGy5R2PDIV7HsKH4KSOqhGLTTYcSjZvxzmTWIy013yrXhU3CEdFUoB7QifSN1bUli2cMIaUe7sr75onhlaNnQxqLv%2By7jqQ9RiOHvcMM4XIMInwkIsGOqYBzgDHFUI%2FtkToYUBHsGsXyI9vGkS81IUV4PSjgSfvCFIGR%2BPjro3EYi30Oc%2FQZijhik3H1oI82Vno5zo%2BVnueR7%2BkGCloKvMkJAe%2F77e%2BPPRDClquvRG9ERm7ELsd6WvljYOJTmuP4pWPW%2B2d%2BQu26lThNein0I5abJKiu%2FYvnXDmBeYAgLMwbyg9Lq3qT5qMKsr3i1aOgHcGHtYldnzNcLqwaNJYhw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=46871ff91f7b5b07ab84b069ca171a812bc09fad60ac1ac629cfddb6a755f491","file_size":32856,"type":"image/png"}],"allow_singular_disclosure_at":"2017-09-20T23:45:19.176Z","allow_singular_disclosure_after":-128010107.89768887,"singular_disclosure_allowed":true,"vote_count":32,"voters":["bogdantcaciuc","flashdisk","fa1rlight","cuso4","mpz","leet-boy","eveeez","r3y","whitesector","apapedulimu","and 22 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1617078,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-04-18T03:13:32.057Z","updated_at":"2017-04-18T03:13:32.057Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.3)","old_severity_id":36915,"new_severity_id":37065},"actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1617092,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @sp1d3rs \n\nWe have reviewed your bug report and would like to inform you that your submission is valid. It is important to note that on investigating this issue, we found that search engine cannot crawl and index Grab-attention website from Grab application this may explain why your google dock have only one result (account from another researcher). In this context, privilege escalation looks very difficult. However, like you said we should disable search indexing and change the request method.\n\nWe would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that we can verify the same.\n\nThanks again for your research. We appreciate your help in keeping Grab and our customers safe and secure.","automated_response":false,"created_at":"2017-04-18T03:39:26.445Z","updated_at":"2017-04-18T03:39:26.445Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1629325,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-04-24T01:10:52.316Z","updated_at":"2017-04-24T01:10:52.316Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Grab"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1700363,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for working with us and helping us in resolving this issue.","automated_response":false,"created_at":"2017-05-25T11:30:11.911Z","updated_at":"2017-05-25T11:30:11.911Z","actor":{"username":"grabsecurity","cleared":false,"url":"/grabsecurity","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1945013,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-21T23:45:19.155Z","updated_at":"2017-08-21T23:45:19.155Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995897,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-14T02:59:28.595Z","updated_at":"2017-09-14T02:59:28.595Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995898,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-14T02:59:28.663Z","updated_at":"2017-09-14T02:59:28.663Z","actor":{"username":"nozz_","cleared":false,"url":"/nozz_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Pav4PNZrRD6jcjSGBPe7jAW5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5133,"category":"researcher","content":"This issue can be classified as best-practice. The exploitation against other users was very unlikely (possible under rare circumstances), but the team still decided to award me with a bounty - i very appreciate it!\nThe team was very responsible and fixed the issue fast.\n\nI requested to disclose this report to show the impact from search indexing of privileged/sensitive info. The reported issue itself is not very interesting, and not impactful much, but the idea behind it can help the other researchers to find more interesting bugs:) The applications can leak to the Search Engines emails (check it using `allinurl:@\u003cmailbox_domain\u003e site:\u003ctarget_domain\u003e`), sensitive tokens (same dork, but with 3-4 entropy characters depending on discovered info upon testing), private info of other users, etc. \nMany interesting things and issues can be found just by using Google/Shodan/Censys etc.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":79690,"username":"sp1d3rs","name":"Dr. Jones","bio":"Human. Possibly","cleared":true,"website":"https://xp.ht","location":"Xen","created_at":"2016-05-23T03:07:23.595Z","url":"https://hackerone.com/sp1d3rs","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}