{"id":225098,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjUwOTg=","url":"https://hackerone.com/reports/225098","title":"SQL exception in JSON format","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-30T11:18:15.867Z","submitted_at":"2017-04-30T11:18:15.867Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"clizsec","url":"/clizsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-31T14:12:15.122Z","bug_reporter_agreed_on_going_public_at":"2020-01-31T14:12:15.059Z","team_member_agreed_on_going_public_at":"2020-01-31T14:09:20.631Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, I know this is not critical, just a design issue,\nbut it will be better if it will not show up to the user as an error, maybe in log files readable to the www-user or to the root user in order to debug.\n\nPoC:\n----------------------\n1. Create a user and confirm the password\n2. Capture the packet\n3. Replay the packet with a username bigger than 64 words in length two times in order to duplicate the user.\n4. Receiving error.\n\nThis is working only when the input for the username is bigger than 64 words. (65 needed.)\n\n### Example:\n***Request*** -\nPOST http://172.16.1.68/nextcloud/index.php/settings/users/users HTTP/1.1\nDATA: username=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\u0026password=test123A\n\n***Response*** -\n```\n{\"message\":\"An exception occurred while executing 'INSERT INTO `oc_users` ( `uid`, `password` ) VALUES( ?, ? )' with params [\\\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\\", \\\"1|$2y$10$gwzH19jqn8HveRpCb2haNurF7rycqsZeYYS7b1zPENnUInUyP35J2\\\"]:\\n\\nSQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' for key 'PRIMARY'\"}\n```\n\n### Example:\n***Request*** -\nPOST http://172.16.1.68/nextcloud/index.php/settings/users/users HTTP/1.1\nDATA: username=aaaaaaa\u0026password=test123A\n\n***Response*** -\n```\n{\"message\":\"A user with that name already exists.\"}\n```","weakness":{"id":82,"name":"Information Exposure Through an Error Message"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T14:09:20.709Z","allow_singular_disclosure_after":-50889555.033900216,"singular_disclosure_allowed":true,"vote_count":6,"voters":["powerjacobb1","exception","cr4xerbik4sh","cjn","hackingmaching101","regraj"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1645227,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2017-04-30T11:18:15.990Z","updated_at":"2017-04-30T11:18:15.990Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1645228,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-04-30T11:18:39.983Z","updated_at":"2017-04-30T11:18:39.983Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":39661},"actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646312,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"While not a security risk in our case as we're an open-source company this should anyways be addressed. Thanks for bringing it up.","automated_response":false,"created_at":"2017-05-01T11:55:19.347Z","updated_at":"2017-05-01T11:55:19.347Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646313,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-05-01T11:55:25.623Z","updated_at":"2017-05-01T11:55:25.623Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646363,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Right, this still most be fixed. ","automated_response":false,"created_at":"2017-05-01T12:49:08.266Z","updated_at":"2017-05-01T12:49:08.266Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1935773,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This is going to be resolved in our upcoming Nextcloud 13 release and a Pull Request is available for this at https://github.com/nextcloud/server/pull/6164\n\nWe're not going to backport this change to other releases since the security impact is marginal and it only affects administrators.","automated_response":false,"created_at":"2017-08-17T12:07:09.919Z","updated_at":"2017-08-17T12:07:09.919Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"clizsec","url":"/clizsec"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1936955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks! :)","automated_response":false,"created_at":"2017-08-17T17:37:41.940Z","updated_at":"2017-08-17T17:37:41.940Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932765,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Forgot to disclose this","automated_response":false,"created_at":"2020-01-31T14:09:20.646Z","updated_at":"2020-01-31T14:09:20.646Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6932786,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-31T14:12:15.078Z","updated_at":"2020-01-31T14:12:15.078Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932787,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-31T14:12:15.150Z","updated_at":"2020-01-31T14:12:15.150Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}