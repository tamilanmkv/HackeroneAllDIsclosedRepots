{"id":225833,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjU4MzM=","url":"https://hackerone.com/reports/225833","title":"www.hackerone.com website CSP \"script-src\" includes \"unsafe-inline\"","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2017-05-03T13:58:52.776Z","submitted_at":"2017-05-03T13:58:52.776Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rootkid","url":"/rootkid","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-23T06:24:45.388Z","bug_reporter_agreed_on_going_public_at":"2017-05-23T06:24:45.334Z","team_member_agreed_on_going_public_at":"2017-05-23T00:02:12.676Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n\nThe HTTP header of the hackerone.com website includes an unsafe CSP parameter for \"script-src\". \n\n**Description:** \nThe hackerone.com website (https://www.hackerone.com) has a  Content-Security-Policy configured, as pointed out on the Bug Bounty page of their program:\n\n\u003eWe utilize a strict Content Security Policy and a safe-by-default templating language to effectively neutralize Cross-Site Scripting (XSS).\n\nHowever, the \"script-src\" parameter is set to \"unsafe-inline\", which allows injection of user passed values, which in result can be misused for Cross-Site Scripting attacks. As a best practice, this value should not be included as a \"script-src\" parameter, if possible.\n\n\n### Steps To Reproduce\n\nThe header can be read using a simple curl query:\n```\n$ curl -I https://www.hackerone.com\nHTTP/1.1 200 OK\nDate: Wed, 03 May 2017 13:43:29 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: keep-alive\nSet-Cookie: __cfduid=d80b77473f21b44450916a32b6f4e56d11493819008; expires=Thu, 03-May-18 13:43:28 GMT; path=/; Domain=www.hackerone.com; HttpOnly\nCache-Control: max-age=300, public\nX-Drupal-Dynamic-Cache: HIT\nX-UA-Compatible: IE=edge\nContent-language: en\nX-Content-Type-Options: nosniff\nX-Frame-Options: DENY\nExpires: Sun, 19 Nov 1978 05:00:00 GMT\nLast-Modified: Mon, 01 May 2017 21:41:56 GMT\nETag: W/\"1493674916\"\nVary: Cookie,Accept-Encoding\nX-Generator: Drupal 8 (https://www.drupal.org)\nContent-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; child-src www.youtube-nocookie.com app-sj17.marketo.com; connect-src 'self' hackerone.com *.mktoresp.com checkout.stripe.com; font-src 'self'; form-action 'self' syndication.twitter.com platform.twitter.com; frame-ancestors 'self'; frame-src www.youtube.com www.youtube-nocookie.com app-sj17.marketo.com boards.greenhouse.io platform.twitter.com syndication.twitter.com checkout.stripe.com; img-src 'self' data: www.google-analytics.com syndication.twitter.com platform.twitter.com *.twimg.com q.stripe.com; media-src 'self'; script-src 'self' 'unsafe-inline' www.google-analytics.com app-sj17.marketo.com munchkin.marketo.net boards.greenhouse.io platform.twitter.com cdn.syndication.twimg.com checkout.stripe.com; style-src 'self' 'unsafe-inline' app-sj17.marketo.com boards.greenhouse.io boards-use1-cdn.greenhouse.io platform.twitter.com checkout.stripe.com; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Xss-Protection: 1; mode=block\nX-Drupal-Cache: HIT\nX-Request-ID: v-50f3aef2-3006-11e7-9597-02c51b741cbd\nX-AH-Environment: prod\nX-Varnish: 549998133 549985183\nAge: 75\nVia: 1.1 varnish\nX-Cache: HIT\nX-Cache-Hits: 43\nServer: cloudflare-nginx\nCF-RAY: 3593a644588915ad-FRA\n```\n\nAs can be seen, \"unsafe-inline\" is included in in the list of \"script-src\" parameters. \nThis does not result in an immediate threat, but should be excluded, if possible, as a best practice. For further information, see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-22T00:02:12.716Z","allow_singular_disclosure_after":-135871591.65159297,"singular_disclosure_allowed":true,"vote_count":16,"voters":["sp1d3rs","flashdisk","mpz","eveeez","r3y","peeper35","ak1t4","ajdumanhug","b3nac","japz","and 6 more..."],"severity":{"rating":"none","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1651428,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-05-03T14:09:13.208Z","updated_at":"2017-05-03T14:09:13.208Z","additional_data":{"old_title":"hackeron.com website CSP \"script-src\" includes \"unsafe-inline\"","new_title":"hackerone.com website CSP \"script-src\" includes \"unsafe-inline\""},"actor":{"username":"rootkid","cleared":false,"url":"/rootkid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652872,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@dhauenstein -- you are correct in that @security talks about a strong CSP policy, but that's meant for https://hackerone.com, not https://www.hackerone.com (they are two different sites). We go to great lengths to ensure that compromising https://www.hackerone.com won't lead to a compromise on https://hackerone.com (and we welcome attempts to do so!).\n\nHowever, we recently made some changes that allowed us to remove the `unsafe-inline` option on https://www.hackerone.com as well, and we have now done so. So, thanks for the poke!","automated_response":false,"created_at":"2017-05-04T02:07:44.733Z","updated_at":"2017-05-04T02:07:44.733Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rootkid","url":"/rootkid"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652873,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-05-04T02:07:58.360Z","updated_at":"2017-05-04T02:07:58.360Z","additional_data":{"old_title":"hackerone.com website CSP \"script-src\" includes \"unsafe-inline\"","new_title":"www.hackerone.com website CSP \"script-src\" includes \"unsafe-inline\""},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1652978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, I can confirm that \"unsafe-inline\" does not appear in the CSP header anymore (although it still does as \"style-src\" parameter - maybe that can be fixed as well). \nSoooo, I was silently hoping for some swag. I assume this is a too low profile bug for swag, right? :)","automated_response":false,"created_at":"2017-05-04T05:36:41.479Z","updated_at":"2017-05-04T05:36:41.479Z","actor":{"username":"rootkid","cleared":false,"url":"/rootkid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693429,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Happy to send you some swag for this particular report. :)\n\nJust a note for the future: If you had provided a method to bypass the CSP using the `unsafe-inline`, we would have been happy to have paid a bounty as well.\n\nThanks again, and happy hacking!","automated_response":false,"created_at":"2017-05-23T00:01:56.360Z","updated_at":"2017-05-23T00:01:56.360Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"reporter":{"username":"rootkid","url":"/rootkid"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693431,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-05-23T00:02:07.361Z","updated_at":"2017-05-23T00:02:07.361Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693432,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-23T00:02:12.694Z","updated_at":"2017-05-23T00:02:12.694Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693996,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-23T06:24:45.357Z","updated_at":"2017-05-23T06:24:45.357Z","actor":{"username":"rootkid","cleared":false,"url":"/rootkid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693997,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-23T06:24:45.407Z","updated_at":"2017-05-23T06:24:45.407Z","actor":{"username":"rootkid","cleared":false,"url":"/rootkid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":4135,"category":"researcher","content":"The www.hackerone.com website was missing a strict \"script-src\" value. Albeit just a low profile risk, a sound \"script-src\" value should be considered best practice. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":12250,"username":"rootkid","name":"Daniel Hauenstein","bio":"#kaeferjaeger","cleared":false,"website":null,"location":"","created_at":"2014-09-20T10:01:36.932Z","url":"https://hackerone.com/rootkid","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/250/cd22edb7c491ddedadba6c8b7c7f8d411e0a9dd3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcTBOIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--db50fa179182d6e6d6f7b0b9bc6d912606338da7/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/profile.jpg"}}}]}