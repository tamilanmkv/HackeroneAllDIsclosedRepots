{"id":226428,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjY0Mjg=","url":"https://hackerone.com/reports/226428","title":"Reflected XSS in \u003cany\u003e.myshopify.com through theme preview","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-05-05T21:22:15.520Z","submitted_at":"2017-05-05T21:22:15.520Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-29T16:06:44.441Z","bug_reporter_agreed_on_going_public_at":"2017-05-29T16:06:44.384Z","team_member_agreed_on_going_public_at":"2017-05-29T15:34:25.429Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nI have found a reflected cross site scripting vulnerability in `\u003cany\u003e.myshopify.com` through `theme_hanlde` parameter due to not single quotes.\n\n#Steps to reproduce: \n1. Navigate to `\u003caccount\u003e.myshopify.com` \n2. view the source of the page and copy the value of `Shopify.theme` Id.\n3. Navigate to `https://echo.myshopify.com/?theme_handle=xx%27-alert(document.cookie)-%27\u0026style_id=1\u0026style_handle=1\u0026preview_theme_id=\u003ctheme_ID\u003e` \n\u003e *replace `\u003ctheme_ID\u003e` with the ID you just copied*.\n4. XSS will trigger in all of the online shop pages unless you click `Cancel theme preview` .\n\n**PoC:** \n`https://test.myshopify.com/?theme_handle=xx%27-alert(document.cookie)-%27\u0026style_id=1\u0026style_handle=1\u0026preview_theme_id=3572` \n\n{F182252}\nThanks!","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":182252,"file_name":"xss-triggered.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/182/252/3b569fa141d28134db891c7a10716d0bc9d6b83a/xss-triggered.png?response-content-disposition=attachment%3B%20filename%3D%22xss-triggered.png%22%3B%20filename%2A%3DUTF-8%27%27xss-triggered.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSZC7DXM7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140859Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC%2BDPA%2BSA%2BpuJvH4UEzvWiP4UFbtskzj7xfN6rqlPo4hwIhAOElSqCIqXNISLvxjY33BSsqOOcMi8dDWLDb%2FHD9us3YKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwLzMOGCwg6RS74p74q1wP3%2BrYZeAM77Rmdm64%2BCSKI7bN93GsX7JZ2tRccS6J5LGMRJTs%2By2W6iZRVDq3XbBt0e6p3WHVjfBqyc9ME6wkTlY9d%2Fv3J1DB8BCqWSb%2BRKzvSiDC8qrGE542%2FrwTG4%2F%2F%2B2GZboS%2Bwx6a4S2dscyeGXoZ%2FpJf5Uq70DiwjHjChb4otA36pPHn6Cbuljknt8dm165HwajfM%2FYT9DsRnV1w0OsaZyXvEEhwGsPTVDhkOXnM85nNGqSZ3QDaL%2FFoqr9dtCpsUJbXrXwy5kt3x0oz1dJ01X%2BzIddVtQMPL2ptVZ7U9zvXOF0wODPRFZiOr31TkuvFOSwxvOXUum3Wvfo9vzLL2sp7049bpk2pDp0SX1ErSpZmBqjAE1Syh%2Bgl%2BQXOk5uGw1WkZ%2Bi%2BVM0miZCx%2Fzk0YwCnQVNh8OZjtqzLjisdsfijlbUNbtSb%2F2rqQk5byOsnNd8EOB%2Fk4YSlr9Ml9Z%2FBjM39hyAylCG6PZXUBPl4i%2FIRvue2kJRbtUIpgVYXpDngioq0oVUItMzpWv1Dpeb3i%2BGYq1GpN7Q2SSm%2FKrlHtq%2FAe%2FUyoxvBMaLL9j8sY6VSMaDAw3WBbjN8GeRsrk6lj%2FvPn7De7XtYE3zRUmOhj70LaDvgw%2FfCQiwY6pAEB7X%2FT8tdYZNLCr%2BSBWKV0iIWafrBI43qKIrIcnQBlJSwVNOZ8Gcvl0OoNDa0QYgNpFyVQok8yJDR3W7a4ZqF2ZSs2yTdzPkNqbsgUkg9RTuuVzr%2BJ0IWfPqfOclYjbyvg8xSLdadzgsszfk0wXK8O0D9utoO42Qj4fAyRHUrDx8JxY18uWRPyFpidRfVqDlD%2FMzGvphFE58fBjncDPhIagYIJNw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6ee1a81d91235b58fadd33c6e1573a6b64141f83d1f4ea7e613382eeac66d879","file_size":113570,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":69,"voters":["sp1d3rs","drsniper","dumeelvavvalu","michiel","bogdantcaciuc","bl4de","fizhimchik","spam404","try_to_hack","ysx","and 59 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1657661,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report! Our engineering team is investigating this issue.","automated_response":false,"created_at":"2017-05-05T23:27:36.180Z","updated_at":"2017-05-05T23:27:36.180Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1707490,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report! This issue has been resolved.\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2017-05-29T13:50:05.839Z","updated_at":"2017-05-29T13:50:05.839Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1707636,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @zombiehelp54, thanks again for reporting this issue! We've set the award considering the impact of this issue. It could be used by an unauthenticated person to perform authenticated actions on a store, with no interaction from the store administrator.","automated_response":false,"created_at":"2017-05-29T15:32:35.676Z","updated_at":"2017-05-29T15:32:35.676Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1707642,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-29T15:34:25.447Z","updated_at":"2017-05-29T15:34:25.447Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1707678,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-29T16:06:44.406Z","updated_at":"2017-05-29T16:06:44.406Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1707679,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-29T16:06:44.460Z","updated_at":"2017-05-29T16:06:44.460Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4247,"category":"team","content":"This is a reflected XSS that could be triggered on the storefront of any Shopify store. Our template was missing proper escaping for the `theme_handle` parameter. This issue is severe because it could be exploited by unauthenticated users to attack the admin area of a store, given that the storefront is hosted on the same origin as the admin area of a store.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":19168,"username":"francoischagnon","name":"Francois Chagnon","bio":"","cleared":false,"website":"","location":"","created_at":"2015-03-19T21:06:55.673Z","url":"https://hackerone.com/francoischagnon","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}