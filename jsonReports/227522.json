{"id":227522,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjc1MjI=","url":"https://hackerone.com/reports/227522","title":"IDOR in editing courses","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-05-10T16:25:29.221Z","submitted_at":"2017-05-10T16:25:29.221Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kieran","url":"/kieran","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2450,"url":"https://hackerone.com/maximum","handle":"maximum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Maximum","twitter_handle":"maximum_NL","website":"https://maximum.nl","about":"Maximum is a full-service agency specialised in employer branding and recruitment advertising."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-22T17:43:43.880Z","bug_reporter_agreed_on_going_public_at":"2017-05-22T14:20:07.881Z","team_member_agreed_on_going_public_at":"2017-05-22T17:43:43.784Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Description\n\nThis vulnerability consists in :\nhttps://mijn.werkenbijdefensie.nl/instellingen/gegevens/\n\nThis vulnerability allows an attacker to edit courses that do not belong to him and remove them from the users account.\nThe edited course ends up in the attackers  account, but gets deleted from the account of the user that made the course.\n\n#Proof of concept\n\n* Create 2 accounts\n* go to https://mijn.werkenbijdefensie.nl/instellingen/gegevens/\n* start intercepting the requests\n* add a course in one account and look at the reponse of the POST request that is made to add this course. It is a number.\n* Now go to the other account also make a course.\n* Edit this course, and capture the POST of the request that is made to edit the course.\n* Repeat the request but change the \"id\" parameter to the id the course that was made in the other account.\n* reload the page\n* The course got removed from the creator's account and was inserted into the account of the attacker.\n\n#impact\nAttacker can remove all courses of all users by iterating trough all the course id's.\n\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-21T14:20:07.914Z","allow_singular_disclosure_after":-135906546.66181153,"singular_disclosure_allowed":true,"vote_count":26,"voters":["mattibijnens","bl4de","z0mb13","aporlorxl23","mpz","eveeez","dz_samir","b3nac","zerotoone","bb00x","and 16 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1666181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a video proof of concept using burp suite to intercept and modify the requests.\n\n#Possible fix\n\nIDOR means that you directly alter a database object by using user submitted data in the query before checking or validating that data.\nYou should first check if the user that submits the request isn't tampering and isn't submitting any ID's that do not belong to his account.\n\nSO the correct and secure flow should be like:\n\nUser submits request:\n\n```\nPOST /instellingen/addcursus HTTP/1.1\nHost: mijn.werkenbijdefensie.nl\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: */*\nAccept-Language: nl,en-US;q=0.7,en;q=0.3\nReferer: https://mijn.werkenbijdefensie.nl/instellingen/gegevens/\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-CSRF-TOKEN: 34eb64be-ed52-442a-b945-f94b516da205\nX-Requested-With: XMLHttpRequest\nContent-Length: 77\nCookie: [cookiedata]\nConnection: close\n\nid=92973\u0026name=test2\u0026behaald=0\u0026jaar=2022\u0026omschrijving=test2\u0026resultaat=test2%0A\n```\n\n* extract the ID parameter value\n* lookup if the user has any course linked to his account with this ID\n* if this is positive, that row gets altered\n* if this is negative a 403 error get's thrown.","automated_response":false,"created_at":"2017-05-10T17:03:12.929Z","updated_at":"2017-05-10T17:03:12.929Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1666196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Upon further exploring this dashboard I realized that this attack is not limited to courses, but could also be carried out against the \"absence\" system at https://mijn.werkenbijdefensie.nl/instellingen/gegevens/#tab3\nAn attacker can overwrite all absence entries in the database with the same attack scenario as explained above.\nThe same proposed fix can be applied.","automated_response":false,"created_at":"2017-05-10T17:12:58.438Z","updated_at":"2017-05-10T17:12:58.438Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1666417,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey Kieran,\n\nThanks for your report. We've got a similar one a while ago. I've forwarded the report to the responsible third party and urged them to fix it as soon as possible.","automated_response":false,"created_at":"2017-05-10T18:43:09.872Z","updated_at":"2017-05-10T18:43:09.872Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1666433,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hey bamie,\n\nGood! \nI noticed that some parts of the dashboard work the same way but are protected against this?\nFor example when you try this in the education section of the dashboard the correct error returns although it works the exact same way.\n\nAlso realized I forgot the video URL, but I guess the issue is clear since a similar report was made before. \n","automated_response":false,"created_at":"2017-05-10T18:53:44.520Z","updated_at":"2017-05-10T18:53:44.520Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1679343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Kieran,\n\nWe've got report the vulnerability is fixed. Can you confirm?","automated_response":false,"created_at":"2017-05-17T06:40:11.339Z","updated_at":"2017-05-17T06:40:11.339Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1679428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bamie ,\n\nI just tested.\nWas the fix deployed in production? I Just tested and it seems the vulnerability still exists.","automated_response":false,"created_at":"2017-05-17T07:29:10.671Z","updated_at":"2017-05-17T07:29:10.671Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1679512,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kieran \nI tested it on production with the educations, courses and absence. For both update and delete.\nIt all seems fixed from my side. What are you still able to reproduce?","automated_response":false,"created_at":"2017-05-17T08:39:54.283Z","updated_at":"2017-05-17T08:39:54.283Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1679563,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bamie \n\nMaybe the patch hasn't rolled out to the entire production platform yet?\nI tried again and was able to remove courses from a test account by doing the idor described in the inital report.\nI made a video poc that demonstrates this:\nhttps://www.youtube.com/watch?v=xx_I8bX5mBc\u0026feature=youtu.be\n","automated_response":false,"created_at":"2017-05-17T09:16:39.448Z","updated_at":"2017-05-17T09:16:39.448Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1690596,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Kieran,\nI've got report from the third party. They explained the regression of the bug was introduced by having multiple instances of the webserver running during a deploy. A new instance would get started and the old instance should be killed. Occasionally, the sigterm didn't work and caused an old process to be kept in circulation. This explains why I couldn't reproduce it, since my request was handled by a newer instance of the webserver. This should be fixed now. Can you confirm once more? Thanks!","automated_response":false,"created_at":"2017-05-22T06:32:33.199Z","updated_at":"2017-05-22T06:32:33.199Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1691496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bamie ,\n\nThanks for explaining, I learn from this as well! :)\nI just checked and the fix seems to be deployed correctly!\n\nKind regards,\nKieran Claessens\n","automated_response":false,"created_at":"2017-05-22T13:39:59.237Z","updated_at":"2017-05-22T13:39:59.237Z","actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1691567,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Awesome! Thanks for the help\nI've assigned another colleague which will assign the bounty. Hang tight","automated_response":false,"created_at":"2017-05-22T14:04:17.642Z","updated_at":"2017-05-22T14:04:17.642Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kieran","url":"/kieran"},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1691626,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey that's awesome!\nThanks in advance!\nMaybe we can disclose this report publicly? :)","automated_response":false,"created_at":"2017-05-22T14:20:07.894Z","updated_at":"2017-05-22T14:20:07.894Z","first_to_agree":true,"actor":{"username":"kieran","cleared":false,"url":"/kieran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/303/c1f887e634fcffdd4bfce6e9f856c8df5d37fea8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1692440,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-22T17:43:43.803Z","updated_at":"2017-05-22T17:43:43.803Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1692441,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-22T17:43:43.901Z","updated_at":"2017-05-22T17:43:43.901Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1706920,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Tx @kieran! Nice job, \n\nbest, Mark","automated_response":false,"created_at":"2017-05-29T07:39:53.287Z","updated_at":"2017-05-29T07:39:53.287Z","actor":{"url":"/maximum","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Maximum"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"maximum","collaborator":{"username":"kieran","url":"/kieran"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}