{"id":23363,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzM2Mw==","url":"https://hackerone.com/reports/23363","title":"Forgot Password Issue","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-08-09T20:02:01.015Z","submitted_at":"2014-08-09T20:02:01.015Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xtross1","url":"/xtross1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-09-10T19:16:02.866Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-08-11T19:15:55.839Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nThe application authenticates user before the password is changed by the user.\r\n\r\nPOC:\r\n1. User attempts password reset\r\n2. User gets verification link\r\n3. User access link and gets authenticated automatically before performing any password change\r\n\r\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-10T19:15:55.915Z","allow_singular_disclosure_after":-223584909.57361698,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sa1tama0","wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":103957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Furthermore, this also works even when the user has not verified his email address.","automated_response":false,"created_at":"2014-08-09T20:03:02.207Z","updated_at":"2014-08-09T20:03:02.207Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103958,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"This is intentional. Many installs do not use passwords.","automated_response":false,"created_at":"2014-08-09T20:03:30.910Z","updated_at":"2014-08-09T20:03:30.910Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":103960,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, but this isn't a correct workflow for application to behave.\n","automated_response":false,"created_at":"2014-08-09T20:08:27.394Z","updated_at":"2014-08-09T20:08:27.394Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Why not? How can an attacker exploit this?","automated_response":false,"created_at":"2014-08-09T20:08:52.647Z","updated_at":"2014-08-09T20:08:52.647Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":103963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"First, the email is not verified - still the password reset works with that email.\nSecondly, password reset link allows direct login, without first performing password change.\n\nAlso, just figured out that - when user has added 2 un-verified email addresses, the password reset link can be sent to either of those 2 un-verified email addresses.\n\nIf user enters an email incorrectly by mistake, the verification link will be sent to another user, the other user can now access the forgot password fucntionality, use his own email address and reset the password OR he can directly login without changing the password.\nThis way original account holder, will never know that another user has access to his phabricator account since the password hasn't been changed","automated_response":false,"created_at":"2014-08-09T20:17:18.472Z","updated_at":"2014-08-09T20:17:18.472Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Basically, what I want to convey is that, since all the below checks are missing :\n* Mandatory email verification check\n* Mandatory password reset\n* Password links sent only to verified emails\n\n-\u003eit can lead to horizontal privilege escalation.","automated_response":false,"created_at":"2014-08-09T20:23:59.432Z","updated_at":"2014-08-09T20:24:22.337Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're not concerned about users accidentally entering email addresses they do not control. Attackers can not actively exploit this and it requires significant user error.","automated_response":false,"created_at":"2014-08-09T20:26:26.004Z","updated_at":"2014-08-09T20:26:26.004Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":103972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes agreed, but then too there are chances of such mishaps happening.\nIt can be prevented even if one issues is fixed (mandatory email verification check)\n\nFor example user might want to try to enter tester@gmail.com and enters testet@gmail.com, the owner of testet@gmail.com can perform the above steps to gain access to this phab account.","automated_response":false,"created_at":"2014-08-09T20:30:25.923Z","updated_at":"2014-08-09T20:30:25.923Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103973,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"I guess we can change the reset emails on unverified addresses behavior, although it is very difficult for me to imagine a user ever making this mistake.","automated_response":false,"created_at":"2014-08-09T20:43:54.430Z","updated_at":"2014-08-09T20:43:54.430Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":103975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes this is a rare case scenario - although there was an article on attackers  obtaining/registering strategic email address or domain names \nHere is a post : http://www.techweekeurope.co.uk/news/attackers-spread-typosquatting-scams-39324\nAND\nhttp://www.wired.co.uk/news/archive/2011-09/09/typosquatting","automated_response":false,"created_at":"2014-08-09T20:50:55.307Z","updated_at":"2014-08-09T20:51:22.844Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fix is out for review:\n\nhttps://secure.phabricator.com/D10206","automated_response":false,"created_at":"2014-08-09T21:09:03.040Z","updated_at":"2014-08-09T21:09:03.040Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":103981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for looking into this !\nThe fix suggested in the report seems solid.","automated_response":false,"created_at":"2014-08-09T21:20:44.335Z","updated_at":"2014-08-09T21:20:44.335Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":105062,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should now be fixed in HEAD.\n\nhttps://secure.phabricator.com/rP6232e9676cd4acb67a747d5463ce9a8092eb802f","automated_response":false,"created_at":"2014-08-11T19:14:07.256Z","updated_at":"2014-08-11T19:14:07.256Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"xtross1","url":"/xtross1"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":105065,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"In assessing the award for this report, I am primarily considering how difficult the issue is to exploit: a user must enter an incorrect address which happens to be a valid address controlled by a malicious user, and not realize they have made a mistake for some time afterward.","automated_response":false,"created_at":"2014-08-11T19:15:36.679Z","updated_at":"2014-08-11T19:15:36.679Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"xtross1","url":"/xtross1"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":105066,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This can be publicly disclosed at any time.","automated_response":false,"created_at":"2014-08-11T19:15:55.853Z","updated_at":"2014-08-11T19:15:55.853Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":106864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Appreciate the bounty offered !\n\nRequesting you for some time to be provided to disclose the issue, it has been triaged on other program.\nOnce they fix it , will disclose the same .","automated_response":false,"created_at":"2014-08-13T18:27:50.966Z","updated_at":"2014-08-13T18:27:50.966Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":106870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem, we're in no hurry to disclose. Thanks for the report!","automated_response":false,"created_at":"2014-08-13T18:32:37.337Z","updated_at":"2014-08-13T18:32:37.337Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":125041,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-09-10T19:16:02.970Z","updated_at":"2014-09-10T19:16:02.970Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}