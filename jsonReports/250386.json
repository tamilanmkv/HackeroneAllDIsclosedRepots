{"id":250386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTAzODY=","url":"https://hackerone.com/reports/250386","title":"CSRF Проверить является ли пользователь админом группы.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-07-17T01:18:48.044Z","submitted_at":"2017-07-17T01:18:48.044Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"circuit","url":"/circuit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-14T17:11:11.943Z","bug_reporter_agreed_on_going_public_at":"2017-08-15T17:10:58.321Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Доброго времени суток. Нашел забавную вещь, которая позволит нам вычислить, является ли пользователь админом группы. Все дело в том, что ответ от запроса, который я привел ниже, будет закомментирован только тогда, когда пользователь будет являться админом группы, в другом же случае мы будем получать (!) ответ \"Ошибка доступа\". Таким образом мы можем отобразить ответ во фрейме на нашем сайте и, собственно, спросить пользователя. При этом он не будет знать, что мы его проверили.\n\nЗапрос который для меня выдает закомментированый ответ: https://vk.com/al_groups.php?act=to_public_box\u0026al=1\u0026gid=147481259 (группа в данном случае моя)\n\nЗапрос который выдает НЕзакомментированый ответ: https://vk.com/al_groups.php?act=to_public_box\u0026al=1\u0026gid=111 (группа в данном случае не моя)\n\nВо фрейм, кстати, ответ изи подгружается.\n\nЯ накидал примерный вариант эксплуатации (нужен он только для того, чтобы продемонстрировать, что во фрейм все отлично подргружается): http://lincoln-shop.ru/ (если боитесь переходить на сайт, то скрины в описании) \n\nИстория такая: пользователь заходит к нам на сайт, оставить отзыв/купить товар и т.д., мы спрашиваем у него подтверждение действия - ввод капчи. Но, блин, по случайным непредвиденным обстоятельствам наша лже-капча не подгружается. Мы, конечно же об этом знаем, и как тру-админы стараемся помочь пользователю, спросить что-же у него за проблема.\n\nА варианта проблемы может быть два:\n\n1. Пишет \"Ошибка доступа\" - собственно пользователь не админ группы.\n2. Не пишет ничего - пользователь админ группы.\n\nПользователь выбирает радиобатон и кликает на кнопку отправить. В итоге у нас есть информация о статусе пользователя:)\n\nФорму можно сделать лучше, я накидал ее за 5 минут. Можно вообще не оставить пользователю шансов уйти с нашего сайта без ответа.\n\nКак исправить: \n\nТут варианта может быть 2\n1) Закомментировать ответ, как сделано во всех остальных скриптах.\n2) Добавить хэш, как требуют стандарты и википедия.\n\nВот, собственно, и все:) Вот такая CSRF. Скрины в описании.\n\nС уважением vk.com/lc :)\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":203784,"file_name":"admin.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/203/784/709b3ef8e3e0dcc2deb6dd9940ca3e8b00c81d87/admin.png?response-content-disposition=attachment%3B%20filename%3D%22admin.png%22%3B%20filename%2A%3DUTF-8%27%27admin.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143028Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0c180fc6941256fa5d3696b456cda06a27d827e6e6fe2f8bfd2cad57b5d2f39a","file_size":13095,"type":"image/png"},{"id":203785,"file_name":"ne_admin.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/203/785/877700dd35adfb70a034dfa18e6d4537ed3d8561/ne_admin.png?response-content-disposition=attachment%3B%20filename%3D%22ne_admin.png%22%3B%20filename%2A%3DUTF-8%27%27ne_admin.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143028Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a61a59561a701d366e521d10f01dbc44057decfcfb11f9fb769e603c9c65e61c","file_size":12658,"type":"image/png"}],"allow_singular_disclosure_at":"2017-09-14T17:10:58.369Z","allow_singular_disclosure_after":-128553570.54078081,"singular_disclosure_allowed":true,"vote_count":17,"voters":["zoom7","bagipro","cheatboss","rooteval","povargek","cuso4","circuit","eveeez","r3y","cr4xerbik4sh","and 7 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1843141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Еще можно сделать так, без капчи:\n\n\u003cbody\u003e\n\u003cscript\u003evar script = document.createElement('script');\n script.src = \"https://vk.com/al_groups.php?act=to_public_box\u0026al=1\u0026gid=147481257\";\n document.body.appendChild(script);\n script.onerror = function() {\n\t alert( \"No admin\" );\n };\n \u003c/script\u003e\n \u003c/body\u003e\n\nЕсли пользователь не админ - выдаст алерт, если админ ничего не произойдет. \n","automated_response":false,"created_at":"2017-07-17T14:25:46.811Z","updated_at":"2017-07-17T14:25:46.811Z","actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1844738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Кстати, с помощью последнего кода можно использовать уязвимость как детектор залогиненого пользователя в ВК. Ставим группу id1 и вместо \"No admin\" пишем \"Мы знаем что прямо сейчас ты сидишь ВКонтакте\". Таким образом можно заставлять на сторонних сайтах подписываться на нашу группу людей:)","automated_response":false,"created_at":"2017-07-17T22:18:38.185Z","updated_at":"2017-07-17T22:18:38.185Z","actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1845581,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Здравствуйте! \n\nСпасибо за репорт. Мы его исследуем и сообщим Вам о результатах.","automated_response":false,"created_at":"2017-07-18T08:14:27.956Z","updated_at":"2017-07-18T08:14:27.956Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Фикс :)","automated_response":false,"created_at":"2017-08-01T00:27:40.251Z","updated_at":"2017-08-01T00:27:40.251Z","actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Еще не всё, так что придется еще немного подождать.","automated_response":false,"created_at":"2017-08-01T07:12:36.771Z","updated_at":"2017-08-01T07:12:36.771Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881547,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Поправили. Проверьте, пожалуйста. ","automated_response":false,"created_at":"2017-08-01T08:01:27.541Z","updated_at":"2017-08-01T08:01:27.541Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"circuit","url":"/circuit"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1881711,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Исправлено, все отлично работает, именно так, как должно. Спасибо вам! Буду искать еще!","automated_response":false,"created_at":"2017-08-01T08:58:45.704Z","updated_at":"2017-08-01T08:59:14.332Z","actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1930880,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-15T17:10:58.342Z","updated_at":"2017-08-15T17:10:58.342Z","first_to_agree":true,"actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1940979,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Благодарим за вклад и ждем новых репортов!","automated_response":false,"created_at":"2017-08-19T17:09:48.538Z","updated_at":"2017-08-19T17:09:48.538Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"circuit","url":"/circuit"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1950265,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Если будете открывать, то пожалуйста полностью. Думаю многих заинтересует. И спасибо за баунти. ","automated_response":false,"created_at":"2017-08-23T20:43:11.158Z","updated_at":"2017-08-23T20:43:11.158Z","actor":{"username":"circuit","cleared":false,"url":"/circuit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/373/9546ab66ad2f00ec9496a084aae519e512aa11bb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997412,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-14T17:11:13.026Z","updated_at":"2017-09-14T17:11:13.026Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}