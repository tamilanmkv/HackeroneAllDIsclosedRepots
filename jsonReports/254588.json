{"id":254588,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTQ1ODg=","url":"https://hackerone.com/reports/254588","title":"Removed staff members who had \"Manage shops\" permission can still create development stores","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-29T09:06:43.903Z","submitted_at":"2017-07-29T09:06:43.903Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-11-08T11:03:31.353Z","bug_reporter_agreed_on_going_public_at":"2019-11-08T11:03:31.254Z","team_member_agreed_on_going_public_at":"2018-04-03T18:12:15.820Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Details: \nIt's been found that staff members of an organization in partners.shopify.com can have a permission to manage shops and those with that permission can create development stores that will be associated with the organization.\n\nWhen a staff member tries to create a development store, a POST request is sent to `https://app.shopify.com/services/signup/setup` with the parameter `extra[affiliate_shop]` as the signature used to link the shop with the partners account.\n\nIt's been found that this signature is the same for all staff members of the same organization and it doesn't expire which means that if a staff member had \"Manage Shops\" permission for only one time, then he was removed from the organization he will still be able to create development stores associated with the organization and they will appear in `https://partners.shopify.com/[id]/development_stores` for organization members. \n\n## Steps to reproduce: \n1. Add a new staff member to your organization with \"Manage Shops\" permission. \n2. Login with the staff member you just added then navigate to `https://partners.shopify.com/641767/development_stores/new` and grab the value of `extra[affiliate_shop]` parameter from the source of the page.\n3. Through the owner account remove the user's access to the organization. \n4. Through the new staff member who no longer has access submit the following HTML form: \n\n```\n\u003cform action=\"https://app.shopify.com/services/signup/setup\" method=post\u003e\n\u003cinput name=\"utf8\" value=\"Γ£ô\"\u003e\n\u003cinput name=\"authenticity_token\" value=\"67uDHcA5IBtc1CRcl3teDJND+2w8ahtpbNo4aux93TfHq0MkadWVOPG0h/8Z+jjcWpXw96fX1BbnYTLiG9aqDw==\"\u003e\n\u003cinput name=\"signup[shop_name]\" value=\"NewStoreTestTest1234\"\u003e\n\u003cinput name=\"signup[email]\" value=\"testmahmoud16+2@gmail.com\"\u003e\n\u003cinput name=\"signup[password]\" value=\"P@ssw0rd\"\u003e\n\u003cinput name=\"signup[confirm_password]\" value=\"P@ssw0rd\"\u003e\n\u003cinput name=\"signup_types\" value=\"affiliate_shop\"\u003e\n\u003cinput name=\"signup_source\" value=\"development+shop\"\u003e\n\u003cinput name=\"signup_source_details\" value=\"\"\u003e\n\u003cinput name=\"extra[affiliate_shop]\" value=\"[SIGNATURE]\"\u003e\n\u003cinput name=\"signup[address1]\" value=\"testxx\"\u003e\n\u003cinput name=\"signup[city]\" value=\"test'ad\"\u003e\n\u003cinput name=\"signup[zip]\" value=\"\"\u003e\n\u003cinput name=\"signup[province]\" value=\"DK\"\u003e\n\u003cinput name=\"signup[country]\" value=\"EG\"\u003e\n\u003cinput type=submit\u003e\n\u003c/form\u003e\n```\n*Replace the value of `extra[affiliate_shop]` with the one you got through the staff member*\n\n5. Navigate to `https://partners.shopify.com/[id]/development_stores` through the owner account and you'll see the new store added to the organization even though the staff member no longer has access.\n\nThanks!","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":124,"name":"Improper Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":37,"voters":["vampire000","drsniper","mashoud1122","sameerphad72","dhakal_ananda","powerjacobb1","saltedfish","eveeez","malcolmx","absshax","and 27 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1875700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\n\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2017-07-29T09:06:44.218Z","updated_at":"2017-07-29T09:06:44.218Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1875715,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-07-29T09:08:13.861Z","updated_at":"2017-07-29T09:08:13.861Z","additional_data":{"old_title":"Removed staff members who had \"Manage shops\" can still create development stores","new_title":"Removed staff members who had \"Manage shops\" permission can still create development stores"},"actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1880431,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @zombiehelp54,\nThis issue was previously submitted to us by another researcher, so it will be closed as a duplicate. \nThanks for your interest in improving Shopify security. We look forward to future reports!","automated_response":false,"created_at":"2017-07-31T18:49:33.010Z","updated_at":"2017-07-31T18:49:33.010Z","original_report_id":235065,"actor":{"username":"kristinaelise","cleared":false,"url":"/kristinaelise","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/227/aa2680ab69f8efa9766fd8f981b2587490c5a201_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2368895,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2018-02-09T21:31:57.108Z","updated_at":"2018-02-09T21:31:57.108Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2368898,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Sorry for closing this report as duplicate of #235065. During our internal investigation, it was found that your report was describing a different issue. Our engineering team is working towards a fix for this issue. Once again thank you for your report.","automated_response":false,"created_at":"2018-02-09T21:32:40.885Z","updated_at":"2018-02-09T21:32:40.885Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2421942,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @zombiehelp54, we'll be announcing soon that we are modifying our bug bounty policy to pay our minimum amount on triage, so we are assigning a 500$ bounty to this triaged report. Sorry for the long wait time, and thank you again for reporting this issue.","automated_response":false,"created_at":"2018-02-22T15:09:22.152Z","updated_at":"2018-02-22T15:09:22.152Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2477421,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report! We have recently deployed a fix for this issue. \n\nTo exploit this issue an attacker would need to be member of an organization with `manage_shops` permission. Our typical bounty for this type of issue is $500. Since we have already awarded $500 to this report during triage, there won't be any additional bounty awarded.","automated_response":false,"created_at":"2018-03-09T16:40:52.766Z","updated_at":"2018-03-09T16:40:52.766Z","actor":{"username":"lalith-shopify","cleared":false,"url":"/lalith-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2479475,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-10T13:27:32.786Z","updated_at":"2018-03-10T13:27:32.786Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":127172},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2560024,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-03T18:12:15.870Z","updated_at":"2018-04-03T18:12:15.870Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2890051,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2018-06-15T18:56:55.819Z","updated_at":"2018-06-15T18:56:55.819Z","additional_data":{"added_weaknesses":[{"id":124,"name":"Improper Authorization"}],"removed_weaknesses":[{"id":26,"name":"Improper Access Control - Generic"}]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2890053,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-06-15T18:57:28.366Z","updated_at":"2018-06-15T18:57:28.366Z","additional_data":{"old_severity":"Low","new_severity":"Medium (5.0)","old_severity_id":127172,"new_severity_id":168658},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6253592,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-08T11:03:31.282Z","updated_at":"2019-11-08T11:03:31.282Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6253593,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-11-08T11:03:31.378Z","updated_at":"2019-11-08T11:03:31.378Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}