{"id":258260,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTgyNjA=","url":"https://hackerone.com/reports/258260","title":"Accessing Private Files Shared in message of other users","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-09T13:41:24.495Z","submitted_at":"2017-08-09T13:41:24.495Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-23T14:31:47.355Z","bug_reporter_agreed_on_going_public_at":"2018-06-23T14:31:43.382Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\n###Description:\n-----------\nUsers can send message to each other as well as attach and share the files as well, and the flow is like once user upload the file on the server, the file get assigned by unique id named **`MediaIDs`** which is vulnerable for IDOR.\n\n\n###Step To Reproduce: \n-----------\n+ Get logged into account!\n+ Send text msg with attachment to other test account.\n+ Intercept the request which send the msg!\n+ Change the value of **`MediaIDs`** and replace with any other id.\n+ You will get the accessible url of that file the response which belong to some other users. \n\n###Exploitability: \n+ Attacker can extract all the private files shared between all the users.\n\n###Possible Fix:\n-----------\n+ Maintain the access control properly.\n\n\nPlease let me know if any more info needed !\n\n-------------\n\n__*- Geekboy!*__","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-23T14:31:43.465Z","allow_singular_disclosure_after":-101606407.99009404,"singular_disclosure_allowed":true,"vote_count":22,"voters":["sameerphad72","spam404","ali","hackerhero","aryan2808","hackkeencyber","idiablos","eveeez","khizer47","vulnh0lic","and 12 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1916387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is the poc video in case if needed: \n\n{F210926}","automated_response":false,"created_at":"2017-08-09T13:48:39.952Z","updated_at":"2017-08-09T13:48:39.952Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":210926,"filename":"2017-08-09_19-16-45.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/210/926/bf7428b16c23d03fe9ca22cdaa3394af123d4559/2017-08-09_19-16-45.mp4?response-content-disposition=attachment%3B%20filename%3D%222017-08-09_19-16-45.mp4%22%3B%20filename%2A%3DUTF-8%27%272017-08-09_19-16-45.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143151Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9f7e063046105025156d4fbca2fd20780f6c0067a94d78c634733e50d995d584"}],"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1916691,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-08-09T16:05:47.129Z","updated_at":"2017-08-09T16:05:47.129Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (6.5)","old_severity_id":66329,"new_severity_id":66359},"actor":{"username":"tburry","cleared":false,"url":"/tburry","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/190/499/3a293de3bd6e5bafafc57dd7c4bb58ad21f47975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1922264,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We've determined this is a valid, medium-severity issue. I anticipate we'll be able to ship a patch in approximately 1-2 weeks. Thanks for finding this and reporting it.","automated_response":false,"created_at":"2017-08-11T17:49:45.622Z","updated_at":"2017-08-11T17:49:45.622Z","actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1957744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Team, \n\ndo we have any ETA on these reports ?","automated_response":false,"created_at":"2017-08-27T02:36:17.120Z","updated_at":"2017-08-27T02:36:17.120Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2043420,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-04T14:39:45.689Z","updated_at":"2017-10-04T14:39:45.689Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vanilla"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"geekboy","url":"/geekboy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2168922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nit's quite long since report? do we have any information on the patch, was planning for the blog post in the future about this.","automated_response":false,"created_at":"2017-11-20T00:25:23.945Z","updated_at":"2017-11-20T00:25:23.945Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2231989,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-12-18T17:09:04.041Z","updated_at":"2017-12-18T17:09:04.041Z","actor":{"username":"daazku","cleared":false,"url":"/daazku","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/360/18b0766d70806965db60ff0f4cdd17ea4a6d1d42_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2231996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been patched and deployed on our servers.","automated_response":false,"created_at":"2017-12-18T17:09:49.889Z","updated_at":"2017-12-18T17:09:49.889Z","actor":{"username":"daazku","cleared":false,"url":"/daazku","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/360/18b0766d70806965db60ff0f4cdd17ea4a6d1d42_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232039,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good to know that @daazku, do you guys maintain any changelog for security issues?","automated_response":false,"created_at":"2017-12-18T17:18:25.280Z","updated_at":"2017-12-18T17:18:25.280Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Unfortunately, nothing public.\nThe best that you can have access to would be: https://docs.vanillaforums.com/help/releases/2017/\nBut we do not list everything there.","automated_response":false,"created_at":"2017-12-18T17:38:56.830Z","updated_at":"2017-12-18T17:38:56.830Z","actor":{"username":"daazku","cleared":false,"url":"/daazku","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/360/18b0766d70806965db60ff0f4cdd17ea4a6d1d42_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can also use this: https://github.com/vanilla/vanilla/search?q=vanilla-patches\u0026type=Commits\u0026utf8=%E2%9C%93","automated_response":false,"created_at":"2017-12-18T17:41:07.715Z","updated_at":"2017-12-18T17:41:07.715Z","actor":{"username":"daazku","cleared":false,"url":"/daazku","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/360/18b0766d70806965db60ff0f4cdd17ea4a6d1d42_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay @daazku, was thinking to get CVE assigned for few critically I submitted to Vanilla, not sure how its possible without any public release, is there anything you can help with CVE?","automated_response":false,"created_at":"2017-12-18T17:42:19.536Z","updated_at":"2017-12-18T17:42:19.536Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It may be possible to redact the hacker one issues that you want to be public. I'll have to talk about this with the rest of our team though (and since we are at the end of December most people are on vacation so this may take time)","automated_response":false,"created_at":"2017-12-18T17:47:07.214Z","updated_at":"2017-12-18T17:47:07.214Z","actor":{"username":"daazku","cleared":false,"url":"/daazku","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/360/18b0766d70806965db60ff0f4cdd17ea4a6d1d42_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2232193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, not in hurry @daazku, just let me know when you have words with your teammates :)","automated_response":false,"created_at":"2017-12-18T17:48:57.351Z","updated_at":"2017-12-18T17:48:57.351Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2925642,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-23T14:31:43.415Z","updated_at":"2018-06-23T14:31:43.415Z","first_to_agree":true,"actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3084353,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-23T14:31:47.393Z","updated_at":"2018-07-23T14:31:47.393Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vanilla"}},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}