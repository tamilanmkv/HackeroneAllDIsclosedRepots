{"id":258876,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTg4NzY=","url":"https://hackerone.com/reports/258876","title":"XSS when clicking \"Share to Twitter\" at quora.com/widgets/embed_iframe?path=...","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-08-11T09:00:04.923Z","submitted_at":"2017-08-11T09:00:04.923Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3152,"url":"https://hackerone.com/quora","handle":"quora","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Quora","twitter_handle":"quora","website":"http://www.quora.com","about":"A place to share knowledge and better understand the world."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-01-11T19:59:23.801Z","bug_reporter_agreed_on_going_public_at":"2018-01-11T02:43:11.365Z","team_member_agreed_on_going_public_at":"2018-01-11T19:59:23.687Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe endpoint at `https://{language}.quora.com/widgets/embed_iframe?path={path_to_answer_in_same_language}` shows the answer you specify in _path_ (like `/Question/answer/User`) in a format useful to embed.\nThere is one button _Share_ that when clicked shows another button _Share to Twitter_. The `href` attribute of this last button is of the format `javascript: window.open(\u0026quot;https://twitter.com/intent/tweet?text=Answer on @Quora by @User to Question? http://qr.ae/nnnn\u0026quot;, \u0026quot;Share Answer to Twitter\u0026quot;, \u0026quot;width=600, height=250\u0026quot;)`.\nThe problem is that you can create a question with `\"` (quotes) and inject Javascript code that is going to be executed when the user clicks _Share to Twitter_.\n\n**Description (Include Impact):**\nIt requires user interaction, but it works.\n\n### Steps To Reproduce\n\n1. Go to https://www.quora.com/\n2. Click on _Ask Question_ \n3. Enter a valid question which includes `\"-alert(document.domain)-\"` somewhere. I entered `Question ignore \"-alert(document.domain)-\"?` and it was accepted as valid\n4. Now you may be in the page of the question you just asked\n5. Click on _Answer_\n6. Enter anything\n7. Click on _Submit_\n8. Copy the path from the address bar. Mine was `/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar`\n9. Go to `https://www.quora.com/widgets/embed_iframe?path={path_from_last_step}`. Mine is https://www.quora.com/widgets/embed_iframe?path=/Question-ignore-alert-document-domain/answer/Cuenta-Para-Probar\n10. Click on _Share_\n11. Click on _Share to Twitter_\n12. `alert(document.domain)` is executed\n\n### Optional: Your Environment (Browser version, Device, app version, os version etc)\n\n * It is not browser dependent. Anyway, I tested it on Firefox, Chrome and Safari for Mac.\n\n### Optional: Supporting Material/References (Screenshots)\n\n * I don't think is necessary, but let me know if you need something else.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["sourc7","hackedbrain","eveeez","malcolmx","khizer47","m7mdharoun","cr4xerbik4sh","raguljr","zerotoone","sumit7","and 5 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2085308,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-10-19T18:02:51.237Z","updated_at":"2017-10-19T18:02:51.237Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2085311,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Sorry for the long delay.","automated_response":false,"created_at":"2017-10-19T18:03:10.746Z","updated_at":"2017-10-19T18:03:10.746Z","actor":{"url":"/quora","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/57b2b1ab624538b6b1a515c5b03f929ef41e0dfd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Quora"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"quora","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2087714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries. Thank you for the bounty!","automated_response":false,"created_at":"2017-10-20T12:04:03.990Z","updated_at":"2017-10-20T12:04:03.990Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2199524,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed now. Can you verify?","automated_response":false,"created_at":"2017-12-04T18:41:22.936Z","updated_at":"2017-12-04T18:41:22.936Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2210609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sriram-quora,\n\nI just checked and it seems that I'm still able to reproduce it. :( \nThis is the question I created https://www.quora.com/widgets/embed_iframe?path=/Blalasd-really-alert-document-domain/answer/Cuenta-Para-Probar\n\nSorry for the delay.","automated_response":false,"created_at":"2017-12-09T00:39:01.827Z","updated_at":"2017-12-09T00:39:01.827Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2236297,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks - we think we've fixed it now, can you try again?","automated_response":false,"created_at":"2017-12-19T21:48:22.192Z","updated_at":"2017-12-19T21:48:22.192Z","actor":{"username":"jessie","cleared":false,"url":"/jessie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2245267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jessie,\n\nit looks fixed now! ","automated_response":false,"created_at":"2017-12-24T21:57:09.490Z","updated_at":"2017-12-24T21:57:09.490Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2260648,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-01-03T22:30:08.542Z","updated_at":"2018-01-03T22:30:08.542Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2276555,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi. If it's okay for you I would like to make this report public. Thank you in advance.","automated_response":false,"created_at":"2018-01-11T02:43:11.407Z","updated_at":"2018-01-11T02:43:11.407Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278673,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-01-11T19:59:23.726Z","updated_at":"2018-01-11T19:59:23.726Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278674,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-01-11T19:59:23.830Z","updated_at":"2018-01-11T19:59:23.830Z","actor":{"username":"sriram-quora","cleared":false,"url":"/sriram-quora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2279519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2018-01-12T04:54:30.836Z","updated_at":"2018-01-12T04:54:30.836Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"quora","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}