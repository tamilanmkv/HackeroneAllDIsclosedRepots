{"id":260689,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjA2ODk=","url":"https://hackerone.com/reports/260689","title":"Weak Cryptography for Passwords","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2017-08-16T12:06:08.883Z","submitted_at":"2017-08-16T12:06:08.883Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tejpratap","url":"/tejpratap","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-21T06:19:37.816Z","bug_reporter_agreed_on_going_public_at":"2017-08-21T06:19:37.772Z","team_member_agreed_on_going_public_at":"2017-08-16T18:36:27.560Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nI saw while creating new account.Password is being encrypted that's good best practice.\n\nBut Issue is:\n\n1. It is showing in the request What type of encryption(Algorithm)  is used in request.\n2. I copied the encrypted password and past it online tool http://md5decrypt.net/en/Sha256/ and i was successfully able to decrypt.\n\nAs per owasp Rule you should not use Sha256 These algorithms are considered weak.\n\nLink : https://www.owasp.org/index.php/Guide_to_Cryptography\n\nStep To Reproduce:\n\n1. Resister mew account in https://app.legalrobot.com/.\n2. Capture the request in burpsuite tool.\n3. Copy the encrypted password and paste in online tool   http://md5decrypt.net/en/Sha256/ it will successfully  decrypt the password.\n\nMitigation.\n1. Which encryption(Algorithm) it should be displayed in the request.\n2. Use strong encryption so that Man in middle attack should not be able to decrypt password.\n\nI have attached Poc.\n\nTej \n\n","weakness":{"id":25,"name":"Weak Cryptography for Passwords"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":213362,"file_name":"Decrypy.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/213/362/768ebf69e50072ab29d356d8684ca2cc2b999da2/Decrypy.png?response-content-disposition=attachment%3B%20filename%3D%22Decrypy.png%22%3B%20filename%2A%3DUTF-8%27%27Decrypy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143229Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=479c6ed2ac48ae1a3600583c6506f37dec591e096d71a66f75396edcf2d96062","file_size":143940,"type":"image/png"},{"id":213363,"file_name":"Password.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/213/363/361c53677563af75a67844b469e263c62ff8d278/Password.png?response-content-disposition=attachment%3B%20filename%3D%22Password.png%22%3B%20filename%2A%3DUTF-8%27%27Password.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143229Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1794068d712caf53cc61dbc6b5a1a453ff6da8647bb760e0364dcf88af08c376","file_size":948312,"type":"image/png"},{"id":213364,"file_name":"Legal.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/213/364/dc5882280f7b9e1c1bebd9c654f3807badf12b3e/Legal.png?response-content-disposition=attachment%3B%20filename%3D%22Legal.png%22%3B%20filename%2A%3DUTF-8%27%27Legal.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143229Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4f9b83cb4b868651ac98471c4427dc26269a88d4d34964f6fa439c4017553d5a","file_size":2588639,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["tejpratap"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":519,"asset_type":"URL","asset_identifier":"app.legalrobot.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1934126,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-08-16T18:32:43.259Z","updated_at":"2017-08-16T18:32:43.259Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":68522,"new_severity_id":68610},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1934127,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. Yes, we use SHA256 to hash the password before sending it over the wire. However, we only transmit the message over TLS, where we're rather sure that the connection is secure since we use HPKP, HSTS, and defend against rogue cert issuance with DNS CAA records, and CT notifications.\n\nSo, *if* someone was able to intercept and decrypt the login message, there could be a productive attack but we're reasonably sure that pinning our keys, using CAA records, and other mitigation factors are sufficient to block this kind of attack. In fact, I have written about this rather extensively [here](https://github.com/meteor/meteor-feature-requests/issues/44), where I tried to push for encryption and signing to mitigate this type of attack for folks running Meteor that don't have all of the HSTS/HPKP/CAA/CT stuff set up as we do.\n\nI'll be more than happy to reopen this if you can demonstrate a productive attack on app.legalrobot-uat.com.\nThanks!","automated_response":false,"created_at":"2017-08-16T18:32:48.013Z","updated_at":"2017-08-16T18:32:48.013Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1934146,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-16T18:36:27.583Z","updated_at":"2017-08-16T18:36:27.583Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1934156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One more thing, just to close the loop - we certainly don't store the passwords as SHA256 :-)\nWe currently use bcrypt with a sufficient work factor and are thinking of switching to scrypt.","automated_response":false,"created_at":"2017-08-16T18:38:50.686Z","updated_at":"2017-08-16T18:38:50.686Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1942552,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-21T06:19:37.800Z","updated_at":"2017-08-21T06:19:37.800Z","actor":{"username":"tejpratap","cleared":false,"url":"/tejpratap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1942553,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-21T06:19:37.835Z","updated_at":"2017-08-21T06:19:37.835Z","actor":{"username":"tejpratap","cleared":false,"url":"/tejpratap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}