{"id":268245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjgyNDU=","url":"https://hackerone.com/reports/268245","title":"XSS in biz.mail.ru/error","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-14T07:00:55.053Z","submitted_at":"2017-09-14T07:00:55.053Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chaosbolt","url":"/chaosbolt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-09T12:23:01.934Z","bug_reporter_agreed_on_going_public_at":"2017-10-04T15:15:19.771Z","team_member_agreed_on_going_public_at":"2017-10-09T12:23:01.880Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again! I've found an open redirect issue and possibility to bypass your filters to add direct links in \u003ca href=\"#user input\"\u003e tag\n\nDomain, site, application: biz.mail.ru/error\n\nTesting environment: latest Chrome\n\nSteps to reproduce:\n1) go to https://biz.mail.ru/error/500/?from=%20https://www.google.com\n2) click Refresh\n\nActual results: you will be redirected to google. And as always, there might be different website that will steal user login credentials or run scripts\n\nExpected results, security impact description and recommendations: redirects are not allowed\n\nPoC, exploit code, screenshots, video, references, additional resources\n\nAs i said, go to https://biz.mail.ru/error/500/?from=%20https://www.google.com and click Refresh\n\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-03T15:15:19.872Z","allow_singular_disclosure_after":-124240743.73106745,"singular_disclosure_allowed":true,"vote_count":33,"voters":["erg0n-xx","jokebookservice1","jensec","bogdantcaciuc","danila","s_p_q_r","003random","emitrani","0x01alka","michan","and 23 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":250,"asset_type":"URL","asset_identifier":"biz.mail.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1996115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"let me explain the problem:\nAt first i got this 500 external error link (at first it looked like \"biz.mail.ru/error/500/?from=https://biz.mail.ru/\") and parameter ?from seemed dangerous to me, so i looked deeper into page. after quick research i found our that ?from is using in \"\u003ca href=\"?from\" class=\"btn\"\u003ebutton\u003c/a\u003e\" element so i started to add payloads. Simple ?from=https://www.google.com didn't work due to sanitize, so i found a way to avoid it - if we add nullbyte before our malicious link (%00https://www.google.com) and press button to refresh, we will be redirected to that address, but %00 can not be converted by url and we get 404 error inside mail.ru, so i decided to add %20 before malicious link and it worked out.","automated_response":false,"created_at":"2017-09-14T07:06:43.504Z","updated_at":"2017-09-14T07:20:33.689Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1996143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This also leads to dangerous XSS: https://biz.mail.ru/error/500/?from=%20javascript:alert() after you click Refresh it will be executed as javascript . Additional info: %09 in ?from= before payload also works.\ninteresting payloads that are working out too:\nhttps://biz.mail.ru/error/500/?from=javascript:javascript:alert(1)\nhttps://biz.mail.ru/error/500/?from=https://www.google.comhttps://www.google.com","automated_response":false,"created_at":"2017-09-14T07:26:15.088Z","updated_at":"2017-09-14T07:38:51.049Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1996273,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.","automated_response":false,"created_at":"2017-09-14T09:17:07.288Z","updated_at":"2017-09-14T09:17:07.288Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1996434,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2017-09-14T11:28:54.044Z","updated_at":"2018-02-28T13:11:24.020Z","additional_data":{"added_weaknesses":[{"id":63,"name":"Cross-site Scripting (XSS) - DOM"}],"removed_weaknesses":[{"id":53,"name":"Open Redirect"}]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2008450,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem","automated_response":false,"created_at":"2017-09-20T12:19:16.304Z","updated_at":"2017-09-20T12:19:16.304Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"chaosbolt","url":"/chaosbolt"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2008461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thank you for the bounty!","automated_response":false,"created_at":"2017-09-20T12:24:15.577Z","updated_at":"2017-09-20T12:24:15.577Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2009252,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-09-20T16:03:43.274Z","updated_at":"2017-09-20T16:03:43.274Z","additional_data":{"old_title":"Open redirect at biz.mail.ru/error","new_title":"XSS in biz.mail.ru/error"},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2043404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2017-10-04T14:31:53.082Z","updated_at":"2017-10-04T14:31:53.082Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chaosbolt","url":"/chaosbolt"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2043526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, seems cool","automated_response":false,"created_at":"2017-10-04T15:14:44.844Z","updated_at":"2017-10-04T15:14:44.844Z","actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2043531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"may we disclose that one?","automated_response":false,"created_at":"2017-10-04T15:15:19.815Z","updated_at":"2017-10-04T15:15:19.815Z","first_to_agree":true,"actor":{"username":"chaosbolt","cleared":true,"url":"/chaosbolt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2053221,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-10-09T12:23:01.905Z","updated_at":"2017-10-09T12:23:01.905Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2053222,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-10-09T12:23:01.955Z","updated_at":"2017-10-09T12:23:01.955Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":6250,"category":"researcher","content":"XSS via invocking javascript in \u003ca\u003e tag ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":191587,"username":"chaosbolt","name":"1","bio":"","cleared":true,"website":null,"location":"","created_at":"2017-08-14T03:46:53.007Z","url":"https://hackerone.com/chaosbolt","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/d81xKAqqBxYLV8QQn83n3V5d/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}