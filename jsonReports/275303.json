{"id":275303,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzUzMDM=","url":"https://hackerone.com/reports/275303","title":" Account Restore / Reactivating an old email via old reset link","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-10-07T07:31:06.508Z","submitted_at":"2017-10-07T07:31:06.508Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"footstep","url":"/footstep","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/985/40da829a3798f18b2e1a5c4eeb47ad988b8ed35a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-27T19:07:44.260Z","bug_reporter_agreed_on_going_public_at":"2018-08-27T19:07:44.176Z","team_member_agreed_on_going_public_at":"2018-08-27T09:23:17.736Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI noticed you now send a confirmation link after loading the reset link, below is a screenshot showing the email and highlighting the error.\n\n{F227060}\n\nBest Regards,\n@footstep","original_report_id":null,"original_report_url":null,"attachments":[{"id":227060,"file_name":"Screen_Shot_2017-10-07_at_8.09.58_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/060/ae29b79ae0c5ab161df1f8ab36f9e5b8e417566e/Screen_Shot_2017-10-07_at_8.09.58_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-10-07_at_8.09.58_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-10-07_at_8.09.58_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143623Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b72c4f5827b55d3d288f8234261f5486460aee9feff2e1170a6c8cd2e63dd48","file_size":273594,"type":"image/png"}],"allow_singular_disclosure_at":"2018-09-26T09:23:17.877Z","allow_singular_disclosure_after":-96009185.61058606,"singular_disclosure_allowed":true,"vote_count":4,"voters":["r3y","arifmkhls","cryptographer","illusionist3886"],"structured_scope":{"databaseId":171,"asset_type":"URL","asset_identifier":"hosted.weblate.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2051082,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"What's wrong there? The password is reset at this point and password authentication is disabled until user sets new password.","automated_response":false,"created_at":"2017-10-07T13:35:00.429Z","updated_at":"2017-10-07T13:35:00.429Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051129,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Oh! Sorry I missed that but I did found another issue. Please change the title to the one below.\n\n------------------------\n**Title**\nAccount Restore / Reactivating an old email via old reset link\n\n **Description**\nI discovered that old password reset link requested from a removed email still works and when used successfully resets the account and adds the email back to the account\n\n**Reproduction Steps**\n1. Setup an account with 2 emails (preferably 1 email and the other Google association)\n2. Request password reset in another browser with the email in (1)\n3. In the other browser, disconnect the email leaving the Google association\n4. Use the reset link you got in (2) in the another browser\n5. You'll get 2 mails in your Google email (the Google association) like below\n{F227096}\n6. At this point, password is reset\n7. Login via Google association\n8. Navigate to the Authentication tab in your profile, https://demo.weblate.org/accounts/profile/#auth\n9. You'll find the email restored.\n\nBest,\n@footstep \n","automated_response":false,"created_at":"2017-10-07T14:33:51.389Z","updated_at":"2017-10-07T14:33:51.389Z","actor":{"username":"footstep","cleared":true,"url":"/footstep","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/985/40da829a3798f18b2e1a5c4eeb47ad988b8ed35a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":227096,"filename":"Screen_Shot_2017-10-07_at_3.27.27_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/227/096/df9cd9178646a32d10b6b41ebdca45c89411e346/Screen_Shot_2017-10-07_at_3.27.27_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-10-07_at_3.27.27_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-10-07_at_3.27.27_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143623Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fda5f8764b6b161262add06d74087c2229d5bc4132aac335625fc50d9f5a2430"}],"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2052118,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-10-08T17:31:09.246Z","updated_at":"2017-10-08T17:31:09.246Z","additional_data":{"old_title":"Error in Reset Link Confirmation Email","new_title":" Account Restore / Reactivating an old email via old reset link"},"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2052123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is kind of expected, because technically the password reset is email based login. I don't think there is any problem with this, though it can probably be a bit confusing.","automated_response":false,"created_at":"2017-10-08T17:33:01.766Z","updated_at":"2017-10-08T17:33:01.766Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2052240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should not be confusing at all, the email has been disconnected from the account and the reset link generated for the email still works after it had been disconnected.\n\nThe email should not have access to the account anymore.\n\nPS: You do have a security measure in place so that the reset link cannot be requested with the email after it had been disconnected. Now you need to add that the reset link generated for a disconnected email should be invalidated so it doesn't work.\n\nHope it's clear now :)","automated_response":false,"created_at":"2017-10-08T18:48:53.153Z","updated_at":"2017-10-08T18:48:53.153Z","actor":{"username":"footstep","cleared":true,"url":"/footstep","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/985/40da829a3798f18b2e1a5c4eeb47ad988b8ed35a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2061223,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The email is still associated with the account through third party authentication, so it's not that it would not be associated at all. But you're right that on removal pending tokens should be invalidated.\n\nThis should be fixed by https://github.com/WeblateOrg/weblate/commit/299a3e04d1668aa6dc53b94672dec713eb8ecbab and will be deployed later today.","automated_response":false,"created_at":"2017-10-12T11:48:06.397Z","updated_at":"2017-10-12T11:48:06.397Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"footstep","url":"/footstep"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3251668,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-08-27T09:23:17.783Z","updated_at":"2018-08-27T09:23:17.783Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3254617,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure 😊","automated_response":false,"created_at":"2018-08-27T19:07:44.209Z","updated_at":"2018-08-27T19:07:44.209Z","actor":{"username":"footstep","cleared":true,"url":"/footstep","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/985/40da829a3798f18b2e1a5c4eeb47ad988b8ed35a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3254618,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-08-27T19:07:44.285Z","updated_at":"2018-08-27T19:07:44.285Z","actor":{"username":"footstep","cleared":true,"url":"/footstep","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/985/40da829a3798f18b2e1a5c4eeb47ad988b8ed35a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}