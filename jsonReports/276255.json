{"id":276255,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzYyNTU=","url":"https://hackerone.com/reports/276255","title":"Use of unitialized value in token_check_object (src/or/parsecommon.c:224)","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-10-11T04:53:58.839Z","submitted_at":"2017-10-11T04:53:58.839Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-04T16:25:57.684Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:25:57.635Z","team_member_agreed_on_going_public_at":"2017-11-07T01:56:37.353Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Triggered in `22139c0`, compiled with `-fsanitize=memory` and clang 6.0.0-trunk.\n\n`./fuzz-consensus \u003c test00d68`\n\n```\n=9591==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55ca86e51348 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55ca86e51348 in get_next_token /root/tor/src/or/parsecommon.c:397\n    #2 0x55ca86e3ff83 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55ca8711139a in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55ca8676fbd1 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55ca8676f29d in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f32a84f2b44 in __libc_start_main /build/glibc-6V9RKT/glibc-2.19/csu/libc-start.c:287\n    #7 0x55ca866fc8ce in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x3bc8ce)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\n```","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":274998,"original_report_url":"https://hackerone.com/reports/274998","attachments":[{"id":228135,"file_name":"test00d68.gz","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/228/135/713b5d32a79bb3ff3449fe4ed64ca368702580cb/test00d68.gz?response-content-disposition=attachment%3B%20filename%3D%22test00d68.gz%22%3B%20filename%2A%3DUTF-8%27%27test00d68.gz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143633Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=689bda0d4b9dbba4047b11f6f5cfa604a5f74e98820418a87b6ab3d23d126028","file_size":1475,"type":"application/gzip"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["0xd0m7","geeknik","x0x01"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2102506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"better stack trace:\n\n```\n==27377==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x55f18fea89d4 in token_check_object /root/tor/src/or/parsecommon.c:224:13\n    #1 0x55f18fea4fc7 in get_next_token /root/tor/src/or/parsecommon.c:397:9\n    #2 0x55f18fea1a93 in tokenize_string /root/tor/src/or/parsecommon.c:72:11\n    #3 0x55f1900356ce in networkstatus_parse_vote_from_string /root/tor/src/or/routerparse.c:3417:7\n    #4 0x55f18fae8b33 in fuzz_main /root/tor/src/test/fuzz/fuzz_consensus.c:66:8\n    #5 0x55f18fae7fc0 in main /root/tor/src/test/fuzz/fuzzing_common.c:179:3\n    #6 0x7f39f76c63f0 in __libc_start_main /build/glibc-mXZSwJ/glibc-2.24/csu/../csu/libc-start.c:291\n    #7 0x55f18fa75a19 in _start (/root/tor/src/test/fuzz/fuzz-consensus+0x71a19)\n\n  Uninitialized value was created by a heap allocation\n    #0 0x55f18fa9e77d in __interceptor_malloc (/root/tor/src/test/fuzz/fuzz-consensus+0x9a77d)\n    #1 0x7f39f8a45e87 in CRYPTO_malloc (/lib/x86_64-linux-gnu/libcrypto.so.1.0.0+0x62e87)\n\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /root/tor/src/or/parsecommon.c:224:13 in token_check_object\nExiting\n```","automated_response":false,"created_at":"2017-10-25T18:35:56.654Z","updated_at":"2017-10-25T18:35:56.654Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2139000,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks for the report. This looks like a very similar code path as #274998, where the memory allocated and written to in libcrypto isn't marked by MemorySanitizer as initialized, probably due to lack of instrumentation in libcrypto.","automated_response":false,"created_at":"2017-11-07T01:55:53.586Z","updated_at":"2017-11-07T01:55:53.586Z","original_report_id":274998,"actor":{"username":"argonblue","cleared":false,"url":"/argonblue","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2139003,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-07T01:56:37.403Z","updated_at":"2017-11-07T01:56:37.403Z","first_to_agree":true,"actor":{"username":"argonblue","cleared":false,"url":"/argonblue","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960702,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-04T16:25:57.656Z","updated_at":"2019-10-04T16:25:57.656Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960703,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-04T16:25:57.703Z","updated_at":"2019-10-04T16:25:57.703Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}