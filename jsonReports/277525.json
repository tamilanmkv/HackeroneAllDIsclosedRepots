{"id":277525,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzc1MjU=","url":"https://hackerone.com/reports/277525","title":"Formula injection via CSV exports in WordCamp Talks plugin","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-10-15T23:19:41.070Z","submitted_at":"2017-10-15T23:19:41.070Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whitehatter","url":"/whitehatter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/077/358/2c8b65e6a1929dcd9bd6a214857909ea5d127f88_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":162,"url":"https://hackerone.com/iandunn-projects","handle":"iandunn-projects","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ian Dunn","twitter_handle":"","website":"","about":"I'm a WordPress developer who maintains several small open source projects."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-23T18:47:08.830Z","bug_reporter_agreed_on_going_public_at":"2017-10-23T18:47:08.718Z","team_member_agreed_on_going_public_at":"2017-10-23T18:42:48.933Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The WordCamp Talks plugin does not attempt to sanitize CSV exports, which can lead to spreadsheet formula injection via malicious inputs.\n\nPOC\n========\n\n* Submit a new talk with the title of `=1+1`. \n* Visit the All Talks page (/wp-admin/edit.php?post_type=talks)\n* Click the CSV Export link\n* Open the downloaded file in Excel, Numbers, or similar\n* Note that the talk's title is displayed as `2`, showing the title was imported as a formula.\n\nImpact\n===========\n\nExcel allows external commands to be executed via formulas after a warning prompt. The warning says \"Do not enable this content unless you trust the source of this file\", but since most users _do_ trust the source (their WordCamp site), they may be more likely to allow it.\n\nLots of arbitrary commands can be executed this way, including installing other commands in a way that can bypass antivirus scanning. \n\nMore details can be found at https://pentestmag.com/formula-injection/\n\nRemedy\n=========\n\n`wct_generate_csv_content()` needs to ensure that the first character in each value is not one of `=`, `-`, or `+`. These can come from several columns such as the title, categories, and tags, so all data should be sanitized.\n\nFurther info:\n\nhttps://www.owasp.org/index.php/CSV_Excel_Macro_Injection\nhttps://hackerone.com/reports/72785","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-22T18:42:49.043Z","allow_singular_disclosure_after":-122586845.59905995,"singular_disclosure_allowed":true,"vote_count":13,"voters":["bl4de","tapani","yumi","eveeez","r3y","dz_samir","khizer47","japz","sa1tama0","ph0b0s","and 3 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2067807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, I should have time to look into this in the next few days.","automated_response":false,"created_at":"2017-10-16T02:53:23.337Z","updated_at":"2017-10-16T02:53:23.337Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2067972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Mathieu, do you have time to take a look at this? I think it's [the same thing we talked about awhile ago](https://wordpress.slack.com/archives/G3V55C92S/p1484944809000002)\n\nShould be an easy fix w/ the `esc_csv()` function mentioned in that message.","automated_response":false,"created_at":"2017-10-16T03:05:04.873Z","updated_at":"2017-10-16T03:05:04.873Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2068031,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2017-10-16T03:56:47.262Z","updated_at":"2017-10-16T03:56:47.262Z","actor":{"username":"imath","cleared":false,"url":"/imath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/986/43eae8c17b5754d71aca360b911fd2483f1bb4f4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2068046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Ian,\n\nSure, i already included the fix into the PR from the WordCampParis github fork:\nhttps://github.com/WordCampParis/wordcamp-talks/commit/e989c6f4423aa5e408e8ba9bfdba515c1167ae49#diff-ca61126ebb9d744b03eea614f4356ea3R1429\n\nI’m going to commit this specific code into the main repo.","automated_response":false,"created_at":"2017-10-16T04:38:17.693Z","updated_at":"2017-10-16T04:38:17.693Z","actor":{"username":"imath","cleared":false,"url":"/imath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/986/43eae8c17b5754d71aca360b911fd2483f1bb4f4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2070689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again, i’ve just committed this https://github.com/imath/wordcamp-talks/commit/1b98f93c6370777de300bbd463878539452899d3 it shoukd fix the issue.","automated_response":false,"created_at":"2017-10-16T20:22:42.401Z","updated_at":"2017-10-16T20:22:42.401Z","actor":{"username":"imath","cleared":false,"url":"/imath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/986/43eae8c17b5754d71aca360b911fd2483f1bb4f4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2074285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks good to me.","automated_response":false,"created_at":"2017-10-17T21:46:07.097Z","updated_at":"2017-10-17T21:46:07.097Z","actor":{"username":"whitehatter","cleared":true,"url":"/whitehatter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/358/2c8b65e6a1929dcd9bd6a214857909ea5d127f88_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2074415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks whitehatter I’ve double checked with the camptix unit test: https://plugins.trac.wordpress.org/browser/camptix/trunk/tests/test-camptix.php and there were some non covered cases, so this commit should be more complete https://github.com/imath/wordcamp-talks/commit/170f7f025990ce82db6e79aacc1d2f208f4600b0","automated_response":false,"created_at":"2017-10-17T22:51:48.376Z","updated_at":"2017-10-17T22:51:48.376Z","actor":{"username":"imath","cleared":false,"url":"/imath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/986/43eae8c17b5754d71aca360b911fd2483f1bb4f4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2086916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, that code looks even better.","automated_response":false,"created_at":"2017-10-20T01:28:27.084Z","updated_at":"2017-10-20T01:28:27.084Z","actor":{"username":"whitehatter","cleared":true,"url":"/whitehatter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/358/2c8b65e6a1929dcd9bd6a214857909ea5d127f88_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2089938,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report @whitehatter. I'll go ahead and assign a bounty.\n\n@imath, thanks for getting it fixed. Are you ok with disclosing this publicly now, or do you need time to update any sites that are running the plugin?","automated_response":false,"created_at":"2017-10-20T19:02:10.723Z","updated_at":"2017-10-20T19:02:10.723Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"whitehatter","url":"/whitehatter"},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2089966,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-20T19:09:17.046Z","updated_at":"2017-10-20T19:09:17.046Z","actor":{"url":"/iandunn-projects","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ian Dunn"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"iandunn-projects","collaborator":{"username":"whitehatter","url":"/whitehatter"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2091346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@iandunn sure i’ve added the fix everywhere :)","automated_response":false,"created_at":"2017-10-21T09:50:15.862Z","updated_at":"2017-10-21T09:50:48.250Z","actor":{"username":"imath","cleared":false,"url":"/imath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/986/43eae8c17b5754d71aca360b911fd2483f1bb4f4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2096339,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! Requesting disclosure now.","automated_response":false,"created_at":"2017-10-23T18:42:48.960Z","updated_at":"2017-10-23T18:42:48.960Z","first_to_agree":true,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2096355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-10-23T18:47:08.747Z","updated_at":"2017-10-23T18:47:08.747Z","actor":{"username":"whitehatter","cleared":true,"url":"/whitehatter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/358/2c8b65e6a1929dcd9bd6a214857909ea5d127f88_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2096357,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-10-23T18:47:08.856Z","updated_at":"2017-10-23T18:47:08.856Z","actor":{"username":"whitehatter","cleared":true,"url":"/whitehatter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/358/2c8b65e6a1929dcd9bd6a214857909ea5d127f88_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}