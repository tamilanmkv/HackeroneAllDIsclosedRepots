{"id":280770,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODA3NzA=","url":"https://hackerone.com/reports/280770","title":"Search query text, including from potentially undisclosed reports, sent to Google Analytics on Inbox query page","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2017-10-19T20:36:52.264Z","submitted_at":"2017-10-19T20:36:52.264Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"holvonix-advay","url":"/holvonix-advay","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-01T20:54:41.075Z","bug_reporter_agreed_on_going_public_at":"2017-11-01T20:54:40.945Z","team_member_agreed_on_going_public_at":"2017-11-01T20:38:48.804Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nSearch query text, including from potentially undisclosed reports, sent to Google Analytics on Inbox query page\n\n**Description (Include Impact):**\nSince search query text can both include content of private vulnerabilities, it shouldn't be sent to Google Analytics.  Furthermore, the information sent to GA includes information indicating the presence of a report and its status associated with a particular company (if there is a non-zero report_id and a filtered reported_to_team parameter), which further pins down that a company has a report with certain yet-undisclosed text in said report. Finally, search query text can contain PII, and therefore should not be sent to GA (however, I am not a lawyer, and this is not legal advice).\n\n**Mitigation:**  Client-side redaction of the 'reported_to_team' and 'text_query' params (at the least) before posting to GA.\n\n### Steps To Reproduce\n\n1. Visit the permalink URL for an inbox search query (for example, searching for \"SOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE\" and filtering to HackerOne gives a URL like: \nhttps://hackerone.com/bugs?subject=user\u0026report_id=0\u0026view=custom\u0026substates%5B%5D=pre-submission\u0026substates%5B%5D=new\u0026substates%5B%5D=needs-more-info\u0026substates%5B%5D=triaged\u0026substates%5B%5D=duplicate\u0026substates%5B%5D=informative\u0026substates%5B%5D=resolved\u0026substates%5B%5D=not-applicable\u0026substates%5B%5D=spam\u0026reported_to_team=security\u0026text_query=SOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE\u0026program_states%5B%5D=2\u0026program_states%5B%5D=3\u0026program_states%5B%5D=4\u0026program_states%5B%5D=5\u0026sort_type=pg_search_rank\u0026sort_direction=descending\u0026limit=25\u0026page=1 )\n\n2. Note in the browser network inspector a www.google-analytics.com/collect post containing the sensitive information in the dl param (I have omitted all numeric identifiers for the sake of future disclosure) :\n`v=1\u0026_v=***\u0026a=***\u0026t=pageview\u0026_s=1\u0026dl=https%3A%2F%2Fhackerone.com%2Fbugs%3Fsubject%3Duser%26report_id%3D0%26view%3Dcustom%26substates%255B%255D%3Dpre-submission%26substates%255B%255D%3Dnew%26substates%255B%255D%3Dneeds-more-info%26substates%255B%255D%3Dtriaged%26substates%255B%255D%3Dduplicate%26substates%255B%255D%3Dinformative%26substates%255B%255D%3Dresolved%26substates%255B%255D%3Dnot-applicable%26substates%255B%255D%3Dspam%26reported_to_team%3Dsecurity%26text_query%3DSOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE%26program_states%255B%255D%3D2%26program_states%255B%255D%3D3%26program_states%255B%255D%3D4%26program_states%255B%255D%3D5%26sort_type%3Dpg_search_rank%26sort_direction%3Ddescending%26limit%3D25%26page%3D1\u0026ul=en-us\u0026de=UTF-8\u0026dt=HackerOne\u0026sd=24-bit\u0026sr=***\u0026vp=***\u0026je=0\u0026_u=***~\u0026jid=\u0026gjid=\u0026cid=***\u0026uid=***\u0026tid=UA-***-1\u0026_gid=***\u0026z=***`\n\n\n\n### Optional: Your Environment (Browser version, Device, etc)\n\n * Mac OS High Sierra, Chrome 61.0.3163.100\n\n### Optional: Supporting Material/References (Screenshots)\n\n * ","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-01T20:38:49.162Z","allow_singular_disclosure_after":-121802311.96777068,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","r3y","luckydivino","mr_r3boot","holvonix-advay","japz","dyabla","b4155f7c29acd42c27d007a"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2086212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Furthermore, now that my inbox actually has a HackerOne bug report, the following permalink:\nhttps://hackerone.com/bugs?subject=user\u0026report_id=280770\u0026view=custom\u0026substates%5B%5D=pre-submission\u0026substates%5B%5D=new\u0026substates%5B%5D=needs-more-info\u0026substates%5B%5D=triaged\u0026substates%5B%5D=duplicate\u0026substates%5B%5D=informative\u0026substates%5B%5D=resolved\u0026substates%5B%5D=not-applicable\u0026substates%5B%5D=spam\u0026reported_to_team=security\u0026text_query=SOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE\u0026program_states%5B%5D=2\u0026program_states%5B%5D=3\u0026program_states%5B%5D=4\u0026program_states%5B%5D=5\u0026sort_type=pg_search_rank\u0026sort_direction=descending\u0026limit=25\u0026page=1\n\nposts to Google Analytics a `dl` parameter:\n`dl=https%3A%2F%2Fhackerone.com%2Fbugs%3Fsubject%3Duser%26report_id%3D280770%26view%3Dcustom%26substates%255B%255D%3Dpre-submission%26substates%255B%255D%3Dnew%26substates%255B%255D%3Dneeds-more-info%26substates%255B%255D%3Dtriaged%26substates%255B%255D%3Dduplicate%26substates%255B%255D%3Dinformative%26substates%255B%255D%3Dresolved%26substates%255B%255D%3Dnot-applicable%26substates%255B%255D%3Dspam%26reported_to_team%3Dsecurity%26text_query%3DSOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE%26program_states%255B%255D%3D2%26program_states%255B%255D%3D3%26program_states%255B%255D%3D4%26program_states%255B%255D%3D5%26sort_type%3Dpg_search_rank%26sort_direction%3Ddescending%26limit%3D25%26page%3D1`\nwherein the combination of reported_to_team, non-zero report_id, and text_query, demonstrates in GA logs that HackerOne has at least one undisclosed bug about \"SOME_UNDISCLOSED_REPORT_OR_PII_INFO_HERE\"","automated_response":false,"created_at":"2017-10-19T20:54:46.869Z","updated_at":"2017-10-19T20:54:46.869Z","actor":{"username":"holvonix-advay","cleared":false,"url":"/holvonix-advay","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2097270,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting @holvonix-advay, we're looking into this and will get back to you shortly.\n\nKind regards,\n@asuka ","automated_response":false,"created_at":"2017-10-23T23:04:41.922Z","updated_at":"2017-10-23T23:04:41.922Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2106368,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @holvonix-advay - We are looking into this further and will update you on our progress once we have additional information to share. Thanks! ","automated_response":false,"created_at":"2017-10-26T20:00:23.173Z","updated_at":"2017-10-26T20:00:23.173Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2109785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @holvonix-advay - A fix for this has been released. Could you recheck on your end? Thanks! ","automated_response":false,"created_at":"2017-10-28T03:35:10.601Z","updated_at":"2017-10-28T03:35:10.601Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2109863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Original report looks fixed (with text_query replaced with FILTERED).  Thanks for the quick response.\n\nI noticed that the GA post also collects `weaknesses%5B%5D=18` (i.e. Information Disclosure weakness in a search query).  The most that would be disclosed here is that a particular company has an undisclosed vulnerability of a particular type (i.e. weakness) - since it is not the /content/ of a vulnerability report, not sure if this is a greater-than-trivial risk. ","automated_response":false,"created_at":"2017-10-28T05:38:27.171Z","updated_at":"2017-10-28T05:38:27.171Z","actor":{"username":"holvonix-advay","cleared":false,"url":"/holvonix-advay","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2118106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @holvonix-advay - Thanks for confirming the fix. We don't see an issue with the weakness being disclosed. All users who have access to Google Analytics are background checked, and even if an attacker was able to somehow determine the weaknesses, it wouldn't help them very much. ","automated_response":false,"created_at":"2017-10-31T17:06:30.437Z","updated_at":"2017-10-31T17:06:30.437Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2118249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good - looks fixed then!","automated_response":false,"created_at":"2017-10-31T17:46:31.476Z","updated_at":"2017-10-31T17:46:31.476Z","actor":{"username":"holvonix-advay","cleared":false,"url":"/holvonix-advay","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122621,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-11-01T20:29:02.799Z","updated_at":"2017-11-01T20:29:02.799Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":86583,"new_severity_id":90637},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122628,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report @holvonix-advay - this has been fixed now. While there wasn't a security vulnerability here, your report highlighted something that we feel is a best practice, so we are going to issue swag. Thanks for your report and we look forward to more reports from you in the future! ","automated_response":false,"created_at":"2017-11-01T20:31:13.579Z","updated_at":"2017-11-01T20:31:13.579Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"holvonix-advay","url":"/holvonix-advay"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122629,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2017-11-01T20:31:22.699Z","updated_at":"2017-11-01T20:31:22.699Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"reporter":{"username":"holvonix-advay","url":"/holvonix-advay"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122651,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-01T20:38:48.959Z","updated_at":"2017-11-01T20:38:48.959Z","first_to_agree":true,"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122708,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-01T20:54:40.997Z","updated_at":"2017-11-01T20:54:40.997Z","actor":{"username":"holvonix-advay","cleared":false,"url":"/holvonix-advay","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2122709,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-01T20:54:41.113Z","updated_at":"2017-11-01T20:54:41.113Z","actor":{"username":"holvonix-advay","cleared":false,"url":"/holvonix-advay","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132876,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-11-03T19:16:02.841Z","updated_at":"2017-11-03T19:16:02.841Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}