{"id":283847,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM4NDc=","url":"https://hackerone.com/reports/283847","title":"GraphQL sessions aren't immediately invalidated when user password is changed","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-10-28T21:59:08.330Z","submitted_at":"2017-10-28T21:59:08.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bigbug","url":"/bigbug","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-30T22:28:39.938Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-11-30T22:28:17.269Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nWhile changing password, once user clicks on \"Change password\" button after giving necessary values, on https://hackerone.com/settings/pass/edit, the session expires and the user is redirected to https://hackerone.com/users/sign_in for logging in again with the updated/changed password. A graphql mutation is used to change password. But, it is observed that the user can still change password with same graphql token and same session id, used in previous graphql request **even after signing out**. Inshort graphql token nor host session expires. \n \n**Description:**\n\nSorry if I categorized this into wrong weakness category. Also apologize for the complicated title.\n\nWhen clicking on \"change password\" after supplying values for  current password, password and confirm password, user is directed to sign_in page to log in again with changed password. \n\nThe password change takes place through graphql mutation request that contains graphql token and session id. \n\nIt was observed that after capturing the above request with the help of a web debugging tool (charles proxy), the above request could be replayed with same graphql token  **x-auth-token** and host session **__Host-session**, with appropriate password values after sign out and the password is changed.\n\nInshort **A user can change password even after he/she is signed out or session expires, without having to login again, with the help of previously captured graphql request.**\n\n**Impact**\n\nAn attacker could simply change the password again by capturing previous request. As the change can be done even after sign out or expired session, it is more severe.\n\n**Remedy**\n\nMust enforce graphql token expiration. Also check for host_sesssion cookie value.\n\n### Steps To Reproduce\n\n1. Login to the account and navigate to https://hackerone.com/settings/pass/edit to change password.\n2. Input necessary values and click \"Change password\" button. Capture the request using a proxy.\n    (User is now logged out and redirected to sign_in page)\n3. Repeat the previous \"graphql mutation\" request using proxy with changed password. Password is\n     changed again without having to login.  \n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-30T22:28:17.598Z","allow_singular_disclosure_after":-119290186.55425033,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","lordjerry0x01","t4ym","cr4xerbik4sh","japz","sumit7","dyabla","seven6"],"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2110689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**An important update**\n\nThis seems to be true for querying profile value as well  as well. The below  graphql query is fired when \"update profile\" is clicked at https://hackerone.com/settings/profile/edit without changing current profile values.\n\n\u003equery Profile_settings_MeRelayQL (......)\n\u003e \"variables\" : {\n\u003e                             .....\n\u003e                            }\n\n\nThis returns current_user profile information. It was observed that even this can be repeated after password change without login. This does not need password as changing/querying profile values do not require a password. \n\n\n**Steps**\n1. I again changed the password and captured the graphql request for the same. (User is signed out)\n2. Created above graphql query to query current profile with same  x-auth-token and  __Host-session values as      \"change password graphql mutation request\". It worked and returned user info even after sign out.  \n\nNormally this would return \"You need to sign_in message\".\n\n**Possible reason**\n\nAfter changing password, the session is not properly expired, and still allows changes. \nThe problem seem to be connected with \"Change password sign_out\" event.  ","automated_response":false,"created_at":"2017-10-28T22:37:39.796Z","updated_at":"2017-10-28T22:44:24.090Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2110703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Update**\n\nThis seem to work with all graphql queries that follows a change password sign out event.\n The problem lies with session not being terminated properly after a password change.  ","automated_response":false,"created_at":"2017-10-28T22:52:36.226Z","updated_at":"2017-10-28T22:52:36.226Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2112946,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would request you to excuse me for the title. This seems to be an issue with the session expiration. Please verify.\nThank you","automated_response":false,"created_at":"2017-10-30T13:47:59.095Z","updated_at":"2017-10-30T13:47:59.095Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2114235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me clear things up if there is any confusion. \n\nAt the time of testing I changed the password and after being signed out, I replayed the graphql query to change password and observed that updation still works after signout. And so the complicated title. At first, I thought that this was limited to just password change.  \n\nBut later, on investigating further it was clear that, **any graphql request after a password change was working even after signout.**  \n\nThus the problem is that the session is not expired, when the user is redirected to sign_in page after password change. And requests after can make changes although user seems to be signed out. \n\nHence I would like to clear that this report addresses an issue of session not being terminated properly , after password change. The issue  possibly exists only in the sign out action, after password change. Because after a normal sign_out, the requests seem to return \"invalid_credentials\" response.\n\nJust wanted to sum things up to avoid any confusion if exists. Hope this helps. \nThank you.","automated_response":false,"created_at":"2017-10-30T17:58:06.191Z","updated_at":"2017-10-30T17:58:06.191Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2118014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates team?","automated_response":false,"created_at":"2017-10-31T16:41:32.530Z","updated_at":"2017-10-31T16:41:32.530Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119659,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @bigbug  - I don't quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request? ","automated_response":false,"created_at":"2017-10-31T22:28:46.715Z","updated_at":"2017-10-31T22:28:46.715Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119966,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @coffeecup,\n\n**As mentioned above the actual bug/ issue I want to report here is the session termination issue.** \n\nI know the title is a bit confusing here. This is because the bug was revealed to me while trying to change the password. At the time of reporting this, I thought that this is just limited to repeating password change requests, and so decided to report with this title. \n\nBut the actual big here is that although you are redirected to sign-in page after a password change, you can still query and make changes to the account with graphql requests. **This shows a broken session termination**\n\nPlease Note - Changing of password is just another possibility. The real fact is that any graphql request (query or mutation) is still valid and can still make changes in the account. \n\n**I would like to end this saying that this is a case of session termination issue, that happens after a password change.**\n\nI will be happy to provide detail POC or any further information on the same. Just wanted to clarify we are on the same track first.\n\nThank you","automated_response":false,"created_at":"2017-11-01T02:21:59.348Z","updated_at":"2017-11-01T02:25:14.475Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2120004,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me answer your above query \n\u003eHi @bigbug - I don't quite see how an attacker could leverage this. How would it be possible to obtain your session tokens used the in the reset password request\n\nThis report is  actually inspired by the new OWASP testing guide v4 , focussing on **Testing for logout functionality (OTG-SESS-006)** at https://www.owasp.org/index.php/Testing_for_logout_functionality_(OTG-SESS-006)\n\nI would request you to scroll to the **Testing for server-side session termination** section. This is what I want to highlight. \n\n**Scenario**\n\nImagine a scenario where the user after changing password is redirected to sign-in page, assuming that he/she is logged out.But actually the session tokens are still alive at the server. The session tokens in our case **_Host-session** is not expired yet actually.\n\nThe risk is in an environment that caches or stores requests or responses especially for testing purposes. As the session tokens are not expired on the server, the requests can still be replayed. eg Cookie replay attacks - https://www.vanstechelman.eu/content/cookie-replay-attacks-in-aspnet-when-using-forms-authentication\n\nA proxy was used here to demonstrate the risk of the same. \n\n**Mitigation**\n\nSession tokens at server-side should be terminated as well. ","automated_response":false,"created_at":"2017-11-01T02:59:35.724Z","updated_at":"2017-11-01T03:02:26.613Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2120045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nTo my surprise I found this report #353 (https://hackerone.com/reports/353).\n\nThis report was submitted to hackerone and was closed after resolved with a bounty.\n\nThis is exactly what we have here too. But the bug is not resolved fully. The issue seems to be with  password change action.\n\nI request you to please look into this.\n\nThank you for your patience @coffeecup. ","automated_response":false,"created_at":"2017-11-01T03:56:25.944Z","updated_at":"2017-11-01T03:59:27.681Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2125158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup any updates on this? ","automated_response":false,"created_at":"2017-11-02T14:12:01.723Z","updated_at":"2017-11-02T14:12:01.723Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132822,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @bigbug - Could you provide me with a step by step PoC demonstrating this vulnerability? I'm getting kind of confused over your report since it seems like the first issue you reported doesn't seem to valid anymore:\n\n\u003e As mentioned above the actual bug/ issue I want to report here is the session termination issue.\n\nCould you list step by step instructions on how I can reproduce this? It would be much appreciated, thanks! ","automated_response":false,"created_at":"2017-11-03T18:59:58.423Z","updated_at":"2017-11-03T18:59:58.423Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132900,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@coffeecup Below are steps you requested\n\n**Steps**\n\n1. Fire up a web debugging proxy to capture requests. Start capture.\n2. Login to account. Navigate to https://hackerone.com/settings/profile/edit. Check for POST request to https://hackerone.com/graphql. (any graphql request will work.)\n3. Navigate to https://hackerone.com/settings/pass/edit. Input values (current password, new password and confirm password). Click \"Change password\" button.\n(User is now signed out and redirected to sign_in page)  \n\n4. Now repeat any graphql request previously captured in step 2. Any graphql request will work. This will return correct data even after logout. Normally it would return \"invalid credentials\" response\n\n**Note**\n\nRepetition of request returns proper response although user was signed out. In order to reproduce this clearly, You can try graphql query that queries users profile or the password change mutation request itself to see correct response and account modifications respectively\n\nHope this helps @coffeecup ","automated_response":false,"created_at":"2017-11-03T19:25:44.545Z","updated_at":"2017-11-03T19:25:44.545Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nLet me also add that the issue is due to improper session termination **after password change**\n\nAnd also it works only with **graphql requests both (query and mutation)**\n\nHope this helps","automated_response":false,"created_at":"2017-11-03T19:33:36.624Z","updated_at":"2017-11-03T19:33:36.624Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2133156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nHope the steps were clear enough to reproduce the issue.\n\nI would request you to change the title of this report to avoid confusion to something relevant relating to session termination after a password change, once it is verified. Thank you ","automated_response":false,"created_at":"2017-11-03T20:52:02.749Z","updated_at":"2017-11-03T20:52:02.749Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2134147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @coffeecup \n\nI am attaching a POC video demonstrating the steps. \n\nI created a test account for this video.\n\nHope this helps! Thank you","automated_response":false,"created_at":"2017-11-04T12:03:58.660Z","updated_at":"2017-11-04T12:10:44.280Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":236485,"filename":"h1_graphql_repeat.compressed.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/236/485/e78850a1a731bf14f20fb3f5a4c02e6d7bd583a7/h1_graphql_repeat.compressed.mp4?response-content-disposition=attachment%3B%20filename%3D%22h1_graphql_repeat.compressed.mp4%22%3B%20filename%2A%3DUTF-8%27%27h1_graphql_repeat.compressed.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143804Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5d8f6243e597fd9be6df1dff3db1721ba972c1b0614978a7a601053754a98d12"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2137311,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @coffeecup any updates?","automated_response":false,"created_at":"2017-11-06T16:13:17.937Z","updated_at":"2017-11-06T16:13:17.937Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2141319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup Anything on the review of this report?","automated_response":false,"created_at":"2017-11-07T20:28:30.623Z","updated_at":"2017-11-07T20:28:30.623Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigbug - I'm looking into this now, thanks for the additional information. ","automated_response":false,"created_at":"2017-11-08T17:12:40.768Z","updated_at":"2017-11-08T17:12:40.768Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143890,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We believe this may be a valid issue, so I'm going to mark this as `Triaged` for now as we continue to investigate. Thanks for your patience as we look into this further. I'll update you when we have additional information to share. ","automated_response":false,"created_at":"2017-11-08T19:31:22.842Z","updated_at":"2017-11-08T19:31:22.842Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2143925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup \n\nThank you for the quick response. Will surely wait for further updates. Thanks again!","automated_response":false,"created_at":"2017-11-08T19:41:45.227Z","updated_at":"2017-11-08T19:41:45.227Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161108,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @bigbug - \n\nThanks for reporting this to us. We've determined that the token expires after a certain amount of time (I think after 10/20 minutes). With this in mind, and also keeping in mind that an attacker would need MiTM access to the victim's computer or browsing history in order to exploit this, we won't be issuing a fix right away nor tracking this as a security issue. With that said, I'll be closing this as `Informative`. Please continue to send us bug reports, we look forward to more reports from you in the future. ","automated_response":false,"created_at":"2017-11-15T23:16:16.304Z","updated_at":"2017-11-15T23:16:16.304Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161416,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup Thank you for confirming that. Is this eligible for public disclosure?","automated_response":false,"created_at":"2017-11-16T03:19:25.417Z","updated_at":"2017-11-16T03:19:25.417Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2161427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coffeecup If possible could you also look into report #273651? I think it needs some serious attention.\n\nThank you","automated_response":false,"created_at":"2017-11-16T03:26:17.212Z","updated_at":"2017-11-16T03:26:17.212Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166182,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-17T19:39:19.056Z","updated_at":"2017-11-17T19:39:19.056Z","first_to_agree":true,"actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this? If yes I would like you to change the title to something relevant. Thank you","automated_response":false,"created_at":"2017-11-17T19:44:18.355Z","updated_at":"2017-11-17T19:44:18.355Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2166383,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-11-17T21:12:34.388Z","updated_at":"2017-11-17T21:12:34.388Z","additional_data":{"old_title":"Change password after signout, without login, by repeating graphql mutation request. ","new_title":"GraphQL sessions aren't immediately invalided when user password is changed"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-17T21:12:57.125Z","updated_at":"2017-11-17T21:12:57.125Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166386,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-17T21:12:57.391Z","updated_at":"2017-11-17T21:12:57.391Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166387,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-11-17T21:13:35.490Z","updated_at":"2017-11-17T21:13:35.490Z","additional_data":{"old_title":"GraphQL sessions aren't immediately invalided when user password is changed","new_title":"GraphQL sessions aren't immediately invalidated when user password is changed"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2166401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Thank you for the apt title. ","automated_response":false,"created_at":"2017-11-17T21:20:11.300Z","updated_at":"2017-11-17T21:20:11.300Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181232,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2017-11-24T20:14:24.576Z","updated_at":"2017-11-24T20:14:24.576Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"email":"aorta","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181249,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2017-11-24T20:43:20.925Z","updated_at":"2017-11-24T20:43:20.925Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"email":"aorta","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2188762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems there was a fix from your end on this. Now on repeating the request immediately, it returns `invalid credentials`. Could you provide updates on this? Was this report reviewed again?","automated_response":false,"created_at":"2017-11-29T14:02:19.278Z","updated_at":"2017-11-29T14:02:19.278Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2189852,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Could you please provide some information on this?","automated_response":false,"created_at":"2017-11-29T21:26:12.161Z","updated_at":"2017-11-29T21:26:12.161Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2190156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bigbug Sure, no problem! We did make some changes to other related sign out inconsistencies, but we still don't invalidate a signed out GraphQL session, because there is no session. We did proactively ensure that other places where we intentionally kill the user's session that we invalidate a GraphQL session that does exist. Though this may slow down an attacker, they can still infinitely use the signed out GraphQL session to workaround our proactive changes. Our protection, which was already in place, is rate limiting.","automated_response":false,"created_at":"2017-11-29T23:55:20.707Z","updated_at":"2017-11-29T23:55:20.707Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2190389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert So cant this be considered a fix to issue that I have reported? Because the `user session` was not invalidated too at the time of reporting this. I had mentioned regarding `_Host-session` expiration as a fix.\n\nnow you have terminated user sessions too which wouldn't normally. \nSo i consider it a fix from your end that relates to user sessions. \n\nAnd the token expiration is actually of the user session ie `_Host-session` and not graphql token that causes the issue. I feel this is resolved. \n\nAccording to me this is a fix I was expecting. ","automated_response":false,"created_at":"2017-11-30T04:26:21.301Z","updated_at":"2017-11-30T04:26:21.301Z","actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2192297,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2017-11-30T22:25:32.399Z","updated_at":"2017-11-30T22:25:32.399Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192299,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @bigbug - marking this as resolved. The initial behavior you reported to us was changed as a side-effect of a code refactor. I wanted to reiterate that the exploit window of the initial vulnerability was limited to 5 minutes after signing out, because then the tokens expire. This is why we marked it as informative. However, since the behavior was changed to close to your report, we're closing this as resolved. This report is not eligible for a bounty due to the lack of exploitability. Good luck and happy hacking!\n\nJobert","automated_response":false,"created_at":"2017-11-30T22:27:56.867Z","updated_at":"2017-11-30T22:27:56.867Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"bigbug","url":"/bigbug"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192300,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-11-30T22:28:06.634Z","updated_at":"2017-11-30T22:28:06.634Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192301,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-30T22:28:17.304Z","updated_at":"2017-11-30T22:28:17.304Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2192302,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-11-30T22:28:39.701Z","updated_at":"2017-11-30T22:28:39.701Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}