{"id":293743,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTM3NDM=","url":"https://hackerone.com/reports/293743","title":"[public-api.wordpress.com] Stored XSS via Crafted Developer App Description","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-11-29T15:38:11.655Z","submitted_at":"2017-11-29T15:38:11.655Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ysx","url":"/ysx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-12-01T13:35:43.503Z","bug_reporter_agreed_on_going_public_at":"2017-12-01T13:22:18.373Z","team_member_agreed_on_going_public_at":"2017-12-01T13:35:43.379Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nAn injection in the \"App Description\" field within the [WordPress Developers](https://developer.wordpress.com) platform can be used to store and reflect JavaScript in the `public-api.wordpress.com` context.\n\n## Steps to reproduce\n\n1) As the \"adversary\" user, please visit the WordPress.com [My Apps](https://developer.wordpress.com/apps/) page and select \"Create New Application\"\n\n2) Populate the \"Name\" and \"Website URL\" fields with generic data, and set the Redirect URL to `https://google.com` for the purposes of this demonstration\n\n3) Next, please copy the below proof of concept payload into the \"Description\" field, save your App, and take note of the client ID\n\n4) Substitute the client ID into the following URL (which can be accessed by any user to reproduce this vulnerability)\n\n```\nhttps://public-api.wordpress.com/oauth2/authorize?client_id=YourID\u0026redirect_uri=https://google.com\u0026response_type=code\u0026blog=\n```\n\n5) Finally, mouse over the `TESTLINK` text to execute the JavaScript payload.\n\n### Proof of concept payload\n\n```\n'\"\u003e\u003cdiv id=\"test\"\u003e\u003chead\u003e\u003cbase href=\"javascript://\"/\u003e\u003c/head\u003e\u003cbody\u003e\u003ca href=\"/. /, /' onmouseover=confirm(document.domain); abc=abc\"\u003eTESTLINK\n```\n\n### Supporting evidence\n\n{F243076}\n\n## Verified conditions\n\nAt the time of testing, I have successfully confirmed exploitability in the following environments:\n\n* Chrome OS 63.0.3239.50 (Official Build) beta (64-bit)\n* Firefox 55.0.3 stable (32-bit) on Ubuntu 16.04.3 LTS\n\nThanks,\n\nYasin\n\n## Impact\n\nAn adversary can leverage this vulnerability in a crafted API authorisation request that, if issued by another WordPress.com user, will cause arbitrary JavaScript code to execute within the target's browser in the context of their WordPress session.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":243076,"file_name":"WP_API_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/243/076/7bd235c846481d47668fbab8b801b52a44b5b625/WP_API_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22WP_API_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27WP_API_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=84c6d38094d25841921a16607c29b3a8e72f07d067313c85ee0e822972ba614f","file_size":86092,"type":"image/png"}],"allow_singular_disclosure_at":"2017-12-31T13:22:18.448Z","allow_singular_disclosure_after":-119236653.7234865,"singular_disclosure_allowed":true,"vote_count":9,"voters":["jr0ch17","asad0x01_","gamliel","eveeez","r3y","cr4xerbik4sh","zerotoone","walidhossain","spyco"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2189021,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi. Thanks for the report. We are going to take a look.","automated_response":false,"created_at":"2017-11-29T16:03:37.419Z","updated_at":"2017-11-29T16:03:37.419Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2189027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem @xknown, thanks for the swift response.","automated_response":false,"created_at":"2017-11-29T16:07:13.226Z","updated_at":"2017-11-29T16:07:13.226Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2189028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. This should be now fixed. We'll look for similar uses of incorrect sanitization functions.","automated_response":false,"created_at":"2017-11-29T16:07:40.041Z","updated_at":"2017-11-29T16:07:40.041Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2189051,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice work with the super-fast fix, thanks again @xknown. Confirming successful remediation.","automated_response":false,"created_at":"2017-11-29T16:17:59.027Z","updated_at":"2017-11-29T16:17:59.027Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2193626,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-12-01T13:18:00.834Z","updated_at":"2017-12-01T13:18:00.834Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ysx","url":"/ysx"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193629,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for the report.","automated_response":false,"created_at":"2017-12-01T13:19:17.861Z","updated_at":"2017-12-01T13:19:17.861Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"ysx","url":"/ysx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193632,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No problem, thanks for the bounty and excellent responsiveness.","automated_response":false,"created_at":"2017-12-01T13:22:18.398Z","updated_at":"2017-12-01T13:22:18.398Z","first_to_agree":true,"actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2193667,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-01T13:35:43.406Z","updated_at":"2017-12-01T13:35:43.406Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193668,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-12-01T13:35:43.525Z","updated_at":"2017-12-01T13:35:43.525Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5984,"category":"researcher","content":"A crafted third-party app description could be leveraged to execute arbitrary JavaScript on the WordPress.com Public API endpoint through an OAuth `authorize` link. Thanks again to @xknown for the highly impressive response and remediation time.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":47082,"username":"ysx","name":"","bio":"","cleared":false,"website":"","location":"","created_at":"2015-12-20T12:11:13.354Z","url":"https://hackerone.com/ysx","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}