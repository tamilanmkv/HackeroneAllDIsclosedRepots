{"id":300181,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDAxODE=","url":"https://hackerone.com/reports/300181","title":"Torrent Viewer extension web service available on all interfaces","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-12-23T08:21:57.137Z","submitted_at":"2017-12-23T08:21:57.137Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"beurtschipper","url":"/beurtschipper","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-01-26T14:06:40.705Z","bug_reporter_agreed_on_going_public_at":"2017-12-27T14:06:33.756Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nWhen files are downloaded via the Torrent Viewer, a local web service is spun up that allows the user to download the files. This web service listens on all interfaces, allowing anyone in the network to view what files are being downloaded, and download them from the user. This mostly affects the privacy of the user.\n\n## Products affected: \n\n * This issue was tested on the Brave browser on OSX, using version 0.19.122. Full specs:\n\nName\tVersion\nBrave\t0.19.122\nrev\t009e792\nMuon\t4.5.31\nlibchromiumcontent\t63.0.3239.108\nV8\t6.3.292.48\nNode.js\t7.9.0\nUpdate Channel\tRelease\nOS Platform\tmacOS\nOS Release\t17.2.0\nOS Architecture\tx64\n\n## Steps To Reproduce:\n\n* Disable local firewall if set to block all external connections\n* Load a torrent in the Brave browser, for example:\nhttps://zooqle.com/download/wiv7v.torrent\n* Click on \"Start download\"\n* Either hover over the \"Save file\" button to see the port to the web service (button_link.png), or perform an external portscan.\n* Use different device to connect to the port. \n* See what the user is downloading (see Open torrent webservice.png)\n\nNote that the port changes every time a download is started, but an attacker can simple perform a portscan to find this port.\n\n## Supporting Material/References:\n\n* I've included two screenshots that show the port (button_click.png) and me viewing downloaded files from a VM (Open torrent webservice.png). This issue has also been tested from a phone instead of the VM, to ensure that it wasn't just my vmnet being viewed as a local address.\n\n## Impact\n\nIf an 'attacker' (or any privacy-snooping agent) is on the same network as the user, it's possible to list all files that are currently downloaded. It's also possible to download these files from the user. \n\nThis vulnerability does not affect users that have their firewall set to block all incoming connections.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":248994,"file_name":"Open_torrent_webservice.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/248/994/0026b7ec200d91a4b601f282161f6583ee53da7c/Open_torrent_webservice.png?response-content-disposition=attachment%3B%20filename%3D%22Open_torrent_webservice.png%22%3B%20filename%2A%3DUTF-8%27%27Open_torrent_webservice.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144111Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=98129d5b8b4494462df024434fcc79f7f8a2fdd8b4526d7b17c54b70022594db","file_size":495797,"type":"image/png"},{"id":248995,"file_name":"button_link.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/248/995/26ef25fa71ff3e68f76622961946e6d3ba168636/button_link.png?response-content-disposition=attachment%3B%20filename%3D%22button_link.png%22%3B%20filename%2A%3DUTF-8%27%27button_link.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144111Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=022cc385dc3fafd0fdd69eb7491dd6580f1ea00fcde4bdfd5f59f7962f158829","file_size":206580,"type":"image/png"}],"allow_singular_disclosure_at":"2018-01-26T14:06:33.840Z","allow_singular_disclosure_after":-116987678.04313676,"singular_disclosure_allowed":true,"vote_count":9,"voters":["sameerphad72","bibekshah","eveeez","whitesector","khizer47","japz","saikiran-10099","rafikithegrouch","adamharvey233"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2246016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\n\nRegards.","automated_response":false,"created_at":"2017-12-25T17:41:09.052Z","updated_at":"2017-12-25T17:41:09.052Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2246361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dutchgraa have you checked if this issue generally affects https://github.com/webtorrent/webtorrent ? If so, it may be worth opening an issue there to check if they are aware of it.","automated_response":false,"created_at":"2017-12-26T04:51:14.323Z","updated_at":"2017-12-26T04:51:14.323Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2246641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No I have not checked that. I also don't have time for that, I'm just testing the Brave browser. If it's a component that you use I suggest you open the issue to fix it.","automated_response":false,"created_at":"2017-12-26T10:07:50.672Z","updated_at":"2017-12-26T10:07:50.672Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2247064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dutchgraa Just pointing out that if this is an upstream issue with webtorrent, it affects *a lot* more users than just Brave, so you may be able to get more bounty money.","automated_response":false,"created_at":"2017-12-26T16:40:24.393Z","updated_at":"2017-12-26T16:40:24.393Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247150,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-12-26T17:48:30.587Z","updated_at":"2017-12-26T17:48:30.587Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":103726,"new_severity_id":104078},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247154,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"triaged to https://github.com/brave/browser-laptop/issues/12400","automated_response":false,"created_at":"2017-12-26T17:50:07.582Z","updated_at":"2017-12-26T17:50:07.582Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"should be a simple fix but i'm checking with webtorrent maintainers to make sure that nothing will break if we change the torrent interface to be local","automated_response":false,"created_at":"2017-12-26T17:58:24.840Z","updated_at":"2017-12-26T17:58:24.840Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks for getting on this. Maybe I'll check out if the issue exists in webtorrent later this week.","automated_response":false,"created_at":"2017-12-26T21:31:27.659Z","updated_at":"2017-12-26T21:31:27.659Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2247716,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I have fixed this in the webtorrent-remote module and it will be fixed in Brave once https://github.com/brave/browser-laptop/pull/12403 is released.","automated_response":false,"created_at":"2017-12-27T00:41:39.467Z","updated_at":"2017-12-27T00:41:39.467Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"beurtschipper","url":"/beurtschipper"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2247717,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-12-27T00:42:04.358Z","updated_at":"2017-12-27T00:42:04.358Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"beurtschipper","url":"/beurtschipper"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2248301,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ho ho ho, thank you for the bounty! Merry Christmas and a happy new year!","automated_response":false,"created_at":"2017-12-27T12:30:19.877Z","updated_at":"2017-12-27T12:30:19.877Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248393,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-27T14:06:33.778Z","updated_at":"2017-12-27T14:06:33.778Z","first_to_agree":true,"actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2320798,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-01-26T14:06:41.144Z","updated_at":"2018-01-26T14:06:41.144Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}