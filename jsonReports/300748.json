{"id":300748,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDA3NDg=","url":"https://hackerone.com/reports/300748","title":"Ethereum account balance manipulation","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-12-27T08:38:17.059Z","submitted_at":"2017-12-27T08:38:17.059Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vicompany","url":"/vicompany","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-21T08:52:55.671Z","bug_reporter_agreed_on_going_public_at":"2018-02-19T08:52:44.320Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-03-21T08:52:44.442Z","allow_singular_disclosure_after":-112340915.82378048,"singular_disclosure_allowed":true,"vote_count":247,"voters":["totalsx","flamezzz","jokebookservice1","arneswinnen","n1m0","jensec","airblender","sp1d3rs","jr0ch17","ajxchapman","and 237 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":120,"asset_type":"URL","asset_identifier":"coinbase.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2248590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-12-27T15:57:19.894Z","updated_at":"2017-12-27T15:57:19.894Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248594,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-12-27T15:58:59.720Z","updated_at":"2017-12-27T15:58:59.720Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-12-27T18:18:10.090Z","updated_at":"2017-12-27T18:18:10.090Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2248787,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-12-27T18:20:01.204Z","updated_at":"2018-03-14T20:17:28.089Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248799,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2017-12-27T18:25:51.321Z","updated_at":"2017-12-27T18:25:51.321Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2255657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-01-02T13:03:34.204Z","updated_at":"2018-03-14T20:17:57.820Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278498,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-01-11T19:08:52.812Z","updated_at":"2018-01-11T19:08:52.812Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278500,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2018-01-11T19:09:43.889Z","updated_at":"2018-01-11T19:09:43.889Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2278548,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","automated_response":false,"created_at":"2018-01-11T19:21:28.081Z","updated_at":"2018-01-11T19:21:28.081Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2284967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-01-15T09:30:33.623Z","updated_at":"2018-03-14T20:17:57.778Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2319652,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-01-26T01:11:06.312Z","updated_at":"2018-01-26T01:11:06.312Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"10000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"vicompany","url":"/vicompany"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2319653,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-01-26T01:11:15.058Z","updated_at":"2018-01-26T01:11:15.058Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"vicompany","url":"/vicompany"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2403495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-02-19T08:52:44.381Z","updated_at":"2018-02-19T08:52:44.381Z","first_to_agree":true,"actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2513557,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-03-21T08:52:55.731Z","updated_at":"2018-03-21T08:52:55.731Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2562506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-04-03T21:38:32.483Z","updated_at":"2018-04-03T21:38:32.483Z","actor":{"username":"cbsisl","cleared":false,"url":"/cbsisl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2563466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-04-04T07:36:26.169Z","updated_at":"2018-04-04T07:36:26.169Z","actor":{"username":"vicompany","cleared":false,"url":"/vicompany","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6904,"category":"team","content":"The researchers noticed an issue with our ETH receiving code when receiving from a contract. This allowed sending of ETH to Coinbase to be credited even if the underlying contract execution failed. The issue was fixed by changing the contract handling logic. Analysis of the issue indicated only accidental loss for Coinbase, and no exploitation attempts.\n\nThe Security team thanks @vicompany for the quick disclosure, and also the internal team for pushing a fix within hours. We do appreciate @vicompany's patience as the full communication loop back to HackerOne took significantly longer than the fix deployment cycle.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":182874,"username":"cbsisl","name":"cbsisl","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2017-07-12T03:49:16.163Z","url":"https://hackerone.com/cbsisl","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":6862,"category":"researcher","content":"**Short Summary:** \nBy using a smart contract to distribute ether over a set of wallets you can manipulate the account balance of your Coinbase account. If 1 of the internal transactions in the smart contract fails all transactions before that will be reversed. But on Coinbase these transactions will not be reversed, meaning someone could add as much ether to their balance as they want. When you look up the Coinbase wallet address after this transaction you will see that it is empty, but checking your Coinbase wallet will show your funds.\n\n**Steps To Reproduce:**\n* Setup a smart contract with a few valid Coinbase wallets and 1 final faulty wallet (always throw exception when receiving funds smart contract for example)\n* Transfer appropriate funds to smart contract.\n* Execute smart contract adding the set amount of ether to the Coinbase wallets without ever actually leaving the smart contract wallet because the complete transaction fails at the last wallet.\n* Repeat until you have more than enough ethereum in your Coinbase wallet.\n* Cash out, transfer to off site wallet\n\nFor some more information see\nhttps://www.vicompany.nl/magazine/from-christmas-present-in-the-blockchain-to-massive-bug-bounty","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":227749,"username":"vicompany","name":"VI Company","bio":"","cleared":false,"website":"https://www.vicompany.nl/","location":"Stationsplein 45, unit A4.194, 3013 AK Rotterdam, The Netherlands ","created_at":"2017-12-27T08:00:43.386Z","url":"https://hackerone.com/vicompany","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/227/749/2b113d525dfb6b31629cfce0d74cc6143d925e80_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}