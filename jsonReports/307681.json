{"id":307681,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDc2ODE=","url":"https://hackerone.com/reports/307681","title":"Cross-Domain JavaScript Source File Inclusion ","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2018-01-21T17:17:34.880Z","submitted_at":"2018-01-21T17:17:34.880Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"mrunal","url":"/mrunal","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby communityâ€™s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-12-10T17:34:25.429Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-02-18T04:33:12.612Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The page includes one or more script files from a third-party domain.\n\nXSSI is a fancy way of saying: you are including in your program, someone elses code; You don't have any control over what is in that code, and you don't have any control over the security of the server on which it is hosted.\n \nparameter : //secure.gaug.es/track.js\nevidence: \u003cscript type=\"text/javascript\" async defer id=\"gauges-tracker\" data-site-id=\"4eab0ac8613f5d1583000005\" src=\"//secure.gaug.es/track.js\"\u003e\u003c/script\u003e\n\nsolution : Ensure JavaScript source files are loaded from only trusted sources, and the sources can't be controlled by end users of the application.\n\n\n    \u003cscript type=\"text/javascript\" async defer id=\"gauges-tracker\" data-site-id=\"4eab0ac8613f5d1583000005\" src=\"//secure.gaug.es/track.js\"\u003e\u003c/script\u003e\n  \u003c/body\u003e\n\n\nHTTP request :\n\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nContent-Security-Policy: default-src 'self'; script-src 'self' https://secure.gaug.es; style-src 'self' https://fonts.googleapis.com; img-src 'self' https://secure.gaug.es https://gravatar.com https://secure.gravatar.com; font-src 'self' https://fonts.gstatic.com; connect-src https://s3-us-west-2.amazonaws.com/rubygems-dumps/; frame-src https://ghbtns.com\nCache-Control: max-age=0, private, must-revalidate\nSet-Cookie: _rubygems_session=R2ovd2tLZG9lUGtmY1pQczgvSFBjdC9IdjE5QnVJQ0Ywby9xbmNUSlRQU3JaOVNoNnF5WE1KZW14eGFlTTdZbHJPZFp6Vk5Udlp3QTRMSElkTmJnWlFlRjMyVWJJa2k5NU1LTm9XTVozWVBYaHdWLzg1dW1UaDd6TitZR1FYZ041M0oyZk94T2tVMG1vbU54Rm02SThnPT0tLTdZK1pRK0QxTW1GcS9GWVlPZlFoVUE9PQ%3D%3D--102c1918815967faefb0604b28daa2d3900df474; path=/; secure; HttpOnly\nX-Request-Id: 282c9423-26fd-4517-8bfc-1359900c553e\nX-Runtime: 0.013107\nStrict-Transport-Security: max-age=0\nX-UA-Compatible: IE=Edge,chrome=1\nX-Backend: F_Rails 54.186.104.15:443\nAccept-Ranges: bytes\nDate: Sun, 21 Jan 2018 17:00:41 GMT\nVia: 1.1 varnish\nAge: 0\nConnection: keep-alive\nX-Served-By: cache-sin18034-SIN\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1516554041.101894,VS0,VE220\nVary: Accept-Encoding,Fastly-SSL\nETag: \"a2988a0215687cad2553179ed0d2d3ef\"\nServer: RubyGems.org\n\n## Impact\n\nBrowsers prevent pages of one domain from reading pages in other domains. But they do not prevent pages of a domain from referencing resources in other domains. In particular, they allow images to be rendered from other domains and scripts to be executed from other domains. An included script doesn't have its own security context. It runs in the security context of the page that included it. For example, if www.evil.example.com includes a script hosted on www.google.com then that script runs in the evil context not in the google context. So any user data in that script will \"leak","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":256113,"file_name":"jerms.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/113/813fa4df255a2e273cb0449a70bed1b8fae4886b/jerms.html?response-content-disposition=attachment%3B%20filename%3D%22jerms.html%22%3B%20filename%2A%3DUTF-8%27%27jerms.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144222Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=70b2da1f52e9c34a139b68162127edae34ab0e62db24e644a8e9d30d66410a87","file_size":105786,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["ali","omi777"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":2042,"asset_type":"URL","asset_identifier":"rubygems.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2304934,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","automated_response":true,"created_at":"2018-01-21T17:17:35.182Z","updated_at":"2018-01-21T17:17:35.182Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2340938,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mrunal thanks for your report.  If I'm understanding you correctly, what you're saying is that we include 3rd party JS on the RubyGems.org domain and that because we don't fully control that JS it subject to being abused by the 3rd party.  If I understand you properly, to exploit such an attack the 3rd party JS hosting provider would need to be compromised for this to become an issue.","automated_response":false,"created_at":"2018-02-01T03:50:46.915Z","updated_at":"2018-02-01T03:50:46.915Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2340942,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-02-01T03:55:16.411Z","updated_at":"2018-02-01T03:55:16.411Z","additional_data":{"old_severity":"High (7.3)","new_severity":"Low","old_severity_id":110705,"new_severity_id":114217},"actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2342409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"okkkk ","automated_response":false,"created_at":"2018-02-01T16:34:36.749Z","updated_at":"2018-02-01T16:34:36.749Z","actor":{"username":"mrunal","cleared":false,"url":"/mrunal","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2364284,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"@mrunal thanks for the contribution here, but we don't see this as an vuln in the platform per say.  We could do more here to protect 3rd party JS integrity, like sub-resource integrity, but the effort vs benefit trade off isn't a good match up at the moment.","automated_response":false,"created_at":"2018-02-08T23:00:28.733Z","updated_at":"2018-02-08T23:00:28.733Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395711,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-02-18T04:33:12.670Z","updated_at":"2018-02-18T04:33:12.670Z","first_to_agree":true,"actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mrunal I'd like to disclose this report publicly to make it clear what our stance is on this issue and reduce the likelihood of duplicate reports.  Any concerns with that?","automated_response":false,"created_at":"2018-02-18T05:05:25.960Z","updated_at":"2018-02-18T05:05:25.960Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3791509,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If we don't hear back within 7 days, I will disclose this report.","automated_response":false,"created_at":"2018-12-08T23:14:08.486Z","updated_at":"2018-12-08T23:14:08.486Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3791896,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"you can disclose it","automated_response":false,"created_at":"2018-12-09T05:05:51.032Z","updated_at":"2018-12-09T05:05:51.032Z","actor":{"username":"mrunal","cleared":false,"url":"/mrunal","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3791899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sir any bounty or reputation point ???","automated_response":false,"created_at":"2018-12-09T05:08:50.688Z","updated_at":"2018-12-09T05:08:50.688Z","actor":{"username":"mrunal","cleared":false,"url":"/mrunal","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3799670,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Only issues within the rubygems client library are eligible for a bounty.","automated_response":false,"created_at":"2018-12-10T17:34:14.127Z","updated_at":"2018-12-10T17:34:14.127Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3799674,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2018-12-10T17:34:25.385Z","updated_at":"2018-12-10T17:34:25.385Z","actor":{"username":"segiddins","cleared":false,"url":"/segiddins","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}