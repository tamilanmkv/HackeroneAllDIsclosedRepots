{"id":310185,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTAxODU=","url":"https://hackerone.com/reports/310185","title":"Removing a user from a private group doesn't remove him from group's project, if his project's role was changed","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-29T16:09:39.604Z","submitted_at":"2018-01-29T16:09:39.604Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rpadovani","url":"/rpadovani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-05T21:49:34.894Z","bug_reporter_agreed_on_going_public_at":"2019-03-21T09:28:55.851Z","team_member_agreed_on_going_public_at":"2019-04-05T21:49:34.745Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n(a) *rogue* user is added to a private group with dozen of projects\n(b) The role in some projects is changed for the *rogue* user\n(c) *rogue* is fired, and removed from the group: he still has access to projects where his role was changed\n\n**Description:** \n\nthe (b) can happen for a lot of different reasons:\n- *rogue* is added as master - knowing this vulnerability, he decreases his privileges to stay in some projects (this is the only malicious one)\n- *rogue* is added as developer, but for some projects he becomes responsible, and is promoted to master\n- *rogue* is added as reporter, and then he is promoted for a project, and so on.\n\nWhen an admin removes an user from a private group, there is no indication that the user still has access to private projects, if role was changed.\n\nI suggest one of these solutions:\n- add an alert, showing which project he will still have access\n- he is removed from every project\n\n## Steps To Reproduce:\n\n  1. *admin* creates superSecretGroup\n  2. *admin* creates bunch of projects \n  3. *admin* adds *myFirstCTO* as master in the group\n  4. *myFirstCTO* is bad and he is fired\n  5. *myFirstCTO* changes his role in every project\n  6. *admin* removes *myFirstCTO* from group's member\n  7. *myFirstCTO* has still access to everything. As long as *admin* doesn' t go to the single project members page, he will have no idea\n\nStep 3-5 can happen for a lot of different reasons, also not malicious. I found out because I was removed from a group as \"developer\", but I was master of some projects and still had access to them\n\n## Impact\n\nA user can still see all resources of a project of a secret group after he has been removed from the group","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-04-20T09:28:55.968Z","allow_singular_disclosure_after":-78210827.74031824,"singular_disclosure_allowed":true,"vote_count":12,"voters":["mik317","ali","melbadry9","eveeez","an0nym0us","khizer47","cr4xerbik4sh","cryptographer","thequietknight","arider","and 2 more..."],"severity":{"rating":"medium","score":6.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2328120,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani  ,\n\nThank you for submitting this report. We are currently investigating the issue. Due to our current workload, we will get back with you within the next week with an update.\n\nRegards,\nJames","automated_response":false,"created_at":"2018-01-29T18:00:25.861Z","updated_at":"2018-01-29T18:00:25.861Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2369021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani ,\n\nI've validated that this is an Improper Access Control issue and have categorized it as Medium severity. We are working internally on resolving the issue at https://gitlab.com/gitlab-org/gitlab-ce/issues/42726. The issue will be made public once a patch has been released. We will keep you updated on our progress via HackerOne.\n\nFeel free to contact us at anytime if you need an update.\n\nThank you,\nJames\n","automated_response":false,"created_at":"2018-02-09T22:04:31.154Z","updated_at":"2018-02-09T22:04:31.154Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2369023,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-02-09T22:04:38.034Z","updated_at":"2018-02-09T22:04:38.034Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2430556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good morning @jritchey ,\n\nany update on this?\n\nIf you think it will take time to develop a proper patch, I'd prefer go public with this, since group admins can easily check if someone has access to a project, and it shouldn't.\n\nWhat do you think? Do you have any timeline?","automated_response":false,"created_at":"2018-02-25T11:11:00.390Z","updated_at":"2018-02-25T11:11:00.390Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2439450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani  ,\n\nI'm checking with the development team for an estimated fix timeline for this issue. Please note that we do full disclosures of H1 issues 30 days **after** the patch has been released.\n\nBest regards,\nJames\n","automated_response":false,"created_at":"2018-02-27T17:27:46.650Z","updated_at":"2018-02-27T17:27:46.650Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2498809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good morning @jritchey,\nit's almost two months from the first report of this issue, and still I do not have an idea if you have a timeline or a plan to fix this.\n\nSince it is something that administrators can check, I really suggest to make a public statement about it, so administrators can verify if they are afflicted.\n\nAs I am sure you know, it is also the course of actions [suggested](https://security.googleblog.com/2013/05/disclosure-timeline-for-vulnerabilities.html) by Google:\n\n\u003e Our standing recommendation is that companies should fix critical vulnerabilities within 60 days -- or, if a fix is not possible, they should notify the public about the risk and offer workarounds\n\nI fully appreciate you are busy, since Gitlab is a big application with thousands of users, but I'd like to have an update if/when you plan to act on this.\n\nHave a great day :-)\nR.","automated_response":false,"created_at":"2018-03-16T11:01:50.841Z","updated_at":"2018-03-16T11:01:50.841Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2500338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani ,\n\nThe development team is actively working on this issue. I've asked them for a timeline for a fix, and I'll let you know once I hear back from them. Thank you for checking up on this issue.\n\nBest regards,\nJames","automated_response":false,"created_at":"2018-03-16T23:21:00.283Z","updated_at":"2018-03-16T23:21:00.283Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3992307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi James,\nI just stumbled again across this report - do you have any news?\n\nHave a nice day,\nRiccardo","automated_response":false,"created_at":"2019-01-17T12:01:04.542Z","updated_at":"2019-01-17T12:01:04.542Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4261458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jritchey \nany update on this?\n","automated_response":false,"created_at":"2019-03-05T15:44:10.415Z","updated_at":"2019-03-05T15:44:10.415Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4311413,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @rpadovani ,\n\nApologies for the delay on this on. Thank you again for the report! It looks like it was fixed in version 11.7.3 and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-03-12T22:53:42.520Z","updated_at":"2019-03-12T22:53:42.520Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"rpadovani","url":"/rpadovani"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4311415,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-03-12T22:53:59.506Z","updated_at":"2019-03-12T22:53:59.506Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rpadovani","url":"/rpadovani"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4315100,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!\n\nThe patch seems to work fine on Gitlab.com :)\n\nWill be this report be made public in 30 days as well?","automated_response":false,"created_at":"2019-03-13T09:20:42.673Z","updated_at":"2019-03-13T09:20:42.673Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4365387,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @jritchey ,\nI see the linked issue on the Gitlab tracker has been made public available, can we disclose this report as well?\n\nThanks,\nRiccardo","automated_response":false,"created_at":"2019-03-21T09:28:55.887Z","updated_at":"2019-03-21T09:28:55.887Z","first_to_agree":true,"actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4494304,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Setting to public","automated_response":false,"created_at":"2019-04-05T21:49:34.782Z","updated_at":"2019-04-05T21:49:34.782Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4494305,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-04-05T21:49:34.923Z","updated_at":"2019-04-05T21:49:34.923Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":15266,"category":"researcher","content":"I published a summary with some personal notes on my blog: https://rpadovani.com/gitlab-responsible-disclosure","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":236751,"username":"rpadovani","name":"Riccardo Padovani","bio":"Changing the world bit by bit","cleared":false,"website":"https://rpadovani.com","location":"Munich","created_at":"2018-01-29T15:46:49.058Z","url":"https://hackerone.com/rpadovani","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}