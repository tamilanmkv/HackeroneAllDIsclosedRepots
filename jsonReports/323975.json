{"id":323975,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjM5NzU=","url":"https://hackerone.com/reports/323975","title":"CSRF in Inviting users","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-03-09T19:33:21.827Z","submitted_at":"2018-03-09T19:33:21.827Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rijalrojan","url":"/rijalrojan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":25188,"url":"https://hackerone.com/pingidentity","handle":"pingidentity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ping Identity","twitter_handle":"pingidentity","website":"https://www.pingidentity.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-26T20:41:09.075Z","bug_reporter_agreed_on_going_public_at":"2019-03-26T20:35:57.285Z","team_member_agreed_on_going_public_at":"2019-03-26T20:41:08.918Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n**Summary:** [add summary of the vulnerability]\nWhen a user is invited, a GET request is made. This can be used with a CSRF attack. \n\n**Description:** [add more details about this vulnerability]\nUser invitations usually should be done through a POST request. In this case the app uses a GET request. For example: https://ort-admin.pingone.com/web-portal/ajax/user/directory/inviteuser/?alternate_email=rojan@netsecurity.tech\u0026email=rojan@securifyinc.com\nWhich allows inviting another user easily. \n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Download the attached html. \n  2. Open it in a logged in browser. \n  3. It should invite my email to the website. \n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nAdding other users easily. Gives internal access.\n\nThe hacker selected the **Cross-Site Request Forgery (CSRF)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://ort-admin.pingone.com/web-portal/usermanagement#/\n\n**Verified**\nYes\n\n**Can a victim be forced to perform a sensitive state-change operation unknowningly?**\nYes\n\n**What state-change operation can be performed?**\nAdding users.","bounty_amount":"1250.0","formatted_bounty":"$1,250","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":271054,"file_name":"csrf.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/271/054/539d4f01759dfb55bcfaefabced1858992f0285d/csrf.html?response-content-disposition=attachment%3B%20filename%3D%22csrf.html%22%3B%20filename%2A%3DUTF-8%27%27csrf.html\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144541Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e5e469c7b3ef164041fdca642cf52987603891a816ad1eb9fe0479b8f2105cab","file_size":162,"type":"text/plain"}],"allow_singular_disclosure_at":"2019-04-25T20:35:57.367Z","allow_singular_disclosure_after":-77738983.6413896,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mashoud1122","0-1","exception","aksl337"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":6162,"asset_type":"URL","asset_identifier":"https://ort-admin.pingone.com/*","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2479875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @uranium238,\n\nThanks for the report. We'll be looking into it and get back to you shortly.\n\nRegards,\n@bagofchips","automated_response":false,"created_at":"2018-03-10T19:34:04.486Z","updated_at":"2018-03-10T19:34:04.486Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479883,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-03-10T19:37:53.447Z","updated_at":"2018-03-10T19:37:53.447Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2480099,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good. Thanks @bagofchips \n","automated_response":false,"created_at":"2018-03-10T21:53:45.626Z","updated_at":"2018-03-10T21:53:45.626Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2484250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, I forgot to give reasoning on why it was marked Critical:\n\nWhen a user is added, they can use the SSO platform to easily login to any internal application of a company. This can be exploited easily and has a major impact on company's integrity so the CVSS reflects that.","automated_response":false,"created_at":"2018-03-12T16:34:33.978Z","updated_at":"2018-03-12T16:34:33.978Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2511957,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-20T21:11:24.394Z","updated_at":"2018-03-20T21:11:24.394Z","additional_data":{"old_severity":"Critical (9.7)","new_severity":"Critical (9.7)","old_severity_id":126971,"new_severity_id":130642},"actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2515889,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-03-21T20:54:35.724Z","updated_at":"2018-03-21T20:54:35.724Z","actor":{"url":"/pingidentity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ping Identity"}},"bounty_amount":"1250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"pingidentity","collaborator":{"username":"rijalrojan","url":"/rijalrojan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2763883,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-05-18T19:42:02.799Z","updated_at":"2018-05-18T19:42:02.799Z","additional_data":{"old_severity":"Critical (9.7)","new_severity":"High","old_severity_id":130642,"new_severity_id":156086},"actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3349914,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-09-17T17:08:24.414Z","updated_at":"2018-09-17T17:08:24.414Z","actor":{"username":"richardcardona","cleared":false,"url":"/richardcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rijalrojan","url":"/rijalrojan"},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4395986,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-26T20:35:57.315Z","updated_at":"2019-03-26T20:35:57.315Z","first_to_agree":true,"actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4396008,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-26T20:41:08.961Z","updated_at":"2019-03-26T20:41:08.961Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4396009,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-26T20:41:09.099Z","updated_at":"2019-03-26T20:41:09.099Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}