{"id":330721,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzA3MjE=","url":"https://hackerone.com/reports/330721","title":"Expose relay IP in the debug (The source is different from the rendering)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-03-28T10:22:07.534Z","submitted_at":"2018-03-28T10:22:07.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rbcafe","url":"/rbcafe","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-21T17:57:04.911Z","bug_reporter_agreed_on_going_public_at":"2018-07-12T16:09:09.076Z","team_member_agreed_on_going_public_at":"2018-07-21T17:57:04.845Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Greetings,\n--\n\nI observed that it was possible to expose the ip of  a relay by doing this :\n\nPoc :\n--\n\n- Go to https://sorry.google.com/sorry/misc/\n- You must observe this visual.\n\n{F279451}\n\n- Open Tor Browser debug\n- You must observe this visual \n\n{F279452}\n\nNote :\n--\n\nYou observe that between the debug and the main window there is no relation between the rendered text and the source code. The text discloses the IP of the client while the source discloses the IP of the relay.\n\nBest regards \n\n@Rbcafe\n\n## Impact\n\n- Get the IP of the relay by changing the ip of the client.","original_report_id":null,"original_report_url":null,"attachments":[{"id":279451,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/279/451/4e8b177ae3ccf819990108d3d2beddfdfd04b6e7/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144648Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=39a8e8e5b03ece22d2c154d9682151dfa26a9e786aef49d0165fa81ee3638e86","file_size":40452,"type":"image/png"},{"id":279452,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/279/452/943f4d3f884d24adcefb875f7977158a69e940a7/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144648Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9ac19d63ff14f5a6eca82d429e5b0466a89674e5be624a4cb97b846f6d5d3c0b","file_size":122376,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["ramsexy","sameerphad72","apapedulimu","hack2tools123","cryptographer","rbcafe","0x08"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2542845,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"In fact, both of those IP addresses are IPs from exit relays:\n\nhttps://metrics.torproject.org/rs.html#details/79E169B25E4C7CE99584F6ED06F379478F23E2B8\n\nhttps://metrics.torproject.org/rs.html#details/47C42E2094EE482E7C9B586B10BABFB67557030B\n\nSo, the important point is: your client IP is not leaked. What is happening here is the following: The IP you see on the sorry page is the one that Google saw when you first landed on that page. Now, the IP address which is shown in the debugger should be the same one as it is basically showing just the source to already loaded content. So, the first bug is that Firefox is fetching the resource again. But still the request should go over the same Tor circuit as one could argue we are still on the same website with the same first party domain. However, that does not happen and instead the request is sent over the circuit used for all those requests which don't have a first party domain associated (like background update checks for extensions).\n\nSo, this is a bug on our side, yes, although I don't think it meets the requirements for a bug bounty. Instead I've opened a ticket in our public bug tracker:\n\nhttps://trac.torproject.org/projects/tor/ticket/25672\n\nHowever, would you be interested in some Tor swag as an appreciation for your efforts looking at our software? If so, please send an email to me (gk[@]torproject[.]org (without the brackets)) and I'll get you in touch with the right person.","automated_response":false,"created_at":"2018-03-29T07:20:52.645Z","updated_at":"2018-03-29T07:20:52.645Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2542863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings,\n\nThanks for the information and for the swag notice.\n\nBest regards.\n\n@Rbcafe","automated_response":false,"created_at":"2018-03-29T07:34:17.830Z","updated_at":"2018-03-29T07:34:17.830Z","actor":{"username":"rbcafe","cleared":false,"url":"/rbcafe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3035356,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Greetings,\n\nDo you agree for disclosure ?\n\nBest regards\n\n@Rbcafe","automated_response":false,"created_at":"2018-07-12T16:09:09.104Z","updated_at":"2018-07-12T16:09:09.104Z","first_to_agree":true,"actor":{"username":"rbcafe","cleared":false,"url":"/rbcafe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3078447,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-21T17:57:04.870Z","updated_at":"2018-07-21T17:57:04.870Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3078448,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-21T17:57:04.935Z","updated_at":"2018-07-21T17:57:04.935Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}