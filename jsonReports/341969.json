{"id":341969,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE5Njk=","url":"https://hackerone.com/reports/341969","title":"DOM XSS in edoverflow.com/tools/respond due to unsafe usage of the innerHTML property.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-04-23T11:01:15.691Z","submitted_at":"2018-04-23T11:01:15.691Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"karel_origin","url":"/karel_origin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24342,"url":"https://hackerone.com/ed","handle":"ed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ed","twitter_handle":"EdOverflow","website":"https://edoverflow.com","about":"This is a vulnerability disclosure program for all of my personal projects and code that I publish."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-23T11:28:11.422Z","bug_reporter_agreed_on_going_public_at":"2018-04-23T11:25:05.505Z","team_member_agreed_on_going_public_at":"2018-04-23T11:28:11.321Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThere's a DOM XSS vulnerability on [edoverflow.com](https://edoverflow.com/tools/respond/). This cannot be exploited without user-interaction so I had to make a clickjacking PoC to trick the user in triggering the payload her/himself.\n\n#Reproduction Steps\n1. Open the attached HTML document in FireFox.\n2. Drag Frog 1 to the other (two) frogs.\n3. Click on the \"Make friends!\" button.\n\nResult: \n{F289573}\n\n# Vulnerable JavaScript\n\n```\n\u003chtml\u003e\n\u003cscript\u003e\n/* ===========================================\n  Allow users to submit usernames and store \n  them in localStorage for future use.\n============================================*/\ndocument.getElementById(\"form\").addEventListener(\"submit\", function(){\n    var triager = document.getElementById(\"triager\").value;\n    var hacker = document.getElementById(\"hacker\").value;\n    console.log(hacker); // Why is this not executing?\n    document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n    document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n    //localStorage.setItem(\"triager\", triager);\n\n//var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n//document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retriev\ndocument.getElementById(\"remove\").addEventListener(\"click\", function(){\n    localStorage.removeItem(\"triager\");\n});\n\u003c/script\u003e\n\u003c/html\u003e\n```\n\n#Fix\n\n~~~diff\n- \u003cinput type=\"submit\" name=\"submit\" class=\"button\"\u003e\n+ \u003cinput type=\"button\" class=\"button\" id=\"submit\"\u003e\n~~~\n\n~~~diff\n       Allow users to submit usernames and store \n       them in localStorage for future use.\n     ============================================*/\n-    document.getElementById(\"form\").addEventListener(\"submit\", function(){\n-        var triager = document.getElementById(\"triager\").value;\n-        var hacker = document.getElementById(\"hacker\").value;\n+       elem = document.getElementsByTagName(\"pre\")[0].children[0];\n+\n+    document.getElementById(\"submit\").addEventListener(\"click\", function(){\n+        var trger = document.getElementById(\"triager\").value;\n+        var hckr = document.getElementById(\"hacker\").value;\n         console.log(hacker); // Why is this not executing?\n-        document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', triager);\n-        document.body.innerHTML = document.body.innerHTML.replace('{{username}}', hacker);\n-        //localStorage.setItem(\"triager\", triager);\n+               elem.innerText = elem.innerText.replace(\"{{username}}\", trger).replace(\"{{triager}}\", hckr);\n+        localStorage.setItem(\"triager\", trger);\n     });\n \n-    //var retrieve = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n-    //document.body.innerHTML = document.body.innerHTML.replace('{{triager}}', retrieve);\n+    if(localStorage.getItem(\"triager\") != null) {\n+       var trger = localStorage.getItem(\"triager\"); // Why does this return \"null\"?\n+       elem.innerText = elem.innerText.replace(\"{{triager}}\", trger);\n+    }\n \n     document.getElementById(\"remove\").addEventListener(\"click\", function(){\n         localStorage.removeItem(\"triager\");\n     });\n\n~~~\n\nRaw (JS attached)\n\n## Impact\n\nThere is not much that can be done because it looks like most pages don't require authentication, I also don't think that the owner of this website would fall for something like this. ;)\n\n\nThanks,\nKarel.\n\nThe hacker selected the **Cross-site Scripting (XSS) - DOM** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://edoverflow.com/tools/respond/\n\n**Verified**\nYes\n\n","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":289572,"file_name":"fix.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/572/b7a4940a2bba2e2f36116c8b531a4aeba81e7d26/fix.js?response-content-disposition=attachment%3B%20filename%3D%22fix.js%22%3B%20filename%2A%3DUTF-8%27%27fix.js\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144809Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=266d2c50ba6c7cf8d5ee37b5ba7beb97c31c617a4955c4dc1fb7bf5fb0d64ae1","file_size":950,"type":"text/plain"},{"id":289573,"file_name":"screenshot.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/573/8a479c91cbb947ed405a2649ab4cbd49179c3b37/screenshot.PNG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.PNG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144809Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e2363a15f9f7ca47c59da63592bf098aa5fc03e7745586f783045a975d2de611","file_size":139116,"type":"image/png"},{"id":289579,"file_name":"Clickjacking-XSS.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/289/579/eb14ac71e4fc0411158af50c3a7810682b938944/Clickjacking-XSS.html?response-content-disposition=attachment%3B%20filename%3D%22Clickjacking-XSS.html%22%3B%20filename%2A%3DUTF-8%27%27Clickjacking-XSS.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144809Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ed840ee1d9b1ddcffab35ee683ccf656886e05d4183d04bdef660c86a22ff3a6","file_size":1769,"type":"text/html"}],"allow_singular_disclosure_at":"2018-05-23T11:25:05.634Z","allow_singular_disclosure_after":-106888983.63543853,"singular_disclosure_allowed":true,"vote_count":27,"voters":["jokebookservice1","sp1d3rs","filedescriptor","europa","kapytein","secator","muon4","bl4de","sameerphad72","emitrani","and 17 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":3524,"asset_type":"URL","asset_identifier":"https://edoverflow.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2653059,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is a valid report! Fantastic work, @karel_origin. I will apply the patch and notify you when everything has been resolved properly.\n\n\\- Ed","automated_response":false,"created_at":"2018-04-23T11:04:43.222Z","updated_at":"2018-04-23T11:04:43.222Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653067,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I have pushed a fix to production. Would you mind taking a quick look and making sure it has been fixed properly?","automated_response":false,"created_at":"2018-04-23T11:10:47.795Z","updated_at":"2018-04-23T11:10:47.795Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"karel_origin","url":"/karel_origin"},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653094,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @edoverflow,\n\nIt looks like the fix is working as planned.\n\nThank you for the quick fix and response!\nKarel.","automated_response":false,"created_at":"2018-04-23T11:25:05.560Z","updated_at":"2018-04-23T11:25:05.560Z","first_to_agree":true,"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2653099,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you so much for your help, @karel_origin. It is always a pleasure to work with you. I hope other programs reading this will see how much effort you put into your reports and fight to get you to participate on their programs. :P\n\nOn a side note, that was the best proof of concept I have ever received on this program. 10/10 would hack again with you.","automated_response":false,"created_at":"2018-04-23T11:28:11.355Z","updated_at":"2018-04-23T11:28:11.355Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2653100,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-23T11:28:11.456Z","updated_at":"2018-04-23T11:28:11.456Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2659488,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"🎁","automated_response":false,"created_at":"2018-04-24T11:34:27.892Z","updated_at":"2018-04-24T11:34:27.892Z","actor":{"url":"/ed","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ed"}},"reporter":{"username":"karel_origin","url":"/karel_origin"},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}