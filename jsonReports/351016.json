{"id":351016,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTEwMTY=","url":"https://hackerone.com/reports/351016","title":"Malformed Skybox .TGA in Half-Life (GoldSRC) leads to Access Violation","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-05-13T01:14:32.363Z","submitted_at":"2018-05-13T01:14:32.363Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chippy","url":"/chippy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-08-28T23:37:17.517Z","bug_reporter_agreed_on_going_public_at":"2018-08-25T00:37:12.827Z","team_member_agreed_on_going_public_at":"2018-08-28T23:37:17.399Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A malformed .TGA when loaded as a Skybox on a map in a GoldSRC engine game (Half-Life) can lead to arbitrary code execution on a remote client.\n\n###Reproduction Steps\n\nLoad the attached map + resources on a local Half-Life listen server. The game will crash with an Access Violation as soon as the map with the malicious skybox is loaded.\n\n###Exploitability\n\nSince anyone can host a map with custom assets, and the custom assets are loaded onto a remote clients computer, a malicious server can distribute malformed skybox assets (.TGA's) that could cause remote code execution on clients. The inclusion of .DLL's on Steam without ASLR make exploitablility of this bug via ROP quite trivial.\n\n## Impact\n\n###Impact\n\nA malicious server could infect hundreds or perhaps thousands of clients with this bug. This bug could also be used in targeted attacks for the theft / compromise of high-value Steam accounts by attacking their Half-Life client.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":3,"name":"Classic Buffer Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":296767,"file_name":"crossfire.tga.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/296/767/f010326221fa09fb1c24338b8c7959b0ce3422bf/crossfire.tga.zip?response-content-disposition=attachment%3B%20filename%3D%22crossfire.tga.zip%22%3B%20filename%2A%3DUTF-8%27%27crossfire.tga.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144917Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=64ed24183f8e326209f77d4009944d2328d457caa226acf7f0c5cfede71723c3","file_size":906043,"type":"application/zip"}],"allow_singular_disclosure_at":null,"vote_count":30,"voters":["njbooher","mvc","ras-it","chippy","mik317","romesful","ali","dilawer01","asad0x01_","michan","and 20 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":1289,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"hl.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2758294,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @chippy,\nThank you for your submission. We need some more information before we can properly review and validate this report. Is it possible you could provide a clearer step-by-step PoC showing this vulnerability? Is it also possible that you provide a video proof-of-concept showing the full exploitation chain?Â  Thanks again for your report and we hope to hear back from you soon. \n\nKind regards.\n@doggos","automated_response":false,"created_at":"2018-05-17T17:02:27.345Z","updated_at":"2018-05-17T17:02:27.345Z","actor":{"username":"doggos","cleared":false,"url":"/doggos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/277/976/e6a23fde0d47001c23dfed7d3c2fef3eb608463e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2781143,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Gentlemen, apologies for the wait. I've attached a .zip containing a recording of the PoC from start to finish, including the crash w/ Access Violation (Exploitable). Let me know if any further detail is required.\n\nKindly,","automated_response":false,"created_at":"2018-05-22T22:32:41.513Z","updated_at":"2018-05-22T22:32:41.513Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":300486,"filename":"HL_TGA_Crash.zip","type":"application/zip","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/300/486/5c23909cf6bc3ee73459d462ed26f090b347727b/HL_TGA_Crash.zip?response-content-disposition=attachment%3B%20filename%3D%22HL_TGA_Crash.zip%22%3B%20filename%2A%3DUTF-8%27%27HL_TGA_Crash.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144917Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a669fe5a47ca247fd26804ba0b346bd38e88884ade70a075f80276fb26ce82d6"}],"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3045041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, may I kindly have an update on this?","automated_response":false,"created_at":"2018-07-14T11:34:47.664Z","updated_at":"2018-07-14T11:34:47.664Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3045964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chippy,\n\nThanks again for the report, we're still looking into this and will respond in this ticket as soon as we have an update. Apologies for any inconvenience.\n\nKind regards,\n@EyeQ","automated_response":false,"created_at":"2018-07-14T23:06:26.268Z","updated_at":"2018-07-14T23:06:26.268Z","actor":{"username":"eyeq","cleared":false,"url":"/eyeq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/260/224/73a49f0c9b82b7dde9fa6838b4cf7ceee82b714a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070432,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chippy, sorry for the delay in responding to this issue. I've looked closely into this report and believe that, while it is definitely a vector for crashing the clients of connected players, it isn't very likely or potentially even possible to turn this issue into a viable remote code exploit. This is still a danger to users and is a valid buffer overflow, but due to the likelihood of being able to focus this into a targeted attack I believe the appropriate severity for this issue to be high rather than critical.\n\nI would be happy to update the severity back to critical if you are able to provide a test case that shows you are able to modify a user's process in an intentional way utilizing this exploit.\n\nThank you for the detailed submission!","automated_response":false,"created_at":"2018-07-19T21:07:53.924Z","updated_at":"2018-07-19T21:07:53.924Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3070436,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-19T21:08:42.215Z","updated_at":"2018-07-19T21:08:42.215Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":152931,"new_severity_id":185730},"actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3102331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mikela , appreciate the follow up! We are in agreement, after expanding on our research we've audited the vulnerability thoroughly and could not expand upon the original PoC. More than fair to close this one out as \"High\", more bugs to follow. Thanks as always!","automated_response":false,"created_at":"2018-07-26T20:26:03.220Z","updated_at":"2018-07-26T20:26:03.220Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3127707,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-08-01T09:37:00.412Z","updated_at":"2018-08-01T09:37:00.412Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3242727,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-08-25T00:03:03.401Z","updated_at":"2018-08-25T00:03:03.401Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Valve"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"chippy","url":"/chippy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3242728,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report! We have deployed a fix to our production systems. Please let us know if you are still able to reproduce the issue.","automated_response":false,"created_at":"2018-08-25T00:03:12.371Z","updated_at":"2018-08-25T00:03:12.371Z","actor":{"username":"jonp","cleared":false,"url":"/jonp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/203/578/6de63d2fdd8c70309cf4326359d3e816a7633b5c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"chippy","url":"/chippy"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3242783,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks as always everyone! I've verified the patch is working as it should. I would love to do a write-up on this soon. May we kindly go public with this report?","automated_response":false,"created_at":"2018-08-25T00:37:12.876Z","updated_at":"2018-08-25T00:37:12.876Z","first_to_agree":true,"actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3261165,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-08-28T23:37:17.446Z","updated_at":"2018-08-28T23:37:17.446Z","actor":{"username":"jonp","cleared":false,"url":"/jonp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/203/578/6de63d2fdd8c70309cf4326359d3e816a7633b5c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3261166,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-08-28T23:37:17.552Z","updated_at":"2018-08-28T23:37:17.552Z","actor":{"username":"jonp","cleared":false,"url":"/jonp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/203/578/6de63d2fdd8c70309cf4326359d3e816a7633b5c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}