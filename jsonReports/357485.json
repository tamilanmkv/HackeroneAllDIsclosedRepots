{"id":357485,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTc0ODU=","url":"https://hackerone.com/reports/357485","title":"Hacktivity of a private program visible to banned user if he gets invited to a program by hackbot","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-05-25T15:02:57.212Z","submitted_at":"2018-05-25T15:02:57.212Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"parth","url":"/parth","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-27T05:38:36.959Z","bug_reporter_agreed_on_going_public_at":"2018-06-27T05:38:36.861Z","team_member_agreed_on_going_public_at":"2018-06-27T03:26:07.058Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe hacktivity of a private program is visible to banned user if he gets invited to a program by hackbot.\n**Description:**\nBack in 2016 i was banned by █████'s private program ( ███ ) due to some conflict between me and their security team, i think they manually put me in banned users list, but few months back i was invited to █████████'s Program by Hackbot in the occasional invites HackerOne sends and i accepted it. But still i am not able to access their program which obviously i shouldn't as i am banned by their security team, but today i noticed in Hacktivity that i am still able to view the reports they have closed.\n████\nWhile going to ██████████ still shows me `Page not found` : \n\n██████\n\nAlso in my profile's `whitelisted_team_ids` i can see the team id of ██████████ `████`\n#Also i am able to make the following requests : \n\n## 1) Get Complete Hacktivity of program : \n###Request : \n```\nGET /hacktivity?sort_type=latest_disclosable_activity_at\u0026page=1\u0026filter=type%3Aall%20to%3A██████████\u0026range=forever HTTP/1.1\nHost: hackerone.com\nConnection: close\nAccept: application/json, text/javascript, */*; q=0.01\nX-CSRF-Token: REDACTED\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36\nContent-Type: application/json\nDNT: 1\nReferer: https://hackerone.com/REDACTED/hacktivity\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: REDACTED\n```\n###Response :\n```\nHTTP/1.1 200 OK\nDate: Fri, 25 May 2018 14:30:37 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.json\"\nX-Request-Id: 17dafd21-a2e3-42c5-b046-e061da2a283c\nSet-Cookie: REDACTED\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nExpect-CT: enforce, max-age=86400\nContent-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; child-src www.youtube-nocookie.com; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare\nCF-RAY: 4208b363780d8a7f-BOM\nContent-Length: 17633\n\n████████\n```\n\n##2) In Scope Items / Assets\n###Request :\n```\nPOST /graphql HTTP/1.1\nHost: hackerone.com\nConnection: close\nContent-Length: 1250\nAccept: */*\nX-Auth-Token: REDACTED\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36\nOrigin: https://hackerone.com\nContent-Type: application/json\nDNT: 1\nReferer: https://hackerone.com/REDACTED\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: REDACTED\n\n{\"query\":\"query Team_assets($first_0:Int!,$first_1:Int!) {\\n  query {\\n    id,\\n    ...F0\\n  }\\n}\\nfragment F0 on Query {\\n  me {\\n    _membership3abeOl:membership(team_handle:\\\"██████\\\") {\\n      permissions,\\n      id\\n    },\\n    id\\n  },\\n  _team3p4BfA:team(handle:\\\"███\\\") {\\n    handle,\\n    _structured_scopes2tadtg:structured_scopes(first:$first_0,archived:false) {\\n      max_updated_at\\n    },\\n    _structured_scopes2tzyk4:structured_scopes(first:$first_1,archived:false,eligible_for_submission:true) {\\n      edges {\\n        node {\\n          id,\\n          asset_type,\\n          asset_identifier,\\n          rendered_instruction,\\n          max_severity,\\n          eligible_for_bounty\\n        },\\n        cursor\\n      },\\n      pageInfo {\\n        hasNextPage,\\n        hasPreviousPage\\n      }\\n    },\\n    _structured_scopes1j7lgN:structured_scopes(first:$first_1,archived:false,eligible_for_submission:false) {\\n      edges {\\n        node {\\n          id,\\n          asset_type,\\n          asset_identifier,\\n          rendered_instruction\\n        },\\n        cursor\\n      },\\n      pageInfo {\\n        hasNextPage,\\n        hasPreviousPage\\n      }\\n    },\\n    id\\n  },\\n  id\\n}\",\"variables\":{\"first_0\":100,\"first_1\":50}}\n```\n###Response :\n```\nHTTP/1.1 200 OK\nDate: Fri, 25 May 2018 14:44:40 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.\"\nX-Request-Id: 9c159688-f22b-4f74-89ef-73df5e85a2f3\nSet-Cookie: REDACTED\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nExpect-CT: enforce, max-age=86400\nContent-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; child-src www.youtube-nocookie.com b5s.hackerone-ext-content.com; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare\nCF-RAY: 4208c802e9c88aa3-BOM\nContent-Length: 5292\n\n████████\n```\n\n##3) Program Updates\n###Request : \n```\nPOST /graphql HTTP/1.1\nHost: hackerone.com\nConnection: close\nContent-Length: 496\nAccept: */*\nX-Auth-Token: REDACTED\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36\nOrigin: https://hackerone.com\nContent-Type: application/json\nDNT: 1\nReferer: https://hackerone.com/REDACTED/updates\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: REDACTED\n\n{\"query\":\"query Team_posts($first_0:Int!) {\\n  query {\\n    id,\\n    ...F0\\n  }\\n}\\nfragment F0 on Query {\\n  _teamhn8Kp:team(handle:\\\"█████████\\\") {\\n    _posts3y3M77:posts(first:$first_0) {\\n      total_count,\\n      edges {\\n        node {\\n          id,\\n          created_at,\\n          markdown_message,\\n          title\\n        },\\n        cursor\\n      },\\n      pageInfo {\\n        hasNextPage,\\n        hasPreviousPage\\n      }\\n    },\\n    id\\n  },\\n  id\\n}\",\"variables\":{\"first_0\":100}}\n```\n###Response :\n```\nHTTP/1.1 200 OK\nDate: Fri, 25 May 2018 14:33:25 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.\"\nX-Request-Id: 19e8ac92-8663-49b9-a614-a80e01b8d2df\nSet-Cookie: REEDACTED\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nExpect-CT: enforce, max-age=86400\nContent-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; child-src www.youtube-nocookie.com b5s.hackerone-ext-content.com; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare\nCF-RAY: 4208b7850b348aa9-BOM\nContent-Length: 240\n\n████████\n```\n\n## Impact\n\nAs hackerone is sending lot of invites these days so it is possible that the users a program banned get invites by hackbot, hackbot shouldn't send invites to users who are in the banned list of program whose invite is being sent to the hacker and/or the above endpoints should check if the user is in program ban list.\n\n___Regards,\nParth :)___","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-27T03:26:07.190Z","allow_singular_disclosure_after":-101301828.73740956,"singular_disclosure_allowed":true,"vote_count":39,"voters":["sp1d3rs","sameerphad72","princechaddha","ali","geekboy","aryan2808","dilawer01","bugdiscloseguys","michan","geeknik","and 29 more..."],"severity":{"rating":"low","score":3.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2814218,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report, I'll be looking into this a bit further. As I understand we don't send invites to banned hackers any longer, but we may not have cleaned up the permissions or removed any existing invitations. \n\nIs there any sensitive information you can access or ways to interact with the program? I'm not sure there's much there, as you already know the private program exists (policy, hacktivity, etc) from participating in it before.","automated_response":false,"created_at":"2018-05-29T19:55:16.923Z","updated_at":"2018-05-29T19:55:16.923Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2821125,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @bencode, I don't think i can extract things other than __Hacktivity, In Scope Items / Assets and Program Updates__ Still, if I'm banned, I shouldn't  be able to access the new scope/policy/updates.\n\n___Regards!___","automated_response":false,"created_at":"2018-05-31T08:13:58.760Z","updated_at":"2018-05-31T08:20:37.893Z","actor":{"username":"parth","cleared":true,"url":"/parth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2865552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @bencode, Any update on this ? :)","automated_response":false,"created_at":"2018-06-11T08:30:43.493Z","updated_at":"2018-06-11T08:30:43.493Z","actor":{"username":"parth","cleared":true,"url":"/parth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2889782,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again, @parth! We're in the process of doing two things here:\n\n - when we fixed a bug a while ago we forgot to remove users from programs that had banned them; we're planning to make this change somewhere next week\n - we'll audit our ACLs and GraphQL authorization logic for programs to make sure that in case this happens again in the future, no data is actually accessible by a banned user; this is not a blocker to resolve this issue\n\nWe'll get back to you with an update next week. Thanks!","automated_response":false,"created_at":"2018-06-15T17:29:32.481Z","updated_at":"2018-06-15T17:29:32.481Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"parth","url":"/parth"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2938951,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-06-27T03:10:43.170Z","updated_at":"2018-06-27T03:10:43.170Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.8)","old_severity_id":159411,"new_severity_id":173306},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2938956,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @parth - we've just pushed a fix for this. We've removed users from the programs that were previously banned and added backend validation to make sure the user can't be in both states. This shouldn't happen again. We'll redact any confidential information in the report soon and request disclosure after that. We're looking forward to receive more reports from you in the future. Happy hacking!","automated_response":false,"created_at":"2018-06-27T03:13:35.190Z","updated_at":"2018-06-27T03:13:35.190Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"parth","url":"/parth"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2938973,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-27T03:26:07.094Z","updated_at":"2018-06-27T03:26:07.094Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2939042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jobert, Please redact the team id `████` as well. Regards!\n","automated_response":false,"created_at":"2018-06-27T04:32:32.040Z","updated_at":"2018-06-27T05:32:42.679Z","actor":{"username":"parth","cleared":true,"url":"/parth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2939124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @parth - thanks for letting me know. The IDs aren't a secret, but I went ahead and redacted it to make sure that others who have access to that program can't identify it. This is good to go!","automated_response":false,"created_at":"2018-06-27T05:37:05.737Z","updated_at":"2018-06-27T05:37:05.737Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2939125,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-27T05:38:36.904Z","updated_at":"2018-06-27T05:38:36.904Z","actor":{"username":"parth","cleared":true,"url":"/parth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2939126,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-06-27T05:38:37.010Z","updated_at":"2018-06-27T05:38:37.010Z","actor":{"username":"parth","cleared":true,"url":"/parth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ncrHdNh7x5GSfQTSiwjht2uG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}