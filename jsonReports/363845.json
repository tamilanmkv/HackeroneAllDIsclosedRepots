{"id":363845,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjM4NDU=","url":"https://hackerone.com/reports/363845","title":"Cross site scripting (content-sniffing)","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2018-06-10T01:18:04.447Z","submitted_at":"2018-06-10T01:18:04.447Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"said778","url":"/said778","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-10T09:25:13.334Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-06-10T05:43:15.765Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This type of XSS can only be triggered on (and affects) content sniffing browsers.\n\nThis script is possibly vulnerable to Cross Site Scripting (XSS) attacks.\n\nThis vulnerability affects /sign-up\nURL encoded POST input sign-in.currency was set to USD\u003cWDILR9\u003eG8OAI[!+!]\u003c/WDILR9\u003e\nThe input is reflected inside a text element\n\nput this URL https://liberapay.com/about/me/edit\u0026sign-in.currency=USD%3CWDILR9%3EG8OAI%5b%21%2b%21%5d%3C/WDILR9%3E\n\nnow put \n\ncsrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I \u0026 form.repost=false\u0026sign-in.back-to=/about/me/edit \u0026 sign-in.currency=USD\u003cWDILR9\u003eG8OAI%5b%21%2b%21%5d\u003c/WDILR9\u003e \u0026 sign-in.email=sample%40email.tst\n\nyou will see the email sent \nand that is allowing the attacker to access any cookies or session tokens retained by the browser. \n\nResponse\n\nHTTP/1.1 400 Bad Request\nContent-Type: application/json; charset=UTF-8\nContent-Length: 196\nConnection: keep-alive\nX-Xss-Protection: 1; mode=block\nContent-Security-Policy: default-src 'self' liberapay.com;connect-src 'self' *.liberapay.org *.mangopay.com *.payline.com;form-action 'self';img-src * blob: data:;object-src 'none';report-uri https://liberapay.report-uri.com/r/d/csp/enforce;upgrade-insecure-requests;\nCache-Control: no-cache\nX-Frame-Options: SAMEORIGIN\nReferrer-Policy: strict-origin-when-cross-origin\nSet-Cookie: csrf_token=oiCrDqa91GRS4YBFb4jzZQzpgxSZN38I; Domain=.liberapay.com; expires=Sun, 17 Jun 2018 00:42:27 GMT; Path=/; SameSite=lax; secure\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nX-Content-Type-Options: nosniff\nExpect-CT: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\nServer: cloudflare\nCF-RAY: 4287cc50ea852744-FRA\n\n## Impact\n\nCross site scripting (also referred to as XSS) is a vulnerability that allows an attacker to send malicious code (usually in the form of Javascript) to another user. Because a browser cannot know if the script should be trusted or not, it will execute the script in the user context allowing the attacker to access any cookies or session tokens retained by the browser.","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["praskhar_pk","said778"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2862893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! We have received your report and a security analyst will respond shortly.","automated_response":true,"created_at":"2018-06-10T03:19:55.951Z","updated_at":"2018-06-10T03:19:55.951Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2862967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"your welcome ... take your time ","automated_response":false,"created_at":"2018-06-10T04:54:41.217Z","updated_at":"2018-06-10T04:54:41.217Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2862981,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @said778,\n\nThere are a few things I noticed that I'd like to point out. Your XSS payload doesn't actually demonstrate anything even if we were vulnerable, this endpoint is protected with CSRF tokens and the `Content-Type` (`application/json`) is correctly set. Not to mention that we are indeed using the `X-Content-Type-Options: nosniff` header as seen in your report.\n\nWe appreciate your time and effort,\nKarel.","automated_response":false,"created_at":"2018-06-10T05:42:45.454Z","updated_at":"2018-06-10T05:42:45.454Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2862984,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-06-10T05:43:07.820Z","updated_at":"2018-06-10T05:43:07.820Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":165730,"new_severity_id":165752},"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2862985,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-10T05:43:15.804Z","updated_at":"2018-06-10T05:43:15.804Z","first_to_agree":true,"actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2863047,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi \nthis is not exactly the (XSS) \nbut this issue is classified actually under the xss .\nthis issue is content-sniffing and it is there . \nand when you try that you will see how we can send any email and that is enable us to sniffing . \nso the browser must not accept that and  An attacker can trick older browsers into guessing the wrong Content-Type .\n\nplease look at that again and check ,\nthank you for your time .","automated_response":false,"created_at":"2018-06-10T06:51:06.791Z","updated_at":"2018-06-10T06:51:06.791Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2863093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @said778,\n\n\u003e Content sniffing, also known as media type sniffing or MIME sniffing, is the practice of inspecting the content of a byte stream to attempt to deduce the file format of the data within it. Content sniffing is generally used to compensate for a lack of accurate metadata that would otherwise be required to enable the file to be interpreted correctly.\n\nSource: [wikipedia](https://en.wikipedia.org/wiki/Content_sniffing)\n\nYou can see here that Content sniffing only occurs when there's no content-type given in the response, the response does actually return the correct content-type which is `application/json`. We also have the `X-Content-Type-Options` set to `nosniff` which means that this feature gets disabled.\n\nWe would appreciate it if you could disclose the report.\n\nThanks,\nKarel. ","automated_response":false,"created_at":"2018-06-10T07:28:27.070Z","updated_at":"2018-06-10T07:30:22.310Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2863198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"okay ... thanks","automated_response":false,"created_at":"2018-06-10T09:05:52.935Z","updated_at":"2018-06-10T09:05:52.935Z","actor":{"username":"said778","cleared":false,"url":"/said778","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/228/937/a8e1dd26ddbcfa841960fc884627337783a430bf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2863208,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2018-06-10T09:25:13.222Z","updated_at":"2018-06-10T09:25:13.222Z","actor":{"username":"karel_origin","cleared":false,"url":"/karel_origin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/077/693/a209ab3606bc8a68fc577dc38b001c8f66b3d561_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}