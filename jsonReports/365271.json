{"id":365271,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjUyNzE=","url":"https://hackerone.com/reports/365271","title":"Remote code execution on Basecamp.com","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-06-13T07:27:51.328Z","submitted_at":"2018-06-13T07:27:51.328Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gammarex","url":"/gammarex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":67,"url":"https://hackerone.com/basecamp","handle":"basecamp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Basecamp","twitter_handle":"basecamp","website":"https://basecamp.com/about/policies/security/response","about":"Basecamp is the leading online project manager and the birthplace of Ruby on Rails. Creators of the HEY email service."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-8291"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-26T18:22:15.199Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-27T18:22:09.455Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A critical flaw in Basecamp's profile image upload function leads to remote command execution. Images are converted on the server side, but not only image files but also PostScript/EPS files are accepted (if renamed to .gif). This is probably due to ImageMagick / GraphicsMagick being used for image conversion, which calls a PostScript interpreter (Ghostscript) if the input file starts with '%!'. The used Ghostscript version however has a security bug (CVE-2017-8291) leading to remote command execution.\n\n/Proof of concept/: Upload the attached rce.gif file as profile image (change the `ping -c1 attacker.com' to some other shell command).\n\n/Mitigation/: Upgrade Ghostscript; also, before processing uploaded images make sure they are real image files (e.g. based on magic header)\n\n## Impact\n\nGain a remote shell; from here start exploitation/privilege escalation","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":308414,"file_name":"rce.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/308/414/db10af4eb698996eda0c5ff9e0e16dc9d418caf2/rce.gif?response-content-disposition=attachment%3B%20filename%3D%22rce.gif%22%3B%20filename%2A%3DUTF-8%27%27rce.gif\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145131Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=802c6136162b64a1abe82ad735ec60723438ccfe6bdf50fae369dd8a6ea20810","file_size":1833,"type":"application/postscript"}],"allow_singular_disclosure_at":"2020-11-26T18:22:09.648Z","allow_singular_disclosure_after":-27548962.040501185,"singular_disclosure_allowed":true,"vote_count":393,"voters":["sgt_","pizzapower","pretorian","r4d1kal","wi11","axelomega","kevsecurity","abudman","svalkanov","moloshy","and 383 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":4654,"asset_type":"URL","asset_identifier":"basecamp.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2879124,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks, Jens! We greatly appreciate you identifying this vulnerability and disclosing it responsibly. We’re awarding you $2,000—one of our largest bounties to date—because this is among the most serious vulnerabilities possible.","automated_response":false,"created_at":"2018-06-13T12:23:45.200Z","updated_at":"2018-06-13T12:23:45.200Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"gammarex","url":"/gammarex"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879126,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We resolved this by disallowing the libgs-based PS and PDF coders in our ImageMagick security policy.","automated_response":false,"created_at":"2018-06-13T12:25:07.706Z","updated_at":"2018-06-13T12:25:07.706Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"gammarex","url":"/gammarex"},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for the bounty, appreciate it!","automated_response":false,"created_at":"2018-06-13T12:46:28.071Z","updated_at":"2018-06-13T12:46:28.071Z","actor":{"username":"gammarex","cleared":true,"url":"/gammarex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879530,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"After some discussion amongst our security and operations teams, we’re adding $3,000 to your bounty to better acknowledge the severity of this vulnerability. Thanks again!","automated_response":false,"created_at":"2018-06-13T14:40:32.495Z","updated_at":"2018-06-13T14:50:00.767Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"gammarex","url":"/gammarex"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2880257,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow, thanks again -- really appreciate it!","automated_response":false,"created_at":"2018-06-13T18:11:52.851Z","updated_at":"2018-06-13T18:11:52.851Z","actor":{"username":"gammarex","cleared":true,"url":"/gammarex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/129/895/2e844ecd04f705e02f2135bcfeac7c46a6f837c7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9651403,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-27T18:22:09.539Z","updated_at":"2020-10-27T18:22:09.539Z","first_to_agree":true,"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9937170,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-26T18:22:15.226Z","updated_at":"2020-11-26T18:22:15.226Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}