{"id":369218,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjkyMTg=","url":"https://hackerone.com/reports/369218","title":"Navigation to restricted origins via \"Open in new tab\"","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-20T16:39:40.656Z","submitted_at":"2018-06-20T16:39:40.656Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-09T23:16:23.617Z","bug_reporter_agreed_on_going_public_at":"2018-09-25T00:25:50.196Z","team_member_agreed_on_going_public_at":"2018-10-09T23:16:23.501Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nIt's possible to open links pointing to `file:///` origin from web pages using \"Open link in a new tab\" in context menu.\n\n\u003e https://hackerone.com/bugs?report_id=369185 shows unsafe `ssh://` protocol handling, which leads to information leak using ssh(OS username and etc.). The vulnerability is highly available, so it's possible to leverage it.\n\nAs of, we could get username, it's easy to predict path of the downloaded file:\n`file:///Users/${USERNAME_FROM_SSH}/Download/${DOWNLOADED_FILE_NAME}`\n\n### USERNAME_FROM_SSH \n\nWhen user initiates ssh session through browser, it's equal to running `ssh os_username@hostname.com`. So the host which receives connection request knows user's OS username.\n\n### DOWNLOADED_FILE_NAME \n\nDOWNLOADED_FILE_NAME is `download` attribute of the link. That means, it's under the attacker's control.\n\n## Products affected: \n\nBrave 0.22.810\nV8 6.7.288.43\nrev 8f30eeb\nMuon 7.0.6\nOS Release 17.6.0\nUpdate Channel Release\nOS Architecture x64\nOS Platform macOS\nNode.js 7.9.0\nBrave Sync v1.4.2\nlibchromiumcontent 67.0.3396.71\nOS: macOS 10.13.5 17F77 x86_64\n\n## Steps To Reproduce:\n\nLive PoC: https://brave-download-execute-local-fs-ifhsmtsbik.now.sh\n\n\u003e I could provide a PoC with \"ssh step\", if it could increase a bounty. Currently, OS username is hardcoded in `exploit.html`. Insert your **OS username** to run the exploit. (e.g. using devtools or locally)\n\n1. Webpage requests navigation to `ssh://` -  user agrees.\n2. Navigation happens, attacker's host received ssh connection request. Attacker knows user's OS username.\n3. Webpage asks to download the file. Let's name it `file-load.html`. Downloading happens.\n4. User opens a link(using \"Open in a new tab\") which points to `file:///Users/${USERNAME_FROM_SSH}/Download/file-load.html`\n5. Navigation happens, downloaded HTML file executes on local file system.\n\nScreencast attached.\n\n## Impact\n\nNavigation from web pages to `file:///` and executing downloaded (from the web) files on local filesystem is definitely a vulnerability, which additionally opens a wider attack surface for an attacker. \n\n\u003e ~~Bypassing SOP on `file:///` origin could lead to a full-chain exploit ðŸ˜ˆ.~~","bounty_amount":"50.0","formatted_bounty":"$50","original_report_id":null,"original_report_url":null,"attachments":[{"id":310810,"file_name":"file-load.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/310/810/651b089bcf0eb8d28066d3eeb3330d28b95caa53/file-load.html?response-content-disposition=attachment%3B%20filename%3D%22file-load.html%22%3B%20filename%2A%3DUTF-8%27%27file-load.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145157Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=97d1b761d51f1f811f5588ebe0fc96261a4d21e857d6baf90cc7720afa9bebad","file_size":99,"type":"text/html"},{"id":310811,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/310/811/e8fe5a5e2736bbe72555d0e02082c1d232771399/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145157Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a69ba8efae9bee73ff3485b3b6a7ed6b1b57cd179352c64859ee42543fdd6288","file_size":360,"type":"text/html"},{"id":310812,"file_name":"Kapture_2018-06-20_at_19.31.36.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/310/812/53d0389bf5b02a66827c5ce2fa295e23bf5e45c7/Kapture_2018-06-20_at_19.31.36.mp4?response-content-disposition=attachment%3B%20filename%3D%22Kapture_2018-06-20_at_19.31.36.mp4%22%3B%20filename%2A%3DUTF-8%27%27Kapture_2018-06-20_at_19.31.36.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145157Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=15f04185b3a593fa19e1aa993718620164282901458a4d943b195fb062e01e50","file_size":318217,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["sameerphad72","ali","metnew","tungpun","eveeez","khizer47","cryptographer","0x08","bd211f76755c9f854182cae","reppie"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2913201,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, `chrome-extension://` is accessible too, that means, it's possible to open internal `about:*` urls.","automated_response":false,"created_at":"2018-06-20T18:39:47.709Z","updated_at":"2018-06-20T18:39:47.709Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2921290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"fix typo: `file:///Users/${USERNAME_FROM_SSH}/Download/file-load.html` -\u003e `file:///Users/${USERNAME_FROM_SSH}/Downloads/file-load.html`","automated_response":false,"created_at":"2018-06-22T09:33:50.289Z","updated_at":"2018-06-22T09:33:50.289Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2921854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @metnew \n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n@rubikcube ","automated_response":false,"created_at":"2018-06-22T11:57:14.261Z","updated_at":"2018-06-22T11:57:14.261Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2922952,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@metnew\n\nWe were able to technically validate your issue and will now escalate it to the internal team for evaluation on whether this is something they want to take a deeper look into.\n\nWe will get back to you as soon as we have any news.\n\nBest Regards, ","automated_response":false,"created_at":"2018-06-22T16:28:06.085Z","updated_at":"2018-06-22T16:28:06.085Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2923008,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Tracked here: https://github.com/brave/browser-laptop/issues/14522","automated_response":false,"created_at":"2018-06-22T16:52:19.424Z","updated_at":"2018-06-22T16:52:19.424Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2923077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Also, I'd like to report more vulnerabilities, but I'm out of trial reports and I'm worrying that fix for this issue could resolve other unreported vulnerabilities. Is there any way I could submit my research on Hackerone?\n@glassofbeer @pranjal_jumde ","automated_response":false,"created_at":"2018-06-22T17:22:17.049Z","updated_at":"2018-06-22T17:22:17.049Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @pranjal_jumde @glassofbeer @rubikcube \nI've just found #375329 - \"Local files reading using `link[rel=import]`\" which makes this bug critical.","automated_response":false,"created_at":"2018-07-02T12:27:38.414Z","updated_at":"2018-07-02T12:31:06.628Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2994701,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-05T18:02:16.891Z","updated_at":"2018-07-05T18:02:16.891Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":171019,"new_severity_id":179204},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3000612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it possible to keep this issue opened for a while? Seems like I've got a better PoC for this case which could increase the severity again to \"High\"\n","automated_response":false,"created_at":"2018-07-06T15:17:34.402Z","updated_at":"2018-07-06T15:17:34.402Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003642,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report.","automated_response":false,"created_at":"2018-07-06T22:49:03.188Z","updated_at":"2018-07-06T22:49:03.188Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Note: this bug also allows to open internal pages - `chrome://` and `chrome-devtools://` :(","automated_response":false,"created_at":"2018-07-06T23:31:51.113Z","updated_at":"2018-07-06T23:31:51.113Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3137931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Probably, closed, since https://github.com/brave/muon/pull/635 was merged","automated_response":false,"created_at":"2018-08-03T17:21:28.208Z","updated_at":"2018-08-03T17:21:28.208Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3163196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"it appears https://github.com/brave/muon/pull/635 doesn't fix this issue. 'open in new tab' still allows file:// to be opened","automated_response":false,"created_at":"2018-08-08T20:28:05.453Z","updated_at":"2018-08-08T20:28:05.453Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3163197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I've accidentally commented on the wrong report, sorry :)","automated_response":false,"created_at":"2018-08-08T20:30:03.182Z","updated_at":"2018-08-08T20:30:03.182Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3197390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in 0.23.80 - https://github.com/brave/browser-laptop/issues/14522","automated_response":false,"created_at":"2018-08-15T06:03:23.549Z","updated_at":"2018-08-15T06:03:23.549Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227147,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-08-21T19:03:01.038Z","updated_at":"2018-08-21T19:03:01.038Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3370737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \nThis bug easily allowed to increase the severity of #390362 and #375329 to Critical:\n\n\u003e In https://bugs.chromium.org/p/project-zero/issues/detail?id=1040 lokihardt used local reflected XSS to execute script in `HelpViewer.app` context -\u003e RCE\n\n### Versions\n\nBrave patched this bug after fixing #375329 and #390362 -\u003e severity of both bugs could be increased.\n\n### Reflected XSS on local filesystem\n\nI guess, as of Brave supports macOS (and older versions) `System/Library/PrivateFrameworks/Tourist.framework/Versions/A/Resources/en.lproj/offline.html` would be considered as valid.\n\nAdditionally, we could try to find any reflected XSS in Win/Linux/other supported platforms.\n\nAlso, it's possible to find reflected XSS in Brave's `app.asar`.\n\n### Attack scenario\n\n1. User opens link using \"Open in new tab\"\n2. The link points to any default system HTML files with reflected XSS (e.g. `/System/Library/PrivateFrameworks/Tourist.framework/Versions/A/Resources/en.lproj/offline.html?redirect=javascript%253a\u003cPAYLOAD\u003e\";`\n3. `\u003cPAYLOAD\u003e` steals local files + sends to attacker's server.","automated_response":false,"created_at":"2018-09-21T20:08:04.720Z","updated_at":"2018-09-21T20:08:04.720Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3371117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And also [#395737](https://hackerone.com/reports/395737#activity-3370816) could be \"level-up\"ed to Critical.","automated_response":false,"created_at":"2018-09-21T21:29:32.573Z","updated_at":"2018-09-21T21:29:32.573Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew the chrome bug you linked to (https://bugs.chromium.org/p/project-zero/issues/detail?id=1040) was fixed in 2017, so i don't think it would have been present in Brave at the time that your report was opened. It's true that it would have been present from Brave's release in 2016 to sometime in early 2017, but we don't consider already-fixed bugs in-scope for a report.","automated_response":false,"created_at":"2018-09-25T00:12:14.834Z","updated_at":"2018-09-25T00:12:14.834Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3383025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, this bug from GPZ just inspired me to re-think submitted bugs, it was reported in late 2016.\nSuch an attack is possible. However, as of reflected XSS on `file://` is required, attacker should have some info about the victim's system (e.g. installed apps).\n@diracdeltas ","automated_response":false,"created_at":"2018-09-25T00:19:24.764Z","updated_at":"2018-09-25T00:20:16.542Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-25T00:25:50.228Z","updated_at":"2018-09-25T00:25:50.228Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3388871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \n\nI don't find a reflected XSS in default macOS installation :(\nHowever, by default macOS includes `/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html` file.\n\nThis file on local filesystem requires a Google maps script from the web. \nHowever, the most interesting thing is that it requires this script with plain `http:// `.\n\nThat's unsafe. MITM =\u003e running own scripts on `file:///` origin.\n\nYeah, so that means an attacker with a MITM access can \"level up\" any bug that requires running scripts on `file:///` origin.\n\n\u003e Tested on the latest High Sierra.","automated_response":false,"created_at":"2018-09-25T22:56:35.323Z","updated_at":"2018-09-25T22:58:27.322Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3389619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My understanding is that due to a MacOS bug (loading files over HTTP), a MITM could load an arbitrary file onto the users' filesystem. Then they could trick a user into executing this file if the user visits their website by telling them to click 'open in new tab'.\n\nI don't think the MacOS bug significantly increases the severity of this issue, since it is mac-only and still requires the attacker to do some tricks (as well as have local network access).","automated_response":false,"created_at":"2018-09-26T06:31:01.197Z","updated_at":"2018-09-26T06:31:01.197Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3391093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"### Distinguish vulnerabilities in different OSs?\n\n@diracdeltas I think that's a bad practice to distinguish vulnerabilities in different OSs and assign severity based on a number of OS where exploitation is possible.\n\nThis practice is ok when we're dealing with Web vulnerabilities (like XSS in modern vs outdated browsers) but in OS... \n\nHonestly, I think this approach is wrong (in the context of OS).\nI've never seen this in programs with native apps.","automated_response":false,"created_at":"2018-09-26T12:25:28.732Z","updated_at":"2018-09-26T12:25:28.732Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3405813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@toml, Could we disclose this?\nAlso, the title is misleading.  `Navigation to restricted origins via \"Open in new tab\"` sounds better.","automated_response":false,"created_at":"2018-09-29T11:28:22.071Z","updated_at":"2018-09-29T11:28:22.071Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, I guess we could disclose this report after changing the title, am I right? @diracdeltas @toml ","automated_response":false,"created_at":"2018-10-04T01:24:45.255Z","updated_at":"2018-10-04T01:24:45.255Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3458046,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-10-09T23:16:13.840Z","updated_at":"2018-10-09T23:16:13.840Z","additional_data":{"old_title":"Execute downloaded HTML file on local filesystem (`file:///` origin)","new_title":"Navigation to restricted origins via \"Open in new tab\""},"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3458050,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-09T23:16:23.524Z","updated_at":"2018-10-09T23:16:23.524Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3458051,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-09T23:16:23.636Z","updated_at":"2018-10-09T23:16:23.636Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}