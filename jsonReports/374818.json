{"id":374818,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzQ4MTg=","url":"https://hackerone.com/reports/374818","title":"SSRF in rompager-check","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2018-06-30T19:40:10.517Z","submitted_at":"2018-06-30T19:40:10.517Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"bb9866f3f743d6bf69b6836","url":"/bb9866f3f743d6bf69b6836","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30278,"url":"https://hackerone.com/hannob","handle":"hannob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/278/97035f061f6de55a9362b39edae4f5948bda6735_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Hanno's projects","twitter_handle":"hanno","website":"https://hboeck.de/","about":"Personal web projects from Hanno BÃ¶ck."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-09T14:54:12.318Z","bug_reporter_agreed_on_going_public_at":"2018-11-09T14:46:01.287Z","team_member_agreed_on_going_public_at":"2018-11-09T14:54:12.270Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nThe script `rompager.php` does not restrict which hosts can be requested. Thereby, an attacker can send HTTP requests to localhost and other servers of the same local network segment, on port 80 and 7547. \n\n## Description\n\nIn `rompager.php`, the value of `CURLOPT_URL` is fully controlled:\n\n```php\n\u003c?php\n// [...]\nfunction checkHost($ip, $port) {\n\t$ch = curl_init();\n\tcurl_setopt($ch, CURLOPT_URL, \"http://\".$ip);\n\tcurl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 1);\n\tcurl_setopt($ch, CURLOPT_TIMEOUT, 1);\n\tcurl_setopt($ch, CURLOPT_HEADER, TRUE);\n\tcurl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);\n\tcurl_setopt($ch, CURLOPT_PORT, $port);\n\t$data = curl_exec($ch);\n// [...]\n\t} else {\n\t\t$ip = $_GET['ip'];\n\t}\n\toutput(\"\u003ch4\u003ePort 80\u003c/h4\u003e\\n\");\n\tcheckHost($ip, 80);\n\toutput(\"\u003ch4\u003ePort 7547\u003c/h4\u003e\\n\");\n\tcheckHost($ip, 7547);\n```\n\n## Steps To Reproduce\n\n  1. Access https://rompager.hboeck.de/?ip=localhost;\n  1. Notice that *No RomPager found* is shown under *Port 80*.\n\n## Impact\n\nAn attacker could force `rompager.hboeck.de` to perform HTTP requests to localhost or servers of the same local network segment.","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["ryotak","eveeez"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":11139,"asset_type":"URL","asset_identifier":"invalid.hboeck.de","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2967308,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"There's no SSRF, as this is not an internal network. So there's no such thing here.\n\nI'm gonna close this as \"Informative\" so it has no negative impact on your H1 account, I've clarified the program description.","automated_response":false,"created_at":"2018-07-01T08:15:31.136Z","updated_at":"2018-07-01T08:15:31.136Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617270,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-09T14:46:01.314Z","updated_at":"2018-11-09T14:46:01.314Z","first_to_agree":true,"actor":{"username":"bb9866f3f743d6bf69b6836","cleared":false,"url":"/bb9866f3f743d6bf69b6836","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3617310,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-09T14:54:12.291Z","updated_at":"2018-11-09T14:54:12.291Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3617311,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-09T14:54:12.335Z","updated_at":"2018-11-09T14:54:12.335Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"hannob","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}