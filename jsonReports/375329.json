{"id":375329,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzUzMjk=","url":"https://hackerone.com/reports/375329","title":"Local files reading using `link[rel=\"import\"]`","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-02T12:25:56.922Z","submitted_at":"2018-07-02T12:25:56.922Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-29T00:16:24.191Z","bug_reporter_agreed_on_going_public_at":"2018-09-21T20:12:07.628Z","team_member_agreed_on_going_public_at":"2018-09-29T00:16:24.130Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nHTML file could import another file using `\u003clink rel=\"import\"\u003e`.  Brave returns `Access-Control-Allow-Origin: *` response header for local HTML files. That leads to local files reading.\n\n\u003e This vulnerability makes #369218 critical.\n\n## Products affected: \n\nBrave: 0.23.19 \nV8: 6.7.288.46 \nrev: 178c3fbc045a0cbdbe098db08307503cce952081 \nMuon: 7.1.3 \nOS Release: 17.6.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 67.0.3396.87\n\n## Steps To Reproduce:\n\nPoC:\n``` html\n\u003chead\u003e\n    \u003cscript\u003e\n        function show() {\n            var file = link.import.querySelector('body')\n            alert(file.innerHTML)\n        }\n    \u003c/script\u003e\n    \u003clink id=\"link\" href=\"file:///etc/passwd\" rel=\"import\" as=\"document\" onload=\"show()\" /\u003e\n\u003c/head\u003e\n```\n\n## Supporting Material/References:\n\nScreencast + PoC attached.\n\n## Impact\n\nLocal files reading is forbidden in any browser.\nAlso, note that this vulnerability makes  #369218 critical.\n\n\u003e Probably all platforms(macOS/Win/Linux) are affected.","bounty_amount":"400.0","formatted_bounty":"$400","original_report_id":null,"original_report_url":null,"attachments":[{"id":314554,"file_name":"brave-read-local-files.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/554/03cb98cfd91fd4d5264ec29231f3aa72695dfacd/brave-read-local-files.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-read-local-files.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-read-local-files.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145234Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cd039d7c51b7c1131328f37dbfa79975ec0edea32286a7dffb35552b73110ba8","file_size":311071,"type":"video/mp4"},{"id":314555,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/555/2324d6d2248486741d263f7c4dcd7ecf3fcf58e3/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145234Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3ad3fac6158b882fb17f5015ea183a3ac253f31e591a9e8c579af3b1a9ee07f1","file_size":260,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":42,"voters":["muon4","otuken","sameerphad72","ali","metnew","ahiezer","eveeez","kieran","an0nym0us","apapedulimu","and 32 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2974825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching two additional screencasts:\n\n1. #369218 + #369185 + #375329: get OS username using ssh://, download a file, open the file using \"Open in new tab\"\n2. #375259 + #375329  - (more realistic case): download the exploit like it's from a trusted resource + open (user gesture)\n","automated_response":false,"created_at":"2018-07-02T14:52:04.158Z","updated_at":"2018-07-02T14:52:04.158Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":314607,"filename":"brave-read-files-twitter-download.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/607/fb10acd46437d85f26cfc2239e7b54facbcf5087/brave-read-files-twitter-download.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-read-files-twitter-download.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-read-files-twitter-download.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145234Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8d660abb230da99471a7021489a11d51f5527b6cf378d0363cc69243f8215963"},{"id":314606,"filename":"brave-chain-contextmenu-ssh-user.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/606/6bc3c6c3b3fc5f33ff795f5aa79bce63d9e5f424/brave-chain-contextmenu-ssh-user.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-chain-contextmenu-ssh-user.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-chain-contextmenu-ssh-user.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145234Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=471384b0abc6646fa5abb0947cb1bb4d06d7a1dd469c58251c94653eaad5be1c"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It worth to note that it's possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.","automated_response":false,"created_at":"2018-07-02T15:15:18.083Z","updated_at":"2018-07-02T15:15:18.083Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It worth to note that it's possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.","automated_response":false,"created_at":"2018-07-02T15:15:21.955Z","updated_at":"2018-07-02T15:15:21.955Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Proof that it's possible to read binary files:\n`application/octet-stream` -\u003e could read\n\n\u003e Also, it's not required for an attacker to know username to find Brave.app, because it's possible to read `.DS_Store` files.","automated_response":false,"created_at":"2018-07-02T15:20:43.164Z","updated_at":"2018-07-02T15:21:57.471Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":314618,"filename":"______________2018-07-02___18.18.02.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/618/011126d1e2b43f84c778974a0e9cf3b3ac466c3f/______________2018-07-02___18.18.02.png?response-content-disposition=attachment%3B%20filename%3D%22______________2018-07-02___18.18.02.png%22%3B%20filename%2A%3DUTF-8%27%27______________2018-07-02___18.18.02.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145234Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bcb3e7db3df6e06f5a8149b5adc985ee7f0bb68459dcd12a66b20e8bcbaf1c46"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2977361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that this vulnerability is much more severe than #175979, because #175979 relies on `\u003ciframe /\u003e`. \nBrave initiates downloading if iframe points to a binary file. That means it's impossible to read binary files using this technique.\n\nHowever, in the case of `link[rel=import]`, it's possible to read files with any mimeType.\n\u003e Tested this on `.zip`,`.jar`, leveldb files.","automated_response":false,"created_at":"2018-07-03T01:34:20.736Z","updated_at":"2018-07-03T01:35:16.473Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2979271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e `deleted`","automated_response":false,"created_at":"2018-07-03T08:50:35.444Z","updated_at":"2018-07-03T08:54:11.856Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2979316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e From my understanding this happens because of `/atom/browser/net/url_request_string_job.h` in Muon ","automated_response":false,"created_at":"2018-07-03T09:12:12.884Z","updated_at":"2018-07-03T09:12:12.884Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e ~~[more correct](https://github.com/brave/muon/blob/master/atom/browser/net/asar/url_request_asar_job.cc#L243)~~","automated_response":false,"created_at":"2018-07-03T12:31:53.596Z","updated_at":"2018-07-03T12:31:53.596Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We have received your report.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**","automated_response":false,"created_at":"2018-07-03T13:24:29.672Z","updated_at":"2018-07-03T13:24:29.672Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980778,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**\n","automated_response":false,"created_at":"2018-07-03T14:05:18.637Z","updated_at":"2018-07-03T14:05:18.637Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2983106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @metnew, what version of Brave are you testing on? I tried your POC in the latest version (0.23.19) and couldn't repro it. Trying to load a file on disk fails with console error \"Not allowed to load local resource:\" as expected.","automated_response":false,"created_at":"2018-07-03T20:24:58.289Z","updated_at":"2018-07-03T20:24:58.289Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Forgot to mention - i tested this loading the POC HTML from a localhost server instead of from the `file:///` origin to simulate loading a remote site. Does the POC only work when loaded from file:///?","automated_response":false,"created_at":"2018-07-03T20:26:38.471Z","updated_at":"2018-07-03T20:26:38.471Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983165,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-03T20:35:02.440Z","updated_at":"2018-07-03T20:35:02.440Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":176975,"new_severity_id":177987},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry i see you included in the original issue what version of Brave you tested on. since this only seems to affect local files, i downgraded the severity to high.","automated_response":false,"created_at":"2018-07-03T21:07:53.567Z","updated_at":"2018-07-03T21:07:53.567Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2984449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"H @diracdeltas, thanks for the quick response.\nYeah, this only affects files on local disk. \nWorks on all platforms.\n","automated_response":false,"created_at":"2018-07-04T02:01:42.587Z","updated_at":"2018-07-04T02:01:42.587Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003641,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report. We are tracking this issue in https://github.com/brave/browser-laptop/issues/14642.","automated_response":false,"created_at":"2018-07-06T22:47:47.420Z","updated_at":"2018-07-06T22:47:47.420Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3012015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I **disagree with the bounty**. I think it should be higher. \n\nTop arguments:\n\n### Impact != reward\nImpact of the vulnerability couldn't be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn't be compared with fingerprinting or other misc attacks.  \n\n### Chained vulnerabilities\nAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of #369086/ #343721/ #375259 (which were marked as duplicate, but that's another story). \n\nI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\n\n## Report + explanation\nI pointed to the vulnerability in the code + explained the root cause (on Github).\n\n---------------------------\n\nI think these arguments are enough for the @brave team to reconsider the bounty.","automated_response":false,"created_at":"2018-07-08T00:33:09.661Z","updated_at":"2018-07-08T00:33:09.661Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3021082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@toml","automated_response":false,"created_at":"2018-07-09T22:29:04.820Z","updated_at":"2018-07-09T22:29:04.820Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3027280,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"I disagree with the bounty. I think it should be higher.\n\nTop arguments:\n\n### Impact != reward\nImpact of the vulnerability couldn't be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn't be compared with fingerprinting or other misc attacks.\n\n### Chained vulnerabilities\nAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of #369086/ #343721/ #375259 (which were marked as duplicate, but that's another story).\n\nI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\n\n### Report + explanation\nI pointed to the vulnerability in the code (the link in comments) + explained it on Github.\n\n","automated_response":false,"created_at":"2018-07-11T00:01:32.935Z","updated_at":"2018-07-11T00:01:32.935Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3032270,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-07-11T20:58:10.301Z","updated_at":"2018-07-11T20:58:10.301Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3058899,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"closing since https://github.com/brave/muon/pull/628 was merged","automated_response":false,"created_at":"2018-07-17T20:33:33.126Z","updated_at":"2018-07-17T20:33:33.126Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3059487,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-17T22:13:59.851Z","updated_at":"2018-07-17T22:13:59.851Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3138237,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I agree with a bounty and resolution","automated_response":false,"created_at":"2018-08-03T18:51:18.423Z","updated_at":"2018-08-03T18:51:18.423Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas @brave\nIt'd better cancel disclosure because of #390362  and #390013","automated_response":false,"created_at":"2018-08-03T23:21:03.165Z","updated_at":"2018-08-03T23:21:03.165Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139466,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2018-08-04T02:56:03.662Z","updated_at":"2018-08-04T02:56:03.662Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139467,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-08-04T02:56:15.465Z","updated_at":"2018-08-04T02:56:15.465Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Unpatched at that time #369218 (opening `file:///` URLs from the web using \"open in new tab\") allowed to significantly increase severity of this bug.","automated_response":false,"created_at":"2018-09-21T20:10:55.366Z","updated_at":"2018-09-21T20:10:55.366Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370757,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-21T20:12:07.681Z","updated_at":"2018-09-21T20:12:07.681Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370803,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hah, noticed a funny thing:\nIn the original report, I wrote: _\"This vulnerability makes #369218 critical.\"_\n\nAnd that's actually become true)","automated_response":false,"created_at":"2018-09-21T20:26:11.139Z","updated_at":"2018-09-21T20:26:11.139Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3402965,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Considering MITM attacks, the attack scenario becomes:\n\n1. MITM attacker waits for user's computer to download a file over HTTP\n2. They inject the attack file\n3. They wait for the user to open the file\n4. They read other local files\n\nI would still call this 'high' instead of critical because it requires some user interaction (download a file over HTTP and then also open the file). But agree with awarding more.","automated_response":false,"created_at":"2018-09-28T18:28:09.740Z","updated_at":"2018-09-28T18:28:09.740Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3402969,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-09-28T18:28:48.205Z","updated_at":"2018-09-28T18:28:48.205Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3404611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @diracdeltas, but I want to highlight the next topics:\n\n### Attack Scenario via #369218\n\n\u003e Attack scenario via downloading is quite interesting but requires specific conditions.\n\nDon't know why you don't consider the attack scenario which leverages #369218.\nThat's a really awesome opportunity for attacker.\n\n1. Victim opens `file:///\u003cRESOURCE_WITH_HTTP_SCRIPT\u003e` (that macOS default system HTML file)\n2. MITM script requested by `file:///\u003cRESOURCE_WITH_HTTP_SCRIPT\u003e`\n3. Read any file on disk :(\n\nI guess that's a valid bug chaining.\n\n\u003e There is no additional downloading in the chain or similar (like I wrongly proposed before).\n\u003e Additional scenario modifications are possible, but that's out of scope.\n\n1. HTTPSE may protect in some cases. I don't know whether it's active by default.\n2. As you said, HTTPSE doesn't always upgrade the connection.\n\n### Distinguishing vulns in different OS\n\nI've already written [about it here](https://hackerone.com/reports/369218#activity-3391093).\n\nI understand that `http://` script in default system files isn't connected to Brave. However, that doesn't change anything. \n\nIn my opinion, that's a problem of Brave that certain OS tricks allow escalating Brave bugs into more severe scenarios :(\n\nAlso, that's macOS, not some rarely used Linux distro with 1% of Brave's users.\n\n\u003e still `http://` on Mojave\n\n### Inconsistent rewards \n\nThat's really awesome that Brave decided to reconsider rewards to benefit researchers.\nBut I think the rewards are pretty inconsistent.  From my point of view, this bug is more severe than it was estimated comparing to other updated bugs.\n\n*Also, could we disclose this report and #390362 since this bug is fixed now?*","automated_response":false,"created_at":"2018-09-28T23:24:12.375Z","updated_at":"2018-09-28T23:24:12.375Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404761,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We do our best to award consistent bounties and that's why we have a bounty schedule on our program page. But we're humans making judgment calls about every report that comes in. And if we provide an unusually-high award for one particular report, that doesn't mean that we're changing our practices and awarding higher awards for every similar report. If we make a mistake and give a particular report an overly-generous award, we're not going to try to take back that money. We'll just keep trying to make consistent award in future. That means you might see some unusually-high awards in our history, because when we accidentally don't award enough, we try to make it right by increasing the bounty. But when we award too much we just move on.\n\nWhen talking about whether an award is fair for *this* report, the only relevant question is where it sits in our bounty schedule — not the awards we've made in the past. For this report, it's clear. This is definitely a real problem that puts Brave users at risk. But we're not going to ship a hotfix for it — a fix will go out in a scheduled release. Our schedule says that the limit for something which goes out in a regularly-scheduled release is $250. The award for this is now $400 which makes this award unusually-generous. ","automated_response":false,"created_at":"2018-09-29T00:16:01.531Z","updated_at":"2018-09-29T00:16:01.531Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404763,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-29T00:16:24.150Z","updated_at":"2018-09-29T00:16:24.150Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404764,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-29T00:16:24.209Z","updated_at":"2018-09-29T00:16:24.209Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, I see, thanks for the explanation, @toml!\n\nI thought the severity might be underestimated because the Brave team considered only MITM +downloading case (comment above), so I decided to add some notes to avoid any kind of miscommunication.","automated_response":false,"created_at":"2018-09-29T00:22:33.986Z","updated_at":"2018-09-29T00:22:33.986Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}