{"id":382612,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODI2MTI=","url":"https://hackerone.com/reports/382612","title":"Potential SSRF and disclosure of sensitive site on *shopifycloud.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-07-17T14:01:13.005Z","submitted_at":"2018-07-17T14:01:13.005Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rijalrojan","url":"/rijalrojan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-19T20:47:58.912Z","bug_reporter_agreed_on_going_public_at":"2018-07-19T20:47:58.767Z","team_member_agreed_on_going_public_at":"2018-07-19T20:20:16.548Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"*Note: I am reporting this after talking with @shopify-peteryaworski*\n\n**Summary**\nThere is a staging/testing site for payment cancellations and refunds at shopifycloud.com. This site allows sending post request and fetching the response back to the user. This leads to SSRF because it allows fetching potential internal clients and servers. \n\n**Description**\nhttps://offsite-gateway-sim.shopifycloud.com/notification allows sending test request to a user supplied `x_url_callback` url. In such request it is allowed to submit Google metadata IPs and get a response back. Thankfully it seems that after the last SSRF report on Shopify, you guys have completely stripped the server from having any access to Google Metadata because for `v1beta1` this server responds with `This metadata api is not allowed in the metadata proxy`. Additionally for the regular `v1` it returns 403 because the header is missing. The only potential exploit here is that if there is any internal site only Google IP is able to access then someone can call that site and see its details. \n\n**Reproduction**\n1. Go to https://offsite-gateway-sim.shopifycloud.com/notification and put http://metadata/computeMetadata/v1beta1/ as a test request.\n\n## Impact\n\nSSRF. The repo for this is private so I am assuming this has to be private too?","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["drsniper","emitrani","eveeez","apapedulimu","cryptographer","asad_anwar","makpoer"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":10202,"asset_type":"URL","asset_identifier":"*.shopify.com","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3058219,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report! Our engineering team is investigating the issue. \n\nAs you noticed, the protections we applied after the last SSRF report reduced the exploitability of this issue significantly. Since this asset is out of scope and because of the low severity of this issue this report won't be eligible for a bounty.","automated_response":false,"created_at":"2018-07-17T17:27:01.575Z","updated_at":"2018-07-17T17:27:01.575Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3058239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good to me. Thank you for accepting the report :) ","automated_response":false,"created_at":"2018-07-17T17:33:04.340Z","updated_at":"2018-07-17T17:33:04.340Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069245,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2018-07-19T15:35:39.379Z","updated_at":"2018-07-19T15:35:39.379Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070211,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report! \n\nWe have recently deployed a fix for this issue. As I mentioned in my previous comment, unfortunately this report is not eligible for a bounty.\n\nWe look forward to future reports from you!","automated_response":false,"created_at":"2018-07-19T20:15:43.880Z","updated_at":"2018-07-19T20:15:43.880Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rijalrojan","url":"/rijalrojan"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070241,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-19T20:20:16.659Z","updated_at":"2018-07-19T20:20:16.659Z","first_to_agree":true,"actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070359,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I am fine with. Thanks! ","automated_response":false,"created_at":"2018-07-19T20:47:58.806Z","updated_at":"2018-07-19T20:47:58.806Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070360,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-19T20:47:58.950Z","updated_at":"2018-07-19T20:47:58.950Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3070373,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-19T20:50:04.350Z","updated_at":"2018-07-19T20:50:04.350Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":183979,"new_severity_id":185723},"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}