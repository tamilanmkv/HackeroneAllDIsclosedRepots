{"id":383564,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODM1NjQ=","url":"https://hackerone.com/reports/383564","title":"Subdomain takeover on svcgatewaydevus.starbucks.com and svcgatewayloadus.starbucks.com","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-07-19T03:32:35.559Z","submitted_at":"2018-07-19T03:32:35.559Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"blurbdust","url":"/blurbdust","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-23T17:45:05.475Z","bug_reporter_agreed_on_going_public_at":"2018-07-20T22:44:18.838Z","team_member_agreed_on_going_public_at":"2018-07-23T17:45:05.318Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThis is fairly close to [this report](https://hackerone.com/reports/325336) however these are different subdomains than the one in the report.\n\nThis can be pretty serious since I can server virtually anything I want. In the 45 minutes I've held the domain I have served to 341 unique IP addresses. \n\nTwo starbucks.com subdomains are pointed to Azure with an unclaimed CNAME record. Anyone would be able to serve content on these subdomains.\n\n##svcgatewayloadus.starbucks.com\n```\n;; Server: 1.1.1.1:53\n;; Size: 191\n;; Unix time: 1531965036\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NXDOMAIN, id: 3697\n;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 0\n\n;; QUESTION SECTION:\nsvcgatewayloadus.starbucks.com. IN A\n\n;; ANSWER SECTION:\nsvcgatewayloadus.starbucks.com. 600 IN CNAME s00197tmp0crdfulload0.trafficmanager.net.\n\n;; AUTHORITY SECTION:\ntrafficmanager.net. 30 IN SOA tm1.msft.net. hostmaster.trafficmanager.net. 2003080800 900 300 2419200 30\n\n```\n\n##svcgatewaydevus.starbucks.com\n```\n;; Server: 9.9.9.9:53\n;; Size: 156\n;; Unix time: 1531965036\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NXDOMAIN, id: 47788\n;; flags: qr rd ra ; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 0\n\n;; QUESTION SECTION:\nsvcgatewaydevus.starbucks.com. IN A                                                                                                                                                            \n\n;; ANSWER SECTION:\nsvcgatewaydevus.starbucks.com. 600 IN CNAME s00197tmp0crdfuldev0.trafficmanager.net.                                                                                                           \n\n;; AUTHORITY SECTION:\ntrafficmanager.net. 30 IN SOA tm1.msft.net. hostmaster.trafficmanager.net. 2003080800 900 300 2419200 30\n```\n\n#PoC:\nhttp://svcgatewayloadus.starbucks.com/\nhttp://svcgatewaydevus.starbucks.com/\n\n##Mitigation:\nRemove the CNAME record from the starbucks.com DNS zone\nClaim it in Azure once I release it\n\n## Impact\n\nSubdomain takeover can be used for several purposes:\n\n* Malware\n* Phishing / Spear phishing\n* XSS\n* Authentication bypass","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-19T22:44:19.018Z","allow_singular_disclosure_after":-99245350.38663216,"singular_disclosure_allowed":true,"vote_count":33,"voters":["muon4","bogdantcaciuc","spam404","mik317","flashdisk","ali","architect","metawolf","aryan2808","nipe","and 23 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3065062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Whoops, I forgot the access log has a timestamp. 1603 requests but only 29 unique IPs.","automated_response":false,"created_at":"2018-07-19T04:35:37.755Z","updated_at":"2018-07-19T04:35:37.755Z","actor":{"username":"blurbdust","cleared":false,"url":"/blurbdust","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-07-19T16:26:14.346Z","updated_at":"2018-07-19T16:26:14.346Z","actor":{"username":"chemex","cleared":false,"url":"/chemex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/303/681/3c605ea745e1e7684d10449216f8d65ff893f288_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069630,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @blurbdust , Thank you for your finding! We are working with our internal team to have the CNAME records removed. Once the removal is confirmed here, please release the resources in Azure. Once again, Thanks for your finding!\n\n@ristretto","automated_response":false,"created_at":"2018-07-19T17:40:48.255Z","updated_at":"2018-07-19T17:40:48.255Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069632,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-19T17:41:46.603Z","updated_at":"2018-07-19T17:41:46.603Z","additional_data":{"old_severity":"High","new_severity":"Critical","old_severity_id":184971,"new_severity_id":185649},"actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069637,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-07-19T17:42:31.081Z","updated_at":"2018-07-19T17:42:31.081Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"4000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"blurbdust","url":"/blurbdust"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3069782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow, thank you so much for the huge bounty! I'll keep an eye on this page and release it whenever instructed. ","automated_response":false,"created_at":"2018-07-19T18:23:17.242Z","updated_at":"2018-07-19T18:23:17.242Z","actor":{"username":"blurbdust","cleared":false,"url":"/blurbdust","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3076105,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @blurbdust, Please release the claimed resources, since the issue has been verified to be fixed. Once again, Thank you for your finding. We hope to work continuously with you.\n\n@ristretto","automated_response":false,"created_at":"2018-07-20T21:32:09.575Z","updated_at":"2018-07-20T21:32:09.575Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"blurbdust","url":"/blurbdust"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3076206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Released! Do you need anything else from me? Also would it be possible to disclose this publicly? ","automated_response":false,"created_at":"2018-07-20T22:07:50.248Z","updated_at":"2018-07-20T22:07:50.248Z","actor":{"username":"blurbdust","cleared":false,"url":"/blurbdust","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3076272,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-20T22:44:18.882Z","updated_at":"2018-07-20T22:44:18.882Z","first_to_agree":true,"actor":{"username":"blurbdust","cleared":false,"url":"/blurbdust","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3085456,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-23T17:45:05.354Z","updated_at":"2018-07-23T17:45:05.354Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3085457,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-23T17:45:05.516Z","updated_at":"2018-07-23T17:45:05.516Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}