{"id":384289,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODQyODk=","url":"https://hackerone.com/reports/384289","title":"Redirect on authorization allows account compromise","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-07-19T19:20:29.501Z","submitted_at":"2018-07-19T19:20:29.501Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej_dds","url":"/cablej_dds","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":50592,"url":"https://hackerone.com/gsa_bbp","handle":"gsa_bbp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GSA Bounty","twitter_handle":null,"website":"http://gsa.gov","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-06T20:53:24.944Z","bug_reporter_agreed_on_going_public_at":"2018-11-06T20:53:24.865Z","team_member_agreed_on_going_public_at":"2018-11-06T03:08:26.294Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["sameerphad72","spam404","ali","michan","khizer47","salmon","cryptographer","0x08","smither","mblegedes","and 2 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":81494,"asset_type":"URL","asset_identifier":"*.login.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3070387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-07-19T20:54:02.492Z","updated_at":"2018-07-19T20:54:02.492Z","actor":{"username":"brodygov","cleared":false,"url":"/brodygov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3071141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-07-19T23:58:39.024Z","updated_at":"2018-07-19T23:58:39.024Z","actor":{"username":"brodygov","cleared":false,"url":"/brodygov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3074056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-07-20T13:40:22.845Z","updated_at":"2018-07-20T13:40:22.845Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3083235,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-07-23T08:31:30.535Z","updated_at":"2018-07-23T08:31:30.535Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3153239,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2018-08-07T01:01:32.607Z","updated_at":"2018-08-07T01:01:32.607Z","actor":{"url":"/gsa_bbp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GSA Bounty"}},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3199129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-08-15T13:30:44.403Z","updated_at":"2018-08-15T13:30:44.403Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3417778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-10-02T05:36:46.389Z","updated_at":"2018-10-02T05:36:46.389Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3422029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-10-02T17:29:02.682Z","updated_at":"2018-10-02T17:29:02.682Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3457913,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-10-09T22:33:14.772Z","updated_at":"2018-10-09T22:33:14.772Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572366,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-11-01T21:13:04.818Z","updated_at":"2018-11-01T21:13:04.818Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cablej_dds","url":"/cablej_dds"},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3589838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-11-05T21:16:59.560Z","updated_at":"2018-11-05T21:16:59.560Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3591191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-06T03:08:26.321Z","updated_at":"2018-11-06T03:08:26.321Z","first_to_agree":true,"actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3595943,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-06T20:53:24.890Z","updated_at":"2018-11-06T20:53:24.890Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3595944,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-06T20:53:25.028Z","updated_at":"2018-11-06T20:53:25.028Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11533,"category":"team","content":"Login.gov had a bug in validating the redirect_uri in the `/openid_connect/authorize` endpoint, which allowed specially crafted subdomains to be incorrectly validated when they began with a valid hostname. For example, a `redirect_uri` with a hostname of `agency.gov.example.com` would validate a URL as if it were presented as `agency.gov`.\n\nThis enabled an attacker to compromise user sessions on sites that integrated with login.gov. No user interaction was required other than the user being redirected to a URL.\n\nLogin.gov immediately patched this bug by making validation of the `redirect_uri` significantly stricter by enforcing an exact match of the hostname. Shortly after, Login.gov worked with agency partners to identify every full URL that agency service providers (SPs) would need to register, and then implemented exact matching for the entire `redirect_uri` (including the URL path).\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":176399,"username":"ericmillgsa","name":"Eric Mill","bio":"Deputy director of Login.gov at 18F and GSA.","cleared":false,"website":"https://18f.gsa.gov","location":"Washington, DC","created_at":"2017-06-16T21:04:29.989Z","url":"https://hackerone.com/ericmillgsa","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":null,"profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBZzVtIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--eb81f1ab2bb893c52fd8aba96fc2bf2eb2106b0b/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/4592.png"}}},{"id":11550,"category":"researcher","content":"An error in parsing redirect urls during the authorization flow allowed an attacker to compromise a user's Login.gov token by redirecting users to a malicious site. Props to the TTS team for quickly issuing a patch after the report!\n\nIneligible for bounty due to government employment.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":297403,"username":"cablej_dds","name":"Jack Cable","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-06-25T16:40:34.992Z","url":"https://hackerone.com/cablej_dds","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBbENhIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ab6df36228bb22a3568902cf577231ad9a8d28be/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/ff228321fc2c30d2215b6e156e53c2c26b80ae1c_xtralarge.jpg"}}}]}