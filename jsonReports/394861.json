{"id":394861,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTQ4NjE=","url":"https://hackerone.com/reports/394861","title":"Incorrect Permission Assignment for Critical Resource","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-14T10:20:51.773Z","submitted_at":"2018-08-14T10:20:51.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dhiraj-mishra","url":"/dhiraj-mishra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8724,"url":"https://hackerone.com/mariadb","handle":"mariadb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"MariaDB","twitter_handle":"mariadb_org","website":"https://mariadb.org","about":"MariaDB is a high performance, open source database that helps the world's busiest websites deliver more content, faster."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-14T09:03:30.215Z","bug_reporter_agreed_on_going_public_at":"2018-11-14T09:03:30.147Z","team_member_agreed_on_going_public_at":"2018-10-22T08:31:51.244Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Team, \n\nProduct Affected: https://github.com/MariaDB/server\n\nFile:\n /server/blob/10.3/sql/mysqld.cc#L2761\n\n```\n}\n    if (!SetSecurityDescriptorDacl(\u0026sdPipeDescriptor, TRUE, NULL, FALSE))\n{\n```\n\nThis was purely identified on code review, Never create NULL ACLs.\n\nA mail was sent to security@mariadb.org and MariaDB team is working on this and a fix will be pushed in next version, attached mail headers for your reference.\n\n## Impact\n\nAn attacker can set it to Everyone (Deny All  Access), which would even forbid administrator access and may lead to privilege escalation.","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":333259,"file_name":"MailFrom-security_mariadb.org.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/259/4e1260e6f461c1f9f4b7282c09c1ed11e0491fd7/MailFrom-security_mariadb.org.txt?response-content-disposition=attachment%3B%20filename%3D%22MailFrom-security_mariadb.org.txt%22%3B%20filename%2A%3DUTF-8%27%27MailFrom-security_mariadb.org.txt\u0026response-content-type=message%2Frfc822\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145526Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bc46a71e84200bc8d26376bb6535383f8c677f745a9fbf686eff4e88c2ec4a56","file_size":11782,"type":"message/rfc822"},{"id":333261,"file_name":"MariaDB.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/261/4300336c079b7d9911daac12d985ee24259723bd/MariaDB.png?response-content-disposition=attachment%3B%20filename%3D%22MariaDB.png%22%3B%20filename%2A%3DUTF-8%27%27MariaDB.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145526Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4c90d95d7a379631270c34fc93c0c55a53755e0ff1a44a2463859df2171ebf92","file_size":212987,"type":"image/png"},{"id":333262,"file_name":"MariaDB-2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/262/a65e957dedf73e2a770fd80ce5a38fa5f8732306/MariaDB-2.png?response-content-disposition=attachment%3B%20filename%3D%22MariaDB-2.png%22%3B%20filename%2A%3DUTF-8%27%27MariaDB-2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145526Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e3c92288b3a32651d7c70484f31913a94e363eac39afc5e9946e3edd3a842163","file_size":19622,"type":"image/png"}],"allow_singular_disclosure_at":"2018-11-21T08:31:51.312Z","allow_singular_disclosure_after":-91175015.24247143,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sameerphad72","ali","eveeez","cryptographer","yaaya"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":10335,"asset_type":"SOURCE_CODE","asset_identifier":"MariaDB Server \u0026 Connectors - Access control bypass","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3193661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue is been patched.\nFYI: https://jira.mariadb.org/browse/MDEV-16963","automated_response":false,"created_at":"2018-08-14T10:43:37.196Z","updated_at":"2018-08-14T10:53:00.128Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3193680,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-08-14T10:55:07.266Z","updated_at":"2018-08-14T10:55:07.266Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":196309},"actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3193681,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @dhiraj-mishra,\n\nThanks for your report!\n\nAs you sent this to the security list first, it has been resolved in MDEV-16963 that you linked, I'll close this here with resolved so you receive the H1 thank you points. :)\n\nThis was not a critical issue, thus we won't release patch versions outside the normal release schedule. The fix will be available in the next scheduled version release 5.5.62 and 10.0.37, respectively.\n\nCheers,\nMariaDB Security Team","automated_response":false,"created_at":"2018-08-14T10:55:57.347Z","updated_at":"2018-08-14T10:59:55.355Z","actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dhiraj-mishra","url":"/dhiraj-mishra"},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3512617,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\n\nIn accordance with our Responsible Disclosure Policy we are now publicly disclosing the details of this report and its resolution.\n\nThank you,\nMariaDB Security Team","automated_response":false,"created_at":"2018-10-22T08:31:51.266Z","updated_at":"2018-10-22T08:31:51.266Z","first_to_agree":true,"actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3641208,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-14T09:03:30.177Z","updated_at":"2018-11-14T09:03:30.177Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3641209,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-14T09:03:30.236Z","updated_at":"2018-11-14T09:03:30.236Z","actor":{"username":"dhiraj-mishra","cleared":false,"url":"/dhiraj-mishra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/455/364f57d6fe4bbc9ead49c2648dacc68f89a3089b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}