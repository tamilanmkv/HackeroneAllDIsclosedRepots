{"id":395737,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTU3Mzc=","url":"https://hackerone.com/reports/395737","title":"`chrome://brave` available for navigation in Release build [-\u003e RCE] + navigation to `chrome://*` using tab_helper [\"Open in new tab\"]","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-16T04:53:51.685Z","submitted_at":"2018-08-16T04:53:51.685Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-25T00:23:34.580Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T16:23:44.526Z","team_member_agreed_on_going_public_at":"2018-09-25T00:23:34.427Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\n### `chrome://brave` is available for navigation\n\nNavigation to `chrome://brave` + `\u003clocal_file_path\u003e` requires local file at `\u003clocal_file_path\u003e`.\n\nThe file loaded in this context has access to **private Muon APIs** such as `chrome.ipcRenderer/remote/webFrame/webViewRequest`.\n\nMuon API allows executing code on the device. (e.g. with `chrome.remote.require('child_process').exec`)\n\n\u003e In addition, Brave isn't sandboxed (on all OS).\n\nThat's clearly a vulnerability, not a feature:\n1. it's in Release channel, not in Debug builds\n2. Could lead to RCE\n\n\u003e Note: attacker knows the correct `\u003clocal_file_path\u003e` after loading the file from `file://` origin (`window.location.pathname`).\n\n### Navigation to `chrome://brave`\n\nI've already shown the way to navigate to `file://` URLs in  #369218, which was fixed in 0.23.80.\n\n\u003e  I mentioned in the report that it's possible navigating to `chrome://` URLs too in #369218. However, [the fix](https://github.com/brave/browser-laptop/pull/14973) was incomplete. It only works for `about:` and `file:`URLs.\n\n### PoC\n\n1. Shows that `\u003cwebview\u003e` works\n2. Launches `Calculator.app` on macOS\n\n## Products affected: \n \nBrave: 0.23.79 (0.23.80 and 0.23.100 too, where #369218 is patched)\nV8: 6.8.275.24 \nrev: 51b49051a779f0db94fbcfd0df5faca781299ea0 \nMuon: 8.0.7 \nOS Release: 17.7.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 68.0.3440.84\n\n## Steps To Reproduce ||  Attack Scenario:\n\n1. Download `exploit.html`\n2. Open link in the file using \"Open in new tab\"\n3. The new tab opens with private `\u003cwebview\u003e` tag + `Calculator.app` starts\n\n## Patch\n\nPreventing navigation to `chrome://brave` origin seems ok.\n\n### Additional resources\n\nScreencast attached.\n\n## Impact\n\nCrafted HTML file allows executing code on the device. \n\n\u003e Requires user gesture - \"Open in a new tab\". Set impact to \"High\", because requires downloading the file.","bounty_amount":"2000.0","formatted_bounty":"$2,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":333763,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/763/ff81e07fa288eb75c6b3297959814d7cc44a5f5b/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145533Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9c707b302b5b7f4f1aaa46d58e25dd71424eab46134333f7f380630a09d2afc4","file_size":499,"type":"text/html"},{"id":334043,"file_name":"brave-chrome-brave-new-tab.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/334/043/5d15c746ef3a4d8b6b816a47b22019293ce356fd/brave-chrome-brave-new-tab.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-chrome-brave-new-tab.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-chrome-brave-new-tab.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145533Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9d0aa530634214eb217b4deb7a98c3b95e6a4d1ca1b36cae88b01e1424d1aa67","file_size":1348996,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":46,"voters":["foobar7","inhibitor181","base_64","otuken","dawgyg","bl4de","sameerphad72","spam404","surfrdan","mik317","and 36 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":7941,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/muon","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3206525,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"triaged to https://github.com/brave/browser-laptop/issues/15045","automated_response":false,"created_at":"2018-08-16T21:33:53.117Z","updated_at":"2018-08-16T21:33:53.117Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3211350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in: https://github.com/brave/browser-laptop/pull/15047","automated_response":false,"created_at":"2018-08-17T17:20:24.771Z","updated_at":"2018-08-17T17:20:24.771Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3211359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e @diracdeltas Are you sure the fix is complete? It still seems possible navigating to \"chrome://brave\" from address bar.","automated_response":false,"created_at":"2018-08-17T17:23:05.964Z","updated_at":"2018-08-17T17:24:07.962Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3214944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew you're right, i thought we already blocked navigation to chrome:// but turns out we don't","automated_response":false,"created_at":"2018-08-19T02:39:28.822Z","updated_at":"2018-08-19T02:39:28.822Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"we're also just going to remove the chrome.remote.require API since it's from Electron but we don't use it: https://github.com/brave/muon/pull/644","automated_response":false,"created_at":"2018-08-21T19:04:32.131Z","updated_at":"2018-08-21T19:04:32.131Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think there is an RCE without `chrome.remote`. I'm going to review this case now @diracdeltas","automated_response":false,"created_at":"2018-08-21T19:14:46.616Z","updated_at":"2018-08-21T19:17:24.055Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"BTW i still plan on blocking chrome:// loads - just saying we can also remove some of these APIs","automated_response":false,"created_at":"2018-08-21T19:16:28.697Z","updated_at":"2018-08-21T19:16:28.697Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Removing `Webview` and `chrome.webFrame` in the context of `chrome://brave/*` seems impossible, however, it's possible to leverage these APIs to UXSS. So blocking navigation to `chrome://brave` is still required.","automated_response":false,"created_at":"2018-08-21T19:19:40.197Z","updated_at":"2018-08-21T19:22:33.378Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \nBlocking navigation to `chrome://` should work.\nHowever, I'm afraid of debugging capabilities: will `chrome://histograms/` being accessible in this case?","automated_response":false,"created_at":"2018-08-21T19:21:43.100Z","updated_at":"2018-08-21T19:22:54.334Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227218,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew good call! i didn't realize we supported chrome://histograms. i guess i can just block chrome://brave","automated_response":false,"created_at":"2018-08-21T19:22:59.555Z","updated_at":"2018-08-21T19:22:59.555Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Also:\nchrome://blob-internals/\nchrome://appcache-internals/\nchrome://serviceworker-internals/\nchrome://webrtc-internals/\nchrome://network-errors/\nchrome://media-internals/\nand something related to USB, AFAIR\n\nI was thinking about local files reading ( #369218 + #375329) from the web with opening a new tab pointing to \"chrome://blob-internals/\u003cblob\u003e\" or something similar. \nI didn't find a way to do this :(","automated_response":false,"created_at":"2018-08-21T19:27:56.583Z","updated_at":"2018-08-21T19:27:56.583Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas  I think `https://github.com/brave/muon/pull/644` is not a good patch against RCE since `chrome.ipcRenderer` continues being available in this case.  \n\n\u003e UXSS of course available in any case\n\nBlocked navigation to `chrome://brave/*` is required.","automated_response":false,"created_at":"2018-08-21T20:14:51.747Z","updated_at":"2018-08-21T20:14:51.747Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems possible to require `require` using \n\n```js\nipcMain.on('ELECTRON_BROWSER_GET_BUILTIN', function (event, module) {\n  try {\n    event.returnValue = valueToMeta(event.sender, electron[module])\n  } catch (error) {\n    event.returnValue = exceptionToMeta(error)\n  }\n})\n```","automated_response":false,"created_at":"2018-08-21T20:16:44.101Z","updated_at":"2018-08-21T20:16:44.101Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3236858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"2nd part of the fix: https://github.com/brave/browser-laptop/pull/15076","automated_response":false,"created_at":"2018-08-23T17:09:34.173Z","updated_at":"2018-08-23T17:09:34.173Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3237435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The vulnerability was completely fixed in 0.23.104\n","automated_response":false,"created_at":"2018-08-23T19:23:37.721Z","updated_at":"2018-08-23T19:23:37.721Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3262065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Hope, you'll consider [my comments](https://hackerone.com/bugs?subject=user\u0026report_id=395737\u0026view=open\u0026substates%5B%5D=new\u0026substates%5B%5D=needs-more-info\u0026substates%5B%5D=triaged\u0026substates%5B%5D=pre-submission\u0026reported_to_team=\u0026text_query=\u0026program_states%5B%5D=2\u0026program_states%5B%5D=3\u0026program_states%5B%5D=4\u0026program_states%5B%5D=5\u0026sort_type=latest_activity\u0026sort_direction=descending\u0026limit=25\u0026page=1#activity-3211359)/activity, when estimating bounty","automated_response":false,"created_at":"2018-08-29T02:07:28.475Z","updated_at":"2018-08-29T02:08:39.445Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3285058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @brave, any updates?","automated_response":false,"created_at":"2018-09-03T12:40:26.137Z","updated_at":"2018-09-03T12:40:26.137Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291770,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the reminder!","automated_response":false,"created_at":"2018-09-04T18:27:02.577Z","updated_at":"2018-09-04T18:27:02.577Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291771,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-09-04T18:27:16.067Z","updated_at":"2018-09-04T18:27:16.067Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks @brave!","automated_response":false,"created_at":"2018-09-04T18:27:41.955Z","updated_at":"2018-09-04T18:27:41.955Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359091,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-19T16:23:44.585Z","updated_at":"2018-09-19T16:23:44.585Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370816,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \n### RCE from the web\n\n #369218 allowed opening a system HTML files to trigger reflected XSS.\nThat vulnerability makes this problem Critical.\n\n### Attack scenario\n\n1. Open `chrome://brave/\u003clocal_file_with_reflected_XSS\u003e`\n2. Trigger RCE.\n\n### Summary\n\nSo, yeah, in some sense, that's RCE from the web.","automated_response":false,"created_at":"2018-09-21T20:31:03.544Z","updated_at":"2018-09-21T20:31:03.544Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383032,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Looking back, we underestimated this.","automated_response":false,"created_at":"2018-09-25T00:23:22.893Z","updated_at":"2018-09-25T00:23:22.893Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383033,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-25T00:23:34.456Z","updated_at":"2018-09-25T00:23:34.456Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383034,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-25T00:23:34.608Z","updated_at":"2018-09-25T00:23:34.608Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @brave!","automated_response":false,"created_at":"2018-09-25T01:03:13.327Z","updated_at":"2018-09-25T01:03:13.327Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3389639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew correctly pointed out in a comment on https://hackerone.com/reports/369218#activity-3388871 that this vuln is pretty easy to trigger if you have MITM access. for instance MacOS apparently loads a file automatically over HTTP (i haven't verified this). or the attacker could just wait for the user to initiate a download over HTTP.\n\nfurthermore, a MITM could redirect any HTTP request in Brave to an attacker site, which would then trigger this exploit. i think this means effectively RCE from MITM with almost no user interaction.\n\ngiven that i think we should consider increasing the bounty yet again. @toml ","automated_response":false,"created_at":"2018-09-26T06:41:13.568Z","updated_at":"2018-09-26T06:41:13.568Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3391080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003cFROM-#369218\u003e\n\nBy default macOS includes `/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html` file.\n\nThis file on the local filesystem requires a Google Maps scripts from the web over `http://`. \nThat's unsafe. MITM =\u003e running own scripts on `file://` and `chrome://brave/` origins.\n\nYeah, so that means an attacker with a MITM access can \"level up\" bugs that requires running scripts on `file:///` origin: like #390362, #375329 and #395737 (this report).\n\nTested on the latest High Sierra.\n\n\u003c/FROM-#369218\u003e\n\n### Attack Scenario (via navigation)\n\n1. User (via copypasting URL or #369218) navigates to `chrome://brave/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html` - This file is available in default macOS installation (High Sierra)\n\n2. This HTML file loads Google Maps scripts from `http://maps.googleapis.com/maps/api/js?v=3\u0026client=gme-appleinc\u0026libraries=places\u0026sensor=false`\n\n3. Attacker with MITM access could inject own JS \n\n4. RCE\n\n@diracdeltas, the attack vector via MITMing downloaded HTML files is also great, thanks for pointing.","automated_response":false,"created_at":"2018-09-26T12:19:44.091Z","updated_at":"2018-09-26T12:20:35.360Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3391244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas, HTTPS everywhere doesn't work on `file:///`, scripts blocking doesn't work on `file:///`.\nDon't know whether it's a separate issue, but this behavior allows MITMing scripts on `file:///` and `chrome://brave/`.","automated_response":false,"created_at":"2018-09-26T13:12:03.779Z","updated_at":"2018-09-26T13:12:03.779Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3397408,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \nAlso, check https://hackerone.com/reports/415258#activity-3397382\n\n\\\\--Copypasted from #415258--\\\n## MITM vs HTTPSE\n\n`chrome://brave` is always vulnerable to MITM even when HTTPSE is active\n`file://` is vulnerable to MITM, when HTTPSE is inactive\n\n\u003e As far as I know, HTTPS Everywhere isn't enabled by default.","automated_response":false,"created_at":"2018-09-27T15:29:39.951Z","updated_at":"2018-09-27T15:29:39.951Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3397955,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"bumping because of https://hackerone.com/reports/395737#activity-3389639\n\nbtw, HTTPS Everywhere is not supposed to upgrade all HTTP requests even when it is functioning (since not all servers support HTTPS).","automated_response":false,"created_at":"2018-09-27T17:26:48.431Z","updated_at":"2018-09-27T17:26:48.431Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3397986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great!\n\nI've considered the most realistic case involving navigation to `chrome://brave` origin. \nRelying on non-default files is not reasonable, so MITM should occur on `maps.googleapis.com`\nHTTPSE correctly handles `maps.googleapis.com` (probably?).\n\nBut from my observations, it doesn't matter since `chrome://brave` origin is always vulnerable to MITM despite the HTTPSE.\n\n\u003e I guess there is no logic mistake in my assumption","automated_response":false,"created_at":"2018-09-27T17:33:15.496Z","updated_at":"2018-09-27T17:34:49.527Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}