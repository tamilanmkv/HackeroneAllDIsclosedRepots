{"id":396467,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTY0Njc=","url":"https://hackerone.com/reports/396467","title":"Github Token Leaked publicly for https://github.sc-corp.net","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-08-17T09:49:01.636Z","submitted_at":"2018-08-17T09:49:01.636Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"th3g3nt3lman","url":"/th3g3nt3lman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":513,"url":"https://hackerone.com/snapchat","handle":"snapchat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Snapchat","twitter_handle":"","website":"https://www.snapchat.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-08T12:57:23.028Z","bug_reporter_agreed_on_going_public_at":"2018-09-08T12:57:18.677Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Description :\n\nGitHub is a truly awesome service but it is unwise to put any sensitive data in code that is hosted on GitHub and similar services as i was able to find github token indexed ***7 hours Ago*** by user ***██████ - Software Engineer - Snap Inc***\n\n### Issue \u0026 POC :\nYou can find the leak in this link :\nhttps://github.com/█████/leetcode/blob/0eec6434940a01e490d5eecea9baf4778836c54e/TopicMatch.py\n\n````\n\nimport os\nimport requests\nimport sys\npull_number = 76793\npull_url = \"https://github.sc-corp.net/api/v3/repos/Snapchat/android/pulls/\" + str(pull_number)\npayload = {}\npayload[\"Authorization\"] = \"token \" + \"9db9ca3440e535d90408a32a9c03d415979da910\"\nprint payload\nr = requests.get(pull_url,\n\n```\n\n## Impact\n\nI didn't try anything with the token, and dont know what access it has, and i know that in order to login to https://github.sc-corp.net you need to have an email @snap but still i though it would be a good idea to share this finding with you in case it can be used in a way that i dont know.\n\nBest Regards","bounty_amount":"15000.0","formatted_bounty":"$15,000","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-08T12:57:18.778Z","allow_singular_disclosure_after":-94960698.99508974,"singular_disclosure_allowed":true,"vote_count":560,"voters":["pajoda","test0x00","honoki","ronykroy","libcontainer","hexpwn","sat0shi","mirchr","badf00d","putsi","and 550 more..."],"severity":{"rating":"critical","score":9.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":11828,"asset_type":"URL","asset_identifier":"app.snapchat.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3211226,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @th3g3nt3lman - thank you for the report. We confirmed that the token you discovered was valid and the repository has been taken down.\n\nWe're going to assess the scope of impact and will let you know about the bounty shortly!","automated_response":false,"created_at":"2018-08-17T16:54:51.129Z","updated_at":"2018-08-17T16:54:51.129Z","actor":{"username":"cgrayson","cleared":false,"url":"/cgrayson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/996/7a179ee2d41ebe9ef8a8b41bfffd19c608672eb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3211243,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @cgrayson for quick response, i really didn't want to highlight this as high or critical as i prefer always in such findings not to escalate or try something that might impact target, so its up to you to asses the risk.\n\nVery happy to help securing snapchat","automated_response":false,"created_at":"2018-08-17T16:57:49.751Z","updated_at":"2018-08-17T16:57:49.751Z","actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3220007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Dear @cgrayson ,\nThere is something i found that is not related to your BB program but it might affect some users, i wanted to share it with you just as an information , maybe you can speak to google and take it over the net.\n\nThere is someone hosting a suspicious website having \"Snapchat inc\" in the certificate, as you can see below :\n{F335558}\n\nthe domain name is \"sn.ht\" which is hosting a suspicious javascript code exactly the same as the one used for Blind XSS attacks, when a user opens this site all his cookies, details will be stolen by the one managing this site.\n\nMaybe you wont be able to take any actions regarding this, and i don't know google policy regarding this but i just wanted to share this with you.\n\nBest Regards, ","automated_response":false,"created_at":"2018-08-20T09:35:34.009Z","updated_at":"2018-08-20T09:35:34.009Z","actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":335558,"filename":"Firefox_Screenshot_2018-08-20T09-28-30.388Z.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/335/558/38e08d2dde88d4c3d14b94431207523d2c0e7d4c/Firefox_Screenshot_2018-08-20T09-28-30.388Z.png?response-content-disposition=attachment%3B%20filename%3D%22Firefox_Screenshot_2018-08-20T09-28-30.388Z.png%22%3B%20filename%2A%3DUTF-8%27%27Firefox_Screenshot_2018-08-20T09-28-30.388Z.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145537Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1291cb1b303b505e4ada83c824db53fb4b9e9f811b0b7053a5dd96df66a5431e"}],"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3221579,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-08-20T17:11:26.620Z","updated_at":"2018-08-20T17:11:26.620Z","additional_data":{"old_severity":"Medium (6.1)","new_severity":"Critical (9.8)","old_severity_id":198040,"new_severity_id":198920},"actor":{"username":"cgrayson","cleared":false,"url":"/cgrayson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/996/7a179ee2d41ebe9ef8a8b41bfffd19c608672eb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3221782,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-08-20T18:02:49.679Z","updated_at":"2018-08-20T18:02:49.679Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Snapchat"}},"bounty_amount":"15000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"snapchat","collaborator":{"username":"th3g3nt3lman","url":"/th3g3nt3lman"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3221800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thats the best day in my life @cgrayson @snapchat ,  you don't know how much this bounty can help me :) thanks for your generosity.\n\nThank you alot guys","automated_response":false,"created_at":"2018-08-20T18:06:29.657Z","updated_at":"2018-08-20T18:06:29.657Z","actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3247974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Dear @cgrayson,\n\nI know its not my right to ask, just out of curiosity, what was the impact of the above if it reached bad hands ?\nDoesnt the google authentication somehow protect the access to this site even with the token leaked ?\n\nI was thinking for the last week in this and would appriciate your answer if this is allowed just to learn :)\n\nBest Regards,","automated_response":false,"created_at":"2018-08-26T21:59:02.184Z","updated_at":"2018-08-26T21:59:02.184Z","actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3309546,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@th3g3nt3lman  The web interface needed a valid snap account, but not the API. Thanks again for your report!","automated_response":false,"created_at":"2018-09-08T00:52:38.333Z","updated_at":"2018-09-08T00:52:38.333Z","actor":{"username":"divya","cleared":false,"url":"/divya","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"th3g3nt3lman","url":"/th3g3nt3lman"},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3310936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks guys, it was nice working with you, can we have a limited disclosure for this without exposing the code ? Just like researcher found a working token that affected one of our servers or whatever you find suitable, maybe only the title of the report.\n\nI like to share with other researchers so they can learn specially the new ones.\n\nBest Regards,\n","automated_response":false,"created_at":"2018-09-08T12:56:59.287Z","updated_at":"2018-09-08T12:56:59.287Z","actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3310937,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-08T12:57:18.741Z","updated_at":"2018-09-08T12:57:18.741Z","first_to_agree":true,"actor":{"username":"th3g3nt3lman","cleared":true,"url":"/th3g3nt3lman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/398/d1e95d529e9fbc465900d6a1aa71824d26397cc1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3447840,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-08T12:57:23.055Z","updated_at":"2018-10-08T12:57:23.055Z","actor":{"url":"/snapchat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Snapchat"}},"genius_execution_id":null,"team_handle":"snapchat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}