{"id":401483,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDE0ODM=","url":"https://hackerone.com/reports/401483","title":"[chaturbate.com] - CSRF Vulnerability on image upload","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-28T04:50:16.484Z","submitted_at":"2018-08-28T04:50:16.484Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"corb3nik","url":"/corb3nik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-19T22:40:09.218Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T22:40:09.111Z","team_member_agreed_on_going_public_at":"2018-09-19T22:32:50.809Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary##\n\nHi guys,\n\nOne of the features available to a Chaturbate user is the ability to upload images into photo sets. The upload functionality does not use any CSRF tokens, allowing attackers to perform CSRF attacks and upload images to a user's profile without the user's consent.\n\n\n## Steps To Reproduce:\n\n1. Login to Chaturbate.\n2. Browse to your profile page and upload an image.\n3. Note the `set` ID of the newly created set (this is available by visiting set in the profile page. It'll be in the URL : `https://chaturbate.com/photo_videos/photoset/detail/[username]/[set_id]/`).\n4. Download the poc.html file attached to this report.\n5. Edit `poc.html` by replacing the number `4771110` by the `set` ID found at step #3.\n6. Open poc.html and click on `Submit request`.\n7. Visit your Chaturbate image set.\n\nYou'll notice that the photo set now inludes an additional image (a blank/white image).\n\n## Impact\n\nIn order for this attack to work, an attacker would need to know the correct photo set ID. Since set IDs are public information, this isn't an issue.\n\nI've set the impact here to medium since this affects the integrity of user accounts.","bounty_amount":"300.0","formatted_bounty":"$300","original_report_id":null,"original_report_url":null,"attachments":[{"id":338757,"file_name":"csrf_poc.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/338/757/1933d181e6931d4bd3d8fd90127c8baa7e09cf2e/csrf_poc.html?response-content-disposition=attachment%3B%20filename%3D%22csrf_poc.html%22%3B%20filename%2A%3DUTF-8%27%27csrf_poc.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145618Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=db97d97bc4e5677d28f847fea8713214cffa255c57854ef8c9baf520215e80a5","file_size":13322,"type":"text/html"}],"allow_singular_disclosure_at":"2018-10-19T22:32:50.993Z","allow_singular_disclosure_after":-93975807.29927121,"singular_disclosure_allowed":true,"vote_count":9,"voters":["ramsexy","ali","eveeez","mefkan","hkr0x01","cryptographer","mozafer786","v13rsba","mezojm10"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":11722,"asset_type":"URL","asset_identifier":"https://chaturbate.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3256598,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report! This is definitely a bug, we'll get it fixed.","automated_response":false,"created_at":"2018-08-28T05:37:00.799Z","updated_at":"2018-08-28T05:37:00.799Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3260814,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-08-28T22:43:41.700Z","updated_at":"2018-08-28T22:43:41.700Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Chaturbate"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"corb3nik","url":"/corb3nik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3265678,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed on our end, could you please confirm @corb3nik?","automated_response":false,"created_at":"2018-08-29T20:55:44.018Z","updated_at":"2018-08-29T20:55:44.018Z","actor":{"username":"pooyammllc","cleared":false,"url":"/pooyammllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"corb3nik","url":"/corb3nik"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3265696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @pooyammllc! It seems that you have added an `X-CSRFToken` header to the upload request. This fixes the issue :)\n\nThanks for the quick bounty and for the awesome time-to-resolution!","automated_response":false,"created_at":"2018-08-29T21:01:32.560Z","updated_at":"2018-08-29T21:01:32.560Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360421,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-19T22:32:50.839Z","updated_at":"2018-09-19T22:32:50.839Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360438,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-19T22:40:09.141Z","updated_at":"2018-09-19T22:40:09.141Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360439,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-19T22:40:09.249Z","updated_at":"2018-09-19T22:40:09.249Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}