{"id":402671,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDI2NzE=","url":"https://hackerone.com/reports/402671","title":"HTTPS is not validating TLS mac codes","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-08-30T02:29:52.957Z","submitted_at":"2018-08-30T02:29:52.957Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cy1337","url":"/cy1337","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-25T14:26:47.393Z","bug_reporter_agreed_on_going_public_at":"2019-04-25T14:26:46.515Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"https://twitterflightschool.com is prone to POODLE and also a stronger variant of POODLE which allows a MITM attacker to actively decrypt bytes from an HTTPS request.\nThis attack is possible because the device terminating this TLS connection responds differently to a bad record mac when the last byte (e.g. padding) is 0x00.\n\nMy test tool recognized this by sending a series of connections with malformed mac/padding on a GET request.\nThis differs from POODLE scanning in that my tool tests how stacks respond to padding errors on application data rather than handshake messages.\nThe tool establishes a connection and sends a GET request with length such that it will need 16 bytes of padding.\n\nhttps://twitterflightschool.com responds with an HTTPS response and no TLS error when it receives a request ending 0x00.\nThis is a unique behavior from how it responds when the padding is correct but the mac is wrong or when the padding is malformed (e.g. random).\n\nTo exploit this, a MITM attacker can replace the last block (padding block) with a targeted ciphertext block as is done in POODLE.\nThe difference here is that the attacker can also select specific bytes for the last byte of the previous ciphertext.\nThe attacker can calculate the output from the block cipher decryption by guessing a plaintext byte.\nThis byte is then placed at the end of the second to last ciphertext block.\nIf the guess is correct, the decryption of the target block xor'd with that byte yields 0x00 for the plaintext.\nThis is observed by the attacker based on the lack of error and/or presence of an encrypted application data response.\n\nThe attack requires a MITM attacker to be able to inject JavaScript into the connection of some victim who has an authenticated session to an affected domain. This JavaScript will trigger a series of controlled HTTPS requests which are then rearranged by the attacker while monitoring for the bad record mac alert. After an average of 256 connections, the attacker learns the value of a targeted secret byte (i.e. from an auth cookie) and then changes the request length to repeat this process for the next byte until the full secret is recovered.\n\nSupporting Material/References\n---------------------------------\n\nI am attaching a packet capture and premaster secret list so that the packet capture can be decrypted in Wireshark.\n\nTo decrypt this, enter Wireshark preferences, then select protocols -\u003e SSL and specify the path to the .pms file as '(Pre)-Master-Secret log filename' and set \"SSL debug file\" to point to a new file.\n\nAfter opening the supplied pcap with the provided logged Premaster-Secret data, you can see that there are 10 TCP streams:\n- tcp.stream eq 0 : Proper HTTPS GET request/response\n- tcp.stream eq 1 : ***Response Received (non-deterministic padding bytes ending 0x00)***\n- tcp.stream eq 2 : EOF (All padding bytes 0xff)\n- tcp.stream eq 3 : EOF (Non-deterministic values with proper length)\n- tcp.stream eq 4 : EOF (All padding bytes 0x80)\n- tcp.stream eq 5 : ***Response received (corrupted last byte of mac)***\n- tcp.stream eq 6 : ***Response received (padding ends with 0x00 and mac is broken)***\n- Streams 7-9 all receive EOF for various other padding errors\n\nAs you can see, an attacker can select a value to insert as the last byte of the second to last ciphertext and have an oracle to know whether the last byte of the last ciphertext block (e.g. padding byte) corresponding to a plaintext 0x00.\n\nExplaining GOLDENDOODLE (POODLE's fiercer cousin)\n--------------------\n\nThe mitm attacker would inject some JavaScript into an HTTP session of the victim or otherwise get them to load JavaScript from any domain. (e.g. there is no XSS needed) This JavaScript triggers HTTPS requests to the targeted server with precise alignment so that the attacker can roughly know how the request will be broken into blocks. As the request is received, the handshake is allowed to complete but when application data from the client is received, the attacker will copy a ciphertext block containing some secret value (e.g. a cookie) and use it to replace the last block. \n\nThe attacker then starts with some initial guess value and XORs this with the last byte of the block prior to the targeted ciphertext block. This reveals what the intermediate value from the block cipher decryption would be if the guess is correct. The last byte of the second to last ciphertext block is now set to this calculated byte and the packet is passed along to the server. If the server disconnects, the attacker waits for the next request and tries again with the next possible value. If the server sends back data, it has confirmed the attacker's guess.\n\nThe bottom line is that a GOLDENDOODLE oracle can be exploited to decrypt HTTPS requests considerably faster than POODLE if the secret value is in a known character set. (POODLE requires an average of 256 requests per byte.)\n\n## Impact\n\nAn attacker with mitm of a victim authenticated to this domain could use a practical attack to break the confidentiality of HTTPS and recover cookie values or other data sent to the server.","weakness":{"id":41,"name":"Use of a Broken or Risky Cryptographic Algorithm"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":339808,"file_name":"twitterflightschool.pcap","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/339/808/644a2040d70e708d6b801403428b8cca5356f218/twitterflightschool.pcap?response-content-disposition=attachment%3B%20filename%3D%22twitterflightschool.pcap%22%3B%20filename%2A%3DUTF-8%27%27twitterflightschool.pcap\u0026response-content-type=application%2Fvnd.tcpdump.pcap\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145624Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bbdd2e78f50c786c36ce24ccd89c2237caf2bee35d596c1a2a8a6d021091238c","file_size":75718,"type":"application/vnd.tcpdump.pcap"},{"id":339809,"file_name":"twitterflightschool.pms","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/339/809/c6c6a84f7829c5f853e545c983db94668103239f/twitterflightschool.pms?response-content-disposition=attachment%3B%20filename%3D%22twitterflightschool.pms%22%3B%20filename%2A%3DUTF-8%27%27twitterflightschool.pms\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145624Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7c1ab9045bffb8958c4246537137a9550a8024fb5112819c26ec64b7fa6beee4","file_size":1180,"type":"text/plain"}],"allow_singular_disclosure_at":"2019-05-25T14:26:46.578Z","allow_singular_disclosure_after":-75169778.30941169,"singular_disclosure_allowed":true,"vote_count":10,"voters":["base_64","proximus_pl","ali","xiaoyinl","khizer47","m7mdharoun","cryptographer","dbof","houniff","rodolfogonzahernan"],"structured_scope":{"databaseId":1070,"asset_type":"URL","asset_identifier":"twitterflightschool.com","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3266672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would really like to know what type of device is handling HTTPS connections for this domain.","automated_response":false,"created_at":"2018-08-30T02:30:42.705Z","updated_at":"2018-08-30T02:30:42.705Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277720,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for your detailed report, @97ffb8d5!\n\nWe see that twitterflightschool.com suffers from some [TLS weaknesses](https://www.ssllabs.com/ssltest/analyze.html?d=twitterflightschool.com) which we'll also look into related to your report.\n\nFor the padding oracle specifically, we're having a bit of trouble reading your results. We can load the .pcap file and decrypt streams 0 and 3:\n\n{F340809}\n\nBut the other streams don't seem to decrypt:\n\n{F340810}\n\nAre we overlooking something? Any additional information you can provide will help us investigate your report.\n\nThank you for thinking of Twitter security.","automated_response":false,"created_at":"2018-08-31T23:53:42.268Z","updated_at":"2018-08-31T23:53:42.268Z","actor":{"username":"bugtriage-michael","cleared":false,"url":"/bugtriage-michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":340810,"filename":"twitterflightschool_pcap_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/340/810/ebc6ae077b97c4b71bc06d323c7b444f04be05be/twitterflightschool_pcap_1.png?response-content-disposition=attachment%3B%20filename%3D%22twitterflightschool_pcap_1.png%22%3B%20filename%2A%3DUTF-8%27%27twitterflightschool_pcap_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145624Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1de77a4d6a1111ac0d7f653dfe1e8e78fe74408c5c8e4550928baa5f25cf4dbd"},{"id":340809,"filename":"twitterflightschool_pcap_3.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/340/809/1ed5744c3b97fb610dcc18dabb625c5455dde577/twitterflightschool_pcap_3.png?response-content-disposition=attachment%3B%20filename%3D%22twitterflightschool_pcap_3.png%22%3B%20filename%2A%3DUTF-8%27%27twitterflightschool_pcap_3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145624Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=dd5bfb0b70b4e06d007eabfc10479e178928c69d815786dcdcedd1079ec33fdc"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277847,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Wireshark is actually decrypting the stream. You may notice that it shows a Finished message -- this would show \"Encrypted Handshake Message\" had it not been able to decrypt.\n\nI think you probably just need to set the \"ignore failed mac\" flag in the SSL preferences.\n\nIn order to see what is happening here, you may need to look at the SSL debug log. (This is another preference setting for the SSL protocol.)\n\nI've attached a screenshot of frame 40 decrypted on my system. You can see that because of the 0x00 length padding, it has pulled the mac into the HTTP request and 15 bytes of the padding were treated as the last 15 bytes of the mac.","automated_response":false,"created_at":"2018-09-01T00:52:28.121Z","updated_at":"2018-09-01T00:52:28.121Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":340828,"filename":"Frame40-decrypted.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/340/828/6de658152ef10543f43ceff74755c4458cf3ca78/Frame40-decrypted.png?response-content-disposition=attachment%3B%20filename%3D%22Frame40-decrypted.png%22%3B%20filename%2A%3DUTF-8%27%27Frame40-decrypted.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145624Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c5c35adef58b9028b9cd01151f4ce12636edc7f62dd59d17162963d0eca3b235"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's also worth noting, in regards to the ssllabs output, this padding oracle is compounded by the fact that the server only supports CBC mode ciphers.\n\nIf possible, I would really like to know what vendor/stack is running the SSL connection for this server so I can make sure there is a CVE assignment for tracking.","automated_response":false,"created_at":"2018-09-01T00:56:10.013Z","updated_at":"2018-09-01T00:56:10.013Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3299002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks very much for your replies and your patience, @97ffb8d5.\n\nWe're looking into this, and we'll keep you updated when we have additional information.\n\nThank you for thinking of Twitter security.","automated_response":false,"created_at":"2018-09-06T00:33:29.423Z","updated_at":"2018-09-06T00:33:29.423Z","actor":{"username":"bugtriage-michael","cleared":false,"url":"/bugtriage-michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3318451,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2018-09-10T21:50:51.653Z","updated_at":"2018-09-10T21:50:51.653Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3339917,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thank you for bringing this issue to our attention. Unfortunately, this report does not fall in scope for a monetary reward at this time. However, you will still be listed in our Hall of Fame. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\n\nThank you for thinking of Twitter security!","automated_response":false,"created_at":"2018-09-14T21:39:30.554Z","updated_at":"2018-09-14T21:39:30.554Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3349309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI was not actually expecting a monetary award considering this domain is not eligible for a bounty.\n\nMy goal with this report was to identify what product is handling the TLS for this server so that I can make sure the vendor releases a fix before I publish my research.\n\nIs there an A10 networks product used to proxy or inspect the SSL traffic? ","automated_response":false,"created_at":"2018-09-17T14:59:49.881Z","updated_at":"2018-09-17T14:59:49.881Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3349744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just noticed that this host is actually on Rack Space. Is this actually using Rack Space for SSL termination / load balancing?","automated_response":false,"created_at":"2018-09-17T16:31:11.189Z","updated_at":"2018-09-17T16:31:11.189Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3379646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just checking in to see if it might be possible to get some information on the server configuration as a thank you for reporting this vulnerability.","automated_response":false,"created_at":"2018-09-24T14:15:00.072Z","updated_at":"2018-09-24T14:15:00.072Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3720236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it possible that I could get permission to reference twitterflightschool.com in communication with Rack Space as an example of one of the Rack Space IP addresses with a vulnerable HTTPS service?","automated_response":false,"created_at":"2018-11-28T04:36:35.139Z","updated_at":"2018-11-28T04:36:35.139Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3816207,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"@cy1337 - The team that manages this website has decided to accept risk on this issue as the website itself is being taken down and replaced within the next week. One of my team members will get back to you regarding your query about using this website as an example for your comms with Rackspace","automated_response":false,"created_at":"2018-12-13T00:55:32.194Z","updated_at":"2018-12-13T00:55:32.194Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3816375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cy1337,\n\nI'm not sure if this site uses RackSpace to terminate TLS, but regardless it won't be available much longer. Given that this site is hosted on RackSpace, the issue is easy to discover (e.g. ssllabs), and the site will be shut down very soon, feel free to mention to RackSpace if you believe it will result in a larger effort to address this problem for their customers. I'll also re-close this as \"resolved\" so you get some rep points once the site is down, since you've put in some good work here.\n\nThanks for thinking of Twitter security!","automated_response":false,"created_at":"2018-12-13T02:28:50.540Z","updated_at":"2018-12-13T02:28:50.540Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3819730,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the update.\n\nPlease keep in mind that even after resolution, this report should not be publicly disclosed since the underlying research is not public. (ssllabs gives a C but it does not show the padding oracles at this time.)\n\nI will ping Rack Space with your URL but if they really aren't providing SSL WAF or Load Balancing, I'm very interested to know what product is terminating the SSL session.","automated_response":false,"created_at":"2018-12-13T14:36:43.642Z","updated_at":"2018-12-13T14:36:43.642Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3877478,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Reopening to resolve as \"fixed\", since we did take action here (although admittedly not as a result of this report). Thanks for your effort on this report. We don't plan to disclose this issue, but feel free to request disclosure if you would like to at some point in the future.\n\nThanks for thinking of Twitter security!","automated_response":false,"created_at":"2018-12-21T18:52:21.211Z","updated_at":"2018-12-21T18:52:21.211Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3877479,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2018-12-21T18:52:30.609Z","updated_at":"2018-12-21T18:52:30.609Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cy1337","url":"/cy1337"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3877484,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thank you for bringing this issue to our attention. Unfortunately, this report does not fall in scope for a monetary reward at this time. However, you will still be listed in our Hall of Fame. Thanks again.","automated_response":false,"created_at":"2018-12-21T18:53:47.147Z","updated_at":"2018-12-21T18:53:47.147Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4137591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Marc Nourani from Rackspace has offered to help connect the dots regarding this issue. You can reach him at marc.nourani@rackspace.com\n\nWith your permission, I'd also like to send them a print of the disclosure communications. Let me know if this is ok or if you'd prefer I not do that.","automated_response":false,"created_at":"2019-02-12T19:38:24.414Z","updated_at":"2019-02-12T19:38:24.414Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4642013,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The underlying research has been published. I think it would be nice to have this disclosure made public. Ideally though, it would be best to redact the email address for the hosting provider contact.","automated_response":false,"created_at":"2019-04-25T14:26:46.543Z","updated_at":"2019-04-25T14:26:46.543Z","first_to_agree":true,"actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4923139,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-25T14:26:47.421Z","updated_at":"2019-05-25T14:26:47.421Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}