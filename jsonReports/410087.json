{"id":410087,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTAwODc=","url":"https://hackerone.com/reports/410087","title":"Expose user IP if TOR crashs","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-09-15T13:52:30.148Z","submitted_at":"2018-09-15T13:52:30.148Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rbcafe","url":"/rbcafe","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-21T07:19:11.740Z","bug_reporter_agreed_on_going_public_at":"2018-09-20T14:18:10.894Z","team_member_agreed_on_going_public_at":"2018-09-21T07:19:11.684Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Greetings,\n\nI have noticed that for unpredictable reason a TOR relay can exposes the IP of an user. I noticed this by going to the server http://195.176.3.24/ and getting information about the headers. I arrived to this header who is : \"X-Your-Address-Is\" . \n\nHow :\n--\n\n- So I went to this tor-relay without being with TOR.\n- My IP was shown inside the X-Your-Address-Is\n- Then I go to this tor-relay with being with TOR.\n- A Tor IP was shown inside the X-Your-Address-Is\n\n{F346664}\n\nThen :\n--\n\nI noticed upon this that there was a clear pattern, so I tried to search more information on Shodan exposing information :\n\n- The url for the search was : https://www.shodan.io/search?query=%22Address%22+Content-Encoding%3A+identity\n- I obtained servers \n- The X-Your-Address-Is was clearly exposed indicating IPS. \n\n{F346661}\n\nExpectation :\n--\n\nThe TOR relay should be able to distinguish a non-tor-ip from a tor-ip. It should not be possible to leak IP user information if the user is not clearly within a TOR session.\n\nBest regards\n\n@Rbcafe\n\n## Impact\n\n- Expose an IP if  TOR crash for unexpected reason. \n- There is no security net if TOR crashes.","original_report_id":null,"original_report_url":null,"attachments":[{"id":346661,"file_name":"shodan.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/346/661/1baab15aeca59ab7731ca7379b207aae027792a3/shodan.png?response-content-disposition=attachment%3B%20filename%3D%22shodan.png%22%3B%20filename%2A%3DUTF-8%27%27shodan.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145711Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3932c6d91a0c1b500ba6f9a81cf22c3f338092e9a55a48c74f9e0f108235b75c","file_size":311553,"type":"image/png"},{"id":346664,"file_name":"term.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/346/664/3fb1f5bcd5aff64955910fb21badf10459935159/term.mov?response-content-disposition=attachment%3B%20filename%3D%22term.mov%22%3B%20filename%2A%3DUTF-8%27%27term.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145711Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c293aded2576e9572fa858b6b50ea11e3c50474a21153df601566932ba599946","file_size":12037598,"type":"video/quicktime"}],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["sameerphad72","ali","eveeez","cryptographer","rbcafe","0x08","gaurav869","jatacheers","brandonsaldan","ffff11110000"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3348382,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello Rbcafe,\n\nI don't understand exactly what you mean here. The `X-Your-Address-Is` HTTP header displays the IP address of the client visiting that webserver: I tested that, and when I visit without Tor it shows my actual IP, whereas when I visit with Tor it shows the exit node's IP address. That's what it's supposed to be doing. Why are you implying that this leaks IP addresses? And what does this have to do with crashing?\n\nThanks!","automated_response":false,"created_at":"2018-09-17T11:19:35.999Z","updated_at":"2018-09-17T11:19:35.999Z","actor":{"username":"asn","cleared":false,"url":"/asn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3348417,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Greetings,\n\nThe question I ask to myself is : \"why there is a X-Your-Address-Is header inside a response for a regular call without a TOR Browser\" . \n\nIf this header gives information about the node, shouldn't it be reserved only in a specific case : TorBrowser calling Tor Relay. \n\nI'm implying that it leaks IP because the data can be fetched by users without TOR and can be cached. (as in example).\n\nIn a particular crash and user switching from proxy to non-proxy the IP of the user would be revelled.\n\nEven if \" it's supposed to be doing\" don't you feel that this data could be stripped out when a non TOR Browser connects to a TOR Relay ?\n\nBest regards\n\nRbcafe\n","automated_response":false,"created_at":"2018-09-17T11:29:34.408Z","updated_at":"2018-09-17T11:29:34.408Z","actor":{"username":"rbcafe","cleared":false,"url":"/rbcafe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3361967,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This does not seem like a security issue for me, given our threat model.\n\nOur services are not meant to protect users that don't use Tor, or that switch proxy to non-proxy. This is just a regular HTTP header like many servers around here.\n\nClosing this.","automated_response":false,"created_at":"2018-09-20T10:14:49.901Z","updated_at":"2018-09-20T10:14:49.901Z","actor":{"username":"asn","cleared":false,"url":"/asn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3362895,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Greetings,\n\nDo you agree then for disclosure ?\n\nBest regards\n\n@Rbcafe","automated_response":false,"created_at":"2018-09-20T14:18:10.939Z","updated_at":"2018-09-20T14:18:10.939Z","first_to_agree":true,"actor":{"username":"rbcafe","cleared":false,"url":"/rbcafe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3365821,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-21T07:19:11.705Z","updated_at":"2018-09-21T07:19:11.705Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3365822,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-21T07:19:11.757Z","updated_at":"2018-09-21T07:19:11.757Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3365864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks\n\nBest regards\n@rbcafe","automated_response":false,"created_at":"2018-09-21T07:48:46.898Z","updated_at":"2018-09-21T07:48:46.898Z","actor":{"username":"rbcafe","cleared":false,"url":"/rbcafe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uft7o1wpafGAE3ASGWGc39AL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}