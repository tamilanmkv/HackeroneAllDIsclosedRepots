{"id":425200,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjUyMDA=","url":"https://hackerone.com/reports/425200","title":"XSS [flow] - on www.paypal.com/paypalme/my/landing (requires user interaction)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-18T00:36:35.334Z","submitted_at":"2018-10-18T00:36:35.334Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1915,"url":"https://hackerone.com/paypal","handle":"paypal","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"PayPal","twitter_handle":"paypal","website":"http://paypal.com/","about":"Send Money, Pay Online or Set Up a Merchant Account - PayPal."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-06T16:40:59.057Z","bug_reporter_agreed_on_going_public_at":"2018-11-02T21:04:59.502Z","team_member_agreed_on_going_public_at":"2018-11-06T16:40:58.970Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Steps to reproduce\nOn _Chrome and Firefox_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZScmY2FuY2VsVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZSc=`\n1. Click on the __X__ at the top right of the modal window\n\nOn _Safari_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDphbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5JyZjYW5jZWxVcmw9amF2YXNjcmlwVDpQQVlQQUwuY29tJTNkMSxsb2NhdGlvbiUzZCdqYXZhc2NyaXB0OmFsZXJ0XHgyOGRvY3VtZW50LmRvbWFpblx4Mjkn`\n1. Click on the __X__ at the top right of the modal window\n\n### Explanation\nThe value of the paramter `flow` is a base64 value which decoded looks like this:\n```\nreturnUrl={paypal_url}\u0026cancelUrl={paypal_url}\n```\n`cancelUrl` is passed as the `href` value of the __X__ button at the top right of the modal window that appears. It doesn't matter if you already created a paypal.me address.\n`returnUrl` is passed as the `href` value of the __Done__ button when you follow the instructions to create a paypal.me profile.\n\nThe problem is that `javascripT:paypal.com` is considered a valid value for `returnUrl` and `cancelUrl`. However, there a few restrictions already: you can't add a `%0a` character (or almost any special character, even using HTML encoding) and the URL has to start with `javascripT:*.paypal.com` or `javascripT:paypal.com` or `javascripT://paypal.com` or `javascripT://*.paypal.com`. \nFirst thing you have to take care of is about `paypal.com` because the object `paypal` doesn't exist, which will stop anything from working. The good thing is that `PAYPAL` does exist and `PAYPAL.com` is accepted as a valid value in the URL.\nThe second thing is that parentheses, quotes, semicolons and new lines are not allowed. But equal signs, commas and single quotes are allowed. So, you can set `PAYAPL.com` to any valid value you want like `PAYPAL.com=1`. Then you can use `location` and set it to something like `'javascript:alert\\x28\\x29'`. I encoded the invalid special characters in a encoding that Javascript understands and will decode before changing the `location`. Now you can put anything you want.\n\nOn Firefox and Chrome, the `location='javascript:alert\\x28\\x29'` writes `javascript:alert()` in the document, so I had to change it to make it work. Ended up with this: `location='javascript:\\x3csvg\\x20onload=alert\\x28document.domain\\x29\\x3e'`.\n\n## Impact\n\nYou could make actions as the authenticated user and probably more but I didn't tried.","bounty_amount":"2900.0","formatted_bounty":"$2,900","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":94,"voters":["m4t35z","honoki","sp1d3rs","foobar7","mashoud1122","gatolouco","ramsexy","shailesh4594","bogdantcaciuc","sameerphad72","and 84 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13591,"asset_type":"URL","asset_identifier":"*.paypal.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3513871,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-22T13:19:20.371Z","updated_at":"2018-10-22T13:19:20.371Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":227117},"actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3513872,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission! We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-10-22T13:19:28.415Z","updated_at":"2018-10-22T13:19:28.415Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3516692,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-22T22:36:11.596Z","updated_at":"2018-10-22T22:36:11.596Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.6)","old_severity_id":227117,"new_severity_id":227428},"actor":{"username":"meteor_pp","cleared":false,"url":"/meteor_pp","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dd81pfjo2syhoj6u3gg603jzz5w4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22pp_v_rgb.jpg%22%3B%20filename%2A%3DUTF-8%27%27pp_v_rgb.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145910Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a6ab976ae48f7358bdc4c15e2244e68178dc11ae2a3c83b1d80ac5bd222d73a5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3516693,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! Your submission has been validated and you will be rewarded a bounty. In order to receive your payment, please ensure your [HackerOne email alias](https://docs.hackerone.com/hackers/hacker-email-alias.html#___gatsby) is added to your PayPal account.\n\nTo add and confirm your email address:\n\n1. Log in to your PayPal account.\n2. Click the **Settings** icon near the top right corner of the page.\n3. Click the \"+\" beside \"Email address\".\n4. Enter your new email address and click **Add Email Address.**\n5. Click **Edit** next to the email you want to confirm.\n6. Click **Confirm this email.**\n\nOpen the email, and click the link to confirm your address. You will automatically return to the PayPal site where you will be asked to enter your password. When you receive the code in the mail, log in to your PayPal account and click Confirm address in the Activate Account box. Then enter your code.","automated_response":false,"created_at":"2018-10-22T22:36:41.426Z","updated_at":"2018-10-22T22:36:41.426Z","actor":{"url":"/paypal","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"PayPal"}},"bounty_amount":"2900.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"paypal","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3517159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the reward!!\nI just added the email alias to my PayPal account and confirmed it.","automated_response":false,"created_at":"2018-10-23T01:45:32.643Z","updated_at":"2018-10-23T01:45:32.643Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577596,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-11-02T19:48:12.112Z","updated_at":"2018-11-02T19:48:12.112Z","actor":{"username":"meteor_pp","cleared":false,"url":"/meteor_pp","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dd81pfjo2syhoj6u3gg603jzz5w4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22pp_v_rgb.jpg%22%3B%20filename%2A%3DUTF-8%27%27pp_v_rgb.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145910Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a6ab976ae48f7358bdc4c15e2244e68178dc11ae2a3c83b1d80ac5bd222d73a5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577915,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"ðŸ™‚","automated_response":false,"created_at":"2018-11-02T21:04:59.571Z","updated_at":"2018-11-02T21:04:59.571Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3594346,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-06T16:40:59.000Z","updated_at":"2018-11-06T16:40:59.000Z","actor":{"username":"dust_pp","cleared":false,"url":"/dust_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/jqtrCQrf4wrFi6RUZEq9xmkD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3594347,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-06T16:40:59.083Z","updated_at":"2018-11-06T16:40:59.083Z","actor":{"username":"dust_pp","cleared":false,"url":"/dust_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/jqtrCQrf4wrFi6RUZEq9xmkD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3594421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","automated_response":false,"created_at":"2018-11-06T16:42:39.833Z","updated_at":"2018-11-06T16:42:39.833Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}