{"id":426275,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjYyNzU=","url":"https://hackerone.com/reports/426275","title":"DOM XSS on 50x.html page on proxy.duckduckgo.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-10-20T20:41:31.759Z","submitted_at":"2018-10-20T20:41:31.759Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"smither","url":"/smither","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":10995,"url":"https://hackerone.com/duckduckgo","handle":"duckduckgo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"DuckDuckGo","twitter_handle":"duckduckgo","website":"https://duckduckgo.com","about":"DuckDuckGo is the Internet privacy company for everyone who's had enough of hidden online tracking."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-07T15:44:46.150Z","bug_reporter_agreed_on_going_public_at":"2018-11-02T20:58:32.989Z","team_member_agreed_on_going_public_at":"2018-11-07T15:44:46.089Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI read the report about DOM XSS on 50x.html page (https://hackerone.com/reports/405191).\nI decided to check some other subdomains to be sure.\nThis link still executes javascript:\nhttps://proxy.duckduckgo.com/50x.html?e=\u0026atb=test%22/%3E%3Cimg%20src=x%20onerror=alert(%27test%27);%3E\n\nThe following subdomains execute javascript as well:\nproxy1.duckduckgo.com\nproxy2.duckduckgo.com\nproxy3.duckduckgo.com\nproxy4.duckduckgo.com\n\n@cujanovic: I'm sorry for stealing.\n\n## Impact\n\nThe attacker can execute javascript code.","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":363740,"file_name":"Screenshot_from_2018-10-21_09-34-26.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/363/740/464894196a5cdb69e615427d9539293273727b71/Screenshot_from_2018-10-21_09-34-26.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-10-21_09-34-26.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-10-21_09-34-26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145917Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=db55336e58e46db448277dee0927d77cb46f894086b7091fb196977786d69baa","file_size":170582,"type":"image/png"}],"allow_singular_disclosure_at":"2018-12-02T20:58:33.031Z","allow_singular_disclosure_after":-90180044.43675113,"singular_disclosure_allowed":true,"vote_count":12,"voters":["sameerphad72","ali","r3y","cryptographer","reppie","ronin1432","pz36","apridos","taimoor2080","ranjitha","and 2 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":8671,"asset_type":"URL","asset_identifier":"*.duckduckgo.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3524839,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @smither, \n\nThank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. \n\nThey will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. \n\nThe HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change. \n\nRegards. \n@chessmast3r  ","automated_response":false,"created_at":"2018-10-24T09:42:31.754Z","updated_at":"2018-10-24T09:42:31.754Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3564220,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"This was fixed with #405191. If there's another issue you see please reopen.","automated_response":false,"created_at":"2018-10-31T16:10:57.285Z","updated_at":"2018-10-31T16:10:57.285Z","original_report_id":405191,"actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3567782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nIn my report I tried to explain that the fix of #405191 doesn't seem to be implemented for the proxy subdomains.\nDid you try the link in my report? If I open the link in a firefox browser it still executes XSS. Please ask if you need further information.","automated_response":false,"created_at":"2018-11-01T00:19:22.290Z","updated_at":"2018-11-01T00:19:22.290Z","actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3567789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@marcantonio I can't reopen the report myself. Could you do it if my last message is accurate?\n","automated_response":false,"created_at":"2018-11-01T00:25:21.484Z","updated_at":"2018-11-01T00:25:21.484Z","actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3570813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I did try it. It didn't work in Chrome or Firefox (latest). What versions are you using? Is it possible that something is cached? Thanks.","automated_response":false,"created_at":"2018-11-01T16:10:54.639Z","updated_at":"2018-11-01T16:10:54.639Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3571831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @marcantonio,\n\nThat's weird. It still seems to work for me. Here are the browsers I tested:\nfirefox quantum 60.2.0esr (64-bit) kali distr - works, even after emptying cache.\nfirefox quantum 63.0 (64-bits) -works\nfirefox quantum 63.0.1 (64-bits) -works, even after emptying cache.\nInternet explorer 11 version 11.345.17134.0 update version 11.0.90 - works, even after emptying cache.\nmicrosoft edge 42.17134.1.0 -works, even after emptying cache.\nTor browser 8.0.3 (based on Mozilla Firefox 60.3.0esr) works, if you allow the site after xss warning.\nI don't have any ideas at the moment why it doesn't execute if you try.\n\n@chessmast3r, were you able to verify XSS execution?\n","automated_response":false,"created_at":"2018-11-01T19:53:03.693Z","updated_at":"2018-11-01T19:53:03.693Z","actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are some other payloads that work for me:\nhttps://proxy.duckduckgo.com/50x.html?e=\u0026atb=test%22/%3E%3Csvg%0Conload=alert(1)%3E\nhttps://proxy.duckduckgo.com/50x.html?e=\u0026atb=test%22/%3E%3Cdetails/open/ontoggle=%22alert`1`%22%3E\nhttps://proxy.duckduckgo.com/50x.html?e=\u0026atb=test%22/%3E%3Cvideo%3E%3Csource%20onerror=%22javascript:alert(1)%22%3E","automated_response":false,"created_at":"2018-11-01T20:24:13.768Z","updated_at":"2018-11-01T20:24:13.768Z","actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3575664,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hi @smither, \n\nThank you for the additional information!  Let me open this for the further review! ","automated_response":false,"created_at":"2018-11-02T13:20:23.111Z","updated_at":"2018-11-02T13:20:23.111Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, our browser extensions were blocking this! Thanks, I see it now.","automated_response":false,"created_at":"2018-11-02T19:36:21.419Z","updated_at":"2018-11-02T19:36:21.419Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577592,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-11-02T19:47:23.171Z","updated_at":"2018-11-02T19:47:23.171Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@smither thanks. This was actually the same issue as #405191 we just didn't deploy it fully.","automated_response":false,"created_at":"2018-11-02T20:12:41.268Z","updated_at":"2018-11-02T20:12:41.268Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577682,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2018-11-02T20:12:53.463Z","updated_at":"2018-11-02T20:12:53.463Z","actor":{"url":"/duckduckgo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"DuckDuckGo"}},"reporter":{"username":"smither","url":"/smither"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577683,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-11-02T20:13:03.664Z","updated_at":"2018-11-02T20:13:03.664Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"smither","url":"/smither"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you. Much appreciated","automated_response":false,"created_at":"2018-11-02T20:57:58.950Z","updated_at":"2018-11-02T20:57:58.950Z","actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577903,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-02T20:58:33.007Z","updated_at":"2018-11-02T20:58:33.007Z","first_to_agree":true,"actor":{"username":"smither","cleared":false,"url":"/smither","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/730/5462497682db43e5b609e148f2d3e40202412cab_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3601631,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-07T15:44:46.108Z","updated_at":"2018-11-07T15:44:46.108Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3601632,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-07T15:44:46.168Z","updated_at":"2018-11-07T15:44:46.168Z","actor":{"username":"marcantonio","cleared":false,"url":"/marcantonio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}