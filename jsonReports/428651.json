{"id":428651,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mjg2NTE=","url":"https://hackerone.com/reports/428651","title":"Subdomain takeover dew to missconfigured project settings for Custom domain .","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-07-09T14:00:19.000Z","submitted_at":"2018-07-09T14:00:19.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xprial","url":"/0xprial","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":34493,"url":"https://hackerone.com/flock","handle":"flock","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/034/493/c2cb04eafffba9e736b57ff56e5185513af0f9aa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/493/c2cb04eafffba9e736b57ff56e5185513af0f9aa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"profile":{"name":"Flock","twitter_handle":"flock","website":"https://flock.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-26T17:24:42.075Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While testing flock.com I got a domain **flock.co** what is under flock company . So I stared looking at it's subdomains and got subdomain **newdev.flock.co** . When I visited the subdomain in browser I got a error like below screenshot :-\n{F365851}\nThis took my attention . So I checked the DNS record for this domain .\n\n```\nR3liGiOus_HuNt3r$ dig newdev.flock.co\n; \u003c\u003c\u003e\u003e DiG 9.10.6 \u003c\u003c\u003e\u003e newdev.flock.co\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 13182\n;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 512\n;; QUESTION SECTION:\n;newdev.flock.co. IN A\n;; ANSWER SECTION:\nnewdev.flock.co. 299 IN CNAME cname.readme.io.\ncname.readme.io. 299 IN CNAME readme-cache-prod-1392018356.us-east-1.elb.amazonaws.com.\nreadme-cache-prod-1392018356.us-east-1.elb.amazonaws.com. 59 IN A 52.0.214.29\nreadme-cache-prod-1392018356.us-east-1.elb.amazonaws.com. 59 IN A 52.5.249.117\n;; Query time: 69 msec\n;; SERVER: 8.8.8.8#53(8.8.8.8)\n;; WHEN: Mon Jul 09 04:58:06 +06 2018\n;; MSG SIZE rcvd: 175\n```\n\nFrom above record we can say the subdomain is pointing to **CNAME cname.readme.io** . So I start looking at custom domain documents on **readme.io** website to understand how they works . From their document I understand that :-\n\n* You need a subdomain pointing to your readme.io subdomain **[yoursubdomain.readme.io]** .\n* Your subdomain should be configured in domains settings in following page **https://dash.readme.io/project/\u003cproject\n_Name\u003e/v1.0/domains**\n\nSo to takeover I need to check if **cname.readme.io** is alreday claimed of not . But Unfortunately it was already claimed :( . But I have seen many such services doesn't force users to verify their ownership of domains by using same CNAME txt record like their service subdomain . So still there's a hope .\nI opened a account in **readme.io** and I got a subdomain **newdev.readme.io** . Then I go to **domains settings** **https://dash.readme.io/project/newdev/v1.0/domains** and in Custom Domain Field used **newdev.flock.co** as value and save changes .\nNow when I visited **newdev.flock.co** It redirected me to **http://newdev.flock.co/inactive** this page what saying now that Not Yet Active.\n\n{F365852}\n\nThis is showing as I am using a trail account . In the webpage title you will see my project name what I used while creating the project . So now this domain is serving my contents from newdev.readme.io project page .\n\n**How to avoid such issues ? :-** Always update your DNS records . remove CNAME or any other DNS records what is not in used .\n\nIf you find a security vulnerability feel free to contact them via security@flock.com\n\n You can find me on [Facebook](https://www.facebook.com/prial261) anytime .\n**My blog :-** https://medium.com/@prial261\n\nThanks for reading .","original_report_id":null,"original_report_url":null,"attachments":[{"id":365851,"file_name":"Screen_Shot_2018-07-09_at_5.02.27_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/365/851/0a3f6979464724fbcd8ff2693788bf0c8916f344/Screen_Shot_2018-07-09_at_5.02.27_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-07-09_at_5.02.27_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-07-09_at_5.02.27_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145931Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=39eed924dfcea5ddcdeae32c862d95e2cbb94783980895857370ec285246f40e","file_size":181551,"type":"image/png"},{"id":365852,"file_name":"Screen_Shot_2018-07-09_at_5.19.43_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/365/852/5709297e42fd55e1539b72235cf7ae55d4663da8/Screen_Shot_2018-07-09_at_5.19.43_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-07-09_at_5.19.43_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-07-09_at_5.19.43_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145931Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7305c706f5c708f384f55998e64b7752b0ee50b5d953fcf7088e79bc78790aaf","file_size":733178,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":67,"voters":["overjt","sameerphad72","remonsec","sheikhrishad0","asad0x01_","smshrimant","eveeez","haxta4ok00","an0nym0us","pandaonair","and 57 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3532520,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-07-09T14:00:19.000Z","updated_at":"2018-07-09T14:00:19.000Z","actor":{"username":"0xprial","cleared":true,"url":"/0xprial","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0xprial","url":"/0xprial"},"genius_execution_id":null,"team_handle":"flock","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3539835,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-26T17:24:42.112Z","updated_at":"2018-10-26T17:24:42.112Z","actor":{"username":"0xprial","cleared":true,"url":"/0xprial","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"flock","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":11252,"category":"researcher","content":"Subdomain takeover is a common Security issue what is actually developers mistake when they left a Unused/unclaimed 3rd party Service DNS CNAME record for a subdoamin of theirs and Hackers can claim those subdomains with the help of external services it pointing to what could lead to serious issues . You can learn more about Subdomain takeover from [detectify blog](https://labs.detectify.com/2014/10/21/hostile-subdomain-takeover-using-herokugithubdesk-more/) .","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":118877,"username":"0xprial","name":"Prial Islam Khan","bio":"A teenage boy with a passion of Breaking Security.","cleared":true,"website":"https://0xprial.com","location":"Dhaka, Bangladesh","created_at":"2016-10-21T19:30:50.280Z","url":"https://hackerone.com/0xprial","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/118/877/7f8e1265c1a3d1de0d05b614064246203b566361_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}