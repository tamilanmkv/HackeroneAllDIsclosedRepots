{"id":430463,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzA0NjM=","url":"https://hackerone.com/reports/430463","title":"Keybase client: downloaded executables lack \"com.apple.quarantine\" meta-attribute [macOS]","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-29T21:04:34.618Z","submitted_at":"2018-10-29T21:04:34.618Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-16T19:58:09.447Z","bug_reporter_agreed_on_going_public_at":"2019-08-20T09:40:27.766Z","team_member_agreed_on_going_public_at":"2019-09-16T19:58:09.376Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\n1. Missing quarantine attribute for downloaded files allows remote attacker to send executable file that won't be checked by Gatekeeper (codesign bypass). \n\n2. Since sent executable files lack `com.apple.quarantine` meta-attribute, no alert about launching executable file from the web will be shown to user.\n\n3. That means, dblclick on file in Finder.app (or any similar gesture to launch the file) immediately launches the attacker's file.\n\n## PoC\n\n1. Attacker sends `exploit.terminal` to the victim (file is unsigned)\n2. Victim opens `exploit.terminal`\n3. No alert from Gatekeeper about unsigned executable\n4. No alert about running executable file downloaded from the web\n5. Shell commands from `exploit.terminal` execute with user-level privileges.\n\n\u003e NOTE: if victim is sudoer with no pass, attacker can insert `sudo` commands in `*.terminal` file and gain `root` permissions.\n\nScreencast + `exploit.terminal` file sample attached.\n\n\u003e Screencast: `xattr \u003cfile\u003e` shows apple-specific meta-attributes like `com.apple.quarantine`\n\n## Impact\n\nQuarantine + codesigning are basic security mechanisms, which prevents user/device from running untrusted executables.\n\nKeybase allows to send **messages** and share **KBFS** with **any Keybase user** (!), that allows attacker to make a massive spam of `.terminal` files with malicious payload.","bounty_amount":"4000.0","formatted_bounty":"$4,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":368059,"file_name":"keybase-terminal-files.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/368/059/a7fcdf5bdb8a0ebdb1ccfea52cebdcae1cb9d86c/keybase-terminal-files.mp4?response-content-disposition=attachment%3B%20filename%3D%22keybase-terminal-files.mp4%22%3B%20filename%2A%3DUTF-8%27%27keybase-terminal-files.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145941Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5183969d3bbaf74293cd362339fefbf2aac13ea6b65a04bcf9f91b9fb15071ee","file_size":721317,"type":"video/mp4"},{"id":368060,"file_name":"exploit.terminal","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/368/060/4b98f51810e27c634a54094fa8f3baa6e7512c00/exploit.terminal?response-content-disposition=attachment%3B%20filename%3D%22exploit.terminal%22%3B%20filename%2A%3DUTF-8%27%27exploit.terminal\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145941Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4808fb82595923a443d1173d45bd36b4f5b597b079cc33ab56634798c893d2f7","file_size":462,"type":"application/xml"}],"allow_singular_disclosure_at":null,"vote_count":75,"voters":["mirchr","ras-it","sameerphad72","spam404","s_p_q_r","ali","metnew","caesim","aryan2808","nidens","and 65 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3551884,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-10-29T21:16:30.710Z","updated_at":"2018-10-29T21:16:30.710Z","additional_data":{"old_title":"Keybase client: Lack of quarantine for downloaded executables [macOS]","new_title":"Keybase client: downloaded executables lack \"com.apple.quarantine\" meta-attribute [macOS]"},"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553192,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Question: which download mechanism did you test for this? KBFS Finder integration, chat downloads or files tab in the app?","automated_response":false,"created_at":"2018-10-30T01:33:49.991Z","updated_at":"2018-10-30T01:33:49.991Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553199,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I used chat downloads (screencast). That also means files tab is vulnerable too because it's the same Electron app.\n\u003e For corresponding quarantine header check Chrome's Info.plist\n\nFrom my observations, sending files over KBFS doesn't attach any meta-attributes, so KBFS must be vulnerable too. I'm going to check it now.","automated_response":false,"created_at":"2018-10-30T01:39:37.701Z","updated_at":"2018-10-30T01:40:33.882Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was able to repro KBFS.\n\nKBFS:\n1. Send file to KBFS\n2. launch file from KBFS (/Keybase/(private|public)/\u003cusername\u003e)","automated_response":false,"created_at":"2018-10-30T01:43:58.689Z","updated_at":"2018-10-30T01:43:58.689Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, thanks for the update. I need to ask around and see if there's a reason we're not setting the attribute. I'll get back to you by the end of the week.","automated_response":false,"created_at":"2018-10-30T01:44:43.175Z","updated_at":"2018-10-30T01:44:43.175Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By point of comparison, do you know what Slack and Dropbox do?","automated_response":false,"created_at":"2018-10-30T01:47:02.259Z","updated_at":"2018-10-30T01:47:02.259Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553219,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Slack uses Quarantine - it's easy to check\nDropbox doesn't, I guess because their folders are considered as a \"trusted space\". \n\n\u003e I'm working on reporting this issue to multiple providers: Skype/WhatsApp/Signal/Dropbox, so I hope this report won't make them fix this problem before my report to them :)","automated_response":false,"created_at":"2018-10-30T01:52:17.911Z","updated_at":"2018-10-30T01:53:32.473Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco  `.app` also works for KBFS, since it's just a folder.","automated_response":false,"created_at":"2018-10-30T02:10:46.381Z","updated_at":"2018-10-30T02:10:46.381Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e @maxtaco I've submitted this vulnerability to Dropbox and some other vendors (not all yet)","automated_response":false,"created_at":"2018-10-30T05:20:16.124Z","updated_at":"2018-10-30T05:20:16.124Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556343,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report, we've decided to fix this with medium priority. We'll get changes into master in about 1 to 3 months. Cheers.","automated_response":false,"created_at":"2018-10-30T17:27:42.413Z","updated_at":"2018-10-30T17:27:42.413Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556345,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-30T17:28:11.208Z","updated_at":"2018-10-30T17:28:11.208Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.6)","old_severity_id":230968,"new_severity_id":231480},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(BTW, the fixes to chat are already in master).","automated_response":false,"created_at":"2018-10-30T17:28:53.047Z","updated_at":"2018-10-30T17:28:53.047Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great!\n\n\u003e // NOTE:  I've seen a few cases were quarantine could break auto-update. ","automated_response":false,"created_at":"2018-10-30T17:46:30.837Z","updated_at":"2018-10-30T17:52:47.047Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the warning, we'll keep that in mind.","automated_response":false,"created_at":"2018-10-30T17:52:38.690Z","updated_at":"2018-10-30T17:52:38.690Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco As I understand, KBFS should respect MOTW (\"mark of the web\") on Windows too. MOTW - is the same defensive mechanism as GateKeeper and Quarantine\n\nI've not checked Windows yet (just started pulling a VM), do I need to report it as a separate vulnerability?","automated_response":false,"created_at":"2018-10-30T18:35:21.366Z","updated_at":"2018-10-30T18:35:21.366Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It was part of our plan internally too to examine Windows, etc. Thanks!","automated_response":false,"created_at":"2018-10-30T18:39:25.099Z","updated_at":"2018-10-30T18:39:25.099Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556776,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In a case MOTW is not set by your FUSE implementation or any Win misbehavior, and you're going to add them in your implementation:\n\n- Chrome's MOTW blacklist is available [here](https://cs.chromium.org/chromium/src/chrome/browser/resources/safe_browsing/download_file_types.asciipb)\n\n- FF has a similar [blacklist](https://searchfox.org/mozilla-central/source/xpcom/io/nsLocalFileWin.cpp#2901), easier to copy-paste, but it's not complete.\n\n- Adobe has a [huge blacklist for paranoids](https://gist.github.com/rxwx/8834cee60e077531c4db2f260ee55e2a)\n\n- (my repo: [dangerous-file-extensions](https://github.com/Metnew/dangerous-file-extensions) Win files are almost the same as in Chromium )\n\nThanks for replying, Keybase is awesome!","automated_response":false,"created_at":"2018-10-30T19:15:48.760Z","updated_at":"2018-10-30T19:16:06.343Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[KBFS fix](https://github.com/keybase/kbfs/pull/1896)\n\n\u003e I'm not a Windows expert, so MOTW implementation was quite surprising :)","automated_response":false,"created_at":"2018-11-02T21:07:47.276Z","updated_at":"2018-11-02T21:11:59.090Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3889642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @maxtaco!\n\nAny updates on this? Two months passed since the reporting date.\n\nAlso, I'd like to post an article about Quarantine issues in applications and highlight your effort in fixing this bug. Only two companies decided to fix this issue so far;  resolutions on other three reports are still pending.\n\n\u003e Slack appears to be vulnerable too, but only if it the app was downloaded from the official website, not from AppStore","automated_response":false,"created_at":"2018-12-25T21:09:50.686Z","updated_at":"2018-12-25T21:09:50.686Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3889645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still working on our finder integration. Let me check with the team. Sorry for the delay. Chat downloads have been fixed for a while. ","automated_response":false,"created_at":"2018-12-25T21:13:38.124Z","updated_at":"2018-12-25T21:13:38.124Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're close, all that's left is the Windows Explorer integration, that's been the hardest to get right. Thank you!","automated_response":false,"created_at":"2019-01-07T01:08:01.487Z","updated_at":"2019-01-07T01:08:01.487Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, @maxtaco!\n","automated_response":false,"created_at":"2019-01-07T03:55:35.777Z","updated_at":"2019-01-07T03:55:35.777Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4027972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @maxtaco, I found a better attack scenario:\n\n1. Silently share a file with victim  (check `/keybase/private/metnew,max`\n2. Drop an executable in this folder\n3. Send a crafted `.url` file to victim\n4. Victim opens `.url` file -\u003e RCE\n\nThe main trick is that crafted `.url` files may run arbitrary executables by the path on the system.\nFiles located in Keybase have known paths.\n`.url` files aren't blocked by browsers(Chrome/FF/Safari) and could be sent using messengers, mail apps, browsers, file storages, \u003cany_app\u003e.\n \nI've made a private shared folder `metnew,max` with PoC `x.url` and `exploit.terminal`\n\nI know that Keybase almost patched the bug, but I think such attack scenario may increase severity to critical retroactively: that's 1-click RCE.\n\n\u003e Hardcoded paths allow tricking users into running arbitrary executables shared in Keybase even with quarantine. Not sure, need some bypass for that.","automated_response":false,"created_at":"2019-01-24T02:01:09.398Z","updated_at":"2019-01-24T02:12:02.142Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for the follow-up. I'm not sure I fully understand.  The victim of this attack needs to:\n\n1. Download the link as an attachment from chat (or something)\n2. Double click on the downloaded file in the finder (x.url)\n\nHow is this different from sending someone the malware just from the chat? Is there anyway that downloading x.url from the internet also executes it without further action? That's what I don't understand.","automated_response":false,"created_at":"2019-01-24T02:32:17.187Z","updated_at":"2019-01-24T02:32:17.187Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, `.url` files downloaded from web could launch files on FS.\nAttaching a PoC (h1 renames `.url` to `.txt`)","automated_response":false,"created_at":"2019-01-24T02:33:52.525Z","updated_at":"2019-01-24T02:35:40.321Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":411497,"filename":"x.url","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/497/feff179d5341b0eac994d330031545baf9946d5c/x.url?response-content-disposition=attachment%3B%20filename%3D%22x.url%22%3B%20filename%2A%3DUTF-8%27%27x.url\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145941Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e3f95a389cdffb5668cfe7880e1a5ae056c3f61f2ef735efeaad94fba4ce0949"}],"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, misunderstand your question\nThe key thing here is that the issue isn't connected to Keybase client only.\nThe victim may receive a `.url` file from mail, browser, other messengers","automated_response":false,"created_at":"2019-01-24T02:34:44.335Z","updated_at":"2019-01-24T02:35:12.590Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But in either mail or browser, clicking on that x.url file downloads it to Downloads, and then the user needs to double-click on it, no?","automated_response":false,"created_at":"2019-01-24T02:36:11.393Z","updated_at":"2019-01-24T02:36:11.393Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it anyway requires a click on `.url` file. However:\n1. the victim doesn't explicitly click on an executable file - that's very important.\n2. Browsers/mail clients allow opening files directly: send `.url` over mail -\u003e victim opens in `Mail.app` (no download step) -\u003e arbitrary code gets executed. For browsers, almost same: it's likely the file will be opened from Chrome downloads bar or in FF via \"Open\" button.\n\n\u003e For messengers: open `x.url` from Telegram/Skype UI -\u003e RCE\n\u003e `.url` files are generally treated as internet shortcuts\n\nI hope you get my point, I may record a screencast if required","automated_response":false,"created_at":"2019-01-24T02:41:22.545Z","updated_at":"2019-01-24T02:56:20.302Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you show me a PoC that works in my browser? The one you sent requires more clicks than you have described.","automated_response":false,"created_at":"2019-01-24T02:55:58.756Z","updated_at":"2019-01-24T02:55:58.756Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching a screencast","automated_response":false,"created_at":"2019-01-24T03:02:45.663Z","updated_at":"2019-01-24T03:02:45.663Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":411503,"filename":"keybase-url.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/503/6b638744b86bab12e929c2c4d67860f1ee28bf55/keybase-url.mp4?response-content-disposition=attachment%3B%20filename%3D%22keybase-url.mp4%22%3B%20filename%2A%3DUTF-8%27%27keybase-url.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145941Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2499ac32fd432aefb00498ddac54d0f742f6a2f2c1959005a394c7845a418bc"}],"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see, so you're saying is that our previous lack of quarantine protection was a way for an attacker to get around the correct quarantine protection of other applications. ","automated_response":false,"created_at":"2019-01-24T10:34:38.660Z","updated_at":"2019-01-24T10:35:05.081Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4030580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For me it's (sorry for duplicating this):\n\n1. Fixed paths in Keybase =\u003e attacker always knows the path to malicious executable\n2. it's easy to open this malicious executable via \".url\"\n3. `.url` opens anywhere and isn't blocked by other apps -\u003e RCE (something that I demonstrated on the screencast)\n\npretty silent and reliable RCE without strange `.terminal` files and user interaction on macOS.","automated_response":false,"created_at":"2019-01-24T10:41:27.857Z","updated_at":"2019-01-24T10:43:27.781Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Keybase worm (if no quarantine)\n\u003e 1. Share malicious file with every follower and send them `.url` (e.g. via Twitter) pointing to the malicious file \n\u003e 2. If RCE -\u003e return to 1","automated_response":false,"created_at":"2019-01-24T11:07:04.004Z","updated_at":"2019-01-24T11:07:51.530Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'd agree with you if it took *one* click but in every example you've sent me, it takes *two* --- one to download the \".url\" file, and another to open it.","automated_response":false,"created_at":"2019-01-24T11:36:06.483Z","updated_at":"2019-01-24T11:36:06.483Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4030778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still working on the windows patch, it'll hopefully be done shortly. It's been challenging to get it right due to malicious DLLs.","automated_response":false,"created_at":"2019-01-24T11:37:10.865Z","updated_at":"2019-01-24T11:37:10.865Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4032469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e No need in a click for downloading -\u003e Chrome auto-downloads `.url`  files, FF has \"Open\" menu in download alert (AFAIR). Only 1 click required :)\n\nI received your message on keybase, thanks)\n\n","automated_response":false,"created_at":"2019-01-24T17:58:50.146Z","updated_at":"2019-01-24T17:58:50.146Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4105588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I think we're finally ready to mark this closed.  Do you concur, are we all fixed here?  Sorry it took us so long.","automated_response":false,"created_at":"2019-02-06T21:06:43.022Z","updated_at":"2019-02-06T21:06:43.022Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4105631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"macOS version is fixed - tested on a real device.\nWindows has MOTW + I see in PRs you've implemented protection for DLL hijacking - only static analysis of source code and Github.\n\nSeems fixed to me.\n\nCould we not disclose all the report details publicly for a while?\nTelegram is still working on a patch.\n\nI believe we could make a full disclosure in 1-2 weeks.","automated_response":false,"created_at":"2019-02-06T21:18:31.538Z","updated_at":"2019-02-06T21:18:31.538Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4614862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, still waiting for the last fix from [COMPANY]","automated_response":false,"created_at":"2019-04-22T14:53:33.735Z","updated_at":"2019-04-22T14:53:33.735Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5092963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Need just a few weeks, ████ :(","automated_response":false,"created_at":"2019-06-14T10:44:35.503Z","updated_at":"2019-08-15T18:01:09.136Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5305642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry, but I’m still waiting for a patch from them\nThey said the patch is in beta already","automated_response":false,"created_at":"2019-07-12T10:05:35.593Z","updated_at":"2019-07-12T10:05:35.593Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5565503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @maxtaco,\n\nAll products (that decided to patch themselves) are now safe.\nCan you mask \u003cCOMPANY_NAME\u003e from the message above (Jun 14) via Limited Disclosure functionality?\n\nThank you for not resolving this ticket for a while!","automated_response":false,"created_at":"2019-08-13T14:52:14.191Z","updated_at":"2019-08-13T14:52:14.191Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5584890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco ping","automated_response":false,"created_at":"2019-08-15T15:48:29.114Z","updated_at":"2019-08-15T15:48:29.114Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5584930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please, no nagging unless it's truly time sensitive.","automated_response":false,"created_at":"2019-08-15T15:56:55.998Z","updated_at":"2019-08-15T15:56:55.998Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How do I edit out the company name?  I don't see how to do it.","automated_response":false,"created_at":"2019-08-15T17:20:27.302Z","updated_at":"2019-08-15T17:20:27.302Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @maxtaco,\n\nSorry for that`ping.`, I know it's easy to forget about a report/comment, so that's why.\n\nUnder the \"Severity\" or \"Notifications\" tab in the header of the report, you should see a \"Visibility\" menu with \"Redact\" button(blue link)","automated_response":false,"created_at":"2019-08-15T17:45:24.521Z","updated_at":"2019-08-15T17:45:24.521Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5585652,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-08-15T18:01:43.084Z","updated_at":"2019-08-15T18:01:43.084Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585654,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-08-15T18:02:05.246Z","updated_at":"2019-08-15T18:02:05.246Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Keybase"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But it's a 1click RCE on the machine via a shortcut file 😞\nThe screencast is here - https://hackerone.com/reports/430463#activity-4028163\n\n\u003e May I ask to reconsider the bounty? The report is a bit old, so maybe we're missing something","automated_response":false,"created_at":"2019-08-15T18:08:58.661Z","updated_at":"2019-08-15T18:08:58.661Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5585809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, are you saying that the original severity was underrated? But that the issue is now fixed?","automated_response":false,"created_at":"2019-08-15T18:22:42.717Z","updated_at":"2019-08-15T18:22:42.717Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I really don't want to nag about bounty and severity, just want to make sure we're on the same page. \n\nThe original attack scenario really was estimated as \"Medium\", but later I provided an attack scenario which requires only 1 click:\n1. silently sync a file with victim\n2. auto-download a shortcut file through browser\n3. victim should do 1 click on this file in \"Downloads\" bar\n\nI later messaged you on Keybase and showed the PoC, and you said that it makes no sense to change the \"Severity\" but you'll consider my additional research when awarding the bounty.\n\nMy Keybase: @metnew\nMessage is dated 24 Jan 2019","automated_response":false,"created_at":"2019-08-15T18:47:42.701Z","updated_at":"2019-08-15T18:47:42.701Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5586036,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the reminder, that was a while ago.","automated_response":false,"created_at":"2019-08-15T18:53:30.765Z","updated_at":"2019-08-15T18:53:30.765Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Keybase"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5586065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, thanks @keybase!\nIt was an awesome research for me, and I truly appreciate your response to remediation and disclosure!\n\n\u003e I guess I said like ten times that I enjoy your product :)","automated_response":false,"created_at":"2019-08-15T18:56:33.781Z","updated_at":"2019-08-15T18:56:33.781Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5586067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your great work here.","automated_response":false,"created_at":"2019-08-15T18:57:23.952Z","updated_at":"2019-08-15T18:57:23.952Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5615225,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-08-20T09:40:27.783Z","updated_at":"2019-08-20T09:40:27.783Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @keybase, may we disclose this report?","automated_response":false,"created_at":"2019-09-16T18:09:49.839Z","updated_at":"2019-09-16T18:12:44.149Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5819085,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-16T19:58:09.394Z","updated_at":"2019-09-16T19:58:09.394Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5819086,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-09-16T19:58:09.462Z","updated_at":"2019-09-16T19:58:09.462Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":14095,"category":"researcher","content":"Insufficient quarantine handling in Keybase allowed a remote attacker to execute code on a target macOS device via shortcut file pointing to the synced asset. (1 click RCE via file shortcut)\nPaths to synced files is known to attacker: `/keybase/public/attacker,victim/\u003cfile\u003e`\n\nThe vulnerability initially was reported for macOS. However, Keybase team found that Windows version has a similar issue with MOTW additionally leading to DLL hijacking scenarios.\n\nI want to thank the @keybase team for giving a chance to other companies to patch their products by not disclosing this report for a while.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":38544,"username":"metnew","name":"Vladimir Metnew","bio":"","cleared":true,"website":null,"location":"Ukraine, Kiev ","created_at":"2015-08-16T17:17:23.396Z","url":"https://hackerone.com/metnew","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}