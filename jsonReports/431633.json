{"id":431633,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzE2MzM=","url":"https://hackerone.com/reports/431633","title":"Order Creation Webhooks can be edited/deleted by STAFF with `Settings` only permission","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-10-31T05:43:47.855Z","submitted_at":"2018-10-31T05:43:47.855Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"h13-","url":"/h13-","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-05-11T03:25:27.533Z","bug_reporter_agreed_on_going_public_at":"2019-05-11T03:25:27.399Z","team_member_agreed_on_going_public_at":"2019-05-10T20:26:05.629Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nA STAFF with just `Settings` permission can only create 1 type of webhook called `Shop Update` as seen below.\n\n{F368739}\n\nAttempting to create a `Order Creation` webhook via burp proxy gives a 403 -Forbidden response with the message indicating that `You do not have permission to create webhooks with orders/create ` as seen below.\n\n{F368743}\n\nSo technically from the above results it means that any STAFF with just `Settings` permission is restricted to create any webhooks related to `Order` or __make modifications/deletions to Order webhooks__ created by Owner or other permitted users.\n\nFrom my testing I observed that a STAFF member with just `Settings` only permission could modify `Order` webhooks if the web-hooks were created previously by Owner or other permitted users. These Order webhooks can also be deleted by the STAFF member.\n\n__STEPS__\n\n1.Onwer assigns `Settings` only permission to STAFF.\n2.Owner creates a webhook for `Order Creation`.\n{F368756}\n{F368757}\n3.STAFF logs into Store Admin and then navigates to Settings\u003e\u003eNotifications. STAFF can see the `Order Creation` webhook which was created by Owner.\n{F368758}\n4.STAFF then clicks on the wehbook. This opens a modal box where STAFF can make modifications in he URL. STAFF then clicks on `Save Webhook`\n{F368759}\n{F368760}\nAs you can see from the above screen shot, the `Order creation` webhook was modified by STAFF.\n\n5.The STAFF can also delete a `Order Creation` webhook.\n{F368762}\n{F368763}\n\n## Impact\n\nFrom my previous report #430285, @jack_mccracken stated the below\n\n\u003eOrder notifications are restricted to staff members with the `Orders` permission.\n\nA Webhook is technically an event which is which triggered due to some activity. In this case, the event `Order Creation` webhook will trigger a notification to the specified URL in webhook. The fact that a STAFF user with just `Settings` permission isn't allowed to create a `Order Creation` webhook indicates that the STAFF must also need `Orders` permission to create it.\n\nBut from my testing, it was possible for a STAFF with just `Settings` permission to edit/delete a `Order Creation` webhook which IMO should not be authorized to the STAFF member.\n\nLet me know what you think about it.\n\nThanks.\n@h13-","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["drsniper","xnutronex","ali","eveeez","cr4xerbik4sh","tiago-danin","authprivate","cryptographer","dolph1n","armansameer","and 8 more..."],"severity":{"rating":"low","score":3.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3565949,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI was testing further on webhooks and its observed that the same kind of behavior with other Shop Webhooks related to Customer, Products, Inventory, Location , Themes etc.\n\nIf a STAFF with just `Settings` permission is not allowed to create new webhooks for Customer, Products, Inventory etc, then the STAFF should clearly must not be able to modify the already created Webhooks for these events. Its makes no sense for this allowing a STAFF with just `Settings` permission not create these webhooks but rather they are allowed to modify/delete already created webhooks.\n\nThanks,\n@h13-","automated_response":false,"created_at":"2018-10-31T19:18:22.790Z","updated_at":"2018-10-31T19:18:22.790Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3566058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the added context @h13-. I'll let you know if we need additional info. Hopefully should have a response in a day or two.","automated_response":false,"created_at":"2018-10-31T19:55:11.828Z","updated_at":"2018-10-31T19:55:11.828Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3566091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right.. Thanks for the update.\n\n@h13-","automated_response":false,"created_at":"2018-10-31T20:02:23.625Z","updated_at":"2018-10-31T20:02:23.625Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3571555,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @h13-,\nthanks again for your report. I was able to reproduce and confirm the issue. We've notified the engineering team and are triaging this in the mean time.","automated_response":false,"created_at":"2018-11-01T18:53:32.704Z","updated_at":"2018-11-01T18:53:32.704Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3571577,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks Pete :).. Have a good weekend ahead..\n\nCheers,\n@h13-","automated_response":false,"created_at":"2018-11-01T18:56:22.942Z","updated_at":"2018-11-01T18:56:22.942Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3587856,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding 500$ on triage and will determine the final amount after the issue is resolved.","automated_response":false,"created_at":"2018-11-05T16:07:54.457Z","updated_at":"2018-11-05T16:07:54.457Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"h13-","url":"/h13-"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3587932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @shopify.","automated_response":false,"created_at":"2018-11-05T16:21:41.998Z","updated_at":"2018-11-05T16:21:41.998Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4770488,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report @h13-. We recently deployed a fix for this issue and you shouldn't be able to reproduce the bug any more. However, we noticed the modal doesn't properly render the error message but we're going to resolve this since the vulnerability is addressed. On that note, we've decided that $500 is an appropriate bounty for this report since it falls under `circumvention of user permission model`, requiring a user to have the trusted permission of `Settings`. Happy hacking!","automated_response":false,"created_at":"2019-05-07T20:19:50.665Z","updated_at":"2019-05-07T20:19:50.665Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"h13-","url":"/h13-"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4770524,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-05-07T20:20:06.193Z","updated_at":"2019-05-07T20:20:06.193Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.4)","old_severity_id":232172,"new_severity_id":381045},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4776029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Pete,\n\nThanks for your response. I was verifying the fix and noticed that now `Settings` only permission staff can't edit other webhooks which he does not have permissions to like `Create Orders, Update Orders` etc. But when I reported this bug initially, I had mentioned that the limited permissions staff was able to both `update \u0026 delete` webhooks. It looks like the STAFF member can still go ahead and delete webhooks which he should not be having permissions to edit. \n\nJust wanted to be sure if that is an expected behaviour for a STAFF member with `Settings` only permission to delete webhooks which he is not able to edit/create for certain store actions.\n\nThanks,\n@h13-","automated_response":false,"created_at":"2019-05-08T05:45:27.991Z","updated_at":"2019-05-08T05:45:27.991Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4781790,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @h13-,\nthanks for flagging, sorry I didn't explicitly address that. The settings permission is meant to allow users to administer web hooks but only create / edit those which they have the necessary permissions for. As a result, it's intentional that they can delete any web hooks.\n\nThanks\nPete","automated_response":false,"created_at":"2019-05-08T13:47:41.534Z","updated_at":"2019-05-08T13:47:41.534Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4781795,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok that makes sense. Thanks for your reply Pete","automated_response":false,"created_at":"2019-05-08T13:49:20.641Z","updated_at":"2019-05-08T13:49:40.323Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4812222,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-05-10T20:26:05.677Z","updated_at":"2019-05-10T20:26:05.677Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4813796,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosed","automated_response":false,"created_at":"2019-05-11T03:25:27.424Z","updated_at":"2019-05-11T03:25:27.424Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4813797,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-11T03:25:27.553Z","updated_at":"2019-05-11T03:25:27.553Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}