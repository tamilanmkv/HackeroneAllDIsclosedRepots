{"id":434116,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzQxMTY=","url":"https://hackerone.com/reports/434116","title":"Exposing voting results on the Slowvote application without actually voting","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-11-04T21:59:36.712Z","submitted_at":"2018-11-04T21:59:36.712Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mishre","url":"/mishre","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-05T19:06:59.943Z","bug_reporter_agreed_on_going_public_at":"2018-11-05T19:06:59.889Z","team_member_agreed_on_going_public_at":"2018-11-05T18:25:45.811Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nThere is a feature on the Phabricator Slowvote application which allows creating polls and asking questions. The poll creator can choose to only allow people who voted to actually see the poll results. However, it seems that by sending an illegal vote a user can still see the poll's results.\n\n## Steps to reproduce\n1. As user1 creator a poll on the Slowvote application and make it visible for anyone and also check the \"Require a vote to see the responses\" option.\n2. As user2 browse to the poll and see that since you haven't voted you can't see the actual result.\n3. As user2 choose one of the options and vote while intercepting the request.\n4. Change the \"vote%5B%5D\" parameter to contain an illegal vote_id (usually just a big number should be enough).\n5. See that you can now see the poll's results but you didn't actually vote.\n\n## Mitigation\nYou should probably verify that the user is actually voting for a valid option.\n\n## Impact\n\nAn unauthorized user can see poll results without making a vote as required by an admin.","bounty_amount":"300.0","formatted_bounty":"$300","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-05T18:25:45.996Z","allow_singular_disclosure_after":-89930047.38602996,"singular_disclosure_allowed":true,"vote_count":11,"voters":["ali","asad0x01_","xiaoyinl","eveeez","an0nym0us","sh0a1b","cryptographer","0x08","mvpprincess","sotoayam1212","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3585247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since you can change your vote at any time and there's no record of the vote change this really pushes the boundaries of plausibility as a security issue versus a mundane bug, but I think this is at least vaguely shaped like a security issue so we'll accept it. I'll probably have a chance to get a fix in tomorrow.","automated_response":false,"created_at":"2018-11-05T00:51:41.791Z","updated_at":"2018-11-05T00:51:41.791Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed by these changes:\n\n\u003chttps://secure.phabricator.com/D19773\u003e\n\u003chttps://secure.phabricator.com/D19774\u003e\n\nThey add validation to prevent users from voting for invalid options.","automated_response":false,"created_at":"2018-11-05T18:23:35.936Z","updated_at":"2018-11-05T18:23:35.936Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588925,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Presuming this is resolved, but let us know if you catch any issues with the patches.","automated_response":false,"created_at":"2018-11-05T18:23:54.328Z","updated_at":"2018-11-05T18:23:54.328Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mishre","url":"/mishre"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588934,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"I'm awarding this report the minimum project award because the impact is incredibly low and it's really more of a bug report than a security issue.","automated_response":false,"created_at":"2018-11-05T18:25:25.882Z","updated_at":"2018-11-05T18:25:25.882Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"mishre","url":"/mishre"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588936,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The patches are public, so this can be disclosed at any time.","automated_response":false,"created_at":"2018-11-05T18:25:45.868Z","updated_at":"2018-11-05T18:25:45.868Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3589175,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-05T19:06:59.904Z","updated_at":"2018-11-05T19:06:59.904Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3589176,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-05T19:06:59.957Z","updated_at":"2018-11-05T19:06:59.957Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}