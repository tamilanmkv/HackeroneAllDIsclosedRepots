{"id":442843,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDI4NDM=","url":"https://hackerone.com/reports/442843","title":"Notifications sent due to \"Transfer report\" functionality may be sent to users who are no longer authorized to see the report","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-11-16T17:55:52.234Z","submitted_at":"2018-11-16T17:55:52.234Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"npbhatter17","url":"/npbhatter17","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-12-04T19:51:45.476Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-11-26T19:57:54.407Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Hackerone team,\n\nI am still able to access other program details etc. when i'm authenticated to HackerOne through SAML .\nI'm not sure if it's the same bug i reported earlier or there is some weak authorization check in place. PFA for more info i can access related to ██████████ etc. See the date it's 16th November .\n\nQuick Note:\nLast time when i reported the issue the H1 team decided not to reward it. https://hackerone.com/reports/438306\nHowever this time it's happening again. I can stop reaching out to H1 if they don't reward the ethical researchers who are willing to help their platform more secure.\n\nPlease consider this as a  valid finding and reward it this time .\n\n## Impact\n\nThis could be a serious issue for HackerOne since the program owners will loose trust in the service and might stop using this platform .","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-26T19:57:54.551Z","allow_singular_disclosure_after":-88110174.83236316,"singular_disclosure_allowed":true,"vote_count":19,"voters":["sameerphad72","ali","eveeez","r3y","haxta4ok00","an0nym0us","kunal94","khizer47","cyberunit","japz","and 9 more..."],"severity":{"rating":"low","score":3.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3659444,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @npbhatter17 - Thanks for bringing this to our attention! Our engineering team is evaluating the impact and making a fix as we speak. Will keep you updated!","automated_response":false,"created_at":"2018-11-16T18:42:54.501Z","updated_at":"2018-11-16T18:42:54.501Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3659563,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pei thanks for the update . Please feel free to let me know if more information needed on my side . I'm hoping this time H1 team will reward this finding . Thanks in advance .","automated_response":false,"created_at":"2018-11-16T19:09:17.459Z","updated_at":"2018-11-16T19:09:17.459Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pei any update on this? Since I don't see the other program details anymore . I had email exchange with Reed Loden regarding 'delete any copies of any information you may have retained from having access to these other program' and i confirmed it's done already . \n\nLast time my finding was not rewarded, i hope this time it's not the same case . Great job with fixing and communicating to the other program owners .","automated_response":false,"created_at":"2018-11-21T22:01:10.544Z","updated_at":"2018-11-21T22:01:10.544Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3707016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @npbhatter17 - we'll get back to you this week. Thanks for your patience!","automated_response":false,"created_at":"2018-11-26T00:41:47.555Z","updated_at":"2018-11-26T00:41:47.555Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711537,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-11-26T19:37:32.456Z","updated_at":"2018-11-26T19:37:32.456Z","additional_data":{"old_severity":"Critical","new_severity":"Low (3.4)","old_severity_id":243259,"new_severity_id":249878},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711820,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @npbhatter17 - thanks again for bringing this to our attention. The underlying issues were resolved the same day this was identified, but we waited to close this out until we had concluded our investigation and had posted a post mortem.","automated_response":false,"created_at":"2018-11-26T19:53:07.706Z","updated_at":"2018-11-26T19:53:07.706Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"npbhatter17","url":"/npbhatter17"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711905,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @npbhatter17 - we lowered the severity to Low because this only affected two reports and was amplified due to the [SAML JIT incident](/reports/438306). In all other cases, the people who had received the notifications had access to the report at some point. In that case, they'd only be able to see a report's title being changed. We don't believe that this would've leaked any (new) significant information. We'd like to thank you again for bringing this to our attention, it's much appreciated! Good luck and happy hacking!","automated_response":false,"created_at":"2018-11-26T19:54:11.298Z","updated_at":"2018-11-26T19:54:11.298Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"npbhatter17","url":"/npbhatter17"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711930,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-11-26T19:57:23.713Z","updated_at":"2018-11-26T19:57:23.713Z","additional_data":{"old_title":"Able to Access Other Program Details - ██████ etc.","new_title":"Notifications sent due to \"Transfer report\" functionality may be sent to users who are no longer authorized to see the report"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3711933,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This is ready to be disclosed. Thanks again, @npbhatter17!","automated_response":false,"created_at":"2018-11-26T19:57:54.456Z","updated_at":"2018-11-26T19:57:54.456Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3712282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Thanks for the reply and the bounty . I still think this was not a low finding . Given it's in the HackerOne platform itself. People trust H1 platform to allow researchers to share the findings and if such incident happen then H1 loose the good will . Sometime finding name is good enough to know where the underlying issue exists . I would request you to reconsider the reward amount since being an ethical researcher, i shared the info with H1 only and as Reed L. requested to delete all the info from my system ASAP, i did . Happy Thanksgiving .","automated_response":false,"created_at":"2018-11-26T21:12:57.720Z","updated_at":"2018-11-26T21:12:57.720Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3712388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @npbhatter17 - thanks for following up, it's appreciated. I don't see a compelling argument to reconsider the bounty though. Don't get me wrong, this was a good find, but the overall security impact is Low. The only reason why this became a more urgent problem, was due to the SAML JIT incident. And even in those cases, you had access to the reports (albeit you being unauthorized to do so). This issue didn't give you any new information that you didn't have access to before.","automated_response":false,"created_at":"2018-11-26T21:49:42.260Z","updated_at":"2018-11-26T21:49:42.260Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3733430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert is it OK if i write about my experience for these two findings (https://hackerone.com/reports/438306 (no reward) and https://hackerone.com/reports/442843 (500 dollars) and how H1 rewarded them?\n\n I'm sure lot of my friends (security engineers) will understand why i think this was a Critical/High bugs and not a LOW finding. I don't think a bug in the H1 platform itself is LOW risk specially when external companies like ███ etc.  are using H1 for researchers to report their finding. Those firms trust H1 as trusted 3rd party vendor. Otherwise everyone will have their own bounty platform similar to ████ . I think any finding in H1 which could lead even a fraction of information disclosure to other people which they are not allowed to see it a High risk. For example the H1 platform grey out the finding name sometime when it's public disclosed. If as a malicious user who does not have access to these finding, can read such information then it's a High risk for that program. I ","automated_response":false,"created_at":"2018-11-29T17:54:29.639Z","updated_at":"2018-11-29T23:10:40.701Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3735778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @npbhatter17 - thanks for following up. Feel free to blog about your experience! With that being said, I'd like to take a moment to reiterate both decisions.\n\n\u003e [438306](/reports/438306): **Accidental Access to Programs Information via SAML Login**\n\nAs stated in the report summary, you were not the first to identify the incident. As per our current policy, we don't award any duplicate findings, unless they've helped us uncover new information. This was not the case. I understand that this is may be frustrating, but that's policy.\n\n\u003e [442843](/reports/442843): **Notifications sent due to \"Transfer report\" functionality may be sent to users who are no longer authorized to see the report**\n\nIn your last comment, you argue the following:\n\n\u003e I think any finding in H1 which could lead even a fraction of information disclosure to other people which they are not allowed to see it a High risk.\n\nWe're in complete agreement with your statement. However, all the users who were sent information about reports due to the problem you submitted already had access to the reports at some point. You, in this case, were given access through the [SAML JIT incident](/reports/438306). This particular report sent two notifications of reports you had already access to and it's blast radius was extremely small. Of all the other notifications that were sent because of the underlying root cause were sent to people who legitimate access to the report at a given time. The lack of exploitability here, because one needed to be part of a program at some point and be subscribed to the particular report, is what made us decide to decrease the severity to low.","automated_response":false,"created_at":"2018-11-29T23:10:04.171Z","updated_at":"2018-11-29T23:10:04.171Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3762885,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"As per [our policy](/security).","automated_response":false,"created_at":"2018-12-04T19:51:45.336Z","updated_at":"2018-12-04T19:51:45.336Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3762926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks :) Will let H1 team know if i see similar issues in future. Great job once again with fixing the issue in timely manner and reaching out to program owners .","automated_response":false,"created_at":"2018-12-04T19:55:48.603Z","updated_at":"2018-12-04T19:55:48.603Z","actor":{"username":"npbhatter17","cleared":false,"url":"/npbhatter17","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11906,"category":"team","content":"# Summary\nUsers that were no longer part of a program were not unsubscribed from reports. Users may have seen an in-app notification of a report being transferred after they were no longer suppose to have access. This vulnerability was introduced on July 17, 2017.\n\n# Timeline (November 16th, all times PDT)\n\n| **Time (PST)** | **Action**                                                                                                                        |\n|----------------|-----------------------------------------------------------------------------------------------------------------------------------|\n| 9:55 AM        | Report submitted to H1 bug bounty program (this report)                                                                           |\n| 10:27 AM       | Root cause was identified                                                                                                         |\n| 10:36 AM       | Notifications that were sent for the two particular reports were deleted for all users                                            |\n| 10:52 AM       | Internal HackerOne announcement went out not to use the \"Transfer Report\" functionality for the time being                        |\n| 11:10 AM       | \"Transfer report\" feature was disabled, blocking all usage of the feature, which avoids another occurrence                        |\n| 12:06 PM       | 2110 notifications were identified (affecting 21 programs) that were sent to people who didn't have access to the reports anymore |\n| 12:13 PM       | All 2110 notifications are deleted                                                                                                |\n| 2:26 PM        | Fix was released to production to make sure subscribers are now removed when they're no longer part of a program                  |\n| 2:30 PM        | \"Transfer report\" feature was re-enabled                                                                                          |\n| 5:09 PM        | Data migration was released to clean up unauthorized subscribers                                                                  |\n| 5:13 PM        | Data migration was completed, 2.91M records deleted                                                                               |  \n\n# Root cause\nWhen a user was part of a program and they'd automatically be subscribed to incoming reports OR they'd manually subscribe, their `User` object was added to the `subscribers` relationship on a `Report` model. When they'd leave the program / be removed, this relationship wouldn't be deleted. This meant that every time we'd use the `\u003creport instance\u003e.subscribers` relationship, it may have included users who no longer had access to the `\u003creport instance\u003e`. This is what happened with the Notifications that were created when a report was transferred to another program.\n\nThis **only** affected notifications that were sent when a report was transferred to another program.\n\nThe changes that this would happen were rather slim. However, due to the [SAML JIT incident](/reports/438306), multiple people were added as subscribers to reports of other programs. We didn't clean those up, as this wasn't part of the `TeamMember::Destroy` interactor logic. When one of the affected customers of the SAML JIT incident moved one of their reports, all of the report subscribers received a notification, which included employees of other programs.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2,"username":"jobert","name":"Jobert Abma","bio":"Co-founder of HackerOne. ಠ_ಠ","cleared":true,"website":"https://hackerone.com","location":"San Francisco, CA","created_at":"2013-03-08T01:17:12.256Z","url":"https://hackerone.com/jobert","anc_triager":false,"hackerone_triager":false,"hackerone_employee":true,"hacker_resume_enabled":true,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}