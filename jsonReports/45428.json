{"id":45428,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTQyOA==","url":"https://hackerone.com/reports/45428","title":"CSRF bypass","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-01-27T19:22:38.392Z","submitted_at":"2015-01-27T19:22:38.392Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b7882330c6060c6b277c5a1","url":"/b7882330c6060c6b277c5a1","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-01-30T18:18:49.473Z","bug_reporter_agreed_on_going_public_at":"2015-01-30T00:07:53.219Z","team_member_agreed_on_going_public_at":"2015-01-30T18:18:48.788Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear Team,\r\n\r\nOnce again i'm here.\r\nDuring research of vimeo.com I found that you are using anti-csrf token against csrf attack. but it's not going to validate on server side.\r\n\r\nlet's see\r\n\r\nStep 1: go to https://vimeo.com/forgot_password\r\nStep 2: write your email and click on **help me**.\r\nStep 3: Now before posting make sure **Burp Suite's Interceptor is turned on** to capture the request.\r\n\r\nClick on \"help me\" now, you will see below kind of request in Burp suite:\r\n\r\n```\r\nPOST /forgot_password HTTP/1.1\r\nHost: vimeo.com\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:35.0) Gecko/20100101 Firefox/35.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://vimeo.com/forgot_password\r\nCookie: vuid=471411067.232973627; __utma=18302654.785580395.1421186258.1421859718.1422384189.4; __utmz=18302654.1421186258.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmv=18302654.|2=user_type=basic=1^3=ms=0=1^7=video_count=0=1; site_settings=%7B%22sticky_page%22%3Anull%7D; has_logged_in=1; __gads=ID=3eb5153d2e8ef474:T=1421187886:S=ALNI_MZ62UIUIjNjSl4kp3auNxfRHSXdnQ; stats_start_date=2015%2F01%2F10; stats_end_date=2015%2F01%2F14; __utmb=18302654.4.10.1422384189; __utmc=18302654; __utmli=forgot_form; xsrft=e9b0179d3dd45669bd6d44a2484fb0f5.0\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 79\r\n\r\nemail=shubhamgupta109.1995%40gmail.com\u0026token=e9b0179d3dd45669bd6d44a2484fb0f5.0\r\n```\r\n\r\nnow you can see you are using **anti-csrf token** there but it's not going to validate. attacker can flood user account with too many mails for password reset request.\r\n\r\nI'ave attached POC of the same.\r\nLet me know if you needed more info.\r\n\r\nBest Regard\r\nShubham","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":27951,"file_name":"POC.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/951/621e762f2c5db1fb13f30678cfcf02202b42f171/POC.gif?response-content-disposition=attachment%3B%20filename%3D%22POC.gif%22%3B%20filename%2A%3DUTF-8%27%27POC.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150154Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6f7c735e6648c3826dc0997b9820d23d087673f8f2d721c7ec17df10c0d78658","file_size":4177850,"type":"image/gif"}],"allow_singular_disclosure_at":"2015-03-01T00:07:54.778Z","allow_singular_disclosure_after":-208796039.48160896,"singular_disclosure_allowed":true,"vote_count":1,"voters":["tandav"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":319307,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Our CSRF tokens can currently be re-used. In this case we've implemented rate limiting on this page to prevent abuse.","automated_response":false,"created_at":"2015-01-27T23:01:07.117Z","updated_at":"2015-01-27T23:01:07.117Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319488,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok your csrf token can be re-used but at least you have fix that vuln. By implemented rate limiting on that page so I think you have to change status as resolved.\n\nBest Regard\nShubham","automated_response":false,"created_at":"2015-01-28T06:10:37.210Z","updated_at":"2015-01-28T06:10:37.210Z","actor":{"username":"b7882330c6060c6b277c5a1","cleared":false,"url":"/b7882330c6060c6b277c5a1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":319860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"atleast reply me on this.","automated_response":false,"created_at":"2015-01-28T18:24:26.608Z","updated_at":"2015-01-28T18:24:26.608Z","actor":{"username":"b7882330c6060c6b277c5a1","cleared":false,"url":"/b7882330c6060c6b277c5a1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure plz.","automated_response":false,"created_at":"2015-01-30T00:07:53.666Z","updated_at":"2015-01-30T00:07:53.666Z","first_to_agree":true,"actor":{"username":"b7882330c6060c6b277c5a1","cleared":false,"url":"/b7882330c6060c6b277c5a1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321390,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey Shubham, sorry I accidentally posted my response privately. I'm not marking it as resolved because it's not the original report that prompted us to add rate limiting and I like to be clear on who gets credit for what. ","automated_response":false,"created_at":"2015-01-30T18:18:48.832Z","updated_at":"2015-01-30T18:18:48.832Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":321391,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-01-30T18:18:49.509Z","updated_at":"2015-01-30T18:18:49.509Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}