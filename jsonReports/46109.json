{"id":46109,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjEwOQ==","url":"https://hackerone.com/reports/46109","title":"Brute force on \"vimeo\" cookie","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-02-02T11:55:32.777Z","submitted_at":"2015-02-02T11:55:32.777Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ba4fe4ca95021d367f8a574","url":"/ba4fe4ca95021d367f8a574","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-02-02T15:59:59.267Z","bug_reporter_agreed_on_going_public_at":"2015-02-02T15:44:31.414Z","team_member_agreed_on_going_public_at":"2015-02-02T15:59:58.270Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I took at \"vimeo\" cookie (\"Vimeo authentication token\" https://vimeo.com/cookie_list)\r\n\r\nAnd to show approximately my thought process I did :\r\n1. compare two generate values from two different sessions of mine\r\n\r\nepk9rrdskc70pcdxxmrdmdx7jpcdxxmrdmdx7%2Cpv222v2mfw90w5dcv5wtkmsfffxfsxc2tdruxmcrt\r\nepk9rrdskc70pcdxxttcrmc7jpcdxxttcrmc7%2C5jjylb%2C_fqq%2C_%2Cf85wpDanqvnh7%2Cpvds5tt9ds9trcvv2mdsf25tx02kc5kkuw9mcf2cs\r\n\r\nboth started with \"epk9rrdskc70pcdxx\" \r\n\r\n2. I have Googled part of this common string and found http://www.integernumber.com/305334256 \r\nIt had \"epk9rd\" as 305334256 in base 29\r\n\r\n3. I have played a little and saw that I can create similar strings, but not quite the one as in the cookie value\r\n\r\n4. So I decided to take the entire string (separated by \".\") and make a python script that tries if it can transform from any base (2,3,4,5,6 .100) to base 10 \r\n\r\ndef to(s, b):\r\n    \"\"\"\r\n    Converts given number s, from base b to base 10\r\n\r\n    s -- string representation of number\r\n    b -- base of given number\r\n    \"\"\"\r\n    assert(1 \u003c b \u003c 37)\r\n    return int(s, b)\r\n\r\nfor i in range(2,200):\r\n        try:\r\n                print to(\"pv222v2mfw90w5dcv5wtkmsfffxfsxc2tdruxmcrt\",i),i\r\n        except:\r\n                pass\r\n\r\n(the script tries to change base, if not tries the next value)\r\n\r\n5. Results: for two different values of \"vimeo\" cookie, I got this: (value,base)\r\n\r\nmirko@pc:~/Downloads$ python temp.py \r\n200501114734436429736082032703861533263520506562424919919 34\r\n568430180925165599882998275863273891667173461682477733127 35\r\n1564967196145999019105609819409570154363830358873721264599 36\r\nmirko@pc:~/Downloads$ vi temp.py\r\nmirko@pc:~/Downloads$ python temp.py \r\n200501114734436429736082031819180459224932196425002801149 34\r\n568430180925165599882998274329084292808031730523265871587 35\r\n1564967196145999019105609816789951113336151685719009724667 36\r\n\r\n\r\n6. So the \"vimeo\" cookie can be considered encoded in base 34,35 or 36 and the decoded value is similar to other values from my other sessions\r\n\r\n7. This means that the cookie value can be guessed and an attack can go like this:\r\n\r\nAttacker generates for months cookie values (1 per second I don't think triggers any firewall for example) and finally gets to some account. (the other substring of the vimeo cookie is generated the same)\r\n\r\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-03-04T15:44:32.176Z","allow_singular_disclosure_after":-208480675.20108327,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":322599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For example if we compare in base36 two values:\n1564967196145999019105609816789951113336151685719009724667\n1564967196145999019105609819409570154363830358873721264599\n\nI this is a good enough lead and some attacker can continue reducing the complexity\n","automated_response":false,"created_at":"2015-02-02T12:00:43.069Z","updated_at":"2015-02-02T12:00:43.069Z","actor":{"username":"ba4fe4ca95021d367f8a574","cleared":false,"url":"/ba4fe4ca95021d367f8a574","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322656,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I like the work you put into this, but I'm afraid these aren't valid cookie values you've decoded too. For one thing, we encode more than just numbers in there.","automated_response":false,"created_at":"2015-02-02T15:41:42.116Z","updated_at":"2015-02-02T15:41:42.116Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322660,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-02-02T15:44:31.457Z","updated_at":"2015-02-02T15:44:31.457Z","first_to_agree":true,"actor":{"username":"ba4fe4ca95021d367f8a574","cleared":false,"url":"/ba4fe4ca95021d367f8a574","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322675,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-02-02T15:59:58.308Z","updated_at":"2015-02-02T15:59:58.308Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322676,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-02-02T15:59:59.304Z","updated_at":"2015-02-02T15:59:59.304Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":323000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok, I admit the values are different from what you initially constructed. but it doesn't need to be the actual value. it needs to be a range with a variation low enough to cause a brute force attack. ","automated_response":false,"created_at":"2015-02-02T21:10:49.991Z","updated_at":"2015-02-02T21:10:49.991Z","actor":{"username":"ba4fe4ca95021d367f8a574","cleared":false,"url":"/ba4fe4ca95021d367f8a574","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}