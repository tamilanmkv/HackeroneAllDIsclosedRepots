{"id":46312,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjMxMg==","url":"https://hackerone.com/reports/46312","title":"In markdown, parsing things like @danlec and #46072 after links is unsafe","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-03T15:18:26.640Z","submitted_at":"2015-02-03T15:18:26.640Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"danlec","url":"/danlec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-07-04T19:12:43.228Z","bug_reporter_agreed_on_going_public_at":"2015-07-04T19:12:42.380Z","team_member_agreed_on_going_public_at":"2015-06-10T05:18:52.887Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"(Let me preface this by saying that I haven't worked out an actual exploit for this, and there may not be one, but when #46072 is disclosed, folks will probably be taking a closer look at HackerOne's markdown parsing and may find a way to turn this bug into something)\r\n\r\nIt looks like the links for things like @danlec and #46072 are being added to the HTML after the initial markdown is processed; this leads to situations where links end up malformed because link markup is being added in an unexpected place (inside the attribute values of existing links)\r\n\r\nFor example:\r\n\r\n```\r\n[text](http://danlec.com \" @danlec \")\r\n```\r\n\r\nrenders as\r\n\r\n[text](http://danlec.com \" @danlec \")\r\n\r\ni.e.\r\n\r\n```\r\n\u003cp\u003e\u003ca title=\" \u003ca href=\" danlec\"=\"\"\u003e@danlec\u003c/a\u003e \" href=\"http://danlec.com\"\u0026gt;text\u003c/p\u003e\r\n```\r\n\r\nAs you can see, there's an unexpected `danlec\"` attribute on the link tag.\r\n\r\nThe same kind of issue exists for references to other submissions, e.g.\r\n\r\n```\r\n[text](http://danlec.com \" #46072 \")\r\n```\r\n\r\nrenders as \r\n\r\n[text](http://danlec.com \" #46072 \")\r\n\r\n```\r\n\u003cp\u003e\u003ca title=\" \u003ca href=\" reports=\"\" 46072\"=\"\"\u003e#46072\u003c/a\u003e \" href=\"http://danlec.com\"\u0026gt;text\u003c/p\u003e\r\n```\r\n\r\n… with an  unexpected `reports` and `46072\"` attribute\r\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-10T05:18:53.739Z","allow_singular_disclosure_after":-197459021.87171268,"singular_disclosure_allowed":true,"vote_count":5,"voters":["dirk","ali","r3y","japz","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":323599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is also why @danlec gets linkified in a code block context, e.g. `foo @danlec `; the replacement isn't aware of the context that it's replacing into.\n\nI know these kinds of things are a pain to fix because you have to make the @ and # linkification part of the full markdown parsing, instead of being able to do a simple regex string replace.","automated_response":false,"created_at":"2015-02-03T16:27:26.597Z","updated_at":"2015-02-03T16:27:26.597Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":324869,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @danlec,\n\nI've looked into this, and although it appears there is no vulnerability here, I agree that the output is.. ugly, to say the least. \n\nI'm currently working on improving this situation, and I'll keep you posted!","automated_response":false,"created_at":"2015-02-04T16:59:36.703Z","updated_at":"2015-02-04T16:59:36.703Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":326637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @danlec,\n\nWe've moved our implementation of automatic linking to a preprocessing step, instead of the postprocessing. As you can see, this still has its quirks (e.g. `@danlec` with a space between the backtick and the @ becomes ` @danlec`), however this is something we're willing to live with. \n\nI've racked my brain (and our code) trying to get some attack string that would impact our service, but with the quite limited input-space, and the sheer malformed-ness of the produced html, I haven't been able to figure out an attack vector. \n\nCould you confirm that the issue is fixed? \n\n  ","automated_response":false,"created_at":"2015-02-06T09:15:28.779Z","updated_at":"2015-02-06T09:15:28.779Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":326722,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dirk … this appears to address the issue I was seeing.  \n\nI'll keep poking at it, but I certainly wouldn't be surprised if there really wasn't anything bad you could do with that bug.","automated_response":false,"created_at":"2015-02-06T13:25:37.509Z","updated_at":"2015-02-06T13:25:37.509Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":326943,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I hope the fix for this wasn't the cause of #46916\t…\n","automated_response":false,"created_at":"2015-02-06T18:18:35.793Z","updated_at":"2015-02-06T18:18:35.793Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":327059,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not related, fortunately. :)","automated_response":false,"created_at":"2015-02-06T19:46:55.259Z","updated_at":"2015-02-06T19:46:55.259Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":328213,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @danlec,\n\nWe have resolved the issue, but we haven't been able to find any security implications related to this bug, which means the bug is ineligible for a bounty. \n\nThank you for reporting this bug, and helping us build a more hardened platform!\n\nCheers, Dirk","automated_response":false,"created_at":"2015-02-09T11:03:01.809Z","updated_at":"2015-02-09T11:03:01.809Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"danlec","url":"/danlec"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":328214,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-02-09T11:03:15.092Z","updated_at":"2015-02-09T11:03:15.092Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":330083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it okay to disclose this issue in a blogpost I write regarding #46916? (I'm assuming you'll be requesting disclosure of #46916)","automated_response":false,"created_at":"2015-02-11T13:57:57.577Z","updated_at":"2015-02-11T13:57:57.577Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":330158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Complete resolution of #46919 is currently pending a fix in a related library. We've resolved the vulnerability on H1 but a number of other sites are impacted by closely related behavior. Would appreciate holding disclosure until we wrap up coordinating a full fix with the library developer and the other impacted sites. (we'll gladly request disclosure on both issues)\n\nThanks @danlec! ","automated_response":false,"created_at":"2015-02-11T16:59:06.819Z","updated_at":"2015-02-11T16:59:06.819Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":330174,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh, definitely.  Any blogpost would be **after** you request disclosure of #46916 … I was just going to start writing it now and was curious if I could include other issues that I'd found along the way to that one.  (e.g. this one and #46952, although that one was effectively disclosed already via a github issue)","automated_response":false,"created_at":"2015-02-11T17:31:56.782Z","updated_at":"2015-02-11T17:33:18.965Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448694,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-10T05:18:52.974Z","updated_at":"2015-06-10T05:18:52.974Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":499624,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-07-04T19:12:42.444Z","updated_at":"2015-07-04T19:12:42.444Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":499625,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-07-04T19:12:43.255Z","updated_at":"2015-07-04T19:12:43.255Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}