{"id":463286,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjMyODY=","url":"https://hackerone.com/reports/463286","title":"Specially Crafted Closed Captions File can lead to Remote Code Execution in CS:GO and other Source Games","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-12-15T20:54:59.683Z","submitted_at":"2018-12-15T20:54:59.683Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gamer7112","url":"/gamer7112","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-05-05T00:45:09.688Z","bug_reporter_agreed_on_going_public_at":"2021-05-04T01:00:02.170Z","team_member_agreed_on_going_public_at":"2021-05-05T00:45:09.418Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"7500.0","formatted_bounty":"$7,500","weakness":{"id":3,"name":"Classic Buffer Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":103,"voters":["drvivanco","nekz","njbooher","battle_angel","drsniper","gamer7112","mvc","gatolouco","romesful","fe7ch","and 93 more..."],"severity":{"rating":"critical","score":9.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":1286,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"csgo.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3836495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2018-12-17T07:07:24.190Z","updated_at":"2018-12-17T07:07:24.190Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3963112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-11T21:09:46.085Z","updated_at":"2019-01-11T21:09:46.085Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4009650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-21T05:17:03.666Z","updated_at":"2019-01-21T05:17:03.666Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4010903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-21T09:47:52.896Z","updated_at":"2019-01-21T09:47:52.896Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4057807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-29T09:28:54.191Z","updated_at":"2019-01-29T09:28:54.191Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4068701,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-01-31T05:37:41.313Z","updated_at":"2019-01-31T05:37:41.313Z","actor":{"username":"fidgetspinner","cleared":false,"url":"/fidgetspinner","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/239/770/3f9a1c9fcbb39dc86cab06aed16dda92753a5eee_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4133400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-02-12T03:08:14.067Z","updated_at":"2019-02-12T03:08:14.067Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4182549,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-02-20T20:52:52.304Z","updated_at":"2019-02-20T20:52:52.304Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4249980,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-03-04T05:56:29.252Z","updated_at":"2019-03-04T05:56:29.252Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5803453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-09-13T23:07:05.501Z","updated_at":"2019-09-13T23:07:05.501Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5928597,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-10-01T09:50:32.001Z","updated_at":"2019-10-01T09:50:32.001Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6673785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-01-02T14:43:22.229Z","updated_at":"2020-01-02T14:43:22.229Z","actor":{"username":"magicmouse","cleared":false,"url":"/magicmouse","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7koyrfQNuacHWmAt2BWtP73b/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7385250,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-03-21T14:19:35.749Z","updated_at":"2020-03-21T14:19:35.749Z","additional_data":{},"actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7385251,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-03-21T14:19:38.873Z","updated_at":"2020-03-21T14:19:38.873Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11558113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-04-29T01:36:04.124Z","updated_at":"2021-04-29T01:36:04.124Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11569937,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-04-29T19:56:39.060Z","updated_at":"2021-04-29T19:56:39.060Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":11584806,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-04-30T23:17:19.238Z","updated_at":"2021-04-30T23:17:19.238Z","actor":{"username":"mcjohn","cleared":false,"url":"/mcjohn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"gamer7112","url":"/gamer7112"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11594175,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-05-03T00:58:58.312Z","updated_at":"2021-05-03T00:58:58.312Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11605905,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2021-05-04T00:42:26.157Z","updated_at":"2021-05-04T00:42:26.157Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Valve"}},"bounty_amount":"7500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"gamer7112","url":"/gamer7112"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11606112,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-04T01:00:02.229Z","updated_at":"2021-05-04T01:00:02.229Z","first_to_agree":true,"actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11620030,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-05T00:45:09.458Z","updated_at":"2021-05-05T00:45:09.458Z","actor":{"username":"mcjohn","cleared":false,"url":"/mcjohn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11620031,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-05T00:45:10.076Z","updated_at":"2021-05-05T00:45:10.076Z","actor":{"username":"mcjohn","cleared":false,"url":"/mcjohn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":48107,"category":"team","content":"With a specially crafted closed captions file, the parser calls CHudCloseCaption::GetNoRepeatValue which in turn calls CHudCloseCaption::SplitCommand which has no boundary checks allowing the on stack variables cmd and args to be overflowed which in turn allows Remote Code Execution.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":300268,"username":"mcjohn","name":"mcjohn","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2018-06-30T00:26:54.841Z","url":"https://hackerone.com/mcjohn","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"legacy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":48108,"category":"researcher","content":"Buffer overflow via the closed captioning system in the function `CHudCloseCaption::SplitCommand` which can be reached via the function `CHudCloseCaption::GetNoRepeatValue`\n```cpp\nbool CHudCloseCaption::GetNoRepeatValue( const wchar_t *caption, float \u0026retval )\n{\n\tretval = 0.0f;\n\tconst wchar_t *curpos = caption;\n\t\n\tfor ( ; curpos \u0026\u0026 *curpos != L'\\0'; ++curpos )\n\t{\n\t\twchar_t cmd[ 256 ];\n\t\twchar_t args[ 256 ];\n\n\t\tif ( SplitCommand( \u0026curpos, cmd, args ) )//Vulnerable call\n\t\t{\n\t\t\tif ( !wcscmp( cmd, L\"norepeat\" ) )\n\t\t\t{\n\t\t\t\tretval = (float)wcstod( args, NULL );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t}\n\treturn false;\n}\n\nbool CHudCloseCaption::SplitCommand( wchar_t const **ppIn, wchar_t *cmd, wchar_t *args ) const\n{\n\tconst wchar_t *in = *ppIn;\n\tconst wchar_t *oldin = in;\n\n\tif ( in[0] != L'\u003c' )\n\t{\n\t\t*ppIn += ( oldin - in );\n\t\treturn false;\n\t}\n\n\targs[ 0 ] = 0;\n\tcmd[ 0 ]= 0;\n\twchar_t *out = cmd;\n\tin++;\n\twhile ( *in != L'\\0' \u0026\u0026 *in != L':' \u0026\u0026 *in != L'\u003e' \u0026\u0026 !V_isspace( *in ) )\n\t{\n\t\t*out++ = *in++;//Vulnerable overflow\n\t}\n\t*out = L'\\0';\n\n\tif ( *in != L':' )\n\t{\n\t\t*ppIn += ( in - oldin );\n\t\treturn true;\n\t}\n\n\tin++;\n\tout = args;\n\twhile ( *in != L'\\0' \u0026\u0026 *in != L'\u003e' )\n\t{\n\t\t*out++ = *in++;//Vulnerable overflow\n\t}\n\t*out = L'\\0';\n\n\t//if ( *in == L'\u003e' )\n\t//\tin++;\n\n\t*ppIn += ( in - oldin );\n\treturn true;\n}\n```\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":328138,"username":"gamer7112","name":"Gamer7112","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-08-12T05:42:58.793Z","url":"https://hackerone.com/gamer7112","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}