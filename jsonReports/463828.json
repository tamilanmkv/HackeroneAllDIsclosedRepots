{"id":463828,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjM4Mjg=","url":"https://hackerone.com/reports/463828","title":"Submitting report through Embedded Submission form gives user indefinite access to a profile","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-12-17T13:12:53.576Z","submitted_at":"2018-12-17T13:12:53.576Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haxta4ok00","url":"/haxta4ok00","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-01-03T10:01:02.311Z","bug_reporter_agreed_on_going_public_at":"2019-01-03T10:01:02.235Z","team_member_agreed_on_going_public_at":"2019-01-03T09:53:10.060Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHi team, @jobert , @ben\n\nAfter testing on the sandbox, I noticed that one of my accounts(which I removed from the program) can see some of the information. I don't know if it affects other programs that have other States - `private-only`, `private-only` whit external link.  I could not find the uuid of any of these programs, perhaps you could help me with this (`Give me uuid of one of the programs :)`)? or check it yourself\n\n\n**Description:**\nAfter sending the report, and exit the program, we can continue to see the main page of the program.\nI can't fully imagine the situation here, as it was done on the sandbox and the account that was team_member\n\nIf you can help me figure it out, I'll be happy. I think that it will work for ordinary users as well. After sending such a report, we will be able to see the main page of the program, which we do not have access to\n\n\n### Steps To Reproduce\n\nMy PoC for report\n\n1. Create sandbox program\n2. Invite any user ( my 2 account - █████████)\n3. Admin create embedded_submissions link for program\n4. 2 account create report for /embedded_submissions link\n\nMy link - ██████████\n\n5. Next we leaved the program , or admin kick(delete) 2 account\n████████\n\n6. Check the page with the second account\n█████████\n\n7. We are will be see main page info.\n\nI think it's a bit like this report #386997\n\n### Optional: Did you use recon data made available by HackerOne to find this vulnerability?\n\nno\n\nI understand the complexity of the operation here, but also, I understand that if it works for the average user and the program is not public, then the seriousness will increase. But unfortunately I can't verify that. I barely found this connection . I created a report in support when I didn't see the connection, but now I can find it. So you can close that report -- https://support.hackerone.com/hc/en-us/requests/256487\n\n***I want to ask you to check the connection of the steps***\n\n1) Create embedded_submissions report for external program whit private page\n2) Create embedded_submissions report for external program whitout private page\n3) Create embedded_submissions report in a private program (located in it), after leaving it, and check whether we will see the main page\n\n\nAnd at the end check whether the user will see the program page\n\nIf it turns out to be invalid, please give me a chance to close the report myself.\n\nSorry i bad speak english\nI hope you understand me\nThank you,haxta4ok00\n\n## Impact\n\nViewing information of the program, after leaving her","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-02-02T09:53:10.120Z","allow_singular_disclosure_after":-84863373.79181124,"singular_disclosure_allowed":true,"vote_count":26,"voters":["mashoud1122","hunter","base_64","bl4de","sameerphad72","spam404","mik317","dhakal_ananda","ms-13","mhamed_kchikech","and 16 more..."],"severity":{"rating":"low","score":3.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3838714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"oops, one more image\n██████████","automated_response":false,"created_at":"2018-12-17T13:48:59.285Z","updated_at":"2019-01-03T09:50:23.134Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3898011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team-- I found a link on the Internet for this report. I took second account for test\n\n1) Program █████████ - private program `\"state\":\"soft_launched\"`\n██████████\n2) I found `embedded_submissions` link\n███\n3) After create report i can see him program (use second account)\n██████\n4) Try open program ████\n██████\n5) I see inscripted - `████ is only visible to invited hackers.` , But i am not invited.\n████████\n\n***Impact***\n\n* After creating such a report, we see statics the program.\n\n\u003e3) Create embedded_submissions report in a private program (located in it), after leaving it, and check whether we will see the main page\n* I think if I were invited to this program, and then deleted after creating the report, I could also see the program.\n(by analogy #386997 #387099)\n\nThanks! @haxta4ok00 ","automated_response":false,"created_at":"2018-12-27T22:42:49.116Z","updated_at":"2019-01-03T09:51:07.426Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3900960,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-12-28T14:50:58.582Z","updated_at":"2018-12-28T14:50:58.582Z","additional_data":{"old_severity":null,"new_severity":"Low (3.8)","old_severity_id":null,"new_severity_id":272668},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900961,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-12-28T14:51:36.958Z","updated_at":"2018-12-28T14:51:36.958Z","additional_data":{"old_title":"Embedded_submissions has an authorization error after submitting the report to the program","new_title":"Submitting report through Embedded Submission form gives user indefinite access to a profile"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900962,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2018-12-28T14:51:50.487Z","updated_at":"2018-12-28T14:51:50.487Z","additional_data":{"added_weaknesses":[{"id":65,"name":"Business Logic Errors"}],"removed_weaknesses":[]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900969,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @haxta4ok00 - thanks for your report and your patience! We discussed this internally and decided to prioritize a fix for this. When a user has access to a valid Embedded Submission UUID, they're always allowed to query information about the program. However, in case the user submitted a report using the Embedded Submission form, and the form would be deleted or disabled, they wouldn't have access to the information anymore. A minor discrepancy in the GraphQL ACL and viewing the profile allows an attacker to continue to view the policy, even though the UUID isn't valid anymore. We'll address this so that the user won't have access to the profile itself, even when they've submitted a report through the form. We'll keep you posted throughout the process. Thanks!","automated_response":false,"created_at":"2018-12-28T14:55:03.006Z","updated_at":"2018-12-28T14:55:03.006Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3900992,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert -- Thanks for the answer. Can you please check #410015 . Thanks!","automated_response":false,"created_at":"2018-12-28T15:03:52.377Z","updated_at":"2018-12-28T15:03:52.377Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3919103,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @haxta4ok00 - thanks again for bringing this to our attention! We've pushes a fix for the underlying problem you reported to us. A couple weeks ago a change was made to the ACLs that allowed a user to view a program's profile when they **ever** submitted a report to a program through an embedded submission form. This didn't look an issue at first sight, because the same information is disclosed through the GraphQL endpoint when you provide an embedded submission form UUID. However, the difference was that the ACL granted someone access, even when the submission form was deleted, whereas the information was not disclosed anymore through GraphQL when it was deleted. We've fixed this by not allowing someone to view the program's profile anymore when they have submitted a report through an embedded submission form. Good luck and happy hacking!","automated_response":false,"created_at":"2019-01-03T09:45:00.842Z","updated_at":"2019-01-03T09:45:00.842Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"haxta4ok00","url":"/haxta4ok00"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3919105,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-01-03T09:45:48.185Z","updated_at":"2019-01-03T09:45:48.185Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"haxta4ok00","url":"/haxta4ok00"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3919125,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-03T09:53:10.086Z","updated_at":"2019-01-03T09:53:10.086Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3919150,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert -- Thank you for the bounty! Looks like is fixed.\n","automated_response":false,"created_at":"2019-01-03T10:00:54.184Z","updated_at":"2019-01-03T10:00:54.184Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3919152,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-03T10:01:02.257Z","updated_at":"2019-01-03T10:01:02.257Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3919153,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-01-03T10:01:02.332Z","updated_at":"2019-01-03T10:01:02.332Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}