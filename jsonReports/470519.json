{"id":470519,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzA1MTk=","url":"https://hackerone.com/reports/470519","title":"Kaspersky Protection extension for Google Chrome is vulnerable to abuse its features","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-21T08:50:01.669Z","submitted_at":"2018-12-21T08:50:01.669Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"palant","url":"/palant","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2379,"url":"https://hackerone.com/kaspersky","handle":"kaspersky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kaspersky","twitter_handle":"kaspersky","website":"http://www.kaspersky.com","about":"Kaspersky is the worldâ€™s largest privately-held vendor of endpoint protection and cybersecurity solutions for business and consumers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15684"],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-25T12:45:30.788Z","bug_reporter_agreed_on_going_public_at":"2019-10-27T12:25:52.755Z","team_member_agreed_on_going_public_at":"2019-11-25T12:45:30.698Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\nThe Google Chrome extension \"Kaspersky Protection\" (installed automatically by Kaspersky Internet Security) can be tricked by arbitrary websites into uninstalling browser extensions.\n\n**Description**\nKaspersky Protection for Google Chrome has some functionality to uninstall malicious browser extensions. The uninstallation is triggered by the warning page. Since that page is marked as web accessible, any website can load this frame. Also, the page receives its data (including the extension to be uninstalled) via a regular `postMessage()` call and doesn't check message origin - any website can send this.\n\nThis issue is somewhat alleviated by the fact that recent Chrome versions will no longer allow extension-triggered uninstalls without an additional user confirmation. So the browser will display an additional prompt. Uninstalling the Kaspersky Protection extension itself doesn't produce such a prompt however.\n\n**Environment**\n- Scope: Application\n- Product name: Kaspersky Internet Security\n- Product version: 19.0.0.1088\n- OS name and version (incl SP): Windows 10.0.17134\n- Attack type: Command injection\n- Maximum user privileges needed to reproduce your issue: no privileges\n\n**Steps to reproduce**\nFirst uninstalling Adblock Plus extension:\n\n1. Make sure that Kaspersky Protect extension is enabled in Chrome.\n2. Make sure to install Adblock Plus in Chrome from https://chrome.google.com/webstore/detail/adblock-plus/cfhdojbkjhnklbpkdaibdccddilifddb.\n3. Download the attached `remove_extension.html` file and open it in Chrome (opening from local filesystem will work).\n4. Move your mouse and click somewhere on the page.\n\nNote how the browser displays a prompt to remove Adblock Plus, noting that the removal was requested by Kaspersky Protect. Despite the prompt being very clear, there is potential for social engineering here, e.g. if the page claims that Kaspersky detected a malicious extension.\n\nNow uninstalling Kaspersky Protect extension itself:\n\n1. Make sure that Kaspersky Protect extension is enabled in Chrome.\n2. Download the attached `remove_self.html` file and open it in Chrome (opening from local filesystem will work).\n3. Move your mouse and click somewhere on the page.\n\nNote how Kaspersky Protect extension is completely gone, and with it any protection it provided. For non-technical users, there is no way to recover: Chrome will no longer offer you to install the extension unless you create a new browser profile. And while the extension is in Chrome Web Store, it is unlisted and cannot be found through search.\n\n## Impact\n\nArbitrary websites can make Kaspersky Protect extension uninstall itself. They can also trigger uninstallation of other browser extensions but have to rely on social engineering for the user to confirm the uninstall prompt.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-26T12:25:52.805Z","allow_singular_disclosure_after":-59193436.83304606,"singular_disclosure_allowed":true,"vote_count":21,"voters":["sameerphad72","dhakal_ananda","imranhudaa","eveeez","what_web","adamgreer","cryptographer","achaayb","matthewdockerty","caustik","and 11 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3875988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Wladimir.\n\nIt is confirmed. Stay tuned for the following update.","automated_response":false,"created_at":"2018-12-21T11:38:51.215Z","updated_at":"2018-12-21T11:38:51.215Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3875991,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-12-21T11:39:06.500Z","updated_at":"2018-12-21T11:39:06.500Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3886637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability will be fixed and we are planning a specific timeline for the fix. A payout is envisaged.","automated_response":false,"created_at":"2018-12-24T14:43:29.892Z","updated_at":"2018-12-24T14:54:18.336Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3922162,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Dear Palant, \nWe would like to thank you for this report. Your help is appreciated for us.\nYour research and your reports will allow to make our products better.\nWe have decided to award you a bounty for your contribution to kaspersky labs product security.\nThank you.","automated_response":false,"created_at":"2019-01-03T22:18:06.799Z","updated_at":"2019-01-03T22:18:06.799Z","actor":{"url":"/kaspersky","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kaspersky"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kaspersky","collaborator":{"username":"palant","url":"/palant"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4661765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So what's the timeline? I just verified that this issue is still present in the latest version.","automated_response":false,"created_at":"2019-04-29T13:44:56.534Z","updated_at":"2019-04-29T13:44:56.534Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4662272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think a fix for this vulnerability will be rolled out in July with commercial release of KIS 2020, it's about July this year.","automated_response":false,"created_at":"2019-04-29T15:18:23.947Z","updated_at":"2019-04-29T15:18:23.947Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455531,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"KIS 2020 is available.\n\nhttps://www.kaspersky.com/internet-security","automated_response":false,"created_at":"2019-07-29T17:01:42.937Z","updated_at":"2019-07-29T17:01:42.937Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"palant","url":"/palant"},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455810,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-29T17:52:45.693Z","updated_at":"2019-07-29T17:52:45.693Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5502141,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Hi Wladimir.\n\nWe can't allow you to disclose this report, because users of earlier versions of the product are still vulnerable.","automated_response":false,"created_at":"2019-08-05T12:14:18.806Z","updated_at":"2019-08-05T12:14:18.806Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5607109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is no definitive disclosure timeline here, so I'll publish an article on these vulnerabilities on 2019-11-25 along with the three vulnerabilities I just sent to vulnerability@kaspersky.com.","automated_response":false,"created_at":"2019-08-19T13:21:27.292Z","updated_at":"2019-08-19T13:21:27.292Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6147910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting disclosure as I will be publishing an article on this vulnerability on 2019-11-27.","automated_response":false,"created_at":"2019-10-27T12:25:52.769Z","updated_at":"2019-10-27T12:25:52.769Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6398212,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2019-11-25T12:44:43.085Z","updated_at":"2019-11-25T12:44:43.085Z","cve_ids":["CVE-2019-15684"],"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6398220,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"https://support.kaspersky.com/general/vulnerability.aspx?el=12430#251119_1\nhttps://www.kaspersky.com/blog/kaspersky-products-fixed/31475/","automated_response":false,"created_at":"2019-11-25T12:45:30.716Z","updated_at":"2019-11-25T12:45:30.716Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6398221,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-11-25T12:45:30.808Z","updated_at":"2019-11-25T12:45:30.808Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6438533,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-11-30T17:31:49.745Z","updated_at":"2019-11-30T17:31:49.745Z","additional_data":{"old_title":"Chrome extension: Websites can uninstall browser extensions","new_title":"Kaspersky Protection extension for Google Chrome is vulnerable to abuse its features"},"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}