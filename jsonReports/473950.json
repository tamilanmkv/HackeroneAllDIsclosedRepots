{"id":473950,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzM5NTA=","url":"https://hackerone.com/reports/473950","title":"XSS on Desktop Client","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-01-02T10:50:30.183Z","submitted_at":"2019-01-02T10:50:30.183Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"u3mur4","url":"/u3mur4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/449/470/1f5148d87050c9c48970956ff5160260dcd451c2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-16T12:47:58.726Z","bug_reporter_agreed_on_going_public_at":"2019-10-16T12:28:26.513Z","team_member_agreed_on_going_public_at":"2019-10-16T12:47:58.642Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Steps to reproduce\n\n1. Create a file named as `')*alert(1)*v.SS('.mp4` in the keybase public/private folder.\n2. On the desktop client open the file as a preview.\n3. An alert box pops up.\n\ngif poc:\n{F399836}\n\n# The Problem\n\nThe [client/shared/fs/filepreview/av-view.desktop.js](https://github.com/keybase/client/blob/master/shared/fs/filepreview/av-view.desktop.js#L46-L54) file contains a template literal with the expression `${url}`.\n```go\nconst webviewJavaScript = url =\u003e `\nconst v = document.createElement(\"video\")\nv.setAttribute('loop', true)\nv.setAttribute('controls', true)\nv.setAttribute('controlsList', 'nodownload nofullscreen')\nv.setAttribute('src', '${url}')\ndocument.getElementsByTagName('body')[0].appendChild(v)\nv.play()\n```\nThe url format is: `http://127.0.0.1:16723/files/public/u3mur4/vid.mp4?token=28d4356e6d3348d5b3cde2618df13324`. We can manipulate the filename part of the url, therefore the javascript code.\n\n## Impact\n\nlimited loss of confidentiality and integrity","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":399836,"file_name":"poc.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/399/836/7cb85faf7c58d9c2ec28b519afc01a5445bbc754/poc.gif?response-content-disposition=attachment%3B%20filename%3D%22poc.gif%22%3B%20filename%2A%3DUTF-8%27%27poc.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150345Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9785faa81eafeda7cf89fcf67a19db7fc58c8fc6e8df4560d2d5ffc76d709f1b","file_size":334481,"type":"image/gif"}],"allow_singular_disclosure_at":null,"vote_count":173,"voters":["mirchr","thaivu","base_64","th4nu_0x0","lemonoftroy","sameerphad72","v0lck3r","s_p_q_r","mik317","arsene_lupin","and 163 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3917592,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-02T21:31:19.968Z","updated_at":"2019-01-02T21:31:19.968Z","additional_data":{"old_severity":"Medium (5.4)","new_severity":"Low","old_severity_id":273914,"new_severity_id":274218},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3917596,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. We marked it low since it's not wormable, and the Electron sandbox saves us from further infection.","automated_response":false,"created_at":"2019-01-02T21:31:43.539Z","updated_at":"2019-01-02T21:31:43.539Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3917724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's okay. I just followed the CVSS calculator.","automated_response":false,"created_at":"2019-01-02T22:10:07.813Z","updated_at":"2019-01-02T22:10:07.813Z","actor":{"username":"u3mur4","cleared":false,"url":"/u3mur4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/449/470/1f5148d87050c9c48970956ff5160260dcd451c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3917729,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok I will recompute it to double check. Thank you. ","automated_response":false,"created_at":"2019-01-02T22:11:05.393Z","updated_at":"2019-01-02T22:11:05.393Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3917810,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-02T22:39:45.136Z","updated_at":"2019-01-02T22:39:45.136Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":274218,"new_severity_id":274233},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3917814,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-02T22:40:26.934Z","updated_at":"2019-01-02T22:40:26.934Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.4)","old_severity_id":274233,"new_severity_id":274234},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3917817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, you are right!","automated_response":false,"created_at":"2019-01-02T22:40:55.952Z","updated_at":"2019-01-02T22:40:55.952Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3923221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Should be fixed in our 2.12.6 release, can you confirm? Many thanks.","automated_response":false,"created_at":"2019-01-04T03:58:42.902Z","updated_at":"2019-01-04T03:58:42.902Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3923504,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Look's Fixed.","automated_response":false,"created_at":"2019-01-04T07:19:19.373Z","updated_at":"2019-01-04T07:19:19.373Z","actor":{"username":"u3mur4","cleared":false,"url":"/u3mur4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/449/470/1f5148d87050c9c48970956ff5160260dcd451c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3925631,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-01-04T16:53:03.579Z","updated_at":"2019-01-04T16:53:03.579Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"u3mur4","url":"/u3mur4"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3925633,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-01-04T16:53:21.896Z","updated_at":"2019-01-04T16:53:21.896Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Keybase"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"u3mur4","url":"/u3mur4"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3925683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","automated_response":false,"created_at":"2019-01-04T17:03:50.484Z","updated_at":"2019-01-04T17:03:50.484Z","actor":{"username":"u3mur4","cleared":false,"url":"/u3mur4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/449/470/1f5148d87050c9c48970956ff5160260dcd451c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6054578,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-16T12:28:26.529Z","updated_at":"2019-10-16T12:28:26.529Z","first_to_agree":true,"actor":{"username":"u3mur4","cleared":false,"url":"/u3mur4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/449/470/1f5148d87050c9c48970956ff5160260dcd451c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6054693,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-16T12:47:58.661Z","updated_at":"2019-10-16T12:47:58.661Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6054694,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-16T12:47:58.739Z","updated_at":"2019-10-16T12:47:58.739Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}