{"id":47536,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzUzNg==","url":"https://hackerone.com/reports/47536","title":"[ishop.qiwi.com] XSS + Misconfiguration","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-12T13:09:49.842Z","submitted_at":"2015-02-12T13:09:49.842Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kxyry","url":"/kxyry","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/463/78e78b6f89306f60a89b97ce1f44ea4fc2595ce8_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-31T08:40:13.734Z","bug_reporter_agreed_on_going_public_at":"2015-08-30T12:12:18.626Z","team_member_agreed_on_going_public_at":"2015-08-31T08:40:13.351Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Хост - ishop.qiwi.com\r\nТип - XSS\r\n\r\nКак воспроизвести\r\n\r\n1) Регистрируем новый магазин с именем \"\u003e\u003cscript\u003e наш код  \u003c/script\u003e\r\nhttp://puu.sh/fOHix/537dacd4cc.png\r\n\r\nhttp://puu.sh/fOHl5/a287e79250.png\r\n\r\nhttp://puu.sh/fOHoJ/0ec66e9f4d.png\r\n\r\n2) Привязываем номер телефона\r\n\r\nhttp://puu.sh/fOHxf/d52b555777.png\r\n\r\n3) Страница сообщает нам что наш номер не идентифицирован\r\n\r\nhttp://puu.sh/fOIT7/da678d5d09.png\r\n\r\n4) Но зная url переходил по ссылке  - misconfiguration\r\n\r\nhttps://ishop.qiwi.com/pays/transfer.action\r\n\r\nполучаем выполнение произвольного javascript кода \r\n\r\nhttp://puu.sh/fOHEv/32c04be367.png\r\n \r\nРекомендации по устранению\r\n\r\nфильтрация специальных символов \" \u003c\u003e ' \r\n\r\n Знаю что импакт от этой  XSS возможен только в случае социльной инженерии, так как на ishop.qiwi.com реализована защита от CSRF атак на login  \r\n\r\n\r\n-------\r\n\r\nС наилучшими пожеланиями , Kxyry\r\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-29T12:12:19.029Z","allow_singular_disclosure_after":-190435897.60890433,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","pekafat"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":333308,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-02-17T13:42:01.574Z","updated_at":"2015-02-17T13:42:01.574Z","actor":{"username":"videns","cleared":false,"url":"/videns","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":351086,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-03-11T14:29:26.580Z","updated_at":"2015-03-11T14:29:26.580Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kxyry","url":"/kxyry"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351087,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2015-03-11T14:29:33.106Z","updated_at":"2015-03-11T14:29:33.106Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"QIWI"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"kxyry","url":"/kxyry"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":568497,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-08-30T12:12:18.685Z","updated_at":"2015-08-30T12:12:18.685Z","first_to_agree":true,"actor":{"username":"kxyry","cleared":false,"url":"/kxyry","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/463/78e78b6f89306f60a89b97ce1f44ea4fc2595ce8_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":569205,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-08-31T08:40:13.387Z","updated_at":"2015-08-31T08:40:13.387Z","actor":{"username":"videns","cleared":false,"url":"/videns","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":569206,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-08-31T08:40:13.759Z","updated_at":"2015-08-31T08:40:13.759Z","actor":{"username":"videns","cleared":false,"url":"/videns","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}