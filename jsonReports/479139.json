{"id":479139,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzkxMzk=","url":"https://hackerone.com/reports/479139","title":"Bypass of #447975 - view mobile application token though \"Application Information\" sidebar on Installation page ","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-01-14T04:49:22.380Z","submitted_at":"2019-01-14T04:49:22.380Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T16:40:28.004Z","bug_reporter_agreed_on_going_public_at":"2020-08-13T16:08:43.528Z","team_member_agreed_on_going_public_at":"2020-08-13T16:40:27.929Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In #447975 I demonstrated that it was possible to view the application token for a mobile app by visiting the upgrade page - this was subsequently fixed by disallowing access completely for a restricted user to view that page. I've found a workaround to this fix, and in doing so I've enable my restricted user account to gain access to the application token once again, meant only for administrators or users with the proper add-on permissions (which the restricted user does not have). \n\n## Steps to Reproduce\n\nSteps to Reproduce\n1. As an admin user, create a new mobile app (`https://rpm.newrelic.com/accounts/1523936/mobile/setup`)\n2. Once you're done setting it up, create a new user with restricted read-only settings for mobile, and log in as that user.\n3. As the restricted user, attempt to navigate to the settings page (`https://rpm.newrelic.com/accounts/1523936/mobile/{MOBILE_ID}/edit`) - you will be denied, and you won't be able to view the page with the application token\n4. Navigate to the \"Deploy\" page which follows the following URL structure: \n\n`https://rpm.newrelic.com/accounts/1523936/mobile/{MOBILE_ID}/deploy`\n\nThe mobile application token will be on the right hand side of the page: \n\n{F405751}\n\n## Impact\n\nI've copied and pasted the impact statement from report #447975 since the impact is the same. \n\nTaken from: https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile/maintenance/viewing-your-application-token\n\n\u003e New Relic Mobile automatically assigns a unique, 40-character hexadecimal string to each mobile app you add for monitoring. This application token is similar to a New Relic license key and is required to authenticate your app with New Relic.\n\nWith this in mind, this is the same severity as having access to that of the account license key.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":405751,"file_name":"Screen_Shot_2019-01-13_at_9.47.28_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/405/751/3690582c1752c33b64f01bdc0f7bc1858d7b7b9f/Screen_Shot_2019-01-13_at_9.47.28_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-01-13_at_9.47.28_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-01-13_at_9.47.28_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150418Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=87b4709e53d1a3ab74fdcfa781d76ba3bcacb6d0b17822b3475ec21e29c8a282","file_size":58394,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-12T16:08:43.607Z","allow_singular_disclosure_after":-34037734.41326929,"singular_disclosure_allowed":true,"vote_count":4,"voters":["wi11","ali","cryptographer","shaaan"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":16410,"asset_type":"URL","asset_identifier":"rpm.newrelic.com/accounts/*/mobile","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3976146,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Total RIPage, dude!\n\nYou aint been slacking on yer hacking. Our fix was lacking some backing, so we'll get cracking! Otherwise I better start packing.","automated_response":false,"created_at":"2019-01-14T23:48:32.120Z","updated_at":"2019-01-14T23:48:32.120Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3976148,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-01-14T23:48:51.592Z","updated_at":"2019-01-14T23:48:51.592Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4081628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, @jon_bottarini! We believe this to be resolved. Can you re-test and confirm that you cannot find the application token?","automated_response":false,"created_at":"2019-02-01T19:42:07.370Z","updated_at":"2019-02-01T19:42:07.370Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4081665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fixed! Get a `You do not have sufficient permissions to perform that action.` error now when attempting to access that page. ","automated_response":false,"created_at":"2019-02-01T19:49:33.029Z","updated_at":"2019-02-01T19:49:33.029Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4091748,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good to hear!","automated_response":false,"created_at":"2019-02-04T18:11:11.391Z","updated_at":"2019-02-04T18:11:11.391Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8928355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T16:08:43.565Z","updated_at":"2020-08-13T16:08:43.565Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8928723,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T16:40:27.948Z","updated_at":"2020-08-13T16:40:27.948Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8928724,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T16:40:28.030Z","updated_at":"2020-08-13T16:40:28.030Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}