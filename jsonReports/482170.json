{"id":482170,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODIxNzA=","url":"https://hackerone.com/reports/482170","title":"Ports are not shown in third-party site redirect warning page.","state":"Closed","substate":"duplicate","severity_rating":"low","readable_substate":"Duplicate","created_at":"2019-01-18T13:36:14.206Z","submitted_at":"2019-01-18T13:36:14.206Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b3f53dc9b2061f7df0c2ffd","url":"/b3f53dc9b2061f7df0c2ffd","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15966,"url":"https://hackerone.com/semrush","handle":"semrush","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150435Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=591c7f9b2a1537a24f97d8743a3247a865624522a6257def7e8e971efff80974","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z5zlmceddsqb6x026x37tp0ych7i/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22Avatars.png%22%3B%20filename%2A%3DUTF-8%27%27Avatars.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150435Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=90e9a2b3d8c220be873b456f67c8c5b6ee85ff25eb104c99b26a2309ad388501"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Semrush","twitter_handle":"","website":"https://www.semrush.com/","about":"Online Visibility Management Platform."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-12T13:53:13.206Z","bug_reporter_agreed_on_going_public_at":"2019-01-23T13:00:39.160Z","team_member_agreed_on_going_public_at":"2019-04-12T13:53:13.154Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n[Ports are not shown in third-party site redirect warning page]\n\nVulnerable Endpoint :- https://www.semrush.com/redirect?urlhttp://example.com:1337\n\n**Description:** I noticed #311330 this report where you guys fixed a open redirect report by adding a external third-party site redirect warning page . It was a great fix . Although a issue caught in my eye . Urls contains a protocol and Ports . If I add a url with any other ports like 1337 then it's not shown in the external warning page what can be used to take a user to any other place then user expected to go .\n\nBrowsers Verified In: Chrome and Mozilla Firefox\n\n## Steps To Reproduce:\n\nVisit https://www.semrush.com/redirect?url=http://example.com:1337\nYou will see a warning page only saying about the domain but no warning about the ports like screenshot added below\nBut the source says it will take user to http://example.com:1337 not only example.com\n\u003ca href=\"http://example.com:1337\" id=\"js-site-link\" class=\"site_link\" data-test-site-link=\"\"\u003e\nGo to site \u003c/a\u003e\n\nFIX :-\nI can suggest possible fix here :-\n\nShow the Ports of the inputted url in the Warning page .\nThanks\n\n## Impact\n\nI noticed in url= parameter many protocols can be used . Like I can use any port  and on my android if I visit https://www.semrush.com/redirect?url=http://example.com:1337 and click on Go to site then it will open my virtual environment's.","original_report_id":459286,"original_report_url":"https://hackerone.com/reports/459286","attachments":[{"id":408553,"file_name":"Screenshot_2019-01-18-19-04-59-960_com.android.chrome.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/408/553/110ff7f0a77a35b1432969b8f40e696e50ce2e7d/Screenshot_2019-01-18-19-04-59-960_com.android.chrome.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2019-01-18-19-04-59-960_com.android.chrome.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2019-01-18-19-04-59-960_com.android.chrome.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150435Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a799783c3462af4b10f5148562bf3ee5743b826a9712743c487410ea124ff298","file_size":55221,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":12483,"asset_type":"URL","asset_identifier":"*.semrush.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4000131,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thank you for the report but this is a duplicate.","automated_response":false,"created_at":"2019-01-18T14:10:32.508Z","updated_at":"2019-01-18T14:10:32.508Z","original_report_id":459286,"actor":{"username":"slowstock","cleared":false,"url":"/slowstock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ZjeZJNJWNzZjJZDzLA9KWqMh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4000156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Both reports look similar at glance . But my report is of issue that isn't resolved so you must consider it as a different report . My request .\n","automated_response":false,"created_at":"2019-01-18T14:16:07.096Z","updated_at":"2019-01-18T14:16:07.096Z","actor":{"username":"b3f53dc9b2061f7df0c2ffd","cleared":false,"url":"/b3f53dc9b2061f7df0c2ffd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4020069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Secondly for a duplicate report how can you reduce my reputation to -5 as a duplicate report gets 0 reputation .","automated_response":false,"created_at":"2019-01-22T19:53:10.635Z","updated_at":"2019-01-22T19:53:10.635Z","actor":{"username":"b3f53dc9b2061f7df0c2ffd","cleared":false,"url":"/b3f53dc9b2061f7df0c2ffd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4023445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, not sure how we could reduce your reputation, I guess it's more of a question to hackerone. And about your report: we don't see here any security implications, moreover, we have never seen such practice as showing ports in redirect warning page.","automated_response":false,"created_at":"2019-01-23T10:49:20.987Z","updated_at":"2019-01-23T10:49:20.987Z","actor":{"username":"slowstock","cleared":false,"url":"/slowstock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ZjeZJNJWNzZjJZDzLA9KWqMh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4024171,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay .","automated_response":false,"created_at":"2019-01-23T13:00:31.686Z","updated_at":"2019-01-23T13:00:31.686Z","actor":{"username":"b3f53dc9b2061f7df0c2ffd","cleared":false,"url":"/b3f53dc9b2061f7df0c2ffd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4024173,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-23T13:00:39.184Z","updated_at":"2019-01-23T13:00:39.184Z","first_to_agree":true,"actor":{"username":"b3f53dc9b2061f7df0c2ffd","cleared":false,"url":"/b3f53dc9b2061f7df0c2ffd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4547651,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-12T13:53:13.173Z","updated_at":"2019-04-12T13:53:13.173Z","actor":{"username":"sergin","cleared":false,"url":"/sergin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7oHfVzGzsdEP4jqKNrfwEiiN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4547652,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-04-12T13:53:13.222Z","updated_at":"2019-04-12T13:53:13.222Z","actor":{"username":"sergin","cleared":false,"url":"/sergin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7oHfVzGzsdEP4jqKNrfwEiiN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semrush","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}