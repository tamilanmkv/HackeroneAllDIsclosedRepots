{"id":484664,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODQ2NjQ=","url":"https://hackerone.com/reports/484664","title":"ICQ for macOS: lack of `com.apple.quarantine` meta-attribute on downloaded files leads to GateKeeper/Quarantine bypass for downloaded executables","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2019-01-23T14:08:34.079Z","submitted_at":"2019-01-23T14:08:34.079Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-17T10:07:37.332Z","bug_reporter_agreed_on_going_public_at":"2019-09-11T19:42:41.223Z","team_member_agreed_on_going_public_at":"2019-09-17T10:07:37.270Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nQuarantine \u0026 GateKeeper are important macOS security mechanisms, which prevent user/device from running unsigned executables and warn users about executables downloaded from the remote. \n\n\u003e Conceptually, Quarantine \u0026 GateKeeper are similar to MOTW on Windows.\n\nApplications that could download files should enable file quarantine, because:\n\n1. Missing quarantine attribute for downloaded files allows a remote attacker to send an executable file that won't be checked by Gatekeeper on victim's machine.\n\n2. Launching downloaded executable files without `com.apple.quarantine` meta-attribute won't show an alert about launching an executable file from the remote.\n\n3. Summarizing this: opening of a downloaded executable file immediately leads to code execution bypassing Quarantine(files from remote) \u0026 GateKeeper(codesign).\n\n\u003e Tip: check `com.apple.quarantine` meta-attribute with \"xattr\" util\n\n## Steps To Reproduce:\n\n1. Attacker sends `exploit.terminal` to the victim (file can't be signed)\n2. Victim opens `exploit.terminal` file\n3. No alert from Gatekeeper about unsigned executable\n4. No alert about running executable file downloaded from the web\n5. Shell commands from `exploit.terminal` get executed immediately after click.\n\n### .terminal\n1. `.terminal` files can't be signed but could lead to code execution. \n2. Disabled quarantine allows attacker to abuse this flaw and decrease required user interaction from `download archive -\u003e unpack archive -\u003e open something from archive` to `download file -\u003e launch file`.\n3.  Download\u0026Launch is a common user flow, because macOS doesn't have any executable files which could lead to immediate code execution. macOS users generally feel safe about opening files.\n\n\u003e Also, `.terminal` files are just a plain XML, so it can't be detected by most antivirus/EDR software.\n\nActual result - Files downloaded through ICQ should have `com.apple.quarantine` meta attribute.\nExpected result - Files downloaded through ICQ don't have `com.apple.quarantine` meta attribute.\n\n## Additional info\n\n `exploit.terminal` file attached to this report (`echo \"Hello\" \u0026\u0026 id`)\n\n## Impact\n\n1. Downloaded through ICQ executable files bypass Quarantine/GateKeeper. \n2. `.terminal` files shorten required user interaction to  ~2 clicks.\n\nAdditional impact - code execution happens even in environments hardened with \"Apps from AppStore only\" GateKeeper setting.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":73,"name":"Phishing"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":411164,"file_name":"exploit.terminal","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/164/f1e89bcc6abcf4c1fb969c626afceff9a7498001/exploit.terminal?response-content-disposition=attachment%3B%20filename%3D%22exploit.terminal%22%3B%20filename%2A%3DUTF-8%27%27exploit.terminal\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150451Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9eea1b33f15c2c36fdfe08abe05b63ac0acc934e3fa28fae159184bb8da4fb4d","file_size":461,"type":"application/xml"}],"allow_singular_disclosure_at":"2019-10-11T19:42:41.280Z","allow_singular_disclosure_after":-63141730.20310036,"singular_disclosure_allowed":true,"vote_count":18,"voters":["danila","sameerphad72","spam404","ali","metnew","theappsec","cryptographer","sh04v","ktnano","blinkdagger","and 8 more..."],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":42797,"asset_type":"OTHER","asset_identifier":"ICQ","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4024490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e IMPORTANT: only ICQ from the official website is affected. AppStore apps are hardened with file quarantine by default (AFAIR)","automated_response":false,"created_at":"2019-01-23T14:10:57.365Z","updated_at":"2019-01-23T14:10:57.365Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4024542,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not sure about the severity level of this issue in this particular case (no way to launch `.terminal` file from ICQ UI)\nSince you treat persistent DoS as \"Medium\" according to the policy, may this qualify as High? Anyway, that's up to you, ICQ security team :)","automated_response":false,"created_at":"2019-01-23T14:27:21.746Z","updated_at":"2019-01-23T14:27:21.746Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4024743,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting this problem to ICQ Team!  We appreciate your time for helping us to make our web services safer.\n\nWe are currently reviewing your submission and will be back in touch soon.","automated_response":false,"created_at":"2019-01-23T15:10:40.442Z","updated_at":"2019-01-23T15:10:40.442Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4065217,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello,\n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem\n","automated_response":false,"created_at":"2019-01-30T15:46:30.094Z","updated_at":"2019-01-30T15:46:30.094Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4443800,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\nthis bug was fixed, please confirm if the patch is OK.","automated_response":false,"created_at":"2019-04-02T12:48:16.063Z","updated_at":"2019-04-02T12:48:16.063Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5016334,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2019-06-06T14:02:29.856Z","updated_at":"2019-06-06T14:02:29.856Z","additional_data":{"added_weaknesses":[{"id":73,"name":"Phishing"}],"removed_weaknesses":[{"id":57,"name":"Violation of Secure Design Principles"}]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5016336,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-06-06T14:02:40.648Z","updated_at":"2019-06-06T14:02:40.648Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":284967,"new_severity_id":414637},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5016493,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-06-06T14:05:43.342Z","updated_at":"2019-06-06T14:05:43.342Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5047601,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Can we disclose it after a patch for another vulnerable app?","automated_response":false,"created_at":"2019-06-11T09:43:09.509Z","updated_at":"2019-06-11T09:43:09.509Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5782030,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-11T19:42:41.246Z","updated_at":"2019-09-11T19:42:41.246Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@3apa3a –≥–æ —Ñ—É–ª –¥–∏—Å–∫–ª–æ—É–∑","automated_response":false,"created_at":"2019-09-16T18:11:42.138Z","updated_at":"2019-09-16T18:11:42.138Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5824522,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-17T10:07:37.295Z","updated_at":"2019-09-17T10:07:37.295Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5824523,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-09-17T10:07:37.350Z","updated_at":"2019-09-17T10:07:37.350Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6803164,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","automated_response":false,"created_at":"2020-01-17T19:51:26.844Z","updated_at":"2020-01-17T19:51:26.844Z","additional_data":{"old_team":"ICQ","new_team":"Mail.ru"},"actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":16520,"category":"team","content":"com.apple.quarantine meta attrbiute was not used for received file in ICQ for MacOS X. While not considered as a bug, using com.apple.quarantine is BCP in MacOS X for files obtained from potentially untrusted sources.\n\nIn addition, ADS Zone.Identifier was added for files downloaded via Windows ICQ desktop version to improve user's security.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"id":18201,"category":"researcher","content":"üòà","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":38544,"username":"metnew","name":"Vladimir Metnew","bio":"","cleared":true,"website":null,"location":"Ukraine, Kiev ","created_at":"2015-08-16T17:17:23.396Z","url":"https://hackerone.com/metnew","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}