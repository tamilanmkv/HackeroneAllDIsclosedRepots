{"id":489146,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODkxNDY=","url":"https://hackerone.com/reports/489146","title":"Confidential data of users and limited metadata of programs and reports accessible via GraphQL","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-01-31T15:32:20.974Z","submitted_at":"2019-01-31T15:32:20.974Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yashrs","url":"/yashrs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-02-03T10:57:19.220Z","bug_reporter_agreed_on_going_public_at":"2019-02-03T10:57:19.106Z","team_member_agreed_on_going_public_at":"2019-02-03T10:36:46.940Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe GraphQL endpoint doesn't have access controls implemented properly.\n\n**Description:**\nAny attacker can get personally identifiable information of users of Hackerone such as email address, backup hash codes, facebook_user_id, account_recovery_phone_number_verified_at, totp_enabled, etc.\n\nThese are just some examples of fields which are getting leaked directly from GraphQL.\n\nThis is the request sent to GraphQL:\n\n```\n{\n  id\n  users()\n  {\n    total_count \n    nodes\n    {\n      _id\n      name\n      username\n      email\n      account_recovery_phone_number\n      account_recovery_unverified_phone_number\n      bounties\n      {\n        total_amount\n      }\n      otp_backup_codes\n      i_can_update_username\n      location\n      year_in_review_published_at\n      anc_triager\n      blacklisted_from_hacker_publish\n      calendar_token\n      vpn_credentials\n      {\n        name\n      }\n      account_recovery_phone_number_sent_at\n      account_recovery_phone_number_verified_at\n      swag\n      {\n        total_count\n      }\n      totp_enabled\n      subscribed_for_team_messages\n      subscribed_for_monthly_digest\n      sessions\n      {\n        total_count\n      }\n      facebook_user_id\n      unconfirmed_email\n    }\n  }\n```\n\nSample Response:\n█████████\n\nPlease fix it.\n\nThanks,\nYash :)\n\n## Impact\n\nThis could potentially leak many users' info","bounty_amount":"20000.0","formatted_bounty":"$20,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-03-05T10:36:47.124Z","allow_singular_disclosure_after":-82182518.15601984,"singular_disclosure_allowed":true,"vote_count":955,"voters":["poutine_hero","0x541","ikuamike","pajoda","rootz491","joaxcar","san1t1z3r","rioru","13c50k4","delimitry","and 945 more..."],"severity":{"rating":"critical","score":9.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4071989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"After further research, we also found the following:\n\n- User email addresses also leak the private program information\n- Duplicate users can give info about actual users. For example:  (jobert -\u003e ███████, Michiel -\u003e ██████████)\n██████\n\n- Invitation preference:\n█████████\n\n- T_shirt size\n- edit_unclaimed_profiles(true/false)\n- Lufthansa account(what is it?)\n- Next username update date\n\nSimilarly, the total count on Users is ███, so we are able to extract information for any user and also for all if an attacker wants to.\n\nThanks,\nYash","automated_response":false,"created_at":"2019-01-31T16:30:59.149Z","updated_at":"2019-02-03T08:16:31.699Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4071997,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2019-01-31T16:32:16.231Z","updated_at":"2019-01-31T16:32:16.231Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"email":"pandaonair","genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4072002,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2019-01-31T16:32:39.853Z","updated_at":"2019-01-31T16:32:39.853Z","actor":{"username":"pandaonair","cleared":true,"url":"/pandaonair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zEjReSt2jjFjUkaw2dGL8xTC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4072033,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For instance, we are able to extact information about a hackerone staff member @still by using the feature of graphql, **after cursor**,` users(after:\"MzY4MDYw\")`. \n\n**P.S We haven't saved any other information other than mentioned here.**\n```\n{\n id\n {\n   id\n   team\n   {\n     _id\n     about\n   }\n   uuid\n }\n me{    \n   _id #388246\n   id  #gid://hackerone/User/388246\n }\n   users(after:\"MzY4MDYw\")\n {\ntotal_count \n   pageInfo\n   {\n     hasNextPage\n     endCursor\n     startCursor\n   }\n   nodes()\n   {\n     _id\n     name\n     username\n     hackerone_triager\n     email\n     authentication_service\n     created_at\n     duplicate_users\n     {\n       total_count\n       nodes\n       {\n         _id\n         name\n         username\n         bio\n         bounties\n         {\n           average_amount\n         }\n         account_recovery_phone_number\n         hackerone_triager\n       }\n     }\naccount_recovery_phone_number\n     account_recovery_unverified_phone_number\n     bounties\n     {\n       total_amount\n     }\n     otp_backup_codes\n     i_can_update_username\n     location\n     #year_in_review_published_at\n     anc_triager\n     #blacklisted_from_hacker_publish\n     calendar_token\n     facebook_user_id\n   }\n }\n}\n```\n\n████\n\n","automated_response":false,"created_at":"2019-01-31T16:39:41.250Z","updated_at":"2019-02-01T20:37:40.349Z","actor":{"username":"pandaonair","cleared":true,"url":"/pandaonair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zEjReSt2jjFjUkaw2dGL8xTC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yashrs and @milind1997 - thanks for this. We're looking into this now and we'll keep you posted.","automated_response":false,"created_at":"2019-02-01T03:16:02.463Z","updated_at":"2019-02-01T03:16:02.463Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075714,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice, we were able to reproduce the vulnerability you described. We'll jump on it right away!","automated_response":false,"created_at":"2019-02-01T03:22:45.872Z","updated_at":"2019-02-01T03:22:45.872Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additionally, we found out that `teams()` was also affected. So this further widens the impact and attack surface of this report.\n\nThe **triage_note** shouldn't be visible to anyone. It reveals information like test accounts for hackers, SAML credentials and other sensitive information that should be only visible to HackerOne Team.\n██████████\n\nAlso, as seen in the above screenshot, other information like `max_number_of_team_mediation_requests`, `last_invitation_accepted_at_for_user`, etc. were found. There maybe more to this, but we haven't investigated 100%.\n\nThanks,\nYash :)","automated_response":false,"created_at":"2019-02-01T05:29:16.310Z","updated_at":"2019-02-01T20:38:31.602Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yashrs and @milind1997 - thanks for continuing to look into this. We're aware that this exposes more data that you initially reported. We will follow up with the data that was possible to be queried in a post mortem. We'd kindly like to ask to stop testing right now. Thanks for your cooperation!","automated_response":false,"created_at":"2019-02-01T05:31:22.693Z","updated_at":"2019-02-01T05:31:22.693Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075866,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jobert, \n\nThanks for your quick response. We were just assessing the attack surface searching for worst case scenarios. But, now that you are aware about all the risks, we will stop. \n\nThanks\n-Yash :) ","automated_response":false,"created_at":"2019-02-01T05:36:07.072Z","updated_at":"2019-02-01T05:36:07.072Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yashrs and @milind1997 - thanks again! We just deployed a fix for the vulnerability you discovered. Can you confirm the fix? We are continuing with our investigation to determine whether this has been abused. Thanks!","automated_response":false,"created_at":"2019-02-01T06:22:52.195Z","updated_at":"2019-02-01T06:22:52.195Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075922,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-02-01T06:26:32.473Z","updated_at":"2019-02-01T06:26:32.473Z","additional_data":{"old_severity":"High (8.8)","new_severity":"Critical (9.3)","old_severity_id":289939,"new_severity_id":290375},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075925,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2019-02-01T06:27:47.188Z","updated_at":"2019-02-01T06:27:47.188Z","additional_data":{"added_weaknesses":[{"id":18,"name":"Information Disclosure"}],"removed_weaknesses":[{"id":46,"name":"Privacy Violation"}]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075935,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that it is fixed. I get an error from GraphQL now. That was quick :) ","automated_response":false,"created_at":"2019-02-01T06:33:54.363Z","updated_at":"2019-02-01T06:33:54.363Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075943,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for confirming, it's much appreciated! We'll wrap up our investigation, provide a summary in this report with our root cause analysis, and award a bounty soon.\n\nUnrelated to the vulnerability itself: we noticed that you're both collaborators on this report and we want to make sure that the weights are set correctly. Can you confirm this?","automated_response":false,"created_at":"2019-02-01T06:39:39.385Z","updated_at":"2019-02-01T06:39:39.385Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"yashrs","url":"/yashrs"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4075955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Thanks for confirming, it's much appreciated! We'll wrap up our investigation, provide a summary in this report with our root cause analysis, and award a bounty soon.\n\nThanks, that is much appreciated :) I'm so excited, it's my first accepted bug on Hackerone\n\n\u003e Unrelated to the vulnerability itself: we noticed that you're both collaborators on this report and we want to make sure that the weights are set correctly. Can you confirm this?\n\nThanks for noticing that @jobert, but yes I can confirm that it's correctly set.","automated_response":false,"created_at":"2019-02-01T06:45:20.092Z","updated_at":"2019-02-01T06:45:20.092Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082575,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @yashrs and @milindpurswani - thanks again for bringing this to our attention, this was an amazing finding! We've added a post mortem at the top of the report to prepare this to be publicly disclosed. This includes how we decided on the bounty amount. We've redacted the screenshots you provided us. We look forward to receiving vulnerabilities from both of you in the future!\n\nHappy hacking!","automated_response":false,"created_at":"2019-02-02T00:18:40.284Z","updated_at":"2019-02-02T00:18:40.284Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"pandaonair","url":"/pandaonair"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4082576,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @yashrs and @milindpurswani - thanks again for bringing this to our attention, this was an amazing finding! We've added a post mortem at the top of the report to prepare this to be publicly disclosed. This includes how we decided on the bounty amount. We've redacted the screenshots you provided us. We look forward to receiving vulnerabilities from both of you in the future!\n\nHappy hacking!","automated_response":false,"created_at":"2019-02-02T00:18:41.408Z","updated_at":"2019-02-02T00:18:41.408Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"18000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"yashrs","url":"/yashrs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4082598,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-02-02T00:35:42.197Z","updated_at":"2019-02-02T00:35:42.197Z","additional_data":{"old_title":"User Information Leakage through GRAPHQL","new_title":"User Information Leakage through GraphQL"},"actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4082625,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-02-02T00:48:10.686Z","updated_at":"2019-02-02T00:48:10.686Z","additional_data":{"old_title":"User Information Leakage through GraphQL","new_title":"Confidential data of users and limited metadata of programs and reports accessible via GraphQL"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4082700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are glad we could help make Hackerone more secure. ","automated_response":false,"created_at":"2019-02-02T01:42:49.410Z","updated_at":"2019-02-02T01:42:49.410Z","actor":{"username":"pandaonair","cleared":true,"url":"/pandaonair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zEjReSt2jjFjUkaw2dGL8xTC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082702,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you so much @jobert and @hackerone team for fixing this so quickly and awarding the bounty :D\n\nDo you think we are eligible for some swag? Would love to have one!","automated_response":false,"created_at":"2019-02-02T01:44:54.538Z","updated_at":"2019-02-02T01:44:54.538Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082703,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Of course! Happy to send you some swag for such a great find. :-)","automated_response":false,"created_at":"2019-02-02T01:46:47.485Z","updated_at":"2019-02-02T01:46:47.485Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"reporter":{"username":"yashrs","url":"/yashrs"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello team, \nTwo researchers collaborated, so do you think that the other researcher is also eligible for some swag? ","automated_response":false,"created_at":"2019-02-02T01:52:23.287Z","updated_at":"2019-02-02T01:52:23.287Z","actor":{"username":"pandaonair","cleared":true,"url":"/pandaonair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zEjReSt2jjFjUkaw2dGL8xTC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert @security \nSlightly related to this vuln: The user himself is able to read the otp_backup_codes hashes. I know this doesn't cause any harm in general but just wanted to confirm if it's intended before this report is disclosed\n```\n{\n me{    \n    _id #388246\n    id  #gid://hackerone/User/388246\n    otp_backup_codes\n    username   \n  }\n}\n```\nResp:\n{F416558}\n\n\nThanks,\nYash :)","automated_response":false,"created_at":"2019-02-02T03:28:02.477Z","updated_at":"2019-02-02T03:28:02.477Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4082814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, just curious: What is the difference between edges[node] and nodes.. why are there two fields which do the same thing?","automated_response":false,"created_at":"2019-02-02T03:31:13.830Z","updated_at":"2019-02-02T03:31:13.830Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4085101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Two researchers collaborated, so do you think that the other researcher is also eligible for some swag?\n\nYes, we'll make sure to send both of you swag.\n\n\u003e The user himself is able to read the otp_backup_codes hashes. I know this doesn't cause any harm in general but just wanted to confirm if it's intended before this report is disclosed\n\nThanks for asking! It is currently intentional, but when we worked on this incident we noticed that this could be implemented in a different way. We'll likely remove it from the schema in some time.\n\n\u003e What is the difference between edges[node] and nodes.. why are there two fields which do the same thing?\n\nGreat question! From what I could see [in the commit history of the gem](https://github.com/rmosolgo/graphql-ruby/commit/cc6ce94032f49b8d732a4a134d7ea484e86d9d05#diff-9d2aa305e6bee5b203288ca963d6d4d4), it is simply a shorthand for `edges { node }`. It wasn't supposed to be added by default though, and so for compatibility the maintainer later accepted [a pull request](https://github.com/rmosolgo/graphql-ruby/pull/1693) to make it configurable.","automated_response":false,"created_at":"2019-02-02T18:24:43.950Z","updated_at":"2019-02-02T18:24:43.950Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4086971,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-02-03T10:36:47.001Z","updated_at":"2019-02-03T10:36:47.001Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4086977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @reed, please redact the last screenshot posted by @yashrs. Then we can disclose it.\n\nThanks\n\n-Milind","automated_response":false,"created_at":"2019-02-03T10:39:07.064Z","updated_at":"2019-02-03T10:39:07.064Z","actor":{"username":"pandaonair","cleared":true,"url":"/pandaonair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/zEjReSt2jjFjUkaw2dGL8xTC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4086989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@milindpurswani done! Please accept disclosure. :-)","automated_response":false,"created_at":"2019-02-03T10:44:52.310Z","updated_at":"2019-02-03T10:44:52.310Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4087002,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Here we go!!\n{F417233}","automated_response":false,"created_at":"2019-02-03T10:57:19.143Z","updated_at":"2019-02-03T10:57:19.143Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":417233,"filename":"done.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/233/ab7a16e547c22fe6370456818f7682788d458ff0/done.jpg?response-content-disposition=attachment%3B%20filename%3D%22done.jpg%22%3B%20filename%2A%3DUTF-8%27%27done.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150525Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7f1a8cd316c68f9fefb4ec9602b12e44d49b4891679aa0c2b901c0c8f4de96da"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4087003,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-02-03T10:57:19.243Z","updated_at":"2019-02-03T10:57:19.243Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4087016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, shoutout to @milindpurswani for being cool and helping me out on this report! Thanks again!","automated_response":false,"created_at":"2019-02-03T11:07:32.647Z","updated_at":"2019-02-03T11:07:32.647Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @security team, \n\nI was just wondering if both the swag packs were sent from your end. I am asking because we haven't received the swag and nor have I received any email regarding that.\n\nThanks,\nYash :)","automated_response":false,"created_at":"2019-03-14T19:21:06.292Z","updated_at":"2019-03-14T19:21:35.919Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4334841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Lemme check @yashrs and I'll get back to you.","automated_response":false,"created_at":"2019-03-16T00:47:57.543Z","updated_at":"2019-03-16T00:47:57.543Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4348022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yashrs can you email us at support@hackerone.com so we can discuss this? I'll give the support team a heads up.","automated_response":false,"created_at":"2019-03-18T18:01:02.323Z","updated_at":"2019-03-18T18:01:02.323Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4348059,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bencode, thanks for looking into this. I have mailed the support team.\n\nRegards,\n@yashrs","automated_response":false,"created_at":"2019-03-18T18:07:29.731Z","updated_at":"2019-03-18T18:07:29.731Z","actor":{"username":"yashrs","cleared":true,"url":"/yashrs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S9WnJuUrpWvxZ6iM38qL2HE4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14009,"category":"team","content":"On January 31st, 2019 at 7:16pm PST, HackerOne confirmed that two reporters were able to query confidential data through a GraphQL endpoint. This vulnerability was introduced on December 17th, 2018 and was caused by a backend migration to a class-based implementation of GraphQL types, mutations, and connections. The [class-based implementation introduced](http://graphql-ruby.org/schema/class_based_api) the `nodes` field by default on all connections. The `nodes` field, in contrast with `edges`, didn’t leverage any of the defenses HackerOne has implemented to mitigate the exposure of sensitive information.\n\nOur investigation concluded that malicious actors did not exploit the vulnerability. No confidential data was compromised. A short-term fix was released on January 31st, 2019 at 9:46 PM, a little over 2 hours after the vulnerability was reproduced.\n\n# Timeline\n\n| **Date** | **Time (PST)** | **Action** |\n|-------------|----------------|------------------------------------------------------------------------------------------------------------------|\n| 2018-12-17 | 9:07 AM | Software containing bug deployed to production. |\n| 2019-01-31 | 7:32 AM | Vulnerability submitted to HackerOne’s bug bounty program. |\n| 2019-01-31 | 7:21 PM | HackerOne validated the report and started incident response. |\n| 2019-01-31 | 8:25 PM | HackerOne identified which code change introduced the security vulnerability and started work on a patch. |\n| 2019-01-31 | 9:46 PM | A patch was released mitigating the identified vulnerability. |\n| 2019-01-31 | 11:46 PM | HackerOne confirmed the vulnerability was not abused by any malicious actors. |\n| 2019-02-01 | 6:18 AM | The root cause of the vulnerability was identified and a long term mitigation was proposed. |\n| 2019-02-01 | 5:08 PM | Long term mitigation was deployed to production. |\n| 2019-02-03 | 2:34 AM | Impacted users were alerted that their information was exposed to the reporters who submitted the vulnerability. |\n\n# Root Cause\nHackerOne has a number of defenses in place to reduce the risk of over-exposing data through our GraphQL layer. The first notable defense is a separate database schema that limits the set of rows a user can query based on their current role. This significantly reduces the impact in case, for example, the result of `Report.all`, would be serialized and returned to the user. The second notable defense is attribute-level authorization depending on the role of the requester. This makes sure that when an object is serialized, for example a publicly disclosed report, the user is not able to obtain internal metadata of the report.\n\n*Why upgrade?*\nOn December 17th, when the code change was put up for review, engineers noticed the addition of the `nodes` field. An assumption was made that the field behaved like a shortcut for `edges { node }` — which, in hindsight, was not the case. No manual testing was performed to make sure that the authorization model for `nodes` was similar to other connection types.\n\nHackerOne’s engineering team decided to upgrade to the class-based implementation of `graphql-ruby` because the old .define-based implementation was lazy-loaded. This caused problems when hot reloading pieces of code in a development environment. The class-based implementation also performs better in most situations. The .define-style implementation is also deprecated by the maintainers of the gem (to be removed with GraphQL 2.0).\n\n*Why didn’t we notice?*\nThe `nodes` field is a helper field for Relay, which is used by the frontend. Even though the field was introduced, HackerOne engineers hadn’t started using this in our frontend. This caused the addition to fly under the radar of other engineers. The go-to way to query data through connection types at HackerOne is to go through the `edges` field. Because engineers outside of the specific team who upgraded to the class-based implementation did not deem the change important enough, there was no communication to other engineering teams.\n\n*Why was it exploitable?*\nWhen a GraphQL query is deconstructed and turned into one or multiple SQL queries, it will cast the result of it into an array of stale objects and use the attribute-level authorization to scrub all data the current user isn’t authorized to see. Root cause analysis showed that this code path was only followed when the nodes were queried through the `edges` field.\n\n**Query that followed the expected code path**\n```\nquery {\n  users() {\n    edges {\n      node {\n        email\n      }\n    }\n  }\n}\n```\n\nDuring the GraphQL gem upgrade on December 17th, all GraphQL types, connections, and mutations were rewritten to a class-based implementation. This introduced the `nodes` field on every connection type [in HackerOne’s GraphQL schema](https://github.com/arkadiyt/bounty-targets-data/commit/cc4ce27dc1c92996191374f46312e4da5b7099c0#diff-8f06618eaa831640dfc824ff0cc29ebd). Instead of casting the result to an array with stale objects, the `nodes` field would result in an `ActiveRecord::Relation` object. The attribute-level authorization instrumentation would then incorrectly assume that the result was safe to be serialized, as it assumes the parent of the GraphQL field had already been scrubbed.\n\n**Query that followed the unexpected code path**\n```\nquery {\n  users() {\n    nodes {\n      email\n    }\n  }\n}\n```\n\nIn the team’s investigation to determine whether this was exploited by malicious actors, the team concluded that the current logging level enabled them to answer two crucial questions: which GraphQL queries were executed and what information was transferred to the people proving the security vulnerability in the first place. These questions confirmed it was not exploited.\n\n# Resolution and Recovery\nAt 7:21 PM PST, HackerOne successfully reproduced the vulnerability as described by the reporter. The responding team identified the code change that introduced the vulnerability and started working on a short-term mitigation at 8:25 PM. This mitigation was released at 9:46 PM. The short-term mitigation was to disable the `nodes` field [from every connection type](https://github.com/arkadiyt/bounty-targets-data/commit/dd90f110609bff572f15b62d29701195a3c2b3bf#diff-8f06618eaa831640dfc824ff0cc29ebd). An internal code rule was deployed to alert the incident responders in case a new connection type was added that had the `nodes` field enabled. At the time, the root cause of the vulnerability was still unclear.\n\nOn February 1st at 6:18 AM, the team concluded the root cause analysis of the identified vulnerability. A long-term fix was put up for discussion. This fix addressed the underlying problem of the lack of attribute-level protection for the `nodes` field. Going forward any connection type that is introduced will either be sanitized through the attribute-level authorization or will stop processing the request in case of an unexpected object to be returned.\n\nThe minimum bounty award for a critical vulnerability on hackerone.com is currently set to $15,000. Even though this vulnerability exposed confidential information, it was limited to user information and metadata of programs and reports. None of the exposed information could have led to the compromise of confidential vulnerability information. It did, however, allow actors to query a significant amount of information. Because of that, the team decided to award the reporters with $20,000 for uncovering this vulnerability and working with us throughout the process.\n\n# Vulnerability Impact on Data\nSensitive information of multiple objects was exposed. Due to the two notable defenses as described in the Root Cause section, the scope of the information that was exposed was limited. Below is an overview of the objects and the confidential data that a user was able to access.\n\n*Connection: users*\nThe GraphQL schema enables anyone to query the users on the platform. This is an intentional design decision. However, because every User object could be accessed, a significant amount of confidential information was accessible.\n\nBelow is an overview of all sensitive attributes that could be queried for every user on hackerone.com.\n\n| **Sensitive attribute** | **Note** |\n|------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| account_recovery_phone_number | The last two digits of a verified account recovery phone number. |\n| account_recovery_unverified_phone_number | The complete unverified account recovery phone number. |\n| address | Accessible when swag was awarded for a report the authenticated user had access to, regardless of their role (e.g. publicly disclosed report). |\n| calendar_token | The secret calendar token that exposes when HackerOne challenges were scheduled for the user. [This does not expose customer names](https://hackerone.com/reports/488643). |\n| duplicate_users | An array of possible duplicate accounts based on platform behavior. |\n| email | The email address. |\n| otp_backup_codes | An array of bcrypt-hashed OTP backup codes. |\n| payout_preferences | A connection of the user’s payout preferences. This does **not** include bank account details. |\n| reports | See Report connection for the scope and attributes that were exposed. |\n| unconfirmed_email | The unconfirmed email address. |\n\n*Connection: teams*\nThe secure database schema, by default, allows any user to query public programs (teams) and public external programs. Because of the relationship between external programs and HackerOne programs, this data set includes programs who may be running a private program. This means it was possible to obtain internal triage notes and the policy of a select number of private programs the user did not have access to. The reporters queried partial program information, but they did not obtain any sensitive information that warranted HackerOne to reach out to any customers.\n\n| **Sensitive attribute** | **Note** |\n|-----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------|\n| average_bounty_lower_amount | The lower bound of the average bounty range. |\n| average_bounty_upper_amount | The higher bound of the average bounty range. |\n| base_bounty | The minimum bounty of a program. |\n| bounties_total | The sum of awarded bounties in the entire lifetime of the program. |\n| bug_count | The total number of resolved reports. |\n| child_teams | A connection containing the hierarchy of teams. |\n| first_response_time | A float containing the average time to first response. |\n| goal_valid_reports | The goal of valid vulnerabilities per month the program set. |\n| grace_period_remaining_in_days | The number of days the program has to recover from too many SLA failures to avoid their program being taken off HackerOne. |\n| new_staleness_threshold | The internal SLA until a report is marked as an SLA miss when it hasn’t received a first response. |\n| new_staleness_threshold_limit | The internal SLA until a report is marked as an SLA fail when it hasn’t received a first response. |\n| policy | The program policy in raw markdown. |\n| policy_html | The rendered program policy. |\n| product_edition | The product edition the program uses. |\n| report_submission_form_intro | The submission form introduction in raw markdown. |\n| report_submission_form_intro_html | The rendered submission form introduction. |\n| report_template | The default report template in raw markdown. |\n| reporters | An array of user objects who have reporter access to the program. |\n| resolution_time | A float containing the average time to resolution. |\n| resolved_staleness_threshold | The internal SLA until a report is marked as an SLA miss when it hasn’t been resolved. |\n| sla_failed_count | The number of reports failing the internal SLA. |\n| structured_policy | A structured representation of the program policy. |\n| structured_scopes | A connection that only disclosed an internal `reference` in case the user was authorized to see the structured scopes on the program page. |\n| target_signal | A float representing the targeted signal of the program. |\n| triage_bounty_management | A text field containing instructions for HackerOne’s triage team on how to handle bounty payments. |\n| triage_enabled | A boolean field indicating whether the program uses HackerOne’s triage services. |\n| triage_note | Internal triage notes in raw markdown. |\n| triage_note_html | The rendered triage notes. |\n| triage_time | A float containing the average time to triage. |\n| triaged_staleness_threshold | The internal SLA until a report is marked as an SLA miss when it hasn’t been triaged. |\n| triaged_staleness_threshold_limit | The internal SLA until a report is marked as an SLA fail when it hasn’t been triaged. |\n| whitelisted_hackers | See `reporters`. |\n\n*Connection: reports*\nThe reports data hasn’t been fully migrated to the secure database schema yet, which means that at the time the vulnerability was reported, only fully publicly disclosed and all reports the user participated in were accessible. This significantly reduced the number of report information that was exposed.\n\n| **Sensitive attribute** | **Note** |\n|-----------------------------|-----------------------------------------------------------------------------------------------|\n| anc_reasons | An array of strings containing flags why the report was submitted to the HackerOne Human-Augmented Signal queue. |\n| mediation_requested_at | A date/time field when mediation was requested. |\n| pre_submission_review_state | A flag representing how Human-Augmented Signal responded to the report. |\n| reference | An optional internal reference. |\n| reference_link | An optional link to an internal ticket. |\n\nEven though the reporters confirmed that they did not query more information than necessary to prove the vulnerability and that they have deleted the information, HackerOne has reached out to the people for which sensitive information was downloaded by the reporters.\n\n**If your data was accessed during this incident, you have received a separate notification from HackerOne.**\n\n# Preventative Measures\nAs part of our incident response process, we are conducting an internal review and analysis of the incident. We are taking the following actions to address the underlying causes of issues and to help prevent future occurrence:\n* Consider leveraging the `graphql-ruby` gem hooks for built-in authorization callbacks to catch more edge cases\n* Break the execution flow when an unexpected object is returned in the resolution of a connection field\n* Reduce the complexity of connection type resolution\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2,"username":"jobert","name":"Jobert Abma","bio":"Co-founder of HackerOne. ಠ_ಠ","cleared":true,"website":"https://hackerone.com","location":"San Francisco, CA","created_at":"2013-03-08T01:17:12.256Z","url":"https://hackerone.com/jobert","anc_triager":false,"hackerone_triager":false,"hackerone_employee":true,"hacker_resume_enabled":true,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}