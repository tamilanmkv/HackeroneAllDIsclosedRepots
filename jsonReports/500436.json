{"id":500436,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDA0MzY=","url":"https://hackerone.com/reports/500436","title":"DOM based CSS Injection on grammarly.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-02-24T11:42:51.113Z","submitted_at":"2019-02-24T11:42:51.113Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gamer7112","url":"/gamer7112","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22746,"url":"https://hackerone.com/grammarly","handle":"grammarly","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Grammarly","twitter_handle":"","website":"https://www.grammarly.com","about":"Grammarly makes sure everything you type is clear, effective, and mistake-free."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-05-06T09:11:54.696Z","bug_reporter_agreed_on_going_public_at":"2019-04-25T02:29:47.169Z","team_member_agreed_on_going_public_at":"2019-05-06T09:11:54.590Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** An attacker can inject an external css file which can lead to phishing attacks and xss in older browsers.\n\n**Description:** Within the main.js file the following code exists:\n```javascript\nt.prototype.componentWillMount = function () {\n        var e = this.getCtx().nav.waypoint.query,\n        t = e.extcss,\n        n = e.affParams,\n        a = e.minWords;\n        this.affParams = n ? JSON.parse(decodeURIComponent(n))  : {\n        },\n        this.minWords = parseInt(a, 10),\n        t \u0026\u0026 this.addExternalCss(t)\n      },\n      t.prototype.addExternalCss = function (e) {\n        var t = document.createElement('link');\n        t.setAttribute('href', e),\n        t.setAttribute('rel', 'stylesheet'),\n        t.setAttribute('type', 'text/css'),\n        document.head.appendChild(t)\n      },\n```\nWhich allows an external css file to be loaded via the extcss parameter without any kind of origin checking or filtering.\n\n## Browsers Verified In:\n\nChrome Version 72.0.3626.109\nFirefox 65.0.1\n\n## Steps To Reproduce:\n1. Visit ```https://www.grammarly.com/embedded?height=300\u0026extcss=https://www.dl.dropboxusercontent.com/s/e0g51ibqswh0v7d/xss.css?dl=0```\n\n## Supporting Material/References:\n\n  * CSS Injection can be used to create a phishing page like so:\n{F429327}\n\n## Impact\n\nAn attacker can use an external css file to spoof the page to their liking allowing for phishing attacks and if the victim is on an older browser an attacker can execute javascript as well.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":429327,"file_name":"css_injection.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/429/327/54badf6c8fc853d0caad67d63f4210d751184a35/css_injection.png?response-content-disposition=attachment%3B%20filename%3D%22css_injection.png%22%3B%20filename%2A%3DUTF-8%27%27css_injection.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150640Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9ec68550b18a7aadaa80853eb232df57fd6bf95f93099bbf0f03556037643b7c","file_size":42464,"type":"image/png"}],"allow_singular_disclosure_at":"2019-05-25T02:29:47.286Z","allow_singular_disclosure_after":-75213412.78663462,"singular_disclosure_allowed":true,"vote_count":59,"voters":["dee-see","gamer7112","foobar7","base_64","spam404","kushaldhkl","mik317","ali","metnew","katsuragicsl","and 49 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":1366,"asset_type":"URL","asset_identifier":"www.grammarly.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4201858,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-02-24T16:40:15.196Z","updated_at":"2019-02-24T16:40:15.196Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":302143,"new_severity_id":302217},"actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4201862,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-02-24T16:41:04.000Z","updated_at":"2019-02-24T16:41:04.000Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4202528,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @gamer7112,\n\nThanks for your report!\nThe issue allows the attacker to manipulate only CSS and not HTML/DOM, code execution isn't possible. \nSo, it seems to be a \"Content spoofing / UI redressing\" vulnerability, rather than an XSS.\n\"Low\" severity seems more appropriate.","automated_response":false,"created_at":"2019-02-24T21:56:55.354Z","updated_at":"2019-02-24T21:56:55.354Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4202552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agreed. Appreciate the quick triage @vladimir_suslenko ","automated_response":false,"created_at":"2019-02-24T22:13:59.557Z","updated_at":"2019-02-24T22:13:59.557Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4203687,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-02-25T08:00:33.885Z","updated_at":"2019-02-25T08:00:33.885Z","actor":{"url":"/grammarly","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Grammarly"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grammarly","collaborator":{"username":"gamer7112","url":"/gamer7112"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4595294,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-04-18T23:58:34.087Z","updated_at":"2019-04-18T23:58:34.087Z","additional_data":{"old_title":"DOM Based CSS/XSS Injection on grammarly.com","new_title":"Reflected CSS Injection on grammarly.com"},"actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4595295,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @gamer7112,\n\nThis must be resolved now. Could you validate the fix?","automated_response":false,"created_at":"2019-04-18T23:59:01.369Z","updated_at":"2019-04-18T23:59:01.369Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"gamer7112","url":"/gamer7112"},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4595325,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed fixed.","automated_response":false,"created_at":"2019-04-19T00:22:40.035Z","updated_at":"2019-04-19T00:22:40.035Z","actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4595333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @gamer7112!","automated_response":false,"created_at":"2019-04-19T00:27:40.657Z","updated_at":"2019-04-19T00:27:40.657Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4638439,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this?","automated_response":false,"created_at":"2019-04-25T02:29:47.198Z","updated_at":"2019-04-25T02:29:47.198Z","first_to_agree":true,"actor":{"username":"gamer7112","cleared":false,"url":"/gamer7112","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4641520,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-04-25T13:19:28.449Z","updated_at":"2019-04-25T13:19:28.449Z","additional_data":{"old_title":"Reflected CSS Injection on grammarly.com","new_title":"DOM based CSS Injection on grammarly.com"},"actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4753018,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-05-06T09:11:54.616Z","updated_at":"2019-05-06T09:11:54.616Z","actor":{"username":"andriy_derevyanko","cleared":false,"url":"/andriy_derevyanko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/232/429/8d025f5ca823ddfa62ce186084ff79b3e72542ed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4753019,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-06T09:11:54.714Z","updated_at":"2019-05-06T09:11:54.714Z","actor":{"username":"andriy_derevyanko","cleared":false,"url":"/andriy_derevyanko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/232/429/8d025f5ca823ddfa62ce186084ff79b3e72542ed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}