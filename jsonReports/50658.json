{"id":50658,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDY1OA==","url":"https://hackerone.com/reports/50658","title":"Reflected File Download attack allows attacker to 'upload' executables to hackerone.com domain","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-09T10:20:23.347Z","submitted_at":"2015-03-09T10:20:23.347Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rickypaipie","url":"/rickypaipie","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-16T10:21:21.121Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-03-17T10:21:15.569Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi hackerone team,\r\n\r\nI'm a friend of Peiying and am looking for a position at hackerone. While playing around with your product, I found a serious vulnerability in your application: it allows attackers to craft executables on the hackerone.com domain rather than the sandboxed one on S3.\r\n\r\n1. attacker reports a bug titled `hackerone\\\"||calc||`\r\n2. attacker can then direct victim to [https://hackerone.com/notifications.bat](https://hackerone.com/notifications.bat)\r\n3. when downloaded and executed, it will open calculator on victim's windows environment\r\n\r\nThe potentials of this vector is outlined in [Reflected File Download: A New Web Attack Vector](https://www.trustwave.com/Resources/SpiderLabs-Blog/Reflected-File-Download---A-New-Web-Attack-Vector/), which does not limit to executing commands on victim's machines.\r\n\r\nTo fix, since hackerone is a Rails deployment, at the rendering step of the notifications action:\r\n\r\ninstead of:\r\n\r\n`render json: notifications`\r\n\r\ndo:\r\n\r\n    respond_to do |format|\r\n        format.json do\r\n            render json: notifications\r\n        end\r\n    end\r\n\r\nso requests of non-json formats would return a 406 Not Acceptable. see [respond_to](http://apidock.com/rails/ActionController/MimeResponds/InstanceMethods/respond_to).\r\n\r\nLook forward to hearing back from you soon,\r\n\r\nRicky","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":31223,"file_name":"rfd.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/031/223/c0e8ad2bb3d94f1ae1051e18281df5ff1d2709c3/rfd.jpg?response-content-disposition=attachment%3B%20filename%3D%22rfd.jpg%22%3B%20filename%2A%3DUTF-8%27%27rfd.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150735Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e1c976604217f651e7a7fdfe6fcf953fde5ad34310f36111c20676861434b967","file_size":153754,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2015-04-16T10:21:16.599Z","allow_singular_disclosure_after":-204785179.004083,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":348940,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @rickypaipie, we're looking into this.","automated_response":false,"created_at":"2015-03-09T10:26:47.119Z","updated_at":"2015-03-09T10:26:47.119Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348943,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks, for your ~~application~~ report. We will investigate this issue.","automated_response":false,"created_at":"2015-03-09T10:27:22.303Z","updated_at":"2015-03-09T10:27:22.303Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":348947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"wow fast response. I hope I didn't wake you two up!","automated_response":false,"created_at":"2015-03-09T10:34:41.428Z","updated_at":"2015-03-09T10:34:41.428Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`Time Zone: Europe/Amsterdam`","automated_response":false,"created_at":"2015-03-09T10:42:51.802Z","updated_at":"2015-03-09T10:42:51.802Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":351180,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've recently pushed a fix to production that should solve this behavior. Could you please verify that the behavior you described is changed for this endpoint?","automated_response":false,"created_at":"2015-03-11T15:39:17.326Z","updated_at":"2015-03-11T15:39:17.326Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rickypaipie","url":"/rickypaipie"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It returns a 406 now with a .bat extension. This should prevent future RFD attacks","automated_response":false,"created_at":"2015-03-13T16:00:00.500Z","updated_at":"2015-03-13T16:00:00.500Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":356650,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-03-17T10:21:05.255Z","updated_at":"2015-03-17T10:21:05.255Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":356651,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-03-17T10:21:15.607Z","updated_at":"2015-03-17T10:21:15.607Z","first_to_agree":true,"actor":{"username":"mvgijssel","cleared":false,"url":"/mvgijssel","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/gb2uj2hl5ifqjswayjze2m51nwcg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22T0254389F-WR4TEKGDC-b7d20a1e2b79-512.jpeg%22%3B%20filename%2A%3DUTF-8%27%27T0254389F-WR4TEKGDC-b7d20a1e2b79-512.jpeg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150735Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=dcb36ef2bc11a8ec620a66aef88646ccca4c491ef35d9f25dec12ae43c3227d3"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":357195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rickypaipie Thanks again for your report and verifying the fix. We just wanted to follow-up that this isn't consider a viable security issue due to both the high barrier to entry (\"To affect a user, he/she must be in a team with the attacker\") and who our customers and clients are, so this won't be eligible for a bounty (only hall of fame).","automated_response":false,"created_at":"2015-03-17T22:28:49.694Z","updated_at":"2015-03-17T22:28:49.694Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":359833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem. For a clarification. When an external party reports a new bug, does a notification item gets added? I couldn't test this scenario because I didn't have a live bounty program to test. That said, as soon as the bug was created, any activity including comments from other team members, would trigger the notification being generated and hence the payload being active. This would have allowed attackers to target any users who is part of an active bounty program.","automated_response":false,"created_at":"2015-03-21T03:31:43.181Z","updated_at":"2015-03-21T03:31:43.181Z","actor":{"username":"rickypaipie","cleared":false,"url":"/rickypaipie","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":381762,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-04-16T10:21:21.266Z","updated_at":"2015-04-16T10:21:21.266Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delayed response! Yes, you are correct that a bug report does generate a notification. An attacker could target a bounty program, but given that they still have to download and run the bat file this is still a high barrier issue.\n\nHappy hacking!","automated_response":false,"created_at":"2015-04-16T18:58:14.024Z","updated_at":"2015-04-16T18:58:14.024Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}