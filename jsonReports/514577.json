{"id":514577,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTQ1Nzc=","url":"https://hackerone.com/reports/514577","title":"Failure to Invalid Session after Password Change","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-24T17:48:05.458Z","submitted_at":"2019-03-24T17:48:05.458Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d3tonator","url":"/d3tonator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/p3aFEDoVCzEZ9ucFQkQDvPoE/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21045,"url":"https://hackerone.com/omise","handle":"omise","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Omise","twitter_handle":"omise","website":"https://www.omise.co","about":"Next generation of payment Platform"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-08T17:43:41.548Z","bug_reporter_agreed_on_going_public_at":"2019-11-08T17:43:40.528Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While conducting my researching I discovered that the application Failure to invalidate session after password.  In this scenario changing the password doesn't destroys the other sessions which are logged in with old passwords.\n\nSteps to Reproduce:\n----------------------\n\u003eVideo PoC attached\n\n###Step By Step:\n-\u003eLogin with the same account in Chrome and Firefox Simultaneously\n-\u003eChange the pass in Chrome Browser\n-\u003eGo to firefox and Update any information, information will be update *If attacker login with firefox and user know his password stolen so even user change their password, his account remain insecure and attacker have full access of victim account.\n\n###Mitigation\nWhen some change in user password, each and every active sessions that belongs to that particular account must be destroyed!\nI would like to recommend you to add a process that asks users whether user want to close all open sessions or not right after changing password.\n\nSo there is two way, either you let users to choose if they want to keep active sessions or just destroy every active sessions when an users change his/her password!\n\nPlease fix this Vulnerability and let me know. Looking forward to hear from you.\n\nBest Regards\n\n## Impact\n\nIf attacker have user password and logged in different places, As other sessions is not destroyed, attacker will be still logged in your account even after changing password, cause his session is still active.. Malicious actor can complete access your account till that session expires! So, your account remains insecure even after the changing of password","weakness":{"id":90,"name":"Insufficient Session Expiration"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":451197,"file_name":"Omise_Session_Not_Expire_.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/451/197/9303e72eaeeabe8ed8ad1a0e5fd3c4855753ced8/Omise_Session_Not_Expire_.mp4?response-content-disposition=attachment%3B%20filename%3D%22Omise_Session_Not_Expire_.mp4%22%3B%20filename%2A%3DUTF-8%27%27Omise_Session_Not_Expire_.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150840Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=68b6fa800d3107d2763e0bcedd640ce4c9e260a89e90671a578fc57922712c13","file_size":1981166,"type":"video/mp4"}],"allow_singular_disclosure_at":"2019-12-08T17:43:40.568Z","allow_singular_disclosure_after":-58137900.0850309,"singular_disclosure_allowed":true,"vote_count":13,"voters":["sameerphad72","nipe","udit_thakkur","darkerhack","logintest","cryptographer","ticzox","armansameer","c1ph3r984","daval0","and 3 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":21896,"asset_type":"URL","asset_identifier":"www.omise.co","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4382264,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the research, \nThis has been up for discussion before. We have session management page where the user can as you say choose at any time to revoke one or all sessions, not only when they change password but if in any case they feel they need to revoke some of their logged in sessions.  We also have session timeout so they are not logged in forever. \n\nWe think this is enough to mitigate this risk, and the user have full control over what session is alive and when. \n\nWe give you points anyways since report was in a good way, and had a lot of info. We can understand the point of view that you want this to be automatic action dependent on especially password change, but the generic session management we think are better, and allows for many user cases for the user to protect against different types of risks. \n\nbest regards\nOmise Security \n","automated_response":false,"created_at":"2019-03-25T01:47:55.541Z","updated_at":"2019-03-25T01:47:55.541Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"d3tonator","url":"/d3tonator"},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4382265,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2019-03-25T01:48:35.168Z","updated_at":"2019-03-25T01:48:35.168Z","actor":{"url":"/omise","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Omise"}},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6256674,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-08T17:43:40.543Z","updated_at":"2019-11-08T17:43:40.543Z","first_to_agree":true,"actor":{"username":"d3tonator","cleared":false,"url":"/d3tonator","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/p3aFEDoVCzEZ9ucFQkQDvPoE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6497451,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-08T17:43:41.569Z","updated_at":"2019-12-08T17:43:41.569Z","actor":{"url":"/omise","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Omise"}},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}