{"id":520630,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjA2MzA=","url":"https://hackerone.com/reports/520630","title":"(Prerelease UI) Stored XSS via role name in JSON chart","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-04-02T06:14:19.880Z","submitted_at":"2019-04-02T06:14:19.880Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-24T15:03:53.228Z","bug_reporter_agreed_on_going_public_at":"2020-08-20T02:41:07.988Z","team_member_agreed_on_going_public_at":"2020-08-24T15:03:53.076Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"When ████████ is released to the public, and you aren't someone like me who has to hack their way around to get access to it (see: #520623) there will be a stored XSS in the chart builder section because of unsanitization of the role name when it is displayed as JSON within the chart visualization. \n\n## Steps to Reproduce\n1. Enable ███████ if you haven't done so already, or follow my steps outlined in #520623 if you want to hack your way around it\n2. Navigate to `https://account.newrelic.com/accounts/YOUR_ACCOUNT_ID/roles`\n3. Click on \"New custom add-on role\" and name the role: \n\n```\n/*\\\"\u003csVg/oNloAd=alert(document.domain)//\u003e\\x3e\n```\n4. Click \"Create Role\" after you've assigned it any permission \n5. Now, as another user navigate to the https://one.newrelic.com homepage\n6. Click on \"Chart builder\" in the upper right hand corner\n7. Click the \"Advanced (NRQL)\" button\n8. Run the following NRQL query: `SELECT * FROM NrAuditEvent SINCE 10 month ago`\n9. Click Run Query\n10. Once the query has run, change the chart type to `JSON`\n\nYou payload of the recently created role will fire within the context of the JSON response:\n\n{F459798}\n\n## Impact\n\nStored XSS against other account users. This was tested in the latest version of Firefox.","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":459798,"file_name":"Screen_Shot_2019-04-01_at_10.57.40_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/798/47d0a02adc724c92f1e365ef33f63a52885b9312/Screen_Shot_2019-04-01_at_10.57.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-01_at_10.57.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-01_at_10.57.40_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fb2c6ed65feabfbe32f45e44092465c35dd206be8df7f7b483a174b4b03e1f64","file_size":273075,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-19T02:41:08.023Z","allow_singular_disclosure_after":-33481673.39798397,"singular_disclosure_allowed":true,"vote_count":47,"voters":["wi11","ltidi","ali","ahiezer","mattberg","codeur","cr4xerbik4sh","bb00x","w1th0ut","harounty","and 37 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":4405,"asset_type":"URL","asset_identifier":"*.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4449969,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @jon_bottarini,\n\nNice find! I was able to replicate this report, and it is in scope for a High severity and reward. Thank you for submitting this!\n\nWe will keep you up to date on resolution.\n\n-- Josh\n","automated_response":false,"created_at":"2019-04-02T18:10:34.162Z","updated_at":"2019-04-02T18:11:35.519Z","actor":{"username":"jfarwell","cleared":false,"url":"/jfarwell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4449981,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-04-02T18:12:05.701Z","updated_at":"2019-04-02T18:12:05.701Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4450278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Appreciate it very much! After over two years of hunting on New Relic... this is my first XSS of any kind. Amazed it's taken me this long but it's super hard to find on NR! ","automated_response":false,"created_at":"2019-04-02T18:24:07.446Z","updated_at":"2019-04-02T18:25:54.331Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4621163,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jon_bottarini,\n\nCongrats on your first New Relic XSS! We now believe this issue to be resolved. Please let us know if you are still able to reproduce this issue in Production and we can check again.\n\nThank you for your report!","automated_response":false,"created_at":"2019-04-22T21:30:21.579Z","updated_at":"2019-04-22T21:30:21.579Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8984332,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-20T02:41:08.007Z","updated_at":"2020-08-20T02:41:08.007Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9024590,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-08-24T15:02:53.542Z","updated_at":"2020-08-24T15:03:26.630Z","additional_data":{"old_title":"(██████) Stored XSS via role name in JSON chart","new_title":"(Prerelease UI) Stored XSS via role name in JSON chart"},"actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9024601,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-24T15:03:53.153Z","updated_at":"2020-08-24T15:03:53.153Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9024602,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-24T15:03:53.259Z","updated_at":"2020-08-24T15:03:53.259Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}