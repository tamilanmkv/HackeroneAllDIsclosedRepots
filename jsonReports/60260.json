{"id":60260,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MDI2MA==","url":"https://hackerone.com/reports/60260","title":"Misconfigured SPF Record Flag","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-05-08T21:51:16.563Z","submitted_at":"2015-05-08T21:51:16.563Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geekboy","url":"/geekboy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/547/b8825b0ae39f962fbe7813bf40d4efe19d018ee9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1566,"url":"https://hackerone.com/udemy","handle":"udemy","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/2nhagtc6ifg2irjlbxo2tyl35qhu/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c?response-content-disposition=inline%3B%20filename%3D%22android-chrome-512x512.png%22%3B%20filename%2A%3DUTF-8%27%27android-chrome-512x512.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151244Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8edeeb46abacf6b74020f6a1c8b1c4071616ad91d48c9ac05175d41124b687dd","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/2nhagtc6ifg2irjlbxo2tyl35qhu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22android-chrome-512x512.png%22%3B%20filename%2A%3DUTF-8%27%27android-chrome-512x512.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151244Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4d7906d2968290aab007b80612b4d4fc86051b140df77122a8724a123b39bd03"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Udemy","twitter_handle":"","website":"http://udemy.com","about":"We’re the world’s online learning marketplace, with courses in everything from programming to yoga to photography."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-22T23:57:14.979Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-06-16T23:20:12.579Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team , \r\n\r\n####Description : \r\nthis report is about misconfigured spf record flag , which can be use to abuse the organization by posing the identity , which allowing to fake mailing on behalf of respected organization .\r\n\r\n####About the Issue : \r\nas i seen the __SPF__  and __TXT__ record for the __Udemy.com__ which is : \r\n````\r\nv=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com ~all \r\n``````\r\nas u can see the symbol at last which Tilde (__~all__) is the issue , which should be replace by Hyphen (__-all__) symbol . \r\n\r\nso valid record will be look like : \r\n````\r\nv=spf1 include:_spf.google.com include:smtp1.uservoice.com include:mktomail.com -all \r\n```\r\n\r\n####Whats the issue : \r\nas u can see in the article  difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. \r\nin current SPF record you should replace ~ with - at last before all , - is strict which prevents all spoofed emails except if you are sending .\r\n\r\n\r\n####Attack Scenario :\r\nan attacker will send phishing mail or anything malicious mail to the victim via mail : __security@Udemy.com__ , even if the victim is aware of phishing attack , he will check the Origin email which will be __security@Udemy.com__ , so he will be sure that its not fake mail and get trapped by attacker !  \r\n\r\nThis can be done using any php mailer tool like this , \r\n````\r\n\u003c?php\r\n$to = \"VICTIM@example.com\";\r\n$subject = \"Password Change\";\r\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\r\n$headers = \"From: security@Udemy.com\";\r\nmail($to,$subject,$txt,$headers);\r\n?\u003e\r\n````\r\n\r\n__u can check your SPF record form here : http://www.kitterman.com/spf/validate.html__ !\r\n\r\n####Reference : https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\r\nhave a look on the __digitalocean__ article for the better understanding !\r\n\r\nPlease let me know if any more info needed !\r\n\r\n__Thank You\r\nGeekboy :)__\r\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-16T23:20:13.054Z","allow_singular_disclosure_after":-196876351.328992,"singular_disclosure_allowed":true,"vote_count":1,"voters":["biswajit_"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":413421,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We have considered the ~all vs -all, and have determined that the increase in security is outweighed with the additional deliverability problems switching would cause. You will see that google.com also uses the ~all.","automated_response":false,"created_at":"2015-05-16T20:09:16.758Z","updated_at":"2015-05-16T20:09:16.758Z","actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":474730,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-16T23:20:12.656Z","updated_at":"2015-06-16T23:20:12.656Z","first_to_agree":true,"actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":808206,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2016-02-22T23:57:14.783Z","updated_at":"2016-02-22T23:57:14.783Z","actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}