{"id":637840,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Mzc4NDA=","url":"https://hackerone.com/reports/637840","title":"Path traversal in command line client","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-08T19:17:44.126Z","submitted_at":"2019-07-08T19:17:44.126Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lixtelnis","url":"/lixtelnis","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/217/345/ef5da885a475b517a6125be9e33f018984c84d5b_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8724,"url":"https://hackerone.com/mariadb","handle":"mariadb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"MariaDB","twitter_handle":"mariadb_org","website":"https://mariadb.org","about":"MariaDB is a high performance, open source database that helps the world's busiest websites deliver more content, faster."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-28T18:59:16.286Z","bug_reporter_agreed_on_going_public_at":"2020-05-28T18:59:16.213Z","team_member_agreed_on_going_public_at":"2020-05-26T19:06:10.086Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The command line client has a directory traversal bug which allows server chosen files to be dlopened when it connects to a malicious server.\n\nThe path can also be padded with `/` characters so that `strxnmov` drops the `.so` extension.\n\nThe `dlopen` call is performed here: \u003chttps://github.com/MariaDB/server/blob/10.5/sql-common/client_plugin.c#L368\u003e\n\n## Impact\n\nIn rare situations where the attacker controls a file at a known location on the victim's machine this can lead to code execution using `init/fini` functions. See attached `dlopen.sh`.\n\nOther side effects present in commonly installed software are not to be neglected. The mecanism is far from being uncommon in C files alone according to this search:\n\n\u003chttps://codesearch.debian.net/search?q=__attribute__.*constructor+filetype%3Ac\u0026perpkg=1\u003e\n\nWithout abusing the path traversal bug the dialog plugin might also be used to fool a user into sending its password unhashed. See attached `dialog.sh`.","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":524519,"file_name":"disc.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/524/519/b9e9387f9d6bb72b7d60a11139d669a9031623aa/disc.zip?response-content-disposition=attachment%3B%20filename%3D%22disc.zip%22%3B%20filename%2A%3DUTF-8%27%27disc.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151407Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a93a17119c69f2c622fcedaac7c006fb1277a6914f62816fde67f5ed1401541c","file_size":2574,"type":"application/zip"}],"allow_singular_disclosure_at":"2020-06-25T19:06:10.181Z","allow_singular_disclosure_after":-40853277.45909794,"singular_disclosure_allowed":true,"vote_count":3,"voters":["brahim_boufakri01","lakuapik","giogom"],"severity":{"rating":"medium","score":4.5,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":10336,"asset_type":"SOURCE_CODE","asset_identifier":"MariaDB Server \u0026 Connectors - Data corruption, exfiltration, disclosure","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5279317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi ,\n\nThanks for your submission,\n\nWe received your report. We will asses its validity and evaluate the risk as soon as possible and come back to you.\n\nRegards,\nMariaDB Security Team","automated_response":false,"created_at":"2019-07-09T07:17:34.253Z","updated_at":"2019-07-09T07:17:34.253Z","actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5305393,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi again,\n\nI'm trying to reproduce the path traversal using your sample, however, it does not load for me:\n```\n./dlopen.sh\nERROR 2013 (HY000): Plugin /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////../../../../../../../../Users/shinnok/Downloads/h1/init.elf could not be loaded: dlopen(/usr/lo\n```\n\nWhich platform did you try this on? And did you manage to execute the exports in init.c fully, if so can you share more details about your exact set-up? The way the *strxnmov* path compilation is done looks like it should always prepend the installation plugin_dir prefix to the path, which is truncated in the error output in my case and it is /usr/local/. This is unless it is being run without an installation in place and run from a local directory using *./mysql*, say from a build dir.\n\nIn any case, I'm pinging @vuvova here, who is the last to touch that piece in client_plugin.c looking with git blame.\n\nRegards,","automated_response":false,"created_at":"2019-07-12T09:10:28.695Z","updated_at":"2019-07-12T09:10:28.695Z","actor":{"username":"teodor","cleared":false,"url":"/teodor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5309106,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nYes, the amount of `../` needed is very installation dependent. The poc is setup for debian buster where plugins are placed in `/lib/x86_64-linux-gnu/mariadb19/plugin`. When successful `init` and `fini` are printed.","automated_response":false,"created_at":"2019-07-12T15:46:17.050Z","updated_at":"2019-07-12T15:46:17.050Z","actor":{"username":"lixtelnis","cleared":false,"url":"/lixtelnis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/345/ef5da885a475b517a6125be9e33f018984c84d5b_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5386592,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! We'll fix it. The fixed version should be released within few weeks","automated_response":false,"created_at":"2019-07-22T09:49:08.920Z","updated_at":"2019-07-22T09:49:08.920Z","actor":{"username":"vuvova","cleared":false,"url":"/vuvova","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5386690,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-07-22T09:55:04.918Z","updated_at":"2019-07-22T09:55:04.918Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.5)","old_severity_id":453414,"new_severity_id":469596},"actor":{"username":"vuvova","cleared":false,"url":"/vuvova","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5386691,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-07-22T09:55:21.966Z","updated_at":"2019-07-22T09:55:21.966Z","actor":{"username":"vuvova","cleared":false,"url":"/vuvova","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5486751,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks. This is now fixed and released in MariaDB Server 5.5.56, 10.1.41, 10.2.26, 10.3.17, 10.4.7 and in MariaDB Connector/C 3.1.3","automated_response":false,"created_at":"2019-08-02T10:10:25.217Z","updated_at":"2019-08-02T10:10:25.217Z","actor":{"username":"vuvova","cleared":false,"url":"/vuvova","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lixtelnis","url":"/lixtelnis"},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8111226,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-26T19:06:10.114Z","updated_at":"2020-05-26T19:06:10.114Z","first_to_agree":true,"actor":{"username":"vuvova","cleared":false,"url":"/vuvova","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8135883,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-28T18:59:16.244Z","updated_at":"2020-05-28T18:59:16.244Z","actor":{"username":"lixtelnis","cleared":false,"url":"/lixtelnis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/345/ef5da885a475b517a6125be9e33f018984c84d5b_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8135884,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-28T18:59:16.339Z","updated_at":"2020-05-28T18:59:16.339Z","actor":{"username":"lixtelnis","cleared":false,"url":"/lixtelnis","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/345/ef5da885a475b517a6125be9e33f018984c84d5b_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}