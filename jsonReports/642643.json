{"id":642643,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDI2NDM=","url":"https://hackerone.com/reports/642643","title":"Bypass _token in forms [Merchant.Kartpay.com ]","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2019-07-13T21:45:32.663Z","submitted_at":"2019-07-13T21:45:32.663Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zxdrrr","url":"/zxdrrr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22925,"url":"https://hackerone.com/kartpay","handle":"kartpay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/925/d481af80adf6cd2b19449b09c785cb232f74eeba_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/925/d481af80adf6cd2b19449b09c785cb232f74eeba_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kartpay","twitter_handle":"","website":"http://Kartpay.com","about":"Kartpay is an Online Payment Gateway For Indian Region."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-09T05:34:18.970Z","bug_reporter_agreed_on_going_public_at":"2019-09-24T14:56:17.872Z","team_member_agreed_on_going_public_at":"2019-10-09T05:34:18.863Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nI found a issue in froms related to the Merchant.Kartpay.com domain and it allow to bypassing _token.\n\n## Browsers Verified In:\n\n  *  Firefox 68\n\n## Steps To Reproduce:\n\n  1. Go To Login or any form (https://merchant.kartpay.com/merchant_login)\n  2. Fill form and Intercept in burpsuite next click on LOGIN\n  3. Request :\n\n```\nPOST /login HTTP/1.1\nHost: merchant.kartpay.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://merchant.kartpay.com/merchant_login\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 112\nConnection: close\nCookie: laravel_session=eyJpdiI6ImU3TkIxd21yXC81SE1rNHlSSnExV3JBPT0iLCJ2YWx1ZSI6IkFmYUMrTEJzXC8rM1VoaWVpUldJN1RGV0doUkZPQ09laThzSHo0dEI4cjgraFhsYWJCSThwK3FkYUNnbjA1OXhNIiwibWFjIjoiNWFkY2E4YmVmYzM4NWYwMzAxN2MwMDZiMjg1MTJlYTdjMGExNDMzMmU3MDk3YjRhMTk4OTg4YmMzYzFjMjk4ZSJ9; XSRF-TOKEN=eyJpdiI6Ink5TmNERjF6UHJnV2NuMjQ5dVB2YUE9PSIsInZhbHVlIjoicEI5SFpxZzd3bkhYeDRBZlNyZWRZZWpcL1wvQTkrR1llbENCUExFYmh0Mk9uaXNxSkp4MTg0d2xHM0NYdVVQRk1cLyIsIm1hYyI6ImM4ODFiMzFkZGY5MzBmNDhiNmU0ZGYxODM3YzZiYmQ0Y2E0ZDkwOGY2MWU1Y2U4ZGNmMGY4Yzg5ZGE1MDk1OWMifQ%3D%3D\nUpgrade-Insecure-Requests: 1\n\n_token=877NUN0kNyUQUP8aRDpdjbHnHteOKr6PvfxMsbv4\u0026merchant_id=123456789\u0026email=test%40gmail.com\u0026password=P%40ssw0rd\n```\nRemove _toekn in request like this and forward request:\n```\nPOST /login HTTP/1.1\nHost: merchant.kartpay.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://merchant.kartpay.com/merchant_login\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 112\nConnection: close\nCookie: laravel_session=eyJpdiI6ImU3TkIxd21yXC81SE1rNHlSSnExV3JBPT0iLCJ2YWx1ZSI6IkFmYUMrTEJzXC8rM1VoaWVpUldJN1RGV0doUkZPQ09laThzSHo0dEI4cjgraFhsYWJCSThwK3FkYUNnbjA1OXhNIiwibWFjIjoiNWFkY2E4YmVmYzM4NWYwMzAxN2MwMDZiMjg1MTJlYTdjMGExNDMzMmU3MDk3YjRhMTk4OTg4YmMzYzFjMjk4ZSJ9; XSRF-TOKEN=eyJpdiI6Ink5TmNERjF6UHJnV2NuMjQ5dVB2YUE9PSIsInZhbHVlIjoicEI5SFpxZzd3bkhYeDRBZlNyZWRZZWpcL1wvQTkrR1llbENCUExFYmh0Mk9uaXNxSkp4MTg0d2xHM0NYdVVQRk1cLyIsIm1hYyI6ImM4ODFiMzFkZGY5MzBmNDhiNmU0ZGYxODM3YzZiYmQ0Y2E0ZDkwOGY2MWU1Y2U4ZGNmMGY4Yzg5ZGE1MDk1OWMifQ%3D%3D\nUpgrade-Insecure-Requests: 1\n\nmerchant_id=123456789\u0026email=test%40gmail.com\u0026password=P%40ssw0rd\n```\nrequest was do successfully.\n\n## Impact\n\nAttacke can bypass _token to do some work like brute force and such as...","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-24T14:56:17.919Z","allow_singular_disclosure_after":-62036288.59825117,"singular_disclosure_allowed":true,"vote_count":25,"voters":["sameerphad72","prophet","dhakal_bibek","notgerson","domssilva","sa1tama0","cryptographer","jeffreyshran","zxdrrr","nims786","and 15 more..."],"severity":{"rating":"none","author_type":"User"},"structured_scope":{"databaseId":3965,"asset_type":"URL","asset_identifier":"*.kartpay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5316205,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-07-13T21:46:07.924Z","updated_at":"2019-07-13T21:46:07.924Z","additional_data":{"old_title":"Bypass _token in forms [Merchant.Kartpay.com]","new_title":"Bypass _token in forms [Merchant.Kartpay.com ]"},"actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5316209,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-07-13T21:47:18.323Z","updated_at":"2019-07-13T21:47:18.323Z","additional_data":{"old_title":"Bypass _token in forms [Merchant.Kartpay.com ]","new_title":"Security Misconfiguration allow to bypass email verification in Merchant.Kartpay.com"},"actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5316212,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-07-13T21:48:25.891Z","updated_at":"2019-07-13T21:48:25.891Z","additional_data":{"old_title":"Security Misconfiguration allow to bypass email verification in Merchant.Kartpay.com","new_title":"Bypass _token in forms [Merchant.Kartpay.com ]"},"actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5317857,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@0xche - Hey, Thanks for reporting the Issue. Can you share the Video of the above Process ? ","automated_response":false,"created_at":"2019-07-14T09:10:30.186Z","updated_at":"2019-07-14T09:10:30.186Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5318014,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi again\nit's video.","automated_response":false,"created_at":"2019-07-14T10:47:39.880Z","updated_at":"2019-07-14T10:47:39.880Z","actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5318042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached","automated_response":false,"created_at":"2019-07-14T11:06:04.959Z","updated_at":"2019-07-14T11:06:04.959Z","actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":528888,"filename":"token.avi","type":"video/x-msvideo","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/528/888/9bd4cecf33630c2b116bb4163f126cccbe023e91/token.avi?response-content-disposition=attachment%3B%20filename%3D%22token.avi%22%3B%20filename%2A%3DUTF-8%27%27token.avi\u0026response-content-type=video%2Fx-msvideo\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4ac9c3363e137eb16b204a7a3d24cbe594afb3eec1d220fa91c34a5da8200659"}],"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5357485,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-07-18T12:30:31.572Z","updated_at":"2019-07-18T12:30:31.572Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5364154,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-07-18T19:36:53.593Z","updated_at":"2019-07-18T19:36:53.593Z","actor":{"username":"pbkyriak","cleared":false,"url":"/pbkyriak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5443718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you patch this vulnerability?!","automated_response":false,"created_at":"2019-07-27T08:40:49.790Z","updated_at":"2019-07-27T08:40:49.790Z","actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5479423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm patch?","automated_response":false,"created_at":"2019-08-01T12:35:29.701Z","updated_at":"2019-08-01T12:35:29.701Z","actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5488878,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@0xche - We are busy at the moment fixing other bugs, as per our Current workload this bug will be fixed in next 5 days. ","automated_response":false,"created_at":"2019-08-02T14:28:58.784Z","updated_at":"2019-08-02T14:28:58.784Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5556353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@0xche - Can you please check again? ","automated_response":false,"created_at":"2019-08-12T14:22:05.881Z","updated_at":"2019-08-12T14:22:05.881Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5713184,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-09-02T16:11:24.001Z","updated_at":"2019-09-02T16:11:24.001Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zxdrrr","url":"/zxdrrr"},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5878745,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-24T14:56:17.889Z","updated_at":"2019-09-24T14:56:17.889Z","first_to_agree":true,"actor":{"username":"zxdrrr","cleared":false,"url":"/zxdrrr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ge5mzADMjvP2jWG2aTPZb8xY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5991470,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-09T05:34:18.886Z","updated_at":"2019-10-09T05:34:18.886Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5991471,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-09T05:34:18.991Z","updated_at":"2019-10-09T05:34:18.991Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}