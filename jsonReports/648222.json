{"id":648222,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDgyMjI=","url":"https://hackerone.com/reports/648222","title":"[██████████] Unauthorized access to admin panel","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-07-17T18:15:38.779Z","submitted_at":"2019-07-17T18:15:38.779Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jarvis7","url":"/jarvis7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-14T16:52:06.670Z","bug_reporter_agreed_on_going_public_at":"2019-12-04T11:01:28.716Z","team_member_agreed_on_going_public_at":"2020-05-14T16:52:06.545Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In previous reports, I described vulnerabilities in a panel to which I had access. \n\n #512269\n #512693\n #512695\n\nI could log in to this site and then perform some attacks, such as SQL injection\\XSS or other bugs. But before the above vulnerabilities were considered by you, the possibility to bypass authorization on the site was disabled. And after that, the vulnerabilities could not be reproduced and I was forced to close my reports.\n\nRecently, I began to explore this site again. And I found that the developers have poorly implemented the restriction of authorization on the site. \n\nI can still get the contents of an authorized site. How? When I visit some pages of the site, I get a redirect to the authorization form. But in addition to the redirect, the response body also contains HTML code of auth site.\n\nLook this pages:\n\u003e https://███████/mission.php\n\u003e https://██████████/personnel.php\n\u003e https://███████/index.php\n\n### Steps to reproduce\n1) Turn on Live Interception in burp (Proxy-Intercept)\n2) Intercept request. Press right mouse button-\u003e Do intercept -\u003e Response this request\n█████████\n3) Delete this redirection\n████\n\nHere I can see a lot of private information\n\n\u003e https://█████████/personnel.php\n\n█████\n\n\u003e https://███/index.php\n\n███████\n\n## Impact\n\nIncorrect access restriction to the authorized interface of the site leads to information leakage.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["jarvis7","dastan_9408","omarelfarsaoui","sl33pyp0t4t0","mbg198618"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5351963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-07-17T18:15:39.125Z","updated_at":"2019-07-17T18:15:39.125Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5352588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another page with interesting information:\n\n\u003e https://██████████/mission.php?content=cifmcn\u0026rcnum=\n█████████","automated_response":false,"created_at":"2019-07-17T19:28:30.464Z","updated_at":"2020-05-14T16:15:31.963Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5363131,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Just be aware Jarvis, this is a test and demo site and not a production site.  I can't even register for an account for this site as it looks to have been disabled.  If you have credentials to log into this, please share them.\n\nWhat you should be doing is looking for the production site and checking if these vulnerabilities exist there...","automated_response":false,"created_at":"2019-07-18T17:30:25.109Z","updated_at":"2019-07-18T17:30:25.109Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5363406,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @ag3nt-j1 Thank you for a quick review of the report))\n\nOn this site I can not register an account, but this is the problem. I have already sent a report before and the site developers have fixed the vulnerability by disabling the authorization feature. In this report, I describe the problem in the site that arose during the correction process. In the report, I give examples of how an unauthorized user can get some private information. I can also access the internal functionality, I get the opportunity to test it. Due to the authorization bypass vulnerability, I found several XSS and new SQL injection.\n\nPerhaps this particular site is not production, but in scope of testing include all sited ```*.mil``` and this site too. I will consider your comment and will no longer send vulnerabilities from this site. But please consider the already submitted vulnerabilities, since I spent a lot of hours analyzing them....\n\nThanks to the authentication bypass vulnerability, I was able to find XSS for authenticated users and two SQL injections. \n\nRegards!","automated_response":false,"created_at":"2019-07-18T18:11:46.309Z","updated_at":"2019-07-18T18:12:07.981Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5364318,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There's nothing wrong with reporting a test and demo site but I need to be able to replicate your findings to validate them.  If I can't validate the reports I can't process them.  We've been through this before, you know how we handle this.  If you have a valid login account for these sites please share those credentials with me so I can validate your findings.  If not you know I am going to ask you to self close these reports.  I looked through the report history on this site and I don't see any reports on authentication bypass so If you have that report number please share it with me.  I want to help you out here but you know, if I can't replicate I can't validate and can't process.","automated_response":false,"created_at":"2019-07-18T20:07:36.863Z","updated_at":"2019-07-18T20:07:36.863Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5364403,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ag3nt-j1 \nLook, in order to validate this bug you  do not need an account.\n\nIn this report, I describe how a hacker without knowing some account can get access to private information on the site, as well as to some functionality on this site.  When a hacker goes to some pages of the site, he redirects to the authorization form, but the answer also contains some information (names, emails).\n\nFor example this link:\n\u003e https://███/personnel.php\n\n███\n\n### How get this page in your browser?\n Read steps-for-reproduce in report.\n\n### How should be? \nWhen I go (for example to https://███████/personnel.php), I must have only redirection without any content of response. \n\nP.S. Let's first solve all the issues with this report, and then I will explain why the rest of my sent reports are important.\n\nRegards!","automated_response":false,"created_at":"2019-07-18T20:22:48.455Z","updated_at":"2020-05-14T16:15:31.957Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5364448,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Use this request:\n\n```\nGET /personnel.php HTTP/1.1\nHost: ████\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: ru,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nCookie: JSESSIONID=████; __VCAP_ID__=███████; TS01771652=██████; TS01771652031=█████; TSf7f79454027=████\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Length: 1\n\n\t\n```\n\nResponse:\n███████\n\nIn this response you can see redirection to login page. But in content you can see some users and their emails. ","automated_response":false,"created_at":"2019-07-18T20:32:35.155Z","updated_at":"2020-05-14T16:18:53.087Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5364692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm getting them to work now, I had to delete the entire \"location:login.php\"  not just the \"login.php\".  You make me tired Jarvis.  Just so you are aware, none of the data here is production, all test.  Even the users and email accounts are from the TV show 'The Office\".  Will process this report as a high and the rest as mediums so the system owner will take notice.","automated_response":false,"created_at":"2019-07-18T20:37:11.028Z","updated_at":"2019-07-18T20:37:11.028Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5364731,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I do not know where these emails come from. And I don't know if this site is production. But I know e that when the site tries to redirect the user to the authorization page, there should be no private data in the response body, or information about the site panel (only the redirect to the authorization page is answered).","automated_response":false,"created_at":"2019-07-18T20:44:17.937Z","updated_at":"2019-07-18T20:44:17.937Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5364842,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-07-18T21:08:44.395Z","updated_at":"2019-07-18T21:08:44.395Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":466550},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5364844,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-07-18T21:08:45.390Z","updated_at":"2019-07-18T21:08:45.390Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5427194,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-07-25T12:17:05.224Z","updated_at":"2019-07-25T12:17:05.224Z","actor":{"username":"w0lv3rin3","cleared":false,"url":"/w0lv3rin3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/435/4c70234237da54fc2eac6227ebb622ebed77eece_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jarvis7","url":"/jarvis7"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6465322,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-04T11:01:28.734Z","updated_at":"2019-12-04T11:01:28.734Z","first_to_agree":true,"actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6467171,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will put it in the queue for disclosure.","automated_response":false,"created_at":"2019-12-04T15:50:51.534Z","updated_at":"2019-12-04T15:50:51.534Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6468659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks!","automated_response":false,"created_at":"2019-12-04T19:49:25.607Z","updated_at":"2019-12-04T19:49:25.607Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8002183,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2020-05-14T16:52:06.566Z","updated_at":"2020-05-14T16:52:06.566Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002184,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-14T16:52:06.693Z","updated_at":"2020-05-14T16:52:06.693Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002186,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2020-05-14T16:52:14.560Z","updated_at":"2020-05-14T16:52:14.560Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}