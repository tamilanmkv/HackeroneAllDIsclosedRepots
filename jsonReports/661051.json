{"id":661051,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjEwNTE=","url":"https://hackerone.com/reports/661051","title":"Message Authentication Codes calculated by the Default Encryption Module allow an attacker to silently overwrite blocks in a file","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-07-26T11:03:14.045Z","submitted_at":"2019-07-26T11:03:14.045Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yahe","url":"/yahe","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8133"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-05T07:59:48.349Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-06T07:59:48.071Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**First:** The default encryption module bundled with the Nextcloud Server creates SHA256-HMAC based message authentication codes for each individual 6072 byte-sized block of data. These are the steps to calculate the MAC:\n\n* Take the user password and harden it with SHA256-PBKDF2 (denoted as `$passPhrase` in \\[1\\]).\n* Concatenate `$passPhrase`, `$version` (which is the value `encrypted` from the `oc_filecache` table), `$position` (which is the zero-based index of the encrypted block within the file) and `\"a\"` and create a SHA512 hash of it (denoted as `$passPhrase` in \\[2\\]).\n* Most MACs of file blocks are created under the salt `hash('sha512', $passPhrase.$version.$position.\"a\", true)` with the exception of the last file block which uses the salt `hash('sha512', $passPhrase.$version.$position.\"end\".\"a\", true)`,\n* Finally create a SHA256-HMAC of the data under the salt `$passPhrase` (as seen in \\[3\\]).\n\n**Second:** An encrypted file uses the same file key (stored in the corresponding `fileKey` file) and envelope keys (stored in the corresponding `shareKey` files) as its stored file versions.\n\n**Third:** To prevent a file from being  truncated the last block uses a different salt (containing `\"end\"`). To prevent file blocks from being moved within a file each message authentication key contains the `$position` of the block within the file. To prevent file blocks from being moved between different versions of the same file each message authentication key contains the `$version` of the file.\n\n**Fourth:** However, the concatenation that is used to create message authentication key is ambiguous. It is e.g. not possible to differentiate between the block with `$position` 10 in `$version` 1 of a file (being `$passPhrase.\"1\".\"10\".\"a\"`) and the block with `$position` 0 in `$version` 11 of a file (being `$passPhrase.\"11\".\"0\".\"a\"`). This way the contents of a properly encrypted and signed file can be modified without breaking the signature check.\n\n**Fifth:** The following steps describe a simple proof of concept:\n\nCreate a file consisting of 6072 * 10 \"A\" + 6072 \"B\" + 1 \"1\":\n\n```\nphp -r 'print(str_repeat(\"A\", 6072*10).str_repeat(\"B\", 6072).\"1\");' \u003e./collision.txt\n```\n\nUpload the file to Nextcloud and visit the folder in which Nextcloud stored the encrypted and signed version of the file `./collision.txt`. Create a backup of the encrypted version 1:\n\n```\ncp ./collision.txt ./collision.txt.1\n```\n\nOpen the file in Nextcloud text editor and create 11 versions. The easiest way to do this is to scroll to the end of the file, add a character, press CTRL+S twice to make sure that the version has been created and proceed until the file has reached version 11. This can be checked in the database by issuing the following query:\n\n```\nselect encrypted from oc_filecache where path = 'files/collision.txt';\n```\n\nDownload the file to have a sample of the currently valid version of the file. Then overwrite the file block with `$position` 0 of `./collision.txt` with the file block with `$position` 11 of `./collision.txt.1`.\n\n```\ndd if=./collision.txt.1 of=./collision.txt bs=8192 conv=notrunc skip=11 seek=1 count=1\n```\n\nDownload the file again. When comparing the first download of the file with the second download of the file you should see that the first block of the file has been modified without breaking the signature check.\n\n1) [apps/encryption/lib/Crypto/Crypt.php#L194](https://github.com/nextcloud/server/blob/a374d8837d6de459500e619cf608e0721ea14574/apps/encryption/lib/Crypto/Crypt.php#L194)\n2) [apps/encryption/lib/Crypto/Crypt.php#L505](https://github.com/nextcloud/server/blob/a374d8837d6de459500e619cf608e0721ea14574/apps/encryption/lib/Crypto/Crypt.php#L505)\n3) [apps/encryption/lib/Crypto/Crypt.php#L506](https://github.com/nextcloud/server/blob/a374d8837d6de459500e619cf608e0721ea14574/apps/encryption/lib/Crypto/Crypt.php#L506)\n\n## Impact\n\nAn attacker that has permanent access to the file storage like an administrator or external storage provider can learn how many versions of which files exist without needing access to the database by monitoring the created version files over time.\n\nSuch an attacker is able to modify the contents of files by overwriting certain file blocks with specific file blocks from earlier versions of the same files. This file modification is possible **without** having access to any encryption secrets like passwords or keys.\n\nThis attack works against master-key encrypted files as well as against user-key encrypted files.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":539930,"file_name":"nextcloud_poc.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/539/930/61b8729f9104ed066d34b317a6b191c32d296a97/nextcloud_poc.mp4?response-content-disposition=attachment%3B%20filename%3D%22nextcloud_poc.mp4%22%3B%20filename%2A%3DUTF-8%27%27nextcloud_poc.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151529Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a2aa684b3046edaf8fa6204de302e8a02a12e942b0edf104e67212939ffa1a18","file_size":16580675,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-11-05T07:59:48.180Z","allow_singular_disclosure_after":-29402141.803994197,"singular_disclosure_allowed":true,"vote_count":8,"voters":["ali","realtess","demonia","4r75y4n4rch157","joe_glueck","papa_sm1rf","helphen","a21aqwqq"],"severity":{"rating":"low","score":1.8,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5436903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-07-26T11:03:17.177Z","updated_at":"2019-07-26T11:03:17.177Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5479368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThanks for the detailed report.\nI have to dive into this a bit but will try to reproduce and get back to you.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2019-08-01T12:25:41.378Z","updated_at":"2019-08-01T12:25:41.378Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5506129,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-08-05T19:10:48.988Z","updated_at":"2019-08-05T19:10:48.988Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5716672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this topic hasn't been handled for a month now. Is there any update on this issue?","automated_response":false,"created_at":"2019-09-03T09:05:51.618Z","updated_at":"2019-09-03T09:05:51.618Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5717348,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nwe have been very busy with the 17 release. So sorry for the lack of updates.\n\nI managed to reproduce your issue.\n\nJust to make sure I fully get the issue. This would allow an attacker to corrupt the files with previous encrypted data right? (I just want to make sure we are not missing anything).\n\nI am in contact with the original author of that code to see if we can harden against this by using proper delimiters.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2019-09-03T11:32:58.405Z","updated_at":"2019-09-03T11:32:58.405Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5729370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, that's exactly what this vulnerability could be used for.","automated_response":false,"created_at":"2019-09-04T15:17:39.455Z","updated_at":"2019-09-04T15:17:39.455Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5987956,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, another month has gone by without any progress. Is there any update on this?","automated_response":false,"created_at":"2019-10-08T16:56:14.446Z","updated_at":"2019-10-08T16:56:14.446Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6253505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And yet another month has gone by. Do you have any news on this?","automated_response":false,"created_at":"2019-11-08T10:49:25.667Z","updated_at":"2019-11-08T10:49:25.667Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6829014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I guess that now that Nextcloud 18 has been published there will be the time to look into the issues of the server-side encryption? My plan is to to submit a talk about the Nextcloud server-side encryption to the upcoming [Gulaschprogrammiernacht](https://entropia.de/GPN20) (May 21st to May 24th). This should be enough time to fix the issues.","automated_response":false,"created_at":"2020-01-21T16:37:01.893Z","updated_at":"2020-01-21T16:37:01.893Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8122973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, this issue hasn't seen any update for 4 months. We approached the end of May without a fix. Do you still intend to work on this problem?","automated_response":false,"created_at":"2020-05-27T19:41:43.653Z","updated_at":"2020-05-27T19:41:43.653Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8145195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nYes this is still on our list but right now we don't have a good way to solve it.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-05-29T13:35:33.332Z","updated_at":"2020-05-29T13:35:33.332Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8902170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSo we have been looking into this as well.\nWe think we have a solution but it might not solve all the cases (but at least a lot). I'll send you a PR soon. It would be great if you could have a look as well.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-08-11T08:58:35.382Z","updated_at":"2020-08-11T08:58:35.382Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8908543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSo we could not identify a solution for existig files. But for new files/versions. Please see: \nhttps://github.com/nextcloud/server/pull/22196\n\nbasically we just add a '_' in between the different parts of the passphrase. That should make sure this does not happen anymore.\n\nSome side notes\n\n1 This requires the file to be modified to write the new signature\n2 Because of the fallback to the old method. Attackers that were in the process of doing this attak can continue it for a little while longer.\n\nHowever I still think for now it is the best to do. As iterating over all files is not doable with huge installations (and millions of files).\n\nFor future work I have the idea to check if there is 1 new signature in the file to require all new signatures. That would make it even harder to abuse this. However that required a lot deeper changes for which it is way to hot right now.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-08-11T17:34:18.920Z","updated_at":"2020-08-11T17:34:18.920Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8909821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think this is a simple but effective solution.\n\nConcerning side note 2: Users who want to decrease the risk of falling victim to this attack could additionally use the `occ versions:cleanup` command to get rid of the older file versions as described [here](https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html?highlight=occ#versions-label)","automated_response":false,"created_at":"2020-08-11T20:05:36.234Z","updated_at":"2020-08-11T20:05:36.234Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8912566,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAh good point. Of course they still lose data. And an attacker could already have the data they need. But it is still a good idea.\n\nLet me get this reviewed and merged (and backported since it is just 2 lines of code).\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-08-12T06:18:43.560Z","updated_at":"2020-08-12T06:18:43.560Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8913223,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSmall update. This just got merged into master. And the backports to all the maintenance releases are pending.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-08-12T08:09:42.155Z","updated_at":"2020-08-12T08:09:42.155Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9021219,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $250.\n\nThanks a lot for making the internet a safer place and keep hacking. Please keep in mind that we didn't release the fix yet, so please do not share this information with any third-parties.","automated_response":false,"created_at":"2020-08-24T11:01:59.710Z","updated_at":"2020-08-24T11:01:59.710Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"yahe","url":"/yahe"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9021230,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This will be resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2020-08-24T11:02:31.228Z","updated_at":"2020-08-24T11:02:31.228Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yahe","url":"/yahe"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9023376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for assigning a bounty to this. Would it be possible to get a couple of Nextcloud merch t-shirts instead of the money so that I can share them with my colleagues?\n\nConcerning the information:\n\nName: Kevin \"Kenny\" Niehage\nE-Mail: kenny@syseleven.de\nWebsite: https://www.syseleven.de/\nCompany: SysEleven GmbH","automated_response":false,"created_at":"2020-08-24T13:41:01.320Z","updated_at":"2020-08-24T13:41:01.320Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9024085,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI don't think we can unassign a bounty. But for the others we could of course. I'm not sure if we currently have a lot of t-shirts left (normally they get ordered now but our conference goes online this year). But let me check for some swag. Would you rather have swag than money?\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-08-24T14:18:17.667Z","updated_at":"2020-08-24T14:18:17.667Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9025108,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, swag would be appreciated. :)","automated_response":false,"created_at":"2020-08-24T15:53:07.306Z","updated_at":"2020-08-24T15:53:07.306Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9026954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok. I've asked if we have any left. But otherwise I'll make sure you are on the list for a few once they are back in stock. Together with a bunch of stickers of course :)","automated_response":false,"created_at":"2020-08-24T18:52:21.321Z","updated_at":"2020-08-24T18:52:21.321Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9423146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I've seen that you have announced Nextcloud 20 and have also backported this fix to Nextcloud 17, 18 and 19. Will there be a [security advisory](https://nextcloud.com/security/advisories/) for this issue?","automated_response":false,"created_at":"2020-10-05T16:16:52.833Z","updated_at":"2020-10-05T16:16:52.833Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9428874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, sorry with the conf and the release we have quite a todo backlog. Advisories will come (but we publish them 4 weeks after the release only anyway).","automated_response":false,"created_at":"2020-10-06T07:00:54.573Z","updated_at":"2020-10-06T07:00:54.573Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429544,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-10-06T07:27:20.135Z","updated_at":"2020-10-06T07:27:20.135Z","additional_data":{"old_title":"Message Authentication Codes calculated by the Default Encryption Module allow an attacker to silently overwrite blocks in a file","new_title":"Passphrase codes calculated by the Default Encryption Module can overwrite each others"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429550,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-10-06T07:27:54.440Z","updated_at":"2020-10-06T07:27:54.440Z","additional_data":{"old_title":"Passphrase codes calculated by the Default Encryption Module can overwrite each others","new_title":"Message Authentication Codes calculated by the Default Encryption Module allow an attacker to silently overwrite blocks in a file"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429754,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-06T07:59:48.103Z","updated_at":"2020-10-06T07:59:48.103Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://nextcloud.com/security/advisory/?id=NC-SA-2020-038\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8133","automated_response":false,"created_at":"2020-10-06T08:01:28.776Z","updated_at":"2020-10-06T08:01:28.776Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9730299,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-05T07:59:48.473Z","updated_at":"2020-11-05T07:59:48.473Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9730344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good morning. Do you already know when the CVE and NC-SA will be published?","automated_response":false,"created_at":"2020-11-05T08:06:36.230Z","updated_at":"2020-11-05T08:06:36.230Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9814709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"SA and CVE published","automated_response":false,"created_at":"2020-11-13T14:42:02.683Z","updated_at":"2020-11-13T14:42:02.683Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}