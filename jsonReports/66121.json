{"id":66121,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjEyMQ==","url":"https://hackerone.com/reports/66121","title":"XSS at http://vk.com on IE using flash files","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-05T09:56:45.013Z","submitted_at":"2015-06-05T09:56:45.013Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunnelshade","url":"/tunnelshade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-30T12:23:19.628Z","bug_reporter_agreed_on_going_public_at":"2015-09-30T12:23:05.997Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Steps**\r\n\r\n+ Open the below url in **Internet Explorer**\r\n \r\n```\r\nhttp://vk.com/swf/photo_uploader_lite.swf?h=h?\u0026onMouseOver=document.write(window.location.hash.substr(1))#\u003cscript\u003ealert(document.domain)\u003c/script\u003e\r\n```\r\n\r\n+ Just hover your mouse over the page.\r\n\r\n**Minor Observations**\r\n\r\n+ No \"X-Content-Type-Options: nosniff\" header allows IE to play the flash file directly whereas other browsers present download dialog as the content type served is **application/zip**.\r\n+ No X-Frame options will allow this attack to be placed inside an iframe and run stealthily.\r\n+ Other flash files such as **http://vk.com/swf/CaptureImg.swf** will also be vulnerable in a similar fashion.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-30T12:23:06.349Z","allow_singular_disclosure_after":-187757544.3980002,"singular_disclosure_allowed":true,"vote_count":1,"voters":["kunal94"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":441802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Payload**\n\n+ The url contains **?h=h?\u0026** to bypass url parameter removal code inside swf\n+ Any ExternalInterface call function name is checked through a regex `/[^().a-z0-9_]/gi`. Hence cannot include quotes, commas and semicolons. Bypassed this using the **window.location.hash** where we have no restrictions :P","automated_response":false,"created_at":"2015-06-05T10:09:32.997Z","updated_at":"2015-06-05T10:09:32.997Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":494416,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Almost a month. Any updates or Have you seen this at all?","automated_response":false,"created_at":"2015-06-28T11:29:27.181Z","updated_at":"2015-06-28T11:29:27.181Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":506070,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-07-11T20:46:03.882Z","updated_at":"2015-07-11T20:46:03.882Z","actor":{"username":"pavlovm","cleared":false,"url":"/pavlovm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":506072,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the report. We will investigate this issue and write you back.","automated_response":false,"created_at":"2015-07-11T20:46:15.943Z","updated_at":"2015-07-11T20:46:15.943Z","actor":{"username":"pavlovm","cleared":false,"url":"/pavlovm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":602929,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for being patient.\nWe resolved this issue. Please, check your side.","automated_response":false,"created_at":"2015-09-30T11:34:01.528Z","updated_at":"2015-09-30T11:34:01.528Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tunnelshade","url":"/tunnelshade"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":602930,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2015-09-30T11:34:10.752Z","updated_at":"2015-09-30T11:34:10.752Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"tunnelshade","url":"/tunnelshade"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":603053,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Yup. You guys took some time. Fixed!","automated_response":false,"created_at":"2015-09-30T12:23:06.049Z","updated_at":"2015-09-30T12:23:06.049Z","first_to_agree":true,"actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":638283,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-10-30T12:23:19.656Z","updated_at":"2015-10-30T12:23:19.656Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":973,"category":"researcher","content":"Flash XSS at vk.com only on Internet Explorer after bypassing few restrictions. More info is available at http://blog.tunnelshade.in/2015/09/interesting-flash-xss-on-vkcom.html","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":1337,"username":"tunnelshade","name":"Bharadwaj Machiraju","bio":"","cleared":false,"website":"http://blog.tunnelshade.in","location":"","created_at":"2013-11-10T19:26:50.666Z","url":"https://hackerone.com/tunnelshade","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":null,"profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBbG9HIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--c32fe9d79140a8c57fae180bb147e48fe3dc8eea/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/logo.png"}}}]}