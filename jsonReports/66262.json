{"id":66262,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjI2Mg==","url":"https://hackerone.com/reports/66262","title":"mailto: link injection on https://hackerone.com/directory","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-06T08:37:34.778Z","submitted_at":"2015-06-06T08:37:34.778Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ashesh","url":"/ashesh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-06-10T05:03:10.438Z","bug_reporter_agreed_on_going_public_at":"2015-06-10T05:03:09.793Z","team_member_agreed_on_going_public_at":"2015-06-10T05:02:06.806Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I just found that entering a non-existing porogram returns the following response:\r\n\r\n\u003eThe Directory doesn't have a profile matching these criteria.\r\n\r\n\u003eIf an organization has published security contact information or a vulnerability disclosure policy, **please let us know.**\r\n\r\nThe bold part has a mailto: link which is in following format: \r\n\r\n`mailto:directory@hackerone.com?subject=Directory:\u003cPROGRAM\u003e`\r\n\r\nNow i tried the following URL which did my Spoofing Job.\r\n\r\n[POC Link](https://hackerone.com/directory?query=Test%20program_____________________________________________________________________________________________%26body%3DPleaase%20delete%20my%20account%20ASAP%26cc%3Dsupport%40hackerone.com%26subject%3D%2CRequest%20to%20delete%20my%20account%26body%3D%20----------------------------%20The%20following%20line%20has%20not%20to%20be%20edited%20or%20your%20Haackerone%20account%20will%20be%20closed----------------------------------------%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Its%20a%20request%20Please%20delete%20my%20account%20ASAP%20without%20confirmation!%20\u0026sort=published_at%3Adescending\u0026page=1)\r\n\r\n1. The user doesn't see the whole search term , so he thinks he is Helping hackerone add a new program.\r\n\r\n2. Now he sends email (hackeone thretens not to change anything in email.\r\n\r\n3. Unexpected action happens like Payemnt method chnage etc.\r\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-10T05:02:07.523Z","allow_singular_disclosure_after":-197460821.76794124,"singular_disclosure_allowed":true,"vote_count":2,"voters":["b9232f43681009f01f1cd41","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":443038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a good explaination of [Why to avoid mailto: links](https://www.campaignmonitor.com/blog/post/4003/tip-avoid-using-mailto-links-in-html-email)","automated_response":false,"created_at":"2015-06-06T09:14:17.304Z","updated_at":"2015-06-06T09:14:17.304Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443286,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"You're not describing a security vulnerability.\n\nThe people behind support@hackerone.com are not going to remove an user account when the subject of the email is prefixed with `Test program___________________________________`.\n\nBtw the article you're referring to talks about `mailto`s __in__ emails.","automated_response":false,"created_at":"2015-06-06T18:08:08.829Z","updated_at":"2015-06-06T18:08:08.829Z","actor":{"username":"wvdv","cleared":false,"url":"/wvdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/221/7503cfe93236733876c422fb69d8a9a81824802c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":443316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@wvdv i can also add external email as receipt with any subject and who knows they might even accept it. also don't you even check my POC? please check what subject its creating before you tell me.","automated_response":false,"created_at":"2015-06-06T18:33:28.565Z","updated_at":"2015-06-06T18:33:28.565Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ashesh, seems like each e-mail client does something differently here. What are you seeing exactly? Can you attach a screenshot?\n\nTheoretical vulnerabilities are not going to get you the same attention as if you had a viable vulnerability that actually caused a security issue. Sounds like the end result is that you hope social engineering will occur, but unless you can actually get our support team to perform an action on your behalf that affects a user or team, then there's no actual vulnerability.","automated_response":false,"created_at":"2015-06-06T23:12:44.840Z","updated_at":"2015-06-06T23:12:44.840Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443462,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed What if i can get your user's Password!?\n\nMy old POC : [Old POC](https://hackerone.com/directory?query=Test%20program_____________________________________________________________________________________________%26body%3DPleaase%20delete%20my%20account%20ASAP%26cc%3Dsupport%40hackerone.com%26subject%3D%2CRequest%20to%20delete%20my%20account%26body%3D%20----------------------------%20The%20following%20line%20has%20not%20to%20be%20edited%20or%20your%20Haackerone%20account%20will%20be%20closed----------------------------------------%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Its%20a%20request%20Please%20delete%20my%20account%20ASAP%20without%20confirmation!%20\u0026sort=published_at%3Adescending\u0026page=1)\n\nGmail Screenshot: http://i.gyazo.com/61549d7f3d811231a1a0e1b2326cfd66.png\n\nMy new better POC demonstrating a better attack case: [New Better POC](https://hackerone.com/directory?query=Test%20Program__________________________________________________________________________________________________%26to%3Dsupport%40hacker0ne.com%26Subject%3D2please%20add%20a%20new%20program%26body%3DPlease%20enter%20your%20Hackerone%20Password%20and%20below%20and%20submit%20this%20email.%250D%250A%250D%250AEmail%3A%20%250D%250A%250D%250APassword%3A%250D%250A\u0026sort=published_at%3Adescending\u0026page=1)\n\nGmail screenshot: http://i.gyazo.com/5e51156f4dcdc2fed812cf23333313b9.png\n\n\n\u003eNote the mail is sent to directory@hackerone.com and support@**hacker0ne.com** , Now it could be an attacker's domain and user's accunt could get compormised. Only a few of them will see it and if i add 5 emails to `support@hackerone.com` before that attacker's email, it could be also hidden from screen.","automated_response":false,"created_at":"2015-06-07T02:21:00.597Z","updated_at":"2015-06-07T02:21:23.943Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443466,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Much better PoC! Thank you for spending the time to find something more realistic.\n\nWhile I'm still skeptical that somebody would fall for this or even that it is a valid attack (especially since it's e-mail client dependent on which extra parameters are supported ('to', 'body', etc.)), you are indeed able to inject other parameters into the mailto: URI besides the subject, which is definitely not wanted.\n\nReopening and triaging.","automated_response":false,"created_at":"2015-06-07T02:46:25.161Z","updated_at":"2015-06-07T02:46:25.161Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed Thanks for the supportive reply, I am constantly trying to improve my reports and delivering better proof of concepts.","automated_response":false,"created_at":"2015-06-07T02:51:55.346Z","updated_at":"2015-06-07T02:51:55.346Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443468,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-06-07T02:55:41.416Z","updated_at":"2015-06-07T02:55:41.416Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443825,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@ashesh, this has been fixed. Please confirm on your end that you are no longer able to inject extra parameters into the mailto: URI.\n\nThanks for the report. We will follow-up within the next day or so as to our bounty decision.","automated_response":false,"created_at":"2015-06-07T23:01:42.470Z","updated_at":"2015-06-07T23:01:42.470Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ashesh","url":"/ashesh"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@red, I ccan confirm that i am no longer able to inject any extra paramaters into the `mailto:` URI and also my POC has stopped working.","automated_response":false,"created_at":"2015-06-08T00:24:55.389Z","updated_at":"2015-06-08T00:24:55.389Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443852,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed, I ccan confirm that i am no longer able to inject any extra paramaters into the `mailto:` URI and also my POC has stopped working.","automated_response":false,"created_at":"2015-06-08T00:24:57.694Z","updated_at":"2015-06-08T00:24:57.694Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":443886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Opps! Sorry for the duplicate comment.","automated_response":false,"created_at":"2015-06-08T02:29:43.890Z","updated_at":"2015-06-08T02:30:09.197Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448676,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@ashesh,\n\nAs mentioned before, this particular case is limited in that a lot of cards must fall into place together for this to be viable:\n* Browser must be set up to open an e-mail client and pass-through parameters\n* E-mail client must actually support extra parameters besides the initial address and subject (specifically, 'to', 'body', etc.)\n* Some form of social engineering must occur, whether:\n - User must not notice extra entries in To:/Cc:/Bcc:; and/or\n - HackerOne support must perform some type of action without confirmation\n\nAs such, this does not meet the criteria for 'severe' issue, but we will award our base 'interesting' bounty here, as it was a form of URI injection that we should have been encoding properly.\n\nThanks again for the report. Please remember to focus on viable issues with real security significance and detailed proof of concepts for any future findings. Makes it much easier to see and validate the issue and get a fix out.\n\nHappy hacking.","automated_response":false,"created_at":"2015-06-10T05:01:56.444Z","updated_at":"2015-06-10T05:01:56.444Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"ashesh","url":"/ashesh"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-10T05:02:06.840Z","updated_at":"2015-06-10T05:02:06.840Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448678,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-06-10T05:03:09.823Z","updated_at":"2015-06-10T05:03:09.823Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448679,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-06-10T05:03:10.471Z","updated_at":"2015-06-10T05:03:10.471Z","actor":{"username":"ashesh","cleared":false,"url":"/ashesh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}