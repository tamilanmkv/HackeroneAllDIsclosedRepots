{"id":66994,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Njk5NA==","url":"https://hackerone.com/reports/66994","title":"Link vulnerability leads to phishing attacks","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-06-09T20:56:20.833Z","submitted_at":"2015-06-09T20:56:20.833Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"scorppy","url":"/scorppy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-07-13T22:39:11.513Z","bug_reporter_agreed_on_going_public_at":"2015-07-13T21:33:21.009Z","team_member_agreed_on_going_public_at":"2015-07-13T22:39:10.739Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Guys,\r\n\r\nHope you are doing great. I'm sending this email to let you know about a vulnerability i stumbled upon while using slack (it's a great app!). \r\n\r\nWhile copy-pasting a link from a pdf to slack (desktop/web), i noticed that the resulting link(s) looked a bit messed up (1.png)\r\n\r\nFiring up burp and investigating this issue, it seems like the link parser is having problems with what in burp appears to be dash. Further analysis led to the following two characters causing this issue:\r\n%c2%ad\r\n\r\nWhen inserting the above (after url decoding it) between a link, it will actually split the link into two different clickable links (2.png)\r\n\r\n\r\n​As you can see, this looks like a perfectly valid domain, however when hovering over it you can see that there are two clickable areas, one for http://abc, and one for 123.com.\r\n\r\nFollow these steps to reproduce:\r\n1. Login to Slack using the Web, in a browser that goes through Burp intercepting proxy\r\n2. Choose a colleague to send a direct message\r\n3. Enter your link as message: http://google.com\r\n4. Turn on Interception in Burp and hit enter to send the message. The intercepted message should appear in burp.\r\n5. Between the letter 'g' and 'oogle.com', insert %c2%ad \r\n6. Now select the insertion (%c2%ad), and right-click on it, select \"convert selection-\u003eurl-\u003eurl decode\" (3.png)\r\n​7. After url decode, it should appear as a dash. Forward the request.\r\n8 Back to slack, you can see that http://g is clickable, as well as oogle.com\r\n-end replication steps\r\n\r\nThe attack scenario here would be someone registering oogle.com (or ogle.com or any part for that matter) and sending this to the victim. With a high probably, that victim will click the second area that sends you to oogle.com instead of the 'g'. Good chances to phish for passwords.\r\n\r\nLet me know if you have problems reproducing or need additional information.\r\n\r\nRegards,\r\nShpend","original_report_id":null,"original_report_url":null,"attachments":[{"id":40707,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/040/707/c66997d95ac9dd82f14a092325c833d540118bf2/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151625Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6d8a2da3e8b160f6887db8648c13b8356c977471c1fb7448a8762fe03c3a8771","file_size":10805,"type":"image/png"},{"id":40708,"file_name":"3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/040/708/40f5e688aeef2cc4de408ec1b7d61631a071b2c8/3.png?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151625Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9ed389315f123acdc5faf16ac80844ce676c5fa65f76f9951205fc741e74a5a3","file_size":116797,"type":"image/png"},{"id":40709,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/040/709/706a17804aa125cad0df89e9a8cb1c03063668cf/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151625Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1964b157a56b7aefad7169f93bb4d504e91f98d3cbf39ffc0a878aa79041d63e","file_size":12209,"type":"image/png"}],"allow_singular_disclosure_at":"2015-08-12T21:33:21.854Z","allow_singular_disclosure_after":-194550183.15456143,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":488026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Guys,\n\nAlmost two weeks passed and no response. Any way i can help to speed up the process?\n\nNote that in my further research, it appears this issue works across devices. That means the Mac/Windows Desktop apps and Android/iOS are vulnerable aswell.","automated_response":false,"created_at":"2015-06-22T19:24:44.647Z","updated_at":"2015-06-22T19:24:44.647Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":507578,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi Shpend,\n\nSlack teams are trusted environments, so we count on team members not attacking each other in this way.\n\nRegards,\n\nLeigh","automated_response":false,"created_at":"2015-07-13T21:24:30.560Z","updated_at":"2015-07-13T21:24:30.560Z","actor":{"username":"leighhoneywell","cleared":false,"url":"/leighhoneywell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/411/956aec0fd38fb8e9577a2f87a2d5e33ee4eb8a9e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":507589,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\n\nThanks for the response. If you don't mind, i'd like to publicly disclose this and get other people's thoughts on it.","automated_response":false,"created_at":"2015-07-13T21:32:54.820Z","updated_at":"2015-07-13T21:32:54.820Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":507590,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-07-13T21:33:21.041Z","updated_at":"2015-07-13T21:33:21.041Z","first_to_agree":true,"actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":507725,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi Shpend, please feel free to publicly disclose this issue.","automated_response":false,"created_at":"2015-07-13T22:39:10.767Z","updated_at":"2015-07-13T22:39:10.767Z","actor":{"username":"leighhoneywell","cleared":false,"url":"/leighhoneywell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/411/956aec0fd38fb8e9577a2f87a2d5e33ee4eb8a9e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":507726,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-07-13T22:39:11.550Z","updated_at":"2015-07-13T22:39:11.550Z","actor":{"username":"leighhoneywell","cleared":false,"url":"/leighhoneywell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/411/956aec0fd38fb8e9577a2f87a2d5e33ee4eb8a9e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":523854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Leigh\n\nJust checking through slack i can see there's many integrations possible, such as desk.com, intercom and twitter. The support integrations are especially interesting as the ticket contents are auto posted on slack. So here we have anybody (untrusted) that can post something to slack which a trusted member can click on and get phished.\n\nThoughts?","automated_response":false,"created_at":"2015-07-24T13:16:10.042Z","updated_at":"2015-07-24T13:16:10.042Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}