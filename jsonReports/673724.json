{"id":673724,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzM3MjQ=","url":"https://hackerone.com/reports/673724","title":"Circle email-members have still access to a shared folder/file after they are removed from the circle","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-08-14T15:46:23.970Z","submitted_at":"2019-08-14T15:46:23.970Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"michag86","url":"/michag86","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15610"],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T11:24:48.159Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T11:24:35.556Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"If a email-address is added to a circle, the email user has still access after the email-address is removed from the circle.\nRequirements\n-------\ncircles app and share by mail app enabled\n\nSteps to reproduce\n-------------\n1. add an email address to a circle\n2. share a folder/file with the circle\n3. remove the email address from the circle\n4. try to access the link that is sent to the email address\n\nemail user has still access!\n\nAdditional information\n----------\nFor every circle share is a non user specific link token created. this token is sent to the email-members.\nAn other problem is, that if you have forced password usage for link shares and share by mail shares, this link is still accessible without a password. \n\nTested with:\nNextcloud 15.0.10\nCircles 0.16.9\nshare by mail 1.5.0\n\n## Impact\n\nA email-member that is removed from a circle","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T11:24:35.653Z","allow_singular_disclosure_after":-50903527.57308928,"singular_disclosure_allowed":true,"vote_count":2,"voters":["a_d_a_m","cryptographer"],"severity":{"rating":"low","score":2.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5576497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-08-14T15:46:26.004Z","updated_at":"2019-08-14T15:46:26.004Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5582780,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-08-15T09:41:03.805Z","updated_at":"2019-08-15T09:41:03.805Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5582859,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nThanks for your report, and I can confirm that this is currently the normal behavior of sharing a file to a group of email users via Circles. \nSharing to a Circle will generate a unique key/single share link that will then be shared to every mail address invited to the Circle.\n\nI will have some discussion with other engineers about it and keep you updated.\n\nRegards,\n\nMaxence. ","automated_response":false,"created_at":"2019-08-15T09:57:33.888Z","updated_at":"2019-08-15T09:57:33.888Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello again,\n\nA descent solution have been found and I will work on this within the next few days!\n\nThanks for your report,\n\nMaxence.","automated_response":false,"created_at":"2019-08-15T18:29:35.159Z","updated_at":"2019-08-15T18:29:35.159Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will the solution fix both problems? Password enforcement and user specific link tokens?","automated_response":false,"created_at":"2019-08-15T18:47:06.269Z","updated_at":"2019-08-15T18:47:06.269Z","actor":{"username":"michag86","cleared":false,"url":"/michag86","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5613126,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-08-20T07:45:44.334Z","updated_at":"2019-08-20T07:45:44.334Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5613922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@michag86 : the 2 bugs will be fixed separately.\n\nFirst, the tokens, as it's a bigger change.\nRight now, we are using one token per share, stored in the table 'shares'. (let's call it `share_token`)\nThe idea is to generate our own listing of tokens per share (one per share and per member, called `member_token`) in our own table. \nThe generated URL include the `member_token` and is routed by the Circles app and will redirect the member to the real share using `share_token`\nWhen a member is removed, we change the `share_token` and remove the `member_tokens` related to that user.\n\nFor the password enforcement, I haven't had a deeper look, but it should not need that much work than the tokens. Hopefully.","automated_response":false,"created_at":"2019-08-20T08:55:12.325Z","updated_at":"2019-08-20T08:55:12.325Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5619173,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"_some updates_\n\nfirst throw: https://github.com/nextcloud/circles/pull/326\n\nThere is no refresh on the token when removing a user, but we are using a personal token for each mail sent","automated_response":false,"created_at":"2019-08-20T17:17:01.711Z","updated_at":"2019-08-20T17:17:01.711Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5621380,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PR should be good. I'll give a new look tomorrow to confirm it does what it should.","automated_response":false,"created_at":"2019-08-20T20:44:18.814Z","updated_at":"2019-08-20T20:44:18.814Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6229789,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there a reason why this is still open?","automated_response":false,"created_at":"2019-11-06T10:10:37.267Z","updated_at":"2019-11-06T10:10:37.267Z","actor":{"username":"michag86","cleared":false,"url":"/michag86","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6278352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, this has been merged now, so closing","automated_response":false,"created_at":"2019-11-11T15:32:40.598Z","updated_at":"2019-11-11T15:32:40.598Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6278360,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2019-11-11T15:33:49.329Z","updated_at":"2019-11-11T15:33:49.329Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"michag86","url":"/michag86"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6278984,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Pseudonym: michag86","automated_response":false,"created_at":"2019-11-11T16:23:52.655Z","updated_at":"2019-11-11T16:23:52.655Z","actor":{"username":"michag86","cleared":false,"url":"/michag86","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6279090,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-11-11T16:35:57.977Z","updated_at":"2019-11-11T16:35:57.977Z","additional_data":{"old_severity":null,"new_severity":"Low (2.0)","old_severity_id":null,"new_severity_id":562803},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6931076,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-01-31T11:24:24.872Z","updated_at":"2020-01-31T11:24:24.872Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"michag86","url":"/michag86"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6931077,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-31T11:24:35.583Z","updated_at":"2020-01-31T11:24:35.583Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6931143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE is requested\nThe advisory will be at https://nextcloud.com/security/advisory/?id=NC-SA-2019-013 (I just failed to deploy it because it was the first on for the circles app, but it will be there next week)","automated_response":false,"created_at":"2020-01-31T11:27:42.902Z","updated_at":"2020-01-31T11:27:42.902Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188038,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-03-01T11:24:48.182Z","updated_at":"2020-03-01T11:24:48.182Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}