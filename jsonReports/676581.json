{"id":676581,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzY1ODE=","url":"https://hackerone.com/reports/676581","title":"Use Github pack with Coda employee github account (search code of Coda's private repositories)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-08-19T13:34:06.576Z","submitted_at":"2019-08-19T13:34:06.576Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39147,"url":"https://hackerone.com/coda_bbp","handle":"coda_bbp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coda","twitter_handle":"coda_hq","website":"https://coda.io/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-02T18:10:37.322Z","bug_reporter_agreed_on_going_public_at":"2019-12-03T18:10:28.483Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nWhen you use the [Github formula](https://coda.io/formulas#GitHub::CodeSearch), the information from the Github API is returned by the endpoint https://coda.io/coda.CalcService/InvokeFormula. From what I understand, this endpoint expects a [gRPC](https://grpc.io/) request. In the request is sent: the formula (`Github..CodeSearch`), the version of the Github pack (`3.4.1`), the id of the Github connection  (generated by Coda when connecting your account), the id of the document to which the Github account is linked, and the parameters for the formula.\n\nThe issue is that you can take the document id and connection id of any public document and use the formula as you please. Also, it's not required to be authenticated to make a request to the endpoint https://coda.io/coda.CalcService/InvokeFormula. It may be working as designed, so that's why I used a document created by a Coda employee for the proof of concept in case that is considered a N/A report :D\n\n## Steps To Reproduce:\nPass all requests through Burp or similar proxy to make the reproduction easier.\n  1. Make sure you are signed in https://coda.io\n  1. Go to https://coda.io/t/Git-Cherry-Pick-From-Branch_tTZJuuyHgqa/preview?useBack\n  1. If you look at the requests in Burp, you will see a request to https://coda.io/embed/igvicDMruo?viewMode=gallery\u0026disconnected=true that is loaded in an `\u003ciframe\u003e` (it is the document you see when you load the template). \"igvicDMruo\" is the document id.\n  1. Using the document id from the last step, go to https://coda.io/internalAppApi/documents/igvicDMruo/externalConnections\n   1. The value that matters from the response is the `id` of the object  with `name` \"albertc44\". The connection id is `7b167155-731e-4913-9091-729c5bd77ee0`\n   1. Go to https://coda.io/newdoc/POC\n   1. Click \"Create doc\"\n   1. Click the \"Open Packs\" button at the top right. It is the puzzle piece icon between the robot and the arrows\n   1. Click \"+ Add a new Pack\"\n   1. Click the \"Github\" card/box\n   1. Click the orange \"Sign in to install\" button\n   1. Click \"Authorize codaprojectapp\"\n   1. Click \"You and anyone this doc is shared with\"\n   1. Click \"Nobody\"\n   1. Click the orange \"+\" button at the top of the document\n   1. Go to \"Formula\", then \"Github\", and then click \"CodeSearch\"\n   1. In the dialog opened press the key \"Tab\", enter comma `,`, enter `\"secret\"`, enter `,`, enter `organization: \"kr-project\"` and finally press the key \"Enter\"\n   1. In Burp Proxy or similar, find the last request to /coda.CalcService/InvokeFormula and send it to the Repeater or similar to modify\n   1. Remove the `Cookie` header \n   1. The value between `$` and `2$` is the connection id. Replace this value with the `7b167155-731e-4913-9091-729c5bd77ee0` you got before (don't touch the `2` before the `$` ðŸ˜… )\n  1. The first ten characters of the last line are the document id. Replace it with the document id you got in the first steps (`igvicDMruo`)\n  1. Send the request\n  1. The most interesting things in the response are the values of `Fragment`\n\n\n## Supporting Material/References:\nNone\n\n## Impact\n\nIt's possible to search the code of all the private repositories to which https://github.com/albertc44 has access. Including the ones of the __kr-project__ organization, that is where the Coda repositories are.","bounty_amount":"450.0","formatted_bounty":"$450","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-01-02T18:10:28.995Z","allow_singular_disclosure_after":-55976789.38338016,"singular_disclosure_allowed":true,"vote_count":97,"voters":["quaz","akshansh","edduu","samux","mik317","ali","0xd0m7","realtess","joaovitormaia","naategh","and 87 more..."],"severity":{"rating":"medium","score":5.9,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":23170,"asset_type":"URL","asset_identifier":"https://coda.io/*","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5607215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was going to try to escalate this. But I don't know how far I am allowed to go.","automated_response":false,"created_at":"2019-08-19T13:35:06.285Z","updated_at":"2019-08-19T13:35:06.285Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5626055,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @stefanofinding,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2019-08-21T09:29:01.077Z","updated_at":"2019-08-21T09:29:01.077Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5626076,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-08-21T09:32:24.360Z","updated_at":"2019-08-21T09:32:24.360Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.9)","old_severity_id":null,"new_severity_id":498047},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5626240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @stefanofinding,\n\nYou discovered a doc that a Coda employee created as a template with a GitHub Pack in it (a Coda-GitHub integration). Because this doc is public, the connection was public as well allowing anyone to use it. This is expected behavior, but Coda is planning to make it super clear that sharing a doc with Packs publicly is dangerous because it will result in anyone else being able to use the Pack to access information.\n\nBecause Coda appreciates you bringing this to their attention, they have asked me to triage the issue. Based on the `kr-project` organization access, there could be a high confidentiality impact. Because it is limited to the https://github.com/albertc44 user, some attack complexity is added. That would make it a Medium severity issue.\n\nCoda will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2019-08-21T09:37:26.389Z","updated_at":"2019-08-21T09:37:26.389Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5626241,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-08-21T09:37:32.484Z","updated_at":"2019-08-21T09:37:32.484Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5627387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @beagle.\n\n\"You discovered...\"\nIt makes sense clarifying because I'm not sure it's clear that anyone have access to private information too.\n\n\"Because Coda...\"\nIf you want to me  to go further to make a better proof of concept, let me know. \n\n\"Coda will...\"\nOkay, thanks. I appreciate it.\n\nI just tried doing something similar with the [Gmail template](https://coda.io/t/Gmail-Coda-Starter-Kit_tXvsm0bmu0k/preview) and was able to get messages of the Coda employee that created the template using the `Gmail::Threads` formula. Also, I'm not sure Al Chen is aware of all the messages that are being shown in the \"Messages\" table in the template?! Or maybe it's just a fake user? The `Threads` formula doesn't return the entire message, but the template does show the entire message because it is syncing the messages with the document.\n\nBest.","automated_response":false,"created_at":"2019-08-21T12:34:56.709Z","updated_at":"2019-08-21T12:45:09.206Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5627478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All the messages of Al synced with the document are shown here: https://coda.io/api/log/83O3pUS7Vo\nFor instance, the object at the position 150 of the array `log` has the following value for `text`: \n```\nYou have been invited to the following event.\\n  \\n\\nBoard meeting dry run\\nWhen\\nTue Aug 13, 2019 4pm â€“ 6pm Eastern Time - New York\\nJoining info\\n Or dial: +1 423-720-0255  PIN: 760078610#\\nCalendar\\nal@codadoc.io\\nWho\\n\u003c\n```","automated_response":false,"created_at":"2019-08-21T12:51:22.201Z","updated_at":"2019-08-21T12:55:52.716Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5642688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @stefanofinding, thanks for your report. As @beagle mentioned, the main discovery here was that one of our employees inadvertently published a template he created using a corporate coda.io account. Because of the way that Packs work, it's up to users to make sure they're not leaking any sensitive info, and unfortunately that wasn't made clear to everyone. So thanks for catching this, we appreciate it!\n\nWe'll work to make it clear, not just for our own employees but for other users, that sharing a doc publicly with a Pack attached may result in someone being able to use that Pack for other purposes. We'll also be adding controls for enterprises to control the boundaries of data like this, too.\n\n\u003e I just tried doing something similar with the Gmail template and ...\nWell, we still want to have demos of all these Packs. In this case, Al actually created a \"throwaway\" Gmail account for this demo. So yes, you can look at the emails of that account, but it should be a fake account created for the template. Do let us know if you find an account that actually looks like a corporate account.\n\n\u003e All the messages of Al synced with the document are shown here: https://coda.io/api/log/83O3pUS7Vo\nYeah, we're doing an audit of docs we've created in templates. The issue here is some docs we've used as templates were based on docs we've created internally within the company. Most templates we should have recreated from scratch, but some, like this one, weren't. The endpoint you found, \"/log\", is used for revision history and as such it contained a previous version of the doc.","automated_response":false,"created_at":"2019-08-22T19:14:24.640Z","updated_at":"2019-08-22T19:14:24.640Z","actor":{"username":"oleg-coda","cleared":false,"url":"/oleg-coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/561/809/39ffee8055ead9b37a3d212d0388be75aa4a2f4d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5642698,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Awarding a $300 bounty for this, along with a 50% bonus for our promotion. ","automated_response":false,"created_at":"2019-08-22T19:15:45.675Z","updated_at":"2019-08-22T19:15:45.675Z","actor":{"url":"/coda_bbp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coda"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"150.0","genius_execution_id":null,"team_handle":"coda_bbp","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5642788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the explanation and the bounty!\n\nI see that other \"throwaway\" accounts in other services are using that email address. Not sure if you want to do something about it. Because from what I see, if those accounts do not have two factor authentication enabled, anyone could take over them. Not a security issue, maybe, but bothersome. \n\n","automated_response":false,"created_at":"2019-08-22T19:35:06.255Z","updated_at":"2019-08-22T19:35:06.255Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5642921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup, we'll also try look into adding 2FA for those throwaway accounts as part of our audit sweep. Thanks for the suggestion.","automated_response":false,"created_at":"2019-08-22T20:01:24.018Z","updated_at":"2019-08-22T20:01:24.018Z","actor":{"username":"oleg-coda","cleared":false,"url":"/oleg-coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/561/809/39ffee8055ead9b37a3d212d0388be75aa4a2f4d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5642932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good! I just took a look to see other templates with a similar issue and found one which has access to @coda.io and Slack. So, maybe there are more.\n\nBest.","automated_response":false,"created_at":"2019-08-22T20:04:59.217Z","updated_at":"2019-08-22T20:04:59.217Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5645044,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Yup, I don't doubt it. We'll take care of it soon, and also enable 2FA. :) The original GitHub issue should be addressed, though.","automated_response":false,"created_at":"2019-08-23T06:45:46.804Z","updated_at":"2019-08-23T06:45:46.804Z","actor":{"username":"oleg-coda","cleared":false,"url":"/oleg-coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/561/809/39ffee8055ead9b37a3d212d0388be75aa4a2f4d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5648309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds great! \nBest!","automated_response":false,"created_at":"2019-08-23T13:22:04.327Z","updated_at":"2019-08-23T13:22:04.327Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6460892,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi Coda team. Is it okay to disclose this report? I noticed that your program is public now and I usually try to disclose my reports whenever a public program allows to do it.\nWhatever you decide is okay for me, and I understand if you don't want to do it.\nThanks!","automated_response":false,"created_at":"2019-12-03T18:10:28.836Z","updated_at":"2019-12-03T18:10:28.836Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6675452,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-02T18:10:37.339Z","updated_at":"2020-01-02T18:10:37.339Z","actor":{"url":"/coda_bbp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coda"}},"genius_execution_id":null,"team_handle":"coda_bbp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}