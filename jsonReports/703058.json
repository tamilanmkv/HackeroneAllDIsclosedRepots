{"id":703058,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDMwNTg=","url":"https://hackerone.com/reports/703058","title":"Insecure redirect rule results in bypassing ban redirect on certain pages","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-09-27T16:31:08.051Z","submitted_at":"2019-09-27T16:31:08.051Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"h0nde","url":"/h0nde","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19491,"url":"https://hackerone.com/roblox","handle":"roblox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Roblox","twitter_handle":"Roblox","website":"https://www.roblox.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-04-26T06:10:02.222Z","bug_reporter_agreed_on_going_public_at":"2020-03-27T06:09:59.238Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nAccount bans on Roblox work via redirect rules. If an user attempts go to a page that's outside a whitelisted set of rules, they'll be redirected back to the ban page.\n\nAfter researching, I've found that the following rules are whitelisted and bypass this redirect:\n- Any URLs ending in a file extension (except for .aspx, .ashx)\n- https://www.roblox.com/request-error/*\n- https://www.roblox.com/login/*\n- https://www.roblox.com/info/*\n- https://www.roblox.com/support/ *\n- https://www.roblox.com/*/membership/*\n\nAll of these seem okay, except for `https://www.roblox.com/*/membership/*`. The `/membership/` part is not anchored to the start of the URL.\n\nIn ASP.NET, we can actually insert paths after the extensions `.aspx` and `.ashx`, which will just be ignored by the server.\n\nThis allows us to access any pages ending in `.aspx/.ashx` without a ban-redirect, just by appending `/membership/` after the extension. Ex.: https://www.roblox.com/my/money.aspx/membership/\n\n## Impact\n\nAn attacker would be able to access the following pages/apis with a banned account:\n- Create/update assets - https://data.roblox.com/Data/Upload.ashx\n- Post comments on assets - https://www.roblox.com/API/Comments.ashx\n- Trade Items (Unverified)   - https://www.roblox.com/Trade/tradehandler.ashx\n- Use any other page or API ending in .ashx/.aspx\n\nA moderator couldn't do anything to stop the attacker from performing these actions. Bans would be ineffective.\n\nAnother thing I would like to mention is that banned accounts can access ANY web apis at api.roblox.com, without a need for a bypass or anything.","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-26T06:09:59.311Z","allow_singular_disclosure_after":-46084133.088524416,"singular_disclosure_allowed":true,"vote_count":196,"voters":["jensec","a_d_a_m","nagli","bogdantcaciuc","prophet","ali","h0nde","its_afolic","vaalici","srom23","and 186 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"low"}},"structured_scope":{"databaseId":12249,"asset_type":"URL","asset_identifier":"*.roblox.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5908163,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-09-27T21:57:14.848Z","updated_at":"2019-09-27T21:57:14.848Z","actor":{"username":"b0mblebee","cleared":false,"url":"/b0mblebee","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/M7XZMLZaLX3D7XoNwPywWdV1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5909545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh, what the heck, this seems to have been already fixed?\n\nCan you confirm?","automated_response":false,"created_at":"2019-09-28T05:49:20.403Z","updated_at":"2019-09-28T05:49:20.403Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5987897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates yet?\n\n","automated_response":false,"created_at":"2019-10-08T16:48:00.109Z","updated_at":"2019-10-08T16:48:00.109Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6006269,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zxzxzxccasc,\nYou are correct, we have been busy addressing this bug.\nWe hope to close this ticket and reward you within the next week or two. Your patience is much appreciated.\n\nThank you","automated_response":false,"created_at":"2019-10-10T18:34:27.466Z","updated_at":"2019-10-10T18:34:27.466Z","actor":{"username":"dinomassimo","cleared":false,"url":"/dinomassimo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6069822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates on this yet?\n\nAlso, I have submitted a new report but I believe the HackerOne triage team might have a difficult time reproducing it so please check it out at https://hackerone.com/reports/714972","automated_response":false,"created_at":"2019-10-18T01:18:41.195Z","updated_at":"2019-10-18T01:18:41.195Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6117809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yonisakharof any updates?","automated_response":false,"created_at":"2019-10-23T15:36:24.521Z","updated_at":"2019-10-23T15:36:24.521Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6120293,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @zxzxzxccasc,\nWe are still in the midst of rolling out a fix, and should be completed any day soon.\nWe are however going to close this ticket in the meantime, and you should be receiving a reward and bonus very soon.\n\nThank you very much for your excellent contributions in helping to keep the Roblox community safe.","automated_response":false,"created_at":"2019-10-23T21:06:33.117Z","updated_at":"2019-10-23T21:06:33.117Z","actor":{"username":"dinomassimo","cleared":false,"url":"/dinomassimo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"h0nde","url":"/h0nde"},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6120308,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-10-23T21:08:09.550Z","updated_at":"2019-10-23T21:08:09.550Z","actor":{"url":"/roblox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Roblox"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"300.0","genius_execution_id":null,"team_handle":"roblox","collaborator":{"username":"h0nde","url":"/h0nde"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6137459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yonisakharof May I ask what the bonus was for?\n\n","automated_response":false,"created_at":"2019-10-25T13:31:48.066Z","updated_at":"2019-10-25T13:31:48.066Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6141126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zxzxzxccasc,\nSure, no problem.\nRoblox considers keeping banned users off of the platform and away from abusing the platform, and other community members, very important.\n\nAlthough your exploit wasn't very technically complex, it highlighted an important control that needed improving.\n\nThank you","automated_response":false,"created_at":"2019-10-25T20:52:47.259Z","updated_at":"2019-10-25T20:52:47.259Z","actor":{"username":"dinomassimo","cleared":false,"url":"/dinomassimo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6158767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yonisakharof Is it possible that you could triage these reports? H1 staff takes a long time\n\nhttps://hackerone.com/reports/724095 \nhttps://hackerone.com/reports/723782\nhttps://hackerone.com/reports/714972\n","automated_response":false,"created_at":"2019-10-28T21:37:37.128Z","updated_at":"2019-10-28T21:37:37.128Z","actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7455525,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-03-27T06:09:59.266Z","updated_at":"2020-03-27T06:09:59.266Z","first_to_agree":true,"actor":{"username":"h0nde","cleared":false,"url":"/h0nde","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7795930,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-04-26T06:10:02.255Z","updated_at":"2020-04-26T06:10:02.255Z","actor":{"url":"/roblox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/491/f2f840883d85a7c71e6f9b0987098a82f8fe0f49_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Roblox"}},"genius_execution_id":null,"team_handle":"roblox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":21459,"category":"researcher","content":"An insecure redirect rule allowed an attacker to bypass the ban redirect on pages ending in .aspx/.ashx.\n\nAdditionally, I have also mentioned in my report that *api.roblox.com* did not have a check for banned authenticated sessions.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":230612,"username":"h0nde","name":"h0nda","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-01-09T06:15:57.696Z","url":"https://hackerone.com/h0nde","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/230/612/dc04049dda38e7b98e5d5485052af4b558cbd46a_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}