{"id":715192,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MTUxOTI=","url":"https://hackerone.com/reports/715192","title":"Private program disclosure via `vpn_suspended` GraphQL query","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2019-10-16T09:09:46.769Z","submitted_at":"2019-10-16T09:09:46.769Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"unknown_person","url":"/unknown_person","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/173/999/155cbb33a03c2b35f84039ac4bd343acf17e28c4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-21T19:07:39.568Z","bug_reporter_agreed_on_going_public_at":"2019-10-21T19:07:39.382Z","team_member_agreed_on_going_public_at":"2019-10-21T19:03:58.536Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n`vpn_suspended` of Team object got exposed\n\n**Description:**\nAn attacker can get vpn_suspended value of any program (including external program which also have private  program   eg. █████  and external program which does not have private program)\n\nWhat an attacker can do with this ?\nIf an external program (which also has private program) has enabled VPN , then value of vpn_suspended become false, so with this information, an attacker can find external programs which have private program, because there is no VPN feature in sandbox mode (all other external programs will be in sandbox mode) \n\n### Steps To Reproduce\n\n1.)  run the below graphql query\n\nPOST /graphql? HTTP/1.1\n\n```\n{\"query\":\"query Team_mini_profile($handle_0:String!,$size_1:ProfilePictureSizes!) {team(handle:$handle_0) {id,...F0}} fragment F0 on Team {id,name,about,_profile_picturePkPpF:profile_picture(size:$size_1),offers_swag,offers_bounties,vpn_enabled,vpn_suspended,base_bounty}\",\"variables\":{\"handle_0\":\"█████\",\"size_1\":\"small\"}}\n```\n\nYou will get response of \n\n```\n{\"data\":{\"team\":{\"id\":\"███\",\"name\":\"████████\",\"about\":\"███████\",\"_profile_picturePkPpF\":\"█████\",\"offers_swag\":null,\"offers_bounties\":null,\"vpn_enabled\":null,\"vpn_suspended\":true,\"base_bounty\":null}}}\n```\n\n\n2. ) the vpn_suspended status of ███████ program is true\n\n## Impact\n\nan attacker can find external programs which have private program","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-20T19:03:58.598Z","allow_singular_disclosure_after":-59688952.0754892,"singular_disclosure_allowed":true,"vote_count":130,"voters":["dirk","drsniper","base_64","sameerphad72","spam404","prophet","mik317","vp40","ldv","organiccrap","and 120 more..."],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6055442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @unknown_person,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@antenna ","automated_response":false,"created_at":"2019-10-16T14:24:39.438Z","updated_at":"2019-10-16T14:24:39.438Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6057315,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-10-16T17:05:58.315Z","updated_at":"2019-10-16T17:05:58.315Z","additional_data":{"old_title":"`vpn_suspended` of Team object got exposed","new_title":"Private program disclosure via `vpn_suspended` GraphQL query"},"actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6057382,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @unknown_person,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@antenna ","automated_response":false,"created_at":"2019-10-16T17:15:52.321Z","updated_at":"2019-10-16T17:15:52.321Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6082898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team, any updates on this ? seems this issue got fixed, now  vpn_suspended = null returned for external programs .","automated_response":false,"created_at":"2019-10-20T06:27:21.696Z","updated_at":"2019-10-20T06:27:21.696Z","actor":{"username":"unknown_person","cleared":false,"url":"/unknown_person","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/173/999/155cbb33a03c2b35f84039ac4bd343acf17e28c4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6099096,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @unknown_person - thanks for checking in with us. I've looked into this and, unfortunately, this turns out to be false positive. The engineers who are working on this feature defined a method that always returned `true`, regardless of the program. This method was exposed in GraphQL to start testing the new frontend. They updated the definition of that method on October 16, shortly after you submitted this to us. Because the method definition was moved from an abstract GraphQL type to the model, proper authorization is now applied.\n\nHowever, there is some good news, too. When we looked into this on Friday, we went through a number of commits to understand what caused this behavior and stumbled upon a security vulnerability that would've allowed anyone who has access to a program to suspend and resume the HackerOne Gateway (VPN) for that particular program. We determined the severity of this vulnerability to be medium and can be found here: #717716. Because you pointed us in the right direction, we decided to award you the full amount that we would've paid for the security vulnerability ($2,500).\n\nThanks again for pointing us in the right direction, it's much appreciated!","automated_response":false,"created_at":"2019-10-21T18:48:12.955Z","updated_at":"2019-10-21T18:48:12.955Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"unknown_person","url":"/unknown_person"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6099109,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-10-21T18:49:09.478Z","updated_at":"2019-10-21T18:49:09.478Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":539721,"new_severity_id":544292},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6099116,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"A fix for #717716 was released earlier today, so marking this as Resolved.","automated_response":false,"created_at":"2019-10-21T18:49:50.744Z","updated_at":"2019-10-21T18:49:50.744Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"unknown_person","url":"/unknown_person"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6099258,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-21T19:03:58.551Z","updated_at":"2019-10-21T19:03:58.551Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6099300,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you so much @jobert  @antenna , after the many duplicates, now I got valid one :)  I am very happy","automated_response":false,"created_at":"2019-10-21T19:07:39.405Z","updated_at":"2019-10-21T19:07:39.405Z","actor":{"username":"unknown_person","cleared":false,"url":"/unknown_person","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/173/999/155cbb33a03c2b35f84039ac4bd343acf17e28c4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6099301,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-21T19:07:39.586Z","updated_at":"2019-10-21T19:07:39.586Z","actor":{"username":"unknown_person","cleared":false,"url":"/unknown_person","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/173/999/155cbb33a03c2b35f84039ac4bd343acf17e28c4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}