{"id":719426,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MTk0MjY=","url":"https://hackerone.com/reports/719426","title":"File-drop content is visible through the gallery app","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-10-21T22:54:00.915Z","submitted_at":"2019-10-21T22:54:00.915Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nursoda","url":"/nursoda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8119"],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-31T10:36:24.922Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T10:34:51.713Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I set up a file-drop on NC 17 (btw, according to https://nextcloud.com/security/ NC17 is not covered - but it should be once it's released!): created folder, set share as upload-only. I access that folder as https://cloud.domain.com/s/randompath - fine: I get the upload interface and cannot see what's in the folder. I (or anyone else) upload(s) something. Still fine. Now I use https://cloud.domain.com/apps/gallery/s/randompath and see everything that gallery can display. In my case, it was an upload folder for pictures, so everything is displayed (and can be downloaded, even if I set \"hide download\"!).\n\n## Impact\n\nAccess all media files uploaded to a (not so secure) file-drop (https://nextcloud.com/file-drop/) folder. Could be critical in, say, a hospital, police, etc.","bounty_amount":"500.0","formatted_bounty":"$500","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T10:34:51.814Z","allow_singular_disclosure_after":-50906710.18739592,"singular_disclosure_allowed":true,"vote_count":68,"voters":["wi11","themastersunil","a_d_a_m","sameerphad72","pirateducky","prophet","7yr","ali","mr-hakhak","exbrazily","and 58 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":65,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/gallery","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6100823,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-10-21T22:54:01.188Z","updated_at":"2019-10-21T22:54:01.188Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6103026,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-10-22T07:54:08.270Z","updated_at":"2019-10-22T07:54:08.270Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6103054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nursoda \n\nnice finding. can you verify that https://github.com/nextcloud/gallery/commit/f38c91cb5e056ed964a85bf13118c020d4f540d0 solves the issue?\n\ncheers Joas","automated_response":false,"created_at":"2019-10-22T08:02:05.251Z","updated_at":"2019-10-22T08:02:05.251Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6103067,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $500.\n\nThanks a lot for making the internet a safer place and keep hacking. Please keep in mind that we didn't patch the vulnerability yet, so please do not share this information with any third-parties.","automated_response":false,"created_at":"2019-10-22T08:05:02.321Z","updated_at":"2019-10-22T08:05:02.321Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"nursoda","url":"/nursoda"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6103068,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2019-10-22T08:05:16.050Z","updated_at":"2019-10-22T08:05:16.050Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"nursoda","url":"/nursoda"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6103079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e according to https://nextcloud.com/security/ NC17 is not covered - but it should be once it's release\n\ntrue, just an oversight on the release. 14 is dropped and 17 added, uipdate of the website will come soon","automated_response":false,"created_at":"2019-10-22T08:06:49.525Z","updated_at":"2019-10-22T08:06:49.525Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6106262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I confirm that the patch fixes the issue. It leads to \"internal server error\" though. Is that intended? Shouldn't there be a verbose warning to the user?\n\nAfter applying the patch, for occ integrity:check-app gallery I expectedly get\n`  - INVALID_HASH:\n    - lib/Middleware/EnvCheckMiddleware.php:\n      - expected: 90bccdfa0e62c3d21bf7a917fe2d2b7d018d6d88dbcd9d4a4d2d1738647491ee4baf461a756a6d2417c6e7d0d815e847cf087a702a21e56a997b61d4688f7bf7\n      - current: e502f08482a540ce0511655fe54d4a301dcd2c22e0740ed9ff6016c0388835ae5bf4f80e1e9d91d5d1a08273c97afe061632ff83feac970232648caa306a0699`\n\nIn nextcloud log, I get\n`{\"reqId\":\"JeNGAbwpGnefwi8HDSOU\",\"level\":3,\"time\":\"2019-10-22T15:27:50+02:00\",\"remoteAddr\":\"192.168.1.2\",\"user\":\"seyfartho\",\"app\":\"index\",\"method\":\"GET\",\"url\":\"\\/apps\\/gallery\\/config?extramediatypes=1\",\"message\":{\"Exception\":\"ParseError\",\"Message\":\"syntax error, unexpected '*', expecting end of file\",\"Code\":0,\"Trace\":[{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/composer\\/composer\\/ClassLoader.php\",\"line\":322,\"function\":\"Composer\\\\Autoload\\\\includeFile\",\"args\":[\"\\/server\\/www\\/suevia\\/cloud\\/apps\\/gallery\\/lib\\/\\/Middleware\\/EnvCheckMiddleware.php\"]},{\"function\":\"loadClass\",\"class\":\"Composer\\\\Autoload\\\\ClassLoader\",\"type\":\"-\u003e\",\"args\":[\"OCA\\\\Gallery\\\\Middleware\\\\EnvCheckMiddleware\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/apps\\/gallery\\/lib\\/AppInfo\\/Application.php\",\"line\":373,\"function\":\"spl_autoload_call\",\"args\":[\"OCA\\\\Gallery\\\\Middleware\\\\EnvCheckMiddleware\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"OCA\\\\Gallery\\\\AppInfo\\\\{closure}\",\"class\":\"OCA\\\\Gallery\\\\AppInfo\\\\Application\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive parameters replaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/DependencyInjection\\/DIContainer.php\",\"line\":282,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"EnvCheckMiddleware\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\{closure}\",\"class\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\DIContainer\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive parameters replaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/DependencyInjection\\/DIContainer.php\",\"line\":169,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"MiddlewareDispatcher\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\{closure}\",\"class\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\DIContainer\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive parameters replaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/App.php\",\"line\":118,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"Dispatcher\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/Routing\\/RouteActionHandler.php\",\"line\":47,\"function\":\"main\",\"class\":\"OC\\\\AppFramework\\\\App\",\"type\":\"::\",\"args\":[\"ConfigController\",\"get\",\"*** sensitive parameter replaced ***\",{\"_route\":\"gallery.config.get\"}]},{\"function\":\"__invoke\",\"class\":\"OC\\\\AppFramework\\\\Routing\\\\RouteActionHandler\",\"type\":\"-\u003e\",\"args\":[{\"_route\":\"gallery.config.get\"}]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/Route\\/Router.php\",\"line\":297,\"function\":\"call_user_func\",\"args\":[{\"__class__\":\"OC\\\\AppFramework\\\\Routing\\\\RouteActionHandler\"},{\"_route\":\"gallery.config.get\"}]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/base.php\",\"line\":1000,\"function\":\"match\",\"class\":\"OC\\\\Route\\\\Router\",\"type\":\"-\u003e\",\"args\":[\"\\/apps\\/gallery\\/config\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/index.php\",\"line\":42,\"function\":\"handleRequest\",\"class\":\"OC\",\"type\":\"::\",\"args\":[]}],\"File\":\"\\/server\\/www\\/suevia\\/cloud\\/apps\\/gallery\\/lib\\/Middleware\\/EnvCheckMiddleware.php\",\"Line\":522,\"CustomMessage\":\"--\"},\"userAgent\":\"Mozilla\\/5.0 (X11; Linux x86_64; rv:70.0) Gecko\\/20100101 Firefox\\/70.0\",\"version\":\"17.0.0.9\"}`","automated_response":false,"created_at":"2019-10-22T13:59:08.706Z","updated_at":"2019-10-22T13:59:08.706Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6106337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, of course the check fails because the file was modified, exactly what the feature reporting the issue is about. it will be fixed with the next release","automated_response":false,"created_at":"2019-10-22T14:07:32.641Z","updated_at":"2019-10-22T14:07:32.641Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6106339,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2019-10-22T14:07:49.710Z","updated_at":"2019-10-22T14:07:49.710Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nursoda","url":"/nursoda"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6106545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You may use my clear name \"Olav Seyfarth\" along with my pseudonym \"nursoda\". Thanks!\n\nI found and reported it as person. I'm a privacy consultant and evangelist. So there's no need to add my company, e-mail address or website mentioned, I don't want to be contacted. Hacking is not my business, I just run my own arch server, with 4 domains, each with an NC instance :-)","automated_response":false,"created_at":"2019-10-22T14:27:57.239Z","updated_at":"2019-10-22T14:27:57.239Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6186122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nETA for that maintenance release/advisory?","automated_response":false,"created_at":"2019-10-31T17:16:02.745Z","updated_at":"2019-10-31T17:16:02.745Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6192829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On the affected NC installation, I applied the above commit. It DID work fine. But after upgrading to latest PHP-FPM 7.3.11 and modifying nginx NC site definition according to https://nextcloud.com/blog/urgent-security-issue-in-nginx-php-fpm/ , the patched gallery app yields \"internal server error\" no matter whether logged in or not:\n\n`app\":\"index\",\"method\":\"GET\",\"url\":\"\\/apps\\/gallery\\/config?extramediatypes=1\",\"message\":{\"Exception\":\"ParseError\",\"Message\":\n\"syntax error, unexpected '*', expecting end of file\",\"Code\":0,\"Trace\":[{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/composer\n\\/composer\\/ClassLoader.php\",\"line\":322,\"function\":\"Composer\\\\Autoload\\\\includeFile\",\"args\":[\"\\/server\\/www\\/suevia\\/cloud\\/\napps\\/gallery\\/lib\\/\\/Middleware\\/EnvCheckMiddleware.php\"]},{\"function\":\"loadClass\",\"class\":\"Composer\\\\Autoload\\\\ClassLoader\n\",\"type\":\"-\u003e\",\"args\":[\"OCA\\\\Gallery\\\\Middleware\\\\EnvCheckMiddleware\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/apps\\/gallery\\\n/lib\\/AppInfo\\/Application.php\",\"line\":373,\"function\":\"spl_autoload_call\",\"args\":[\"OCA\\\\Gallery\\\\Middleware\\\\EnvCheckMiddlew\nare\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"O\nCA\\\\Gallery\\\\AppInfo\\\\{closure}\",\"class\":\"OCA\\\\Gallery\\\\AppInfo\\\\Application\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive parameters \nreplaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/DependencyInjection\\/DIContainer.php\",\"li\nne\":282,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"EnvCheckMiddleware\"]},{\"file\":\"\\/server\\/www\n\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"OC\\\\AppFramework\\\\DependencyIn\njection\\\\{closure}\",\"class\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\DIContainer\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive paramete\nrs replaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/DependencyInjection\\/DIContainer.php\",\n\"line\":169,\"function\":\"offsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"MiddlewareDispatcher\"]},{\"file\":\"\\/server\n\\/www\\/suevia\\/cloud\\/3rdparty\\/pimple\\/pimple\\/src\\/Pimple\\/Container.php\",\"line\":118,\"function\":\"OC\\\\AppFramework\\\\Depende\nncyInjection\\\\{closure}\",\"class\":\"OC\\\\AppFramework\\\\DependencyInjection\\\\DIContainer\",\"type\":\"-\u003e\",\"args\":[\"*** sensitive par\nameters replaced ***\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\\/AppFramework\\/App.php\",\"line\":118,\"function\":\"o\nffsetGet\",\"class\":\"Pimple\\\\Container\",\"type\":\"-\u003e\",\"args\":[\"Dispatcher\"]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/private\n\\/AppFramework\\/Routing\\/RouteActionHandler.php\",\"line\":47,\"function\":\"main\",\"class\":\"OC\\\\AppFramework\\\\App\",\"type\":\"::\",\"ar\ngs\":[\"ConfigController\",\"get\",\"*** sensitive parameter replaced ***\",{\"_route\":\"gallery.config.get\"}]},{\"function\":\"__invoke\n\",\"class\":\"OC\\\\AppFramework\\\\Routing\\\\RouteActionHandler\",\"type\":\"-\u003e\",\"args\":[{\"_route\":\"gallery.config.get\"}]},{\"file\":\"\\/s\nerver\\/www\\/suevia\\/cloud\\/lib\\/private\\/Route\\/Router.php\",\"line\":297,\"function\":\"call_user_func\",\"args\":[{\"__class__\":\"OC\\\n\\AppFramework\\\\Routing\\\\RouteActionHandler\"},{\"_route\":\"gallery.config.get\"}]},{\"file\":\"\\/server\\/www\\/suevia\\/cloud\\/lib\\/b\nase.php\",\"line\":1000,\"function\":\"match\",\"class\":\"OC\\\\Route\\\\Router\",\"type\":\"-\u003e\",\"args\":[\"\\/apps\\/gallery\\/config\"]},{\"file\":\n\"\\/server\\/www\\/suevia\\/cloud\\/index.php\",\"line\":42,\"function\":\"handleRequest\",\"class\":\"OC\",\"type\":\"::\",\"args\":[]}],\"File\":\"\n\\/server\\/www\\/suevia\\/cloud\\/apps\\/gallery\\/lib\\/Middleware\\/EnvCheckMiddleware.php\",\"Line\":522,\"CustomMessage\":\"--\"},\"user\nAgent\":\"Mozilla\\/5.0 (X11; Linux x86_64; rv:70.0) Gecko\\/20100101 Firefox\\/70.0\",\"version\":\"17.0.0.9\"}`\n\nNo error if nginx NC site definition hardening is used without the patch.","automated_response":false,"created_at":"2019-11-01T11:54:10.966Z","updated_at":"2019-11-01T11:55:25.013Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6210426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e ETA for that maintenance release/advisory?\n\nUsually we publish them 2-4 weeks after the release.\nThe release is planned for 7th November","automated_response":false,"created_at":"2019-11-04T09:47:38.202Z","updated_at":"2019-11-04T09:47:38.202Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6210458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The parse error from your second comment sounds like you didnt apply the patch correctly, or it created a conflict.","automated_response":false,"created_at":"2019-11-04T09:52:44.846Z","updated_at":"2019-11-04T09:52:44.846Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6271728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, I installed 17.0.1 and verified that the fix works fine (gives proper 404 with explanation) while the app also works both for uploading and accessing the gallery. No idea what caused the above error. Thanks for all so far.\n\nHowever, I was surprised to neither see it referenced in the [Changelog](https://nextcloud.com/changelog/#17-0-1) (or did I miss it?) nor on [Security Advisories](https://nextcloud.com/security/advisories/). Was that on purpose?","automated_response":false,"created_at":"2019-11-10T12:52:59.386Z","updated_at":"2019-11-10T12:52:59.386Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6277591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, we always publish the advisories 2-4 weeks after a release so people had time to update, before an easy attack-path is posted publicly.","automated_response":false,"created_at":"2019-11-11T14:11:45.015Z","updated_at":"2019-11-11T14:11:45.015Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6278342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see, thanks.","automated_response":false,"created_at":"2019-11-11T15:31:24.814Z","updated_at":"2019-11-11T15:31:24.814Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6278855,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-11-11T16:07:23.301Z","updated_at":"2019-11-11T16:07:23.301Z","additional_data":{"old_severity":"High (7.5)","new_severity":"Medium (5.0)","old_severity_id":544472,"new_severity_id":562778},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6278947,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-11-11T16:18:15.433Z","updated_at":"2019-11-11T16:18:15.433Z","additional_data":{"old_title":"file-drop folder content visible through gallery","new_title":"File-drop content is visible through the gallery app"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6681826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is a reminder to post an advisory since the report is 2 months ago, and the fix more than 4 weeks. Nothing on https://nextcloud.com/security/advisories/ yet.","automated_response":false,"created_at":"2020-01-03T15:07:38.243Z","updated_at":"2020-01-03T15:07:38.243Z","actor":{"username":"nursoda","cleared":false,"url":"/nursoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/bFsX9j1QPxJy2tMEmvC1NXts/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6929915,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Advisory has been published: https://nextcloud.com/security/advisory/?id=NC-SA-2019-012\nCVE assignment is still pending at H1","automated_response":false,"created_at":"2020-01-31T10:34:44.271Z","updated_at":"2020-01-31T10:34:44.271Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6929917,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-31T10:34:51.735Z","updated_at":"2020-01-31T10:34:51.735Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6929926,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-01-31T10:36:24.853Z","updated_at":"2020-01-31T10:36:24.853Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}