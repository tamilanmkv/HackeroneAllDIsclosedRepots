{"id":72785,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjc4NQ==","url":"https://hackerone.com/reports/72785","title":"CSV Injection with the CVS export feature","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-26T19:53:52.138Z","submitted_at":"2015-06-26T19:53:52.138Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"appsec3","url":"/appsec3","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-09-21T22:04:25.799Z","bug_reporter_agreed_on_going_public_at":"2015-09-21T22:04:25.400Z","team_member_agreed_on_going_public_at":"2015-08-26T18:32:28.395Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The \"Download as a CSV\" feature of HackerOne does not properly \"escape\" fields. This allows an adversary to turn a field into active content so when a response team download the csv and opens it, the active content gets executed. Here is more information about this issue: http://www.contextis.com/resources/blog/comma-separated-vulnerabilities/\r\n\r\nHere is one method to reproduce this issue:\r\n\r\n1. As a researcher, I can report an issue with a name starting with \"=1+1\"\r\n2. As a response team, I choose to export all issues found to CSV containing the issue in (1)\r\n3. As a response team, I now open this CSV file in excel or another spreadsheet program\r\n4. You can see the cell containing the issue name in (1) is displayed as \"2\" which means the code is executed.\r\n\r\nMitigation:\r\nEnsure all fields are properly \"escaped\" before returning the CSV file to the user.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-25T18:32:29.248Z","allow_singular_disclosure_after":-190759702.1742558,"singular_disclosure_allowed":true,"vote_count":6,"voters":["spam404","fantam1","japz","sa1tama0","muhaddix","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":493524,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @appsec3  ! Thanks for your report. We are investigating the issue and will provide an update soon. ","automated_response":false,"created_at":"2015-06-26T21:51:14.497Z","updated_at":"2015-06-26T21:51:14.497Z","actor":{"username":"nisha","cleared":false,"url":"/nisha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/281/000ac416929b11797e914561d17c095d92cafd85_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":493538,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-06-26T22:07:51.131Z","updated_at":"2015-06-26T22:07:51.131Z","actor":{"username":"nisha","cleared":false,"url":"/nisha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/281/000ac416929b11797e914561d17c095d92cafd85_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":493748,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@appsec3, we released a fix that adds ' before any = in report titles when exporting as CSV. Can you confirm the issue is corrected?\n\nWe will follow-up next week as to bounty consideration / decision.","automated_response":false,"created_at":"2015-06-27T06:26:36.513Z","updated_at":"2015-06-27T06:26:36.513Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"appsec3","url":"/appsec3"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":493974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks like the = issue is fixed. Excellent idea on enclosing the field with quotes to prevent comma escaping.\n\nDuring my research, I discovered that - and + will also work (it's not as elegant as =, but still possible to extract data from the csv with these characters). To reproduce, just replace \"=1+1\" from step 1 with \"-2+2\" for example.\n\nAlso, the reporter field may also be a suspect but I have not tested it. It's best to look through all the fields that can be manipulated by the user and ensure they're all escaped and enclosed with \"\"","automated_response":false,"created_at":"2015-06-27T15:06:40.004Z","updated_at":"2015-06-27T15:06:40.004Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":494113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you give an example as to how you would use - and + to ex-filtrate data? Basic math doesn't actually equate to data being sent off-site.\n\nReporter field is fine based off of our strict username requirements. Report title is the only user-controlled field, so that should cover it.","automated_response":false,"created_at":"2015-06-27T19:11:56.369Z","updated_at":"2015-06-27T19:11:56.369Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":494163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Once excel interprets the cell as active content, it will attempt to execute functions contained in it.  For example, -2+2+FUNCTION(...). Here's a working example: \n\n-2+3+cmd|' /C calc'!A0\n\nThis would let you use cmd to execute commands. As mentioned, it's not as elegant as it pops up warning to the user. BUT, the user here would assume the content is coming from a trusted source, HackerOne, so chances are good that this command will get executed.","automated_response":false,"created_at":"2015-06-27T20:47:17.003Z","updated_at":"2015-06-27T20:47:17.003Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":509351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there anything else you need from me for this report?","automated_response":false,"created_at":"2015-07-14T22:08:28.335Z","updated_at":"2015-07-14T22:08:28.335Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":509430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @appsec3,\n\nWhat would you suggest as fix for the last issue you described? Excel will always try to become \"smarter\" with every release, so we can only do so much to prevent it from processing data that looks like active content as active content. Using quotation marks to force all data into string format doesn't seem like a great solution for users that actually want to work with the exported numeric values.","automated_response":false,"created_at":"2015-07-14T22:47:12.675Z","updated_at":"2015-07-14T22:47:12.675Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":509455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Excel only treats a cell data as active content when it encounters a \"trigger\" character. The list of trigger characters as per Excel are: +, -, and =. \n\nThe easiest solution is to ensure cells that begin with these characters are prepended with a single quote. Excel will ignore the single quote when the data is displayed and will not treat the data as active content. \n\nIf you would like a more future proof version, then doing some sort of URL encoding scheme would work (but this may also impact UX).\n\nThe best solution is for you to restrict the user enter data to a whitelist set of characters similar to how you've done it for the username. Of course, it'll probably need to be less restrictive than what you have for the username.","automated_response":false,"created_at":"2015-07-14T23:00:18.858Z","updated_at":"2015-07-14T23:00:18.858Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":511288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @appsec3,\n\nWe've just pushed a fix for the +/- cases. Can you verify this on your end?","automated_response":false,"created_at":"2015-07-16T02:40:33.113Z","updated_at":"2015-07-16T02:40:33.113Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":512264,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks good.","automated_response":false,"created_at":"2015-07-16T17:02:12.797Z","updated_at":"2015-07-16T17:02:12.797Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":528936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Have you decided on the bounty / decision?","automated_response":false,"created_at":"2015-07-28T18:57:58.465Z","updated_at":"2015-07-28T18:57:58.465Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":564461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?","automated_response":false,"created_at":"2015-08-26T18:24:36.069Z","updated_at":"2015-08-26T18:24:36.069Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":564469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My bad. I totally dropped the ball here.","automated_response":false,"created_at":"2015-08-26T18:31:12.578Z","updated_at":"2015-08-26T18:31:12.578Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":564471,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you so much for the detailed report and for working with us on getting it corrected. Sorry again for the long delay in getting this bounty decision made and processed.\n\nWe welcome any future reports from you, and we'll make sure to stay more on top of the bounty payout and current status in the future.","automated_response":false,"created_at":"2015-08-26T18:32:21.101Z","updated_at":"2015-08-26T18:32:21.101Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"appsec3","url":"/appsec3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":564472,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-08-26T18:32:28.467Z","updated_at":"2015-08-26T18:32:28.467Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":564500,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.","automated_response":false,"created_at":"2015-08-26T18:52:15.460Z","updated_at":"2015-08-26T18:52:15.460Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":594729,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-21T22:04:25.426Z","updated_at":"2015-09-21T22:04:25.426Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":594730,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-09-21T22:04:25.834Z","updated_at":"2015-09-21T22:04:25.834Z","actor":{"username":"appsec3","cleared":false,"url":"/appsec3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}