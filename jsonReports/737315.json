{"id":737315,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzczMTU=","url":"https://hackerone.com/reports/737315","title":"'X-Forwarded-Host' key used in input without sanitation - possible cache poisoning","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-11-14T11:52:10.340Z","submitted_at":"2019-11-14T11:52:10.340Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rhetoric","url":"/rhetoric","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2450,"url":"https://hackerone.com/maximum","handle":"maximum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Maximum","twitter_handle":"maximum_NL","website":"https://maximum.nl","about":"Maximum is a full-service agency specialised in employer branding and recruitment advertising."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-14T16:38:07.514Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-15T16:38:05.121Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Domain and URL:**\nmaximum.nl\n\n**Summary:** \nThe HTTP 'X-Forwarded-Host' is dynamically used in the application without sanitization, allowing an attacker control of the input key. This can allow for self-XSS, or when a CDN or caching service is deployed, risk the CDN caching the request and serving the injected payload to other users.\n\nPoC:\n\n```$ curl -v https://www.maximum.nl/ -H 'X-Forwarded-Host: exampleinject' 2\u003e\u00261 | grep 'exampleinject'\n                \u003clink rel=\"alternate\" hreflang=\"nl\" type=\"application/atom+xml\" href=\"https://exampleinject/feed-page\" title=\"Page Feed\"\u003e\n                \u003clink rel=\"alternate\" hreflang=\"nl\" type=\"application/atom+xml\" href=\"https://exampleinject/feed-vacancy\" title=\"Vacancy Feed\"\u003e\n    \u003cmeta property=\"og:url\" content=\"https://exampleinject\" /\u003e\n```\nHere my input is returned in the web applications response. When cached this it will return to other users.\n\n\n## Steps To Reproduce:\n\nSee PoC\n\n## Impact\n\nInjected response being returned to users","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":72,"name":"Resource Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-14T16:38:05.325Z","allow_singular_disclosure_after":-52267437.60418691,"singular_disclosure_allowed":true,"vote_count":10,"voters":["ali","javo","exception","hamzaavvan","sa1tama0","cryptographer","dolph1n","iftek","emprass","diamondkill"],"severity":{"rating":"low","score":3.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":162,"asset_type":"URL","asset_identifier":"*.maximum.nl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6366386,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey rhetoric,\n\nThank you for your report\nWe're going to look into it.\n\nRegards,\nbamie","automated_response":false,"created_at":"2019-11-21T08:22:49.136Z","updated_at":"2019-11-21T08:22:49.136Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6705582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any update? Thanks ","automated_response":false,"created_at":"2020-01-07T08:52:26.613Z","updated_at":"2020-01-07T08:52:26.613Z","actor":{"username":"rhetoric","cleared":false,"url":"/rhetoric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6712667,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-07T22:28:26.319Z","updated_at":"2020-01-07T22:28:26.319Z","additional_data":{"old_severity":"High (8.2)","new_severity":"Low (3.1)","old_severity_id":565485,"new_severity_id":602414},"actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6712674,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your patience and the reminder. It's fixed as of today.\nI'll assign my colleague to assign bounty\n\nhang tight!","automated_response":false,"created_at":"2020-01-07T22:29:34.321Z","updated_at":"2020-01-07T22:29:34.321Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rhetoric","url":"/rhetoric"},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6778488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-15T16:38:05.171Z","updated_at":"2020-01-15T16:38:05.171Z","first_to_agree":true,"actor":{"username":"maarten","cleared":false,"url":"/maarten","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/074/37cec379fad2e1b82ca4b9c4c3131f10acf45caa_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6817132,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, why was this marked as resolved and disclosure requested, but no bounty assigned? That was also 5 days ago..","automated_response":false,"created_at":"2020-01-20T13:15:10.020Z","updated_at":"2020-01-20T13:15:10.020Z","actor":{"username":"rhetoric","cleared":false,"url":"/rhetoric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6817135,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Hi,\nThey resolved and fixed issue, said they would assign bounty, yet 5 days later did not and have requested disclosure too. ","automated_response":false,"created_at":"2020-01-20T13:15:29.720Z","updated_at":"2020-01-20T13:15:29.720Z","actor":{"username":"rhetoric","cleared":false,"url":"/rhetoric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6817143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Correction: 13 days, not 5.","automated_response":false,"created_at":"2020-01-20T13:15:57.807Z","updated_at":"2020-01-20T13:15:57.807Z","actor":{"username":"rhetoric","cleared":false,"url":"/rhetoric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6817157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, the person who does the payouts does that about once a month for all reports. So you might have to wait a little.","automated_response":false,"created_at":"2020-01-20T13:17:31.254Z","updated_at":"2020-01-20T13:17:31.254Z","actor":{"username":"maarten","cleared":false,"url":"/maarten","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/074/37cec379fad2e1b82ca4b9c4c3131f10acf45caa_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6824625,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks @rhetoric for your report and patience,\n\nbest, Mark","automated_response":false,"created_at":"2020-01-21T10:22:30.370Z","updated_at":"2020-01-21T10:22:30.370Z","actor":{"url":"/maximum","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Maximum"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"maximum","collaborator":{"username":"rhetoric","url":"/rhetoric"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7055237,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-02-14T16:38:07.548Z","updated_at":"2020-02-14T16:38:07.548Z","actor":{"url":"/maximum","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Maximum"}},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}