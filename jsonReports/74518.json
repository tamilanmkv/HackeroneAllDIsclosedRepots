{"id":74518,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDUxOA==","url":"https://hackerone.com/reports/74518","title":"The email updates issues","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-08T21:19:29.475Z","submitted_at":"2015-07-08T21:19:29.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"s_p_q_r","url":"/s_p_q_r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":293,"url":"https://hackerone.com/digitalsellz","handle":"digitalsellz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"DigitalSellz","twitter_handle":null,"website":"https://www.digitalsellz.com/","about":"Planning to sell your files? Need a platform to sell your new e-book? May be just music, photos, articles, digital art or movies? Try DigitalSellz.com"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-25T21:30:41.362Z","bug_reporter_agreed_on_going_public_at":"2015-07-26T21:30:32.529Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. The email message content at the https://www.digitalsellz.com/user/#/email-updates page (contrary to the [email customization one](https://www.digitalsellz.com/user/#/custom-email)) is not validated properly. So this form allows all the html tags and their parameters. For example, all the following tags are sent as is:\r\n\r\n\u003e \u003ca href=\"javascript:alert(0)\"\u003eLink\u003c/a\u003e\r\n\u003ca href='javascript:alert(1)'\u003eLink\u003c/a\u003e\r\n\u003cimg src=x onerror=\"alert(2)\" /\u003e\r\n\u003cscript\u003ealert(3)\u003c/script\u003e\r\n\r\nand all their scripts will be executed if the email service the customer uses doesn't have a proper protection itself. Of course most of the modern email services do this, but there are still some not too widespread ones that don't. This also relates to the customers that have their own servers and have the emails there.\r\n\r\nWell, it's the recipient system's vulnerability mostly, but you also shouldn't send executable code there. Otherwise it would be something like distributing viruses over your clients and saying it's their fault they don't use antivirus software :) Especially since it won't be too hard to fix it, cause you already have this done for the [email customization page](https://www.digitalsellz.com/user/#/custom-email) mentioned above â€” all the unnecessary tags and parameters are properly sanitized, so you just have to copy the validating code from there.\r\n\r\n2\\. Also I don't think it's a good idea to let anyone send whatever he wants on your behalf in general\r\n\r\nFor example, the attacker can send emails as follows:\r\n\r\n\u003e Due to the recent security issue some of our accounts have been compromised.\r\n\u003e\r\n\u003e We recommend you to change your password as soon as possible. To do this please click the following link:\r\n\u003e\r\n\u003e[Change your password](http://phishing_link)\r\n\r\nBeing sent on behalf of support@digitalsellz.com and designed kinda like your forget password mail, it can easily mislead the customers, so they will open the attacker's phishing link and put their login and password there.\r\n\r\nHe can also send something abusive or prohibited by law.\r\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-08-25T21:30:32.886Z","allow_singular_disclosure_after":-193427530.25336993,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":503689,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello again @s_p_q_r. Nice approach  with \"the email being sent on behalf of support@digitalsellz.com\".  We will fix this by changing the email to no-reply@digitalsellz.com and adding a security message at the end of the page.","automated_response":false,"created_at":"2015-07-09T04:56:19.061Z","updated_at":"2015-07-09T04:56:19.061Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":503969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug has been fixed. Can you confirm?","automated_response":false,"created_at":"2015-07-09T15:20:21.504Z","updated_at":"2015-07-09T15:20:21.504Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":504000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not fix. Will check again this also.","automated_response":false,"created_at":"2015-07-09T16:17:06.204Z","updated_at":"2015-07-09T16:17:06.204Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":510858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you please confirm this bug it has been fixed?","automated_response":false,"created_at":"2015-07-15T22:29:46.193Z","updated_at":"2015-07-15T22:29:46.193Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":511819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This one looks like not fixed\n\n\u003e We will fix this by changing the email to no-reply@digitalsellz.com\n\nEmails are still sent from support@digitalsellz.com\n\n\u003e and adding a security message at the end of the page\n\nThe message \"We will never ask you for your password information via e-mail.\" has been added to the very end. So if the message is quite big and colorful, the recepient will more likely not even notice it.\n\nFurthermore, as mentioned above, html tags are allowed. So I can simply add the comment tag at the vey end, and the security message will disappear.\n\n__PoC:__\n\n1. Go to https://www.digitalsellz.com/user/#/email-updates\n2. Put \"Test \u003c!--\" as the email message\n3. Click \"Send Test Email\"\n4. Check your inbox\n\nThe message received doesn't have the security message.\n\nChecked this for my mail.ru box (see the attached screenshot) and some temp mail one as well.","automated_response":false,"created_at":"2015-07-16T11:03:26.069Z","updated_at":"2015-07-16T11:03:26.069Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":45336,"filename":"mail.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/045/336/57e33c7e6afc0d7f8a96b644d94448e18bb13449/mail.png?response-content-disposition=attachment%3B%20filename%3D%22mail.png%22%3B%20filename%2A%3DUTF-8%27%27mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152243Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8cef5a09c463c24eb97b91a14b415caf296fdbafe36bd308f024f3d39cd356f5"}],"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":525577,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"For now we will only add a message and change the email sender. Thanks for your report.","automated_response":false,"created_at":"2015-07-25T17:37:20.977Z","updated_at":"2015-07-25T17:37:20.977Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"s_p_q_r","url":"/s_p_q_r"},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":526317,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You're welcome!","automated_response":false,"created_at":"2015-07-26T21:30:32.686Z","updated_at":"2015-07-26T21:30:32.686Z","first_to_agree":true,"actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":563068,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-08-25T21:30:42.175Z","updated_at":"2015-08-25T21:30:42.175Z","actor":{"url":"/digitalsellz","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"DigitalSellz"}},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}