{"id":745495,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDU0OTU=","url":"https://hackerone.com/reports/745495","title":"Unauthenticated users can access all food.grammarly.io user's data","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-11-24T23:15:37.689Z","submitted_at":"2019-11-24T23:15:37.689Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cript0nauta","url":"/cript0nauta","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/311/573/85004b102bf6cd590bbbd3b80942a6caa574e0a9_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22746,"url":"https://hackerone.com/grammarly","handle":"grammarly","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Grammarly","twitter_handle":"","website":"https://www.grammarly.com","about":"Grammarly makes sure everything you type is clear, effective, and mistake-free."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-10T10:10:03.488Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-08-07T10:56:04.841Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** The food.grammarly.io site uses the Meteor framework, which uses publications and methods to communicate between the backend and frontend. Although the site seems to require being authenticated as a Grammarly employee to use it, most methods and publications work without being authenticated. I was able to list user data including emails, access tokens and admin status just by using the Chrome Developer tools.\n\n**Description:** I discovered that the following Meteor publications work without being authenticated:\n\n* activeUsers\n* allExtraFood\n* allOrders(date)\n* allUsers\n* allUserStats\n* allVendors\n* allVendorsItems\n* extraFoodFromToday\n* foodEventLog\n* foodSettings\n* itemsLimits\n* monthlyTop\n* vendorByName\n* vendorHistoryFromToday\n* vendorItemsByName\n* vendorsHistory\n\nThis means I can access the data stored in the following Meteor collections:\n* Meteor.users\n* ExtraFood\n* OrderItems\n* UserStats\n* Vendors\n* VendorsItems,\n* FoodEventLog\n* FoodSettings\n* VendorsItemsLimits\n* MontlyTopItems\n* VendorsHistory\n\nThe Meteor.users collection includes the email address of 300+ employees of Grammarly, along with their Okta and Google oauth access tokens, a hash of their login tokens, and their admin status. The FoodSettings collection also exposes some Grammarly user emails.\n\nBased on the source code of the app, it seems that most Meteor methods also don't perform any authentication checks. But because they could perform destruction of data, I preferred not no use them when testing.\n\n\n## Browsers Verified In:\n\n  * Chrome\n  * Firefox\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Visit https://food.grammarly.io and open the Chrome Developer Tools\n  1. In the console, run `Meteor.subscribe('activeUsers')`\n  1. Wait a few seconds, and run `Meteor.users.find().forEach(e =\u003e console.log(e))`\n  1. You will see all user's information, as seen in the screenshots\n\n## Supporting Material/References:\n\n  * The [Meteor Security page](https://guide.meteor.com/security.html) explains how this vulnerabilities can be fixed by implementing proper access control in the Meteor methods and publications\n\n## Impact\n\nAn attacker could use this vulnerability to get information about Grammarly employees. He/she could know which employees have admin privileges and target them in other attacks.\n\nI wasn't able to use the Okta and Google tokens for anything of high impact. Also, the hashedLoginToken requires the attacker to reverse a SHA256 hash of a random secret, so exploiting it seems difficult.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":642832,"file_name":"userlist.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tdKXt76XsBxv4ZH3AsRntswr?response-content-disposition=attachment%3B%20filename%3D%22userlist.png%22%3B%20filename%2A%3DUTF-8%27%27userlist.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152246Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=18816075310c424fd3ad9af1ab9d44b72d4645142ee1db33a93264bf79d564f7","file_size":49546,"type":"image/png"},{"id":642833,"file_name":"userdetail.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BoApwwQszMrRD3dXeqwxSx3Q?response-content-disposition=attachment%3B%20filename%3D%22userdetail.png%22%3B%20filename%2A%3DUTF-8%27%27userdetail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152246Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=61bae30ada2468e43dcf4ba7195647000e0ef2e63a992a983294a52bf8d9e50c","file_size":70899,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-06T10:56:04.983Z","allow_singular_disclosure_after":-34576001.2685494,"singular_disclosure_allowed":true,"vote_count":123,"voters":["xdms","daehee","svalkanov","jensec","yxw21","foobar7","newbipath12","mik317","ali","metnew","and 113 more..."],"severity":{"rating":"low","score":3.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":24235,"asset_type":"URL","asset_identifier":"food.grammarly.io","max_severity":"low"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6399143,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @cript0nauta,\n\nThanks for your report! Moving it to \"Triaged\".","automated_response":false,"created_at":"2019-11-25T14:06:17.939Z","updated_at":"2019-11-25T14:06:17.939Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6413744,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @cript0nauta! Thanks for a great report and an interesting finding in our internal service! This is valuable.\nKeep hunting for more ;)","automated_response":false,"created_at":"2019-11-26T16:28:03.876Z","updated_at":"2019-11-26T16:28:03.876Z","actor":{"url":"/grammarly","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/746/a2bf7f90c683af5214fcc74c1df6804286ee97ce_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Grammarly"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grammarly","collaborator":{"username":"cript0nauta","url":"/cript0nauta"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6465033,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The reported bug was fixed.\nThanks for your report, @cript0nauta!","automated_response":false,"created_at":"2019-12-04T09:57:26.170Z","updated_at":"2019-12-04T09:57:26.170Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cript0nauta","url":"/cript0nauta"},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8873825,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @cript0nauta,\nThat's a nice bug, would you like to disclose the report?","automated_response":false,"created_at":"2020-08-07T10:56:04.874Z","updated_at":"2020-08-07T10:56:04.874Z","first_to_agree":true,"actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8878164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, it would be great!","automated_response":false,"created_at":"2020-08-07T17:48:46.180Z","updated_at":"2020-08-07T17:48:46.180Z","actor":{"username":"cript0nauta","cleared":false,"url":"/cript0nauta","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/311/573/85004b102bf6cd590bbbd3b80942a6caa574e0a9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8892034,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-08-10T10:10:03.400Z","updated_at":"2020-08-10T10:10:03.400Z","actor":{"username":"vladimir_suslenko","cleared":false,"url":"/vladimir_suslenko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grammarly","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}