{"id":748375,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDgzNzU=","url":"https://hackerone.com/reports/748375","title":"Transferring a public group to a private group doesn't remove code from the Elastichsearch API search result","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-11-29T11:18:45.773Z","submitted_at":"2019-11-29T11:18:45.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rpadovani","url":"/rpadovani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-06T21:57:06.733Z","bug_reporter_agreed_on_going_public_at":"2020-10-06T21:57:06.651Z","team_member_agreed_on_going_public_at":"2020-10-06T19:26:12.132Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nWhen a public group with public projects is transferred to a private group, the code and the wiki of the public project, although now should be private, it is still reachable through search APIs.\n\nI set the severity as \"medium\" and not \"high\", because any new action over the project issues a re indexing (or some actions, not sure), so if the transfer is for \"archiving\" purposes it is a problem, but if after the transfer other activities happen, then it is not a problem, cause the project will be removed from the index.\n\n### Steps to reproduce\n\nAlice creates the public group \"Example\", and a public project named \"Example-project\" inside the group. In the readme of the project, Alice writes \"Example\".\n\nNow, Alice creates a private group called \"private\", and transfer all the \"Example\" group to the \"private\" group.\n\nIf Bob (totally unrelated to Alice), search for \"Example\" instance-wide, will not find anything on the interface, but the count of the results will be \"1\" (see screenshot).\n\nIf he uses the APIs (e.g. http://localhost/api/v4/search?search=password\u0026scope=blobs), he will receive the results back with the information that should be private.\n\nThis happens also with wiki_blobs.\n\nThis doesn't happen transferring single projects, but only transferring entire groups\n\n### Output of checks\n\n#### Results of GitLab environment info\n\n``` \nSystem information\nSystem:\t\t\nProxy:\t\tno\nCurrent User:\tgit\nUsing RVM:\tno\nRuby Version:\t2.6.3p62\nGem Version:\t2.7.9\nBundler Version:1.17.3\nRake Version:\t12.3.3\nRedis Version:\t3.2.12\nGit Version:\t2.22.0\nSidekiq Version:5.2.7\nGo Version:\tunknown\n\nGitLab information\nVersion:\t12.5.2-ee\nRevision:\tc1b3929bc67\nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails\nDB Adapter:\tPostgreSQL\nDB Version:\t10.9\nURL:\t\thttp://aldebaran\nHTTP Clone URL:\thttp://aldebaran/some-group/some-project.git\nSSH Clone URL:\tgit@aldebaran:some-group/some-project.git\nElasticsearch:\tyes\nGeo:\t\tno\nUsing LDAP:\tno\nUsing Omniauth:\tyes\nOmniauth Providers: \n\nGitLab Shell\nVersion:\t10.2.0\nRepository storage paths:\n- default: \t/var/opt/gitlab/git-data/repositories\nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell\nGit:\t\t/opt/gitlab/embedded/bin/git\n```\n\n## Impact\n\nAlice thinks her code is now private, but it is not, unless she continues working on the project","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["th3hidd3nmist","thaivu","sameerphad72","ali","naategh","since2003","cryptographer","loki090919","armansameer","qacker","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6432834,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @rpadovani,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/issues/37766. This issue will be made public 30 days following the release of a patch.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2019-11-29T11:55:57.920Z","updated_at":"2019-11-29T11:55:57.920Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6455026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @rpadovani,\n\nAs per our policy, we are awarding you a partial bounty at triage.\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2019-12-03T10:24:47.308Z","updated_at":"2019-12-03T10:24:47.308Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6455028,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-12-03T10:24:56.577Z","updated_at":"2019-12-03T10:24:56.577Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"rpadovani","url":"/rpadovani"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6463471,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @rpadovani,\n\nThe issue you reported is currently scheduled to be fixed by 2019-12-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-12-04T04:06:17.539Z","updated_at":"2019-12-04T04:06:17.539Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6521656,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @rpadovani,\n\nThank you again for the report! Your finding has been patched in GitLab version 12.5.4. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe will come back to you with the bounty award.\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n\n","automated_response":false,"created_at":"2019-12-11T09:15:52.481Z","updated_at":"2019-12-11T09:15:52.481Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rpadovani","url":"/rpadovani"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6533131,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello,\n\nThank you again for the report! We are awarding the final bounty.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-12-12T14:59:40.915Z","updated_at":"2019-12-12T14:59:40.915Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"rpadovani","url":"/rpadovani"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9438601,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-06T19:26:12.157Z","updated_at":"2020-10-06T19:26:12.157Z","first_to_agree":true,"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9439528,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-06T21:57:06.684Z","updated_at":"2020-10-06T21:57:06.684Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9439529,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-06T21:57:06.756Z","updated_at":"2020-10-06T21:57:06.756Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}