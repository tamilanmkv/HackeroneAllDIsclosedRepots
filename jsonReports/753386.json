{"id":753386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTMzODY=","url":"https://hackerone.com/reports/753386","title":"No CSRF Protection in Resend Confirmation Email feature leads to Sending Unwanted Email in Victim's Inbox without knowing Victim's email address","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-12-06T20:57:52.849Z","submitted_at":"2019-12-06T20:57:52.849Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whoisbinit","url":"/whoisbinit","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-08T11:17:01.487Z","bug_reporter_agreed_on_going_public_at":"2020-08-26T05:34:12.133Z","team_member_agreed_on_going_public_at":"2020-09-08T11:17:01.409Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThere's no CSRF protection in confirmation email resending feature as a result of which an attacker can trick the victim to receive a confirmation email unknowingly. In other features of the website, the content-type must be \"application/json\", and there is same-origin policy, which prevents CSRF, but in this one, it isn't necessary to have the content-type \"application/json\", as a result of which the \"resendEmailConfirmation\" endpoint becomes vulnerable to CSRF.\n\n## Steps To Reproduce:\nStep 1. Login to your unverified Stripo account, and then intercept the request made while clicking on the \"Resend it\" text at the top-right corner of the webpage. The HTTP Request would look like this:\nRequest URL: https://my.stripo.email/cabinet/stripeapi/v1/resendEmailConfirmation\nRequest Method: POST\nRequest Data: {}\nStep 2. With the obtained information, create a HTML code like this:\n```\n\u003cbody onload=\"document.form.submit()\"\u003e\n\u003cform name=\"form\" method=\"POST\" action=\"https://my.stripo.email/cabinet/stripeapi/v1/resendEmailConfirmation\"\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n```\nStep 3. Save the file with .html extension, upload it to your website, and send the URL to the victim.\nWhen the victim visits the URL, the request is made automatically from victim's account\n\n### Example URL: https://binitghimire.com.np/stripo/resendEmail.html\n\nThis is how this vulnerability can be reproduced.\n\n## Remediation Actions\nIn accordance with the current situation of the website, the vulnerability can be fixed by making the \"application/json\" content-type compulsory in requests, and optionally passing certain data in the HTTP request so that the reproduction would be impossible, unless the `enctype=\"application/json\"` feature is introduced in higher versions of HTML, and other things would be handled by the existing Same-origin Policy just like in the other features of the website. If the Same-origin Policy hadn't existed, an attacker would have been able to, for example, put any image as someone's profile photo or delete anyone's profile photo, but this doesn't exist, all thanks to the SOP and the content-type \"application/json\" necessity.\n\nAnother way to fix the vulnerability is to introduce the CSRF token system, if you are thinking about bringing a change to the Stripo platform.\n\n## Supporting Material/References:\n  * An image has been attached along with this vulnerability report.\n\n## Impact\n\nAs a result of this vulnerability, an attacker would be able to lead the victim in receiving confirmation email without even knowing and without clicking any buttons or filling up any details.\n\nI would be looking forward to hearing from you soon.\n\nThanks,\n@binit","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":652858,"file_name":"Result_of_CSRF.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jYbWpRXL22UuLRiWeNCH33HK?response-content-disposition=attachment%3B%20filename%3D%22Result_of_CSRF.png%22%3B%20filename%2A%3DUTF-8%27%27Result_of_CSRF.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152326Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d6f36b107cd6bdc199c342d4d905d98a6ba91ac48722eea8796b2f3012c7af25","file_size":24780,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["bibekshah","dhakal_bibek","akashhamal0x01","styrene","sa1tama0","linusiar","zaher1911","aliasnotallowed","valluvarsploit"],"severity":{"rating":"medium","score":6.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":38702,"asset_type":"URL","asset_identifier":"my.stripo.email","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6502603,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @binit \n\nThanks a lot for this report, we planned to fix this during the next 2 weeks. Keep in touch!\n\nRegards,\nStripo Dev Team","automated_response":false,"created_at":"2019-12-09T12:38:59.753Z","updated_at":"2019-12-09T12:38:59.753Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6503183,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nThat's great! I hope to see this issue getting fixed soon.\n\nThanks,\nBinit Ghimire","automated_response":false,"created_at":"2019-12-09T13:41:43.768Z","updated_at":"2019-12-09T13:41:43.768Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6510952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@binit it os planned for the next dev iteration.","automated_response":false,"created_at":"2019-12-10T09:31:43.980Z","updated_at":"2019-12-10T09:31:43.980Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6534616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh! :) \n\nThank you for letting me know about the current state!","automated_response":false,"created_at":"2019-12-12T17:20:21.081Z","updated_at":"2019-12-12T17:20:21.081Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6625044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nIs there any update regarding this issue?\n\nThanks,\n@binit","automated_response":false,"created_at":"2019-12-25T08:36:54.169Z","updated_at":"2019-12-25T08:36:54.169Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6706890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there,\n\nI am looking forward to hearing from you regarding this issue.\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-01-07T10:32:23.534Z","updated_at":"2020-01-07T10:32:23.534Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6718659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@binit \nthanks for pushing\nthis is still in the queue because of the vast amount of other reports. Planned for the next sprint 13th-24th of January","automated_response":false,"created_at":"2020-01-08T15:31:25.565Z","updated_at":"2020-01-08T15:31:25.565Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6720710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nThat's awesome! Looking forward to witness the results of the next sprint!\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-01-08T20:10:37.135Z","updated_at":"2020-01-08T20:10:37.135Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6986258,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-02-07T10:19:30.430Z","updated_at":"2020-02-07T10:19:30.430Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"whoisbinit","url":"/whoisbinit"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7055013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good to see that the vulnerability is now resolved, @artem_nefedov!","automated_response":false,"created_at":"2020-02-14T16:24:20.897Z","updated_at":"2020-02-14T16:24:20.897Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9040805,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello there,\n\nWould it be fine if we disclose this report? That would really be great!\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-08-26T05:34:12.165Z","updated_at":"2020-08-26T05:34:12.165Z","first_to_agree":true,"actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9159112,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-08T11:17:01.428Z","updated_at":"2020-09-08T11:17:01.428Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9159114,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-08T11:17:01.517Z","updated_at":"2020-09-08T11:17:01.517Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9159431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @artem_nefedov,\n\nThank you for your agreement in disclosing this report!\n\nI am looking forward to working with the team for more security issues in the near future.\n\nThanks,\n@binit","automated_response":false,"created_at":"2020-09-08T11:57:08.241Z","updated_at":"2020-09-08T11:57:08.241Z","actor":{"username":"whoisbinit","cleared":false,"url":"/whoisbinit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":24340,"category":"researcher","content":"There was no CSRF protection in the feature used for resending confirmation email in **Stripo**, due to which an attacker could trick the victim to receive an account confirmation email unknowingly.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":204685,"username":"whoisbinit","name":"Binit Ghimire","bio":"I am a Tech Enthusiastic full-stack web developer, programmer and web/network penetration tester from Nepal.","cleared":false,"website":"https://WHOISbinit.me/","location":"Bharatpur-9, Milanchowk, Chitwan","created_at":"2017-10-02T06:42:57.263Z","url":"https://hackerone.com/whoisbinit","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}