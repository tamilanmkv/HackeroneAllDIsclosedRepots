{"id":756833,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTY4MzM=","url":"https://hackerone.com/reports/756833","title":"Public available Sensitive Information about drivers","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2019-12-12T09:36:06.215Z","submitted_at":"2019-12-12T09:36:06.215Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"krupnikas","url":"/krupnikas","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/BS4JWe517cCjDVNMiyKhcKKy/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-18T18:12:37.001Z","bug_reporter_agreed_on_going_public_at":"2019-12-18T18:12:36.946Z","team_member_agreed_on_going_public_at":"2019-12-18T17:58:40.191Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nAPI for client app Citimobil\nhttps://c-api.city-mobil.ru/\nVersion 4.33.0 (and others)\n\nTesting environment\n--\nDevice on any OS with internet connection\nAny software to send https requests\n\nSteps to reproduce\n--\nSend POST request to url \"https://c-api.city-mobil.ru/getdrivers\" with data:\n{\n        \"latitude\": LAT,\n        \"longitude\": LON,\n        \"limit\": 10,\n        \"method\": \"getdrivers\",\n        \"radius\": 5,\n        \"tariff_group\":  [ 4 ],\n        \"ver\": \"4.33.0\"\n}\n\nActual results\n--\nResponse will contain GEO and BUSINESS data about 10 drivers nearest to the requested point - their positions, color codes, directions and car types.  Iterating over different city locations you can get the whole information about company fleet.\n\nThe response will proceed without any authentication. So the sensitive real-time information about company fleet is public available. \n\nExpected results, security impact description and recommendations\n--\nThe authentication procedure for this data should be required \n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n**Request:**\n```\ncurl -X POST --data '{ \"latitude\": 55.7, \"limit\": 10, \"longitude\": 37.6, \"method\": \"getdrivers\", \"radius\": 5, \"tariff_group\": [4], \"ver\": \"4.33.0\" }' https://c-api.city-mobil.ru/getdrivers\n```\n**Response:**\n~~~\n{\"drivers\":[{\"id\":\"1c1f6779f893af6fe5bf4509af7366cd\",\"lt\":\"55.7025061\",\"ln\":\"37.5954334\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort_plus\"},{\"id\":\"1a13d0daad9b6a3fa2b3d04a5b6f8c2a\",\"lt\":\"55.7019682\",\"ln\":\"37.6054896\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"},{\"id\":\"c7c1634fae41a68924083af1d496d0a7\",\"lt\":\"55.7014223\",\"ln\":\"37.6067352\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort_plus\"},{\"id\":\"f15ce054ccdaa268b16a0904b9eecdae\",\"lt\":\"55.6956527\",\"ln\":\"37.5972063\",\"direction\":\"4\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"94ebc0fcc644bb1da4b57e7d23942e6d\",\"lt\":\"55.694786\",\"ln\":\"37.5982642\",\"direction\":\"4\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"7251c45ee945c9cb839d69d5902b9f17\",\"lt\":\"55.7009351\",\"ln\":\"37.6094206\",\"direction\":\"3\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"},{\"id\":\"cb9dab2ba7379c3db817dd76ec68e6c5\",\"lt\":\"55.6950137\",\"ln\":\"37.6041883\",\"direction\":\"8\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"761891d9c1129b1678c3eba616249e2b\",\"lt\":\"55.6944542\",\"ln\":\"37.5951122\",\"direction\":\"2\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"4f0e835751cadaa5d5386f0e1374f315\",\"lt\":\"55.7066516\",\"ln\":\"37.6011767\",\"direction\":\"7\",\"CarColorCode\":\"000000\",\"car_type\":\"sedan\"},{\"id\":\"2eb330cad5e5d9c87e6d0600a9ff10e8\",\"lt\":\"55.7066801\",\"ln\":\"37.6009127\",\"direction\":\"8\",\"CarColorCode\":\"000000\",\"car_type\":\"comfort\"}],\"nearest\":{\"duration\":420},\"service_status\":1}\n~~~\n\n## Impact\n\nGet sensitive real-time information about company fleet.","weakness":{"id":101,"name":"Insecure Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["artebels","snork","0x08","infinity19","2701896"],"severity":{"rating":"none","score":0.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":40415,"asset_type":"OTHER","asset_identifier":"Citymobil","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6530490,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-12-12T09:51:43.651Z","updated_at":"2019-12-12T09:51:43.651Z","additional_data":{"old_severity":"Critical (9.3)","new_severity":"None (0.0)","old_severity_id":587235,"new_severity_id":587243},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6530511,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Thank you for your report to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\n\n(Un)fortunately, we can't confirm your report as a real security threat, this response does not contain any sensitive data. Displaying information about cars close to user is an application's feature and should not require any special permissions.","automated_response":false,"created_at":"2019-12-12T09:54:57.653Z","updated_at":"2019-12-12T09:54:57.653Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6581587,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-18T17:58:40.214Z","updated_at":"2019-12-18T17:58:40.214Z","first_to_agree":true,"actor":{"username":"sergeybelove","cleared":false,"url":"/sergeybelove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/254/a481de670c50a6db66baea250057d8f3317aabd4_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6581719,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-18T18:12:36.970Z","updated_at":"2019-12-18T18:12:36.970Z","actor":{"username":"krupnikas","cleared":false,"url":"/krupnikas","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBODVvQ3c9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--f72317b57f7639e98ece5f91656c92b131eab794/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/6640248.jpeg"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6581720,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-18T18:12:37.025Z","updated_at":"2019-12-18T18:12:37.025Z","actor":{"username":"krupnikas","cleared":false,"url":"/krupnikas","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBODVvQ3c9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--f72317b57f7639e98ece5f91656c92b131eab794/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/6640248.jpeg"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}