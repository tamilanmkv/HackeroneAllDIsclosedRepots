{"id":757957,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTc5NTc=","url":"https://hackerone.com/reports/757957","title":"Restricted user can manage the NerdGraph entities' tags","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-12-13T16:49:19.502Z","submitted_at":"2019-12-13T16:49:19.502Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T15:30:07.839Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:40:19.338Z","team_member_agreed_on_going_public_at":"2020-08-13T15:30:07.675Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey team,\n\nI've found that the `Restricted` user can manage the `NerdGraph` entities' tags:\n- create new ones;\n- edit and/or remove current ones.\n\nIt seems that the tags are supposed to be used internally by account administration and unauthorized removing of them can cause some issues. Thus, this report seems to be a valid security issue though I cannot find this option at all in the Capabilities matrice.\n\n##Steps to reproduce\n1) Sign in NR using Restricted account\n2) Navigate to https://api.newrelic.com/graphiql?#query=query%20%28%24query%3A%20String%21%29%20%7B%0A%20%20actor%20%7B%0A%20%20%20%20entitySearch%28query%3A%20%24query%29%20%7B%0A%20%20%20%20%20%20count%0A%20%20%20%20%20%20results%20%7B%0A%20%20%20%20%20%20%20%20entities%20%7B%0A%20%20%20%20%20%20%20%20%20%20name%0A%20%20%20%20%20%20%20%20%20%20entityType%0A%20%20%20%20%20%20%20%20%20%20guid%0A%20%20%20%20%20%20%20%20%20%20tags%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20values%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A\u0026variables=%7B%20%22query%22%3A%20%22type%20%21%3D%201%22%20%7D\n3) Choose an API key from the list at the top of the page, or create a new one there\n4) Press \"Play\" and make sure there are some entities displayed. Copy the `guid` of one of them.\n5) Navigate to https://api.newrelic.com/graphiql?#query=mutation%20%7B%0A%20%20taggingAddTagsToEntity%28guid%3A%20%22MjM4NTkxNHxNT0JJTEV8QVBQTElDQVRJT058MjE4NDA2NDA3%22%2C%20tags%3A%20%5B%7Bkey%3A%20%22malicious_key%22%2C%20values%3A%20%5B%22malicious_value%22%5D%7D%5D%29%20%7B%0A%20%20%20%20errors%20%7B%0A%20%20%20%20%20%20message%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A\n6) Replace the `guid` in the GraphQL I prepended for you to the one you copied at the step 4\n7) Run the request\n8) Execute the query from step 2 again after few minutes and make sure the malicious tag was added to the selected entity.\n\nThe same way, Restricted user can remove the tags or replace their values through:\n- `taggingDeleteTagFromEntity`;\n- `taggingDeleteTagValuesFromEntity`;\n- `taggingReplaceTagsOnEntity`.\n\nI don't know whether these mutations access control implementations are different or not, but, due to their similarity, I decided to submit all of them at this single report. If you discover that the issues are different I can submit them separately, or you can just reward me with some bonus :)\n\n## Impact\n\nRestricted user can manage the NerdGraph entities' tags","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-09-10T09:40:19.373Z","allow_singular_disclosure_after":-34235012.98019268,"singular_disclosure_allowed":true,"vote_count":3,"voters":["wi11","ali","cryptographer"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":4405,"asset_type":"URL","asset_identifier":"*.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6544000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans, thanks for the report. I'm asking the team about this now. As a heads up today is a short day for the company so I may not be able to triage this until Monday.","automated_response":false,"created_at":"2019-12-13T19:06:15.926Z","updated_at":"2019-12-13T19:06:15.926Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6561138,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I confirmed with the team that this is an access control issue, nice catch @skavans !","automated_response":false,"created_at":"2019-12-16T17:19:13.660Z","updated_at":"2019-12-16T17:19:13.660Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6561160,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"{F661201}","automated_response":false,"created_at":"2019-12-16T17:25:18.477Z","updated_at":"2019-12-16T17:25:18.477Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","attachments":[{"id":661201,"filename":"130h6m.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qWBDHD6wcnqosnwA53vb591B?response-content-disposition=attachment%3B%20filename%3D%22130h6m.jpg%22%3B%20filename%2A%3DUTF-8%27%27130h6m.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152352Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4212a73e5d2d817429830e555b32c0770c7904341dfd026666bb1e6f1ec2f00b"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6854880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The dev team believes this is fixed, would you mind trying to re-exploit this to confirm?","automated_response":false,"created_at":"2020-01-23T22:30:36.889Z","updated_at":"2020-01-23T22:30:36.889Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6856054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems to be correctly fixed :)","automated_response":false,"created_at":"2020-01-24T05:16:38.111Z","updated_at":"2020-01-24T05:16:38.111Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6863710,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks!","automated_response":false,"created_at":"2020-01-24T17:13:15.260Z","updated_at":"2020-01-24T17:13:15.260Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8902634,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-11T09:40:19.357Z","updated_at":"2020-08-11T09:40:19.357Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2020-08-13T08:30:52.198Z","updated_at":"2020-08-13T08:30:52.198Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8927866,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T15:30:07.726Z","updated_at":"2020-08-13T15:30:07.726Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8927867,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T15:30:07.906Z","updated_at":"2020-08-13T15:30:07.906Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}