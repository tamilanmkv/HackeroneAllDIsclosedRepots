{"id":762271,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjIyNzE=","url":"https://hackerone.com/reports/762271","title":"Guest users can change the confidentiality attribute on those issues that have been assigned to them","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-12-20T11:29:58.372Z","submitted_at":"2019-12-20T11:29:58.372Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xwintermute","url":"/0xwintermute","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-09T09:44:50.775Z","bug_reporter_agreed_on_going_public_at":"2020-11-09T09:44:50.680Z","team_member_agreed_on_going_public_at":"2020-11-02T15:29:17.290Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nA user with no association to a project nor group can use a mutation GraphQL query to change the confidentiality on those issues where they have been previously assigned. This functionality is restricted to those users which have been granted access to a project and hold at least the `Reporter` role, or those users that have created the issue.\n\n\n\n### Steps to reproduce\n\nA user creates an issue on a program and assigns by mistake the issue to our attacker account. The attacker will receive a notification, as he has been assigned to a new issue on a particular program.\n\nThe attacker could then craft a GraphQL mutation on the `issueSetConfidential` object and change the `confidentiality` attribute from `false` to `true`. This will have an immediate effect on the issue, hiding it from the rest of users holding the `Guest` role.\n\n### Impact\n\nAs detailed above, an attacker with no role or permissions on a group that has created a project could hide issues from other users.\n\n\n\nI'm completely aware of the likelihood of this scenario from happening, however I've not been able to exercise this functionality from the web interface nor the API. Hence why I believe this behavior is not intended and should not happen. Specially if the user performing this attack does not belong to the group that has created the project.\n\n\n\n### Example\n\nFor this scenario lets gonna use two different accounts:\n\n* `victim@gitlab.com`\n* `attacker@gitlab.com`\n\nAs `victim@gitlab.com` lets create a new issue on a public project where we participate:\n\n{F664563}\n\nAs the `attacker@gitlab.com`, if we attempt to access the issue, we will be presented with only the ability to write new comments:\n\n{F664561}\n\nIf attacker attempts to perform the mutation GraphQL query mentioned above, the following response will be returned:\n\n**GraphQL Query**\n\n```\nmutation {\n  issueSetConfidential(input:{projectPath:\"groupID/projectID\", iid:\"5\", confidential:true}){\n    errors\n  }\n}\n```\n\n\n\n**GraphQL Response**\n\n```\n{\n  \"data\": {\n    \"issueSetConfidential\": null\n  },\n  \"errors\": [\n    {\n      \"message\": \"The resource that you are attempting to access does not exist or you don't have permission to perform this action\",\n      \"locations\": [\n        {\n          \"line\": 2,\n          \"column\": 3\n        }\n      ],\n      \"path\": [\n        \"issueSetConfidential\"\n      ]\n    }\n  ]\n}\n```\n\n\n\nWe will get back later to this, for now lets focus again on our `victim@gitlab.com`. As we have decided to assign the recently created issue to a new user, which in this case will be our `attacker@gitlab.com` (Either by mistake or on purpose):\n\n*Note* : In this case I'm going to use the quick action `/assign @username` as I cannot assign external users that do not belong to a project using the web interface (I'm not sure if this is kind of expected, but thought would be worth to be brought to your attention)\n\n\n\n{F664559}\n\n\n\nRight after doing this, the `attacker@gitlab.com` will receive a new notification on the UI, as shown below:\n\n{F664560}\n\nAfter visiting the new issue as the `attacker@gitlab.com` we can observe two things:\n\n* There is no user assigned to the issue\n* There is no option to change the `confidentiality` attribute through the web interface.\n\n{F664561}\n\nHowever, if we repeat the same GraphQL mutation query mentioned above, we will receive a different response this time:\n\n\n**GraphQL Request**\n\n```\nmutation {\n  issueSetConfidential(input:{projectPath:\"groupID/projectID\", iid:\"5\", confidential:true}){\n    errors\n  }\n}\n```\n\n**GraphQL Response**\n\n```\n{\n  \"data\": {\n    \"issueSetConfidential\": {\n      \"errors\": []\n    }\n  }\n}\n```\n\nIf we check the issue activity, we will observe the following message:\n\n{F664562}\n\nOur `attacker@gitlab.com` has been able to successfully change the `confidential` attribute for a finding, when this functionality was not being offered in first place through the web interface.\n\nAdditionally, if we open a new anonymous session and navigate to the issues page for this project, we will see that the issue is \"gone\".\n\n{F664558}\n\n\n### What's the current bug behaviour?\n\nChanging `confidentiality` attributes on findings through a mutation GraphQL query should not be possible if such functionality is not offered neither through the web interface, nor the GitLab API.\n\nThis may allow an attacker without any special role nor privileges to arbitrarily change the confidentiality of those issues for which he/she has been assigned to. Revoking visibiility to uses with `Guest` or no role at all.\n\n\n\n### What's the expected correct behaviour?\n\nI would expect this action to not be possible from being executed as such functionality/behaviour is not present within the GitLab web interface nor GitLab API.\n\nAs a user with no privileges nor member of a group where the affected project belongs to, I would expect two things:\n\n- Not being able to get any issues assigned as I'm not involve nor belongs to the project's group.\n- Not being able to arbitrarily set the confidentiality attribute of an issue for which I've been assigned to, specially if I don't have enough permissions for such action.\n\n## Impact\n\nPlease see the description provided above","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":664558,"file_name":"Issue_-_Anonymous_Window.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/aVFgAay1Y7UL6YgxB74kLmLL?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Anonymous_Window.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Anonymous_Window.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8b52867a2cfe57539c1e66ff88e208e3510fca6ad2b423650e91e436661398ba","file_size":129898,"type":"image/png"},{"id":664559,"file_name":"Issue_-_Attacker_Assigned.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qqaZkTXdaCyW6Ag5QRAaniBr?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Attacker_Assigned.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Attacker_Assigned.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a8ec9a98623890b1d27c8de98a73d201f90fe1d2d1050d71aac7c91ab3ecf4d4","file_size":279298,"type":"image/png"},{"id":664560,"file_name":"Issue_-_Attacker_Notification.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oLejUPuNbzkTV4tjJkMSvuT3?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Attacker_Notification.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Attacker_Notification.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ec9e33de7e8e9b082cf6eac4cecba388a3678ec74721aa80710ac113f8582c28","file_size":147260,"type":"image/png"},{"id":664561,"file_name":"Issue_-_Attacker_perspective.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/NUxtNckRs2KtksFbG91wuPMb?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Attacker_perspective.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Attacker_perspective.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4c0cc9d30d93d49b071a4221e6ed95b0fab2904c8f9c9cef4184f42aa8b7f32a","file_size":217319,"type":"image/png"},{"id":664562,"file_name":"Issue_-_Changed_by_attacker.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GLUpG5ZzFDvvVdVuoAsEZp8p?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Changed_by_attacker.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Changed_by_attacker.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=004cd1beaee083f89db286e22aed187455d6699b4b09980b5b6013b8ccf8decc","file_size":226511,"type":"image/png"},{"id":664563,"file_name":"Issue_-_Created.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AVDqN1JdFYAhGksdsB8DMxac?response-content-disposition=attachment%3B%20filename%3D%22Issue_-_Created.png%22%3B%20filename%2A%3DUTF-8%27%27Issue_-_Created.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=160073828e28a55b0b6f5ad7311eb11aeb3d6b4970351abcbf77d769bc2c2306","file_size":269005,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["rjenningsuk","ali","mainteemoforfun","sakshamguruji","0xwintermute","jbono","clars","jedau","booghi","bl4ckmamba"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6596235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, apparently my report was again flagged by the Human Augmented Signal algorithm. Could someone else please check this out? Thanks","automated_response":false,"created_at":"2019-12-20T11:31:49.290Z","updated_at":"2019-12-20T11:31:49.290Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6598223,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xwintermute,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 14 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-12-20T16:05:56.428Z","updated_at":"2019-12-20T16:05:56.428Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6671608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Happy new year!\n\nI guess you are currently hammered with hundreds of reports, just wanted to double check if this one may have become sloppy\n\nBest regards!","automated_response":false,"created_at":"2020-01-02T09:13:17.663Z","updated_at":"2020-01-02T09:13:17.663Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6684391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @0xwintermute and happy new year!\n\nThank you for submitting this report and for your patience during the holidays.\n\nIt is an intended feature to be able to assign users that aren't members of the group and/or project and that feature is used in the open source development of GitLab. The fact that `attacker` doesn't show up in the assignment dropdown is a known issue and using `/assign` is the workaround.\n\nI have reproduced the issue where the assigned user can change confidentiality. However, I wonder if this should be secured in the GraphQL API or rather if this feature should be enabled in the UI/REST API for users that are assigned to an issue. I will reach out to the engineering team and update you when I hear back from them.\n\nBest regards,\nDominic\nSecurity Team | GitLab","automated_response":false,"created_at":"2020-01-03T22:34:08.876Z","updated_at":"2020-01-03T22:34:08.876Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6684671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dcouture,\n\nThat was my feeling regarding issues being assigned to members that are not necessarily part of a group and/or project. It wasn't my intention to flag this as a vulnerability, sorry if the details provided sounded like this.\n\nI honestly believe a user should not be able to execute this GraphQL mutation if he/she is not the issue's owner. Ultimately, the issue's owner should be who decides whether an issue goes confidential or not. For example, assignees cannot lock an issue, at least based on the current UI/REST API and the GraphQL mutations, why would they be able to arbitrarily set an issue confidential or not?\n\nI'm more than happy to explore attack paths here, please do let me know once you hear back from engineering :)\n\nThanks,\n\nBest\n\n\n","automated_response":false,"created_at":"2020-01-03T23:48:55.105Z","updated_at":"2020-01-03T23:48:55.105Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6700033,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @0xwintermute,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/issues/195327.  This issue will be made public 30 days following the release of a patch.\n\nGiven that the attacker can only change issues that were assigned to them and that the maintainer can easily mitigate this the severity was changed to `Low`. If you find another attack scenario with more impact let us know and we'll be happy to reconsider the severity.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nDominic\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2020-01-06T16:23:17.405Z","updated_at":"2020-01-06T16:23:17.405Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6700390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dcouture thanks!\n\nLet me think on different attack vectors and if I get something that could increase the impact on this, i will let you know immediately on this ticket, but I doubt so as I've already attempted it and couldn't find a better vector.\n\nBest!","automated_response":false,"created_at":"2020-01-06T17:01:25.438Z","updated_at":"2020-01-06T17:01:25.438Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6824494,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dcouture hey there, is there any estimation on when this security issue will be fixed?","automated_response":false,"created_at":"2020-01-21T09:59:40.205Z","updated_at":"2020-01-21T09:59:40.205Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6826979,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xwintermute,\n\nThe fix hasn't been planned yet, we'll update you when we we have more information. We pay bounties on resolution, but if the fix hasn't been deployed after 90 days we'll award the bounty regardless.\n\nThanks for your patience,\nDominic\nSecurity Team | GitLab","automated_response":false,"created_at":"2020-01-21T14:45:18.852Z","updated_at":"2020-01-21T14:45:18.852Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7369918,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @0xwintermute,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nWe will continue to keep you updated via HackerOne as a fix is scheduled.\n\nBest regards,\nDominic\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2020-03-19T14:55:43.276Z","updated_at":"2020-03-19T14:55:43.276Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"0xwintermute","url":"/0xwintermute"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7372347,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dcouture , \n\nThank you a lot for the bounty reward, please keep me in the loop once this issue is fixed, so I can give it another try.\n\nThanks!","automated_response":false,"created_at":"2020-03-19T20:19:10.871Z","updated_at":"2020-03-19T20:19:10.871Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8555912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @0xwintermute,\n\nThe issue you reported is currently scheduled to be fixed by 2020-08-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-07-10T04:21:06.792Z","updated_at":"2020-07-10T04:21:06.792Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8995966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @0xwintermute,\n\nThe issue you reported is currently scheduled to be fixed by 2020-09-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-08-21T04:21:27.979Z","updated_at":"2020-08-21T04:21:27.979Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9419847,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @0xwintermute,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.4.2. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nDominic\nGitLab Security Team","automated_response":false,"created_at":"2020-10-05T12:07:44.636Z","updated_at":"2020-10-05T12:07:44.636Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"0xwintermute","url":"/0xwintermute"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9703718,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-02T15:29:05.680Z","updated_at":"2020-11-02T15:29:05.680Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":593614,"new_severity_id":894836},"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9703728,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-02T15:29:17.310Z","updated_at":"2020-11-02T15:29:17.310Z","first_to_agree":true,"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9765181,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure thing!","automated_response":false,"created_at":"2020-11-09T09:44:50.710Z","updated_at":"2020-11-09T09:44:50.710Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9765182,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-09T09:44:50.809Z","updated_at":"2020-11-09T09:44:50.809Z","actor":{"username":"0xwintermute","cleared":false,"url":"/0xwintermute","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aT73s19aFe8KiEZYzRgmND7z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}