{"id":767829,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Njc4Mjk=","url":"https://hackerone.com/reports/767829","title":"Account take over of 'light' starbuckscardb2b users","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-01-03T19:32:55.361Z","submitted_at":"2020-01-03T19:32:55.361Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zude","url":"/zude","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-29T17:38:31.113Z","bug_reporter_agreed_on_going_public_at":"2020-01-19T04:42:39.310Z","team_member_agreed_on_going_public_at":"2020-01-29T17:38:31.037Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This issue was found on https://www.starbuckscardb2b.com, this website belongs to starbucks and its is a critical vulnerability so I am reporting this.\n\n```Issue:``` An attacker can takeover the account of the victim by creating a new account by using victim's (who is already registered) email address. \n\nSteps to reproduce are as follows:\n1. Open https://www.starbuckscardb2b.com and go to create account.\n2. for example user successfully created the account with ```abc@xyz.com``` and password ```12345678```\n3. Now attacker will create the account with the email used in step 2  ```abc@xyz.com``` with different password.\n4. After completion of step 3 the password for the  ```abc@xyz.com``` user will be set to the password used by attacker.\n5. This will result in the account take over by attacker.\n\n## Impact\n\nAn attacker can take over the control of any/all registered users.","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-18T04:42:39.348Z","allow_singular_disclosure_after":-51964950.92441123,"singular_disclosure_allowed":true,"vote_count":23,"voters":["msultan","sudi","elmahdi","streghdev","detroitsmash","mr_n30","exception","zimmer75","okido1","zude","and 13 more..."],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":12995,"asset_type":"OTHER","asset_identifier":"Other assets","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6684710,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-04T00:08:46.346Z","updated_at":"2020-01-04T00:08:46.346Z","additional_data":{"old_severity":"Critical","new_severity":"Critical (9.8)","old_severity_id":599997,"new_severity_id":600083},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6684712,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2020-01-04T00:08:56.522Z","updated_at":"2020-01-04T00:08:56.522Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6684721,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi there, @zude - as you've probably noticed, this is outside of our scope for a monetary reward, but we accept the vulnerability exists on one of our services, and that it looks like you can change a user's password by simply going through the Create Account functionality. Thank you very much for reporting this to us - I will ensure that it is addressed by the team responsible for this component.","automated_response":false,"created_at":"2020-01-04T00:13:56.376Z","updated_at":"2020-01-04T00:13:56.376Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6733093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tealeaf any update on this?","automated_response":false,"created_at":"2020-01-10T08:07:28.036Z","updated_at":"2020-01-10T08:07:28.036Z","actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6761452,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-13T23:55:41.553Z","updated_at":"2020-01-13T23:55:41.553Z","additional_data":{"old_severity":"Critical (9.8)","new_severity":"High (7.5)","old_severity_id":600083,"new_severity_id":607200},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6761457,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there, @zude - updated information we have as of now is:\n* The development team is aware of this issue, and is working on possible fixes\n* The account takeover potential of this vulnerability is limited to \"light\" accounts - those that have not yet registered a credit card or ordered any rewards cards. Since the main point of the web site is to facilitate the ordering of rewards cards, any damage is limited to these few light accounts, only a few of which have address or phone number data.\n* Several of these accounts appear to be from people pen-testing the system, either through specific pen-tests, or the HackerOne program.\nI'm downgrading this to a High because of the small number of affected accounts, and the limited nature of their capabilities. The CVSS scoring doesn't seem to apply as \"High\" loss of Confidentiality or Integrity.","automated_response":false,"created_at":"2020-01-13T23:56:44.615Z","updated_at":"2020-01-13T23:56:44.615Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6796036,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi again, @zude - the development team has addressed this issue by removing the ability to create \"light\" accounts entirely, which will prevent the ability to take over these accounts. Please feel free to retest this and make sure we haven't missed an ability to exercise this flaw. I'm closing this issue as resolved, but you should please reopen it if you find the fix is incomplete.\nWe look forward to receiving further issues from you as and when you find them in Starbucks web sites and applications.","automated_response":false,"created_at":"2020-01-17T02:10:31.403Z","updated_at":"2020-01-17T02:10:31.403Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zude","url":"/zude"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6809140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tealeaf this issue can be marked as fixed. ","automated_response":false,"created_at":"2020-01-19T04:42:35.592Z","updated_at":"2020-01-19T04:42:35.592Z","actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6809141,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-19T04:42:39.326Z","updated_at":"2020-01-19T04:42:39.326Z","first_to_agree":true,"actor":{"username":"zude","cleared":false,"url":"/zude","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7mzJKzujGv6fiBh5k7qgN9cU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6811422,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-01-19T17:35:22.082Z","updated_at":"2020-01-19T17:35:22.082Z","additional_data":{"old_title":"Account take over of any user","new_title":"Account take over of any starbuckscardb2b user"},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6811423,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-01-19T17:35:39.209Z","updated_at":"2020-01-19T17:35:39.209Z","additional_data":{"old_title":"Account take over of any starbuckscardb2b user","new_title":"Account take over of 'light' starbuckscardb2b users"},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6901115,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-29T17:38:31.054Z","updated_at":"2020-01-29T17:38:31.054Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6901116,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-29T17:38:31.129Z","updated_at":"2020-01-29T17:38:31.129Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":19986,"category":"team","content":"zude discovered that 'light' accounts on https://www.starbuckscardb2b.com could be taken over by registering a new account with the same email address. 'Light' accounts were defined as those that had been created but not used to add a payment method or complete a checkout.\n\n@zude — thank you for reporting this vulnerability and confirming the resolution.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":706273,"username":"agedsumatra","name":"agedSumatra","bio":"","cleared":false,"website":null,"location":"","created_at":"2019-08-12T17:50:49.926Z","url":"https://hackerone.com/agedsumatra","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}