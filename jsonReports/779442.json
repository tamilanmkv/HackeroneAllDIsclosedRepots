{"id":779442,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Nzk0NDI=","url":"https://hackerone.com/reports/779442","title":"Subdomain takeover of storybook.lystit.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-01-21T16:51:00.002Z","submitted_at":"2020-01-21T16:51:00.002Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"parzel","url":"/parzel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16334,"url":"https://hackerone.com/lyst","handle":"lyst","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Lyst","twitter_handle":"makinglyst","website":"https://www.lyst.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-22T14:38:48.812Z","bug_reporter_agreed_on_going_public_at":"2020-01-22T14:35:17.834Z","team_member_agreed_on_going_public_at":"2020-01-22T14:38:48.687Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary:\nThe subdomain storybook.lystit.com had an CNAME record pointing to an unclaimed S3 bucket. This is a high severity security issue because an attacker can register the bucket on AWS and therefore can serve her own content on the subdomain. This allows for various attacks.\n\n# Description:\nThe dangling CNAME record of storybook.lystit.com is pointing to ███████ and the bucket which could not be found was: \"storybook.lystit.com\". I was able to register a S3 bucket with this name in AWS. After enabling static website hosting I was able to takeover the subdomain and serve arbitrary content. I am serving a POC to proof I am controlling the subdomain as well as a simple XSS POC.\n\n# POC\nPOC: view-source:http://storybook.lystit.com/\nStored XSS: http://storybook.lystit.com/asdjklkas1312das879123.html\n{F691531}\n{F691530}\n\n# Supporting Material/References:\nhttps://www.hackerone.com/blog/Guide-Subdomain-Takeovers\n\n# Recommendations for fix\nRemove the dangling CNAME record from storybook.lystit.com\n\n## Impact\n\nThe domain takeover allows various attacks. As the full domain is attacker controlled it can be used to serve XSS attacks, phishing campaigns and might be used to bypass the Same Origin Policy on other lystit.com domains and services.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":691530,"file_name":"Screenshot_from_2020-01-21_17-48-41.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ujm2R7u3eWuFXjweCEx6iTPm?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-01-21_17-48-41.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-01-21_17-48-41.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152635Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9e7e791f87db0c83e85416c2e88e9e91e37181d3473f74f2797a93cdaa250f7e","file_size":34023,"type":"image/png"},{"id":691531,"file_name":"Screenshot_from_2020-01-21_17-48-19.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/R8qSWEsmCsYWrjJoZR5UrE8P?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-01-21_17-48-19.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-01-21_17-48-19.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152635Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=14eb755db86a260a541a8e4216f52caef78fbe7360c622b06c3deff248307cf6","file_size":13658,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":155,"voters":["sebd","daehee","themastersunil","hackerontwowheels","sourc7","a_d_a_m","securitychops","sklnhunt","kickino","sameerphad72","and 145 more..."],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":32967,"asset_type":"URL","asset_identifier":"*.lyst.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6830478,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-21T18:15:09.812Z","updated_at":"2020-01-21T18:15:09.812Z","additional_data":{"old_severity":"High","new_severity":"High (7.3)","old_severity_id":613558,"new_severity_id":613688},"actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6830480,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @parzel,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@nasr0x01","automated_response":false,"created_at":"2020-01-21T18:15:12.143Z","updated_at":"2020-01-21T18:15:12.143Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6840040,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-01-22T13:35:44.448Z","updated_at":"2020-01-22T13:35:44.448Z","actor":{"url":"/lyst","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/334/0915cf74d60a19ff359a42f4dfa3f9878957e589_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Lyst"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"lyst","collaborator":{"username":"parzel","url":"/parzel"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6840047,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @parzel, thanks so much for the report! We've removed this domain name now, are you able to confirm that this resolves the issue?","automated_response":false,"created_at":"2020-01-22T13:36:26.097Z","updated_at":"2020-01-22T13:36:26.097Z","actor":{"username":"lystmatt","cleared":false,"url":"/lystmatt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6840411,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lystmatt, thank you so much for the super quick reward! I really appreciate it. I can confirm the issue is resolved and the dangling record is properly removed.","automated_response":false,"created_at":"2020-01-22T14:29:30.341Z","updated_at":"2020-01-22T14:29:30.341Z","actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6840437,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"No problem @parzel, thanks once again for your work!","automated_response":false,"created_at":"2020-01-22T14:32:03.497Z","updated_at":"2020-01-22T14:32:03.497Z","actor":{"username":"lystmatt","cleared":false,"url":"/lystmatt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"parzel","url":"/parzel"},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6840460,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You are welcome! I deleted the bucket now in case you want to reclaim it. Would you mind disclosing this report? ","automated_response":false,"created_at":"2020-01-22T14:35:17.852Z","updated_at":"2020-01-22T14:35:17.852Z","first_to_agree":true,"actor":{"username":"parzel","cleared":false,"url":"/parzel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/kAVxjQwjsERoJp9eMTQEwZD1/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6840495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-22T14:38:48.710Z","updated_at":"2020-01-22T14:38:48.710Z","actor":{"username":"lystmatt","cleared":false,"url":"/lystmatt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6840496,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-22T14:38:48.838Z","updated_at":"2020-01-22T14:38:48.838Z","actor":{"username":"lystmatt","cleared":false,"url":"/lystmatt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lyst","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}