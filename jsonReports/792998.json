{"id":792998,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTI5OTg=","url":"https://hackerone.com/reports/792998","title":"404-response contains debug-information with all headers","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-02-11T08:34:34.732Z","submitted_at":"2020-02-11T08:34:34.732Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"p4fg","url":"/p4fg","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/379/295/7023423bdb8cb71d1537e9e1a26263fd387f97a0_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-16T07:56:41.796Z","bug_reporter_agreed_on_going_public_at":"2020-05-16T07:56:41.752Z","team_member_agreed_on_going_public_at":"2020-05-15T18:22:45.261Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\n\nWhen requesting a page that does not exist under `www.hackerone.com` the page returns a hidden HTML-element `#debugData` that reflects all headers in the GET-request, including http-only cookies.\n\n**Description:**\n\nThis in itself is not a serious vulnerablity, but as the program description mentions, the site runs drupal and probably have an administrative interface somewhere. If (when) an XSS is found on the domain, this page can be used to fetch all cookies for an administrator and take over their session on the site.\n\nThe response does not have `X-Frame-Options` or CSP so it can be read over a iframe on the same domain.\n\n### Steps To Reproduce\n\n1. Visit `https://www.hackerone.com/resources/read/ajax_issueWidgets_p4fg` using a browser\n2. View source of the recieved data\n\n\n### Supporting Material\n\nSent GET-request (with added headers and cookies to prove the point):\n\n```\nGET /resources/read/ajax_issueWidgets_p4fg HTTP/1.1\nHost: www.hackerone.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 Safari/605.1.15\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: ███ super_secret_made_up_cookie=VERY_VERY_SECRET\nUpgrade-Insecure-Requests: 1\nX-HackerOne-Research: p4fg\nX-Other-Custom-Header: WILL_BE_REFLECTED\n```\n\n\nThe response (cut to show relevant portions):\n\n```\nHTTP/1.1 404 Not Found\nDate: Tue, 11 Feb 2020 08:29:55 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: close\nP3p: CP=\"NOI ADM DEV PSAi COM NAV OUR OTRo STP IND DEM\"\nReferrer-Policy: unsafe-url\nX-Content-Type-Options: nosniff\nX-Xss-Protection: 1; mode=block\nCF-Cache-Status: DYNAMIC\nExpect-CT: max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\nStrict-Transport-Security: max-age=31536000; includeSubDomains; preload\nServer: cloudflare\nCF-RAY: 5634f5362977d147-GOT\nContent-Length: 6334\n\n\u003c!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"\u003e\n\u003chtml xmlns=\"http://www.w3.org/1999/xhtml\"\u003e\n    \u003chead\u003e\n    \t\u003ctitle\u003ePage Not Found (404)\u003c/title\u003e\n        \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e        \u003clink href=\"https://fonts.googleapis.com/css?family=Lato:300|Montserrat:300,400\" rel=\"stylesheet\" type=\"text/css\"\u003e\n    \t\u003cstyle\u003e\n\t\t\tbody, html {margin:0;background:#252525;}\n            body{padding:7% 20%;font-family: \"Montserrat\",sans-serif;}\n\t\t\th1{color:#4b4b4b;font-size:55px;margin:0 0 8px;font-weight:400;}\n            div{border-top:1px solid #4b4b4b;width: 40px;height:1px;margin:0 0 45px -20px;}\n            h2{color:#fff;font-size:22px;margin-bottom:12px;font-weight:300;}\n            p{color:#ddd;font-size:18px;margin-bottom:60px; font-family: \"Lato\",sans-serif;font-weight:300}\n\t\t\u003c/style\u003e\n    \u003c/head\u003e          \n    \u003cbody\u003e\n\t\t\u003ch1\u003e404\u003c/h1\u003e\n        \u003cdiv\u003e\u003c/div\u003e\n        \u003ch2\u003eHey, we can't find what you're looking for...\u003c/h2\u003e\n        \u003cp\u003eThe requested URL doesn't exist.\u003c/p\u003e\n        \u003cpre id=\"debugData\" style=\"display: none;\"\u003e\n            {\n    \u0026quot;headers\u0026quot;: {\n        \u0026quot;Host\u0026quot;: \u0026quot;www.hackerone.com\u0026quot;,\n        \u0026quot;User-Agent\u0026quot;: \u0026quot;Mozilla\\/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit\\/605.1.15 (KHTML, like Gecko) Version\\/12.1.1 Safari\\/605.1.15\u0026quot;,\n        \u0026quot;Accept\u0026quot;: \u0026quot;text\\/html,application\\/xhtml+xml,application\\/xml;q=0.9,image\\/webp,*\\/*;q=0.8\u0026quot;,\n        \u0026quot;Accept-Encoding\u0026quot;: \u0026quot;gzip\u0026quot;,\n        \u0026quot;Accept-Language\u0026quot;: \u0026quot;en-US,en;q=0.5\u0026quot;,\n        \u0026quot;Cdn-Loop\u0026quot;: \u0026quot;cloudflare\u0026quot;,\n        \u0026quot;Cf-Connecting-Ip\u0026quot;: \u0026quot;109.228.159.19\u0026quot;,\n        \u0026quot;Cf-Ipcountry\u0026quot;: \u0026quot;SE\u0026quot;,\n        \u0026quot;Cf-Ray\u0026quot;: \u0026quot;5634f5362977d147-BOS\u0026quot;,\n        \u0026quot;Cf-Visitor\u0026quot;: \u0026quot;{\\\u0026quot;scheme\\\u0026quot;:\\\u0026quot;https\\\u0026quot;}\u0026quot;,\n        \u0026quot;Cookie\u0026quot;: \u0026quot;███ super_secret_made_up_cookie=VERY_VERY_SECRET\u0026quot;,\n        \u0026quot;Upgrade-Insecure-Requests\u0026quot;: \u0026quot;1\u0026quot;,\n        \u0026quot;X-Forwarded-For\u0026quot;: \u0026quot;109.228.159.19, 172.68.54.33\u0026quot;,\n        \u0026quot;X-Forwarded-Host\u0026quot;: \u0026quot;www.hackerone.com\u0026quot;,\n        \u0026quot;X-Forwarded-Port\u0026quot;: \u0026quot;443\u0026quot;,\n        \u0026quot;X-Forwarded-Proto\u0026quot;: \u0026quot;https\u0026quot;,\n        \u0026quot;X-Hackerone-Research\u0026quot;: \u0026quot;p4fg\u0026quot;,\n        \u0026quot;X-Other-Custom-Header\u0026quot;: \u0026quot;WILL_BE_REFLECTED\u0026quot;,\n        \u0026quot;X-Real-Ip\u0026quot;: \u0026quot;172.68.54.33\u0026quot;\n    },\n    \u0026quot;requestMethod\u0026quot;: \u0026quot;GET\u0026quot;,\n    \u0026quot;requestedUrl\u0026quot;: \u0026quot;\\/resources\\/read\\/ajax_issueWidgets_p4fg\u0026quot;,\n    \u0026quot;host\u0026quot;: \u0026quot;www.hackerone.com\u0026quot;,\n    \u0026quot;baseHubUrl\u0026quot;: \u0026quot;https:\\/\\/www.hackerone.com\\/resources\u0026quot;,\n    \u0026quot;currentPageRequest\u0026quot;: \u0026quot;https:\\/\\/www.hackerone.com\\/resources\\/read\\/ajax_issueWidgets_p4fg\u0026quot;,\n    \u0026quot;https\u0026quot;: true,\n    \u0026quot;timestamp\u0026quot;: \u0026quot;2020-02-11T03:29:55-05:00\u0026quot;\n}        \u003c/pre\u003e\n    \u003c/body\u003e\n\u003c/html\u003e\n\n```\n\n## Impact\n\nThis could be an essential part in escalating a future XSS to session takeover for the site.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":83,"name":"Information Exposure Through Debug Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-06-14T18:22:45.355Z","allow_singular_disclosure_after":-41807155.534281455,"singular_disclosure_allowed":true,"vote_count":163,"voters":["megaknight","n0x496n","testt0","base_64","alesandroortiz","mik317","ali","k1ra_","0xelkomy","hrithikbot","and 153 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":6,"asset_type":"URL","asset_identifier":"https://www.hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7016770,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @p4fg,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@lasagna ","automated_response":false,"created_at":"2020-02-11T09:24:52.927Z","updated_at":"2020-02-11T09:24:52.927Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7023484,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @p4fg - thanks for bringing this to our attention! These files are hosted by a vendor of ours. We'll reach out to them to coordinate a fix. Happy hacking!","automated_response":false,"created_at":"2020-02-11T17:50:31.365Z","updated_at":"2020-02-11T17:50:31.365Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7115376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @p4fg - thanks again for bringing this to our attention. The vendor hasn't gotten back to us with a timeline yet. We'll let you know when we hear back. Thanks for your patience!","automated_response":false,"created_at":"2020-02-21T19:08:25.949Z","updated_at":"2020-02-21T19:08:25.949Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7177940,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @p4fg - thanks again for bringing this to our attention! Although this is a vulnerability in a vendor of ours, it could've potentially impact HackerOne users. Because of that, we've decided to award you with a $500 bounty. Thanks again and we're looking forward to receive more vulnerabilities from you in the future. Good luck and happy hacking!","automated_response":false,"created_at":"2020-02-28T17:49:19.574Z","updated_at":"2020-02-28T17:49:19.574Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"p4fg","url":"/p4fg"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8014488,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @p4fg - thanks for your patience. The vendor got back to us earlier today to notify us that a fix was deployed. We internally confirmed that the cookies aren't being reflected anymore. Thanks again for bringing this to our attention!","automated_response":false,"created_at":"2020-05-15T18:20:57.753Z","updated_at":"2020-05-15T18:20:57.753Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"p4fg","url":"/p4fg"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8014493,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-05-15T18:21:11.866Z","updated_at":"2020-05-15T18:21:11.866Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":723058},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8014503,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-15T18:22:45.287Z","updated_at":"2020-05-15T18:22:45.287Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8019765,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-16T07:56:41.771Z","updated_at":"2020-05-16T07:56:41.771Z","actor":{"username":"p4fg","cleared":true,"url":"/p4fg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/295/7023423bdb8cb71d1537e9e1a26263fd387f97a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8019766,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-16T07:56:41.818Z","updated_at":"2020-05-16T07:56:41.818Z","actor":{"username":"p4fg","cleared":true,"url":"/p4fg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/295/7023423bdb8cb71d1537e9e1a26263fd387f97a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}