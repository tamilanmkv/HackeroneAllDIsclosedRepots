{"id":802930,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDI5MzA=","url":"https://hackerone.com/reports/802930","title":"CSRF on https://market.my.games","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-02-23T18:28:18.269Z","submitted_at":"2020-02-23T18:28:18.269Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"naategh","url":"/naategh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xxcg5T9sE1sDyfdoBemCjAuQ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-06T12:43:14.812Z","bug_reporter_agreed_on_going_public_at":"2020-03-24T09:40:44.035Z","team_member_agreed_on_going_public_at":"2020-04-06T12:43:14.748Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nHi team,\nWhile exploring https://market.my.games/ domain, I got this domain is vulnerable to CSRF. This site include an `X-CSRFToken` in headers but it seems the server doesn't validate it at all.\nMany endpoints require `application/json` as their `content-type` so we can't exploit this issue against them but I found `api/watchlist` endpoint doesn't require it so we can abuse this against this endpoint.\n\n## PoC\n- Save the following code as `ex.html` in your pc:   \n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://market.my.games/api/watchlist/37/\" method=\"POST\" enctype=\"text/plain\"\u003e\n      \u003cinput type=\"hidden\" name=\"null\" value=\"\" /\u003e\n      \u003cinput type=\"submit\" value=\"Go\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n- Go to https://account.my.games and login to your account\n- Open `ex.html` in your browser and click on `Go`\n- The game that assured to 37 will be added to your wishlist\n\n## Impact\n\nVulnerable endpoint it's not so sensitive, but an attacker can abuse this to add arbitrary games to users wishlist, so the impact of this is low, Also because it doesn't validate `X-CSRFToken` it's better to fix it.\nPlease note, I read your rules and I'm aware of \n\u003e Reports of missed protection mechanism / best current practice (e.g. no CSRF token, framing/clickjacking protection) without demonstration of real security impact for user or system\n\nBut this endpoint require authentication that's why I think this is a valid report and it's better to fix it.\nBest regards,\n@Naategh","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":726135,"file_name":"csrf.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PoUQE86aoe5wxrnxcphqi1HL?response-content-disposition=attachment%3B%20filename%3D%22csrf.gif%22%3B%20filename%2A%3DUTF-8%27%27csrf.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152948Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0c360e3c547cbe7fe9553fec3b117de0759f52d2bd323f409c1a4a59fd1c99fd","file_size":4885725,"type":"image/gif"}],"allow_singular_disclosure_at":"2020-04-23T09:40:44.084Z","allow_singular_disclosure_after":-46331344.34477711,"singular_disclosure_allowed":true,"vote_count":8,"voters":["k3ypt0","realtess","eye_","what_web","frogzzz","crius999","5p1d3rr","martinchoh10"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":40419,"asset_type":"OTHER","asset_identifier":"Ext. B Scope","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7142251,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report to Mail.Ru Group! We appreciate your time for helping us to make our web services safer.\n\nYour report have passed an initial review and was assigned to security engineer. Security engineer will contact you only if there are any questions on reproducing the bug or some additional information from you is required. He will manage the patching process. Once the bug is completely fixed, this report is transferred to \"Resolved\" state, it can take some time. Unfortunately,  your report is not eligible for monetary reward (check the [rules](https://hackerone.com/mailru)). We say \"thank you\" for your help and contribution.","automated_response":false,"created_at":"2020-02-25T08:40:26.428Z","updated_at":"2020-02-25T08:40:26.428Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7142253,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2020-02-25T08:40:33.543Z","updated_at":"2020-02-25T08:40:33.543Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7237965,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-03-05T22:18:33.212Z","updated_at":"2020-03-05T22:18:33.212Z","additional_data":{"duplicate_report_id":811617},"actor":{"username":"bohdansec","cleared":true,"url":"/bohdansec","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/huvtff3149eychjj1qlp363drji4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22avatar-pack.jpg%22%3B%20filename%2A%3DUTF-8%27%27avatar-pack.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152948Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=91387ae8559f1c19ca2402dcc476a75665bc5c7e5acfc4b66125d4acd9963815"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7402002,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2020-03-23T16:29:29.785Z","updated_at":"2020-03-23T16:29:29.785Z","actor":{"username":"danila-mailru","cleared":false,"url":"/danila-mailru","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BViUM1nbH32EqCVUS2MxHD5q/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"naategh","url":"/naategh"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7402640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\nI confirm that the issue has been fixed.","automated_response":false,"created_at":"2020-03-23T17:17:45.896Z","updated_at":"2020-03-23T17:17:45.896Z","actor":{"username":"naategh","cleared":false,"url":"/naategh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xxcg5T9sE1sDyfdoBemCjAuQ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7407996,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclosure this?","automated_response":false,"created_at":"2020-03-24T09:40:44.055Z","updated_at":"2020-03-24T09:40:44.055Z","first_to_agree":true,"actor":{"username":"naategh","cleared":false,"url":"/naategh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xxcg5T9sE1sDyfdoBemCjAuQ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7412993,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nwe will disclosure it within few weeks after request.","automated_response":false,"created_at":"2020-03-24T16:01:23.108Z","updated_at":"2020-03-24T16:01:23.108Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7557968,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-04-06T12:43:14.765Z","updated_at":"2020-04-06T12:43:14.765Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7557969,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-04-06T12:43:14.830Z","updated_at":"2020-04-06T12:43:14.830Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21124,"category":"team","content":"CSRF token was not properly validated in some APIs of market.my.games","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}