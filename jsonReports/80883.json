{"id":80883,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDg4Mw==","url":"https://hackerone.com/reports/80883","title":"Authentication errors in server side validaton of E-MAIL","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2015-08-06T12:00:40.577Z","submitted_at":"2015-08-06T12:00:40.577Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"faisalahmed","url":"/faisalahmed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-08-10T13:26:24.963Z","bug_reporter_agreed_on_going_public_at":"2015-08-10T13:26:24.822Z","team_member_agreed_on_going_public_at":"2015-08-10T13:00:35.223Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"To be honest, I'm not sure if there is any real security implications of this bug, but it's something which should be fixed at some point (since it'll be pretty easy).\r\nI'm going to describe the issue with reproducible steps:\r\n1. Navigate to Gratipay Settings Page. https://gratipay.com/~username/settings/\r\n2. Try adding an invalid e-mail address. ex: `myemail@gmail.com'`.\r\n3. You won't be able to, as it says \"please add an e-mail address. means you're only allowed to add a valid e-mail address.\r\n\r\nNow this can be bypassed by intercepting request. Let me show you how.\r\n* Add a valid email address in e-mail field. ex:mail01@gmail.com\r\n* Run any Request Repeater (ex: BURP Repeater, Live HTTP Header, Temper Data)\r\n* Click **Add E-Mail Address** and intercept the request.\r\n* Go to your repeater and you'll find there this form contents,\r\n\r\n\u003e POST https://gratipay.com/~lolzsec007/emails/modify.json\r\nPost Content:\r\n```\r\naction=add-email\u0026address=mymail%40gmail.com\r\n```\r\n\r\n* Change email address from `mymail%40gmail.com` to `mymail%40gmail.com\"\u003e\u003ch1\u003e`\r\n* Reply/Repeat your request.\r\n* The **Invalid** Email address will get saved.\r\n\r\nSo that means, there is no server side validation for adding e-mail addresses.\r\nNow in this point, i would like to talked about another issue that i noticed because of this process,\r\nI discovered there is simply character limit for email addresses, as there is no server side validation implemented, an attacker can add an email address with as much characters he wants.\r\nbut as per RFC, an email address that has more than **255** characters, shouldn't be allowed.\r\n\r\nPossible Fix:\r\n* Implementation of server side validation for email address should resolve both issues.\r\n\r\nLooking forward.\r\nThanks\r\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-09-09T13:00:35.403Z","allow_singular_disclosure_after":-192162606.37678826,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":539452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"screenshot","automated_response":false,"created_at":"2015-08-06T12:03:39.840Z","updated_at":"2015-08-06T12:03:39.840Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":48704,"filename":"gr.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/048/704/6f8fafe19c4749756242c5a03676dd7727725fa0/gr.png?response-content-disposition=attachment%3B%20filename%3D%22gr.png%22%3B%20filename%2A%3DUTF-8%27%27gr.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153041Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5d4de78d572c60a1b0ce1ef33f77c427bc51d524ff27557cbab7321acbbeff46"}],"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":539743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, faisalahmed! This is to confirm that we have received your report and are taking steps to validate your findings.\n\nThanks again,\n\nBen, Gratipay Security","automated_response":false,"created_at":"2015-08-06T16:47:56.967Z","updated_at":"2015-08-06T16:47:56.967Z","actor":{"username":"bhc","cleared":false,"url":"/bhc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/667/b469b5c20ad0e91bac9a4ce0d31bfd71a1c26b71_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":542347,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ftr, I hypothesize that this research is behind the alert we got from Mandrill:\n\n\u003e Your bounce rate for today is currently 13.58%, compared to your 90-day average bounce rate of 0.60%.\n\nhttps://gratipay.freshdesk.com/helpdesk/tickets/2782","automated_response":false,"created_at":"2015-08-10T00:41:29.314Z","updated_at":"2015-08-10T00:41:29.314Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":542352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess you're right! \nI tried a few times to be sure before reporting it. \nI'm sorry for the inconvenience caused because of my research. \n","automated_response":false,"created_at":"2015-08-10T01:03:31.054Z","updated_at":"2015-08-10T01:03:31.054Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":542353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries, @faisalahmed, just cross-linking for future reference. :-)","automated_response":false,"created_at":"2015-08-10T01:06:13.693Z","updated_at":"2015-08-10T01:06:13.693Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":542748,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"It looks like we made an intentional decision to only perform [light email validation on the server-side](https://github.com/gratipay/gratipay.com/blob/1874/www/~/%25username/emails/modify.json.spt#L20-L23). The reason for this decision is that [email address syntax](https://en.wikipedia.org/wiki/Email_address#Syntax) is so arcane that any validation algorithm we implement is bound to be imperfect. Rather than risking false positives or negatives we simply try sending an email, and let that be our test. Even with regard to length, a cursory investigation reveals conflicting information: you said 255 characters, Wikipedia says 254 characters, [one of their sources](https://tools.ietf.org/html/rfc3696#section-3) says 320. Better to just send the mail and wait for the bounce. :-)","automated_response":false,"created_at":"2015-08-10T12:13:44.181Z","updated_at":"2015-08-10T12:13:44.181Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":542830,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-08-10T13:00:35.255Z","updated_at":"2015-08-10T13:00:35.255Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":542846,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-08-10T13:26:24.847Z","updated_at":"2015-08-10T13:26:24.847Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":542847,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-08-10T13:26:24.987Z","updated_at":"2015-08-10T13:26:24.987Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340088,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-04T18:37:35.442Z","updated_at":"2016-12-04T18:37:35.442Z","additional_data":{"old_severity":null,"new_severity":"None","old_severity_id":null,"new_severity_id":11548},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}