{"id":817245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MTcyNDU=","url":"https://hackerone.com/reports/817245","title":"Hardware Wallets Do Not Check Unlock TIme","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-12T00:41:50.915Z","submitted_at":"2020-03-12T00:41:50.915Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thecharlatan","url":"/thecharlatan","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-09-12T08:36:40.539Z","bug_reporter_agreed_on_going_public_at":"2021-09-12T08:36:40.480Z","team_member_agreed_on_going_public_at":"2021-09-11T20:36:52.651Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nThe hardware wallet implementations using the monero wallet do not check the unlock time when signing. This allows malware on the user's computer (which the hardware wallet should protect from) to permanently lock-up all the user's funds if the user signs a transaction on the device with a very high unlock time.To provide a scenario for this kind of attack: A disgruntled employee can use this vector to permanently cripple a business' funds.\n\n## Releases Affected:\n\nAll releases since inclusion of hardware wallet support.\n\n## Steps To Reproduce:\n\nReproduction is easy, just create a new wallet with monero-wallet-cli with either Trezor or Ledger as a keystore. Then sign a transaction with locked_transfer and set a high unlock time.\n\n## Supporting Material/References:\n\nI disclosed this vulnerability on 02.02.2020 to both Trezor and Ledger. \nTrezor was able to quickly patch the vulnerability, since they already parsed the unlock time field. They will release this patch beginning of April. No patch for the monero wallet is required in their case.\nLedger has not patched the vulnerability yet. Unlike Trezor, they do not parse the unlock time field in the firmware currently, so their patch might require a change in the monero wallet. The possibility of requiring this patch is the reason why I am raising this report now, such that monero developers can prepare for its inclusion in a point release. I will stick to the 90 day disclosure timeline measured from 02.02.2020 . The Ledger developers have vouched to patch the problem by end of this period.\n\n## Impact\n\nPermanently lock-up a user's hardware wallet funds.","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-10-11T20:36:52.729Z","allow_singular_disclosure_after":18316.316564597,"singular_disclosure_allowed":false,"vote_count":26,"voters":["0nlymohammed","khizer47","akashhamal0x01","pr0t0","ethraltaunt","jessichick","ckcp","shivpalbilada","serhack_","meispi","and 16 more..."],"severity":{"rating":"medium","score":6.6,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7768576,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the note. Nothing to do here for us yet, we'll wait on the trezor/ledger patches.","automated_response":false,"created_at":"2020-04-23T14:33:13.909Z","updated_at":"2020-04-23T14:33:13.909Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7771319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is Ledger's patch for the issue, Trezor has already fixed it and I verified it with their latest release.\nhttps://github.com/monero-project/monero/pull/6424","automated_response":false,"created_at":"2020-04-23T17:32:44.579Z","updated_at":"2020-04-23T17:32:54.732Z","actor":{"username":"thecharlatan","cleared":false,"url":"/thecharlatan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9262514,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ledger still has an open bug for their unlock time validation. A high number triggers an integer overflow that either results in incorrect values being displayed on the ledger, or the ledger being unable to parse the transaction. I've been discussing this with the Ledger developer since late May, but they have not authored a further patch yet. Ironically they did post a security bulletin of the issue: https://donjon.ledger.com/lsb/009/","automated_response":false,"created_at":"2020-09-18T23:53:32.428Z","updated_at":"2020-09-18T23:53:32.428Z","actor":{"username":"thecharlatan","cleared":false,"url":"/thecharlatan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9447164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The unlock time verification bug is now patched and released. This ticket can be closed now.","automated_response":false,"created_at":"2020-10-07T13:58:01.040Z","updated_at":"2020-10-07T13:58:01.040Z","actor":{"username":"thecharlatan","cleared":false,"url":"/thecharlatan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9474254,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks","automated_response":false,"created_at":"2020-10-09T17:43:40.888Z","updated_at":"2020-10-09T17:43:40.888Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"thecharlatan","url":"/thecharlatan"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13416290,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-09-11T20:36:52.672Z","updated_at":"2021-09-11T20:36:52.672Z","first_to_agree":true,"actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13418213,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-09-12T08:36:40.505Z","updated_at":"2021-09-12T08:36:40.505Z","actor":{"username":"thecharlatan","cleared":false,"url":"/thecharlatan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13418214,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-12T08:36:40.574Z","updated_at":"2021-09-12T08:36:40.574Z","actor":{"username":"thecharlatan","cleared":false,"url":"/thecharlatan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}