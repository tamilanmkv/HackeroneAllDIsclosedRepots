{"id":833470,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzM0NzA=","url":"https://hackerone.com/reports/833470","title":"[Security Vulnerability Rocket.chat] HTML Injection into Email via Signup","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-28T16:20:56.574Z","submitted_at":"2020-03-28T16:20:56.574Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"steven_julian22","url":"/steven_julian22","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-24T15:31:47.800Z","bug_reporter_agreed_on_going_public_at":"2020-05-25T15:31:34.608Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description**\nDue to a lack of\u0026nbsp;\u0026nbsp;sanitization\u0026nbsp;and validation in parameter affected, we can input\u0026nbsp;HTML\u0026nbsp;Tag and system will render it into Email victim.\u0026nbsp;  \n\n  \n\n  \n\n**Affected Endpoint**\n\n[https://chat.oas.greenhost.net/home](https://chat.oas.greenhost.net/home)\u0026nbsp;\u0026nbsp;  \n\n  \n\nParameter : Name\n\n  \n\n  \n\n**Step to produce**\n\n ![image.png](cid:ii_k8bsyhgc0)  \n\nIn textbox name, input HTML code like\n\n  \n\n_\"\\\u003e\\\u003cimg src=[https://www.no-gods-no-masters.com/images\\_designs/anonymous-gandhi-d001001207265.png](https://www.no-gods-no-masters.com/images_designs/anonymous-gandhi-d001001207265.png)\\\u003e”@x.y \" \u0026nbsp;_\n\n  \n\nAnd in Email, input your victim email. Then click Lets Go\u0026nbsp;/ Submit.\n\n  \n\nWhen victim open email from your system, it will look.\u0026nbsp;\u0026nbsp;  \n\n  \n\n ![image.png](cid:ii_k8bt2hsk2)  \n\n  \n\n ![image.png](cid:ii_k8bt36wd3)  \n\n  \n\n**Impact**\n\n- Phising\n\n- Abusing other user\n\n- Defacing\n\n  \n\n**Fix**\n\nFiltering on parameter affected.\n\u003cfont color=\"#888888\"\u003e\u003cdiv\u003e\u003cbr\u003e\u003c/div\u003e\n\u003cdiv\u003e\u003cbr\u003e\u003c/div\u003e\n\u003cdiv\u003e\u003cbr\u003e\u003c/div\u003e\n\u003cdiv\u003e\u003cb\u003eSteven Julian\u003c/b\u003e\u003c/div\u003e\n\u003cdiv\u003e\u003cb\u003e\u003ca href=\"mailto:sn22shop@gmail.com\" target=\"_blank\"\u003esn22shop@gmail.com\u003c/a\u003e // +62 89658610626\u003c/b\u003e\u003c/div\u003e\u003c/font\u003e\n\n## Impact\n\n- Phising\n\n- Abusing other user\n\n- Defacing","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":764211,"file_name":"image.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ztJLbJkJoZWD3TMjGJUM2vag?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153253Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a7e3165dcde7a917782e66ee9b8c4a4a93267b9b7be2405469328e16d19470b4","file_size":29839,"type":"image/png"},{"id":764213,"file_name":"image.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7VpmpecL6enikxz8sZ3BQMVc?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153253Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a83838632a1406f96174c9e7b5d711f51d8bc79832d6a82a350c0cb440adc228","file_size":87470,"type":"image/png"},{"id":764214,"file_name":"image.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sMVQVxnLzD4R2PyeDnVJcckA?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153253Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9d5bfcb09b078403309ab600727a341f884e364983702be6a0eb884f04b5dbd6","file_size":58108,"type":"image/png"}],"allow_singular_disclosure_at":"2020-06-24T15:31:34.652Z","allow_singular_disclosure_after":-40953678.968374304,"singular_disclosure_allowed":true,"vote_count":21,"voters":["a_d_a_m","drsniper","badcracker","brahim_boufakri01","ali","m16","khizer47","hitman_47","jaisharma","mightyowl","and 11 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7474386,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @steven_julian22,\n\nThanks for the report! The present issue appears to be a self-XSS, which is not directly exploitable or would require convincing the user to copy/paste the JavaScript payload into the vulnerable field. In this case, it's no different from asking users to copy and paste malicious content into their browser's web developer console. \n\nIf you'd like us to reconsider this report, please include a working proof-of-concept which can be used without the victim entering the payload in the browser themselves.\n\nRegards,\n@bugseeker ","automated_response":false,"created_at":"2020-03-29T23:35:21.585Z","updated_at":"2020-03-29T23:35:21.585Z","actor":{"username":"bugseeker","cleared":false,"url":"/bugseeker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MQSo6h7swJUBC1NdjKCT4ZYe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7529194,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2020-04-03T11:25:29.197Z","updated_at":"2020-04-03T11:25:29.197Z","actor":{"username":"steven_julian22","cleared":false,"url":"/steven_julian22","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7529195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How funny when you said it like self XSS. Please understand what i write/report. If you don't really know the proof, just ask to me. Don't boast with close my report with N/A.\n\nLet me to tell you the proof again.\n\nSo attacker register another victim email. Then after successfully register, victim will receive confirmation email (look at F764213 and F764214). \n\nSo if you ask how it can be happen while victim already registered? you can use trick + like victim+1@email.com. However attacker will only not target victim who already registered.\n\n\n\nThe problem here is, no sanitization and validation in textfield/parameter affected so injection can happen. Just fixed it, or you call it fiture? LOL.\n\nwanna reference?\nhttps://hackerone.com/reports/321029\nhttps://hackerone.com/reports/181810\nhttps://hackerone.com/reports/262004","automated_response":false,"created_at":"2020-04-03T11:25:29.232Z","updated_at":"2020-04-03T11:25:29.232Z","actor":{"username":"steven_julian22","cleared":false,"url":"/steven_julian22","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7558528,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@steven_julian22 \n\nthanks for your report and clarification. \n\nI understand the problem with the lack of sanitization and validation and we will issue a fix.\n\nBest\nMarkus","automated_response":false,"created_at":"2020-04-06T13:24:12.186Z","updated_at":"2020-04-06T13:24:12.186Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7835785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Update.","automated_response":false,"created_at":"2020-04-29T10:08:27.699Z","updated_at":"2020-04-29T10:08:27.699Z","actor":{"username":"steven_julian22","cleared":false,"url":"/steven_julian22","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7851096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"we are working on a fix and it looks like it can come with the next release. Please bear with us","automated_response":false,"created_at":"2020-04-30T12:30:05.579Z","updated_at":"2020-04-30T12:30:05.579Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8096580,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @steven_julian22 \n\nthis has been fixed. Please feel free to let us know your opinion on the fix as well: https://github.com/RocketChat/Rocket.Chat/pull/17587\n\nThank you for making Rocket.Chat more secure!\n\nBest\nMarkus","automated_response":false,"created_at":"2020-05-25T11:42:47.676Z","updated_at":"2020-05-25T11:42:47.676Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"steven_julian22","url":"/steven_julian22"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8098202,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-25T15:31:34.625Z","updated_at":"2020-05-25T15:31:34.625Z","first_to_agree":true,"actor":{"username":"steven_julian22","cleared":false,"url":"/steven_julian22","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8396406,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-06-24T15:31:47.858Z","updated_at":"2020-06-24T15:31:47.858Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}