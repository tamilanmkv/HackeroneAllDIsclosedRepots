{"id":858603,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTg2MDM=","url":"https://hackerone.com/reports/858603","title":"Denial of Service in anti_ransomware_service.exe via logs files","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-24T11:23:57.042Z","submitted_at":"2020-04-24T11:23:57.042Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mjoensen","url":"/mjoensen","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13428,"url":"https://hackerone.com/acronis","handle":"acronis","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Acronis","twitter_handle":"Acronis","website":"https://www.acronis.com","about":"Acronis sets the standard for cyber protection through its backup, anti-ransomware and cyber infrastructure"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-06-24T08:21:49.389Z","bug_reporter_agreed_on_going_public_at":"2021-06-24T08:21:49.294Z","team_member_agreed_on_going_public_at":"2021-06-22T06:36:46.033Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"anti_ransomware_service.exe keeps a log in a folder where any unprivileged user has write permissions. The logs are generated in a predictable pattern allowing the unprivileged user to create a hardlink from the, not yet created, log file to the anti_ransomware_service itself. On reboot, this forces the anti_ransomware_service to try to write its log into its own process, crashing in a SHARING VIOLATION. This crash occurs on every reboot.\n\nSteps to reproduce:\n1. Download the symbolic link testing tools by James Forshaw:\n    https://github.com/googleprojectzero/symboliclink-testing-tools\n2. Create hardlink from the next log file in line. E.g. If active_protection.1.log exist but not active_protection.2.log, create the hardlink on number 2 and so on.\n    CreateHardlink.exe \"C:\\ProgramData\\Acronis\\ActiveProtection\\Logs\\active_protection.2.log\" \"C:\\Program Files (x86)\\Common Files\\Acronis\\ActiveProtection\\anti_ransomware_service.exe\"\n3. Reboot and verify that anti_ransomware_service.exe is not running.\n\n## Impact\n\nThe anti_ransomware_service.exe stops working from the first reboot (step 3) and onwards. This is a silent fail meaning that the user is not aware of the failing protection of the anti_ransomware_service.exe making the user vulnerable to ransomware.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["mr-medi","xsky","3x3s","cryptographer","ac1dm4n14c","ekgaribadmi","meispi"],"severity":{"rating":"medium","score":4.7,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":50772,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Acronis Cyber Protect Home Office (formerly Acronis True Image)","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7784692,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-04-24T15:27:59.034Z","updated_at":"2020-04-24T15:27:59.034Z","additional_data":{"old_title":"Denial of Service in anti_ransomware_service.exe","new_title":"Denial of Service in anti_ransomware_service.exe via logs files"},"actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7784710,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, @mjoensen. Thanks for your efforts!","automated_response":false,"created_at":"2020-04-24T15:29:23.635Z","updated_at":"2020-04-24T15:29:23.635Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7820343,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-04-28T08:24:05.792Z","updated_at":"2020-04-28T08:24:05.792Z","actor":{"url":"/acronis","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Acronis"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"acronis","collaborator":{"username":"mjoensen","url":"/mjoensen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8584135,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-07-13T15:11:32.286Z","updated_at":"2020-07-13T15:11:32.286Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Mobile applications","new_scope":"Acronis Agent","genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8785483,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-07-28T20:33:56.151Z","updated_at":"2020-07-28T20:33:56.151Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Acronis Agent","new_scope":"Acronis Cyber Protect Home Office (formerly Acronis True Image)","genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8799322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, @mjoensen,\n\nAs we discussed, this issue will be fixed in Acronis True Image 2021. \nAcronis True Image 2021 Beta is now available. You can join Beta Program and verify, if this issue is reproducible, https://www.acronis.com/en-us/personal/computer-backup/beta/.","automated_response":false,"created_at":"2020-07-29T21:36:20.006Z","updated_at":"2020-07-29T21:36:20.006Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9021308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mjoensen,\nWe've just released Acronis True Image 2021 where this bug should be fixed. Please confirm that you are no longer able to reproduce the issue. You can request a trial [here](https://www.acronis.com/en-eu/personal/computer-backup/)\n\nOne note regarding vulnerability details disclosure. Since in this case we're not managing vulnerable installations, we're asking for a standard 90 days remediation time so that as many customers as possible would get an update. \nWe also kindly ask you to share with us content of the requested CVE, so that we could confirm that there is no excessive information disclosure.","automated_response":false,"created_at":"2020-08-24T11:11:27.353Z","updated_at":"2020-08-24T11:11:27.353Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9041623,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for catching this bug!\n\nWe have fixed it, please confirm that you are no longer able to reproduce the issue.\n","automated_response":true,"created_at":"2020-08-26T06:41:11.895Z","updated_at":"2020-08-26T06:41:11.895Z","actor":{"username":"acronis-bot","cleared":false,"url":"/acronis-bot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mjoensen","url":"/mjoensen"},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9043624,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mjoensen,\nWe also mentioned you in Acronis True Image 2021 release notes: https://www.acronis.com/en-us/support/updates/changes.html?p=41682","automated_response":false,"created_at":"2020-08-26T10:49:21.036Z","updated_at":"2020-08-26T10:49:21.036Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12201509,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-22T06:36:46.063Z","updated_at":"2021-06-22T06:36:46.063Z","first_to_agree":true,"actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12228885,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-24T08:21:49.330Z","updated_at":"2021-06-24T08:21:49.330Z","actor":{"username":"mjoensen","cleared":false,"url":"/mjoensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12228886,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-24T08:21:49.439Z","updated_at":"2021-06-24T08:21:49.439Z","actor":{"username":"mjoensen","cleared":false,"url":"/mjoensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}