{"id":863979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjM5Nzk=","url":"https://hackerone.com/reports/863979","title":"Compromise of node can lead to compromise of pods on other nodes","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-01T12:26:35.494Z","submitted_at":"2020-05-01T12:26:35.494Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"wtm","url":"/wtm","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39386,"url":"https://hackerone.com/kubernetes","handle":"kubernetes","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kubernetes","twitter_handle":"kubernetesio","website":"https://kubernetes.io/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8559"],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-30T21:54:31.857Z","bug_reporter_agreed_on_going_public_at":"2020-10-30T21:54:31.792Z","team_member_agreed_on_going_public_at":"2020-10-30T21:27:37.598Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Kubernetes team, \n\n## Summary:\nIf an attacker manages to escape a (eg. privileged) container and gains access to the underlying node it can replace the Kubelet process listening on port 10250/10255 on the node. A fake Kubelet server issueing 301 redirects can trick 'kubectl' (or other clients) into issueing commands against a other pods in the cluster.  This attack bypasses firewalling configurations where nodes cannot talk directly to eachother on port 10250/10255 and also works when port 10250 requires authentication since kubectl is happy to resend the Authorization header / bearer token when a 301redirect is received. \n\n## Kubernetes Version:\n1.14.10\n\n## Component Version:\nkubelet/kubectl\n\n## Steps To Reproduce:\n\n  1. Attacker escapes container \n  2. Attacker issues a 'kill -9 `pidof kubelet`; python fakekubet.py  (see attachment)\n  3. Attacker waits for a /exec request coming in to the fakekubelet.py server, and redirects it (with an arbitrary command) to another node.  \n\nExample exec request for 'hello-app'  by kubectl:\n10.138.0.10 - - [01/May/2020 11:28:55] \"POST /exec/default/hello-server-7f8fd4d44b-j5rsc/hello-app?command=%2Fbin%2Fs\u0026input=1\u0026output=1\u0026tty=1 HTTP/1.1\" 307 - \n\nExample response by the fakekubelet: \nHTTP/1.1 301 Redirect\nLocation: https://10.138.0.8/exec/default/victim-67c59cd9f4-vm5dl/nginx?command=/bin/arbitrary_command_here\u0026error=1\u0026input=1\u0026output=1\u0026tty=0\n\n  4. kubectl follows the redirect and contacts the victim node, requesting /exec as specified by fakekubelet.py (can also redirect to 'master')\n  5. arbitrary command is executed on the victim node\n\n\n## Supporting Material/References:\nattachment 1:  fakekubelet.py\nattachment 2: ugly_diagram.png\nrelated Kubelet code: https://github.com/kubernetes/kubernetes/blob/4a6935b31fcc4d1498c977d90387e02b6b93288f/pkg/kubelet/server/server.go#L257-L263\n\n\nI hope this helps!\n\nKind regards, \nOffensi.com\n\nWouter ter Maat\n\n## Impact\n\nexecute arbitrary command in victim's pod","bounty_amount":"1100.0","formatted_bounty":"$1,100","original_report_id":null,"original_report_url":null,"attachments":[{"id":810873,"file_name":"fakekubelet.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4pL6DL2P5J7VR5buPSiwVYcn?response-content-disposition=attachment%3B%20filename%3D%22fakekubelet.py%22%3B%20filename%2A%3DUTF-8%27%27fakekubelet.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153548Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=881b82fbd62431d9bed6a33546e78acc70b21ca51ec5bbac59baeaa714f57a5b","file_size":685,"type":"text/x-python"},{"id":810906,"file_name":"ugly_diagram.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GyVLT3S84jcqTBDhcxnvCkn6?response-content-disposition=attachment%3B%20filename%3D%22ugly_diagram.png%22%3B%20filename%2A%3DUTF-8%27%27ugly_diagram.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153548Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=93884b5a20b7ca440f8e2f3032bb1e0c401a892de5146810e1fd425832890bbc","file_size":29640,"type":"image/png"}],"allow_singular_disclosure_at":"2020-11-29T21:27:37.751Z","allow_singular_disclosure_after":-27281290.56587913,"singular_disclosure_allowed":true,"vote_count":8,"voters":["ali","wtm","sa1tama0","omespino","m0ti0nl3ss_","karca","jeyanthan","xenonm2r"],"severity":{"rating":"medium","score":6.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":32489,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/kubernetes/kubelet","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7865609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @wtm - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.","automated_response":false,"created_at":"2020-05-01T16:18:03.621Z","updated_at":"2020-05-01T16:18:03.621Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7865661,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @wtm - Thank you for the report. Can you please include more details in your reproduction steps, and if possible, include a video demonstrating how to reproduce this? Thanks!","automated_response":false,"created_at":"2020-05-01T16:24:25.498Z","updated_at":"2020-05-01T16:24:25.498Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8106606,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @tuxedo, \n\nSorry for my late reply. I'm currently working on the PoC video, will get back to you ASAP. \n\nKind regards, \n\nWouter ter Maat","automated_response":false,"created_at":"2020-05-26T12:58:21.855Z","updated_at":"2020-05-26T12:58:21.855Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8109530,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @wtm - Thank you for letting me know. I'm changing the status of this report back to `Needs more info`. Please reply when you're ready to provide the PoC video. Thank you!","automated_response":false,"created_at":"2020-05-26T16:32:01.294Z","updated_at":"2020-05-26T16:32:01.294Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8117882,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @tuxedo, \n\nI've (finally) finished the PoC, again sorry for the delay. Attached you will find several files. \n\n- poc-google-kubernetes.mp4: video of the PoC script running\n- poc-google-kubernetes.sh: script to setup a GKE cluster and demonstrate what happens if a pod gets compromised and the attacker replaces the kubelet running on the node. \n- kubectl_verbose.txt : verbose log of an admin trying to execute a command in an attacker controlled pod (with kubectl)\n\nThe poc-google-kubernetes.sh creates a cluster with 2 nodes. It then tries to schedule 1 pod on each node. \n\nThe attacker controlled pod is configured to run my fake kubelet server (which mimic's what i would do when i compromise a pod remotely). The fake kubelet on the attacker controlled pod is configured to redirect all exec requests to the 'very-secure-pod', adding a arbitrary command of my choosing (in this case: 'echo hello from very-secure-pod'). In a real life scenario i could ofcourse also redirect arbitrary commands into pods running in the kube-system namespaces, such as the master. \n\nI hope this helps! Let me know if you need any further information. \n\nKind regards, \nOffensi.com\n\nWouter ter Maat\n\n","automated_response":false,"created_at":"2020-05-27T11:34:19.294Z","updated_at":"2020-05-27T11:34:19.294Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":844771,"filename":"poc-google-kubernetes.sh","type":"application/x-shellscript","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6GVLHxo1iTPN8QNSQtmk7PQD?response-content-disposition=attachment%3B%20filename%3D%22poc-google-kubernetes.sh%22%3B%20filename%2A%3DUTF-8%27%27poc-google-kubernetes.sh\u0026response-content-type=application%2Fx-shellscript\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153548Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3e157566f14e40ebc48a1a52c25d3f3689a180adc63f09eb139a15d4c9f4a72b"},{"id":844769,"filename":"kubectl_verbose.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LX8zhXrKrbxevE9Y3M9Y8F7U?response-content-disposition=attachment%3B%20filename%3D%22kubectl_verbose.txt%22%3B%20filename%2A%3DUTF-8%27%27kubectl_verbose.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153548Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=243063cfebbeec5df2af508fc4f84aedb1c8c2194713fca1e09ab99f1e2d528f"},{"id":844760,"filename":"poc-google-kubernetes.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GbBgHsquB7oiKgGLu7QP2T53?response-content-disposition=attachment%3B%20filename%3D%22poc-google-kubernetes.mp4%22%3B%20filename%2A%3DUTF-8%27%27poc-google-kubernetes.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153548Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=94330eaa4e9e5b6e0009b46cc1d31b0d5e9db84c0ed932a84e799e0375d5579d"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8150440,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @wtm,\n\nThank you for the additional information. The Kubernetes team informed me that this would be mitigated by the [deprecation of StreamingProxyRedirects](https://github.com/kubernetes/enhancements/blob/master/keps/sig-node/20191205-container-streaming-requests.md).\n\nI changed this report's state to \"Needs More Info\" so that you can self-close it. By self-closing a report, you will avoid any reputation loss on your HackerOne profile!\n\nIn order to self-close a report:\n\n- Click on the \"Add comment\" button above the reply textbox\n- Choose \"Close report\"\n- Click on the green button \"Close report\" on the bottom right of the reply textbox\n\nWe hope to read more of your reports in the future!\n\nKind regards,\n@tuxedo","automated_response":false,"created_at":"2020-05-29T18:33:09.067Z","updated_at":"2020-05-29T18:33:09.067Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8173526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@wtm - Sorry for the confusion, this looks like a valid report even though it will eventually be broken by the removal of StreamingProxyRedirects. We still want to fix it, as the deprecation won't trickle down to all supported releases for another year.\n\nThank you for the report!","automated_response":false,"created_at":"2020-06-02T00:09:30.021Z","updated_at":"2020-06-02T00:09:30.021Z","actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8176260,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @tallclair, \n\nCool to see it's being addressed, thanks for the info! \n\nKind regards, \n\nWouter ter Maat","automated_response":false,"created_at":"2020-06-02T09:04:51.297Z","updated_at":"2020-06-02T09:04:51.297Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8205426,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2020-06-04T21:05:39.854Z","updated_at":"2020-06-04T21:05:39.854Z","cve_ids":["CVE-2020-8559"],"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8565814,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-07-11T00:13:20.915Z","updated_at":"2020-07-11T00:13:20.915Z","actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8586619,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-07-13T18:51:15.163Z","updated_at":"2020-07-13T18:51:15.163Z","additional_data":{"old_severity":"High (8.4)","new_severity":"Medium (6.8)","old_severity_id":709311,"new_severity_id":778441},"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8586752,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Bonus for good write up \u0026 PoC :)\n\nSeverity - Apologies for not giving advanced notice on the severity update. We downgraded the scope to unchanged to better capture the requirement to compromise a node first.\n\nWe will announce this on Wednesday, July 15th, at approximately 9am PT to kubernetes-security-announce@googlegroups.\n\nHow would you like to be credited on the public announcement? I currently have: \"Wouter ter Maat of Offensi\"","automated_response":false,"created_at":"2020-07-13T19:08:03.907Z","updated_at":"2020-07-13T19:08:03.907Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kubernetes"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"kubernetes","collaborator":{"username":"wtm","url":"/wtm"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8587386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you Tim and Kubernetes team! Great to receive a bounty from such a cool project.\nI'm fine with being credited the way you described.\n\nThanks again,\n\nWouter","automated_response":false,"created_at":"2020-07-13T20:46:08.717Z","updated_at":"2020-07-13T20:46:08.717Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8612440,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://groups.google.com/g/kubernetes-security-announce/c/JAIGG5yNROs","automated_response":false,"created_at":"2020-07-15T21:26:05.570Z","updated_at":"2020-07-15T21:26:05.570Z","actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"wtm","url":"/wtm"},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8612445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Corrected link: https://groups.google.com/forum/?oldui=1#!topic/kubernetes-security-announce/JAIGG5yNROs","automated_response":false,"created_at":"2020-07-15T21:28:23.951Z","updated_at":"2020-07-15T21:28:23.951Z","actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8667983,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-21T19:18:19.450Z","updated_at":"2020-07-21T19:18:19.450Z","first_to_agree":true,"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8699376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @wtm, would you be okay with us disclosing this report? There are some presenters who will be discussing the Kubernetes bug bounty program and would like to mention this issue.","automated_response":false,"created_at":"2020-07-22T21:26:38.259Z","updated_at":"2020-07-22T21:26:38.259Z","actor":{"username":"jk1joel","cleared":false,"url":"/jk1joel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8716223,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jk1joel,\n\nIs there a way we can disclose a summary that would benefit the presenters without providing threat actors with tools?\n\nI reported a full exploit chain to some large bug bounty programs which rely on similar tactics as described in this report. They are still in the process of fixing, but i know out of experience it can take months in the worst case :)\n\nKind regards,\n\nWouter","automated_response":false,"created_at":"2020-07-23T09:29:23.438Z","updated_at":"2020-07-23T09:29:23.438Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8977748,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"pausing this for now. \n\nKind regards, \n\nWouter\n","automated_response":false,"created_at":"2020-08-19T13:15:12.060Z","updated_at":"2020-08-19T13:15:12.060Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9688161,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Given the PoCs that have already been posted on several blog posts about this vulnerability, I am comfortable releasing this report as-is.","automated_response":false,"created_at":"2020-10-30T21:27:37.630Z","updated_at":"2020-10-30T21:27:37.630Z","first_to_agree":true,"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9688188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Tim,\n\nHope you are well. You are right, this should be fine!\n\nKind regards,\n\nWoutrr","automated_response":false,"created_at":"2020-10-30T21:32:15.965Z","updated_at":"2020-10-30T21:32:15.965Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9688297,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-30T21:54:31.816Z","updated_at":"2020-10-30T21:54:31.816Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9688298,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-30T21:54:31.888Z","updated_at":"2020-10-30T21:54:31.888Z","actor":{"username":"wtm","cleared":true,"url":"/wtm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/088/197125731be3cf899a34f727af5f5d3f8c6891e9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}