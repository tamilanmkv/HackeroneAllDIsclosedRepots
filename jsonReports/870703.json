{"id":870703,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzA3MDM=","url":"https://hackerone.com/reports/870703","title":"Stored XSS in assets.txmblr.com","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2020-05-11T11:15:09.682Z","submitted_at":"2020-05-11T11:15:09.682Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"keer0k","url":"/keer0k","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-11T17:39:23.673Z","bug_reporter_agreed_on_going_public_at":"2020-05-11T17:35:28.660Z","team_member_agreed_on_going_public_at":"2020-05-11T17:39:23.529Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Description\n\nHi, i would like to report a issue that i think is legitimate. to get this XSS we need to create a Post in the attacker account with a payload, after this, it's necessary that a victim reblog this post and so, enter in the edit mode of their own blog, after this the victim will see a button with \"CLICK ME\" value, so, when the victim click in \"CLICK ME\" the XSS will be triggerd.\n\nPoC payload:\n```\n\u003cform\u003e\n\u003cinput type=submit formaction=javascript:alert(document.domain)\u003e\n\u003c/form\u003e\n```\n\n# Steps to reproduce\n1. go to your account\n2. create a post with the payload mentioned before\n3. victim reblog the post\n4. victim enter in the edit mode of their own blog\n5. victim click in \"CLICK ME\" button\n6. XSS will be triggerd\n\n## Impact\n\nit is possible to perform malicious actions on the victim's account","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["an40r1","keer0k","htrgouvea","0nlymohammed","aslanemre","notinuse","zombees","dshy","amrvvvb"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":42406,"asset_type":"URL","asset_identifier":"*.txmblr.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7960917,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I also created a video to better understand: \n{F823707}","automated_response":false,"created_at":"2020-05-11T11:21:58.267Z","updated_at":"2020-05-11T11:21:58.267Z","actor":{"username":"keer0k","cleared":true,"url":"/keer0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":823707,"filename":"Screen_Recording_2020-05-11_at_08.17.41.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rCgGe16aagEouBUnGeGefJEx?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2020-05-11_at_08.17.41.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2020-05-11_at_08.17.41.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153634Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bb2b50ff5d781bc1ff26cefbb26c43ee8d95e95cae877ee7e378afe0ff98d981"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7963684,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. Your report will be reviewed and we'll get back to you shortly.","automated_response":false,"created_at":"2020-05-11T14:32:17.542Z","updated_at":"2020-05-11T14:32:17.542Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7963717,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @keer0k,\n\nAt Tumblr, we allow creators (i.e. our users) the freedom of expression and offer them the most that they can desire (within reason of course). The Blog Network is home to each user's custom blog - we can think of these as miniature websites. We allow all users to customize their blog / \"website\" as much as they want - this includes the ability to add JavaScript on their pages.\n\nIn other words, we allow JavaScript to exist on the blog network. Since it is a separate domain, it cannot affect a user's logged in session. In this case, the \"blog network\" is being emulated on the customize page which, in turn, will execute JavaScript if a post on the blog being customized contains JavaScript.\n\nWe usually have a trigger that would have triggered on this submission (I'll look into why it didn't) so please feel free to self-close or, alternatively, we would be happy to close as `Informative` if you'd prefer.\n\nThanks!","automated_response":false,"created_at":"2020-05-11T14:35:27.438Z","updated_at":"2020-05-11T14:35:27.438Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965492,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I thought that because it is triggering on a domain other than username.tumblr.com this would be a valid failure (as in this case xss is alerted on the assets.txmblr domain) but ok, can you close the report as informative?","automated_response":false,"created_at":"2020-05-11T17:22:29.799Z","updated_at":"2020-05-11T17:22:29.799Z","actor":{"username":"keer0k","cleared":true,"url":"/keer0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"after this, can you disclose the report?","automated_response":false,"created_at":"2020-05-11T17:24:42.133Z","updated_at":"2020-05-11T17:24:42.133Z","actor":{"username":"keer0k","cleared":true,"url":"/keer0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965602,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"\u003e I thought that because it is triggering on a domain other than username.tumblr.com this would be a valid failure (as in this case xss is alerted on the assets.txmblr domain)\n\nAh, yeah, that's our bad; the `assets.txmblr.com` domain isn't listed as \"out of scope\"; it is in the trigger response that *should* have fired here but not on the policy page. I'll see if we can get it updated. :)\n\n\u003e can you close the report as informative?\n\nSure thing!\n\n\u003e after this, can you disclose the report?\n\nAlso, sure, please request the disclosure yourself and I'll approve it.\n\nThanks! ^_^","automated_response":false,"created_at":"2020-05-11T17:31:16.751Z","updated_at":"2020-05-11T17:31:16.751Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965661,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Ok","automated_response":false,"created_at":"2020-05-11T17:35:28.731Z","updated_at":"2020-05-11T17:35:28.731Z","first_to_agree":true,"actor":{"username":"keer0k","cleared":true,"url":"/keer0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@keer0k - oops, sorry, forgot to ask; would you like full disclosure or limited disclosure?","automated_response":false,"created_at":"2020-05-11T17:36:41.314Z","updated_at":"2020-05-11T17:36:41.314Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965716,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can be full disclosure","automated_response":false,"created_at":"2020-05-11T17:37:59.421Z","updated_at":"2020-05-11T17:37:59.421Z","actor":{"username":"keer0k","cleared":true,"url":"/keer0k","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/008/f3d301be988630bf61027f4d4584ca9f85b9e747_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965736,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Perfect, will do! Thank you again for your report and we look forward to more reports from you in the future! ^_^","automated_response":false,"created_at":"2020-05-11T17:39:23.554Z","updated_at":"2020-05-11T17:39:23.554Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7965738,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-11T17:39:23.698Z","updated_at":"2020-05-11T17:39:23.698Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}