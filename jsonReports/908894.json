{"id":908894,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDg4OTQ=","url":"https://hackerone.com/reports/908894","title":"Null dereference or redundant null check in `mail_crypt_load_global_private_key` for plugin mail-crypt","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-26T12:51:30.035Z","submitted_at":"2020-06-26T12:51:30.035Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"catenacyber","url":"/catenacyber","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-07T07:07:47.458Z","bug_reporter_agreed_on_going_public_at":"2020-07-07T07:06:07.571Z","team_member_agreed_on_going_public_at":"2020-07-07T07:07:47.353Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In this function, we check once if `error_r` is not NULL in \n```\n\tif (enc_type == DCRYPT_KEY_ENCRYPTION_TYPE_PASSWORD) {\n\t\t/* Fail here if password is not set since openssl will prompt\n\t\t * for it otherwise */\n\t\tif (key_password == NULL) {\n\t\t\tif (error_r != NULL)\n\t\t\t\t*error_r = t_strdup_printf(\"%s: %s unset, no \"\n\t\t\t\t\t\t\"password to decrypt the key\",\n\t\t\t\t\t\tset_key, set_pw);\n\t\t\treturn -1;\n\t\t}\n\t}\n\n```\n\nright after not having checked this NULL case\n```\n\tif (kind != DCRYPT_KEY_KIND_PRIVATE) {\n\t\t*error_r = t_strdup_printf(\"%s: key is not private\", set_key);\n\t\treturn -1;\n\t}\n```\n\n## Impact\n\nThis is likely a redundant NULL check, but reporting it there to be safe like https://hackerone.com/bugs?report_id=827729","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":51,"name":"NULL Pointer Dereference"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["secator","prophet","b69fb2ebda43240ece9dbeb"],"severity":{"rating":"medium","score":4.1,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":42899,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/dovecot/core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8418248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Same kind of bug is present in `master_login_auth_callback`\n\n```\n\tif (errormsg != NULL || auth_args[0] == NULL) {\n\t\tif (auth_args != NULL) {\n\t\t\ti_error(\"login client: Username missing from auth reply\");\n```\n\nWe dereference `auth_args` before checking its NULLness","automated_response":false,"created_at":"2020-06-26T12:53:11.793Z","updated_at":"2020-06-26T12:53:11.793Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8463724,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We'll add/remove the NULL checks as appropriate for each case. Thank you for reporting this issue.","automated_response":false,"created_at":"2020-07-01T06:34:10.556Z","updated_at":"2020-07-01T06:34:10.556Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8519923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me know when you found out if these were redundant null checks without security impact (or missing null checks).\nSo, I can publish my codeql query that found those","automated_response":false,"created_at":"2020-07-06T19:52:05.007Z","updated_at":"2020-07-06T19:52:05.007Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8523279,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"they are missing NULL checks but they have no security impact. ","automated_response":false,"created_at":"2020-07-07T05:40:12.850Z","updated_at":"2020-07-07T05:40:12.850Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523321,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-07-07T05:50:06.191Z","updated_at":"2020-07-07T05:50:06.191Z","additional_data":{"old_severity":"Medium (6.5)","new_severity":"Medium (4.1)","old_severity_id":762132,"new_severity_id":772322},"actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523322,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have determined this bug has no practical security impact, and thus we are closing it. Thank you for taking the time to report this bug.","automated_response":false,"created_at":"2020-07-07T05:50:10.985Z","updated_at":"2020-07-07T05:50:10.985Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"catenacyber","url":"/catenacyber"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523323,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-07-07T05:50:22.420Z","updated_at":"2020-07-07T05:50:22.420Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"catenacyber","url":"/catenacyber"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-07T07:06:07.604Z","updated_at":"2020-07-07T07:06:07.604Z","first_to_agree":true,"actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8523736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks","automated_response":false,"created_at":"2020-07-07T07:06:15.647Z","updated_at":"2020-07-07T07:06:15.647Z","actor":{"username":"catenacyber","cleared":false,"url":"/catenacyber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8523747,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-07T07:07:47.376Z","updated_at":"2020-07-07T07:07:47.376Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523748,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-07T07:07:47.485Z","updated_at":"2020-07-07T07:07:47.485Z","actor":{"username":"akituomi","cleared":false,"url":"/akituomi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/216/805d230879c8e3757d37eedddaadf9efed0a8094_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}