{"id":921709,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjE3MDk=","url":"https://hackerone.com/reports/921709","title":"Clickjacking on donation page","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-07-12T21:52:04.959Z","submitted_at":"2020-07-12T21:52:04.959Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b0d8e6c576cada9bb87be7b","url":"/b0d8e6c576cada9bb87be7b","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-16T11:25:16.069Z","bug_reporter_agreed_on_going_public_at":"2020-07-15T17:34:50.096Z","team_member_agreed_on_going_public_at":"2020-07-16T11:25:15.912Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description:\n\nVulnerable URL: https://wordpressfoundation.org/donate/\n\nClickjacking on the vulnerable URL allows an attacker to redirect a victim to do a donation at an attacker's page.\n\n## Steps To Reproduce:\n\n1)  To test whether the page is vulnerable to clickjacking or not use this code\n\n\u003c!DOCTYPE HTML\u003e\n\u003chtml lang=\"en-US\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"UTF-8\"\u003e\n\u003cmeta http-equiv=\"refresh\" content=\"5\"\u003e\n\u003ctitle\u003ei Frame\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ccenter\u003e\u003ch1\u003eTHIS PAGE IS VULNERABLE TO CLICKJACKING\u003c/h1\u003e\n\u003ciframe src=\"https://wordpressfoundation.org/donate/\" frameborder=\"0 px\" height=\"1200px\" width=\"1920px\"\u003e\u003c/iframe\u003e\n\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\n2) To test whether an attacker is able to trick the victim to donate money to the attacker's payment gateway\n             i) Open the attached page \"donation.html \"\n             ii) Click on the button give once\n             iii) The page will be redirected to the attacker's PayPal money request page.\n\n*Sorry for the bad UI and please remove my payment-request id after the vulnerability check from donation.html page.\n\n## Recommendations\n\nTo control where your site can be embedded, use the frame-ancestors directive:\nContent-Security-Policy: frame-ancestors 'none'  (The page cannot be displayed in a frame, regardless of the site attempting to do so.)\nContent-Security-Policy: frame-ancestors 'self' (The page can only be displayed in a frame on the same origin as the page itself.)\nContent-Security-Policy: frame-ancestors *uri* (The page can only be displayed in a frame on the specified origins.)\n\n## Impact\n\nIf an attacker is successful in tricking the victim to a click jacked page. He can trick the victim to donate money to the attacker's account. An attacker may also craft a page to gather victim's information, He may use also use BEEF hook id to take control of victim's browser.","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":904820,"file_name":"donation.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rDTz2E66QmosqFvTnmnDFuM9?response-content-disposition=attachment%3B%20filename%3D%22donation.html%22%3B%20filename%2A%3DUTF-8%27%27donation.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154226Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5a047000b795042ccd3ba15c73ffc374b1630227ce50e31a36fc2daec56dd513","file_size":7593,"type":"text/html"}],"allow_singular_disclosure_at":"2020-08-14T17:34:50.163Z","allow_singular_disclosure_after":-36540456.26545611,"singular_disclosure_allowed":true,"vote_count":88,"voters":["ali","0xelkomy","ayoub0x1","realtess","gamliel","prob0x01","demonia","salahhasoneh","h4x0r_dz","eschultze","and 78 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":17572,"asset_type":"URL","asset_identifier":"wordpressfoundation.org","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8576701,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-07-13T03:46:49.528Z","updated_at":"2020-07-13T03:46:49.528Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":777146,"new_severity_id":777529},"actor":{"username":"otto","cleared":false,"url":"/otto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/196/bd7b2308fb12476f4e36cf8d3afd852a6c89a9b4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8576704,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the report!\n\nAs it is not necessary for any part of the WordPress Foundation site to be embedded into a frame from anywhere, the frame-ancestors directive has been set to \"none\" for that site.\n","automated_response":false,"created_at":"2020-07-13T03:47:23.699Z","updated_at":"2020-07-13T03:47:23.699Z","actor":{"username":"otto","cleared":false,"url":"/otto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/196/bd7b2308fb12476f4e36cf8d3afd852a6c89a9b4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"b0d8e6c576cada9bb87be7b","url":"/b0d8e6c576cada9bb87be7b"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8576814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The URL \"https://central.wordcamp.org/\"  is also vulnerable to clickjacking, It has not much dynamic impact on the page except bulk mailing and redirecting but SCOPE IS CRITICAL.\n\nYou can use this code to test the vulnerability\n\n\u003c!DOCTYPE HTML\u003e\n\u003chtml lang=\"en-US\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"UTF-8\"\u003e\n\u003ctitle\u003ei Frame\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003ccenter\u003e\u003ch1\u003eTHIS PAGE IS VULNERABLE TO CLICKJACKING\u003c/h1\u003e\n\u003ciframe src=\"https://central.wordcamp.org\" frameborder=\"0 px\" height=\"1200px\" width=\"1920px\"\u003e\u003c/iframe\u003e\n\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\nPLEASE FIX THIS TOO.\n\nHAPPY TO HELP : )\n\nAnd any reward ??","automated_response":false,"created_at":"2020-07-13T04:40:04.516Z","updated_at":"2020-07-13T04:40:04.516Z","actor":{"username":"b0d8e6c576cada9bb87be7b","cleared":false,"url":"/b0d8e6c576cada9bb87be7b","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8576833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wordcamp.org has a different setup than the wordpressfoundation.org site, and frames are used for portions of that site.\n\nHowever, that specific issue was already reported years ago, and mitigations for it are already in place. Specifically, different headers are sent on wordcamp.org for logged-in users than for logged-out ones, and there is no viable threat for logged-out users. Not all instances of \"clickjacking\" are valid.\n\nAs for rewards, that is not my area. Somebody else will address that.\n","automated_response":false,"created_at":"2020-07-13T04:48:38.423Z","updated_at":"2020-07-13T04:48:38.423Z","actor":{"username":"otto","cleared":false,"url":"/otto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/196/bd7b2308fb12476f4e36cf8d3afd852a6c89a9b4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8576908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok..cool. Please let me know if this report is eligible for any bounty or swag.","automated_response":false,"created_at":"2020-07-13T05:00:36.309Z","updated_at":"2020-07-13T05:00:36.309Z","actor":{"username":"b0d8e6c576cada9bb87be7b","cleared":false,"url":"/b0d8e6c576cada9bb87be7b","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8610448,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @0_loophole_, we would like thank you again for your submission and helping make WordPress a safer place. We look forward to more reports from you in the future!","automated_response":false,"created_at":"2020-07-15T16:56:24.385Z","updated_at":"2020-07-15T16:56:24.385Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"b0d8e6c576cada9bb87be7b","url":"/b0d8e6c576cada9bb87be7b"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8610746,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for the bounty. Can we disclose this.","automated_response":false,"created_at":"2020-07-15T17:34:50.117Z","updated_at":"2020-07-15T17:34:50.117Z","first_to_agree":true,"actor":{"username":"b0d8e6c576cada9bb87be7b","cleared":false,"url":"/b0d8e6c576cada9bb87be7b","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8617868,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, as it had low security implications, going ahead with the disclosure now instead of waiting the usual 30 days.","automated_response":false,"created_at":"2020-07-16T11:25:15.936Z","updated_at":"2020-07-16T11:25:15.936Z","actor":{"username":"ehtis","cleared":false,"url":"/ehtis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8617869,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-16T11:25:16.091Z","updated_at":"2020-07-16T11:25:16.091Z","actor":{"username":"ehtis","cleared":false,"url":"/ehtis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}