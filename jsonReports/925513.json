{"id":925513,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjU1MTM=","url":"https://hackerone.com/reports/925513","title":"Unrestricted File Upload in Chat Window","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-16T16:12:54.368Z","submitted_at":"2020-07-16T16:12:54.368Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ant_pyne","url":"/ant_pyne","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":12633,"url":"https://hackerone.com/owox","handle":"owox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"OWOX, Inc.","twitter_handle":"owoxbi","website":"https://bi.owox.com","about":"Get more advantages from Google Analytics and complete control over your data in Google BigQuery"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-16T06:35:33.740Z","bug_reporter_agreed_on_going_public_at":"2020-07-17T06:35:28.925Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Summary:\nThe application allows the attacker to upload dangerous file types that can be automatically processed within the product's environment.\n\n#Steps To Reproduce:\n- Hit the browser and navigate to https://bi.owox.com and sign in.\n- Open The Chat window.\n- Upload any .rb or .php file .\n- Click on send button.\n\n## Impact\n\n-\u003e The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the\nattacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.\n-\u003eIt is important to check a file upload module’s access controls to examine the risks properly.\n-\u003e Server-side attacks: The web server can be compromised by uploading and executing a web-shell which can run commands, browse system files,\nbrowse local resources, attack other servers, or exploit the local vulnerabilities, and so forth.\n-\u003eClient-side attacks: Uploading malicious files can make the website vulnerable to client-side attacks such as XSS or Cross-site Content Hijacking.\n-\u003eUploaded files can be abused to exploit other vulnerable sections of an application when a file on the same or a trusted server is needed (can again\nlead to client-side or server-side attacks)\n-\u003eUploaded files might trigger vulnerabilities in broken libraries/applications on the client side (e.g. iPhone MobileSafari LibTIFF Buffer Overflow).\n-\u003eUploaded files might trigger vulnerabilities in broken libraries/applications on the server side (e.g. ImageMagick flaw that called ImageTragick!).\n-\u003eUploaded files might trigger vulnerabilities in broken real-time monitoring tools (e.g. Symantec antivirus exploit by unpacking a RAR file)\n-\u003eA malicious file such as a Unix shell script, a windows virus, an Excel file with a dangerous formula, or a reverse shell can be uploaded on the server in\norder to execute code by an administrator or webmaster later – on the victim’s machine.\n-\u003eAn attacker might be able to put a phishing page into the website or deface the website.\n-\u003eThe file storage server might be abused to host troublesome files including malwares, illegal software, or adult contents. Uploaded files might also\ncontain malwares’ command and control data, violence and harassment messages, or steganographic data that can be used by criminal organisations.\n-\u003eUploaded sensitive files might be accessible by unauthorised people.\n-\u003eFile uploaders may disclose internal information such as server internal paths in their error messages.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":909873,"file_name":"Screenshot_2020-07-16_at_9.40.43_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/duiC3pEKfQCGieJqH89E4xyF?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-07-16_at_9.40.43_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-07-16_at_9.40.43_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154255Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=29583ef30e7f71f22df2e32fbe5ee15bfad026f0c889cd62f1b307e75d76d418","file_size":852125,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-16T06:35:28.975Z","allow_singular_disclosure_after":-36407246.75548727,"singular_disclosure_allowed":true,"vote_count":13,"voters":["ali","what_web","assassin_marcos","sa1tama0","ant_pyne","sheerwood","muqduq","yuvikepa","thesudo2","gr3yr0n1n","and 3 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8623940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ant_pyne  thanks for the report!  Since we use Intercom as a third-party solution to communicate with our customers,  all files that are sent to the chat cannot be executed because ones are not part of the application.  We may configure the files extension list in Intercom if will needed","automated_response":false,"created_at":"2020-07-16T22:47:28.769Z","updated_at":"2020-07-16T22:47:28.769Z","actor":{"username":"dubovyi","cleared":false,"url":"/dubovyi","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8625221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @dubovyi,\n\nExactly what is needed. A whitelisting of the file extensions that should be allowed.\n\nThanks,\nDipmalya","automated_response":false,"created_at":"2020-07-17T05:49:12.869Z","updated_at":"2020-07-17T05:49:12.869Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8625421,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@ant_pyne thanks for the report! We have configured restrict attachment types at Intercom.","automated_response":false,"created_at":"2020-07-17T06:32:07.009Z","updated_at":"2020-07-17T06:32:07.009Z","actor":{"username":"maxvoloshin","cleared":false,"url":"/maxvoloshin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ant_pyne","url":"/ant_pyne"},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8625435,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you.. Disclosure?","automated_response":false,"created_at":"2020-07-17T06:35:28.939Z","updated_at":"2020-07-17T06:35:28.939Z","first_to_agree":true,"actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8639277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, this has not been solved? Should I provide a separate report as I can still upload html files and dmg executables.","automated_response":false,"created_at":"2020-07-18T08:04:38.657Z","updated_at":"2020-07-18T08:04:38.657Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There????","automated_response":false,"created_at":"2020-07-20T08:21:17.328Z","updated_at":"2020-07-20T08:21:17.328Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ant_pyne Intercom allows uploading files of all types but restricts an ability to download them (screenshot is attached).","automated_response":false,"created_at":"2020-07-20T09:07:35.275Z","updated_at":"2020-07-20T09:07:35.275Z","actor":{"username":"maxvoloshin","cleared":false,"url":"/maxvoloshin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":913779,"filename":"Screenshot_2020-07-20_at_12.04.16.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AHFDL9WrYM2GNbF9e1gfFtx2?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-07-20_at_12.04.16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-07-20_at_12.04.16.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154255Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=edd93927761ce6ec1b816ddef302edd5b1717e043550c88265c89d64633e07c1"}],"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8948278,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-16T06:35:33.768Z","updated_at":"2020-08-16T06:35:33.768Z","actor":{"url":"/owox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"OWOX, Inc."}},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}