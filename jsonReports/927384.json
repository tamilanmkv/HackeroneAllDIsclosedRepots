{"id":927384,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjczODQ=","url":"https://hackerone.com/reports/927384","title":"Race Condition when following a user","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-07-19T15:48:42.399Z","submitted_at":"2020-07-19T15:48:42.399Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugra","url":"/bugra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/343/105/470c1fd0c4915f1fa9e9376053d0c1ba8af260b7_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":45900,"url":"https://hackerone.com/stagingdoteverydotorg","handle":"stagingdoteverydotorg","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Staging.every.org","twitter_handle":"everydotorg","website":"https://staging.every.org","about":"At https://staging.every.org, you can help improve security for a 501(c)(3) tech nonprofit with the mission to connect givers and nonprofits."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-09T05:51:17.666Z","bug_reporter_agreed_on_going_public_at":"2020-09-07T14:59:05.355Z","team_member_agreed_on_going_public_at":"2020-09-09T05:51:17.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi team,\nThere is a race condition vulnerability when following a user. If you send the `Follow` requests asynchronously, you can follow a user multiple times instead getting an error message.\nI've been using Turbo Intruder extension at Burp Suite for trying Race Condition attacks. I can recommend it for reproduce this vulnerability.\n\n## Steps To Reproduce:\n\n  1. Go to any user's profile\n  1. Turn on Intercept at Burp Suite and click `Follow` button\n  1. Right click to follow request, click `Send to turbo intruder` and drop the request\n  1. Add a fake header that contains `%s` value. Like `Test: %s `\n  1. Paste this Python code to Turbo Intruder :\n       ```python\ndef queueRequests(target, wordlists):\n        engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=30,\n                           requestsPerConnection=100,\n                           pipeline=False\n                           )\n\n        for i in range(30):\n            engine.queue(target.req, str(i), gate='race1')\n\n        engine.openGate('race1')\n        engine.complete(timeout=60)\ndef handleResponse(req, interesting):\n        table.add(req)\n       ```\n 5. Click `Attack` button. Turbo Intruder will send 30 requests, check the status codes. If you see multiple responses with `201 Created` status, that means you followed the user multiple times.\n\n## PoC Video :\n{F913171}\n\n## Impact\n\nRace Condition vulnerability allows to following a user multiple times with one account\n\nThanks,\nBugra","weakness":{"id":140,"name":"Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":913171,"file_name":"EveryRaceCondition.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Z7h7jeww3Xirs1yFfVCE3bXV?response-content-disposition=attachment%3B%20filename%3D%22EveryRaceCondition.mp4%22%3B%20filename%2A%3DUTF-8%27%27EveryRaceCondition.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154305Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9567e06dd2955314227590403a56f936a2d5d8699169b2d98f01ff859d7e1b6c","file_size":4812778,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":89,"voters":["s3asarv3sh","pyrrhon","ltidi","mashoud1122","base_64","mirhat","prophet","bibekshah","realtess","taaminz","and 79 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":42365,"asset_type":"URL","asset_identifier":"staging.every.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8646869,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Reported to engineering team, thank you for helping keep nonprofits more secure!","automated_response":false,"created_at":"2020-07-19T18:41:46.539Z","updated_at":"2020-07-19T18:41:46.539Z","actor":{"username":"mu_yp51u","cleared":false,"url":"/mu_yp51u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8646900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect! Let me know if you need more information or anything to help :)","automated_response":false,"created_at":"2020-07-19T19:00:10.918Z","updated_at":"2020-07-19T19:00:10.918Z","actor":{"username":"bugra","cleared":true,"url":"/bugra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/343/105/470c1fd0c4915f1fa9e9376053d0c1ba8af260b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9152488,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mu_yp51u, I checked the bug and it looks fixed. Is there any update from engineering team?","automated_response":false,"created_at":"2020-09-07T12:34:42.856Z","updated_at":"2020-09-07T12:34:42.856Z","actor":{"username":"bugra","cleared":true,"url":"/bugra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/343/105/470c1fd0c4915f1fa9e9376053d0c1ba8af260b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9153058,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Indeed, we made it idempotent so it should be fine now. Thank you for the report and for checking that it's fixed - these reports go a long way to protecting the privacy of donors and nonprofits!","automated_response":false,"created_at":"2020-09-07T13:58:10.421Z","updated_at":"2020-09-07T13:58:10.421Z","actor":{"username":"osdiab","cleared":false,"url":"/osdiab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bugra","url":"/bugra"},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9153776,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@osdiab Perfect! Thanks for your quick response. Can we disclose this report?","automated_response":false,"created_at":"2020-09-07T14:59:05.375Z","updated_at":"2020-09-07T14:59:05.375Z","first_to_agree":true,"actor":{"username":"bugra","cleared":true,"url":"/bugra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/343/105/470c1fd0c4915f1fa9e9376053d0c1ba8af260b7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9165990,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-09T05:51:17.599Z","updated_at":"2020-09-09T05:51:17.599Z","actor":{"username":"osdiab","cleared":false,"url":"/osdiab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9165991,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-09T05:51:17.694Z","updated_at":"2020-09-09T05:51:17.694Z","actor":{"username":"osdiab","cleared":false,"url":"/osdiab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}