{"id":93394,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MzM5NA==","url":"https://hackerone.com/reports/93394","title":"Unauthenticated access to details of hidden products in any shop via title emuneration","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-12T03:49:19.322Z","submitted_at":"2015-10-12T03:49:19.322Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"juhhga","url":"/juhhga","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-10-23T20:08:47.691Z","bug_reporter_agreed_on_going_public_at":"2015-10-23T20:08:47.543Z","team_member_agreed_on_going_public_at":"2015-10-23T19:45:16.488Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This issue allows external unauthenticated attacker to bypass password protection of currently unopened (\"Opening Soon\" stage) stores and obtain full description of products considering they know/enumerate the title of the product and the product has been published. It could be used to obtain commercially sensitive information, such as retail prices of new products, and be used by competitor stores.\n\nReproduction:\n1. Browse to the following URL and see that the shop is password-protected http://sdfg674567.myshopify.com/\n2. Browse to http://sdfg674567.myshopify.com/tee.json?channel=buy_button\nand see the description of an item with title 'tee' which otherwise should not be accessible:\n\n{\"product\":{\"id\":3019937283,\"title\":\"tee\",\"body_html\":\"\\u003cp\\u003eThis is a hidden super secret Tee at an awesome price that will be published next year.\\u003c\\/p\\u003e\\n\\u003cp\\u003eYou should not be able to see it via:\\u003c\\/p\\u003e\\n\\u003cp\\u003ehttp:\\/\\/sdfg674567.myshopify.com\\/products\\/tee\\u003c\\/p\\u003e\",\"vendor\":\"sdfg674567\",\"product_type\":\"\",\"created_at\":\"2015-10-08T18:48:58-04:00\",\"handle\":\"tee\",\"updated_at\":\"2015-10-11T23:45:36-04:00\",\"published_at\":\"2015-10-11T23:44:00-04:00\",\"template_suffix\":null,\"published_scope\":\"global\",\"tags\":\"\",\"variants\":[{\"id\":8803442371,\"product_id\":3019937283,\"title\":\"Default Title\",\"price\":\"11.00\",\"sku\":\"\",\"position\":1,\"grams\":0,\"inventory_policy\":\"deny\",\"compare_at_price\":null,\"fulfillment_service\":\"manual\",\"inventory_management\":null,\"option1\":\"Default Title\",\"option2\":null,\"option3\":null,\"created_at\":\"2015-10-08T18:48:58-04:00\",\"updated_at\":\"2015-10-08T23:30:52-04:00\",\"requires_shipping\":true,\"taxable\":true,\"barcode\":\"\",\"inventory_quantity\":-124,\"old_inventory_quantity\":-124,\"image_id\":null,\"weight\":0.0,\"weight_unit\":\"kg\"}],\"options\":[{\"id\":3641130243,\"product_id\":3019937283,\"name\":\"Title\",\"position\":1,\"values\":[\"Default Title\"]}],\"images\":[],\"image\":null}}\n\n3. Note that access to https://dslfkgjskldjfgsd.myshopify.com/products/tee.json or https://dslfkgjskldjfgsd.myshopify.com/products/tee/ is closed.\n\nThis type of request with the \"channel=buy_button\" parameter in the URL is made when a Buy Button widget is added to the shop and an admin browses products to create a button for.\n\nRecommendation:\nEnsure that proper authentication and authorization checks are performed for the affected request.\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-22T19:45:16.614Z","allow_singular_disclosure_after":-185745485.0378813,"singular_disclosure_allowed":true,"vote_count":1,"voters":["michiel"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":617075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2015-10-12T03:49:19.685Z","updated_at":"2015-10-12T03:49:19.685Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":617109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A small addition: admin of the victim's shop needs to be authenticated at the time of reproduction or some limited time needs to pass after they log out. \n\nThis vector also works:\nhttp://sdfg674567.myshopify.com/products/tee.json?channel=facebook\n\nAnd please treat https://dslfkgjskldjfgsd.myshopify.com/products/tee.json  and https://dslfkgjskldjfgsd.myshopify.com/products/tee/  links in the description as \n https://sdfg674567.myshopify.com/products/tee/  and https://sdfg674567.myshopify.com/products/tee/  respectively. Sorry foe that confusion I just wanted to submit this issue ASAP.","automated_response":false,"created_at":"2015-10-12T05:06:00.963Z","updated_at":"2015-10-12T05:06:00.963Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":618036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, now I can reproduce without an admin being logged in...\n\nThese requests should work:\n\nGET /products/tee.json?channel=facebook HTTP/1.1\nHost: sdfg674567.myshopify.com\nContent-Length: 6\n\n\nGET /products/tee-1.json?channel=facebook HTTP/1.1\nHost: sdfg674567.myshopify.com\nContent-Length: 6\n\n\n\n\n\n\n\n\n\n","automated_response":false,"created_at":"2015-10-12T19:04:26.637Z","updated_at":"2015-10-12T19:04:26.637Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":618126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found another vector with a higher impact, as there's no need to enumerate titles of products. Decided not to publish a duplicate issue. \n\nThis one allows unauthenticated access to products in a \"Coming soon\" password protected shop via one request, for the products that are set to be published via one of the sale channels. \n\nPoC:\n\nGET /products.json?channel=pos HTTP/1.1\nHost: dslfkgjskldjfgsd.myshopify.com\nContent-Length: 6\n\nThis request will retrieve all the products which were published on a password protected store for the Point of Sale channel. You can also try \"channel=facebook\" or \"channel=pinterest\" other channels, and if a product was published using one of them it will appear in the response. Note, that sales channels need only to be added to the shop by an admin and they may not be configured properly, so the information leaked about the products may not be actually published anywhere.","automated_response":false,"created_at":"2015-10-12T20:08:53.224Z","updated_at":"2015-10-12T20:14:02.647Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":620335,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I reproduced this issue and I agree that it is a problem. I opened an issue and our engineering team will look into this. \n\nI'll keep you updated with any new information as soon as it becomes available.","automated_response":false,"created_at":"2015-10-14T14:01:12.225Z","updated_at":"2015-10-14T14:01:12.225Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":629876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @juhhga,\n\nI consulted with the engineering team internally and they clarified an important point. The password-protection feature is not meant to prevent all products from being accessible. The password protection only apply to the Online Store channel, so the Buy button channel will continue to work even when the online store is password-protected.\n\nHowever there were a few different issues that we've fixed due to your report.\n\nFirst, some channels are not meant to be visible through the storefront API. For example, products visible through the Point of Sale channel should not have been visible on the storefront API. However this is not the case of the Buy Button channel, which is meant to be visible through the API. Products visible to the Buy Button channel are meant to be published online on other websites, so protecting the online store with a password will not affect the Buy Buttons published elsewhere.\n\nSecond, we discovered an issue where products would be visible through `/products.json?channel=buy_button` even though the Buy Button channel was removed from the store. This was obviously unintentional, so we've fixed this issue as well. Now when a channel is removed, products published to the channel will no longer be visible.","automated_response":false,"created_at":"2015-10-23T18:02:56.754Z","updated_at":"2015-10-23T18:02:56.754Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":629877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can expect to hear back shortly regarding our decision for the bounty.","automated_response":false,"created_at":"2015-10-23T18:03:28.237Z","updated_at":"2015-10-23T18:03:28.237Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":630122,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","automated_response":false,"created_at":"2015-10-23T19:45:04.484Z","updated_at":"2015-10-23T19:45:04.484Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"juhhga","url":"/juhhga"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":630123,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-10-23T19:45:11.027Z","updated_at":"2015-10-23T19:45:11.027Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"juhhga","url":"/juhhga"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":630124,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-10-23T19:45:16.509Z","updated_at":"2015-10-23T19:45:16.509Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":630180,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great stuff, thanks for the bounty!","automated_response":false,"created_at":"2015-10-23T20:08:47.567Z","updated_at":"2015-10-23T20:08:47.567Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":630181,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-10-23T20:08:47.712Z","updated_at":"2015-10-23T20:08:47.712Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}