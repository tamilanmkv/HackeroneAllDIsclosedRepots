{"id":951623,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTE2MjM=","url":"https://hackerone.com/reports/951623","title":"Vulnerabilities in Endorsement Mechanism of Private Data Related Transactions in Hyperledger Fabric 2.0","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2020-08-05T14:09:07.129Z","submitted_at":"2020-08-05T14:09:07.148Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"swang1994","url":"/swang1994","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22522,"url":"https://hackerone.com/hyperledger","handle":"hyperledger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/522/14a496059824de0648d5d65966e9ab4dd8c8e715_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/522/14a496059824de0648d5d65966e9ab4dd8c8e715_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Hyperledger","twitter_handle":"hyperledger","website":"https://www.hyperledger.org/","about":"An industry-wide open source initiative to advance blockchain technology, governed by The Linux Foundation."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-03-30T20:29:49.355Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-03-30T18:21:14.842Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"To whom it may concern,\n\nWe report design flaws that can be exploited by private data collection non-member organizations to forge endorsements of read-related transactions and return fake values to a user.  \n\nWhen a user issues a read-only transaction proposal to a endorser in the private data collection, if the user has the privilege to read private data, the endorser returns a read set storing \u003ckey, version\u003e and a null write set. The value of the key is returned in the \"payload\" field of the transaction. \n\nWhen the user issues a read-only transaction proposal to an endorser which is not a member of private data collection, the \u003ckey, version\u003e and the value can not be found in the endorser's world state. Therefore, a private data collection non-member endorser cannot endorse such read-related transactions.\n\nHowever, we find a malicious private data non-member endorser can endorse a read-only transaction proposal for private data and pass the validation by all peers if this non-member endorser colludes with other endorsers, which can be either a private data collection member or non-member endorsers. These malicious endorsers can just return the same read set and payload, which can collaboratively fabricated by these malicious endorsers. Since the validation process does not check if the endorsers have the private data, the transaction will be written into the ledger as valid. \n\nThe damage of this attack is the malicious endorsers can return fake values to the user.\n\nPlease let me know if you have any questions or concerns. If you think it is necessary, we can give you a briefing on the issues. Look forward to your reply!\n\nBest Regards,\n\nShan Wang, Southeast University (Email: shanwang1994@gmail.com)\nYue Zhang, Jinan University\nXinwen Fu, University of Massachusetts, Lowell\n\n## Impact\n\nThe damage of this attack is the malicious endorsers can return fake values to the user.","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["khizer47","ekgaribadmi"],"structured_scope":{"databaseId":2994,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/hyperledger/fabric","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9639158,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi,\nThis is as designed.\nRy","automated_response":false,"created_at":"2020-10-26T17:43:41.371Z","updated_at":"2020-10-26T17:43:41.371Z","actor":{"username":"ryjones","cleared":false,"url":"/ryjones","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/190/898/16fe922a06ceb4649331e21bb3e89674e236554b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11100437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Correct, this is as designed. You need to set a strong enough endorsement policy to withstand a set of colluders.\nMore documentation has been added here:\n\nhttps://hyperledger-fabric.readthedocs.io/en/latest/endorsement-policies.html#setting-collection-level-endorsement-policies\n\"You can use collection-level endorsement policies to restrict which organization peers can write to the private data collection key namespace, for example to ensure that non-authorized organizations cannot write to a collection, and to have confidence that any state in a private data collection has been endorsed by the required collection organization(s).\"\n\n\"If you do not specify a collection-level endorsement policy, the chaincode-level endorsement policy will be applied to protect writes to a private data collection key namespace. This may be desirable if a set of organizations meeting the chaincode-level endorsement policy are authorized to create data in other organizationâ€™s private data collection. For example if those organizations are trusted to process transactions but are not authorized to store and later query private data due to industry privacy regulations, or if the private data is being shared or transferred from one set of organizations to another through the use of private data collections. In other scenarios, the private data collection members may need to be in full control of writes to the private data collection, in which case a collection-level endorsement policy should be provided.\"","automated_response":false,"created_at":"2021-03-24T05:32:50.366Z","updated_at":"2021-03-24T05:32:50.366Z","actor":{"username":"denyeart","cleared":false,"url":"/denyeart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11105576,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2021-03-24T14:23:51.817Z","updated_at":"2021-03-24T14:23:51.817Z","actor":{"username":"swang1994","cleared":false,"url":"/swang1994","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"email":"xi**************om","genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11105981,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2021-03-24T14:59:18.674Z","updated_at":"2021-03-24T14:59:18.674Z","actor":{"username":"xinwenfu","cleared":false,"url":"/xinwenfu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11187307,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-30T18:21:14.861Z","updated_at":"2021-03-30T18:21:14.861Z","first_to_agree":true,"actor":{"username":"ryjones","cleared":false,"url":"/ryjones","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/190/898/16fe922a06ceb4649331e21bb3e89674e236554b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11189931,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2021-03-30T20:29:49.274Z","updated_at":"2021-03-30T20:29:49.274Z","actor":{"username":"denyeart","cleared":false,"url":"/denyeart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"hyperledger","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}