{"id":9560,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTYw","url":"https://hackerone.com/reports/9560","title":"Security issue with your \"bag\" script","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-24T15:05:22.708Z","submitted_at":"2014-04-24T15:05:22.708Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"peterjaric","url":"/peterjaric","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-05-07T14:11:01.245Z","bug_reporter_agreed_on_going_public_at":"2014-05-07T14:11:01.076Z","team_member_agreed_on_going_public_at":"2014-05-07T14:01:55.598Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This is an old issue that has been fixed, but in since I reported it before you started your Bug Bounty program I was advised to report it here again.\r\n\r\nThese are the requests in your issue tracker:\r\n* http://support.cloudflare.com/tickets/44767 (original vulnerability report)\r\n* http://support.cloudflare.com/hc/requests/58556 (follow up)\r\n* http://support.cloudflare.com/hc/requests/107974 (request where I was advised to report here)\r\n\r\nThe original text of the vulnerability report:\r\n--------------------------------------------------------------\r\n\r\nHi,\r\n\r\nSome days ago I submitted a vulnerability report to a site that I think is one of your customers. I don't want to disclose their name at the moment as I am not sure they are OK with that. They might have been in contact with you already, since the problem seems to be with functionality you provide.\r\n\r\nURL:\r\n1) http://cloudflare.com/cdn-cgi/pe/bag?r[]=http%3A%2F%2Fgoogle.com\r\n2) http://cloudflare.com/cdn-cgi/pe/bag?r[]=http%3A%2F%2Fyahoo.com\r\n\r\nDescription:\r\nWhen these URL is accessed, your server nicely gets the page in the r[] parameter and returns it in the response. Multiple instances of r[] in the same URL is also possible.\r\n\r\nThis could be exploited by someone who wants to access another URL, but anonymously (except for your logs of course), or to access pages \"in your name\", making you look bad.\r\n\r\nIt could also be exploited in another, more serious way. If you happen to have any internal web servers that are not visible to the internet (for example a bug tracker), they might be visible to the computer hosting cloudflare.com. Then this vuln could be used to fetch files from the internal servers (given that the attacker knows the URLs or brute forces them).\r\n\r\nA search on Google for this type of URL shows that many sites has the same problem. I don't know if you can fix it in one place or if you have to roll it out to all these sites.\r\n\r\nIf you have any questions, please let me know.\r\n\r\nPeter Jaric\r\n@peterjaric ","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-24T22:05:40.878Z","allow_singular_disclosure_after":-232997975.58813334,"singular_disclosure_allowed":true,"vote_count":1,"voters":["cryptographer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":38340,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2014-04-24T22:04:23.788Z","updated_at":"2014-04-24T22:04:23.788Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":38343,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for submitting this vulnerability to us. We greatly appreciate your participation.","automated_response":false,"created_at":"2014-04-24T22:05:40.910Z","updated_at":"2014-04-24T22:05:40.910Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"peterjaric","url":"/peterjaric"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45920,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-05-07T14:01:55.614Z","updated_at":"2014-05-07T14:01:55.614Z","first_to_agree":true,"actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45927,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-05-07T14:11:01.094Z","updated_at":"2014-05-07T14:11:01.094Z","actor":{"username":"peterjaric","cleared":false,"url":"/peterjaric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45928,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-05-07T14:11:01.259Z","updated_at":"2014-05-07T14:11:01.259Z","actor":{"username":"peterjaric","cleared":false,"url":"/peterjaric","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103201,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We apologize for the delay in reward fulfillment, but look out for an email requesting your shirt size, address, and other information needed for fulfillment next week. Thank you.","automated_response":false,"created_at":"2014-08-08T17:17:22.295Z","updated_at":"2014-08-08T17:17:22.295Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}