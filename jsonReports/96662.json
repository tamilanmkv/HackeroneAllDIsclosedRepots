{"id":96662,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjY2Mg==","url":"https://hackerone.com/reports/96662","title":"crossdomain.xml too permissive on eu1.badoo.com, us1.badoo.com, etc.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-29T23:54:41.876Z","submitted_at":"2015-10-29T23:54:41.876Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21554,"url":"https://hackerone.com/bumble","handle":"bumble","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bumble","twitter_handle":"bumble","website":"https://bumble.com/","about":"Bumble - Date, Meet, Network Better"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-31T10:20:34.330Z","bug_reporter_agreed_on_going_public_at":"2017-08-01T10:20:24.040Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Description__\n\nThe file _crossdomain.xml_ that is hosted at https://[eu1,us1,etc].badoo.com/crossdomain.xml is too permissive in the scope of allowed domains to access the content in the domain using Flash.\nWhen you contact Badoo via https://us1.badoo.com/feedback/, you can upload a file. This file can be a Flash file. This file is hosted at https://static-*.badoo.com which is an allowed domain because of the line `\u003callow-access-from domain=\"*.badoo.com\"/\u003e` in the _crossdomain.xml_ file.\nThe problem is that an attacker can upload a malicious Flash file and load it from an external website. This allows to read and update information of the current logged in user.\n\n__Proof of concept__\n\n1. Download the file _bug.jpg_ that I attached (the source code is attached too).\n2. Go to https://us1.badoo.com/feedback/.\n3. Click on _General question_.\n4. Fill the required fields.\n5. Click _Attach screenshot_.\n6. Select the file you downloaded in step 1 and click _Open_.\n7. When the upload is finished, click _Send message_.\n8. Go to the inbox of the email address that you entered for _Email address_.\n9. Open the email with the subject \"We've received your query\", sent by Badoo Support Team.\n10. Click on the link that appears (like: https://us1.badoo.com/support.phtml?rid=11761766:noX7xh7DgCDiU80B).\n11. Click on the name of the file that you uploaded (_bug.jpg_). Appears below the message you wrote.\n12. Right click on the black box that is shown, and find the `\u003cimg alt=\"\" class=\"pv-big\" id=\"big_photo\"\u003e` element.\n13. Save the `src` value of the element (it looks like https://static-us2.badoo.com/file/36140042.0?signature=41918aa731579d62a601d6391ac793f1\u0026amp;dt=9tKskfyuTrlkjvLg).\n14. Download the file _bug.html_ that I attached.\n15. Open the file _bug.html_ in a text editor. Change the value of the attribute `src` of the element `\u003cembed\u003e` to the value that you saved in step 13.\n16. Serve the file _bug.html_ from a server (can be local, like `php -S 0.0.0.0:8000`).\n17. Verify that you are logged in Badoo.\n18. Open the file _bug.html_ from the server using the web browser (like http://localhost:8000/bug.html).\n19. The content of the endpoint https://us1.badoo.com/settings is showed in the `\u003ctextarea\u003e`.\n\nThis is a simple proof of concept, but it's possible to make POST requests too.\n\nLet me know if something is not well explained.","bounty_amount":"310.0","formatted_bounty":"$310","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":59462,"file_name":"bug.as","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/462/9ebea60de1d1cad87599bb14df2729238066675c/bug.as?response-content-disposition=attachment%3B%20filename%3D%22bug.as%22%3B%20filename%2A%3DUTF-8%27%27bug.as\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154632Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fe203d5e3901400486b71db843225ad8c2686475566e01d19e458778676cd760","file_size":1153,"type":"text/x-java"},{"id":59463,"file_name":"bug.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/463/f506c240ed03a3df50dd07ea90eca9efab0a8894/bug.jpg?response-content-disposition=attachment%3B%20filename%3D%22bug.jpg%22%3B%20filename%2A%3DUTF-8%27%27bug.jpg\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154632Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3240d6bf89930258bccbfc19eec93fe6e6debab8a3b33d5963b4ed46f5ed3350","file_size":1597,"type":"application/x-shockwave-flash"},{"id":59464,"file_name":"bug.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/464/b8e3fad124eb9243b0f799c8fdddc6da8e95d7c6/bug.html?response-content-disposition=attachment%3B%20filename%3D%22bug.html%22%3B%20filename%2A%3DUTF-8%27%27bug.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154632Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=713b9d7a54ec1ed6f3c53567d280fb3ce7632b97480f05413b037f9d294999d3","file_size":508,"type":"text/html"}],"allow_singular_disclosure_at":"2017-08-31T10:20:24.130Z","allow_singular_disclosure_after":-129792368.56419733,"singular_disclosure_allowed":true,"vote_count":14,"voters":["flamezzz","thaivu","mashoud1122","bogdantcaciuc","michan","eveeez","malcolmx","sumit7","hacklad","klau5","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":642299,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-11-03T08:21:18.756Z","updated_at":"2015-11-03T08:21:18.756Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642312,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @esevece!\nThank you very much for such clear and detailed report! We've decided to assign a 2nd category to this vulnerability, and reward you with a £200, which is a bit less than $310.\nWe hope that you will continue testing of our projects to help us make them more secure! ","automated_response":false,"created_at":"2015-11-03T08:27:37.498Z","updated_at":"2015-11-03T08:28:01.228Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bumble"}},"bounty_amount":"310.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"bumble","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @iyakovlev!\nThank you for the reward! I'm glad the report was clear and you were able to reproduce the proof of concept.\nI will keep testing. :)","automated_response":false,"created_at":"2015-11-03T08:35:59.818Z","updated_at":"2015-11-03T08:35:59.818Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":834862,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Report is completely resolved, thanks.\n","automated_response":false,"created_at":"2016-03-11T10:46:35.190Z","updated_at":"2016-03-11T10:46:35.190Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":835261,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect!","automated_response":false,"created_at":"2016-03-11T15:49:20.937Z","updated_at":"2016-03-11T15:49:20.937Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881884,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I would like to disclose this report if you agree.","automated_response":false,"created_at":"2017-08-01T10:20:24.087Z","updated_at":"2017-08-01T10:20:24.087Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968360,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-31T10:20:34.364Z","updated_at":"2017-08-31T10:20:34.364Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bumble"}},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}