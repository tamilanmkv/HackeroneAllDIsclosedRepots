{"id":979820,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85Nzk4MjA=","url":"https://hackerone.com/reports/979820","title":"Rate limits too low for email 2FA","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-09-11T14:34:10.398Z","submitted_at":"2020-09-11T14:34:10.459Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akashhamal0x01","url":"/akashhamal0x01","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21024,"url":"https://hackerone.com/bitwarden","handle":"bitwarden","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bitwarden","twitter_handle":"bitwarden","website":"https://bitwarden.com","about":"Open source password management solutions for individuals, teams, and business organizations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-14T18:18:31.415Z","bug_reporter_agreed_on_going_public_at":"2020-09-14T18:18:25.990Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"NO RATE LIMIT ON 2FA CAN LEAD TO ACCOUNT COMPROMISE!\n\n1. Create account on vault.bitwarden.com  if you don't have.\n2.Setup 2FA via email \n3.Logout and log in again. This time along with password you have to fill the 2fa code which is sent to the email.\n4.Type Any Random number, intercept request with burp  then send to intruder, mark the code position and start bruteforcing\n\nResults:\n\n\u003e\u003eInvalid Code Response = 400 \n\u003e\u003eValid Code Response = 200\n\n## Impact\n\n2FA acts as extra security. Even if the attacker has user credentials 2FA always protects them from accessing the user data and compromise their whole account.\nIf the 2FA can be bruteforced it can lead to account compromise assuming that attacker already knows email and password!","weakness":{"id":31,"name":"Brute Force"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-10-14T18:18:26.049Z","allow_singular_disclosure_after":-31267774.064411826,"singular_disclosure_allowed":true,"vote_count":7,"voters":["drsniper","prophet","3x3s","akashhamal0x01","exception","artkulak","mrgxhunterr"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":772,"asset_type":"URL","asset_identifier":"vault.bitwarden.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9193796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eIgnore 429 responses too . Just look for 200  responses\n\nRegards,\n\nAkash Hamal","automated_response":false,"created_at":"2020-09-11T14:50:08.399Z","updated_at":"2020-09-11T14:50:08.399Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9199895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team, set a margin between 1k range i.e check the 2fa from mail and implement bruteforce in such a way that right code falls at 1k attempt of bruteforcing as this is the solid proof that 1k requests are sent and there is misconfigured rate limit! Even if you get 429 Too Many Requests just wait for right code to arrive as it will have 200 response.!","automated_response":false,"created_at":"2020-09-12T05:44:29.312Z","updated_at":"2020-09-12T05:44:29.312Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9205843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you are unable to reproduce let me know, i will help you!","automated_response":false,"created_at":"2020-09-13T07:45:07.776Z","updated_at":"2020-09-13T07:45:07.776Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9214219,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nThanks for the report. We have rate limiting built into this endpoint, which is why you are seeing 429 repsonses.","automated_response":false,"created_at":"2020-09-14T12:39:20.794Z","updated_at":"2020-09-14T12:39:20.794Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9215313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have adjusted the rate limiter to be a bit more aggressive. I am not sure if this is what you are looking for. Can you confirm?","automated_response":false,"created_at":"2020-09-14T14:17:43.346Z","updated_at":"2020-09-14T14:17:43.346Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9215917,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So see the rate limiter is misconfigured because after sometime of 429 responses it will also give 400 BAD request indicating the code is wrong and there is a chance that the right code can be hit by the attacker! Just give me a an hour i will check it!","automated_response":false,"created_at":"2020-09-14T14:47:36.389Z","updated_at":"2020-09-14T14:47:36.389Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9215932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That is how the rate limiter works. You won't get 429 responses forever.","automated_response":false,"created_at":"2020-09-14T14:48:51.794Z","updated_at":"2020-09-14T14:48:51.794Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9215976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't mean forever, it's about the bruteforcing same 2fa code again and again.I hit the right code at 1k request of bruteforcing and it confirms there is misconfigured rate limit as you can also check that on sites like facebook, twitter, etc , the rate limit is configured properly! There is something misconfigured and i believe that right code can be hit by the attacker!","automated_response":false,"created_at":"2020-09-14T14:52:47.636Z","updated_at":"2020-09-14T14:52:47.636Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9216019,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"u can test on fb and twitter as their system gives new code after too many retries where as your system gives 400 after some 429 . And the fact here to notice is that new 2fa code is not sent so it can be bruteforced. I mean same code ","automated_response":false,"created_at":"2020-09-14T14:56:23.655Z","updated_at":"2020-09-14T14:56:23.655Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9216076,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please change report title to Misconfigured 2FA\n","automated_response":false,"created_at":"2020-09-14T15:03:54.040Z","updated_at":"2020-09-14T15:03:54.040Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9216984,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Team ,i have an update here. Looks like after you made the rate limit bit more progressive it's giving 429 for remaining requests good work! :)","automated_response":false,"created_at":"2020-09-14T16:14:43.377Z","updated_at":"2020-09-14T16:14:43.377Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9216987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"bit more aggressive*","automated_response":false,"created_at":"2020-09-14T16:15:07.612Z","updated_at":"2020-09-14T16:15:07.612Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9219322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"please change report title to one which i specified and resolve the report as the problem has now been resolved as you have adjusted rate limiter to be a bit more aggressive and i believe the bug is now not reproducible.\n\nRegards,\nAkash Hamal","automated_response":false,"created_at":"2020-09-14T18:08:10.603Z","updated_at":"2020-09-14T18:08:10.603Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9219333,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-09-14T18:09:33.145Z","updated_at":"2020-09-14T18:09:33.145Z","additional_data":{"old_title":"2FA BRUTEFORCABLE - NO RATE LIMIT","new_title":"Rate limits too low for email 2FA"},"actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9219345,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-09-14T18:10:04.537Z","updated_at":"2020-09-14T18:10:04.537Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"akashhamal0x01","url":"/akashhamal0x01"},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9219423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi thanks for resolving but i think you didn't get my point. I can explain you if you didn't understand. Else can we disclose it if you understood my point of view? :)\n\nRegards,\n\nAkash Hamal","automated_response":false,"created_at":"2020-09-14T18:14:58.780Z","updated_at":"2020-09-14T18:14:58.780Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9219466,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we? :)\n\nRegards,\n\nAkash Hamal","automated_response":false,"created_at":"2020-09-14T18:18:26.015Z","updated_at":"2020-09-14T18:18:26.015Z","first_to_agree":true,"actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9219604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kspearrin \nHypotheses: \n\nBefore improving rate limit, while bruteforcing a range of 2fa codes containing 1 right code, the application responded with 400 response indicating the code was incorrect. After bruteforcing some 2fa codes it now starts to give some 429 responses i.e too many requests and it means that the request was rejected and code wasn't even check if it was right or wrong so 429 responses can't be used to analyze if the code was wrong or not. But after some 429 responses the application again starts testing remaining codes and throws 400 responses and this step continues till our list of bruteforcing 2fa ends. And the conclusion here is that there is a chance of falling right code after  series of 429 responses .  \u003c=THIS HYPOTHESIS IS ENOUGH FOR PROOF\n\nRegards,\n\nAkash Hamal","automated_response":false,"created_at":"2020-09-14T18:37:04.405Z","updated_at":"2020-09-14T18:37:04.405Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9225352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kspearrin  any update on disclosure?","automated_response":false,"created_at":"2020-09-15T11:12:23.485Z","updated_at":"2020-09-15T11:12:23.485Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9235137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team any update on disclosure?\n","automated_response":false,"created_at":"2020-09-16T09:52:21.964Z","updated_at":"2020-09-16T09:52:21.964Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9524323,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-14T18:18:31.443Z","updated_at":"2020-10-14T18:18:31.443Z","actor":{"url":"/bitwarden","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bitwarden"}},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9524418,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team, the report has been disclosed and i know your program is public but since its disclosed it should be visible on hacktivity section but i can't see my report there","automated_response":false,"created_at":"2020-10-14T18:31:55.679Z","updated_at":"2020-10-14T18:31:55.679Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}