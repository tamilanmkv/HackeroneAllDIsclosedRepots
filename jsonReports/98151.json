{"id":98151,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODE1MQ==","url":"https://hackerone.com/reports/98151","title":"Non-owner user can remove online store channel and re-add it.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-05T21:40:10.826Z","submitted_at":"2015-11-05T21:40:10.826Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-03T17:35:29.320Z","bug_reporter_agreed_on_going_public_at":"2015-12-03T17:28:31.719Z","team_member_agreed_on_going_public_at":"2015-12-03T17:35:29.133Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found an issue that allows a non-owner user with full access permissions or access to /channels  to remove the online store channel while only the store owner can remove it!\n\n#Steps to reproduce:\n1. Login with a non-owner user who has full access permissions\n2. Send this request: \n\n```\nPOST /admin/channels/\u003cOnline_store_channel_id\u003e HTTP/1.1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nOrigin: https://\u003cyour_shop\u003e.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.8\nCookie: \u003cStaff_Member_cookies\u003e\n\n_method=delete\u0026authenticity_token=\u003cYour_token\u003e\n```\n\nThen go to `*yourstore.myshopify.com/admin/channels` and you'll see that the channel was removed causing an error with the plan.\n\nThe staff member can also re-add the channel by submitting the following form:\n\n```\n\u003cform method=\"post\" action=\"/admin/channels?channel%5Bprovider_id%5D=1\u0026amp;resolve_redirect_url=%2Fadmin%2Fchannels\"\u003e\n\u003cinput type=\"submit\" value=\"Re-add channel\"\u003e\n\u003cinput name=\"authenticity_token\" value=\"\u003cyout_token\u003e\"\u003e\n\u003c/form\u003e\n```\n\nThis is clearly a privilege escalation issue , since when you go to channels with a non-owner account , it says that you have to contact the owner to remove the online store channel which means that only the owner should be able to remove it.\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-01-02T17:28:31.896Z","allow_singular_disclosure_after":-182211579.53587165,"singular_disclosure_allowed":true,"vote_count":1,"voters":["spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":647298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2015-11-05T21:40:11.592Z","updated_at":"2015-11-05T21:40:11.592Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":647312,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a more simple PoC to remove the online store channel: \n1. Get the Channel id \n2. Submit this form through the staff member account with full access permissions.\n\n```\n\u003cform class=\"button_to\" method=\"post\" action=\"https://*yourstore.myshopify.com/admin/channels/\u003cchannel_id\u003e\"\u003e\n\u003cinput name=\"_method\" value=\"delete\"\u003e\n\u003cinput type=\"submit\" value=\"Remove\"\u003e\n\u003cinput name=\"authenticity_token\" value=\"\u003cyour_token\u003e\"\u003e\n\u003c/form\u003e\n```\nand it will show a message saying that the channel was removed from your shop.\nTo verify go to `https://*yourstore.myshopify.com/admin/dashboard/online` and it will show a 404 error , also the channel link will no longer appear in the side menu and you won't be able to add products to it.\n\nThanks","automated_response":false,"created_at":"2015-11-05T21:50:27.783Z","updated_at":"2015-11-05T21:50:27.783Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":647320,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi , I have found that this issue works for users with limited permissions and the staff member shouldn't have full access permissions.\nThe only permission the staff member needs to reproduce this issue is `settings` \nAttached file is a screenshot of the permissions I gave to the user.\n","automated_response":false,"created_at":"2015-11-05T21:58:13.823Z","updated_at":"2015-11-05T21:58:13.823Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":60496,"filename":"shopify_PE.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/060/496/c47a93bc9c0156d7f95e419ccd082472f02907cd/shopify_PE.png?response-content-disposition=attachment%3B%20filename%3D%22shopify_PE.png%22%3B%20filename%2A%3DUTF-8%27%27shopify_PE.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154811Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2bf4f6048de029d0cf0f909881207d40ddd61829cff48f719e7d197da27d06d4"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":651556,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting this issue, I informed our engineering team and we will look into fixing this. \n\nI will keep you informed of any progress as soon as I have more information.","automated_response":false,"created_at":"2015-11-09T19:54:18.398Z","updated_at":"2015-11-09T19:54:18.398Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":693576,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report, we've now resolved this issue.\n\nThe reason this action was only available to the store owner is that it requires a change to the billing plan of the store, and only the account owner is able to change the plan for the store. So the action of removing the channel is not restricted to only the account owner, it is restricted to users who can also make changes to the store's plan, but only if a plan change is required to remove the channel. If no plan change is required, then any user can remove the channel.\n\nWe have fixed this issue by adding a verification that no billing change is required before removing the channel.\n\nYou can expect our next round of decisions regarding a bounty within the next week.","automated_response":false,"created_at":"2015-11-20T21:09:37.446Z","updated_at":"2015-11-20T21:09:37.446Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707359,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thanks for this report. As Francois described, there is no security impact to this issue, so it is not eligible for a reward","automated_response":false,"created_at":"2015-12-03T16:39:33.690Z","updated_at":"2015-12-03T16:39:33.690Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707481,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No worries.\nCan it be publicly disclosed ? ","automated_response":false,"created_at":"2015-12-03T17:28:31.751Z","updated_at":"2015-12-03T17:28:31.751Z","first_to_agree":true,"actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":707488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-03T17:35:29.167Z","updated_at":"2015-12-03T17:35:29.167Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707489,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-12-03T17:35:29.361Z","updated_at":"2015-12-03T17:35:29.361Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1080,"category":"team","content":"An issue where a channel could be removed when the UI interface did not allow the channel to be removed. This discrepency was not a security issue but we added a server side check nonetheless.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":19168,"username":"francoischagnon","name":"Francois Chagnon","bio":"","cleared":false,"website":"","location":"","created_at":"2015-03-19T21:06:55.673Z","url":"https://hackerone.com/francoischagnon","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}