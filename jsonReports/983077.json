{"id":983077,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODMwNzc=","url":"https://hackerone.com/reports/983077","title":"Stored Cross-Site Scripting vulnerability in example Custom Digital Agreement","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-09-16T01:19:49.770Z","submitted_at":"2020-09-16T01:19:49.814Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-18T20:34:26.331Z","bug_reporter_agreed_on_going_public_at":"2021-03-18T20:31:16.327Z","team_member_agreed_on_going_public_at":"2021-03-18T20:34:26.231Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The advanced vetting settings page is vulnerable to a Cross-Site Scripting (XSS) vulnerability by passing the unsanitized Program Name into a Markdown component, which expects sanitized HTML to be given. This leads to a stored XSS vulnerability that can be exploited by a program member when the program is in sandbox mode.\n\n# Proof of concept\n- create a new program, set the name to `\u003cblink\u003e\u003cmarquee\u003e\u003ca href=\"//anything\"\u003eXSS\u003c/a\u003e\u003c/marquee\u003e\u003c/blink\u003e`\n- go to http://localhost:8080/handle/advanced_vetting\n- click the \"View document\" button, which generates an example DCA based on the Program Name\n- the Program Name in the example DCA isn't properly sanitized and is passed directly to the `Markdown` React component, which assumes the HTML is sanitized\n\n{F989452}\n\n## Impact\n\nThe impact is limited due to the fact that the example DCA is only generated when the program is in sandbox mode. It can only be exploited by Program Managers, since only they are authorized to update the Program Name. Programs in sandbox mode do **not** contain real vulnerability data.","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":989452,"file_name":"Screen_Shot_2020-09-15_at_6.18.01_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BWsQgiAA5c1cCkNuUH9UHsAw?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-09-15_at_6.18.01_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-09-15_at_6.18.01_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154819Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f7a82554352e75b8bb894e452149cb2c02a3b8659272499d31a8b03af25880dd","file_size":314561,"type":"image/png"}],"allow_singular_disclosure_at":"2021-04-17T20:31:16.505Z","allow_singular_disclosure_after":-15275823.33935932,"singular_disclosure_allowed":true,"vote_count":22,"voters":["xploiterr","mirhat","0xelkomy","ayoub0x1","mattberg","realtess","ms-13","sodium_","3x3s","f_m","and 12 more..."],"severity":{"rating":"medium","score":5.7,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9232098,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-09-16T01:21:52.248Z","updated_at":"2020-09-16T01:21:52.248Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9232099,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"This was an internal finding and is therefor ineligible for a reward.","automated_response":false,"created_at":"2020-09-16T01:22:02.098Z","updated_at":"2020-09-16T01:27:17.971Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11045583,"is_internal":false,"editable":false,"type":"Activities::BugRetesting","message":"A fix for this vulnerability was released earlier today. Here are the steps that can be used to reproduce / retest the vulnerability:\n\n* create a new program at https://hackerone.com/teams/new/sandbox, set the name of the program to `\u003cmarquee\u003e\u003ca href=\"//anything\"\u003eXSS\u003c/a\u003e\u003c/marquee\u003e`\n* go to `https://hackerone.com/:handle/advanced_vetting`\n* click the \"View document\" button, which generates an example DCA based on the Program Name\n* the Program Name in the example DCA isn't properly sanitized and is passed directly to the Markdown React component, which assumes the HTML is sanitized\n\nThe vulnerability was mitigated by properly rendering the markdown in the frontend instead of manually constructing HTML.","automated_response":false,"created_at":"2021-03-18T20:14:56.755Z","updated_at":"2021-03-18T20:14:57.021Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","report_retest":{"id":4583,"retest_subscription":{"handled_by_triage":false}},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11045676,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2021-03-18T20:22:14.472Z","updated_at":"2021-03-18T20:22:14.472Z","additional_data":{"report_retest_user_id":10603},"actor":{"username":"p4fg","cleared":true,"url":"/p4fg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/295/7023423bdb8cb71d1537e9e1a26263fd387f97a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11045712,"is_internal":false,"editable":false,"type":"Activities::UserCompletedRetest","message":"HTML was properly escaped.","automated_response":false,"created_at":"2021-03-18T20:26:42.974Z","updated_at":"2021-03-18T20:26:42.974Z","actor":{"username":"p4fg","cleared":true,"url":"/p4fg","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/295/7023423bdb8cb71d1537e9e1a26263fd387f97a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11045762,"is_internal":false,"editable":false,"type":"Activities::ReportRetestApproved","message":"Great, thanks @p4fg!","automated_response":false,"created_at":"2021-03-18T20:31:00.193Z","updated_at":"2021-03-18T20:31:00.193Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","report_retest_user":{"user":{"username":"p4fg"},"report_retest":{"retest_subscription":{"tag":"new","handled_by_triage":false,"awarding_retesters":true}}},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11045763,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-03-18T20:31:00.399Z","updated_at":"2021-03-18T20:31:00.399Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11045765,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-18T20:31:16.352Z","updated_at":"2021-03-18T20:31:16.352Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11045782,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-18T20:34:26.250Z","updated_at":"2021-03-18T20:34:26.250Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11045783,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-18T20:34:26.370Z","updated_at":"2021-03-18T20:34:26.370Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}