{"id":985124,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODUxMjQ=","url":"https://hackerone.com/reports/985124","title":"GraphQL Query leads to sensitive information disclosure","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2020-09-18T05:27:28.778Z","submitted_at":"2020-09-18T05:27:28.860Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chroduath","url":"/chroduath","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/MtsrgR8YkGvtGxPH9FViQNz4/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-03-08T11:18:28.535Z","bug_reporter_agreed_on_going_public_at":"2021-03-08T07:22:34.509Z","team_member_agreed_on_going_public_at":"2021-03-08T11:18:28.386Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n### Summary\n\nGraphql Query mentioned below disclosed emails of profiles which are not visible on their public pages in gitlab\n\n\n### Steps to reproduce\n\n1\u003e Go to Gitlab Graphql Explorer (https://gitlab.com/-/graphql-explorer)\n2\u003e  Use the query to fetch the information \n\n    {\n    users {\n    edges {\n      node {\n        username\n        email\n        avatarUrl\n        status {\n          emoji\n          message\n          messageHtml\n         }\n        }\n       }\n      }\n     }\n\n3\u003e Navigate through any of the public profile of the usernames  fetched  with url : https://gitlab.com/username\n4\u003e Email information is not displayed in the public profile while the graphql query fetches it \n\n### Impact\n\nThis can be abused since email address is not publicly visible through gitlab profile. Any person can access user emails and try to hack their accounts using brute-force etc.\n\n### What is the current *bug* behavior?\n\nIt displays sensitive information about the user which is not available in their public profile \n\n### What is the expected *correct* behavior?\n\nit should only display public profile information such as username but not email\n\n### Relevant logs and/or screenshots\n\nScreenshot attached\n\n## Impact\n\nThis can be abused since email address is not publicly visible through gitlab profile. Any person can access user emails and try to hack their accounts using brute-force etc","weakness":{"id":46,"name":"Privacy Violation"},"original_report_id":972355,"original_report_url":"https://hackerone.com/reports/972355","attachments":[],"allow_singular_disclosure_at":null,"vote_count":12,"voters":["salahhasoneh","chroduath","bskousen","dapopem","wilgert","d3dezio","fbn","xerainaaa","itsrandomboy77","meispi","and 2 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9255230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reproducible: My report contains clear, concise steps to reproduce the vulnerability. (Yes i have given steps to reproduce)\nImpact: My report describes exactly what outcome an attacker would reasonably achieve. (Yes i have provided the impact)\nIn Scope: I have carefully reviewed the GitLab security page (Yes)","automated_response":false,"created_at":"2020-09-18T10:39:05.951Z","updated_at":"2020-09-18T10:39:05.951Z","actor":{"username":"chroduath","cleared":false,"url":"/chroduath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MtsrgR8YkGvtGxPH9FViQNz4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9260094,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @knack2hack,\n\nThank you for submitting this report! We will investigate the issue as soon as\npossible, and should get back within a week.\n\nPlease do not submit your report or ask about its status through additional\nchannels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-09-18T17:19:53.634Z","updated_at":"2020-09-18T17:19:53.634Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9260566,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hello @knack2hack,\n\nThanks for reporting this issue. Unfortunately, it is a duplicate of a previous report that we are tracking at https://gitlab.com/gitlab-org/gitlab/-/issues/244275. The original report will be made public 30 days after a patch is released. Because the GitLab issue will be made public after release, we do not typically add reporters as contributors to the original reports on HackerOne.\n\nBest regards,\nDominic\nGitLab Security Team","automated_response":false,"created_at":"2020-09-18T17:46:42.168Z","updated_at":"2020-09-18T17:46:42.168Z","original_report_id":972355,"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10909553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the original over Gitlab.com has been disclosed, I'd like to disclose this as well :-)","automated_response":false,"created_at":"2021-03-08T05:11:57.877Z","updated_at":"2021-03-08T05:11:57.877Z","actor":{"username":"chroduath","cleared":false,"url":"/chroduath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MtsrgR8YkGvtGxPH9FViQNz4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10910267,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-08T07:22:34.526Z","updated_at":"2021-03-08T07:22:34.526Z","first_to_agree":true,"actor":{"username":"chroduath","cleared":false,"url":"/chroduath","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/MtsrgR8YkGvtGxPH9FViQNz4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10913668,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @knack2hack,\n\nThe [original HackerOne report](https://hackerone.com/reports/972355) was disclosed as well but I suppose we can disclose this one too!\n\nBest regards,\nDominic\nGitLab Security Team","automated_response":false,"created_at":"2021-03-08T11:18:28.414Z","updated_at":"2021-03-08T11:18:28.414Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10913669,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-08T11:18:28.563Z","updated_at":"2021-03-08T11:18:28.563Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10913984,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-03-08T11:57:30.107Z","updated_at":"2021-03-08T11:57:30.107Z","additional_data":{"old_severity":"Critical","new_severity":"Medium","old_severity_id":849428,"new_severity_id":1005272},"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}