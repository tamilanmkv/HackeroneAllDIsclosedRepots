{"id":99321,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85OTMyMQ==","url":"https://hackerone.com/reports/99321","title":" [CSRF] Activate PayPal Express Checkout","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-12T16:57:37.924Z","submitted_at":"2015-11-12T16:57:37.924Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-03T17:26:19.144Z","bug_reporter_agreed_on_going_public_at":"2015-12-03T17:26:18.923Z","team_member_agreed_on_going_public_at":"2015-12-03T16:39:44.603Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , i have found a CSRF issue when activating PayPal Express checkout.\n#Steps to reproduce: \n1. Create a new store then login with the admin account.\n2. Go to `https://\u003cyour_store\u003e.myshopify.com/admin/settings/payments` and you'll see that PayPal Express checkout is already active , so click the edit button and deactivate it.\n3. Go to the following link: `https://\u003cyour_store\u003e.myshopify.com/admin/payments/complete_paypal_oauth/41` and you'll see that PayPal Express checkout was activated and you'll get a message saying: *Successfully activated your account*.\n\nI have been trying to link a malicious paypal email through this CSRF by using the following link: \n`https://\u003cyour_store\u003e.myshopify.com/admin/payments/complete_paypal_oauth/41?verification_token=\u003cPAYPAL_TOKEN\u003e` but it doesn't work.\n\nThis issue is a little bit confusing when being reproduced since it will only work on a store in which the admin never tried to activate PayPal before because if he did so , a `request token` will be generated and will be validated for whenever the link is visited.\n\nPlease tell me if you are having an issue reproducing it and I will send you a PoC video. \n\nThanks.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-01-02T16:39:44.809Z","allow_singular_disclosure_after":-182214557.4299443,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","maximilienblank"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":655507,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","automated_response":true,"created_at":"2015-11-12T16:57:38.595Z","updated_at":"2015-11-12T16:57:38.595Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi , I have found that this works even after a `request token` is generated , but you will have to wait some time till the token expires. ","automated_response":false,"created_at":"2015-11-12T21:08:58.211Z","updated_at":"2015-11-12T21:08:58.211Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":655903,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. I've reproduced the issue, and we're working on a fix.","automated_response":false,"created_at":"2015-11-12T21:30:35.870Z","updated_at":"2015-11-12T21:30:35.870Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":693511,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report!\n\nThere was a bug that allowed the previous PayPal configuration to be reinstated even without a valid `request_token` or `verification_code`. The bug has now been corrected, which should address the CSRF issue.\n\nOur next round of bounty decisions will be sometime next week, so we will be in touch with you then.","automated_response":false,"created_at":"2015-11-20T20:28:57.715Z","updated_at":"2015-11-20T20:28:57.715Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707354,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","automated_response":false,"created_at":"2015-12-03T16:37:45.814Z","updated_at":"2015-12-03T16:37:45.814Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707362,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-03T16:39:44.656Z","updated_at":"2015-12-03T16:39:44.656Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":707478,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-03T17:26:18.973Z","updated_at":"2015-12-03T17:26:18.973Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":707479,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-12-03T17:26:19.176Z","updated_at":"2015-12-03T17:26:19.176Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}