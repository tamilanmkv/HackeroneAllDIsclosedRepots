{"id":352869,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTI4Njk=","url":"https://hackerone.com/reports/352869","title":" Subdomain Takeover Via Insecure CloudFront Distribution cdn.grab.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-16T13:40:17.516Z","submitted_at":"2018-05-16T13:40:17.516Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"todayisnew","url":"/todayisnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-02-24T01:52:42.853Z","bug_reporter_agreed_on_going_public_at":"2021-02-24T01:52:42.746Z","team_member_agreed_on_going_public_at":"2018-05-17T17:07:26.981Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Good day, I truly hope it treats you awesomely on your side of the screen :)\n\n\nI have found that your website cdn.grab.com is pointed via a cname to a cloudfront instance\n\ncdn.grab.com =\u003e *.cloudfront.net\n\nThis was not registered on Amazon Aws Cloudfront.\n\nI was able to take over the domain:\n\nSee my POC (Pug of Concept)\nhttp://cdn.grab.com/index.html\n\n\n\nOptions How to fix:\n\n1) Remove the Cname record on cdn.grab.com to not point to cloudfront.net\n\n2) Ask me to remove my registered cdn.grab.com on cloudfront, and you can re register yours :)\n\nMay you be well on your side of the screen :)\n\n-Eric\n\n## Impact\n\nImpact:\n\nCyber attackers can launch a phishing campaign leveraging your established (soon to be impacted) brand reputation.\n\nThe victim has no way of telling, whether the content is served by the domain owner or the cyber attacker.\n\nAttackers can also chain higher severity attacks to this. Many applications expose session cookies to a wildcard domain (*.example.com),\nso any subdomain can access them. An attacker can take a forgotten subdomain, trick the user to visit it, and extract cookies \n(even those with secure flag). This can be seen as an advanced version of XSS.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":12,"name":"Array Index Underflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":95,"voters":["hacker0x0101","ganeshbagaria","youstin","m0chan","drsniper","haxor31337","prakash142","badcracker","spam404","remonsec","and 85 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":1670,"asset_type":"URL","asset_identifier":"*.grab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2751722,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have reviewed your bug report and would like to inform you that your submission is valid. We would request you give us some time while our teams are working on the fix. We will update you once the issue has been fixed so that you can verify the same.\n\nWe appreciate your help in keeping Grab and our customers safe and secure.","automated_response":false,"created_at":"2018-05-16T14:17:03.013Z","updated_at":"2018-05-16T14:17:03.013Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2751808,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-05-16T14:51:26.636Z","updated_at":"2018-05-16T14:51:26.636Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":154689,"new_severity_id":154704},"actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2751919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @todayisnew, \n\nCan you release the claimed records ? :-) \n\nThank you","automated_response":false,"created_at":"2018-05-16T15:23:15.569Z","updated_at":"2018-05-16T15:23:15.569Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2752021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @prakhar-prasad :)\n\nDomain has been released should be available in 10-30 mins :)\n\nsubdomain take overs in my past experience usually have a pretty high impact, curious why the reclassification?\n\nwish you well on your side of the screen :)\n\n-Eric","automated_response":false,"created_at":"2018-05-16T15:52:09.526Z","updated_at":"2018-05-16T15:52:09.526Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2752178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @todayisnew, \n\nThanks for releasing it.\n\nThis issue doesn't significantly risk our users or their data - XSS [requires important cookies to be scoped in `*.grab.com`] and convincing phishing attack [requires a bit of social engineering combined with user interaction]. Hence, the **Medium** severity classification. \n\nFeel free to reach out for any additional questions you have! ","automated_response":false,"created_at":"2018-05-16T16:43:46.563Z","updated_at":"2018-05-16T16:43:46.563Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2754992,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have deployed a fix to address the issue. Can you verify if this has been fixed and you're no longer able to reproduce the behaviour ?\n","automated_response":false,"created_at":"2018-05-17T07:03:31.020Z","updated_at":"2018-05-17T07:03:31.020Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2758299,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the clarification and great work getting it locked down :)  I can verify fixed on my side :)\n\nwish you well on your side of the screen :)\n\n-Eric","automated_response":false,"created_at":"2018-05-17T17:02:50.549Z","updated_at":"2018-05-17T17:02:50.549Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2758303,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for working with us and helping us in resolving this issue. Your bounty will be processed shortly.\n\nWe appreciate your help in keeping Grab and our customers safe and secure.","automated_response":false,"created_at":"2018-05-17T17:04:50.501Z","updated_at":"2018-05-17T17:04:50.501Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"todayisnew","url":"/todayisnew"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2758305,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-05-17T17:05:28.286Z","updated_at":"2018-05-17T17:05:28.286Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Grab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"todayisnew","url":"/todayisnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2758314,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-05-17T17:07:27.021Z","updated_at":"2018-05-17T17:07:27.021Z","first_to_agree":true,"actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2764264,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the awesome kind bounty :)\n\nWish you well on your side of the screen :)\n\n-Eric ","automated_response":false,"created_at":"2018-05-18T22:09:40.081Z","updated_at":"2018-05-18T22:09:40.081Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10761751,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great program to work with, open to questions and answers to clarify impact :) Cloudfront was vulnerable in the past, no longer from my experience.  ","automated_response":false,"created_at":"2021-02-24T01:52:42.774Z","updated_at":"2021-02-24T01:52:42.774Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10761752,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-02-24T01:52:42.877Z","updated_at":"2021-02-24T01:52:42.877Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}