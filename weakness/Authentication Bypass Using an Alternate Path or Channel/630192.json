{"id":630192,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MzAxOTI=","url":"https://hackerone.com/reports/630192","title":"Access control bypass leads to domain information disclosure","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-26T18:30:27.800Z","submitted_at":"2019-06-26T18:30:27.800Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"morax","url":"/morax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/058/826/ae7808c4d99b33f66c6737683ee33ed25a115970_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39174,"url":"https://hackerone.com/vercel","handle":"vercel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vercel","twitter_handle":"vercel","website":"https://vercel.com","about":"Creators of Next.js - Vercel is the platform for developing, previewing, and shipping Jamstack sites."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-04T08:02:31.076Z","bug_reporter_agreed_on_going_public_at":"2019-07-01T21:14:01.456Z","team_member_agreed_on_going_public_at":"2019-07-04T08:02:30.871Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nBy leveraging the domain verification endpoint I can obtain sensitive information about the user who registered the domain within the zeit UI including username, email address, userId, and customerId. In addition, some high level information about the domain is included as well such as when it was registered or if its CDN enabled.\n\nUpon testing the various API endpoints it became clear to me that these details were not intended to be disclosed due to the fact that you have implemented access controls to prevent me from pulling these very details from the /api/v4/domains/now.systems endpoint by returning an HTTP 403 containing a response body indicating that I do not have permission to access the resource.\n\n## Steps To Reproduce:\n1. Configure your browser to use an intercepting proxy such as Burp Suite (used here)\n2. Authenticate as a normal user and capture the HTTP request payload including token and authorization headers\n3. Execute an HTTP POST request using these values against /api/v4/domains/now.systems/verify\n4. Examine the HTTP response body which includes the same information as the /api/v4/domains/now.systems response body (if you have access to it)\n\n## Supporting Material/References:\nAttached are the HTTP requests and corresponding responses I received from your endpoint in Burp Suite repeater. Included in the output are the following attributes associated with the domain now.systems.\n\nCustomer ID: ██████████\nEmail address of registrant:████████\nUser ID:██████\nUsername: ██████\n\n## Impact\n\nThere are a few things here. \n\n1. Domain enumeration - What domains are registered with Zeist?\n2. Who registered the domains and what is their username and email address? These can be used for spearphishing attacks to impersonate Zeist staff.\n3. User ID and CustomerID could be leveraged against other API endpoints to obtain more information such as team IDs.\n4. Various attacks against Zeit staff including phishing and brute forcing which could lead to account takeover of critical production resources (such as domains)","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eBy leveraging the domain verification endpoint I can obtain sensitive information about the user who registered the domain within the zeit UI including username, email address, userId, and customerId. In addition, some high level information about the domain is included as well such as when it was registered or if its CDN enabled.\u003c/p\u003e\n\n\u003cp\u003eUpon testing the various API endpoints it became clear to me that these details were not intended to be disclosed due to the fact that you have implemented access controls to prevent me from pulling these very details from the /api/v4/domains/now.systems endpoint by returning an HTTP 403 containing a response body indicating that I do not have permission to access the resource.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eConfigure your browser to use an intercepting proxy such as Burp Suite (used here)\u003c/li\u003e\n\u003cli\u003eAuthenticate as a normal user and capture the HTTP request payload including token and authorization headers\u003c/li\u003e\n\u003cli\u003eExecute an HTTP POST request using these values against /api/v4/domains/now.systems/verify\u003c/li\u003e\n\u003cli\u003eExamine the HTTP response body which includes the same information as the /api/v4/domains/now.systems response body (if you have access to it)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eAttached are the HTTP requests and corresponding responses I received from your endpoint in Burp Suite repeater. Included in the output are the following attributes associated with the domain now.systems.\u003c/p\u003e\n\n\u003cp\u003eCustomer ID: ██████████\u003cbr\u003e\nEmail address of registrant:████████\u003cbr\u003e\nUser ID:██████\u003cbr\u003e\nUsername: ██████\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThere are a few things here. \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDomain enumeration - What domains are registered with Zeist?\u003c/li\u003e\n\u003cli\u003eWho registered the domains and what is their username and email address? These can be used for spearphishing attacks to impersonate Zeist staff.\u003c/li\u003e\n\u003cli\u003eUser ID and CustomerID could be leveraged against other API endpoints to obtain more information such as team IDs.\u003c/li\u003e\n\u003cli\u003eVarious attacks against Zeit staff including phishing and brute forcing which could lead to account takeover of critical production resources (such as domains)\u003c/li\u003e\n\u003c/ol\u003e\n","weakness":{"id":142,"name":"Authentication Bypass Using an Alternate Path or Channel"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-07-31T21:14:01.571Z","allow_singular_disclosure_after":-44615834.37341442,"singular_disclosure_allowed":true,"vote_count":8,"voters":["sameerphad72","dhakal_ananda","mygf","cryptographer","shad0wdevil","armansameer","laika","3147"],"severity":{"rating":"medium","score":4.2,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":23160,"asset_type":"URL","asset_identifier":"*.vercel.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5201412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are a few additional requests / responses from other domains marked as in scope. Worth noting.. a few of these were registered by Jarmo who is no longer an employee of yours yet still has an external email address associated with the account. Therefore, he could potentially take these accounts over. Or, if his email were to be compromised, an attacker could, which would lead to full control over at least zeit.sh as zeit-cdn is pointed to CloudFlare resolvers.\n\nSee attached.","markdown_message":"\u003cp\u003eHere are a few additional requests / responses from other domains marked as in scope. Worth noting.. a few of these were registered by Jarmo who is no longer an employee of yours yet still has an external email address associated with the account. Therefore, he could potentially take these accounts over. Or, if his email were to be compromised, an attacker could, which would lead to full control over at least zeit.sh as zeit-cdn is pointed to CloudFlare resolvers.\u003c/p\u003e\n\n\u003cp\u003eSee attached.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T18:51:43.697Z","updated_at":"2019-06-26T18:51:43.697Z","actor":{"username":"morax","cleared":false,"url":"/morax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/826/ae7808c4d99b33f66c6737683ee33ed25a115970_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5201451,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was able to validate Jarmos email address via your login page as well by using the email address associated with his account. He should have received a login link at jarmo+zeit@isotalo.fi","markdown_message":"\u003cp\u003eI was able to validate Jarmos email address via your login page as well by using the email address associated with his account. He should have received a login link at \u003ca title=\"jarmo+zeit@isotalo.fi\" href=\"mailto:jarmo+zeit@isotalo.fi\" rel=\"nofollow noopener noreferrer\"\u003ejarmo+zeit@isotalo.fi\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T18:55:50.166Z","updated_at":"2019-06-26T18:55:50.166Z","actor":{"username":"morax","cleared":false,"url":"/morax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/826/ae7808c4d99b33f66c6737683ee33ed25a115970_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5206344,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T14:03:15.170Z","updated_at":"2019-06-27T14:03:15.170Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5208672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nWe have fixed the main issue you reported. We are still reviewing the other issues.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eWe have fixed the main issue you reported. We are still reviewing the other issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-27T18:30:25.369Z","updated_at":"2019-06-27T18:30:25.369Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5208988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update and rapid turn around time! I have confirmed that I am no longer able to retrieve registration information about domains I have not registered within the zeit.co control panel. See attached for HTTP requests and responses.\n","markdown_message":"\u003cp\u003eThanks for the update and rapid turn around time! I have confirmed that I am no longer able to retrieve registration information about domains I have not registered within the zeit.co control panel. See attached for HTTP requests and responses.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-27T19:32:10.053Z","updated_at":"2019-06-27T19:32:10.053Z","actor":{"username":"morax","cleared":false,"url":"/morax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/826/ae7808c4d99b33f66c6737683ee33ed25a115970_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":518020,"filename":"domain-enumeration-fixed.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/518/020/f4b3aae5464924a5a62bac5f6af387a2ce115865/domain-enumeration-fixed.txt?response-content-disposition=attachment%3B%20filename%3D%22domain-enumeration-fixed.txt%22%3B%20filename%2A%3DUTF-8%27%27domain-enumeration-fixed.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063116Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=3e9fae99b20ccbecce8d50f0facda310d25af47ef9d2fbed1a0d30b99120f254"}],"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5232440,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-01T17:39:03.779Z","updated_at":"2019-07-01T17:39:03.779Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"morax","url":"/morax"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5233749,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would it be possible to disclose this report?","markdown_message":"\u003cp\u003eWould it be possible to disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-01T21:14:01.494Z","updated_at":"2019-07-01T21:14:01.494Z","first_to_agree":true,"actor":{"username":"morax","cleared":false,"url":"/morax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/826/ae7808c4d99b33f66c6737683ee33ed25a115970_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5239397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Absolutely. We are waiting for HackerOne to solve a technical issue regarding this report. I'll disclose the report once it's fixed.","markdown_message":"\u003cp\u003eAbsolutely. We are waiting for HackerOne to solve a technical issue regarding this report. I\u0026#39;ll disclose the report once it\u0026#39;s fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-02T15:17:23.282Z","updated_at":"2019-07-02T15:17:23.282Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5251477,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T08:02:30.968Z","updated_at":"2019-07-04T08:02:30.968Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5251478,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T08:02:31.105Z","updated_at":"2019-07-04T08:02:31.105Z","actor":{"username":"hbp","cleared":false,"url":"/hbp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/523/554/b581fbe37ea432116fda96844cafd9ef88b507aa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}