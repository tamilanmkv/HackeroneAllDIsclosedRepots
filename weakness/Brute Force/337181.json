{"id":337181,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzcxODE=","url":"https://hackerone.com/reports/337181","title":"app.passit.io is vulnerable against Brute Force password quessing attack","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-04-13T09:02:07.603Z","submitted_at":"2018-04-13T09:02:07.603Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"muon4","url":"/muon4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27430,"url":"https://hackerone.com/passit","handle":"passit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Passit","twitter_handle":"passitdotio","website":"https://passit.io","about":"An open source app that uses an established and modern cryptographic library to secure your passwords online so you can access them anywhere."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-11T14:19:59.123Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-07-12T14:19:45.344Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\napp.passit.io is vulnerable against Brute Force password quessing attack\n\n**Description:**\nHello!\n\nI have found out that your login functionality is vulnerable against brute force attack.\nThis is especially dangerous in your case because an attacker can get all of users passwords if they brute correctly password! And the because the \"master password\" requirements are not very toughs.\n\n\n## Steps To Reproduce:\n\n  1. Try to \"guess\" your own password like 50 times in very short time perioid and see that you can still successfull log in!\n\n### How to fix?\n- Atleast add captcha \u003c-- This is optional and makes brute force attacks a way more harder\n- Set rate limit which temporary block the IP/user \u003c-- This is recommended\n\nAs a reference you can see almost every login is configured against this :)\n\nIf you need any information please let me know.\n\nCheers!\n\n## Impact\n\nAn attacker could get access to users/victims accounts by brute forcing passwords.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\napp.passit.io is vulnerable against Brute Force password quessing attack\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nHello!\u003c/p\u003e\n\n\u003cp\u003eI have found out that your login functionality is vulnerable against brute force attack.\u003cbr\u003e\nThis is especially dangerous in your case because an attacker can get all of users passwords if they brute correctly password! And the because the \u0026quot;master password\u0026quot; requirements are not very toughs.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eTry to \u0026quot;guess\u0026quot; your own password like 50 times in very short time perioid and see that you can still successfull log in!\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"how-to-fix\"\u003eHow to fix?\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eAtleast add captcha \u0026lt;-- This is optional and makes brute force attacks a way more harder\u003c/li\u003e\n\u003cli\u003eSet rate limit which temporary block the IP/user \u0026lt;-- This is recommended\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAs a reference you can see almost every login is configured against this :)\u003c/p\u003e\n\n\u003cp\u003eIf you need any information please let me know.\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could get access to users/victims accounts by brute forcing passwords.\u003c/p\u003e\n","weakness":{"id":31,"name":"Brute Force"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-11T14:19:45.479Z","allow_singular_disclosure_after":-75223120.59984125,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","cryptographer","the_baghdad_sniper","juba_"],"structured_scope":{"databaseId":8266,"asset_type":"URL","asset_identifier":"app.passit.io","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2603539,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. To be clear, are you able to brute force the server authentication or the actual private key? I'll assume you are talking about guessing the server password which would get you access to a user's ciphertext. This is still bad but limits damage. It's bad because I'd like to assume that even if my crypto strategy is flawed the basic server auth would keep users safe. Auth works like this:\n\n1. User types plain text password (we were just discussing making this min length 10 too)\n2. libsodium pw_hash (argon2) is run client side\n3. The hash is sent to the server. The server treats the hash like the password\n4. The server hashes it again to check (Basic Django auth).\n\nThe fact that hashes are long would likely make this brute force harder to pull off.\n\nCaptcha: Yes - it would help but can be annoying so I'd want it only on users who try to log in many times. I think this could be a nice to have (not urgent) feature. \nRate limit - Well I am an idiot. I have rate limits already....except for the login view. You wouldn't notice this clicking around in the web interface but just repeating /api/auth/login/ can be done over and over. Do'h. That's an easy fix at least.\n\nI'll add the rate limit next release and look into ip/user blocking. In the not near future I'll consider the captcha.","markdown_message":"\u003cp\u003eThanks for the report. To be clear, are you able to brute force the server authentication or the actual private key? I\u0026#39;ll assume you are talking about guessing the server password which would get you access to a user\u0026#39;s ciphertext. This is still bad but limits damage. It\u0026#39;s bad because I\u0026#39;d like to assume that even if my crypto strategy is flawed the basic server auth would keep users safe. Auth works like this:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUser types plain text password (we were just discussing making this min length 10 too)\u003c/li\u003e\n\u003cli\u003elibsodium pw_hash (argon2) is run client side\u003c/li\u003e\n\u003cli\u003eThe hash is sent to the server. The server treats the hash like the password\u003c/li\u003e\n\u003cli\u003eThe server hashes it again to check (Basic Django auth).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe fact that hashes are long would likely make this brute force harder to pull off.\u003c/p\u003e\n\n\u003cp\u003eCaptcha: Yes - it would help but can be annoying so I\u0026#39;d want it only on users who try to log in many times. I think this could be a nice to have (not urgent) feature. \u003cbr\u003e\nRate limit - Well I am an idiot. I have rate limits already....except for the login view. You wouldn\u0026#39;t notice this clicking around in the web interface but just repeating /api/auth/login/ can be done over and over. Do\u0026#39;h. That\u0026#39;s an easy fix at least.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll add the rate limit next release and look into ip/user blocking. In the not near future I\u0026#39;ll consider the captcha.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-13T14:07:57.836Z","updated_at":"2018-04-13T14:07:57.836Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2603771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! \n\nThanks for the answer.\nIn my opinion this rate limit decision is good! Captcha brings more like layered defence and it's not as good as rate limit.\nOh, I should have tested another endpoints too but I thought that the login is most important :)\n\nThe server authentication is my answer to your question if I understood it correctly.\n\nI should be more clear and investigate this more - sorry for this lack of information and fast reporting! Anyway as you said too the login should be protected anyway.\n\nIf I can anything for you please let me know.\n\nCheers!","markdown_message":"\u003cp\u003eHello! \u003c/p\u003e\n\n\u003cp\u003eThanks for the answer.\u003cbr\u003e\nIn my opinion this rate limit decision is good! Captcha brings more like layered defence and it\u0026#39;s not as good as rate limit.\u003cbr\u003e\nOh, I should have tested another endpoints too but I thought that the login is most important :)\u003c/p\u003e\n\n\u003cp\u003eThe server authentication is my answer to your question if I understood it correctly.\u003c/p\u003e\n\n\u003cp\u003eI should be more clear and investigate this more - sorry for this lack of information and fast reporting! Anyway as you said too the login should be protected anyway.\u003c/p\u003e\n\n\u003cp\u003eIf I can anything for you please let me know.\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-13T15:04:15.550Z","updated_at":"2018-04-13T15:04:15.550Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2607477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe this issue is resolved and will be fixed on app.passit.io on the next planned release. Feel free to review https://gitlab.com/passit/passit-backend/merge_requests/15\n\nHighlights:\n\n- 100 attempts per user. We want this to only come up doing brute force attempts (not the user trying too many times).\n- The fact that the password is hashed client side already mitigates the issue because an attacker would have to either try hashing weak password guesses (slow, cpu and ram intensive) or just guess random hashes (which are long)\n- We are requiring min length 10 (pre hash) passwords\n- A captcha after 5 attempts would be ideal but I think a low priority so it won't be included in the next release\n- All other login methods were removed (like django admin)\n\nLet me know if you disagree on anything with my plan. I'll keep this report open until it's live on app.passit.io. Thanks again!","markdown_message":"\u003cp\u003eI believe this issue is resolved and will be fixed on app.passit.io on the next planned release. Feel free to review \u003ca title=\"https://gitlab.com/passit/passit-backend/merge_requests/15\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fpassit%2Fpassit-backend%2Fmerge_requests%2F15\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/passit/passit-backend/merge_requests/15\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHighlights:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e100 attempts per user. We want this to only come up doing brute force attempts (not the user trying too many times).\u003c/li\u003e\n\u003cli\u003eThe fact that the password is hashed client side already mitigates the issue because an attacker would have to either try hashing weak password guesses (slow, cpu and ram intensive) or just guess random hashes (which are long)\u003c/li\u003e\n\u003cli\u003eWe are requiring min length 10 (pre hash) passwords\u003c/li\u003e\n\u003cli\u003eA captcha after 5 attempts would be ideal but I think a low priority so it won\u0026#39;t be included in the next release\u003c/li\u003e\n\u003cli\u003eAll other login methods were removed (like django admin)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLet me know if you disagree on anything with my plan. I\u0026#39;ll keep this report open until it\u0026#39;s live on app.passit.io. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-14T13:19:42.752Z","updated_at":"2018-04-14T13:19:42.752Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2607721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello\n\nSounds reasonable in my opinion!\nOnly thing what I'd change is that how many times users can try passwords. Like 20 times / 10 minutes should be enough to detect the attack but also enough for trying right password. This is just my opinion :)\n\nGreat work anyway!\n\nCheers","markdown_message":"\u003cp\u003eHello\u003c/p\u003e\n\n\u003cp\u003eSounds reasonable in my opinion!\u003cbr\u003e\nOnly thing what I\u0026#39;d change is that how many times users can try passwords. Like 20 times / 10 minutes should be enough to detect the attack but also enough for trying right password. This is just my opinion :)\u003c/p\u003e\n\n\u003cp\u003eGreat work anyway!\u003c/p\u003e\n\n\u003cp\u003eCheers\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-14T15:57:05.311Z","updated_at":"2018-04-14T15:57:05.311Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2614963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello\n\nBtw - I'd add HSTS header to the app.passit.io. Your policy is not tight but I didn't wanted to hit you another report with this \"best practice\".. If you are going to set it ofcourse I am interested about reputation points :)\n\nJust a hint: If you never think going to the public with this program I recommend you to add some \"Out of scope\" reports - this makes your life so much easier! Or atleast it should make ;)\n\nCheers!","markdown_message":"\u003cp\u003eHello\u003c/p\u003e\n\n\u003cp\u003eBtw - I\u0026#39;d add HSTS header to the app.passit.io. Your policy is not tight but I didn\u0026#39;t wanted to hit you another report with this \u0026quot;best practice\u0026quot;.. If you are going to set it ofcourse I am interested about reputation points :)\u003c/p\u003e\n\n\u003cp\u003eJust a hint: If you never think going to the public with this program I recommend you to add some \u0026quot;Out of scope\u0026quot; reports - this makes your life so much easier! Or atleast it should make ;)\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-15T09:14:51.475Z","updated_at":"2018-04-15T09:14:51.475Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2615748,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed on app.passit.io. Let me know if you believe otherwise. I made the max attempts 50 - I'd like it to never really happen for human users until we can think through the UX here more. Thank you.\n\nAgree HSTS is on my list of things to do already.","markdown_message":"\u003cp\u003eFixed on app.passit.io. Let me know if you believe otherwise. I made the max attempts 50 - I\u0026#39;d like it to never really happen for human users until we can think through the UX here more. Thank you.\u003c/p\u003e\n\n\u003cp\u003eAgree HSTS is on my list of things to do already.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-15T18:06:27.919Z","updated_at":"2018-04-15T18:06:27.919Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"muon4","url":"/muon4"},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2615775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello\n\nGreat work! Thanks.\n\nCheers","markdown_message":"\u003cp\u003eHello\u003c/p\u003e\n\n\u003cp\u003eGreat work! Thanks.\u003c/p\u003e\n\n\u003cp\u003eCheers\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-15T18:28:29.159Z","updated_at":"2018-04-15T18:28:29.159Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3035027,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Just going through old issues to mark public when that seems appropriate.","markdown_message":"\u003cp\u003eJust going through old issues to mark public when that seems appropriate.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-12T14:19:45.399Z","updated_at":"2018-07-12T14:19:45.399Z","first_to_agree":true,"actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3177065,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-11T14:19:59.174Z","updated_at":"2018-08-11T14:19:59.174Z","actor":{"url":"/passit","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Passit"}},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}