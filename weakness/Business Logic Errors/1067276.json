{"id":1067276,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY3Mjc2","url":"https://hackerone.com/reports/1067276","title":"Sending trusted ████ and ██████████ emails through public API endpoint in ███████ site","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-12-28T05:24:49.277Z","submitted_at":"2020-12-28T05:24:49.291Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skarsom","url":"/skarsom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/AJF5UwM9J4LCZWYcZzShLMAG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-08T18:54:26.525Z","bug_reporter_agreed_on_going_public_at":"2021-04-07T04:44:23.615Z","team_member_agreed_on_going_public_at":"2021-04-08T18:54:26.399Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nA publicly accessible endpoint at PUT https://████████does not validate any of its four parameters: to, from, subject, text. This enables sending email to any address, with any content, with any from address, on a server that is in ██████whitelist. Such services include, but are not limited to, all ██████ email (██████.\n\n**Description:**\nThe ███'s (████████) ███████ (███) public portal, including login to the private portal, exists at https://███████████/welcome/ with a staging environment at https://███/welcome/. This vulnerability affects both staging and production.\n\nWhenever a request for a new account or a password reset is created, the AngularJS frontend formats this request with a client-side email template (relevant code in https://██████/█████) and sends a JSON-encoded PUT request to `/███████`.\n\nThere are four parameters:\n1) `to` -- this should always be `█████` per https://████████/████████\n1) `from` -- this should always be `█████` per https://████████/█████\n3) `subject` -- the email subject\n4) `text` -- the email body\n\nBecause the client-side AngularJS code is trusted to generate legitimate emails, an unauthorized attacker can use this API to mass-send legitimate ███████ or ██████ emails with arbitrary content. These emails go through the ███ system, so they explicitly pass DKIM and SPF.\n\n## Step-by-step Reproduction Instructions\n\n1. Execute the following cURL request, changing the text `YOUREMAIL` in the JSON-encoded `to` parameter to an email address of your choosing:\n\n    ```\ncurl -X PUT --data '{\"from\":\"Email POC \u003cskarsomh1vdp@████\u003e\",\"to\":\"YOUREMAIL\",\"subject\":\"Test under DC3 VDP at HackerOne\",\"text\":\"This is a test. For more info see hackerone.com/deptofdefense.\"}' -k https://████████-H 'Content-type: application/json'\n    ```\n2. Success. Check the email address specified in the `to` parameter. Notice that this email passes all spam checks such as DKIM and SPF.\n\n## Suggested Mitigation/Remediation Actions\n- Completely remove the `/████` endpoint.\n- Add a new endpoint for requesting a new account that composes the proper email on the *backend*.\n- Add a new endpoint for requesting help with logging in that composes the proper email on the *backend*.\n- Evaluate whether the ██████████ needs to continue including ████████SPF records, as it increases attack surface.\n\n## Impact\n\nAn unauthorized attacker can send arbitrary email from ██████-controlled email servers.\n\nAn adversary could create a spear phishing attack against high-value targets by forging ████ or IC correspondence. For example, sending an email from `██████████` requesting personnel to click on a link to verify their CAC info.","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["skarsom","ayoub0x1","dastan_9408","jangobeastwood","ekgaribadmi","meispi"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10217899,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-12-28T12:26:25.629Z","updated_at":"2020-12-28T12:26:25.629Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":943399},"actor":{"username":"s52","cleared":false,"url":"/s52","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10217900,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected ████ system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the ███████ Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2020-12-28T12:26:34.913Z","updated_at":"2021-04-08T18:32:09.685Z","actor":{"username":"s52","cleared":false,"url":"/s52","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10566182,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the ███ information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2021-02-03T19:08:57.225Z","updated_at":"2021-04-08T18:32:09.673Z","actor":{"username":"agent-bk1","cleared":false,"url":"/agent-bk1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/24F5P44zwdHsXnLAwGzUrqfy/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skarsom","url":"/skarsom"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10570009,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would like to request disclosure.\n\nI know disclosure is usually limited to high+ severity, which I believe this is. Ability to send emails with any .mil or nsa.gov email address is an extreme integrity risk.","automated_response":false,"created_at":"2021-02-04T08:00:29.047Z","updated_at":"2021-02-04T08:00:29.047Z","first_to_agree":true,"actor":{"username":"skarsom","cleared":true,"url":"/skarsom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AJF5UwM9J4LCZWYcZzShLMAG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10575267,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2021-02-04T13:23:21.918Z","updated_at":"2021-02-04T13:23:21.918Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10575270,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-02-04T13:23:29.942Z","updated_at":"2021-02-04T13:23:29.942Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":943399,"new_severity_id":976644},"actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10575274,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected ████████ system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the █████████ Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2021-02-04T13:23:44.041Z","updated_at":"2021-04-08T18:32:09.656Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10575284,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skarsom we have raised the severity and it will be eligible for disclosure. That said, this does not appears to still be an issue, so reopening at this time. Upon resolution please request disclosure again. Thank you!","automated_response":false,"created_at":"2021-02-04T13:24:57.116Z","updated_at":"2021-02-04T13:24:57.116Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11256948,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the ███ information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2021-04-05T16:44:30.008Z","updated_at":"2021-04-08T18:32:09.645Z","actor":{"username":"agent-k9","cleared":false,"url":"/agent-k9","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Tcbk7nwxL7nBJx9emeNQBksZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skarsom","url":"/skarsom"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11292446,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-07T04:44:23.647Z","updated_at":"2021-04-07T04:44:23.647Z","first_to_agree":true,"actor":{"username":"skarsom","cleared":true,"url":"/skarsom","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AJF5UwM9J4LCZWYcZzShLMAG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11324122,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2021-04-08T18:54:26.421Z","updated_at":"2021-04-08T18:54:26.421Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11324123,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-08T18:54:26.600Z","updated_at":"2021-04-08T18:54:26.600Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11324125,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2021-04-08T18:54:32.857Z","updated_at":"2021-04-08T18:54:32.857Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}