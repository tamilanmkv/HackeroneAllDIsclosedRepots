{"id":1112679,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTEyNjc5","url":"https://hackerone.com/reports/1112679","title":"Dangling cloud instance at vpn.inverselink.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2021-02-27T04:03:24.620Z","submitted_at":"2021-02-27T04:03:24.729Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ian","url":"/ian","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-11T17:58:20.365Z","bug_reporter_agreed_on_going_public_at":"2021-03-10T06:28:25.116Z","team_member_agreed_on_going_public_at":"2021-03-11T17:58:20.268Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** `\tvpn.inverselink.com` points to `54.202.130.246`, which is currently serving a TLS certificate for `Workday, Inc`. This seems to indicate that the subdomain is no longer controlled by HackerOne.\n\n### Optional: Supporting Material/References (Screenshots)\n```\n% dig  vpn.inverselink.com +short\n54.202.130.246\n\n % curl -v https://vpn.inverselink.com\n*   Trying 54.202.130.246...\n* TCP_NODELAY set\n* Connected to vpn.inverselink.com (54.202.130.246) port 443 (#0)\n[...]\n* Server certificate:\n*  subject: C=US; ST=California; L=Pleasanton; O=Workday Inc.; CN=*.workdaysuv.com\n```\n\n### Optional: Did you use [recon data made available by HackerOne](https://github.com/Hacker0x01/helpful-recon-data) to find this vulnerability?\nno\n\n## Impact\n\nSubdomain takeover if Workday releases this IP address","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-04-09T06:28:25.343Z","allow_singular_disclosure_after":-16009020.260852264,"singular_disclosure_allowed":true,"vote_count":22,"voters":["yssk","m0chan","th4nu_0x0","ali","yassinek3ch","ayoub0x1","melbadry9","fdeleite","sudi","realtess","and 12 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10822675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Rushed the report a bit to ensure it was reported in a timely manner, but to add to the report:\n\n* `54.202.130.246` is within AWS `us-west-2`, so this was likely a dangling instance that was deleted without the DNS record updated.\n* Workday has claimed the IP now, but if they delete their EC2 instance or EIP, it will be released into the pool and can be claimed by someone else, accidentally or intentionally. (AFAIK there are a small amount of mitigations here on the AWS side, but clearly did not stop Workday, and I have decent success with rapid instance creation/deletion).\n* `inverselink.com` is HackerOne, i.e. https://storybook.inverselink.com is clearly HackerOne. I wish this was listed as an explicit asset, if only given it makes the smart rewards model a bit confusing.\n* It seems like there would be additional impact if you have older VPN clients attempting to connect to this instance (if you captured the instance, could get a valid cert for this domain and capture credentials).\n\nLet me know if I can clarify anything.","automated_response":false,"created_at":"2021-02-27T04:21:22.898Z","updated_at":"2021-02-27T04:21:22.898Z","actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10828724,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @ian,\n\nI hope all is well and thanks for leaving a message. \n\nI am not able to replicate the issue or connect to the host:\n\n```bash\n% curl -v https://vpn.inverselink.com\n*   Trying 54.202.130.246...\n* TCP_NODELAY set\n* Connection failed\n* connect to 54.202.130.246 port 443 failed: Operation timed out\n* Failed to connect to vpn.inverselink.com port 443: Operation timed out\n* Closing connection 0\ncurl: (7) Failed to connect to vpn.inverselink.com port 443: Operation timed out\n```\n\nHow did get the SSL certificate get shown to you?\n\nThanks and regards,\n@golden__retriever","automated_response":false,"created_at":"2021-02-28T06:13:24.815Z","updated_at":"2021-02-28T06:13:24.815Z","actor":{"username":"golden__retriever","cleared":false,"url":"/golden__retriever","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/2wvzjwm8m3j5eot0zytbco21ocjv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22abc123.png%22%3B%20filename%2A%3DUTF-8%27%27abc123.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132525Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=59c1484036870717b741ff1095fc271915ed30c060d5c1e03f71330e2317e3a1"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10828768,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @golden__retriever,\n\nThanks for taking a look; I agree, it appears this address is no longer allocated to Workday. It's either in use by yet another customer, or is in the free pool of AWS IP addresses, but it's not possible for it to be controlled by HackerOne at this point, since it was already allocated to another AWS customer when I took a look at it.\n\nI think the easiest way to validate that this is indeed no longer under HackerOne's control is for HackerOne to verify the IP does not match any of their instances within `us-west-2`. I have tooling hunting for this address as well, but given cost constraints, I cannot make very many attempts.\n\nSorry for the lack of a reproducible PoC at this point! I'll keep poking at it and see if it comes back up under another customer (or myself).","automated_response":false,"created_at":"2021-02-28T06:29:52.485Z","updated_at":"2021-02-28T06:29:52.485Z","actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10871949,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @ian - thanks for letting us know! We'll check with our infrastructure team if this record is indeed dangling and get back to you when we've heard back.","automated_response":false,"created_at":"2021-03-03T21:56:48.211Z","updated_at":"2021-03-03T21:56:48.211Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10873663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @jobert! Looks like this has been deleted.\n\n```\n% dig vpn.inverselink.com\n[...]\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NXDOMAIN, id: 51395\n```","automated_response":false,"created_at":"2021-03-04T04:20:04.746Z","updated_at":"2021-03-04T04:20:04.746Z","actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10882733,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-03-04T18:26:43.153Z","updated_at":"2021-03-04T18:26:43.153Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":997186,"new_severity_id":1002581},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10882747,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @ian - ha, you're so fast! The team indeed deleted the record yesterday; thanks for confirming! We did a quick audit of other services under the inverselink.com domain and noticed that the most critical ones have their cookies correctly scoped, avoiding a possible leak. Because of that, I lowered the severity to low and are awarded a bounty accordingly. Did I miss anything in that assessment? Thanks again, nice find!","automated_response":false,"created_at":"2021-03-04T18:28:06.829Z","updated_at":"2021-03-04T18:28:06.829Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"ian","url":"/ian"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10882749,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-03-04T18:28:14.091Z","updated_at":"2021-03-04T18:28:14.091Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"ian","url":"/ian"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10882836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert, thanks for the bounty! I agree with the impact assessment, but if you had any VPN clients that may have tried to connect to this endpoint, itâ€™s possible those credentials could have been captured, since we could get a valid TLS certificate if we had control of the instance. Purely theoretical though :)","automated_response":false,"created_at":"2021-03-04T18:40:16.655Z","updated_at":"2021-03-04T18:40:16.655Z","actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10896931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ian - definitely! We moved to a different hostname some time ago. All credentials were regenerated at the time. My suspicion is that we didn't have any clients connect to vpn.inverselink.com anymore. Even if they would though, the credentials wouldn't work on the new VPN instance. Thanks again!","automated_response":false,"created_at":"2021-03-05T20:25:31.641Z","updated_at":"2021-03-05T20:25:31.641Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10941528,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again @jobert! I'd prefer limited disclosure if you don't mind.","automated_response":false,"created_at":"2021-03-10T06:28:25.162Z","updated_at":"2021-03-10T06:28:25.162Z","first_to_agree":true,"actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10941633,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually full disclosure is okay, nothing new in here of course :)","automated_response":false,"created_at":"2021-03-10T06:42:44.613Z","updated_at":"2021-03-10T06:42:44.613Z","actor":{"username":"ian","cleared":true,"url":"/ian","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/LG6Pp9rV6DqFuyi3RJN8e17s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10960672,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-03-11T17:58:20.294Z","updated_at":"2021-03-11T17:58:20.294Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10960673,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-11T17:58:20.388Z","updated_at":"2021-03-11T17:58:20.388Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}