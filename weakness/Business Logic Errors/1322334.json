{"id":1322334,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzIyMzM0","url":"https://hackerone.com/reports/1322334","title":"Ability to subscribe to inactive Post+ creators","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2021-08-28T19:15:05.278Z","submitted_at":"2021-08-28T19:15:05.334Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ajoekerr","url":"/ajoekerr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-10-05T13:00:33.300Z","bug_reporter_agreed_on_going_public_at":"2021-10-05T03:47:52.956Z","team_member_agreed_on_going_public_at":"2021-10-05T13:00:33.157Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey y'all! ðŸ‘‹ Hope all is well!\n\n## Summary:\nIn testing Tumblr's Post+, I've found that it's possible to subscribe to creators that, at one point, opted into Post+ but had opted out after some point. As I note later on, it appears that this is a \"one time use only\" as the Payment URL becomes invalid after activating Post+ for the inactive Post+ blog.\n\n## Platform(s) Affected:\nN/A\n\n## Steps To Reproduce:\nIn order to reproduce, you need the `blogMembershipsId` of an inactive Post+ blog. This creates a high bar to actually exploit this but, for some reason, I had the `blogMembershipsId` of `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`, who had deactivated Post+ shortly after launch (the membership ID is `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`).\n\n1. Get an active Post+ subscription URL (I used `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ.tumblr.com`'s subscription URL).\n2. Replace the active Post+ blog's `blogMemershipsId` with the inactive blog's `blogMembershipsId` (if using `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`, you should have a url like `https://â–ˆâ–ˆâ–ˆ.payment.tumblr.com/checkout/?token=\u003ctoken\u003e`).\n    * As a heads up, it actually looks like this URL is no longer valid after activating my Post+ subscription for `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`.\n3. Complete checkout as normal.\n4. After checkout, it will redirect back to the active Post+ blog's creator page but it will never load.\n5. Verify that the creator page for the previously inactive Post+ blog is active again and that the subscription is active for the inactive Post+ blog.\n\n## Supporting Material/References:\nUnfortunately, this looks like a \"one time use\" only vulnerability as the WooCommerce payment URL is no longer active for `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ` after I attempted to subscribe so I was unable to get a PoC video. However, I've uploaded the receipt in case having the `payment_intent` ID helps at all!\n\n## Impact\n\nAs of right now, the only impact I've been able to see is that the inactive Post+ blog's creator page became active, even without them enrolled into Post+: https://www.tumblr.com/creator/â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ. However, I would also consider the fact that a page would show the blog name \u0026 avatar for the Post+ blog noted in the token but the checkout URL corresponds to the `blogMembershipsId` as unexpected behavior but, as far as I can tell, it would be somewhat of a \"self-pwn\" ðŸ˜….\n\nIf y'all don't necessarily consider this a security risk, please let me know and I will self-close this report! To be honest, with what I can see, I consider this to be fairly low impact but I wanted to let y'all know anyway. ðŸ™‚","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["run_win","alp","khizer47","akashhamal0x01","cryptographer","godworld","andrei_goodguy","i_am_gaurav_57"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":42403,"asset_type":"URL","asset_identifier":"www.tumblr.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":13230422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ajoekerr! It's good to see you here :) I hope everything is fine on your side as well! I'll forward this report to the Tumblr core PHP team.","automated_response":false,"created_at":"2021-08-30T12:46:00.487Z","updated_at":"2021-08-30T12:46:00.487Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13234024,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, Alex! Let me know if they have any questions. :)","automated_response":false,"created_at":"2021-08-30T16:48:34.123Z","updated_at":"2021-08-30T16:48:34.123Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13693827,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @ajoekerr, thanks again for the report. The Tumblr team deployed a couple of fixes to address this issue :)","automated_response":false,"created_at":"2021-09-30T13:05:18.376Z","updated_at":"2021-09-30T13:05:18.376Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ajoekerr","url":"/ajoekerr"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13693971,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi, we would like thank you again for your submission and helping make Tumblr a safer place. We look forward to more reports from you in the future.","automated_response":false,"created_at":"2021-09-30T13:06:15.659Z","updated_at":"2021-09-30T13:06:15.659Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"ajoekerr","url":"/ajoekerr"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13749198,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty! Iâ€™d love to request disclosure if thatâ€™s alright with yâ€™all. :)\n\nIf we do proceed with disclosure, I would like to redact the blog name I used for testing as well as the Post+ membership ID, just in case. Thanks!","automated_response":false,"created_at":"2021-10-05T03:47:52.996Z","updated_at":"2021-10-05T03:47:52.996Z","first_to_agree":true,"actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13757575,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Andrew, we redacted the items you mentioned as well as the attached screenshot :). If everything is fine for you now, happy to disclose this right away :)","automated_response":false,"created_at":"2021-10-05T11:50:49.316Z","updated_at":"2021-10-05T11:50:49.316Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13758478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @xknown, thanks for the redactions! I think this is fine to move forward with now. :) Thanks again!","automated_response":false,"created_at":"2021-10-05T12:50:05.250Z","updated_at":"2021-10-05T12:50:05.250Z","actor":{"username":"ajoekerr","cleared":false,"url":"/ajoekerr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/249/632/1c6e9236a8c7e818c6073436420c1cbdbdde819d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13758580,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-10-05T13:00:33.190Z","updated_at":"2021-10-05T13:00:33.190Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13758581,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-10-05T13:00:33.378Z","updated_at":"2021-10-05T13:00:33.378Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}