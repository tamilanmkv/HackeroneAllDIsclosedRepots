{"id":397792,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTc3OTI=","url":"https://hackerone.com/reports/397792","title":"@wearehackerone.com is vulnerable to namespace attacks due to hackerone.com not being RFC2142 compliant.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-21T15:11:18.461Z","submitted_at":"2018-08-21T15:11:18.461Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thefrog","url":"/thefrog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-01-02T10:47:54.504Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-01-02T10:47:07.961Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hola amigos,\n\nFirst off, I know RFCs are annoying.\nSecond of all, namespace attacks are a b*tch.\n\nWith that out of the way, here is an Inti-bug that was discovered as a result of reading RFC2142 very carefully.\n\n## Brief summary of RFC2142\n\nRFC2142 defines a standard set of email addresses that cover certain roles and functions. For example, you might be familiar with the `security@` address. This was originally defined in section 4 of RFC2142: https://tools.ietf.org/html/rfc2142#section-4.\n\n```\nMAILBOX        AREA                USAGE\n-----------    ----------------    ---------------------------\nABUSE          Customer Relations  Inappropriate public behaviour\nNOC            Network Operations  Network infrastructure\nSECURITY       Network Security    Security bulletins or queries\n```\n\n## Ze Bug\n\nThe way the new `@wearehackerone.com` email forwarding system works, is that an address is allocated for your HackerOne account based on your username (`\u003cyour-h1-handle\u003e@wearehackerone.com`). So hackerone.com/foobar turns into `foobar@wearehackerone.com`. With this in mind, I decided to enumerate all the various email addresses defined in RFC2142 and determine which ones can be registered ultimately resulting in me controlling what should be a reserved email address.\n\nIn some cases you do actually prevent people from claiming the handle, such as with `postmaster`.\n\n{F336065}\n\nUnfortunately though, after a bit of probing I noticed that not all RFC2142 addresses were blocked. I am now the proud owner of trouble@wearehackerone.com. Please feel free to shoot me an email and I will respond back to demonstrate that this address is under my control.\n\n## How to fix this issue\n\nIn order to fix this issue, I advise you to add the following usernames to your exclusion list so that one cannot hijack these important email addresses.\n\n```\nabuse\nadmin\nadministrator\nhostmaster\ninfo\nis\nit\nlist\nlist-request\nmajordomo\nmarketing\nmis\nnews\npostmaster\nroot\nsales\nsecurity\nssl-admin\nssladmin\nssladministrator\nsslwebmaster\nsupport\nsysadmin\ntrouble\nusenet\nuucp\nwebmaster\n```\n\nHave fun fixing this issue and feel free to email me at trouble@wearehackerone.com if you are having any trouble reproducing this issue. ;)\n\n\\- @thefrog\n\n## Impact\n\nIn some cases, these reserved addresses are used to generate SSL certificates since CAs assume that these are all trusted addresses.","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":336065,"file_name":"Screen_Shot_2018-08-21_at_16.30.25.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/336/065/42f07fe1b56be415dd67dd1066c7fe304a77b30e/Screen_Shot_2018-08-21_at_16.30.25.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-08-21_at_16.30.25.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-08-21_at_16.30.25.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145558Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7001606bf6695f06cc65eda06805f47ac6fde1ab891e1fee0f57230421dff9e2","file_size":402734,"type":"image/png"}],"allow_singular_disclosure_at":"2019-02-01T10:47:08.071Z","allow_singular_disclosure_after":-84946130.10784976,"singular_disclosure_allowed":true,"vote_count":104,"voters":["pajoda","mirchr","8ayac","nytr0gen","arneswinnen","drsniper","dxaxpanda","ramsexy","bughunterninja","muon4","and 94 more..."],"severity":{"rating":"medium","score":5.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3260397,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @thefrog :) we'll look into it!","automated_response":false,"created_at":"2018-08-28T21:33:50.834Z","updated_at":"2018-08-28T21:33:50.834Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3308111,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-09-07T17:18:03.422Z","updated_at":"2018-09-07T17:18:03.422Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.8)","old_severity_id":null,"new_severity_id":207503},"actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3308127,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thanks again! We're fixing it. Sorry that we can't pay out $$ because you're part of the team :)","automated_response":false,"created_at":"2018-09-07T17:22:36.373Z","updated_at":"2018-09-07T17:22:36.373Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3489930,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed! Marking this as resolved now :) ","automated_response":false,"created_at":"2018-10-16T20:27:35.696Z","updated_at":"2018-10-16T20:27:35.696Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"thefrog","url":"/thefrog"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3914541,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-02T10:47:07.987Z","updated_at":"2019-01-02T10:47:07.987Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3914545,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2019-01-02T10:47:54.444Z","updated_at":"2019-01-02T10:47:54.444Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}