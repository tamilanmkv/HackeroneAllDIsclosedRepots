{"id":413759,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTM3NTk=","url":"https://hackerone.com/reports/413759","title":"Race condition at create new Location","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-09-25T03:20:18.368Z","submitted_at":"2018-09-25T03:20:18.368Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zhurig","url":"/zhurig","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/063/65bb7ae2640970c4a3020890562cc16cbb211b60_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-05T04:49:12.421Z","bug_reporter_agreed_on_going_public_at":"2018-10-05T04:49:12.328Z","team_member_agreed_on_going_public_at":"2018-10-04T13:15:08.071Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"User can bypas restriction and create more ctore location, than maximum depends store plan. Intercept request and send it multiple at once. See screensots\nF350687 - requests\nF350688 - results\nI created 12 store location when 4 possible\n\n## Impact\n\nBypass the limitations of the billing plan","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":350687,"file_name":"Requests.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/687/1822514b7c1d3cfaaa24dab446a05ec5f0c81813/Requests.png?response-content-disposition=attachment%3B%20filename%3D%22Requests.png%22%3B%20filename%2A%3DUTF-8%27%27Requests.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145750Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=67a688da150087f98bf510787910b006dbe9e884564da5fbfb103c7089dc8ba2","file_size":83187,"type":"image/png"},{"id":350688,"file_name":"result.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/688/a51dc513b81608521e8e8c0f6e03515b7a3d3537/result.png?response-content-disposition=attachment%3B%20filename%3D%22result.png%22%3B%20filename%2A%3DUTF-8%27%27result.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145750Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=264dffeff7167315c8feb9723d578260c8e3f5b5b66c18fec1e4843ecfc01f51","file_size":66389,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":23,"voters":["drsniper","sameerphad72","ali","eveeez","an0nym0us","h13-","mefkan","khoata","japz","sumit7","and 13 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3391515,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue and our team is currently working on a fix. We will get back to you as soon as we have any updates :)","automated_response":false,"created_at":"2018-09-26T14:25:05.634Z","updated_at":"2018-09-26T14:25:05.634Z","actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3391529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok :)","automated_response":false,"created_at":"2018-09-26T14:27:20.648Z","updated_at":"2018-09-26T14:27:20.648Z","actor":{"username":"zhurig","cleared":false,"url":"/zhurig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/063/65bb7ae2640970c4a3020890562cc16cbb211b60_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3401198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems fixed now. It does not matter how many requests I send - only the allowed number of stores is created.","automated_response":false,"created_at":"2018-09-28T12:05:43.698Z","updated_at":"2018-09-28T12:05:43.698Z","actor":{"username":"zhurig","cleared":false,"url":"/zhurig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/063/65bb7ae2640970c4a3020890562cc16cbb211b60_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3421211,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report @zhurig! We are awarding an initial 500$ for this bug, and we will determine the final amount once the issue is resolved.","automated_response":false,"created_at":"2018-10-02T14:08:50.286Z","updated_at":"2018-10-02T14:08:50.286Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zhurig","url":"/zhurig"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3428427,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report! We recently deployed a fix for this issue. We have resolved this issue by adding extra transactional locking during store location changes. We've deemed that the initial bounty is appropriate for this vulnerability.\nWe look forward to hearing from you again soon!","automated_response":false,"created_at":"2018-10-03T16:18:38.339Z","updated_at":"2018-10-03T16:18:38.339Z","actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zhurig","url":"/zhurig"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3434020,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-04T13:15:08.130Z","updated_at":"2018-10-04T13:15:08.130Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3437240,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for bounty and fast responses. I confirm that I can not reproduce this bug, no matter how to try - when creating several of new locations, or at the same time activate several of deactivated.\nI will be glad to work with you in the future.","automated_response":false,"created_at":"2018-10-05T04:49:12.354Z","updated_at":"2018-10-05T04:49:12.354Z","actor":{"username":"zhurig","cleared":false,"url":"/zhurig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/063/65bb7ae2640970c4a3020890562cc16cbb211b60_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3437241,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-05T04:49:12.438Z","updated_at":"2018-10-05T04:49:12.438Z","actor":{"username":"zhurig","cleared":false,"url":"/zhurig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/063/65bb7ae2640970c4a3020890562cc16cbb211b60_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10912,"category":"team","content":"@zhurig found a race condition where it was possible to bypass the limit for the number of locations a store can have by submitting multiple requests at once. We have resolved this issue by adding extra transactional locking during store location changes.\n\n**Note**: Shopify no longer accepts reports regarding race conditions bypassing plan limits to this bug bounty program. Please make sure to check that your report has additional merchant impact beyond bypassing a plan limit before reporting.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":166726,"username":"abdulwahaab_ahmed","name":"Abdulwahaab Ahmed","bio":"","cleared":false,"website":null,"location":"","created_at":"2017-05-11T17:57:27.993Z","url":"https://hackerone.com/abdulwahaab_ahmed","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}