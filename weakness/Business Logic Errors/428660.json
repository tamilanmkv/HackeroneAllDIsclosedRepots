{"id":428660,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mjg2NjA=","url":"https://hackerone.com/reports/428660","title":"Gallery: No feedback for invalid password","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-10-25T14:42:39.243Z","submitted_at":"2018-10-25T14:42:39.243Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"foobar7","url":"/foobar7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-27T09:20:10.842Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-06-27T09:20:08.886Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"CVSS\n----\n\nLow 3.1 [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)\n\nDescription\n-----------\n\nThe Gallery plugin does not inform a user when password-protecting a file failed in combination with the Password Policy plugin. Because of this, files that the user will rightfully assume to be password-protected are actually publicly accessible.\n\nPOC\n---\n\nPrerequisite: Enable Gallery and Password Policy plugins \u0026 upload an image\n\nView the image in the Gallery:\n\n    http://192.168.0.103/nextcloud/nextcloud/index.php/apps/gallery/#dummy_192x192.png\n\nNow click on \"Share\" -\u003e \"Share link\" -\u003e \"Password protect\" and enter a password that is in violation of the password policy (for example `vjhtdf68`).\n\nThe password will not actually be applied, as it violates the policy. However, the feedback is exactly the same as when a password is successfully set; there is no error message. \n\nA user will now think that the file is password-protected while it is actually publicly accessible.\n\nSolution\n---------\n\nThe error should be visibly shown, so that a user is aware that no password is set (the same way as is currently already happening in the main file view when setting a password).\n\n## Impact\n\naccidental disclosure of files which should be password protected.","vulnerability_information_html":"\u003ch2 id=\"cvss\"\u003eCVSS\u003c/h2\u003e\n\n\u003cp\u003eLow 3.1 \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.first.org%2Fcvss%2Fcalculator%2F3.0%23CVSS%3A3.0%2FAV%3AN%2FAC%3AH%2FPR%3AN%2FUI%3AR%2FS%3AU%2FC%3AL%2FI%3AN%2FA%3AN\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eThe Gallery plugin does not inform a user when password-protecting a file failed in combination with the Password Policy plugin. Because of this, files that the user will rightfully assume to be password-protected are actually publicly accessible.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003ePrerequisite: Enable Gallery and Password Policy plugins \u0026amp; upload an image\u003c/p\u003e\n\n\u003cp\u003eView the image in the Gallery:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://192.168.0.103/nextcloud/nextcloud/index.php/apps/gallery/#dummy_192x192.png\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow click on \u0026quot;Share\u0026quot; -\u0026gt; \u0026quot;Share link\u0026quot; -\u0026gt; \u0026quot;Password protect\u0026quot; and enter a password that is in violation of the password policy (for example \u003ccode\u003evjhtdf68\u003c/code\u003e).\u003c/p\u003e\n\n\u003cp\u003eThe password will not actually be applied, as it violates the policy. However, the feedback is exactly the same as when a password is successfully set; there is no error message. \u003c/p\u003e\n\n\u003cp\u003eA user will now think that the file is password-protected while it is actually publicly accessible.\u003c/p\u003e\n\n\u003ch2 id=\"solution\"\u003eSolution\u003c/h2\u003e\n\n\u003cp\u003eThe error should be visibly shown, so that a user is aware that no password is set (the same way as is currently already happening in the main file view when setting a password).\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eaccidental disclosure of files which should be password protected.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-07-27T09:20:08.978Z","allow_singular_disclosure_after":-45002208.98647539,"singular_disclosure_allowed":true,"vote_count":19,"voters":["sustenance","sameerphad72","emanuelharijanto","dhakal_ananda","mygf","realtess","exception","cr4xerbik4sh","okido1","cryptographer","and 9 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":65,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/gallery","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3532690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-10-25T14:42:43.685Z","updated_at":"2018-10-25T14:42:43.685Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3548406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @foobar7,\n\nThanks for your report (again).\nGetting the normal sidebar into gallery is on our roadmap. But you are right that this issue is currently a problem.\nI'll see what we can do here.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi \u003ca href=\"/foobar7\"\u003e@foobar7\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report (again).\u003cbr\u003e\nGetting the normal sidebar into gallery is on our roadmap. But you are right that this issue is currently a problem.\u003cbr\u003e\nI\u0026#39;ll see what we can do here.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-29T10:00:58.441Z","updated_at":"2018-10-29T10:00:58.441Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3548409,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-29T10:01:08.833Z","updated_at":"2018-10-29T10:01:08.833Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4175921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer,\n\nI know this is low-priority, but it's been four month already, so I thought I'd if you have any update on this?\n\nBest,\nFoobar7","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rullzer\"\u003e@rullzer\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI know this is low-priority, but it\u0026#39;s been four month already, so I thought I\u0026#39;d if you have any update on this?\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nFoobar7\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-19T21:09:22.187Z","updated_at":"2019-02-19T21:09:22.187Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5204771,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Patch is at https://github.com/nextcloud/gallery/pull/528","markdown_message":"\u003cp\u003ePatch is at \u003ca title=\"https://github.com/nextcloud/gallery/pull/528\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fgallery%2Fpull%2F528\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/gallery/pull/528\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-27T09:19:43.966Z","updated_at":"2019-06-27T09:19:43.966Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"foobar7","url":"/foobar7"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5204774,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T09:19:58.788Z","updated_at":"2019-06-27T09:19:58.788Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"foobar7","url":"/foobar7"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5204775,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T09:20:08.916Z","updated_at":"2019-06-27T09:20:08.916Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5443762,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-27T09:20:10.860Z","updated_at":"2019-07-27T09:20:10.860Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}