{"id":484615,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODQ2MTU=","url":"https://hackerone.com/reports/484615","title":"Unsanitized user photo paths allow local file read","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-23T11:16:20.844Z","submitted_at":"2019-01-23T11:16:20.844Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"alb3r7","url":"/alb3r7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-13T04:27:29.324Z","bug_reporter_agreed_on_going_public_at":"2019-06-13T04:27:26.252Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nWhen we register a new user, we can set the photo of user.  If we set a milicious path, we can delete the profile photo of others\n\n**Description:**\nThere is an episode of register.\napplications/dashboard/controllers/class.entrycontroller.php\n```\n    private function registerBasic() {\n        $this-\u003eView = 'registerbasic';\n        Gdn::userModel()-\u003eaddPasswordStrength($this);\n\n        if ($this-\u003eForm-\u003eisPostBack() === true) {\n            // Add validation rules that are not enforced by the model\n            $this-\u003eUserModel-\u003edefineSchema();\n            $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('Name', 'Username', $this-\u003eUsernameError);\n            $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('TermsOfService', 'Required', t('You must agree to the terms of service.'));z\n            $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('Password', 'Required');\n            $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('Password', 'Strength');\n            $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('Password', 'Match');\n            // $this-\u003eUserModel-\u003eValidation-\u003eapplyRule('DateOfBirth', 'MinimumAge');\n\n            $this-\u003efireEvent('RegisterValidation');\n\n            try {\n                $values = $this-\u003eForm-\u003eformValues(); //1\n                $values = $this-\u003eUserModel-\u003efilterForm($values, true); //2\n                unset($values['Roles']);\n                $authUserID = $this-\u003eUserModel-\u003eregister($values);//3\n```\nGet form values and filter many fields in UserModel. But I find there are 23 fields in GDN_User remains\n```\nAbout\nBanned\nConfirmed\nCountBookmarks\nCountDrafts\nCountUnreadConversations\nCountUnreadDiscussions\nDateOfBirth\nDateSetInvitations\nEmail\nGender\nHashMethod\nHourOffset\nInviteUserID\nLocation\nName\nPassword\nPhoto\nPoints\nShowEmail\nTitle\nUserID\nVerified\n```\nIn UserModel::removePicture, it delete the local file according to photo field. But in step 2, it call changeBasename to add prefix 'p' in basename. So we can only delete the filename starts with 'p' in uploads directory\n```\n    public function removePicture($userID) {\n        // Grab the current photo.\n        $user = $this-\u003egetID($userID, DATASET_TYPE_ARRAY); //1\n        $photo = $user['Photo'];\n\n        // Only attempt to delete a physical file, not a URL.\n        if (!isUrl($photo)) {\n            $profilePhoto = changeBasename($photo, 'p%s'); //2\n            $upload = new Gdn_Upload();\n            $upload-\u003edelete($profilePhoto); //3\n        }\n\n        // Wipe the Photo field.\n        $this-\u003esetField($userID, 'Photo', null);\n    }\n```\n\n## Steps to reproduce:\n\n1. find other user's photo url to delete (eg: uploads/userpics/868/pT8SSG8E4EYSK.png)\n2. register a new user and intercept the request\n3. add a field `Photo`, set the value as `userpics/868/T8SSG8E4EYSK.png`(without prefix p)\n4. login, and request /vanilla/index.php?p=/profile/removepicture/**yourusername**\u0026tk=**yourtk**\u0026deliveryType=ALL\nThen the local file uploads/userpics/868/pT8SSG8E4EYSK.png will be deleted\n\n## Anything else we should know?\nBecause of the path restriction, only filepath matchs `uploads/*/p*` can be deleted.\nWhitelist may better than blacklist, only a few fields should be permitted to insert into database where registration\n\n## Impact\n\nbe able to delete profile photo of others","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nWhen we register a new user, we can set the photo of user.  If we set a milicious path, we can delete the profile photo of others\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003cbr\u003e\nThere is an episode of register.\u003cbr\u003e\napplications/dashboard/controllers/class.entrycontroller.php\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    private function registerBasic() {\n        $this-\u0026gt;View = \u0026#39;registerbasic\u0026#39;;\n        Gdn::userModel()-\u0026gt;addPasswordStrength($this);\n\n        if ($this-\u0026gt;Form-\u0026gt;isPostBack() === true) {\n            // Add validation rules that are not enforced by the model\n            $this-\u0026gt;UserModel-\u0026gt;defineSchema();\n            $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;Name\u0026#39;, \u0026#39;Username\u0026#39;, $this-\u0026gt;UsernameError);\n            $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;TermsOfService\u0026#39;, \u0026#39;Required\u0026#39;, t(\u0026#39;You must agree to the terms of service.\u0026#39;));z\n            $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;Password\u0026#39;, \u0026#39;Required\u0026#39;);\n            $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;Password\u0026#39;, \u0026#39;Strength\u0026#39;);\n            $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;Password\u0026#39;, \u0026#39;Match\u0026#39;);\n            // $this-\u0026gt;UserModel-\u0026gt;Validation-\u0026gt;applyRule(\u0026#39;DateOfBirth\u0026#39;, \u0026#39;MinimumAge\u0026#39;);\n\n            $this-\u0026gt;fireEvent(\u0026#39;RegisterValidation\u0026#39;);\n\n            try {\n                $values = $this-\u0026gt;Form-\u0026gt;formValues(); //1\n                $values = $this-\u0026gt;UserModel-\u0026gt;filterForm($values, true); //2\n                unset($values[\u0026#39;Roles\u0026#39;]);\n                $authUserID = $this-\u0026gt;UserModel-\u0026gt;register($values);//3\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGet form values and filter many fields in UserModel. But I find there are 23 fields in GDN_User remains\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eAbout\nBanned\nConfirmed\nCountBookmarks\nCountDrafts\nCountUnreadConversations\nCountUnreadDiscussions\nDateOfBirth\nDateSetInvitations\nEmail\nGender\nHashMethod\nHourOffset\nInviteUserID\nLocation\nName\nPassword\nPhoto\nPoints\nShowEmail\nTitle\nUserID\nVerified\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn UserModel::removePicture, it delete the local file according to photo field. But in step 2, it call changeBasename to add prefix \u0026#39;p\u0026#39; in basename. So we can only delete the filename starts with \u0026#39;p\u0026#39; in uploads directory\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    public function removePicture($userID) {\n        // Grab the current photo.\n        $user = $this-\u0026gt;getID($userID, DATASET_TYPE_ARRAY); //1\n        $photo = $user[\u0026#39;Photo\u0026#39;];\n\n        // Only attempt to delete a physical file, not a URL.\n        if (!isUrl($photo)) {\n            $profilePhoto = changeBasename($photo, \u0026#39;p%s\u0026#39;); //2\n            $upload = new Gdn_Upload();\n            $upload-\u0026gt;delete($profilePhoto); //3\n        }\n\n        // Wipe the Photo field.\n        $this-\u0026gt;setField($userID, \u0026#39;Photo\u0026#39;, null);\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003efind other user\u0026#39;s photo url to delete (eg: uploads/userpics/868/pT8SSG8E4EYSK.png)\u003c/li\u003e\n\u003cli\u003eregister a new user and intercept the request\u003c/li\u003e\n\u003cli\u003eadd a field \u003ccode\u003ePhoto\u003c/code\u003e, set the value as \u003ccode\u003euserpics/868/T8SSG8E4EYSK.png\u003c/code\u003e(without prefix p)\u003c/li\u003e\n\u003cli\u003elogin, and request /vanilla/index.php?p=/profile/removepicture/\u003cstrong\u003eyourusername\u003c/strong\u003e\u0026amp;tk=\u003cstrong\u003eyourtk\u003c/strong\u003e\u0026amp;deliveryType=ALL\nThen the local file uploads/userpics/868/pT8SSG8E4EYSK.png will be deleted\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"anything-else-we-should-know\"\u003eAnything else we should know?\u003c/h2\u003e\n\n\u003cp\u003eBecause of the path restriction, only filepath matchs \u003ccode\u003euploads/*/p*\u003c/code\u003e can be deleted.\u003cbr\u003e\nWhitelist may better than blacklist, only a few fields should be permitted to insert into database where registration\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ebe able to delete profile photo of others\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":411066,"file_name":"3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/066/9bf86e66a34b1f9aed9b5575171ece7356f01364/3.png?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZJO3526D%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060550Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCIvMo8EBz315uHyZU%2FDG0Huf%2BYKjgYY96exJvyGCLJ6QIgTS1mW%2Fy84%2BDNAkhNbJC8Lysp3409zBR1BXDeS%2BTYRyoqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDEH1nkH4bxOL%2FzZVaiqRAz36Ga68aNU0H93UvEuRIu3bWdCaX174NDGE9HjZ6%2FIGHIDSo8%2BrgJclDinDvb%2Bz5hmDmKwxsZWntb8C077ZNi40vSm3S2BX7TIgKs7OdhHPP26QN5RZDLBCOd0pFTN5ykSL4WFPtakUEHIG05D09oYImqFNistW6N3pBf2hsoRXecWNFI7qMU5wkBMwH2QMBKxqwWAWEAbH6%2Bm%2FxceXV1a8FnL9d8Uhq%2F2Q494%2BZl8MTPuGY7b8f24oQWse7cwMUzvDfqk5TkNfLVSGvrldYvDZ5%2BxCgwagxuwM5onXgbXJ4rRlwsCuZjULhImoKeNv96uim58dbOdKVASQ6GndH5Nrd3tU1KMMgE8wulU71dP4zkXeWt6gi59gtfTvslGO582avOHZUkGIulK7r7JD3t1kTj7U8QaLGPznBskRPSjpug5C4fTdunIrlWgxxYPRSkn61QPQIYfO5cT0HvlOlcuNwaVarnH6q4OXAnE%2BiCH6ODeGHFc%2FbpDT1S1H%2FhTwMOseCmH6rpa9zpdueGS1v945MK%2F9qv8FOusBHn%2BLyL3HJMADkT5J%2FQsL%2Bm415pbG%2FB7sn6BT00QcjPotU4hSnic44MJSPfUmiSKj6d9gLy1f6TEKMFDfJSsENQ%2FaA%2FcWdZKIurcEqINLaFCH7pBgplCMxWUAgnjBUSd4R3H7RrO8ZQbJ3mfz5fAyaFiog5eNoktqTPC5U6knr6J5p0BqQz3pjKkZdFIlUKqlFwECcnX15GzWTOONLY2H8vGW7f3Jzu30NgpDT7w1IP4BRoOJg0NZFk0VVeK%2BYFVc3To9CA8AHQuJZBmtD%2B3SdCh%2FxMl87xH6SWR8e4W2edgavCy2dBUw0YFKbw%3D%3D\u0026X-Amz-Signature=96e10f7d8dd3aa0af0bde14715926d575268d1c6e24a6964550680f503faf126","file_size":58867,"type":"image/png"}],"allow_singular_disclosure_at":"2019-07-13T04:27:26.349Z","allow_singular_disclosure_after":-46229903.94919123,"singular_disclosure_allowed":true,"vote_count":31,"voters":["secator","hunter","bl4de","0xbeefed","spam404","ahiezer","mygf","aryan2808","realtess","tems","and 21 more..."],"severity":{"rating":"high","score":7.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":14809,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/vanilla/vanilla/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4023801,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://github.com/vanilla/vanilla/issues/8246 ","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/vanilla/vanilla/issues/8246\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvanilla%2Fvanilla%2Fissues%2F8246\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/vanilla/vanilla/issues/8246\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-23T11:18:05.758Z","updated_at":"2019-01-23T11:18:05.758Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4024275,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi there. Thank you for reporting this, however a similar report has already been submitted to us on HackerOne.","markdown_message":"\u003cp\u003eHi there. Thank you for reporting this, however a similar report has already been submitted to us on HackerOne.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-23T13:12:09.702Z","updated_at":"2019-01-23T13:12:09.702Z","original_report_id":394247,"actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4220862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Has this issue been resolved?\nIt still exists in latest version 2.8. And I find a new way to exploit this issue. It can be led to Local File Read.\n\nSteps to reproduce:\n1. find the file to read (eg: `/etc/passwd`)\n2. register a new user and intercept the request, add a field Photo, set the value as `static://v/lugins\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd`\n3. forward the request to finish the registration\n4. login, and request /vanilla/index.php?p=/profile/picture\nThen the local file `/etc/passwd` will be copied to `/uploads/tmp-static/plugins-..-..-..-..-..-..-..-..-etc-passwd`","markdown_message":"\u003cp\u003eHas this issue been resolved?\u003cbr\u003e\nIt still exists in latest version 2.8. And I find a new way to exploit this issue. It can be led to Local File Read.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003efind the file to read (eg: \u003ccode\u003e/etc/passwd\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eregister a new user and intercept the request, add a field Photo, set the value as \u003ccode\u003estatic://v/lugins\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eforward the request to finish the registration\u003c/li\u003e\n\u003cli\u003elogin, and request /vanilla/index.php?p=/profile/picture\nThen the local file \u003ccode\u003e/etc/passwd\u003c/code\u003e will be copied to \u003ccode\u003e/uploads/tmp-static/plugins-..-..-..-..-..-..-..-..-etc-passwd\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2019-02-27T05:53:02.016Z","updated_at":"2019-02-27T05:53:02.016Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":432139,"filename":"333.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/432/139/6f9c98f6c9f78aef7f954938b00bb38fedf88596/333.png?response-content-disposition=attachment%3B%20filename%3D%22333.png%22%3B%20filename%2A%3DUTF-8%27%27333.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZJO3526D%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060550Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCIvMo8EBz315uHyZU%2FDG0Huf%2BYKjgYY96exJvyGCLJ6QIgTS1mW%2Fy84%2BDNAkhNbJC8Lysp3409zBR1BXDeS%2BTYRyoqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDEH1nkH4bxOL%2FzZVaiqRAz36Ga68aNU0H93UvEuRIu3bWdCaX174NDGE9HjZ6%2FIGHIDSo8%2BrgJclDinDvb%2Bz5hmDmKwxsZWntb8C077ZNi40vSm3S2BX7TIgKs7OdhHPP26QN5RZDLBCOd0pFTN5ykSL4WFPtakUEHIG05D09oYImqFNistW6N3pBf2hsoRXecWNFI7qMU5wkBMwH2QMBKxqwWAWEAbH6%2Bm%2FxceXV1a8FnL9d8Uhq%2F2Q494%2BZl8MTPuGY7b8f24oQWse7cwMUzvDfqk5TkNfLVSGvrldYvDZ5%2BxCgwagxuwM5onXgbXJ4rRlwsCuZjULhImoKeNv96uim58dbOdKVASQ6GndH5Nrd3tU1KMMgE8wulU71dP4zkXeWt6gi59gtfTvslGO582avOHZUkGIulK7r7JD3t1kTj7U8QaLGPznBskRPSjpug5C4fTdunIrlWgxxYPRSkn61QPQIYfO5cT0HvlOlcuNwaVarnH6q4OXAnE%2BiCH6ODeGHFc%2FbpDT1S1H%2FhTwMOseCmH6rpa9zpdueGS1v945MK%2F9qv8FOusBHn%2BLyL3HJMADkT5J%2FQsL%2Bm415pbG%2FB7sn6BT00QcjPotU4hSnic44MJSPfUmiSKj6d9gLy1f6TEKMFDfJSsENQ%2FaA%2FcWdZKIurcEqINLaFCH7pBgplCMxWUAgnjBUSd4R3H7RrO8ZQbJ3mfz5fAyaFiog5eNoktqTPC5U6knr6J5p0BqQz3pjKkZdFIlUKqlFwECcnX15GzWTOONLY2H8vGW7f3Jzu30NgpDT7w1IP4BRoOJg0NZFk0VVeK%2BYFVc3To9CA8AHQuJZBmtD%2B3SdCh%2FxMl87xH6SWR8e4W2edgavCy2dBUw0YFKbw%3D%3D\u0026X-Amz-Signature=6dd66d657d43478664237b95593d7cfc9ac4bc965f3cd42711fb79cbb4925d83"},{"id":432133,"filename":"111.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/432/133/99dc5c80539d2c52899d0e4204f205af8f5f68c5/111.png?response-content-disposition=attachment%3B%20filename%3D%22111.png%22%3B%20filename%2A%3DUTF-8%27%27111.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZJO3526D%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060550Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCIvMo8EBz315uHyZU%2FDG0Huf%2BYKjgYY96exJvyGCLJ6QIgTS1mW%2Fy84%2BDNAkhNbJC8Lysp3409zBR1BXDeS%2BTYRyoqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDEH1nkH4bxOL%2FzZVaiqRAz36Ga68aNU0H93UvEuRIu3bWdCaX174NDGE9HjZ6%2FIGHIDSo8%2BrgJclDinDvb%2Bz5hmDmKwxsZWntb8C077ZNi40vSm3S2BX7TIgKs7OdhHPP26QN5RZDLBCOd0pFTN5ykSL4WFPtakUEHIG05D09oYImqFNistW6N3pBf2hsoRXecWNFI7qMU5wkBMwH2QMBKxqwWAWEAbH6%2Bm%2FxceXV1a8FnL9d8Uhq%2F2Q494%2BZl8MTPuGY7b8f24oQWse7cwMUzvDfqk5TkNfLVSGvrldYvDZ5%2BxCgwagxuwM5onXgbXJ4rRlwsCuZjULhImoKeNv96uim58dbOdKVASQ6GndH5Nrd3tU1KMMgE8wulU71dP4zkXeWt6gi59gtfTvslGO582avOHZUkGIulK7r7JD3t1kTj7U8QaLGPznBskRPSjpug5C4fTdunIrlWgxxYPRSkn61QPQIYfO5cT0HvlOlcuNwaVarnH6q4OXAnE%2BiCH6ODeGHFc%2FbpDT1S1H%2FhTwMOseCmH6rpa9zpdueGS1v945MK%2F9qv8FOusBHn%2BLyL3HJMADkT5J%2FQsL%2Bm415pbG%2FB7sn6BT00QcjPotU4hSnic44MJSPfUmiSKj6d9gLy1f6TEKMFDfJSsENQ%2FaA%2FcWdZKIurcEqINLaFCH7pBgplCMxWUAgnjBUSd4R3H7RrO8ZQbJ3mfz5fAyaFiog5eNoktqTPC5U6knr6J5p0BqQz3pjKkZdFIlUKqlFwECcnX15GzWTOONLY2H8vGW7f3Jzu30NgpDT7w1IP4BRoOJg0NZFk0VVeK%2BYFVc3To9CA8AHQuJZBmtD%2B3SdCh%2FxMl87xH6SWR8e4W2edgavCy2dBUw0YFKbw%3D%3D\u0026X-Amz-Signature=3df2c27431df0e22f58c10599d8caa29511f7b45d06f9832c68652be36b3d1ce"}],"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4223810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will check and get back to you.\nThank you alb3r7.","markdown_message":"\u003cp\u003eI will check and get back to you.\u003cbr\u003e\nThank you alb3r7.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-27T13:03:59.083Z","updated_at":"2019-02-27T13:03:59.083Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4227945,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is more details, I hope that will be helpful.\n### Analysis of Local File Read\nIn `/application/dashboard/controllers/class.profilecontroller.php` Line 835\n```\n        if ($this-\u003eisUploadedAvatar($avatar)) {\n            // Get the image source so we can manipulate it in the crop module.\n            $upload = new Gdn_UploadImage();\n            $thumbnailSize = c('Garden.Thumbnail.Size');\n            $basename = changeBasename($avatar, \"p%s\");\n            $source = $upload-\u003ecopyLocal($basename);\n```\nIt copies the Photo to local path. `copyLocal` is in `/library/core/class.upload.php` Line 100\n```\n    public function copyLocal($name) {\n        $parsed = self::parse($name);\n\n        $localPath = '';\n        $this-\u003eEventArguments['Parsed'] = $parsed;\n        $this-\u003eEventArguments['Path'] =\u0026 $localPath;\n\n        $this-\u003efireAs('Gdn_Upload')-\u003efireEvent('CopyLocal');\n        if (!$localPath) {\n            $localPath = PATH_UPLOADS.'/'.$parsed['Name'];\n        }\n        return $localPath;\n    }\n```\nFire the event `CopyLocal` to do the actual Copy.\nIn `/application/dashboard/settings/class.hooks.php` Line 876\n```\n    public function gdn_upload_copyLocal_handler($sender, $args) {\n        $parsed = $args['Parsed'];\n        if ($parsed['Type'] !== 'static' || $parsed['Domain'] !== 'v') {\n            return;\n        }\n\n        $remotePath = PATH_ROOT.'/'.$parsed['Name'];\n\n        // Since this is just a temp file we don't want to nest it in a bunch of subfolders.\n        $localPath = paths(PATH_UPLOADS, 'tmp-static', str_replace('/', '-', $parsed['Name']));\n\n        // Make sure the destination path exists\n        if (!file_exists(dirname($localPath))) {\n            mkdir(dirname($localPath), 0777, true);\n        }\n\n        // Copy\n        copy($remotePath, $localPath);\n\n        $args['Path'] = $localPath;\n    }\n```\nCopy `$remotePath` to `$localPath`, but it doesn't check the real path of `$remotePath`. So by Manipulating the value of User Photo, we can manipulate the `$remotePath`. It causes the Local File Read.\n***Check the `$remotePath` may solve this issue***\n\n### Another way to manipulate the value of User Photo \nWhen we edit profile, we can update the `Photo`. It checks the value of Photo, but it doesn't work well. In `/applications/dashboard/controllers/class.profilecontroller.php` Line 485\n```\n            // Don't allow non-mods to set an explicit photo.\n            if ($photo = $this-\u003eForm-\u003egetFormValue('Photo')) {\n                if (!Gdn_Upload::isUploadUri($photo)) {\n                    if (!checkPermission('Garden.Users.Edit')) {\n                        $this-\u003eForm-\u003eremoveFormValue('Photo');\n                    } elseif (!filter_var($photo, FILTER_VALIDATE_URL)) {\n                        $this-\u003eForm-\u003eaddError('Invalid photo URL.');\n                    }\n                }\n            }\n```\n`static://v/lugins\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd` can bypass these checks.\nStep to reproduce this:\n1. Edit your own profile, don't need to change anything, just click save\n2. Enter Your Password, and intercept the request,\n3. Add `,\"Photo\":\"static://v/lugins\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\etc\\\\passwd\"` into OriginalSubmission\n4. Forward the request\n\nWhen the server finish this request, the value of Photo will be changed","markdown_message":"\u003cp\u003eHere is more details, I hope that will be helpful.\u003c/p\u003e\n\n\u003ch3 id=\"analysis-of-local-file-read\"\u003eAnalysis of Local File Read\u003c/h3\u003e\n\n\u003cp\u003eIn \u003ccode\u003e/application/dashboard/controllers/class.profilecontroller.php\u003c/code\u003e Line 835\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        if ($this-\u0026gt;isUploadedAvatar($avatar)) {\n            // Get the image source so we can manipulate it in the crop module.\n            $upload = new Gdn_UploadImage();\n            $thumbnailSize = c(\u0026#39;Garden.Thumbnail.Size\u0026#39;);\n            $basename = changeBasename($avatar, \u0026quot;p%s\u0026quot;);\n            $source = $upload-\u0026gt;copyLocal($basename);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt copies the Photo to local path. \u003ccode\u003ecopyLocal\u003c/code\u003e is in \u003ccode\u003e/library/core/class.upload.php\u003c/code\u003e Line 100\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    public function copyLocal($name) {\n        $parsed = self::parse($name);\n\n        $localPath = \u0026#39;\u0026#39;;\n        $this-\u0026gt;EventArguments[\u0026#39;Parsed\u0026#39;] = $parsed;\n        $this-\u0026gt;EventArguments[\u0026#39;Path\u0026#39;] =\u0026amp; $localPath;\n\n        $this-\u0026gt;fireAs(\u0026#39;Gdn_Upload\u0026#39;)-\u0026gt;fireEvent(\u0026#39;CopyLocal\u0026#39;);\n        if (!$localPath) {\n            $localPath = PATH_UPLOADS.\u0026#39;/\u0026#39;.$parsed[\u0026#39;Name\u0026#39;];\n        }\n        return $localPath;\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFire the event \u003ccode\u003eCopyLocal\u003c/code\u003e to do the actual Copy.\u003cbr\u003e\nIn \u003ccode\u003e/application/dashboard/settings/class.hooks.php\u003c/code\u003e Line 876\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    public function gdn_upload_copyLocal_handler($sender, $args) {\n        $parsed = $args[\u0026#39;Parsed\u0026#39;];\n        if ($parsed[\u0026#39;Type\u0026#39;] !== \u0026#39;static\u0026#39; || $parsed[\u0026#39;Domain\u0026#39;] !== \u0026#39;v\u0026#39;) {\n            return;\n        }\n\n        $remotePath = PATH_ROOT.\u0026#39;/\u0026#39;.$parsed[\u0026#39;Name\u0026#39;];\n\n        // Since this is just a temp file we don\u0026#39;t want to nest it in a bunch of subfolders.\n        $localPath = paths(PATH_UPLOADS, \u0026#39;tmp-static\u0026#39;, str_replace(\u0026#39;/\u0026#39;, \u0026#39;-\u0026#39;, $parsed[\u0026#39;Name\u0026#39;]));\n\n        // Make sure the destination path exists\n        if (!file_exists(dirname($localPath))) {\n            mkdir(dirname($localPath), 0777, true);\n        }\n\n        // Copy\n        copy($remotePath, $localPath);\n\n        $args[\u0026#39;Path\u0026#39;] = $localPath;\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCopy \u003ccode\u003e$remotePath\u003c/code\u003e to \u003ccode\u003e$localPath\u003c/code\u003e, but it doesn\u0026#39;t check the real path of \u003ccode\u003e$remotePath\u003c/code\u003e. So by Manipulating the value of User Photo, we can manipulate the \u003ccode\u003e$remotePath\u003c/code\u003e. It causes the Local File Read.\u003cbr\u003e\n\u003cstrong\u003e\u003cem\u003eCheck the \u003ccode\u003e$remotePath\u003c/code\u003e may solve this issue\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3 id=\"another-way-to-manipulate-the-value-of-user-photo\"\u003eAnother way to manipulate the value of User Photo\u003c/h3\u003e\n\n\u003cp\u003eWhen we edit profile, we can update the \u003ccode\u003ePhoto\u003c/code\u003e. It checks the value of Photo, but it doesn\u0026#39;t work well. In \u003ccode\u003e/applications/dashboard/controllers/class.profilecontroller.php\u003c/code\u003e Line 485\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e            // Don\u0026#39;t allow non-mods to set an explicit photo.\n            if ($photo = $this-\u0026gt;Form-\u0026gt;getFormValue(\u0026#39;Photo\u0026#39;)) {\n                if (!Gdn_Upload::isUploadUri($photo)) {\n                    if (!checkPermission(\u0026#39;Garden.Users.Edit\u0026#39;)) {\n                        $this-\u0026gt;Form-\u0026gt;removeFormValue(\u0026#39;Photo\u0026#39;);\n                    } elseif (!filter_var($photo, FILTER_VALIDATE_URL)) {\n                        $this-\u0026gt;Form-\u0026gt;addError(\u0026#39;Invalid photo URL.\u0026#39;);\n                    }\n                }\n            }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003estatic://v/lugins\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd\u003c/code\u003e can bypass these checks.\u003cbr\u003e\nStep to reproduce this:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eEdit your own profile, don\u0026#39;t need to change anything, just click save\u003c/li\u003e\n\u003cli\u003eEnter Your Password, and intercept the request,\u003c/li\u003e\n\u003cli\u003eAdd \u003ccode\u003e,\u0026quot;Photo\u0026quot;:\u0026quot;static://v/lugins\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\etc\\\\passwd\u0026quot;\u003c/code\u003e into OriginalSubmission\u003c/li\u003e\n\u003cli\u003eForward the request\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhen the server finish this request, the value of Photo will be changed\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-28T02:56:16.523Z","updated_at":"2019-02-28T02:56:16.523Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4255283,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"I rechecked this report and it's valid.\n","markdown_message":"\u003cp\u003eI rechecked this report and it\u0026#39;s valid.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T19:33:17.492Z","updated_at":"2019-03-04T19:33:17.492Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4255298,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting it. It's now triaged.","markdown_message":"\u003cp\u003eThank you for reporting it. It\u0026#39;s now triaged.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T19:34:34.854Z","updated_at":"2019-03-04T19:34:34.854Z","actor":{"username":"dexterr","cleared":false,"url":"/dexterr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/201/201/11a7da9d5256f50a86acdf6a8f3366252baee73e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4291694,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-09T15:08:49.142Z","updated_at":"2019-03-09T15:08:49.142Z","additional_data":{"old_severity":"Low","new_severity":"Medium (4.3)","old_severity_id":284909,"new_severity_id":313344},"actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4291695,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-09T15:08:57.800Z","updated_at":"2019-03-09T15:08:57.800Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"alb3r7","url":"/alb3r7"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4293071,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi guys, I wonder know why the Severity is Medium. Attacker can access the sensitive file on server with http user privilege(maybe www-data)","markdown_message":"\u003cp\u003eHi guys, I wonder know why the Severity is Medium. Attacker can access the sensitive file on server with http user privilege(maybe www-data)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T04:10:01.993Z","updated_at":"2019-03-10T04:10:01.993Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4294975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Using the CVSS 2.0 calculator, we determined that this vulnerability had an Integrity score of Low due to the very restricted ability to work within the parameters you described in this ticket. The Confidentiality score is None (uploads folder is public) and the Availability score is None (does not affect uptime or system availability). If you have further questions about using the CVSS 2.0 calculator, let us know.","markdown_message":"\u003cp\u003eUsing the CVSS 2.0 calculator, we determined that this vulnerability had an Integrity score of Low due to the very restricted ability to work within the parameters you described in this ticket. The Confidentiality score is None (uploads folder is public) and the Availability score is None (does not affect uptime or system availability). If you have further questions about using the CVSS 2.0 calculator, let us know.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T16:36:29.004Z","updated_at":"2019-03-10T16:36:29.004Z","actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4296385,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@linc \nHi, thanks for your answer. But I don't think You have understood this problem.\nThe whole impact is that:\nAttacker can copy any private file in the Server to the uploads folder, and then he can access the content of this private file. Because HTTP daemon user is www-data(low privilege) usually, Attacker can read partial files.\n\nThe Integrity score is Partial.\nThe Confidentiality score is Partial.\nThe Availability score is Partial.\nAnd If you use the CVSS 3.0 calculator, this 3 parameters should be set as Low","markdown_message":"\u003cp\u003e\u003ca href=\"/linc\"\u003e@linc\u003c/a\u003e \u003cbr\u003e\nHi, thanks for your answer. But I don\u0026#39;t think You have understood this problem.\u003cbr\u003e\nThe whole impact is that:\u003cbr\u003e\nAttacker can copy any private file in the Server to the uploads folder, and then he can access the content of this private file. Because HTTP daemon user is www-data(low privilege) usually, Attacker can read partial files.\u003c/p\u003e\n\n\u003cp\u003eThe Integrity score is Partial.\u003cbr\u003e\nThe Confidentiality score is Partial.\u003cbr\u003e\nThe Availability score is Partial.\u003cbr\u003e\nAnd If you use the CVSS 3.0 calculator, this 3 parameters should be set as Low\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T03:50:08.529Z","updated_at":"2019-03-11T03:50:08.529Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4307223,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T12:36:32.226Z","updated_at":"2019-03-12T12:36:32.226Z","additional_data":{"old_severity":"Medium (4.3)","new_severity":"High (7.6)","old_severity_id":313344,"new_severity_id":314740},"actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4307239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're correct, I was only evaluating your initial report, not the followups that expanded the scope.\n\nTo clarify, I meant to say CVSS 3.0, not 2.0.\n\nFYI, changing all 3 (Integrity, Confidentiality, Availability) to Low still only resulted in a Medium. I moved Confidentiality to High, which moved the overall severity up.","markdown_message":"\u003cp\u003eYou\u0026#39;re correct, I was only evaluating your initial report, not the followups that expanded the scope.\u003c/p\u003e\n\n\u003cp\u003eTo clarify, I meant to say CVSS 3.0, not 2.0.\u003c/p\u003e\n\n\u003cp\u003eFYI, changing all 3 (Integrity, Confidentiality, Availability) to Low still only resulted in a Medium. I moved Confidentiality to High, which moved the overall severity up.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T12:38:58.732Z","updated_at":"2019-03-12T12:38:58.732Z","actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4307250,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Doubling bounty to reach 'High' severity.","markdown_message":"\u003cp\u003eDoubling bounty to reach \u0026#39;High\u0026#39; severity.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T12:40:30.529Z","updated_at":"2019-03-12T12:40:30.529Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vanilla","collaborator":{"username":"alb3r7","url":"/alb3r7"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4312887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thx.\nMaybe you can update the title to `Unsanitized User Photo URL Lead to Local File Read` or other better titles","markdown_message":"\u003cp\u003ethx.\u003cbr\u003e\nMaybe you can update the title to \u003ccode\u003eUnsanitized User Photo URL Lead to Local File Read\u003c/code\u003e or other better titles\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T01:40:53.345Z","updated_at":"2019-03-13T01:40:53.345Z","actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4317091,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T15:29:25.500Z","updated_at":"2019-03-13T15:29:25.500Z","additional_data":{"old_title":"Be able to delete the profile photo of others","new_title":"Unsanitized user photo paths allow local file read"},"actor":{"username":"linc","cleared":false,"url":"/linc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/136/045/6328894ce30b4f6b0e176d2a721ce5ea9849d135_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5074027,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Released with (or before): https://success.vanillaforums.com/kb/articles/85-2019-007","markdown_message":"\u003cp\u003eReleased with (or before): \u003ca title=\"https://success.vanillaforums.com/kb/articles/85-2019-007\" href=\"/redirect?url=https%3A%2F%2Fsuccess.vanillaforums.com%2Fkb%2Farticles%2F85-2019-007\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://success.vanillaforums.com/kb/articles/85-2019-007\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-12T20:06:06.979Z","updated_at":"2019-06-12T20:06:06.979Z","actor":{"username":"alex-vf","cleared":false,"url":"/alex-vf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"alb3r7","url":"/alb3r7"},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5076327,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-13T04:27:26.285Z","updated_at":"2019-06-13T04:27:26.285Z","first_to_agree":true,"actor":{"username":"alb3r7","cleared":false,"url":"/alb3r7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/180/ce539542de07b2104fe48c7eca2af3cb3d583dca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5313309,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-13T04:27:29.353Z","updated_at":"2019-07-13T04:27:29.353Z","actor":{"url":"/vanilla","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vanilla"}},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}