{"id":976441,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NzY0NDE=","url":"https://hackerone.com/reports/976441","title":"removed user can still join the organization","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-09-07T21:34:38.926Z","submitted_at":"2020-09-07T21:34:39.114Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"moon_shadow","url":"/moon_shadow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/D9kskBWfKH6iAZJSrAxqKd9z/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-05-10T11:24:51.411Z","bug_reporter_agreed_on_going_public_at":"2021-05-08T20:27:26.256Z","team_member_agreed_on_going_public_at":"2021-05-10T11:24:51.314Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hi, \n i would like to report an issue i have found that allow attacker to join organization even if the attacker is removed.\ni found out that when adding new user, if you add a new user without verifying the email address, you change the email of the user, the email address you initially send the invitation to would receive the invitation and can be able to join the organization and override you update setting even though you changed that user email address\n\nattack scenario\nan admin while adding a new user might mistype the email and sending the request, he would realize and correct the email address, the user having the mistyped email shouldn't suppose to be able to join the organization since the admin have corrected the email to the correct one, but i found out that even after changing the email the user having mistyped email would be able to join the organization overriding the admin's setting.\n\nsteps to reproduce\nafter creating the account you will need two adding emails or you can use email aliases\n\n1 login using your admin account\n2 click on your account setting\n3 click on manage your plan\n4 click on manage users\n5 add new user using your first email e.g vimctim1@test.com\n6 update the user to second email e.g victim2@test.com\n7 goto victim1@test.com inbox and click on verification email you received (you would be able to verify the email and you will be able to join the organization)\n\nbelow is the video demonstrating how to reproduce the issue\n\n## Impact\n\nattacker can be to join the organization, even when the user is removed","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":979315,"file_name":"newrelic.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iv227YEPqyXEfT5oxFjeZ5Xd?response-content-disposition=attachment%3B%20filename%3D%22newrelic.mp4%22%3B%20filename%2A%3DUTF-8%27%27newrelic.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154738Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=614aaad2ca138847953cd762fa2fe14f60cea470a1a93d8187c45ba52906868d","file_size":7633051,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-06-07T20:27:26.325Z","allow_singular_disclosure_after":-10869612.531643216,"singular_disclosure_allowed":true,"vote_count":34,"voters":["neptunium","ali","mattberg","predator_97","h4x0r_dz","akashhamal0x01","ganofins","cryptographer","moon_shadow","rao_ji1hackerone","and 24 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":4405,"asset_type":"URL","asset_identifier":"*.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9183945,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @moon_shadow,\n\nThanks for the report. Can you confirm something for me? Everything you described is correct and I was able to reproduce that behavior. When victim1@test.com follows the email instructions to sign into the account, I see that they are logged in as victim1@test.com. Not as victim2@test.com.\n\nThe user management page will show victim2@test.com as the new user until victim1@test.com logs in, at which point it will revert back to victim1@test.com.\n\nIs that what you're seeing as well?\n\nIf a new email was generated for victim2@test.com and the link sent to victim1@test.com allowed that user to login as victim2@test.com, I would see that as being very problematic but I'm not seeing that behavior.\n\nTo me, it seems like this works like I would expect. An admin mistakenly invites victim1@test.com and that user is able to log into the account. Once that happens, an admin could review the list of users and they would see that victim1@test.com, the incorrect user, is a member.\n\nHopefully that makes sense. Let me know if I can clarify my question.\n\nThanks,\nDaniel","automated_response":false,"created_at":"2020-09-10T21:27:50.421Z","updated_at":"2020-09-10T21:27:50.421Z","actor":{"username":"dhartnell","cleared":false,"url":"/dhartnell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9187684,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The scenario is you want to invite user with email victim@test.com\nBut mistakenly you mistyped and invite victam@test.com\nAfter you realize that you edit the user and correct the user email to victim@test.com,\nSince the verification email sent to the first user victam@test.com is mistake i and is already corrected I think the verification email should be invalidated, and the mistaken user should not suppose to be able to join the team, but as you can see when you update the user email you will receive a notification saying that the user is successfully updated, but still the mistaken user would be able to join the team and the user correct the email to his email, victim@test.com would not receive the verification email.","automated_response":false,"created_at":"2020-09-11T06:42:56.445Z","updated_at":"2020-09-11T06:42:56.445Z","actor":{"username":"moon_shadow","cleared":false,"url":"/moon_shadow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/D9kskBWfKH6iAZJSrAxqKd9z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9199238,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-12T01:09:58.812Z","updated_at":"2020-09-12T01:09:58.812Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":839720,"new_severity_id":844185},"actor":{"username":"dhartnell","cleared":false,"url":"/dhartnell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9199240,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-09-12T01:10:15.442Z","updated_at":"2020-09-12T01:10:15.442Z","actor":{"username":"dhartnell","cleared":false,"url":"/dhartnell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9199242,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @moon_shadow,\n\nI was able to notify our engineering team and we'll be working together to see how we might want to address this. Considering the low likelihood of this being used maliciously, I have set a low severity.\n\nWe appreciate the report. I can get you an update when we have more information.\n\nCheers!\nDaniel","automated_response":false,"created_at":"2020-09-12T01:13:06.406Z","updated_at":"2020-09-12T01:13:06.406Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"moon_shadow","url":"/moon_shadow"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9201313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty","automated_response":false,"created_at":"2020-09-12T10:55:41.513Z","updated_at":"2020-09-12T10:55:41.513Z","actor":{"username":"moon_shadow","cleared":false,"url":"/moon_shadow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/D9kskBWfKH6iAZJSrAxqKd9z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10134556,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @moon_shadow,\n\nWe believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!\n\nRegards,\nDaniel","automated_response":false,"created_at":"2020-12-17T16:26:39.108Z","updated_at":"2020-12-17T16:26:39.108Z","actor":{"username":"dhartnell","cleared":false,"url":"/dhartnell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"moon_shadow","url":"/moon_shadow"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11672218,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-08T20:27:26.287Z","updated_at":"2021-05-08T20:27:26.287Z","first_to_agree":true,"actor":{"username":"moon_shadow","cleared":false,"url":"/moon_shadow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/D9kskBWfKH6iAZJSrAxqKd9z/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11682006,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-10T11:24:51.343Z","updated_at":"2021-05-10T11:24:51.343Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11682007,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-10T11:24:51.458Z","updated_at":"2021-05-10T11:24:51.458Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}