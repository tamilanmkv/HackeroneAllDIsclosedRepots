{"id":262620,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjI2MjA=","url":"https://hackerone.com/reports/262620","title":"Gratipay rails secret token (secret_key_base) publicly exposed in GitHub","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-23T16:40:01.692Z","submitted_at":"2017-08-23T16:40:01.692Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp4rrow","url":"/sp4rrow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/167/668/c142929e727824c63deec1fc890ea2d0c3473477_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-23T17:04:45.686Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-08-23T16:51:52.281Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\nGratipay's Rails secret token is publicly exposed on GitHub. Knowing the secret token allows an attacker to impersonate any user in the application.\n\nThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects, below is the referenced github for the analysis. \n\n# Description\nThe `secret_token.rb` file's content includes a long randomized string which is used to verify the integrity of signed cookies (such as user sessions when people are signed into your web app).\n[Documentation](http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html) says:\n\u003e Use your existing `secret_key_base` from the `secret_token.rb` initializer to set the `SECRET_KEY_BASE` environment variable for whichever users run the Rails app in production mode. Alternately, you can simply copy the existing `secret_key_base` from the `secret_token.rb` initializer to `secrets.yml` under the production section, replacing `\u003c%= ENV[\"SECRET_KEY_BASE\"] %\u003e`.\n\u003e Make sure your secret_key_base is kept private\nif you're sharing your code publicly.\n\n**Further Details:**\nKnowing the secret token allows an attacker to impersonate any user in the application.\n\n# Steps To Reproduce\nGo to the Gratipay \"Access Dashboard\" project (https://github.com/gratipay/access-dashboard/blob/rails-recode/config/initializers)\nIn the `secret_token.rb` file the `secret_key_base` is publicly disclosed.\nAs per the comments in the code as well as the documentation the key should always be kept private, looks like the developer forgot to remove the token. Happens! Too much work sometimes and the expected delivery deadlines :)\n\n# Patch\nRemoving the secret key would do the work!\n\n# Supporting Material/References:\nThanks to EdOverflow for sharing the tips for finding security issues in GitHub projects. :)\n(https://gist.github.com/EdOverflow/922549f610b258f459b219a32f92d10b)\n\nPlease let me know if any further information is needed on this.\n\nBR,\nnull","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-22T16:51:52.344Z","allow_singular_disclosure_after":-127863664.63915351,"singular_disclosure_allowed":true,"vote_count":9,"voters":["sp1d3rs","dawgyg","ngalog","skansing","eveeez","khizer47","sp4rrow","edio","coldbrew"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":373,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/gratipay/bot","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1949359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","automated_response":true,"created_at":"2017-08-23T16:40:01.885Z","updated_at":"2017-08-23T16:40:01.885Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1949366,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @nuii,\n\nThis looks like a valid issue. While it is out of scope, we have made an exception and decided to accept this report. The issue cannot currently be exploited since the app has never been deployed, but we would like to prevent any confusion and possible deployment of this vulnerable app in the future.\n\nAlso I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)\n\nBest regards,\nEdOverflow ","automated_response":false,"created_at":"2017-08-23T16:44:27.894Z","updated_at":"2017-08-23T16:44:27.894Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949378,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @nuii,\n\nThank you very much for the report. We have resolved this issue by removing the affected branch, but we plan on removing the whole repo at some point too.\n\nBest regards,\nEdOverflow","automated_response":false,"created_at":"2017-08-23T16:51:43.355Z","updated_at":"2017-08-23T16:51:43.355Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp4rrow","url":"/sp4rrow"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949379,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-23T16:51:52.312Z","updated_at":"2017-08-23T16:51:52.312Z","first_to_agree":true,"actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wooo, it's fixed. \nThis was really fast :)\nThe secret_token.rb file isnt accessible anymore.\n\n_Also I am super happy to see someone has learnt something from my blog post. There is nothing more rewarding than seeing someone find an issue thanks to your write-up. :)_\n\nThanks for the writeups Ed. They are really helpful, keep sharing.\n\nWe can disclose this.\n","automated_response":false,"created_at":"2017-08-23T17:01:38.751Z","updated_at":"2017-08-23T17:01:38.751Z","actor":{"username":"sp4rrow","cleared":false,"url":"/sp4rrow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/668/c142929e727824c63deec1fc890ea2d0c3473477_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1949409,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-08-23T17:04:45.668Z","updated_at":"2017-08-23T17:04:45.668Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1949410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Keep up the good work @nuii!","automated_response":false,"created_at":"2017-08-23T17:05:20.416Z","updated_at":"2017-08-23T17:05:20.416Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2036449,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-10-01T12:41:43.353Z","updated_at":"2017-10-01T12:41:43.353Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}