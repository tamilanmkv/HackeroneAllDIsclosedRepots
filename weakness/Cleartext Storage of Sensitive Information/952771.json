{"id":952771,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTI3NzE=","url":"https://hackerone.com/reports/952771","title":"CVE-2019-11250 remains in effect.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-08-06T17:42:21.805Z","submitted_at":"2020-08-06T17:42:21.852Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"purelyapplied","url":"/purelyapplied","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39386,"url":"https://hackerone.com/kubernetes","handle":"kubernetes","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kubernetes","twitter_handle":"kubernetesio","website":"https://kubernetes.io/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8565","CVE-2019-11250"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-29T21:23:11.134Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-30T21:23:04.168Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Report Submission Form\n\n## Summary:\n\"CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs\" remains in effect.  \n\n## Kubernetes Version:\nEffects at least all versions since 1.4.\n- This was determined with some `git` archaeology.  This was determined by following the code snippet from it's current location in `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go`\n- The snippet was last meaningfully modified \n- It's current location in The snippet remains relatively unchanged since \n\n## Component Version:\nI'm not sure.\n\n## Steps To Reproduce:\n1. Spin up a cluster with high verbosity: klog.V(9).Enabled()\n1. Watch logs  round_trippers.go `curl -k -v -X\u003c\u003e -H \"Authorization: \u003ctoken\u003e\" \u003c...\u003e`\n\nI was having trouble getting a cluster spun up, so I have not managed a live reproduction.\n\n## Supporting Material/References:\n[Issue \\#81146: Kubernetes 3rd Party Security Audit Findings]\n(https://github.com/kubernetes/kubernetes/issues/81146)\n\n[Issue  \\#81114: CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs]\n(https://github.com/kubernetes/kubernetes/issues/81114)\n\n[Partial fix for \\#81114: PR \\#81330]\n(https://github.com/kubernetes/kubernetes/pull/81330).\nNote that only `debuggingRoundTripper.RoundTrip` only masks headers in the `if rt.levels[debugRequestHeaders]` block, exposure is also present in the \n`if rt.levels[debugCurlCommand] {klog.Infof(\"%s\", reqInfo.toCurl())}` preceding it.\n\nAt `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:416`:\n```golang\nfunc (rt *debuggingRoundTripper) RoundTrip(req *http.Request) (*http.Response, error) {\n\treqInfo := newRequestInfo(req)\n\n\tif rt.levels[debugJustURL] {\n\t\tklog.Infof(\"%s %s\", reqInfo.RequestVerb, reqInfo.RequestURL)\n\t}\n\tif rt.levels[debugCurlCommand] {\n\t\tklog.Infof(\"%s\", reqInfo.toCurl())\n\t}\n\tif rt.levels[debugRequestHeaders] {\n\t\tklog.Infof(\"Request Headers:\")\n\t\tfor key, values := range reqInfo.RequestHeaders {\n\t\t\tfor _, value := range values {\n\t\t\t\tvalue = maskValue(key, value)\n\t\t\t\tklog.Infof(\"    %s: %s\", key, value)\n\t\t\t}\n\t\t}\n\t}\n\t// \u003cfunction continues\u003e\n}\n```\n\nAt `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:338`:\n```golang\n// toCurl returns a string that can be run as a command in a terminal (minus the body)\nfunc (r *requestInfo) toCurl() string {\n\theaders := \"\"\n\tfor key, values := range r.RequestHeaders {\n\t\tfor _, value := range values {\n\t\t\theaders += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))\n\t\t}\n\t}\n\n\treturn fmt.Sprintf(\"curl -k -v -X%s %s '%s'\", r.RequestVerb, headers, r.RequestURL)\n}\n```\n\nCorrection will be a one-line diff to use `maskValue` in this loop as well.\n\n## Impact\n\n\u003e Alice logs into a Kubernetes cluster and is issued a Bearer token. The system logs her\ntoken. Eve, who has access to the logs but not the production Kubernetes cluster, replays\nAliceâ€™s Bearer token, and can masquerade as Alice to the cluster.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-29T21:23:04.259Z","allow_singular_disclosure_after":-27282105.30931563,"singular_disclosure_allowed":true,"vote_count":1,"voters":["khizer47"],"severity":{"rating":"medium","score":4.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":32459,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/kubernetes/kubernetes","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8870912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @purelyapplied - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.","automated_response":false,"created_at":"2020-08-07T02:53:08.169Z","updated_at":"2020-08-07T02:53:08.169Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8879536,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @purelyapplied - Thanks for the report! Can you please provide more details in your step-by-step instructions?","automated_response":false,"created_at":"2020-08-07T21:44:25.831Z","updated_at":"2020-08-07T21:44:25.831Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8920922,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I just wanted to ACK the request for a real reproduction.  I'll hopefully have it tomorrow or Friday.","automated_response":false,"created_at":"2020-08-12T23:56:23.751Z","updated_at":"2020-08-12T23:56:23.751Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8932219,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for letting me know @purelyapplied! ","automated_response":false,"created_at":"2020-08-13T23:30:57.625Z","updated_at":"2020-08-13T23:30:57.625Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8973576,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Reproduction was pretty straight-forward once I reviewed the authentication and testing documentation.\n\n0\\. From a clone of `git@github.com:kubernetes/kubernetes.git`, spin up a local cluster.\n\n```bash\ncd kubernetes\nhack/local-up-cluster.sh\n# You've got a minute or two.  Stretch your legs and refill your water.\n```\n\n1\\. In another tab, use the suggested kubeconfig.  Add a user who authenticates via bearer token.  I have reproduced the `mmosley` example in [the authentication documentation](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#option-1-oidc-authenticator).  The `set-credentials` command may require `sudo` to create the `admin.kubeconfig.lock` file, or permissions to the config directory must be otherwise granted.\n\n```bash\nexport KUBECONFIG=/var/run/kubernetes/admin.kubeconfig\n\nsudo cluster/kubectl.sh config set-credentials mmosley  \\\n        --auth-provider=oidc  \\\n        --auth-provider-arg=idp-issuer-url=https://oidcidp.tremolo.lan:8443/auth/idp/OidcIdP  \\\n        --auth-provider-arg=client-id=kubernetes  \\\n        --auth-provider-arg=client-secret=1db158f6-177d-4d9c-8a8b-d36869918ec5  \\\n        --auth-provider-arg=refresh-token=q1bKLFOyUiosTfawzA93TzZIDzH2TNa2SMm0zEiPKTUwME6BkEo6Sql5yUWVBSWpKUGphaWpxSVAfekBOZbBhaEW+VlFUeVRGcluyVF5JT4+haZmPsluFoFu5XkpXk5BXqHega4GAXlF+ma+vmYpFcHe5eZR+slBFpZKtQA= \\\n        --auth-provider-arg=idp-certificate-authority=/root/ca.pem \\\n        --auth-provider-arg=id-token=eyJraWQiOiJDTj1vaWRjaWRwLnRyZW1vbG8ubGFuLCBPVT1EZW1vLCBPPVRybWVvbG8gU2VjdXJpdHksIEw9QXJsaW5ndG9uLCBTVD1WaXJnaW5pYSwgQz1VUy1DTj1rdWJlLWNhLTEyMDIxNDc5MjEwMzYwNzMyMTUyIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL29pZGNpZHAudHJlbW9sby5sYW46ODQ0My9hdXRoL2lkcC9PaWRjSWRQIiwiYXVkIjoia3ViZXJuZXRlcyIsImV4cCI6MTQ4MzU0OTUxMSwianRpIjoiMm96US15TXdFcHV4WDlHZUhQdy1hZyIsImlhdCI6MTQ4MzU0OTQ1MSwibmJmIjoxNDgzNTQ5MzMxLCJzdWIiOiI0YWViMzdiYS1iNjQ1LTQ4ZmQtYWIzMC0xYTAxZWU0MWUyMTgifQ.w6p4J_6qQ1HzTG9nrEOrubxIMb9K5hzcMPxc9IxPx2K4xO9l-oFiUw93daH3m5pluP6K7eOE6txBuRVfEcpJSwlelsOsW8gb8VJcnzMS9EnZpeA0tW_p-mnkFc3VcfyXuhe5R3G7aa5d8uHv70yJ9Y3-UhjiN9EhpMdfPAoEB9fYKKkJRzF7utTTIPGrSaSU6d2pcpfYKaxIwePzEkT4DfcQthoZdy9ucNvvLoi1DIC-UocFD8HLs8LYKEqSxQvOcvnThbObJ9af71EwmuE21fO5KzMW20KtAeget1gnldOosPtz1G5EwvaQ401-RPQzPGMVBld0_zMCAwZttJ4knw\n```\n\n2\\. Execute a `kubectl` command using the token above at verbosity 9 or higher.  Capture STDERR.\n\n```bash\nID=\"eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw \"\ncluster/kubectl.sh --v=10 --token=${ID} get nodes 2\u003e request_output.txt\n```\n\n3\\. Find the `curl` logged by `round_trippers.go`.  Observe the included bearer token.\n\n```bash\ngrep \"curl \" request_output.txt\n# I0818 23:48:42.048062  651691 round_trippers.go:423] curl -k -v -XGET  -H \"Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw\" -H \"Accept: application/json;as=Table;v=v1;g=meta.k8s.io,application/json;as=Table;v=v1beta1;g=meta.k8s.io,application/json\" -H \"User-Agent: kubectl/v0.0.0 (linux/amd64) kubernetes/3b5aedc\" 'https://localhost:6443/api/v1/nodes?limit=500'\n```","automated_response":false,"created_at":"2020-08-18T23:52:14.207Z","updated_at":"2020-08-18T23:53:16.629Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8994819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I had also been meaning to ask: should I go ahead and open a PR to correct this issue, or is there a process to observe for fixes for CVEs?","automated_response":false,"created_at":"2020-08-20T22:05:58.721Z","updated_at":"2020-08-20T22:05:58.721Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9027333,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @purelyapplied,\n\nThank you for your patience. Unfortunately, I'm not seeing a token in the logs. Are you still able to reproduce this? If possible, can you please provide a video demonstrating how to reproduce this? ","automated_response":false,"created_at":"2020-08-24T19:49:54.042Z","updated_at":"2020-08-24T19:49:54.042Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9165126,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sorry it's been a crazy couple weeks.\n\nI made a recording with `asciinema`.  Attached are the `.cast` and a `.gif` of that.\n\nOf course, that recording is ultimately just a text file converted into something pretty, so from a security standpoint, that's pretty weak.  I have a video of me executing it, but because it takes so long to spin up a cluster, it's about 9 minutes long and exceeds the 250MB file size limit.\n\nLet me know if you want to connect via video conference of your choice and I could screen-share my way through it live.\n\nAlso, while the above reproduction demonstrates the logging of the token in the `kubectl` round_tripper, I should have demonstrated that they also appear in the `kube-clusterapi.log`s when the log-level is high.  That can be achieved by prepending the log level when you spin up the cluster, i.e., `LOG_LEVEL=10 ./hack/local-up-cluster.sh`.  I'll send you a gif that demonstrates that tomorrow -- the one I just attempted didn't follow `screen` and I'm late for dinner.  :/\n\nThe gif is at 10x speed.  I'm using a commit from yesterday because HEAD doesn't build for me right now.","automated_response":false,"created_at":"2020-09-09T00:34:25.707Z","updated_at":"2020-09-09T00:34:25.707Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":980676,"filename":"reprod-log.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/quNjeWfxpezRRLpg4rZDzqiW?response-content-disposition=attachment%3B%20filename%3D%22reprod-log.gif%22%3B%20filename%2A%3DUTF-8%27%27reprod-log.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154449Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=781cdc5daf7653b471d3b9b2c7ff0d69434adfd5e0c4ecbb9790f64c67aa8aa9"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9172840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached to this comment is the reprod that demonstrates that many tokens are logged when the cluster apiserver is run at high `LOG_LEVEL`.  Similar to the previous, it has been made with `asciinema` at 10x speed.  Let me know if you'd like either at a slower speed or anything.","automated_response":false,"created_at":"2020-09-09T17:17:14.287Z","updated_at":"2020-09-09T17:17:14.287Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":981614,"filename":"reprod-in-cluster-log.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/E7DuWyL6yYdHWwH4FLVy1kMb?response-content-disposition=attachment%3B%20filename%3D%22reprod-in-cluster-log.gif%22%3B%20filename%2A%3DUTF-8%27%27reprod-in-cluster-log.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154449Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8a2ec5fa56fdcbce20d9aecef1f50b438d73f5faddca7ee2d525cb0dd849fe82"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9186439,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @purelyapplied! I was able to validate your report, and have submitted it to the appropriate remediation team for review. You will be updated on the status of this report as soon as there is additional information to share. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2020-09-11T03:37:45.343Z","updated_at":"2020-09-11T03:37:45.343Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9196692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to hear it!\n\nJust to provide some additional context to the remediation team:\n\nThe fix should be straight-forward.  The [previous partial fix](https://github.com/kubernetes/kubernetes/pull/81330) introduced a `maskValue` utility function that was only applied to one of the two header leak sites.  This fix should be just the one-line addition in `round_trippers.go` of \n\n```golang\n// toCurl returns a string that can be run as a command in a terminal (minus the body)\nfunc (r *requestInfo) toCurl() string {\n\theaders := \"\"\n\tfor key, values := range r.RequestHeaders {\n\t\tfor _, value := range values {\n+\t\t\tvalue = maskValue(key, value)\n\t\t\theaders += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))\n\t\t}\n\t}\n\n\treturn fmt.Sprintf(\"curl -k -v -X%s %s '%s'\", r.RequestVerb, headers, r.RequestURL)\n}\n```","automated_response":false,"created_at":"2020-09-11T17:53:13.354Z","updated_at":"2020-09-11T17:53:13.354Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9203996,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-12T18:45:49.849Z","updated_at":"2020-09-12T18:45:49.849Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.3)","old_severity_id":811323,"new_severity_id":844594},"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9389361,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2020-10-01T19:49:30.042Z","updated_at":"2020-10-01T19:49:30.042Z","cve_ids":["CVE-2020-8565"],"actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9513524,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Patrick - Thanks for your report! A fix has been submitted and merged but is still pending release and public disclosure. ","automated_response":false,"created_at":"2020-10-13T20:57:57.687Z","updated_at":"2020-10-13T20:57:57.687Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kubernetes"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kubernetes","collaborator":{"username":"purelyapplied","url":"/purelyapplied"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9542870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @purelyapplied  - the CVE was published and announced in coordination with the Kubernetes releases yesterday. Thanks again for your report! https://groups.google.com/g/kubernetes-security-announce/c/9d0gPe7SCM8/m/MsCBAxE2AgAJ","automated_response":false,"created_at":"2020-10-16T14:37:11.348Z","updated_at":"2020-10-16T14:37:11.348Z","actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9542872,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-10-16T14:37:19.714Z","updated_at":"2020-10-16T14:37:19.714Z","actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"purelyapplied","url":"/purelyapplied"},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9688144,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-30T21:23:04.190Z","updated_at":"2020-10-30T21:23:04.190Z","first_to_agree":true,"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9956742,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-29T21:23:11.179Z","updated_at":"2020-11-29T21:23:11.179Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kubernetes"}},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}