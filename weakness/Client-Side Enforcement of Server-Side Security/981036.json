{"id":981036,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODEwMzY=","url":"https://hackerone.com/reports/981036","title":"Hacker can bypass minimum bounty amount restrictions in \"invitation preferences\" setting via UpdateInvitationPreferencesMutation GraphQL operation","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2020-09-13T07:22:47.693Z","submitted_at":"2020-09-13T07:22:47.775Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"frozensolid","url":"/frozensolid","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-09-20T13:20:06.264Z","bug_reporter_agreed_on_going_public_at":"2021-08-18T03:59:16.526Z","team_member_agreed_on_going_public_at":"2021-09-20T13:20:06.095Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHacker can bypass minimum bounty amount restrictions in invitation preferences due to trusted client-side input to `UpdateInvitationPreferencesMutation` GraphQL operation\n\n**Description:**\nThe new \"Bounty Preferences\" feature at https://hackerone.com/settings/preferences allows the hacker to set a minimum critical bounty size for their future private program invitations. \nThe largest minimum bounty a hacker can select using the slider in the user interface is based on their average bounty payout. \nI've submitted a few low severity/low payout issues lately so my average is dropping like a stone. I was excited to see if there was a way around this. \n\nA hacker can bypass this minimum bounty slider by sending a crafted POST to the `UpdateInvitationPreferencesMutation` GraphQL operation at https://hackerone.com/graphql\n\n```\n{\"operationName\":\"UpdateInvitationPreferencesMutation\",\n  \"variables\":\n    {\"min_bounty\":1337},\n\"query\":\"mutation UpdateInvitationPreferencesMutation($receive_invites: Boolean, $bounty_programs_only: Boolean, $exclude_crypto_programs: Boolean, $min_bounty: Float, $time_off_ends_at: DateTime) {\\n  updateInvitationPreferences(input: {receive_invites: $receive_invites, bounty_programs_only: $bounty_programs_only, exclude_crypto_programs: $exclude_crypto_programs, min_bounty: $min_bounty, time_off_ends_at: $time_off_ends_at}) {\\n    me {\\n      id\\n      hacker_invitations_profile {\\n        id\\n        receive_invites\\n        bounty_programs_only\\n        min_bounty\\n        exclude_crypto_programs\\n        active_time_off\\n        time_off_ends_at\\n        __typename\\n      }\\n      __typename\\n    }\\n    was_successful\\n    __typename\\n  }\\n}\\n\"}\n```\n\n### Steps To Reproduce\n\n1. Start your favorite interception proxy (I used Portswigger BurpSuite)\n2. Login to a hackerone account (hacker persona)\n3. visit https://hackerone.com/settings/preferences\n4. Toggle on \"Only invite me for programs that award a Bounty\"\n5. set slider to an initial value (for later comparison)\n6. Enable request interception in the proxy\n7. set slider to a different value \n8. the intercepted request will look like this: \n    ```\n    POST /graphql HTTP/1.1\n    Host: hackerone.com\n    Connection: close\n    Content-Length: 848\n    accept: */*\n    X-Auth-Token: ████████████████████████████████████\n    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36\n    content-type: application/json\n    Origin: https://hackerone.com\n    Sec-Fetch-Site: same-origin\n    Sec-Fetch-Mode: cors\n    Sec-Fetch-Dest: empty\n    Referer: https://hackerone.com/settings/preferences\n    Accept-Encoding: gzip, deflate\n    Accept-Language: en-US,en;q=0.9\n    Cookie: ███████████████████████████████████\n    \n    {\"operationName\":\"UpdateInvitationPreferencesMutation\",\n      \"variables\":{\n        \"min_bounty\":1337\n      },\n      \"query\":\"mutation UpdateInvitationPreferencesMutation($receive_invites: Boolean, $bounty_programs_only: Boolean, $exclude_crypto_programs: Boolean, $min_bounty: Float, $time_off_ends_at: DateTime) {\\n  updateInvitationPreferences(input: {receive_invites: $receive_invites, bounty_programs_only: $bounty_programs_only, exclude_crypto_programs: $exclude_crypto_programs, min_bounty: $min_bounty, time_off_ends_at: $time_off_ends_at}) {\\n    me {\\n      id\\n      hacker_invitations_profile {\\n        id\\n        receive_invites\\n        bounty_programs_only\\n        min_bounty\\n        exclude_crypto_programs\\n        active_time_off\\n        time_off_ends_at\\n        __typename\\n      }\\n      __typename\\n    }\\n    was_successful\\n    __typename\\n  }\\n}\\n\"\n    }\n    ```\n9. Update the `min_bounty` variable to the desired minimum bounty. on my account I set to `7000`\n    ```\n    {\"operationName\":\"UpdateInvitationPreferencesMutation\",\n      \"variables\":{\n        \"min_bounty\":7000\n      },\n      \"query\":\"mutation UpdateInvitationPreferencesMutation($receive_invites: Boolean, $bounty_programs_only: Boolean, $exclude_crypto_programs: Boolean, $min_bounty: Float, $time_off_ends_at: DateTime) {\\n  updateInvitationPreferences(input: {receive_invites: $receive_invites, bounty_programs_only: $bounty_programs_only, exclude_crypto_programs: $exclude_crypto_programs, min_bounty: $min_bounty, time_off_ends_at: $time_off_ends_at}) {\\n    me {\\n      id\\n      hacker_invitations_profile {\\n        id\\n        receive_invites\\n        bounty_programs_only\\n        min_bounty\\n        exclude_crypto_programs\\n        active_time_off\\n        time_off_ends_at\\n        __typename\\n      }\\n      __typename\\n    }\\n    was_successful\\n    __typename\\n  }\\n}\\n\"\n    }\n    ```\n\n10. Now submit your crafted POST request. my request received a 200 OK with `\"was_successful\":true` with the following result:\n    ```\n    {\n       \"data\":{\n          \"updateInvitationPreferences\":{\n             \"me\":{\n                \"id\":\"██████\",\n                \"hacker_invitations_profile\":{\n                   \"id\":\"██████\",\n                   \"receive_invites\":true,\n                   \"bounty_programs_only\":true,\n                   \"min_bounty\":7000.0,\n                   \"exclude_crypto_programs\":true,\n                   \"active_time_off\":false,\n                   \"time_off_ends_at\":null,\n                   \"__typename\":\"HackerInvitationsProfile\"\n                },\n                \"__typename\":\"User\"\n             },\n             \"was_successful\":true,\n             \"__typename\":\"UpdateInvitationPreferencesPayload\"\n          }\n       }\n    }\n    ```\n    ████\n11. to further verify, I queried GraphQL again with the `UserInvitationSettingsQuery` operation and received back \n    ```\n    {\n       \"data\":{\n          \"me\":{\n             \"id\":███████████████████████████████████,\n             \"hacker_invitations_profile\":{\n                \"id\":███████████████████████████████████,\n                \"receive_invites\":true,\n                \"bounty_programs_only\":true,\n                \"min_bounty\":7000.0,\n                \"exclude_crypto_programs\":true,\n                \"time_off_ends_at\":null,\n                \"active_time_off\":false,\n                \"__typename\":\"HackerInvitationsProfile\"\n             },\n             \"bounties\":{\n                \"average_amount\":600.625,\n                \"__typename\":\"BountyConnection\"\n             },\n             \"__typename\":\"User\"\n          }\n       }\n    }\n    ```\n    ██████\n\n12. await your next private program invitation with a higher critical bounty payout.\n\n\n### Optional: Your Environment (Browser version, Device, etc)\n\n * Chrome/ Chromium 85.0.4183.83 (Official Build) (64-bit) (Mac OS 10.15.6)\n\n### Optional: Supporting Material/References (Screenshots)\nUpdating the minimum critical bounty payout.\n███████\n\nQuerying the current set minimum bounty \n███\n\n### Optional: Did you use [recon data made available by HackerOne](https://github.com/Hacker0x01/helpful-recon-data) to find this vulnerability?\nno\n\n## Impact\n\nHacker can further influence which private programs they are invited to outside of the intended design of the minimum critical bounty feature.","weakness":{"id":102,"name":"Client-Side Enforcement of Server-Side Security"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":26,"voters":["run_win","adhamsadaqah","alp","akashhamal0x01","sharp488","d4w","fat-fingers","oldaccount","cryftness","reik0","and 16 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9211480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @frozensolid,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@ktistai","automated_response":false,"created_at":"2020-09-14T08:53:29.479Z","updated_at":"2020-09-14T08:53:29.479Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9262400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @frozensolid - whoa, nice writeup! I'll have to check with the team is the block was intended as improved UX or as mitigation for a risk. My gut reaction says that the team might've done so to avoid a situation where someone wouldn't receive any invitation anymore if they set it to something too high, but I could be wrong. I'll escalate this to the team to get their thoughts on it. If this turns out to be UX instead of a defense, I'll probably close this as Informative. Please let me know if I've missed something in my initial investigation though, I'm all ears.","automated_response":false,"created_at":"2020-09-18T23:18:00.555Z","updated_at":"2020-09-18T23:18:00.555Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9838031,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @frozensolid - thanks for your patience with us! The team got back to me saying that this was indeed a UX improvement and not a risk mitigation. Because of that, I'll go ahead and close this as Informative. Please let me know if you believe we've missed something. Thanks again, good luck, and happy hacking!","automated_response":false,"created_at":"2020-11-16T23:04:00.841Z","updated_at":"2020-11-16T23:04:00.841Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9923035,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-11-25T10:30:43.564Z","updated_at":"2020-11-25T10:30:43.564Z","additional_data":{"duplicate_report_id":1042666},"actor":{"username":"nagli","cleared":true,"url":"/nagli","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/jk2lqhv83tqfeprdo7qwjeyxq3w9/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22Screen%20Shot%202021-08-19%20at%209.38.55.png%22%3B%20filename%2A%3DUTF-8%27%27Screen%2520Shot%25202021-08-19%2520at%25209.38.55.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154807Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5ec36b74d67b1beb46cfcd532286f4e54ba18aa9bd292cb1a96327f8f96b8d16"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12991207,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2021-08-14T15:21:33.326Z","updated_at":"2021-08-14T15:21:33.326Z","additional_data":{"duplicate_report_id":1304913},"actor":{"username":"adhamsadaqah","cleared":false,"url":"/adhamsadaqah","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vqbxFjHe3qnxamESSyjctuaH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13042960,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-08-18T03:59:16.548Z","updated_at":"2021-08-18T03:59:16.548Z","first_to_agree":true,"actor":{"username":"frozensolid","cleared":true,"url":"/frozensolid","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13540665,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Due to the amount of duplicates filed we are disclosing this report in order to make it visible that it is an accepted risk for us.","automated_response":false,"created_at":"2021-09-20T13:20:06.137Z","updated_at":"2021-09-20T15:33:36.319Z","actor":{"username":"chriszo111","cleared":false,"url":"/chriszo111","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/604/754/383197a933bca5db42c76ede0744df2a79952769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13540666,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-20T13:20:06.330Z","updated_at":"2021-09-20T13:20:06.330Z","actor":{"username":"chriszo111","cleared":false,"url":"/chriszo111","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/604/754/383197a933bca5db42c76ede0744df2a79952769_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}