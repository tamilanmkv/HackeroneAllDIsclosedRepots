{"id":1167530,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY3NTMw","url":"https://hackerone.com/reports/1167530","title":"RCE in 'Copy as Node Request' BApp via code injection","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2021-04-18T03:45:36.252Z","submitted_at":"2021-04-18T03:45:36.318Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ryotak","url":"/ryotak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15252,"url":"https://hackerone.com/portswigger","handle":"portswigger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"PortSwigger Web Security","twitter_handle":"Burp_Suite","website":"https://portswigger.net","about":"Burp Suite is the leading software for web security testing"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-04-22T00:35:37.097Z","bug_reporter_agreed_on_going_public_at":"2021-04-22T00:35:37.004Z","team_member_agreed_on_going_public_at":"2021-04-21T14:47:50.890Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\n`Copy as Node Request` is a burp suite extension that allows users to copy requests as Node.js code.\nDue to improper sanitization of cookie,  it's possible to inject arbitrary Node.js code in copied text, which may lead remote code execution with a significant amount of user interaction.\n\n## Root cause\nThis extension has a function named `escapeQuotes`.\nWhile this function escapes double quotes, it doesn't escape single quotes.\nhttps://github.com/PortSwigger/copy-as-node-request/blob/b34456463310836e93365541189626909adc70bb/src/burp/BurpExtender.java#L165-L167\nAs the cookie field of generated codes use single quote, it's possible to escape string literal and inject arbitrary Node.js codes.\nhttps://github.com/PortSwigger/copy-as-node-request/blob/b34456463310836e93365541189626909adc70bb/src/burp/BurpExtender.java#L123-L125\n\n## Step to reproduce\n1. Install [Copy as Node Request extension](https://portswigger.net/bappstore/e170472f83ef4da1bca5897203b6b33d).\n2. Open https://example.com\n3. Open DevTools and type `document.cookie = \"test='/require('child_process').exec('calc.exe')//\"`\n4. Enable intercept and reload the browser tab.\n5. Right click on intercepted request and click `Copy as Node.js Request`.\n6. Execute copied text in Node.js.\n7. `calc.exe` will be popped up.\n\n{F1269399}\n\n## Impact\n\nRemote code execution via Node.js code injection with user interaction.","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1269399,"file_name":"2021-04-18_12-36-32.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nu19nj57hjxs9uvh6i59jx3gscns?response-content-disposition=attachment%3B%20filename%3D%222021-04-18_12-36-32.mp4%22%3B%20filename%2A%3DUTF-8%27%272021-04-18_12-36-32.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ76PP2BUX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132910Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGHP7cIwt2Tsf8KjliDyT5Lb7ly0JskiaYe2ChAX3AmbAiAqtHMw8uLFecT9g9U5UE%2FCxE1a%2BtPZJAnSYYnH2BI8piqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMzMSFx2nvHLNo5SLgKtcDcW%2FgFn8cU0mgC1%2FVdGfTPYSBsMiGZbBVEFWLz7BIkAjvx1Yl0xNwccsia5mxGh5Pof1BmLOj%2FPbfN0yxfjTbBvX%2BtxFisFe4lleD7sAfIMQHgrItYYlJlrAkcGTOF0hj5oy17q8C901VMWg1M3Oq1DUHqNUDjNiOuNs3pYI8%2F%2FpJPSaJwkT0kt%2FgzY3%2FaZ0aVY4K5doqZxp2VxJBM6CwnM47o6IbMvH%2F6hCdkC2dfUYQhPAa%2FygUp%2Fmm%2FrBM1LnDwRHK5mENZHzc9lNN77yHKCN1H3z9bi6t%2FdgHvkJFjucgPEBep99zqb1GTqjJfJh62po7%2FS6VgiubeoT%2ByWP%2FtbqeYVZAMxxgiX1mB4dTzOp9zUHuTJ5nixo2KbV6zjXbuM3CsrhUAywRCeq1ysa5sihESBZMzWy4KTeSnnVgA3YGSpb6bjYVcuyXShrdtMdh%2Bi%2Fut350eVReQuhtta9UeSQASWy1DEqou8oW6%2BWrK%2Fu8ty%2Bdy03u84XY3jIFi15g20CivixBXwDrJq5GMnahFYcvlzz%2FNfvLxBKnaZyOEiCkM%2BOhX4C4%2BLxcdNS1%2B%2FJZkMdX5isJd3PLZxJ0Za4ah4jaZUkoTXoWEByAePJ%2FcQ2oGnMS56ZNMLTgkIsGOqYBDJcz6RvFiMKVMfgvSf0yaXoPP4o%2BD%2Fa8JI%2BvkanDoFK0GH2rrIW6QMEbvg1sbDA%2B9VmM8kFxkCwfS%2F888Z5ykzUXec2dE5NYyugHVg5stjEJdkzVfFm30TsJCuULkIUdUPpiclOA72MSSbJsTlChJhjuLyQb8nARpH6iLndWaVXQjXW0hsGl9kRoYIkectIjPcMElLSYn47zPkurLskrWPNIcaHBlw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=33f8fcbb11457f36fd0090bec5b79a67ecdbf473681a717eddbcce9ead5b97c7","file_size":2052687,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-05-21T14:47:50.968Z","allow_singular_disclosure_after":-12350479.623300731,"singular_disclosure_allowed":true,"vote_count":48,"voters":["akichia","battle_angel","nagli","badcracker","ali","yassinek3ch","arthuraires","mattberg","0nlymohammed","0xn","and 38 more..."],"severity":{"rating":"none","score":0.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":170,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Burp Suite Extension (BApps)","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11434421,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Good catch, thanks for letting us know. We have confirmed this finding and will work with BApp author to get it fixed.","automated_response":false,"created_at":"2021-04-19T08:58:14.198Z","updated_at":"2021-04-19T08:58:14.198Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11452777,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The author has now resolved this, and we've released the update via the BApp store. You can find their fix here: https://github.com/PortSwigger/copy-as-node-request/commit/7f62f3ae9561e45398a308a8096bd8446eb495bc\n\nThanks again for letting us know!","automated_response":false,"created_at":"2021-04-20T12:11:33.548Z","updated_at":"2021-04-20T12:11:33.548Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ryotak","url":"/ryotak"},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11453427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @albinowax,\nThank you for the update!\n\nI confirmed that the patch fixes this vulnerability.\nDo you need a CVE ID for it? In case you need a CVE ID, I can request it. So please let me know.\n\nBest regards,\nRyotaK","automated_response":false,"created_at":"2021-04-20T13:10:10.865Z","updated_at":"2021-04-20T13:10:16.894Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11453506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the offer, but we are not concerned with obtaining CVEs for extensions. Thanks for confirming the fix, too.","automated_response":false,"created_at":"2021-04-20T13:18:36.539Z","updated_at":"2021-04-20T13:18:36.539Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11453523,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, thank you for clarifying it!","automated_response":false,"created_at":"2021-04-20T13:21:20.882Z","updated_at":"2021-04-20T13:21:20.882Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11468948,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2021-04-21T14:47:22.356Z","updated_at":"2021-04-21T14:47:22.356Z","additional_data":{"old_title":"Code Injection in Copy as Node Request allows an attacker to inject arbitrary Node.js codes","new_title":"RCE in 'Copy as Node Request' BApp via code injection"},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11468956,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would you like to disclose this? \n\nPS awesome work on Homebrew!","automated_response":false,"created_at":"2021-04-21T14:47:50.906Z","updated_at":"2021-04-21T14:47:50.906Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11473107,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Yes, let's disclose this!\n\n\u003e PS awesome work on Homebrew!\n\nThank you ;)","automated_response":false,"created_at":"2021-04-22T00:35:37.036Z","updated_at":"2021-04-22T00:35:37.036Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11473108,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-22T00:35:37.145Z","updated_at":"2021-04-22T00:35:37.145Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}