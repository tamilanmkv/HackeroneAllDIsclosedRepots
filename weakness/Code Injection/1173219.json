{"id":1173219,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTczMjE5","url":"https://hackerone.com/reports/1173219","title":"HTML Injection In Email In one.newrelic.com","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2021-04-23T13:41:01.824Z","submitted_at":"2021-04-23T13:41:01.902Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"itsz4x","url":"/itsz4x","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-05-24T10:27:24.223Z","bug_reporter_agreed_on_going_public_at":"2021-05-10T16:59:48.438Z","team_member_agreed_on_going_public_at":"2021-05-24T10:27:24.143Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nThere's a HTML injection vulnerability present inside emails sent from Newrelic when the  name on the organization inviting user contains HTML. The html is stored in the backend database and when emails are sent (invitation), the HTML is sent along with the rest of the email.\n\nSteps to reproduce:\n1. Go to  https://login.newrelic.com/login and login in your account.\n2. Then go to https://one.newrelic.com/launcher/admin-portal.launcher \u003e\u003e User management\n3.  Then click add user button\n4.  In the name field enject any html code ... i enject(  \u003ca href=\"https://newrelic.com.evil.com\"\u003e Anything \u003c/a\u003e  ) and in the email field  add victim email then click add user button.\n5. Newrelic automatically sent a invitation link with html code in victim email.\n\nPOC: video attachmented\n\nFix:\nRemedies for this would include proper sanitization of user name fields \n\nRelated reports, best practices\n#786976 #262004 #209398\n\n## Impact\n\nHTML injection, Phishing attacks\nThis vulnerability can lead to the reformatting/editing of emails from an official Newrelic email address, which can be used in targeted phishing attacks.\nThis could lead to users being tricked into giving logins away to malicious attackers.","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1275983,"file_name":"Video_20210423_184951.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mdh1o6h63h8vadqhtqmahwy4wgq6?response-content-disposition=attachment%3B%20filename%3D%22Video_20210423_184951.mp4%22%3B%20filename%2A%3DUTF-8%27%27Video_20210423_184951.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132942Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4a012e5c1d9390e7700eb51dadd6df20e2f150cbfa2a536b75b0c8d5ff23a7e1","file_size":12544495,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["nipe","0nlymohammed","powerjacobb1","3x3s","akashhamal0x01","gh0stv1p3r","ekgaribadmi"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":31873,"asset_type":"URL","asset_identifier":"one.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11507640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nYou can also use just Url without html code because the backend field use html code.\n\nPOC: One Screenshot attached\n\nAn Attacker Can Do:\nAn attacker can create a fake website login page like Newrelic then he can sent invitation link like above. When victim check the mail came from official Newrelic mail so if somehow click the Malicious link then he see the website like Newrelic, so if without thinking victim try to login his account with his credentials an attacker can stealing his account. So victim can lose his account.\n","automated_response":false,"created_at":"2021-04-26T04:19:41.629Z","updated_at":"2021-04-26T04:19:41.629Z","actor":{"username":"itsz4x","cleared":false,"url":"/itsz4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1278447,"filename":"Screenshot_(112).png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/afkbdrqzfpw247uglw2rgdit7bkm?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_%2528112%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_%2528112%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132942Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=980c8f6eb7667536f4ed0a8bb7fd543bd1c100a0d444c1def673eb776db368f5"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11514520,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @itsz4x,\n\nThanks for your report. We don't consider this a vulnerability, but more of a best practice.\n\nUnfortunately, it's outside of our control how an email client interprets the name - some will render HTML or hyperlinks and others will show text - and we allow names to be whatever the user desires.","automated_response":false,"created_at":"2021-04-26T13:53:30.921Z","updated_at":"2021-04-26T13:53:30.921Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11517410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi\nThank you so much for your response.\nBut an attacker can takeover victim account by this phising method if victim haven't too much idea about phising attack then he can easily lose his account. So, i think you should take attention on it.\nThank You","automated_response":false,"created_at":"2021-04-26T15:56:33.270Z","updated_at":"2021-04-26T15:56:33.270Z","actor":{"username":"itsz4x","cleared":false,"url":"/itsz4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11687812,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-10T16:59:48.472Z","updated_at":"2021-05-10T16:59:48.472Z","first_to_agree":true,"actor":{"username":"itsz4x","cleared":false,"url":"/itsz4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11857880,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-24T10:27:24.162Z","updated_at":"2021-05-24T10:27:24.162Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11857881,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-24T10:27:24.267Z","updated_at":"2021-05-24T10:27:24.267Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}