{"id":824689,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjQ2ODk=","url":"https://hackerone.com/reports/824689","title":"Send arbitrary PUT requests when user clicks on a link","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-19T14:09:58.998Z","submitted_at":"2020-03-19T14:09:58.998Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yvvdwf","url":"/yvvdwf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-27T08:44:34.335Z","bug_reporter_agreed_on_going_public_at":"2020-07-27T08:39:58.419Z","team_member_agreed_on_going_public_at":"2020-07-27T08:44:34.259Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear teams,\n\n### Summary\n\nMermaid allows users to set class name of a block. This ability becomes vulnerable in Gitlab issues because of [issue.js#L90](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/issue.js#L90):\n\n```javascript\n    return $(document).on(\n      'click',\n      '.js-issuable-actions a.btn-close, .js-issuable-actions a.btn-reopen',\n      e =\u003e {\n...\n       const $button = $(e.currentTarget);\n...\n        const url = $button.attr('href');\n        return axios\n          .put(url)\n          .then(({ data }) =\u003e {\n...\n```\n\n### Steps to reproduce\n\n 1. Create any issue\n 2. Enter the following payload as the description of the issue:\n\n```\n```mermaid\ngraph TD;\n A[Click to send a PUT request];\n class A js-issuable-actions;\n class A btn-close;\n click A \"./put-destination\" \"click to PUT\"\n```\n\nAfter saving the issue, if you click on the block `Click to send a PUT request`, a `PUT` request will be sent to `./put-destination`\n\n### Impact\n\nSince attacker can control `./put-destination`, he can theoretically can perform any PUT requests on behalf of the current user.\nFor example, attacker can use the following url to update the description of issue #2:\n\n`/api/v4/projects/16210710/issues/2?description=a`\n\n### Examples\n\nAn example is available here: https://gitlab.com/yvvdwf/xss/-/issues/1 (it is private, pls let me know if you cannot access it)\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n## Impact\n\nWhen received click of user, attacker may perform arbitrary PUT requests of the behalf of the user","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":131,"voters":["sky003","muthu_prakash","overjt","n0x496n","foobar7","kapytein","holme","th4nu_0x0","badcracker","vp40","and 121 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7370002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @yvvdwf,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-03-19T15:05:54.294Z","updated_at":"2020-03-19T15:05:54.294Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7370782,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @yvvdwf,\n\nThank you for this report.\nYet when using the documented payload and clicking on the link, a GET request is executed by the browser (Chrome and Firefox)  to `/put-destination` \n\nCan you please confirm a GET query is executed and not a PUT ?\n\nBest regards,\nGitLab Security Team\n","automated_response":false,"created_at":"2020-03-19T16:40:19.468Z","updated_at":"2020-03-19T16:40:19.468Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7371969,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jmatos_bgtvf ,\n\nThank you for the quick reply. Please put the payload into an issue's description or comment (not in a wiki page). Otherwise, I create a small video demo in the attached file.\n\nRegards,","automated_response":false,"created_at":"2020-03-19T19:26:51.068Z","updated_at":"2020-03-19T19:26:51.068Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":753562,"filename":"send-put-request.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Es2KmqqpyssDae4uth3SDYau?response-content-disposition=attachment%3B%20filename%3D%22send-put-request.mp4%22%3B%20filename%2A%3DUTF-8%27%27send-put-request.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153208Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=db2fcc94e5238e20ba304e0cc649fef011d2aa1502af516a5217194f2c4f368b"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7372417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the quick feedback.\n\nI confirm I can reproduce the issue on Gitlab 12.9.0-pre (gitlab.com and self-hosted), but not on the latest official self-hosted release (12.8.7).\nLet me come back to you once impact has been fully assessed.\n\nBest regards,\nGitLab Security Team","automated_response":false,"created_at":"2020-03-19T20:30:25.707Z","updated_at":"2020-03-19T20:30:25.707Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378413,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @yvvdwf,\n\nThank you for submitting this report.\nFor your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/-/issues/211949. This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2020-03-20T14:13:08.908Z","updated_at":"2020-03-20T14:13:08.908Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378421,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-03-20T14:13:54.800Z","updated_at":"2020-03-20T14:13:54.800Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7378586,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","automated_response":false,"created_at":"2020-03-20T14:34:19.878Z","updated_at":"2020-03-20T14:34:19.878Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7382736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @yvvdwf,\n\nThe issue you reported is currently scheduled to be fixed by 2020-04-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-03-21T04:06:44.906Z","updated_at":"2020-03-21T04:06:44.906Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7468133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\u003e For your information, the payload only triggers a PUT query if the victim has at least Reporter role in the project containing the issue.\n\nYes, this is correct for the example above: `/api/v4/projects/16210710/issues/2?description=a`\n (if attackers want to change an issue's description **of the current project** (the one contains the issue))\n\nSince attacker can use any project id (in another attack), he may update any issues of any projects the victim has Reporter role.\n\nOtherwise, attacker can also use any API supporting PUT request, such as [`PUT /projects/:id`](https://docs.gitlab.com/ee/api/projects.html#edit-project) to update an existing project if the victim has permission to do that.","automated_response":false,"created_at":"2020-03-28T21:36:11.694Z","updated_at":"2020-03-28T21:36:11.694Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8145620,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @yvvdwf,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.0.1 and we will soon be warding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2020-05-29T14:19:47.224Z","updated_at":"2020-05-29T14:19:47.224Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yvvdwf","url":"/yvvdwf"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8175597,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-06-02T08:00:15.132Z","updated_at":"2020-06-02T08:00:15.132Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"yvvdwf","url":"/yvvdwf"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8175613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome! Thank you for the bounty!!","automated_response":false,"created_at":"2020-06-02T08:02:51.813Z","updated_at":"2020-06-02T08:02:51.813Z","actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762183,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The internal issue has been public, so let's open this one also!","automated_response":false,"created_at":"2020-07-27T08:39:58.444Z","updated_at":"2020-07-27T08:39:58.444Z","first_to_agree":true,"actor":{"username":"yvvdwf","cleared":false,"url":"/yvvdwf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yQ79x7V8gqtK3SUH9zj881MY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762241,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-27T08:44:34.277Z","updated_at":"2020-07-27T08:44:34.277Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8762242,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-27T08:44:34.357Z","updated_at":"2020-07-27T08:44:34.357Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}