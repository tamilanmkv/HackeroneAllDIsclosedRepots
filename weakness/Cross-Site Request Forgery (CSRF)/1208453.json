{"id":1208453,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjA4NDUz","url":"https://hackerone.com/reports/1208453","title":"Account takeover through multistage CSRF at https://autochoice.fas.gsa.gov/AutoChoice/changeQAOktaAnswer and ../AutoChoice/changePwOktaAnswer","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-05-25T12:08:45.244Z","submitted_at":"2021-05-25T12:08:45.284Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rajeshpatil","url":"/rajeshpatil","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/HSnGP4ZA9NoaVBJ9pAHjSPSQ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":50553,"url":"https://hackerone.com/gsa_vdp","handle":"gsa_vdp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9AGCZikBbg78ZgLS65KZumei/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/9AGCZikBbg78ZgLS65KZumei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. General Services Administration","twitter_handle":null,"website":"http://gsa.gov","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-07-23T02:07:47.706Z","bug_reporter_agreed_on_going_public_at":"2021-06-23T02:07:47.389Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nAccount takeover is possible through CSRF vulnerability at 'Change Security Question/Answer'  \u0026 ' Change Password'.\nThe endpoints - https://autochoice.fas.gsa.gov/AutoChoice/changeQAOktaAnswer \u0026 https://autochoice.fas.gsa.gov/AutoChoice/changePwOktaAnswer both are vulnerable to CSRF attack .==The CSRF token/or its presence is not validated at server side.==\n\nSince, the password update functionality requires 'Secret Answer' Value \u0026 'New Password'. Therefore, in multistage CSRF Secret Answer was updated first \u0026 then using that new secret answer, new password was set for the account using second stage.\n\nBoth CSRF request are performed through the same html POC. Upon execution of POC html, changes will  be reflected after few seconds as timeout is set for the first request to complete.  Also, there is no need to know the security question either, which itself is updated in the first stage.\n\nPOC Video - {F1314428}\n\nCSRF Html file -  {F1314439}\n\n@Triage Team - Since, this report involves two CSRFs for different functionalities, should I have filed two different  reports ?  as I would be losing rep. points.\n\n## Impact\n\nAccount takeover through CSRF","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1314428,"file_name":"recording-1621943105665.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1n7tai991r67s4re1knk4z8dqsac?response-content-disposition=attachment%3B%20filename%3D%22recording-1621943105665.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1621943105665.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUJKC7J4R%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133227Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIC49ArTf3LAqriZd1Lwuq3I3uKt0W5qVVJhzIQib1O0YAiEAotLNlyUZMk18dOsDs4rZgwa1HC%2F97I0ZOQY2G5rwxRcqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOvtFvz4a8x633onlirXAzPXQ2%2F5YIwHif4VZsTaZh1gaGvxJeaFfMEHhYDER%2B09WJ0UTquyO7zM97bGLeSh46E3SyxDMje5%2FZ1U4wOO3hNE7QSYJojnrJK0sSAfm%2FVN9xgjYZv6HVpRWB3jc3mwY%2B87if3SlFkJYLumzbO5csxhDwtJ5WXU2mBz%2BQpO4qmKmR1lYVtBXNgruWvdNx5Qr5NLYq8Dl0syzp3QEqDeyJ5bql6lJJXY%2B6gcXsqDkf1%2BWqBm20iQWJnylJSrj9ffHZ1N3GfFKi5fgBOsveTb2Nob8UEwpMjzno0A3qJe0k%2F3DbN3ERjTaoR8jh%2FcOreKCfIL06Pdqzi6JIgjRpc4vZGfpq6TcXLEDI5TfIPHc4C1APAJAFIPq%2Bt9d4F0XmZy91VzSHcign0uVhqRnorxP75Vq4KBj7L0FyzIIDFWy80jtXCeju4Q0MVc2rlvWAlOueRA41BrhpuFfOJIGimciTYiE0auGnlylur%2F%2BQ5FOxirMX%2Bby6J2W4a%2BsQ8IMgUa7xoY%2BEsgg46CsRxOVXQDq9wvd8dKWTSYFrnP5T0l86h38M8e5JTP%2FzTJyV4%2B5bl9IuNvlNvpmOvx%2FAygxKS65pEFeEX2CvdZovhe3nX4Yg%2BuSOWdcjonxzD10JCLBjqlAfx6d5oYSQZ1X773otHyNqfHvq26hlTf%2BofuB5ezB8Ga6rKCSh8RrGaRokw2oqsgLT5xkbRFpwX%2BJWXGVN3zaKcdQzS6endZ0h0tWr1Dxod7DTG5J%2B5HvZtfAaI5y6BclbNEvfcEyp5ZiX1lHeXJlsILocXuPZCkmxl%2B2UZzZH4tf13l8EldI699gp%2Be2oh6PcYIdSUDfnHtZAenLKh56KfVA3uM6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cf84b9f847f557198080f24b40654633f30f652c08a5004a8346f22aa8b837ac","file_size":14054632,"type":"video/webm"},{"id":1314439,"file_name":"secret_answer_and_pwd_csrf.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/12zk259qmehzglhdauqegnohzqgi?response-content-disposition=attachment%3B%20filename%3D%22secret_answer_and_pwd_csrf.html%22%3B%20filename%2A%3DUTF-8%27%27secret_answer_and_pwd_csrf.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUJKC7J4R%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133227Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIC49ArTf3LAqriZd1Lwuq3I3uKt0W5qVVJhzIQib1O0YAiEAotLNlyUZMk18dOsDs4rZgwa1HC%2F97I0ZOQY2G5rwxRcqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOvtFvz4a8x633onlirXAzPXQ2%2F5YIwHif4VZsTaZh1gaGvxJeaFfMEHhYDER%2B09WJ0UTquyO7zM97bGLeSh46E3SyxDMje5%2FZ1U4wOO3hNE7QSYJojnrJK0sSAfm%2FVN9xgjYZv6HVpRWB3jc3mwY%2B87if3SlFkJYLumzbO5csxhDwtJ5WXU2mBz%2BQpO4qmKmR1lYVtBXNgruWvdNx5Qr5NLYq8Dl0syzp3QEqDeyJ5bql6lJJXY%2B6gcXsqDkf1%2BWqBm20iQWJnylJSrj9ffHZ1N3GfFKi5fgBOsveTb2Nob8UEwpMjzno0A3qJe0k%2F3DbN3ERjTaoR8jh%2FcOreKCfIL06Pdqzi6JIgjRpc4vZGfpq6TcXLEDI5TfIPHc4C1APAJAFIPq%2Bt9d4F0XmZy91VzSHcign0uVhqRnorxP75Vq4KBj7L0FyzIIDFWy80jtXCeju4Q0MVc2rlvWAlOueRA41BrhpuFfOJIGimciTYiE0auGnlylur%2F%2BQ5FOxirMX%2Bby6J2W4a%2BsQ8IMgUa7xoY%2BEsgg46CsRxOVXQDq9wvd8dKWTSYFrnP5T0l86h38M8e5JTP%2FzTJyV4%2B5bl9IuNvlNvpmOvx%2FAygxKS65pEFeEX2CvdZovhe3nX4Yg%2BuSOWdcjonxzD10JCLBjqlAfx6d5oYSQZ1X773otHyNqfHvq26hlTf%2BofuB5ezB8Ga6rKCSh8RrGaRokw2oqsgLT5xkbRFpwX%2BJWXGVN3zaKcdQzS6endZ0h0tWr1Dxod7DTG5J%2B5HvZtfAaI5y6BclbNEvfcEyp5ZiX1lHeXJlsILocXuPZCkmxl%2B2UZzZH4tf13l8EldI699gp%2Be2oh6PcYIdSUDfnHtZAenLKh56KfVA3uM6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fe923bafab924459dad30e42303496b10c1066334891212aee8ef0f1639ea2ba","file_size":913,"type":"text/html"}],"allow_singular_disclosure_at":"2021-07-23T02:07:47.484Z","allow_singular_disclosure_after":-6953080.099064078,"singular_disclosure_allowed":true,"vote_count":29,"voters":["obsesif","realtess","mirazdevox","g0ktug","eveeez","lu3ky-13","khizer47","akashhamal0x01","sa1tama0","grmx","and 19 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":60003,"asset_type":"URL","asset_identifier":"autochoice.fas.gsa.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11876393,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For setting up new account, you may use 00 as bureau \u0026 agency code.","automated_response":false,"created_at":"2021-05-25T13:12:08.584Z","updated_at":"2021-05-25T13:12:08.584Z","actor":{"username":"rajeshpatil","cleared":false,"url":"/rajeshpatil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HSnGP4ZA9NoaVBJ9pAHjSPSQ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11888185,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2021-05-26T06:14:22.820Z","updated_at":"2021-05-26T06:14:22.820Z","additional_data":{"old_severity":null,"new_severity":"Medium (6.5)","old_severity_id":null,"new_severity_id":1098329},"actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":11888309,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2021-05-26T06:33:18.665Z","updated_at":"2021-05-26T06:33:18.665Z","additional_data":{"old_severity":"Medium (6.5)","new_severity":"High","old_severity_id":1098329,"new_severity_id":1098348},"actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":11888311,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @rajeshpatil,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@lugtag","automated_response":false,"created_at":"2021-05-26T06:33:24.087Z","updated_at":"2021-05-26T06:33:24.087Z","actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":11892758,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2021-05-26T14:10:16.216Z","updated_at":"2021-05-26T14:10:16.216Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":1098348,"new_severity_id":1098681},"actor":{"username":"issamy11","cleared":false,"url":"/issamy11","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11892767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rajeshpatil Thank you for your report. Our team is currently looking into it and we will follow up with questions if applicable.","automated_response":false,"created_at":"2021-05-26T14:11:37.560Z","updated_at":"2021-05-26T14:11:37.560Z","actor":{"username":"issamy11","cleared":false,"url":"/issamy11","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12212022,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@rajeshpatil Thank you for reporting this finding! The team has been able to take action. Your support of the VDP is very much appreciated!","automated_response":false,"created_at":"2021-06-22T19:29:57.593Z","updated_at":"2021-06-22T19:29:57.593Z","actor":{"username":"issamy11","cleared":false,"url":"/issamy11","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rajeshpatil","url":"/rajeshpatil"},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12214056,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-23T02:07:47.428Z","updated_at":"2021-06-23T02:07:47.428Z","first_to_agree":true,"actor":{"username":"rajeshpatil","cleared":false,"url":"/rajeshpatil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HSnGP4ZA9NoaVBJ9pAHjSPSQ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12634546,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-07-23T02:07:47.758Z","updated_at":"2021-07-23T02:07:47.758Z","actor":{"url":"/gsa_vdp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9AGCZikBbg78ZgLS65KZumei/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. General Services Administration"}},"genius_execution_id":null,"team_handle":"gsa_vdp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}