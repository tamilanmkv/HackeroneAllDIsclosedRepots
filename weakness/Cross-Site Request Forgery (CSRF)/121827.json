{"id":121827,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjE4Mjc=","url":"https://hackerone.com/reports/121827","title":"Account Takeover","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-09T19:17:05.609Z","submitted_at":"2016-03-09T19:17:05.609Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugdisclose","url":"/bugdisclose","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21554,"url":"https://hackerone.com/bumble","handle":"bumble","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bumble","twitter_handle":"bumble","website":"https://bumble.com/","about":"Bumble - Date, Meet, Network Better"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-12T13:47:00.877Z","bug_reporter_agreed_on_going_public_at":"2016-03-12T13:40:35.362Z","team_member_agreed_on_going_public_at":"2016-03-12T13:47:00.675Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello this is regarding an account takeover via import image from facebook option, when we import fb photos a link with a token generated which is valid for any user and it can be use to replace user linked fb account to attacker fb account And then login via fb to takeover account\n\nNote: I tested it on https://m.Badoo.com\n-\n\nSteps to reproduce :-\n--\n\n1 -Create two Badoo account attacker \u0026 victim and link 2 diff fb account in each of them\n\n2- Login as 'attacker' and go to import photos via fb and copy the link from URL bar \n\n3- Now login as 'victim' in diffrent browser and open the link and click cancel.\n\n4- FB account of 'victim' is replaced with FB account of 'attacker' (Removed from 'victim' one)\n\n5-Login via attacker FB account and you will be logged in 'User' account \n\nCongo u just hacked victim account \n\nMore explanation\n--\nSuppose a user have an account of attacker 'A' with FB linked which 'FB-of-A' and a victim account 'B' with fb linked which is 'FB-of-B' now attacker create a link to import photos from his fb and give it to victim 'B' he opens it and press cancel but this have changed his FB account 'FB-of-B' to attacker's FB account 'FB-of-A', And now attacker can login with his fb account in victim's badoo account.\n\nI have made a PoC video on mobile so if u need i will send it or please wait i will send u PC made within mext 24 hours","bounty_amount":"850.0","formatted_bounty":"$850","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-11T13:40:46.206Z","allow_singular_disclosure_after":-173577132.69644597,"singular_disclosure_allowed":true,"vote_count":15,"voters":["cuso4","0nlymohammed","sodium_","musab_alharany","mefkan","fantam1","nafisaqil","nigba","noobhunter","jiven","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":831703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Mobile record, if u need PC one i will do that too ..\nhttps://youtu.be/xylkmN_IRF0\n\nUnlisted Video ^","automated_response":false,"created_at":"2016-03-09T20:22:17.623Z","updated_at":"2016-03-09T20:22:17.623Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832383,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nCorrection\n\n4- FB account of 'victim' is replaced with FB account of 'attacker' (Removed from 'attacker' one)\n\n5-Login via attacker FB account and you will be logged in 'victim' account\n\n\nFix\n-\nYou must have atleast a CSRF token on external photoupload link so this type of attack fails\n\nhttps://m.badoo.com/external-provider-photo-import/xxxxxxxxxx\n\nAdd CSRF token on external-provider-photo-import end \n\nAnd also it must be valid for only that user. Token should not work on any account.","automated_response":false,"created_at":"2016-03-10T02:56:18.724Z","updated_at":"2016-03-10T02:56:18.724Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@uyga","automated_response":false,"created_at":"2016-03-10T03:29:03.933Z","updated_at":"2016-03-10T03:29:03.933Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832532,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PC video  PoC... n this issue is applicable only for m.Badoo.com","automated_response":false,"created_at":"2016-03-10T06:25:51.870Z","updated_at":"2016-03-10T06:27:23.758Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":77667,"filename":"Screen_03-10-2016_06-20-03.avi","type":"video/x-msvideo","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/667/0d545eb4457474d6d9fe4e9996d89feb6d0af418/Screen_03-10-2016_06-20-03.avi?response-content-disposition=attachment%3B%20filename%3D%22Screen_03-10-2016_06-20-03.avi%22%3B%20filename%2A%3DUTF-8%27%27Screen_03-10-2016_06-20-03.avi\u0026response-content-type=video%2Fx-msvideo\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTTPJWCNM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133258Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDOwM9%2B2Ol25EbTHv2AOl1ZXwoFCdY81Kf4Cj%2BZw5bGagIhALNw4OtUKzuuJ5JDnXIMoizsmzLoA6B3TMlT4JOm5OV%2FKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBja9Y5H4vqpYK%2BZIq1wMKEFztYF934tg2oiDnz06aS%2BIxaoyblb3k6%2F%2BxBMgQzBtDrU0ocKh0rsBsPTyultSX957Ztb0Xxm%2BlSHqRsjq6d7mkuWsgkJaqQC34P%2FPoowX%2BlH2ZrTK%2FmkJH0GzYvbYPapiuIgj7k6s%2BThAEuj5K1dIvpyoPZSWU4lDCKAHDR63JJK4rjQBzSsyouhVced%2BThWTOJVdRFvPpVLh85ANN2kni9b%2BvA%2BYr4QNdI7bXX3vCy%2Bmlxmt9OtrkNSzeMBq%2B4UjjQL%2BALBrQRVk2zZ5rDj%2ByazHJ4N56LN4FxJEAdf%2BKr7nn9dZ2DExdIbY7%2Blz79tlyq02tT%2B98LGY82aPEMuTJbBZN6Znugvuj3qTN5Ajkz33XEdb09pTvqYEHwNQvHa8molgvM8Hr0UftpVOr%2FcSDQ%2Be7ClWky3g9k3C7fx8DtVeV3YKXMiauv6oe6iv529tf7ZQLwVbk8MDZHKluj8DVRfRr7MlmTLozZouf9SJ7q02NxX1M1zjSiK9%2Bb3knUL5CRpQRCENhmDWhXpTY5NtCVb6swQ3By1ka7LxXtkUadmYfSCwXxpca0jIGluHz9THdy%2Fc3993usF1hP11r0y8u18g%2BZLF5OCf8pMK8LDv4nKUjODow6e2QiwY6pAHH%2FNyAbORzwpluWJFiLzeFhl5RjYZpJEx0nM7ZKbFuGASfNSFcAHpRW7ZXX%2BBSHdPdxqv%2BQd1FC1QHUbL0ZWNROontBy0xjQujOuLkMDUyDfIqsPUVcZohJWSYUkM5yYj9wg6BrbGLNW9NinBFdcPB5%2BIeF%2Bg7o5tKzk0UaPV%2FO3FiQPt3VlESRyrk8YbEQk7JEub211414ZV4sdV3jLFmf60bgw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5b609393574f10c1586eb3b19f4ba13cb9440f817036986cd5de2be52a573737"}],"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":832859,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@uyga @badoo have a look ASAP","automated_response":false,"created_at":"2016-03-10T11:02:45.806Z","updated_at":"2016-03-10T11:02:45.806Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":833037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FINAL ONE PLESE USE BELLOW GIVEN INFORMATION ONLY \n-\n\nOnly for m.badoo.com\n-\n\nHello this is regarding an account takeover via import image from facebook option which do not have any CSRF token requirement,\n\nWhen we import fb photos a link with a token generated which is valid for any user and it can be use to replace user linked fb account to attacker fb account And then login via fb to takeover account.\n\nSteps to reproduce :-\n-\n\n1 -Create two Badoo account attacker \u0026 victim and link 2 diff fb account in each of them\n\n2- Login as 'attacker' and go to import photos via fb and copy the link from URL bar\n\n3- Now login as 'victim' in diffrent browser and open the link and click cancel.\n\n4- FB account of 'victim' is replaced with FB account of 'attacker' (Removed from 'attacker' one)\n\n5-Login via attacker FB account and you will be logged in 'victim' account\n\nCongo u just hacked victim account\n-\n\nMore explanation\n-\n\nSuppose a user have an account of attacker 'A' with FB linked which 'FB-of-A' and a victim account 'B' with fb linked which is 'FB-of-B' now attacker create a link to import photos from his fb and give it to victim 'B' he opens it and press cancel but this have changed his FB account 'FB-of-B' to attacker's FB account 'FB-of-A', And now attacker can login with his fb account in victim's badoo account.\n\nFix\n-\n\nYou must have a CSRF token on external photoupload link so this type of attack fails\n\nhttps://m.badoo.com/external-provider-photo-import/xxxxxxxxxx\n\nAdd CSRF token on external-provider-photo-import end\n\nAnd also it must be valid for only that user. Token should not work on any account.\n\n\nProof of Concept \n-\nPC video \nhttps://hackerone-attachments.s3.amazonaws.com/production/000/077/667/0d545eb4457474d6d9fe4e9996d89feb6d0af418/Screen_03-10-2016_06-20-03.avi?AWSAccessKeyId=AKIAJFXIS7KJADBA4QQA\u0026Expires=1457618818\u0026Signature=058JY5MCOWRjpQsYLdfual0VrlE%3D\n\nMobile video\nhttps://youtu.be/xylkmN_IRF0\n\n\nSorry for too much messages :-) \n\nThanks \nHarsh jaiswal \u0026 Rudra \n\n\n\n\n\n\n","automated_response":false,"created_at":"2016-03-10T13:14:17.448Z","updated_at":"2016-03-10T13:14:17.448Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":833040,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey. Thanks for the info.\nWe are on it.","automated_response":false,"created_at":"2016-03-10T13:19:49.568Z","updated_at":"2016-03-10T13:19:49.568Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":833058,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks.","automated_response":false,"created_at":"2016-03-10T13:35:47.005Z","updated_at":"2016-03-10T13:35:47.005Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bumble"}},"bounty_amount":"850.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"bumble","collaborator":{"username":"bugdisclose","url":"/bugdisclose"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":833063,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you so much :-) ","automated_response":false,"created_at":"2016-03-10T13:39:03.802Z","updated_at":"2016-03-10T13:39:03.802Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":833071,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was expecting for 1000$ ","automated_response":false,"created_at":"2016-03-10T13:48:41.973Z","updated_at":"2016-03-10T13:48:41.973Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":833075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think your bounty is quite enough. Thanks.\nImpact is good but the vector is very simple.\nContinue finding bugs and maybe you'll find something more.\n","automated_response":false,"created_at":"2016-03-10T13:52:11.547Z","updated_at":"2016-03-10T13:52:11.547Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":833077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Completely Agree ","automated_response":false,"created_at":"2016-03-10T13:55:21.850Z","updated_at":"2016-03-10T13:55:21.850Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":835095,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-03-11T14:30:49.877Z","updated_at":"2016-03-11T14:30:49.877Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugdisclose","url":"/bugdisclose"},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":836538,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Any problem with this ? ","automated_response":false,"created_at":"2016-03-12T13:40:35.394Z","updated_at":"2016-03-12T13:40:35.394Z","first_to_agree":true,"actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":836542,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I don't see any problem with the disclosure. Thank you, @bugdisclose.","automated_response":false,"created_at":"2016-03-12T13:47:00.697Z","updated_at":"2016-03-12T13:47:00.697Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":836543,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-12T13:47:00.903Z","updated_at":"2016-03-12T13:47:00.903Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":861751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey can you please add me on corp.badoo.com/security by this name \" Harsh jaiswal \u0026 Rudra \" Link to bugdisclose.blogspot.com","automated_response":false,"created_at":"2016-03-22T09:45:26.905Z","updated_at":"2016-03-22T09:45:26.905Z","actor":{"username":"bugdisclose","cleared":false,"url":"/bugdisclose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/640/a9694d602212c6d063d67f88b754b7ef461e8460_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}