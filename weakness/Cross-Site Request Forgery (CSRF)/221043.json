{"id":221043,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEwNDM=","url":"https://hackerone.com/reports/221043","title":"CSRF token validation is missing","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-04-14T18:25:57.134Z","submitted_at":"2017-04-14T18:25:57.134Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"596a96cc7bf9108cd896f33c4","url":"/596a96cc7bf9108cd896f33c4","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-04-19T06:55:51.732Z","bug_reporter_agreed_on_going_public_at":"2017-04-19T00:47:04.857Z","team_member_agreed_on_going_public_at":"2017-04-19T06:55:51.656Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Greetings,\n\nHello Security Team,\n\n### Summary\nI know this is a medium risk issue but i want you guys to be aware of it that the CSRF token validation is missing at the time of login on `https://portal.nextcloud.com/login.php` login page.\n\n### PoC Code:\n```\n\u003cform name=\"frmlogin\" action=\"https://portal.nextcloud.com/login.php\" method=\"post\" onsubmit=\"return ValidateForm();\"\u003e\n\t\u003cdiv class=\"row\"\u003e\n\t\t\u003cdiv class=\"col-xs-12\"\u003e\n\t\t\t\u003cdiv class=\"form-group\"\u003e\n\t\t\t\t\u003clabel class=\"control-label\"\u003eEmail\u003c/label\u003e\n\t\t\t\t\u003cinput type=\"text\" name=\"member_username\" id=\"member_username\" value=\"\" class=\"form-control\"\u003e\n\t\t\t\u003c/div\u003e\n\t\t\u003c/div\u003e\u003c!-- col-sm-12 --\u003e\n\t\t\u003cdiv class=\"col-xs-12\"\u003e\n\t\t\t\u003cdiv class=\"form-group\"\u003e\n\t\t\t\t\u003clabel class=\"control-label\"\u003ePassword\u003c/label\u003e\n\t\t\t\t\u003cinput type=\"password\" name=\"member_password\" class=\"form-control\"\u003e\n\t\t\t\u003c/div\u003e\n\t\t\u003c/div\u003e\u003c!-- col-sm-12 --\u003e\n\t\t\u003cdiv class=\"col-xs-12\"\u003e\n\t\t\t\u003cdiv class=\"form-group text-center\"\u003e\n\t\t\t\t\u003cbutton class=\"btn btn-search btn-primary col-xs-12 mb10\" style=\"padding:10px;margin-top:10px;\" type=\"submit\" name=\"login\" value=\"Login Now\"\u003eLogin Now\u003c/button\u003e\n\t\t\t\t\u003ca href=\"https://support.nextcloud.com/#password_reset\"\u003eForgot Password?\u003c/a\u003e\n\t\t\t\u003c/div\u003e\n\t\t\u003c/div\u003e\u003c!-- col-sm-12 --\u003e\n\t\u003c/div\u003e\u003c!-- End Row --\u003e\n\u003c/form\u003e\n\u003cscript type=\"text/javascript\"\u003e\n\tvar tabs = '';\n\t//\u003c![CDATA[\n\tfunction ValidateForm()\n\t{\n\t\tvar f = document.frmlogin;\n\t\tif(f.member_username.value=='')\n\t\t{\n\t\t\talert('Please enter the Username.');\n\t\t\tf.member_username.focus(); return false;\n\t\t}\n\t\tif(f.member_password.value=='')\n\t\t{\n\t\t\talert('Please specify the Password.');\n\t\t\tf.member_password.focus(); return false;\n\t\t}\n\t}\n\t//]]\u003e\n\u003c/script\u003e\n```\n### PoC Attached is the html code: {F175917}\n\n### Impact:\n* An attacker can Brute force their password.\n* Brute force Attack\n\n\nRegards,\nj3","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":175917,"file_name":"csrf_token_is_missing.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/175/917/9665dc0dc8b938426d70c3281bff8bc6301f04a4/csrf_token_is_missing.html?response-content-disposition=attachment%3B%20filename%3D%22csrf_token_is_missing.html%22%3B%20filename%2A%3DUTF-8%27%27csrf_token_is_missing.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140649Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=61490bdc9e0c6273479e547ffd1fd19f425a42e0086510e549b6ac15b6a9f0fe","file_size":1398,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["r3y","spetr0x"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1612064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2017-04-14T18:25:57.264Z","updated_at":"2017-04-14T18:25:57.264Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612065,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"\u003e An attacker can Brute force their password.\n\u003e Brute force Attack\n\nThis is not really what a CSRF token would preventâ€¦","automated_response":false,"created_at":"2017-04-14T18:27:37.768Z","updated_at":"2017-04-14T18:27:37.768Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lukasreschke \nIts my typo error, i mean, `An attacker can launch a brute force attack to any users` by guesting email and guesting password.\n\nAnd i mean its a medium security risk. but its a good practice for a login page to implement a csrf token validation.\n\n\u003eThis is not really what a CSRF token would prevent,\n\nSo do you mean that the security are not increase when we use a csrf token on login form?","automated_response":false,"created_at":"2017-04-14T18:37:50.678Z","updated_at":"2017-04-14T18:37:50.678Z","actor":{"username":"596a96cc7bf9108cd896f33c4","cleared":false,"url":"/596a96cc7bf9108cd896f33c4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke Its seems you guys implemented a nonce on this url `https://auth.nextcloud.com`","automated_response":false,"created_at":"2017-04-14T18:46:28.961Z","updated_at":"2017-04-14T18:46:28.961Z","actor":{"username":"596a96cc7bf9108cd896f33c4","cleared":false,"url":"/596a96cc7bf9108cd896f33c4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1612122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke\n\nHoping for your response.\n\nThanks,\nj3","automated_response":false,"created_at":"2017-04-14T18:51:08.663Z","updated_at":"2017-04-14T18:51:08.663Z","actor":{"username":"596a96cc7bf9108cd896f33c4","cleared":false,"url":"/596a96cc7bf9108cd896f33c4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1619907,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-19T00:47:04.870Z","updated_at":"2017-04-19T00:47:04.870Z","first_to_agree":true,"actor":{"username":"596a96cc7bf9108cd896f33c4","cleared":false,"url":"/596a96cc7bf9108cd896f33c4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620223,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-19T06:55:51.709Z","updated_at":"2017-04-19T06:55:51.709Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620224,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-19T06:55:51.745Z","updated_at":"2017-04-19T06:55:51.745Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3825,"category":"researcher","content":"@lukasreschke, Sorry my mistake and my foolish action., Anyway i'm a newbie.\n\nI've found that even if there is a xsrf token on login form  you can brute force  the login form using Burp Intruder, with an extender extension to handle the CSRF token., that is why you said `This is not really what a CSRF token would preventâ€¦` Thank you for correcting me on that.\n\nBut in fact that the `CSRF token validation is missing` on `https://portal.nextcloud.com/login.php` is my correct part. would you consider my report is valid? Thank you very much.\n\nCheers!, and God bless @lukasreschke","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":154069,"username":"596a96cc7bf9108cd896f33c4","name":"","bio":"","cleared":false,"website":"","location":"","created_at":"2017-03-26T19:26:09.512Z","url":"https://hackerone.com/596a96cc7bf9108cd896f33c4","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":null,"profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}