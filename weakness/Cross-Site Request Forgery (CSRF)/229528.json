{"id":229528,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjk1Mjg=","url":"https://hackerone.com/reports/229528","title":"Login CSRF : Login Authentication Flaw","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-05-18T06:50:42.729Z","submitted_at":"2017-05-18T06:50:42.729Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"japz","url":"/japz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-02T09:51:04.678Z","bug_reporter_agreed_on_going_public_at":"2017-05-19T13:32:01.545Z","team_member_agreed_on_going_public_at":"2017-06-02T09:51:04.608Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDomain: `demo.weblate.org`\n\nIn this bug, i have found a way to login any person to the attackers account, therefor when any user login to attackers account, the attacker can see the victims activity inside attackers account such as sensitive information. The issue relies on __registration confirmation together with the password reset__.\n\n### Steps to reproduce:\n\n  1. Attacker create account\n  2. Account confirmation will send to the attackers email \n  3. Attackers will send the confirmation link to the victim\n  4. Victim clicks the link and will automatically logged in to the attackers account.\n  5. Done, victim will think that he/she is in his own account.\n\nNow, how the attackers can view the information that the victim supplied to the account ? (let say the victim provided a password that the attackers do not know ? , this is where the flaw of the password reset will use, because password reset also automatically logged in the person who have the password reset link even without supplying the password.\n\n### Attackers steps to access the fake account on where the victim was logged-in\n\n  1. Attacker go to reset password and perform reset since attacker originated the email address of the fake account.\n  2. Password reset link will sent to attackers email.\n  3. Attacker will click the reset link and will automatically logged in even did not supply the password.\n  4. Done. Attacker and Victim now logged in in the same account.\n  5. Attacker can now see all activities of the victim including all sensitive information that the victim supplied to the account.\n\n### Mitigation:\n\nI have observed that the password creation was not enforced on the registration form and this will causes the issue on the 2 endpoints (registration and reset password).\n\n__Fix: PASSWORD should be enforced to create upon registration.__\n\n__1. Regisration Endoiunt Fix:__ Now when the password is created upon registration, the confirmation link sent to email should be redirected to the login page, then the user should input the username and password first before continue logged in to the account.\n\n__2. Password Reset Fix:__ Now when anyone request password reset, the url link of reset password should redirect to the page that will require `current, newpass, and confirm newpass`, __BUT do not directly logged-in the account, after successfully changing the password it should also redirect to login page, then the user will input username and password before continue logged in to the account.\n\nLet me know if you need more information.\n\nRegards\nJapz","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-18T13:32:02.195Z","allow_singular_disclosure_after":-136168661.6626144,"singular_disclosure_allowed":true,"vote_count":9,"voters":["eveeez","r3y","luckydivino","japz","jong_jong","spetr0x","mrr3boot","muhaddix","jadav233"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1684332,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Sorry, but how is user supposed to enter current password on password reset? The password reset is used in situation when user forgets the password, so this really has to work without prior password knowledge.","automated_response":false,"created_at":"2017-05-18T19:56:23.629Z","updated_at":"2017-05-18T19:56:23.629Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1685374,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @nijel ,\n\n\u003eSorry, but how is user supposed to enter current password on password reset? The password reset is used in situation when user forgets the password\n\nActually the current behavior for inserting the password is correct, the only issue is after i clicked the password reset url link , it will redirect to password reset __BUT IT IS ALREADY LOGGED-IN__ , please see attached screen shot (resetpass_redirect_page.png).\n\n{F185982}\n\nThe issue is, why did you automatically logged-in the user after clicking the reset pass link.\n\n__Fix:__ Do not directly logged-in the user after clicking the link, let them finished changing the password, after changing the password, redirect it to login page for `Re-authentication` , that will resolved the issue so that the account will be safe.\n\nRegards\nJapz","automated_response":false,"created_at":"2017-05-19T08:45:56.246Z","updated_at":"2017-05-19T08:45:56.246Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":185982,"filename":"resetpass_redirect_page.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/185/982/bbe42031022359dc220617be57db9654e5341832/resetpass_redirect_page.png?response-content-disposition=attachment%3B%20filename%3D%22resetpass_redirect_page.png%22%3B%20filename%2A%3DUTF-8%27%27resetpass_redirect_page.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140943Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=eef4e1216943f31f2f868c1f3db424c26731d9dc15898508d9e2978d9a8e8d0a"}],"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1685531,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for spotting, fixed in https://github.com/WeblateOrg/weblate/commit/b76e73ebe9723d3feed9c8c32573dff1c7dd18a2, will be deployed later today.","automated_response":false,"created_at":"2017-05-19T10:07:43.399Z","updated_at":"2017-05-19T10:07:43.399Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"japz","url":"/japz"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1685938,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Good job @nijel , really quick.. lets disclose when the update already pushed into prod environment.\n\nCheers\nJapz","automated_response":false,"created_at":"2017-05-19T13:32:02.172Z","updated_at":"2017-05-19T13:32:02.172Z","first_to_agree":true,"actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1686140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I prefer disclosures once the issue is also fixed in released version, so it will take a bit more time (but I will most likely push hotfix version next week if I'll have time for that).","automated_response":false,"created_at":"2017-05-19T14:47:16.195Z","updated_at":"2017-05-19T14:47:16.195Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1686165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nnijel , no worries :) disclose it at your convenience.\n\nRegards\n@japzdivino ","automated_response":false,"created_at":"2017-05-19T14:54:50.847Z","updated_at":"2017-05-19T14:54:50.847Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1697282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nijel ,\n\nJust to give you a confirmation on my end, i just retested the `demo` and `hosted` domain and the issue no longer exist, so i assume the fix for the issue already pushed to prod. :)\n\nLet me know if i am not mistaken, so that you can proceed to disclosure.\n\nCheers\nJapz","automated_response":false,"created_at":"2017-05-24T09:41:40.814Z","updated_at":"2017-05-24T09:42:54.550Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1724450,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-06-02T09:51:04.634Z","updated_at":"2017-06-02T09:51:04.634Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724451,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-06-02T09:51:04.711Z","updated_at":"2017-06-02T09:51:04.711Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}