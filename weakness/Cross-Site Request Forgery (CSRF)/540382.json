{"id":540382,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDAzODI=","url":"https://hackerone.com/reports/540382","title":"CSRF allows attacker to manage customer's shopping cart.","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2019-04-16T17:04:51.597Z","submitted_at":"2019-04-16T17:04:51.597Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"flamingo","url":"/flamingo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39424,"url":"https://hackerone.com/tomtom","handle":"tomtom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/424/007e488fb83dfcd5086bd2c42897c19cb20a4025_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/424/007e488fb83dfcd5086bd2c42897c19cb20a4025_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"TomTom","twitter_handle":"tomtom","website":"https://tomtom.com/","about":"TomTom is shaping the future, leading the way with autonomous driving, smart mobility and smarter cities."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-13T23:02:13.745Z","bug_reporter_agreed_on_going_public_at":"2019-04-17T08:08:49.414Z","team_member_agreed_on_going_public_at":"2019-06-13T23:02:13.612Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The following endpoint https://www.tomtom.com:443/en_us/store/basket-add.html had no CSRF checks / tokens .. whatsoever , which allows a malicious user add massive amounts of a any product to a victim's cart or empty the cart.\n\nthe CSRF POC file  included adds 50 items of the giving product the a victim's cart , and the quantity can be changed to any number , or to 0 to empty the cart .\nalso the script can be modified to require no interraction from the victim .\n\n## Impact\n\n- A customer can proceed shopping without noticing that other items has been added to his cart .\n- A customer might lose all his items previously added to cart , which is frustrating.","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":540281,"original_report_url":"https://hackerone.com/reports/540281","attachments":[{"id":470161,"file_name":"POC.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/470/161/09fdd9449918c163879204c2afd77d5f98eaebad/POC.html?response-content-disposition=attachment%3B%20filename%3D%22POC.html%22%3B%20filename%2A%3DUTF-8%27%27POC.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150958Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5ce15cc63942e45f34ded629f865cdaeb8ea67db69f12ca568094d1b076c1a32","file_size":1832,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["flamingo"],"structured_scope":{"databaseId":24133,"asset_type":"URL","asset_identifier":"*.tomtom.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4577123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @abzi, \n\nThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \nPlease provide a detailed proof of concept that includes the following:\n* How to find the vulnerable functionality\n* Steps to reproduce the issue\n\nProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\n\nRegards, \n@sodacan","automated_response":false,"created_at":"2019-04-16T17:51:29.342Z","updated_at":"2019-04-16T17:51:29.342Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4577209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Steps to reproduce :\n- choose any product and click \" Buy Now \" , and while burp intercepter is on , click on \" Add to cart \"\n- go to the intercepted request in burp , and if you are logged in , remove this parameter 'logged_in_user=' intirely .\n- send the request to burp CSRF POC creator ( a burp plugin )\n- add this line to the POC : \u003cinput type=\"text\" name=\"quantity\" value=\"50\"\u003e , and save it as html.\n","automated_response":false,"created_at":"2019-04-16T18:10:09.544Z","updated_at":"2019-04-16T18:12:31.215Z","actor":{"username":"flamingo","cleared":false,"url":"/flamingo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4581151,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @abzi,\n\nThanks for the report. Unfortunately this was submitted previously by another tester, but we appreciate your work and look forward to additional reports from you.\n\nGood Luck!\n@lasagna ","automated_response":false,"created_at":"2019-04-17T07:47:03.275Z","updated_at":"2019-04-17T07:47:03.275Z","original_report_id":540281,"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4581271,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-17T08:08:49.436Z","updated_at":"2019-04-17T08:08:49.436Z","first_to_agree":true,"actor":{"username":"flamingo","cleared":false,"url":"/flamingo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5086732,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-06-13T23:02:13.673Z","updated_at":"2019-06-13T23:02:13.673Z","actor":{"username":"mcgivney","cleared":false,"url":"/mcgivney","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5086733,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-06-13T23:02:13.777Z","updated_at":"2019-06-13T23:02:13.777Z","actor":{"username":"mcgivney","cleared":false,"url":"/mcgivney","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}