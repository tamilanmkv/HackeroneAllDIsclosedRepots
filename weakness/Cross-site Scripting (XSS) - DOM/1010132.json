{"id":1010132,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDEwMTMy","url":"https://hackerone.com/reports/1010132","title":"Possible DOM XSS on app.hey.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-10-16T13:57:35.282Z","submitted_at":"2020-10-16T13:57:35.358Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"enigmaticjohn","url":"/enigmaticjohn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":67,"url":"https://hackerone.com/basecamp","handle":"basecamp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Basecamp","twitter_handle":"basecamp","website":"https://basecamp.com/about/policies/security/response","about":"Basecamp is the leading online project manager and the birthplace of Ruby on Rails. Creators of the HEY email service."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-27T19:44:49.290Z","bug_reporter_agreed_on_going_public_at":"2020-10-27T19:44:49.204Z","team_member_agreed_on_going_public_at":"2020-10-27T18:25:17.211Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Summary:\n\nHello Team,\nWhile testing it was observed that on https://app.hey.com/, on Search box there is a possibility of XSS. Although the payload is reflected in the DOM but the CSP blocks the execution of the script, the XSS can happen if the CSP is somehow bypassed. The Subject parameter is vulnerable.\n\nApart from XSS, the HTML injection attack is working pretty straight forward.\n\n#Steps To Reproduce:\n1. Go to https://app.hey.com\n2. Login to your account.\n3. Click on 'Write' Mail button.\n4. Add the recipient as yourself.\n5. In the Subject, add following payload\n```\nTestPayload\u0026lt;/a\u0026gt;\u0026lt;a href=\"javascript:alert(1)\"\u0026gt;ClickHere\u0026lt;/a\u0026gt;\n```\n6. Send the mail.\n7. Go to top left corner Search Box and type \"**TestPayload**\" \n8. You will see the mail you sent to yourself, and \u003ca\u003e tag will be there \"ClickHere\".\n9. Click on it, you will see the CSP violation in the Console.\n10. Below is the CSP of the page:\n\n```\nscript-src 'self' https://production.haystack-assets.com stats.hey.com *.braintreegateway.com *.braintree-api.com hcaptcha.com *.hcaptcha.com; \nobject-src 'none'; \nbase-uri 'none'; \nform-action 'self'; \nframe-ancestors 'none'; \nreport-uri https://sentry.io/api/1371426/security/?sentry_key=3a5ea420eecc45bd9e1d1c2424683f3a\u0026sentry_environment=production\u0026sentry_release=\n```\nAs seen from the CSP, there might be a possibility of Host whitelists bypass.\n\n## Impact\n\nIf attacker send such type of mail to a victim and if victim accidentally searches for the same mail then the Script will be executed leading to account takeover. This is possible only if CSP is bypassed.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-26T18:25:17.383Z","allow_singular_disclosure_after":-27543068.87139277,"singular_disclosure_allowed":true,"vote_count":64,"voters":["sw33tlie","xploiterr","mzfr","fqdn","najeh_halawani","ali","sudi","rahulkadavil_","moex","3x3s","and 54 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":53959,"asset_type":"URL","asset_identifier":"*.hey.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9542574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attachments","automated_response":false,"created_at":"2020-10-16T14:03:48.237Z","updated_at":"2020-10-16T14:03:48.237Z","actor":{"username":"enigmaticjohn","cleared":false,"url":"/enigmaticjohn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1038813,"filename":"POC.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CNvEsmbZcN4VM1mbgrDUZZ4D?response-content-disposition=attachment%3B%20filename%3D%22POC.JPG%22%3B%20filename%2A%3DUTF-8%27%27POC.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131626Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=33951bd1fb838f3929c708d72dfe144db8c295f6523deda7ca59a4ec69dda141"},{"id":1038811,"filename":"POC2.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/44fF5UbB5B1YPMHSGoayk4bB?response-content-disposition=attachment%3B%20filename%3D%22POC2.JPG%22%3B%20filename%2A%3DUTF-8%27%27POC2.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131626Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b86750d4a483ee8cf4853cb09afaca39a8050d8e3723a0a624029f156b39f051"}],"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9560254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @enigmaticjohn, thanks for sending this report! We'll take a look and let you know. \n\nRosa","automated_response":false,"created_at":"2020-10-19T08:12:14.276Z","updated_at":"2020-10-19T08:12:14.276Z","actor":{"username":"rosa","cleared":false,"url":"/rosa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/154/237/a07aeeba083a8f178942d326a68f6427c699e0f1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9562498,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-10-19T10:38:01.147Z","updated_at":"2020-10-19T10:38:01.147Z","additional_data":{"old_severity":"Medium","new_severity":"High","old_severity_id":878763,"new_severity_id":880560},"actor":{"username":"jorgemanrubia","cleared":false,"url":"/jorgemanrubia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2Y7kee1jgW6dtashD6ok6qT3/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9562499,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-10-19T10:38:12.047Z","updated_at":"2020-10-19T10:38:12.047Z","actor":{"username":"jorgemanrubia","cleared":false,"url":"/jorgemanrubia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2Y7kee1jgW6dtashD6ok6qT3/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9562537,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report @enigmaticjohn. I could also reproduce this by sending an email to HEY from an external provider, so it was very easy to inject unescaped HTML in users' search results. I raised severity to high. We are interested in dealing with root causes for potential XSS issues, even when intercepted by our CSP. We'll have a fix deployed for this soon. \n\nThanks!\n\n","automated_response":false,"created_at":"2020-10-19T10:42:29.673Z","updated_at":"2020-10-19T10:42:29.673Z","actor":{"url":"/basecamp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/STtZ2opgRsHdKby72xs56KhB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Basecamp"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"basecamp","collaborator":{"username":"enigmaticjohn","url":"/enigmaticjohn"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9563794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi team, \nThanks for the bounty :)","automated_response":false,"created_at":"2020-10-19T13:01:02.654Z","updated_at":"2020-10-19T13:01:02.654Z","actor":{"username":"enigmaticjohn","cleared":false,"url":"/enigmaticjohn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9573992,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@enigmaticjohn this should be fixed now. I'd appreciate if you could confirm on your side.\n\nThanks!","automated_response":false,"created_at":"2020-10-20T10:09:15.503Z","updated_at":"2020-10-20T10:09:15.503Z","actor":{"username":"jorgemanrubia","cleared":false,"url":"/jorgemanrubia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2Y7kee1jgW6dtashD6ok6qT3/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9574144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jorgemanrubia,\nI tested it again, and can verify that the issue is no more observed.\nThanks!","automated_response":false,"created_at":"2020-10-20T10:26:23.719Z","updated_at":"2020-10-20T10:26:23.719Z","actor":{"username":"enigmaticjohn","cleared":false,"url":"/enigmaticjohn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9586436,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for confirming @enigmaticjohn ","automated_response":false,"created_at":"2020-10-21T09:23:33.253Z","updated_at":"2020-10-21T09:23:33.253Z","actor":{"username":"jorgemanrubia","cleared":false,"url":"/jorgemanrubia","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/2Y7kee1jgW6dtashD6ok6qT3/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"enigmaticjohn","url":"/enigmaticjohn"},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9651429,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-27T18:25:17.252Z","updated_at":"2020-10-27T18:25:17.252Z","first_to_agree":true,"actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9652559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-27T19:44:49.238Z","updated_at":"2020-10-27T19:44:49.238Z","actor":{"username":"enigmaticjohn","cleared":false,"url":"/enigmaticjohn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9652560,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-27T19:44:49.327Z","updated_at":"2020-10-27T19:44:49.327Z","actor":{"username":"enigmaticjohn","cleared":false,"url":"/enigmaticjohn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FyYEq1N1itB6rgYGfmieTVnT/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"basecamp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}