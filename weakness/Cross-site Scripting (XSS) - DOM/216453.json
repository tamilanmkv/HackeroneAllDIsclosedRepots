{"id":216453,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTY0NTM=","url":"https://hackerone.com/reports/216453","title":"Unfiltered `class` attribute in markdown code","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-27T16:26:59.771Z","submitted_at":"2017-03-27T16:26:59.771Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chalker","url":"/chalker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-04-13T14:46:15.472Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-04-06T04:08:03.765Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This affects merge request/issue comments and probably other parts of the user interface.\n\nI am demonstrating PoCs on GitLab.com itself, as they don't affect anything outside of my test repo, which is private. It could be used to execute some js actions by contructing content that uses the pre-existing attached event handlers (for example, `onclick`), but I am not sure how far could that go — I have not reviewed that, the mentioned issues are already pretty bad.\n\nThis could be used to make some issue/merge request pages inaccessible, to forge page content and potentially forge or hide other users comments in the thread.\n\n## PoC 1 — full-size message\nDemo: https://gitlab.com/ChALkeR/my-private-test-project/issues/2\n```html\n\u003cpre class=\"zen-backdrop fullscreen sherlock-line-samples-table center\"\u003e\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\n\u003cp\u003e\u0026nbsp;\u003c/p\u003e\n\u003cimg src=\"https://about.gitlab.com/images/press/logo/wm_no_bg.svg\" width=\"500\"\u003e\n\u003ch2\u003eHello there! Something has gone wrong, we are working on it.\u003c/h2\u003e\n\u003ch3\u003eIn the meantime, play a game with us at \u003ca href=\"http://example.com/\"\u003eexample.com\u003c/a\u003e.\u003c/h3\u003e\n\u003c/pre\u003e\n```\n\n## PoC 2 — basic JavaScript\n\nDemo: https://gitlab.com/ChALkeR/my-private-test-project/issues/3\n```html\n\u003cpre class=\"js-details-expand\"\u003eclick me\u003c/pre\u003e\n\u003cpre class=\"js-details-content hide\"\u003efoo\u003c/pre\u003e\n```\n\nThere is a significant amout of onlick event listeners that are bound using just the classname, so it is possible to do some basic stuff with just classes and might be possible to execute more complex actions.\n\nI have not reviewed all instances in the JS where the classnames are used, that is irrelevant to fixing this issue.\n\n## Suggested fix\nBoth of the following should be applied:\n * Filter `class` attributes (higher priority).\n * Make sure that user content couldn't be displayed outside of the bounding box, e.g. by applying `oveflow:hidden` (lower priority).","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":171563,"file_name":"Spectacle.F20349.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/171/563/15d32a32e6251277b34b284ddf547b2bbb76cace/Spectacle.F20349.png?response-content-disposition=attachment%3B%20filename%3D%22Spectacle.F20349.png%22%3B%20filename%2A%3DUTF-8%27%27Spectacle.F20349.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRIN5EFBE%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140533Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIBhBo9%2BUqNxY%2Bdl%2FBu6j6mVjFeVGWlX5BwuNk30B2pI7AiBQHUUbG%2FDPlDr8hIO32FMCMyDmnYxvDdVBvosTOZwinyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM8sXPkJOx9vMC77IEKtcDIV9fcoJlSEMqzyGBN8r5cvnWs1RDUOFGGZvMSBD3mEA7oDpMSi%2BV7Zp9cOht07PFLX%2BkJK8eC1UTkCn542dx8VJGQsKAyVMnUijrNudvAtZaz4XmN54QO8IAmSWJAz1M4dpRjKM3mpj%2FRtGlWd3KN52y5erIqbsZL2gDnrA%2FRb3fgap6IHD7xfj6d0gbxTW4t4%2FdNxTbdiUOs%2BzGzj%2FLTVG1Y2pAFSOg%2FtQWuve8SbkTy352fvT3gWDrJKVFK4FnKn4DMECasTJgeWjjC5%2FMBxmNQ4Ck1dV%2Bd2U1r3%2FXszmBUhzCVAnW%2BBtuglfqKxlek0HFP2W%2FAgf7HsdcRXu4XQ9grbRgh1ZNM9yCRee%2FQ8AoIWmoCQS%2BbBfiZfI9t95HA%2Fnu0iExODE3gc%2FeDNILImEbUu8YNyftwi4u%2BBTFJzhLm45mJqK2nq8%2F1P%2BZ%2FjDCVTu7n6SR3CDOMKZAj5KEc2HF25gj0XTKyS4MKzzEI3%2B1%2BX1BRUu%2Ft%2Foofn%2BCL69KENTohq5xEcSjfjHYy%2FruEuKnSzzB2Olo0%2Fch%2Bgu9EjjuR5sCj5hDvticB%2BiLsNWB0Sjpt4T5BO2Gz9yWZ5R7UDjFjBikyO0qI3cmEMuMQ9c4%2Bi%2BthNSEMOrskIsGOqYBSW5YtERPJhE422%2BOJ%2FODVERL3856%2BJxv6Gylf0pw9PAOnyl%2FoQCO3GPLC6BDKKKCT0DANAMHRViXtizwdYWxIVcxRRpAFRuplthRNuoekn7M%2BD9Vyq2Ves6bm56gWv49amyryPOpp3Kpzb30DAEAyzl0ZK%2BqfWyDzq5HLSIy5lGtjLObsOuLdF%2BYMEHir%2BrCGGp%2FmWPemSN9vmdtiNbqa6zyiUuPDw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f41cc09ea6bcdad237d4da44033d737974a364fb8f7294b38d9aa0e0cdfffe34","file_size":95460,"type":"image/png"}],"allow_singular_disclosure_at":"2017-05-06T04:08:03.824Z","allow_singular_disclosure_after":-139917450.05550888,"singular_disclosure_allowed":true,"vote_count":11,"voters":["edoverflow","muhammad_uwais","eveeez","haxta4ok00","apapedulimu","m7mdharoun","linkks","spetr0x","pratikx99","alaaeb3ad","and 1 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1565602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By filtering `class` atributes I mean — either remove them completely, or allow a predefined set of allowed (whitelisted) classes.","automated_response":false,"created_at":"2017-03-27T16:32:38.582Z","updated_at":"2017-03-27T16:32:38.582Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1565605,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report @chalker. I've opened a confidential issue at https://gitlab.com/gitlab-org/gitlab-ce/issues/30125 so we can discuss a fix. We'll keep you updated here on its progress.","automated_response":false,"created_at":"2017-03-27T16:33:20.897Z","updated_at":"2017-03-27T16:33:20.897Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1568283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates on this? The first fix (whitelisting allowed classes) should be trivial and would fix the most important issue here.","automated_response":false,"created_at":"2017-03-28T17:07:01.835Z","updated_at":"2017-03-28T17:07:01.835Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1568299,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chalker,\n\nNothing yet. You have to give us more than one day!  ;)","automated_response":false,"created_at":"2017-03-28T17:14:41.807Z","updated_at":"2017-03-28T17:14:41.807Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1568300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chalker A fix is in progress. It's not entirely trivial because our syntax highlighting code is affected.","automated_response":false,"created_at":"2017-03-28T17:14:49.068Z","updated_at":"2017-03-28T17:14:49.068Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1569923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, ok.\n\nThe reason why I'm asking is because this issue is not unique to GitLab implementation, so I'm trying to coordinate things.\n\nBtw, could you please delay the public disclosure until a further confirmation, just in case?\nReleasing a public patch is fine, I'm talking only about making this report public or publishing something like a blog post.","automated_response":false,"created_at":"2017-03-29T09:34:59.642Z","updated_at":"2017-03-29T09:34:59.642Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1570026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that I'm reporting a similar issue to another open-source project today, and when they fix that — it's probably going to be present in their changelog/commit log likewise.\n\nI am going to ask them to delay other means of public disclosure.","automated_response":false,"created_at":"2017-03-29T10:39:18.706Z","updated_at":"2017-03-29T10:39:18.706Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chalker,\n\nWe always try to include a description of each vulnerability in the security release blog post so that users can make an informed decision about the impact of the vulnerability and better determine if they need to upgrade.\n\nDepending on when the other project will be releasing a patch we might be able to coordinate a release for the same day if it's important.","automated_response":false,"created_at":"2017-03-29T19:09:48.561Z","updated_at":"2017-03-29T19:09:48.561Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1571331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.\nPart of the issue here is the fact that the number of parties involved is more than 2.\n\nI will ask you to delay publishing this until a confirmation is received.\nI will ask other parties not to publish this until I receive a confirmation from you.\n\nLet me know if it's ok to share the fact that GitLab is affected with other parties or not (that might ease the coordination).\n\nNikita.","automated_response":false,"created_at":"2017-03-29T19:30:46.416Z","updated_at":"2017-03-29T19:30:46.416Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1579900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi! I am waiting for a confirmation from a thirdparty that this could be disclosed, and hope to receive that confirmation soon.\n\nWhat is the status of the fix on your side — i.e. is it ready to be released?","automated_response":false,"created_at":"2017-04-03T09:09:56.250Z","updated_at":"2017-04-03T09:09:56.250Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1580143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Status update: the number of affected projects with the exact same issue (with minor differences) increased to 5.\n\nThey were all informed about this issue being present in their software and that it is not unique to their software (i.e. that full public disclosure requires at least some level of coordination), in pretty much the same language as here.\n\nOne of them, gogs, has made a public commit with the fix, but did not make a public statement about the issue.\nRef: https://github.com/gogits/gogs/commit/9d06ebd01a07b51ab2513e171dcfb79183c4997c","automated_response":false,"created_at":"2017-04-03T11:23:42.640Z","updated_at":"2017-04-03T11:25:15.817Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1580172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note: gogs fix is incomplete, DO NOT reproduce it.","automated_response":false,"created_at":"2017-04-03T11:41:56.530Z","updated_at":"2017-04-03T11:41:56.530Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1581165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chalker,\n\nWe're not comfortable with our vulnerability being shared with other projects. We have several other security patches that we would normally bundle into a security release that are in various stages of readiness. The patch for this vulnerability it ready to go but we'd prefer to bundle it with the others so we don't have several security releases in the same week. That places a large burden on administrators.\n\nIf you have a date you can provide us as to when the other projects will be releasing their patches we can do our best to release at the same time, but otherwise I think we're fine with everyone releasing on their own schedule.","automated_response":false,"created_at":"2017-04-03T17:55:21.010Z","updated_at":"2017-04-03T17:55:21.010Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1581220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the response.\n\nGitHub just informed me that the issue is fixed on their side, including GitHub Enterprise, and that they are ok with a private disclosure with other projects (including the fact that GitHub was involved).\nTheir release notes are here: https://enterprise.github.com/releases/2.9.2/notes\n\nNote that there are other affected projects, apart from GitHub and GitLab, but the rest of them are either less affected by this or are less popular than GitLab.\n\n\u003e We're not comfortable with our vulnerability being shared with other projects.\n\nOk, I am not going to mention GitLab to other projects at this point.\n\nThe main reason why I asked is because I wanted to give other projects a good reason for not disclosing this atm, but I guess this is not needed anymore (see below).\n\n\u003e If you have a date you can provide us as to when the other projects will be releasing their patches we can do our best to release at the same time, but otherwise I think we're fine with everyone releasing on their own schedule.\n\nNo, I don't have a date, it's hard to organize things like this .\n\nCan you confirm that you are ok with other projects releasing fixes to this specific issue in their code with the detailed information at this point? Note that GitHub has not released the detailed information in their release notes, and I asked them not to (because there were other affected projects).\n\nNikita.","automated_response":false,"created_at":"2017-04-03T18:12:38.871Z","updated_at":"2017-04-03T18:12:38.871Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chalker,\n\nBecause we unlock our patch issues and merge requests whenever we perform a security release it's almost impossible for us to hide a patch without providing a summary. People would notice a merge request with no matching description. That would likely draw more attention than releasing it with the full write-up.\n\nWe're planning to release our patch this Wednesday, April 5th. If that's OK with you and the other projects please let us know. Thanks!","automated_response":false,"created_at":"2017-04-04T02:13:13.291Z","updated_at":"2017-04-04T02:13:13.291Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann.\n\n\u003e Because we unlock our patch issues and merge requests whenever we perform a security release it's almost impossible for us to hide a patch without providing a summary.\n\nYes, thanks, that is understandable. I am just trying to figure out the best course of action here.\n\n\u003e People would notice a merge request with no matching description. That would likely draw more attention than releasing it with the full write-up.\n\nThat looks like a valid consideration, I overlooked that.\n\n\u003e We're planning to release our patch this Wednesday, April 5th.\n\nOk, I will try to let others know, thanks!\n\nThe problem on my side is that telling others that a coordinated release is needed without providing enough information about the fact that the issue is present in some other major open-source project is impossible, and «some other major open-source project» could be pretty much deduceable — the total number of similar popular projects is not too high, and the issue is shared.\n\nThis is a message (with minor differences) I just sent to two independent thirdparty projects:\n\n\u003e Hi. There at least one more project that is more popular than **redacted** there.\n\u003e They are planning to do a release on Wednesday, April 5th.\n\u003e Please hold off disclosing the issue until that date.\n\u003e On the other hand, their release will disclose the issue (in their project, but the issue is shared between several projects, including **redacted**), so it would be best to prepare a release by then and to perform a coordinated release on Wednesday, April 5th.\n\u003e If that is impossible, then note that any date after April 5th will be ok and there would be no more need for you to hold off disclosure anymore.\n\nThis is the best thing that I could do IMO in this course of action, though.\n\nNote that all of them are also open-source and also provide detailed information, so they are in the same position as you. On the other hand, they are either less popular or less affected than GitLab.\n\nNikita.","automated_response":false,"created_at":"2017-04-04T05:17:13.343Z","updated_at":"2017-04-04T05:24:10.363Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e We're planning to release our patch this Wednesday, April 5th. If that's OK with you and the other projects please let us know. Thanks!\n\nI notified other projects about the scheduled disclosure for April 5th, they are ok with that and will also publish their releases and disclosure on April 5th or later.","automated_response":false,"created_at":"2017-04-04T11:39:50.908Z","updated_at":"2017-04-04T11:39:50.908Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583008,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I understand and appreciate you going above-and-beyond to help coordinate the releases. We have a security release scheduled for Wednesday including some other fixes, but if you do decide you'd like us to delay this particular patch please let me know and we'll remove it from that release.\n\nThanks for understanding.","automated_response":false,"created_at":"2017-04-04T14:56:13.430Z","updated_at":"2017-04-04T14:56:13.430Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583073,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@briann There is no need to delay this.\nAs I already said, other projects confirmed that April 5th (as you proposed) is ok.","automated_response":false,"created_at":"2017-04-04T15:18:16.984Z","updated_at":"2017-04-04T15:18:16.984Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1586362,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @chalker,\n\nWe just released a patch for this vulnerability: https://about.gitlab.com/2017/04/05/gitlab-9-dot-0-dot-4-security-release/\n\nThanks so much for the report! Let us know if you'd prefer we link to another profile, twitter handle, or what-have-you in our vulnerability acknowledgements page. We'd be happy to oblige.","automated_response":false,"created_at":"2017-04-06T03:48:28.638Z","updated_at":"2017-04-06T03:48:28.638Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chalker","url":"/chalker"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1586380,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-06T04:08:03.790Z","updated_at":"2017-04-06T04:08:03.790Z","first_to_agree":true,"actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1586447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@briann Thanks, that's great! =)\n\n\u003e if you'd prefer we link to another profile, twitter handle, or what-have-you\n\nI usually use my GitHub profile ( https://github.com/ChALkeR/ ) — btw, that's where I will post the details on the issue (my [notes](https://github.com/ChALkeR/notes) repo is, in fact, my new blog). I would prefer that, with, perhaps, switching the link to the corresponding blog post in the said repo when I will prepare one — that would provide the readers more details on the issue.\n\nMy twitter handle is also fine ( https://twitter.com/skovorodan ), though I usually just post random stuff there.\n\n\u003e briann requested to disclose this report publicly.\n\nAs for the disclosure of this exact thread — while that is a positive thing and I wish to see that happen, I would ask you to wait for some time (probably several days) until I receive confirmation from other projects, as this thread provides more information than your release notes (i.e. the fact that there were other projects affected).\n\nI am new to this HackerOne thing, so I have no experience of handling dislosure here, but please make sure that this thread does not go public until I receive a confirmation from all other affected parties (I will notify you here). \nThanks.\n\nNikita.","automated_response":false,"created_at":"2017-04-06T05:41:19.601Z","updated_at":"2017-04-06T05:41:19.601Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1586562,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@briann, one more thing to note: the patch you made and deployed does not affect existing posts — e.g. if someone already posted malicous content to some server (e.g. GitLab.com), it would still be there.\n\nI.e. this fix does not re-process all the existing markdown comments, files, and other stuff. At least judging by what I observe on GitLab.com.","automated_response":false,"created_at":"2017-04-06T07:43:51.097Z","updated_at":"2017-04-06T07:43:51.097Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1586718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Re: disclosure: I see the «Public disclosure in 29d, 18hr, 5min» label now, that looks fine to me =).","automated_response":false,"created_at":"2017-04-06T10:05:04.293Z","updated_at":"2017-04-06T10:05:04.293Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1588357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'll update our acknowledgements page with your GitHub profile link. \n\nAs far public disclosure, we always leave that up to the reporter. If you prefer we don't disclose here we won't. But like you've noticed there's a delay of about a month by default unless both sides agree to disclose right away. The default for us is to always request disclosure right away because some reporters get antsy. \n\nRegarding the patch itself. These filters get re-run every time Markdown is rendered. If you're still seeing a vulnerability try clearing your cache and if it's still there please do let us know right away so we can look into again. Thanks for your help!","automated_response":false,"created_at":"2017-04-07T01:52:01.369Z","updated_at":"2017-04-07T01:52:01.369Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1588595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e If you're still seeing a vulnerability try clearing your cache and if it's still there please do let us know right away so we can look into again.\n\nI am speaking about GitLab.com itself, and it looks like someone has to clear the cache on your side.\nAlso, the migration from 9.0.3 to 9.0.4 should have cleared the markdown cache for security reasons.\n\nIf anyone has exploited this vulnerability in the past on GitLab.com — their malicious code is still active.\nMoreover, if anyone has exploited the vulnerability in the past on some other domain — updating to 9.0.4 does not solve that for the user by itself without clearing the cache, and that (clearing the markdown cache) probably should have been done automatically.\n\nDemo (I made that public now): https://gitlab.com/ChALkeR/my-private-test-project/issues/2","automated_response":false,"created_at":"2017-04-07T05:59:36.793Z","updated_at":"2017-04-07T06:05:57.687Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1589802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, you're right. The cache used to be cleared with every release but that was recently changed for performance reasons. I've asked our production team to clear the cache. In the meantime I re-saved your PoC issue to reset the cache so you can verify it's no longer vulnerable. Thanks for the extra effort.","automated_response":false,"created_at":"2017-04-07T17:58:16.583Z","updated_at":"2017-04-07T17:58:16.583Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1589909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e  I've asked our production team to clear the cache. \n\nAnd what about all the other servers with GitLab installed on them?\n\n\u003e I've asked our production team to clear the cache.\n\nJust checked — that hasn't been done yet.\n\n\u003e In the meantime I re-saved your PoC issue to reset the cache so you can verify it's no longer vulnerable.\n\nThanks. My PoC was not the one I was worried about, though (I already verified that the issue is not reproduceable anymore on new comments), my concern here is about someone else posting actual malicious code before the update to 9.0.4 was made, on GitLab.com or on any server where GitLab is installed — that is not solved by update to 9.0.4.","automated_response":false,"created_at":"2017-04-07T18:43:56.675Z","updated_at":"2017-04-07T18:43:56.675Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1609277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@briann I believe that fixes for the unsanitized `class` attribute landed to every other project that I had in mind.\n\nThis is now disclosed at https://github.com/ChALkeR/notes/blob/master/Improper-markup-sanitization.md, including mentioning other projects.\n\nI am ok with making this specific thread on HackerOne public (i.e., disclosing it) at any time, starting from now.\n\nThanks!","automated_response":false,"created_at":"2017-04-13T09:32:58.506Z","updated_at":"2017-04-13T09:32:58.506Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1609735,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Disclosed!","automated_response":false,"created_at":"2017-04-13T14:46:15.431Z","updated_at":"2017-04-13T14:46:15.431Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1609828,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[Noted!](https://github.com/ChALkeR/notes/blob/master/Improper-markup-sanitization.md#gitlab) ;-)\n\n@briann, @rspeicher, thanks again for taking care of this.\n\nMinor note, though: the Markdown cache on GitLab.com doesn't seem to be cleared yet.","automated_response":false,"created_at":"2017-04-13T15:23:19.894Z","updated_at":"2017-04-13T15:23:19.894Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1609851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chalker,\n\nA task to clear the Markdown cache was run April 8th. Would you mind sending me a link to the issue that hasn't been reset? If you can do that privately here that would be great, otherwise please send it to security@gitlab.com. Thanks!\n\nhttps://gitlab.com/gitlab-com/infrastructure/issues/1571\n","automated_response":false,"created_at":"2017-04-13T15:34:32.649Z","updated_at":"2017-04-13T15:34:32.649Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1609871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@briann I sent an email =).","automated_response":false,"created_at":"2017-04-13T15:41:32.244Z","updated_at":"2017-04-13T15:41:32.244Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}