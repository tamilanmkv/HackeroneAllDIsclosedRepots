{"id":230435,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzA0MzU=","url":"https://hackerone.com/reports/230435","title":"DOM Based XSS In mercantile.wordpress.org","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-05-21T10:15:00.019Z","submitted_at":"2017-05-21T10:15:00.019Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pabster","url":"/pabster","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-14T05:23:11.631Z","bug_reporter_agreed_on_going_public_at":"2017-06-14T05:23:11.537Z","team_member_agreed_on_going_public_at":"2017-06-14T04:58:25.612Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nThere is a DOM XSS in mercantile.wordpress.org in the apparel subcat.\nFor example: https://mercantile.wordpress.org/product-category/apparel/?subcat=\u003chtml payload\u003e\n\nSteps To Reproduce\n1. Go to https://mercantile.wordpress.org\n2. Click on apparel\n3. In the url bar add :  /?subcat=\"\u003e\u003cimg src=x onerror=alert(document.domain)\u003e\nThe domain will pop-up.\n\nOr alternatively just click on the link to: https://mercantile.wordpress.org/product-category/apparel/?subcat=%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E\n\nHope this helps.\nSincerely,\nPablo","bounty_amount":"275.0","formatted_bounty":"$275","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-14T04:58:25.703Z","allow_singular_disclosure_after":-133953106.40762644,"singular_disclosure_allowed":true,"vote_count":21,"voters":["abze","bl4de","fillawful","powerjacobb1","gamliel","eveeez","r3y","apapedulimu","grampae","jose_carlos_exposito","and 11 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1693073,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi, thanks for the report, unfortunately it's already been sent in by several other researchers.","automated_response":false,"created_at":"2017-05-22T21:06:54.097Z","updated_at":"2017-05-22T21:06:54.097Z","original_report_id":230234,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1693778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, thanks for responding so quickly. I am not sure it is the same vulnerability since the endpoint does not appear to be the same, #230234 inserts the payload in the search endpoint, while mine inserts it in the subcat parameter in the apparel site. In fact, his payload \"{{constructor.constructor('alert(document.domain)')()}}\" does not execute JS in https://mercantile.wordpress.org/product-category/apparel/?subcat={{constructor.constructor('alert(document.domain)')()}} .\nI believe them to be different reports. Could you please review this @iandunn .\nThe subcat vulnerability gets rendered as HTML by the DOM, while his payload gets rendered as AngularJS in his report, which are different reports.","automated_response":false,"created_at":"2017-05-23T05:34:28.480Z","updated_at":"2017-05-23T05:37:01.266Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1696193,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Ah, you're right, sorry I missed that.","automated_response":false,"created_at":"2017-05-23T21:08:28.617Z","updated_at":"2017-05-23T21:08:28.617Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1696194,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-05-23T21:08:36.067Z","updated_at":"2017-05-23T21:08:36.067Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1696925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem. thanks for triaging!","automated_response":false,"created_at":"2017-05-24T05:23:13.413Z","updated_at":"2017-05-24T05:23:13.413Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1701491,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, just wanted to give you an update.\n\nWe've deployed some partial fixes already, but we're still in the process of refining some of the them, and doing more testing and hardening.","automated_response":false,"created_at":"2017-05-25T18:29:11.331Z","updated_at":"2017-05-25T18:29:11.331Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1701885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I left the other report since it didn't make much sense for me to be there.\nThanks for the update @iandunn !","automated_response":false,"created_at":"2017-05-25T20:38:57.437Z","updated_at":"2017-05-25T20:44:04.263Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1707929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @iandunn ,\nI believe this XSS doesn't work anymore :)\nGood job!","automated_response":false,"created_at":"2017-05-29T18:45:56.722Z","updated_at":"2017-05-29T18:45:56.722Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1708098,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! I'll let you know once we've finished our tests and any additional fixes we make.","automated_response":false,"created_at":"2017-05-29T20:20:09.940Z","updated_at":"2017-05-29T20:20:09.940Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1710649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems cool @iandunn !","automated_response":false,"created_at":"2017-05-30T18:20:53.722Z","updated_at":"2017-05-30T18:20:53.722Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1728424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates @iandunn ?","automated_response":false,"created_at":"2017-06-03T21:17:39.652Z","updated_at":"2017-06-03T21:17:39.652Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1728442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not yet, sorry. It's taking us longer than we expected to go through everything. I'm hoping we'll be done sometime next week, but I can't guarantee that.","automated_response":false,"created_at":"2017-06-03T21:51:25.578Z","updated_at":"2017-06-03T21:51:25.578Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1728864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, no problem take your time guys :)","automated_response":false,"created_at":"2017-06-04T11:18:08.480Z","updated_at":"2017-06-04T11:18:08.480Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1754441,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I think this is resolved now. Thanks for your patience.\n\nI'll request disclosure. We have a backlog of bounties to determine and award, but this in the queue now.","automated_response":false,"created_at":"2017-06-14T04:58:03.009Z","updated_at":"2017-06-14T04:58:03.009Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pabster","url":"/pabster"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1754442,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-06-14T04:58:25.636Z","updated_at":"2017-06-14T04:58:25.636Z","first_to_agree":true,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1754460,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you for fixing @iandunn :)","automated_response":false,"created_at":"2017-06-14T05:23:11.563Z","updated_at":"2017-06-14T05:23:11.563Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1754461,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-06-14T05:23:11.651Z","updated_at":"2017-06-14T05:23:11.651Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, bounty @iandunn ?","automated_response":false,"created_at":"2017-08-10T00:18:10.425Z","updated_at":"2017-08-10T00:18:10.425Z","actor":{"username":"pabster","cleared":false,"url":"/pabster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, sorry for the delay, we're behind on awarding bounties. This one is still in our queue, though. I'll follow up on it w/ the team member who handles bounties.","automated_response":false,"created_at":"2017-08-10T06:34:02.103Z","updated_at":"2017-08-10T06:34:02.103Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1932666,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-08-16T06:04:38.306Z","updated_at":"2017-08-16T06:04:38.306Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"bounty_amount":"225.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"pabster","url":"/pabster"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}