{"id":702981,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDI5ODE=","url":"https://hackerone.com/reports/702981","title":"DOM XSS at https://www.thx.com in IE/Edge browser","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-09-27T13:43:41.817Z","submitted_at":"2019-09-27T13:43:41.817Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"enesdexh1","url":"/enesdexh1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/VBwScoKoGD7pDwyCH2KJrHNc/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":32400,"url":"https://hackerone.com/razer","handle":"razer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Razer","twitter_handle":"","website":"http://www.razer.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-11-23T15:59:51.240Z","bug_reporter_agreed_on_going_public_at":"2019-10-24T15:59:45.375Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nI just recently found easy exploitable DOM XSS vulnerability because of https://www.thx.com/assets/plugins/ultimate-social-media-icons/js/custom.js?ver=5.2.3 js file\n\n## Steps To Reproduce:\nFirst i want to say this is vulnerable code\n\n`function sfsi_mobile_wechat_share(url) {\n    if (jQuery('.sfsi_wechat_follow_overlay').length == 0) {\n        jQuery('body').append(\"\u003cdiv class='sfsi_wechat_follow_overlay sfsi_overlay show'\u003e\u003cdiv class='sfsi_inner_display'\u003e\u003ca class='close_btn' href='' onclick=\\\"event.preventDefault();close_overlay(\\'.sfsi_wechat_follow_overlay\\')\\\" \u003eÃ—\u003c/a\u003e\u003cdiv style='width:95%; min-height:80%;background-color:#fff;margin:0 auto;margin:30% auto;padding: 20px 0;'\u003e\u003cdiv style='width:90%;margin: 0 auto;'\u003e\u003cinput type='text' value='\" + window.location.href + \"' style='width:100%;padding:7px 0;text-align:center' /\u003e\u003c/div\u003e\u003cdiv style='width:80%;margin:10px auto 0 auto'\u003e\u003cdiv  class='sfsi_upload_butt_container' \u003e\u003cbutton onclick='sfsi_copy_text_parent_input(event)' class='upload_butt' \u003eCopy\u003c/button\u003e\u003c/div\u003e\u003cdiv class='sfsi_upload_butt_container' \u003e\u003ca href='weixin://' class='upload_butt'\u003eOpen WeChat\u003c/a\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\");`\n\nAs you can see ==window.location.href== is vulnerable for dom xss because there is no encode \n\nFirst go this homepage https://www.thx.com\nThen add #'\u003e\u003cimg src=x onerror=alert(document.domain)\u003e\nLike this \nhttps://www.thx.com/#'\u003e\u003cimg src=x onerror=alert(document.domain)\u003e\n\nBut will not work Chrome and Firefox beucase they have default encode for location.href\nThis will work on Microsoft Edge and IE\n\nAlso I have an picture to show you\n\n## Impact\n\n--Hacker execute malicious code victim's browsers\n--Redirect malicious sites\n--Arbitrary code can be executed on victim's browser","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eI just recently found easy exploitable DOM XSS vulnerability because of \u003ca title=\"https://www.thx.com/assets/plugins/ultimate-social-media-icons/js/custom.js?ver=5.2.3\" href=\"/redirect?url=https%3A%2F%2Fwww.thx.com%2Fassets%2Fplugins%2Fultimate-social-media-icons%2Fjs%2Fcustom.js%3Fver%3D5.2.3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.thx.com/assets/plugins/ultimate-social-media-icons/js/custom.js?ver=5.2.3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e js file\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eFirst i want to say this is vulnerable code\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003efunction sfsi_mobile_wechat_share(url) {\u003cbr\u003e\n    if (jQuery(\u0026#39;.sfsi_wechat_follow_overlay\u0026#39;).length == 0) {\u003cbr\u003e\n        jQuery(\u0026#39;body\u0026#39;).append(\u0026quot;\u0026lt;div class=\u0026#39;sfsi_wechat_follow_overlay sfsi_overlay show\u0026#39;\u0026gt;\u0026lt;div class=\u0026#39;sfsi_inner_display\u0026#39;\u0026gt;\u0026lt;a class=\u0026#39;close_btn\u0026#39; href=\u0026#39;\u0026#39; onclick=\\\u0026quot;event.preventDefault();close_overlay(\\\u0026#39;.sfsi_wechat_follow_overlay\\\u0026#39;)\\\u0026quot; \u0026gt;Ã—\u0026lt;/a\u0026gt;\u0026lt;div style=\u0026#39;width:95%; min-height:80%;background-color:#fff;margin:0 auto;margin:30% auto;padding: 20px 0;\u0026#39;\u0026gt;\u0026lt;div style=\u0026#39;width:90%;margin: 0 auto;\u0026#39;\u0026gt;\u0026lt;input type=\u0026#39;text\u0026#39; value=\u0026#39;\u0026quot; + window.location.href + \u0026quot;\u0026#39; style=\u0026#39;width:100%;padding:7px 0;text-align:center\u0026#39; /\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div style=\u0026#39;width:80%;margin:10px auto 0 auto\u0026#39;\u0026gt;\u0026lt;div  class=\u0026#39;sfsi_upload_butt_container\u0026#39; \u0026gt;\u0026lt;button onclick=\u0026#39;sfsi_copy_text_parent_input(event)\u0026#39; class=\u0026#39;upload_butt\u0026#39; \u0026gt;Copy\u0026lt;/button\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;div class=\u0026#39;sfsi_upload_butt_container\u0026#39; \u0026gt;\u0026lt;a href=\u0026#39;weixin://\u0026#39; class=\u0026#39;upload_butt\u0026#39;\u0026gt;Open WeChat\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/div\u0026gt;\u0026quot;);\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAs you can see \u003cmark\u003ewindow.location.href\u003c/mark\u003e is vulnerable for dom xss because there is no encode \u003c/p\u003e\n\n\u003cp\u003eFirst go this homepage \u003ca title=\"https://www.thx.com\" href=\"/redirect?url=https%3A%2F%2Fwww.thx.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.thx.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThen add #\u0026#39;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\u003cbr\u003e\nLike this \u003cbr\u003e\n\u003ca title=\"https://www.thx.com/#\u0026#39;%3E\" href=\"/redirect?url=https%3A%2F%2Fwww.thx.com%2F%23%27%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.thx.com/#\u0026#39;%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eBut will not work Chrome and Firefox beucase they have default encode for location.href\u003cbr\u003e\nThis will work on Microsoft Edge and IE\u003c/p\u003e\n\n\u003cp\u003eAlso I have an picture to show you\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e--Hacker execute malicious code victim\u0026#39;s browsers\u003cbr\u003e\n--Redirect malicious sites\u003cbr\u003e\n--Arbitrary code can be executed on victim\u0026#39;s browser\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":593497,"file_name":"DOM_XSS.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sTpvkNxUbABSEqSNmkHsDMuV?response-content-disposition=attachment%3B%20filename%3D%22DOM_XSS.PNG%22%3B%20filename%2A%3DUTF-8%27%27DOM_XSS.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063949Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=c52af5c75a0094333d544d3a2c6ad9affbbfcb59470976c11930e4b242343e62","file_size":28668,"type":"image/png"}],"allow_singular_disclosure_at":"2019-11-23T15:59:45.456Z","allow_singular_disclosure_after":-34699204.044412255,"singular_disclosure_allowed":true,"vote_count":102,"voters":["physuru","lowtoe","m4v3r1ck-","mashoud1122","wisp","base_64","sameerphad72","dhakal_ananda","mygf","aporlorxl23","and 92 more..."],"severity":{"rating":"medium","score":4.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":37647,"asset_type":"OTHER","asset_identifier":"Razer web properties NOT in Group 1 (as listed)","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5910599,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-28T11:12:37.767Z","updated_at":"2019-09-28T11:12:37.767Z","additional_data":{"old_severity":"High","new_severity":"Medium (4.2)","old_severity_id":525908,"new_severity_id":526469},"actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5910601,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-28T11:13:33.972Z","updated_at":"2019-09-28T11:13:33.972Z","additional_data":{"old_title":"DOM XSS On Homepage Of THX.COM But Affects Microsoft Edge and Internet Explorer","new_title":"DOM XSS at https://www.thx.com in IE/Edge browser"},"actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5910602,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission @enesdexh1,\n\nThis appears to be a valid finding. The information you have provided here will be forwarded onto the team. You will receive updates when, and if, there will be any to share. Please note that the status and severity are subject to change.\n\nCheers, \n@chessmast3r  ","markdown_message":"\u003cp\u003eThank you for your submission \u003ca href=\"/enesdexh1\"\u003e@enesdexh1\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis appears to be a valid finding. The information you have provided here will be forwarded onto the team. You will receive updates when, and if, there will be any to share. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eCheers, \u003cbr\u003e\n\u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-28T11:13:47.239Z","updated_at":"2019-09-28T11:13:47.239Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5965165,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-05T10:47:10.387Z","updated_at":"2019-10-05T10:47:10.387Z","additional_data":{"duplicate_report_id":707389},"actor":{"username":"smalien","cleared":false,"url":"/smalien","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5975299,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-07T10:29:45.247Z","updated_at":"2019-10-07T10:29:45.247Z","actor":{"url":"/razer","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Razer"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"razer","collaborator":{"username":"enesdexh1","url":"/enesdexh1"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6126074,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @enesdexh1,\n\nThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \n\nThanks! \n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/enesdexh1\"\u003e@enesdexh1\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-24T14:29:36.010Z","updated_at":"2019-10-24T14:29:36.010Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"enesdexh1","url":"/enesdexh1"},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6127180,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclosure If possible? @razer @chessmast3r ","markdown_message":"\u003cp\u003eCan we disclosure If possible? \u003ca href=\"/razer\"\u003e@razer\u003c/a\u003e \u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-24T15:59:45.394Z","updated_at":"2019-10-24T15:59:45.394Z","first_to_agree":true,"actor":{"username":"enesdexh1","cleared":false,"url":"/enesdexh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VBwScoKoGD7pDwyCH2KJrHNc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6386454,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-23T15:59:51.260Z","updated_at":"2019-11-23T15:59:51.260Z","actor":{"url":"/razer","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Razer"}},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}