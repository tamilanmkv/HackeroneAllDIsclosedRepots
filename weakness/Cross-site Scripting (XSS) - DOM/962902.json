{"id":962902,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjI5MDI=","url":"https://hackerone.com/reports/962902","title":"Session Hijack via Self-XSS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-08-20T03:22:36.914Z","submitted_at":"2020-08-20T03:22:37.033Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jcardona","url":"/jcardona","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8292"],"singular_disclosure_disabled":false,"disclosed_at":"2021-01-17T16:51:18.491Z","bug_reporter_agreed_on_going_public_at":"2020-12-18T16:51:17.909Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** It's possible to hijack a session by tricking the user to perform a Self-XSS on the drag and drop functionality in the chat.\n\n**Description:** Self-XSS is an underrated vulnerability that can have a harmful impact on the users of the application like here, after we get access to the user's session we can read chats, change (some) info and lock the account by activating the 2FA.  \n\n## Releases Affected:\n\n  * Tested on 3.5.2 and 3.5.3 (current version)\n\n## Steps To Reproduce:\n\n  1. Serve the image (payload) using Python's HTTP server.\n  1. Trick the user to drag and drop the image inside a chat.\n  1. Get the **Meteor.loginToken** from the server logs.\n  1. Open that instance of Rocket Chat in a browser.\n  1. Add the **Meteor.loginToken** as an item in the local storage.\n  1. The site automatically redirects to the session.\n  1. Profit!\n\n## Supporting Material/References:\n\n  * GIF file explaining the PoC.\n  * HTML file with the payload.\n\n## Suggested mitigation\n\n  * Sanitize the drag and drop functionality of chat text box striping the tags.\n\n## Impact\n\nThe attacker can gain access to the user session and read chats, change (some) info and lock the account by activating the Two-Factor Authentication, even alter the server configuration depending on the account privileges.","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-01-17T16:51:18.059Z","allow_singular_disclosure_after":-23064887.10513108,"singular_disclosure_allowed":true,"vote_count":11,"voters":["prophet","ali","0nlymohammed","h4x0r_dz","88shturman88","secureroot","kali_linux_1337_pixel_gamer_yt","melthecybertechy","louismonday","transquinnzel","and 1 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8991130,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jcardona \n\nthank you for your report. Interesting attack style... we will think on how to mitigate that.\nIÂ´ll keep you posted here. If you have any additional information, please feel free to share.\n\nBest\nMarkus","automated_response":false,"created_at":"2020-08-20T16:12:12.695Z","updated_at":"2020-08-20T16:12:12.695Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9691450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat, got any news on this one? I really want to post the write-up on a personal blog that I'm building.\n\n","automated_response":false,"created_at":"2020-10-31T13:52:52.583Z","updated_at":"2020-10-31T13:52:52.583Z","actor":{"username":"jcardona","cleared":false,"url":"/jcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9697983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jcardona \n\napologies for the silence. We are still working on it. If you could give us a bit more time, that would help us implement a proper fix. And since you are the only one currently who reported it, you dont have to worry that someone else will take the credits from you. Thank you for your patience.\n\nBest\nMarkus","automated_response":false,"created_at":"2020-11-01T23:54:09.088Z","updated_at":"2020-11-01T23:54:09.088Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9835192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jcardona \n\ni just wanted to let you know that we are still working on it and our initial idea to fix it turned out not to be sufficient. So we are still working on it, and hoping to have a fix soon.\n\nBest\nMarkus","automated_response":false,"created_at":"2020-11-16T17:33:49.105Z","updated_at":"2020-11-16T17:33:49.105Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9854840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat, thank you very much for the update if there is something I can help with, don't hesitate to ask me.","automated_response":false,"created_at":"2020-11-18T12:16:36.506Z","updated_at":"2020-11-18T12:16:36.506Z","actor":{"username":"jcardona","cleared":false,"url":"/jcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10133195,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jcardona \n\nthanks again for your report. We included a fix in the latest release. Please apologize the delay in me notifying you, I was ooo.\nhttps://github.com/RocketChat/Rocket.Chat/pull/19593","automated_response":false,"created_at":"2020-12-17T14:19:58.986Z","updated_at":"2020-12-17T14:19:58.986Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jcardona","url":"/jcardona"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10145744,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @markus-rocketchat, I would like to disclose this report since it has already been resolved, PD: I would love to appear on your HoF, the details are on my profile.","automated_response":false,"created_at":"2020-12-18T16:51:17.927Z","updated_at":"2020-12-18T16:51:17.927Z","first_to_agree":true,"actor":{"username":"jcardona","cleared":false,"url":"/jcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10244975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jcardona \nI have added you to our White Hat Hall of Fame. https://docs.rocket.chat/contributors/contributing/security#whitehat-hall-of-fame\n\nI also requested a CVE-ID for this report, which will be associated with it. ","automated_response":false,"created_at":"2020-12-31T15:52:14.787Z","updated_at":"2020-12-31T15:52:14.787Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10394357,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-17T16:51:18.572Z","updated_at":"2021-01-17T16:51:18.572Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}