{"id":126906,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjY5MDY=","url":"https://hackerone.com/reports/126906","title":"Stored XSS in archive.uber.com Due to Injection of Javascript:alert(0)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-30T14:26:17.893Z","submitted_at":"2016-03-30T14:26:17.893Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-09T22:31:09.417Z","bug_reporter_agreed_on_going_public_at":"2016-04-28T00:46:22.931Z","team_member_agreed_on_going_public_at":"2016-05-09T22:31:09.190Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"archive.uber.com is vulnerable to an XSS due to injection of Javascript:alert(0) as the ```download_url``` or the ```home_page``` in the ```setup.py``` when generating the ```.tar.gz```. As of [PEP 0470](https://www.python.org/dev/peps/pep-0470/), the ```download_url``` and ```home_page``` parameters are depreciated. \n\nAn example of a setup.py that can exploit this is: \n\n``` python\nfrom distutils.core import setup\n\nsetup(\n    name='IgnoreMe_mime',\n    version='1.0.2',\n    author='David Dworken',\n    author_email='david@daviddworken.com',\n    packages=['IgnoreMe_mime'],\n    home_page='Javascript: alert(0)',\n    download_url='Javascript: alert(0)',\n    url='http://pypi.python.org/pypi/IgnoreMe_mime/',\n    license='LICENSE.txt',\n    description='XSS!',\n    long_description=open('README.rst').read(),\n    scripts=['uberPip/nothing.py'],\n)\n```\n\nAs with #126197, my PoC will be active once you run the mirror process to update archive.uber.com from pypi. Conveniently enough,, it looks like this was historically exploited on pypi, so a PoC (not mine) is already hosted on archive.uber.com here: \n\n```\nhttp://archive.uber.com/pypi/simple/ignore-me-1.0/\n```\n\nIn order to see the alert(0) box you have to click on the link titled ```1 home_page```. This will work in all browsers as it is a persistent XSS rather than a reflected one. \n\nThis XSS was inadvertently fixed by [PEP 0470](https://www.python.org/dev/peps/pep-0470/) which removed the ```download_url``` and ```home_page``` parameters. In order to fix this, all you have to do is upgrade the software you use to host the mirror since this was fixed upstream. \n\nThanks,\nDavid Dworken","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-28T00:46:23.013Z","allow_singular_disclosure_after":-169562970.25611758,"singular_disclosure_allowed":true,"vote_count":5,"voters":["michiel","jens","mogyhacker","martijn","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":878619,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report! I triaged things to the related team so they can investigate further. We will keep you updated.","automated_response":false,"created_at":"2016-03-30T19:14:52.961Z","updated_at":"2016-03-30T19:14:52.961Z","actor":{"username":"zacmuber","cleared":false,"url":"/zacmuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/637/8ae1b2449b13a6b336fb1e84fed117006320998f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Thank you very much. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-03-30T19:21:54.651Z","updated_at":"2016-03-30T19:21:54.651Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":892275,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm this is fixed?","automated_response":false,"created_at":"2016-04-06T17:11:41.389Z","updated_at":"2016-04-06T17:11:41.389Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":892328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I cannot. I just checked the example link I sent in and it still works. My guess is you probably fixed it on the backend so no more javascript can be uploaded, but you also have to go through and remove any that were already uploaded. \n\nJust scan for links starting with ```Javascript:``` and remove those. \n\nThanks, \nDavid Dworken ","automated_response":false,"created_at":"2016-04-06T17:52:18.304Z","updated_at":"2016-04-06T17:52:18.304Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ddworken we are still working on this and are getting close to getting this resolved. Just wanted to give you an update!","automated_response":false,"created_at":"2016-04-12T23:40:25.355Z","updated_at":"2016-04-12T23:40:25.355Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902596,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Thank you very much for the update. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-04-12T23:42:26.979Z","updated_at":"2016-04-12T23:42:26.979Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":931086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ddworken think we finally got everything cleaned up. Can you confirm? Thanks again.","automated_response":false,"created_at":"2016-04-27T22:44:57.084Z","updated_at":"2016-04-27T22:44:57.084Z","actor":{"username":"zacmuber","cleared":false,"url":"/zacmuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/637/8ae1b2449b13a6b336fb1e84fed117006320998f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":931091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yup, I can confirm that this has now been fixed. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-04-27T22:47:14.077Z","updated_at":"2016-04-27T22:47:14.077Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":931201,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-04-28T00:43:50.130Z","updated_at":"2016-04-28T00:43:50.130Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ddworken","url":"/ddworken"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":931203,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-28T00:46:22.972Z","updated_at":"2016-04-28T00:46:22.972Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937543,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @ddworken we are paying the max bounty (3K) due to us not being clear that this was a max bounty amount at the time you submitted this. Future reports may be rewarded less depending on levels of user interaction and other mitigating factors.","automated_response":false,"created_at":"2016-05-02T22:36:46.029Z","updated_at":"2016-05-02T22:36:46.029Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"ddworken","url":"/ddworken"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Thank you very much. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-05-03T01:18:48.821Z","updated_at":"2016-05-03T01:18:48.821Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947960,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the report @ddworken! Publicly disclosing this now.","automated_response":false,"created_at":"2016-05-09T22:31:09.339Z","updated_at":"2016-05-09T22:31:09.339Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947961,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-05-09T22:31:09.569Z","updated_at":"2016-05-09T22:31:09.569Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":1902,"category":"researcher","content":"Injection of `Javascript:alert(0)` into the `download_url` or the `home_page` parameters of python packages caused injection of `\u003ca href=Javascript:alert(0)\u003e` into archive.uber.com which is a mirror of pypi. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":17344,"username":"ddworken","name":"David Dworken","bio":"Security Engineer -- keybase.io/dworken","cleared":true,"website":"https://daviddworken.com","location":"Seattle, WA","created_at":"2015-02-09T18:16:44.568Z","url":"https://hackerone.com/ddworken","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}