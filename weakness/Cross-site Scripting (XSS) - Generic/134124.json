{"id":134124,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzQxMjQ=","url":"https://hackerone.com/reports/134124","title":"Stored self-XSS at m.uber.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-23T22:24:12.693Z","submitted_at":"2016-04-23T22:24:12.693Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-08T23:28:11.320Z","bug_reporter_agreed_on_going_public_at":"2016-06-08T23:28:03.975Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is a stored self-XSS vulnerability at m.uber.com in displaying the uber invite code. If the user sets the invite code at `\u003cscript\u003ealert(document.domain)\u003c/script\u003e` value using the main personal area at the uber.com and then signs into the m.uber.com the XSS is fired.\n\nPossible other user exploitation case can be the following:\nThe attacker sends messages to everyone with text:\n\n```\nI have worked at Uber and I know the secret invite code using by employees \nso invite friends using it gets you a $10000 discount for every invited friend. \nSet your invite code to this value:\nEMPLOYEE_2016_04_oidkjnfkerjnoidkjnfkerjnoidkjnfkerjnoidkjnfkerjnoidkjnfkerjn\u003cscript\u003eeval(atob('YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='))\u003c/script\u003eoidkjnfkerjnoidkjnfkerjnoidkjnfkerjnoidkjnfkerjnoidkjnfkerjn\n```\nThe unlimited invite code length makes easier to hide a payload inside it. So user will set his invite code to this value and next time he will visit the m.uber.com the XSS will fire.","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":89116,"file_name":"______________2016-04-24___1.19.52.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/089/116/221007971ee8965e108b1a78fe1eb62bfa6e7975/______________2016-04-24___1.19.52.png?response-content-disposition=attachment%3B%20filename%3D%22______________2016-04-24___1.19.52.png%22%3B%20filename%2A%3DUTF-8%27%27______________2016-04-24___1.19.52.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133839Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=844509d9202aea8ca3d1490d7d96568d32da843532fb6e469828f78ebfcaf1d7","file_size":489843,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-08T23:28:04.102Z","allow_singular_disclosure_after":-165939034.90785396,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":925918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The malicious code will store in the user profile forever and XSS fires every time the user signs in his account (at the main page of m.uber.com)","automated_response":false,"created_at":"2016-04-25T10:51:48.947Z","updated_at":"2016-04-25T10:51:48.947Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927147,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, thanks for your report. \n\nWe're having trouble reproducing the findings that you've reported. In our testing, we're not seeing any JavaScript being executed. If you think we've missed something, please let us know and provide us with detailed instructions on how to reproduce the exploit. Any images, or a video, that demonstrates the issue would also help us to evaluate this report. \n\nThanks and good luck in your future bug hunting. \n\n","automated_response":false,"created_at":"2016-04-25T21:16:07.435Z","updated_at":"2016-04-25T21:16:07.435Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927198,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi!\nI have captured the video PoC. It is the private youtube video, you can get access using this link: https://youtu.be/G_9C-GPRSys","automated_response":false,"created_at":"2016-04-25T21:47:02.116Z","updated_at":"2016-04-25T21:47:02.116Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi!\nI have captured the video PoC. It is the private youtube video, you can get access using this link: https://youtu.be/G_9C-GPRSys","automated_response":false,"created_at":"2016-04-25T21:47:15.999Z","updated_at":"2016-04-25T21:47:15.999Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It works at least at the last version of OS X Firefox and at the last version of iOS Safari.\nIt does not work at the last version of OS X Chrome for some reasons, I will check them.","automated_response":false,"created_at":"2016-04-25T21:56:37.990Z","updated_at":"2016-04-25T21:56:37.990Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":927221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is because of the **span** tag payload injects into. Payload like `uber\u003c/span\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e` works also in last version of OS X Chrome and last version of OS X Safari.","automated_response":false,"created_at":"2016-04-25T22:01:36.450Z","updated_at":"2016-04-25T22:02:29.068Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":930852,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! Do you have problems with reproducing the issue still?","automated_response":false,"created_at":"2016-04-27T20:27:13.031Z","updated_at":"2016-04-27T20:27:13.031Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":932704,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans we're confirmed this and should be triaging this shortly. Keep in mind that due to this being a self-XSS it is not in scope for a reward. Thanks!","automated_response":false,"created_at":"2016-04-28T22:06:58.729Z","updated_at":"2016-04-28T22:06:58.729Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937025,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Triaging this now, thanks @skavans - please let us know if you find anything else!","automated_response":false,"created_at":"2016-05-02T18:17:12.803Z","updated_at":"2016-05-02T18:17:12.803Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1001845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans,\n\nThis self-XSS now appears resolved. Can you confirm on your end?","automated_response":false,"created_at":"2016-06-06T20:51:45.576Z","updated_at":"2016-06-06T20:51:45.576Z","actor":{"username":"dnathe4th","cleared":false,"url":"/dnathe4th","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/064/148/cd4147cc3e2922a84021a0f466a83a16ed250f81_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1001958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, the issue is fixed for now.","automated_response":false,"created_at":"2016-06-06T21:40:47.840Z","updated_at":"2016-06-06T21:40:47.840Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1005480,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you @skavans for both the original report and the confirmation of the fix.\n\nHappy hunting!","automated_response":false,"created_at":"2016-06-08T22:19:05.116Z","updated_at":"2016-06-08T22:19:05.116Z","actor":{"username":"dnathe4th","cleared":false,"url":"/dnathe4th","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/064/148/cd4147cc3e2922a84021a0f466a83a16ed250f81_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1005483,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As previously discussed, this issue was a self-xss and was out of scope for a bounty payout.\n\nThank you again for taking the time, and best of luck on the rest of the hunt.","automated_response":false,"created_at":"2016-06-08T22:20:44.509Z","updated_at":"2016-06-08T22:20:44.509Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1005605,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclose?","automated_response":false,"created_at":"2016-06-08T23:28:03.999Z","updated_at":"2016-06-08T23:28:03.999Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1017431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Are there any problems with disclosing this report?","automated_response":false,"created_at":"2016-06-16T15:15:50.346Z","updated_at":"2016-06-16T15:15:50.346Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1060479,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-08T23:28:11.421Z","updated_at":"2016-07-08T23:28:11.421Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}