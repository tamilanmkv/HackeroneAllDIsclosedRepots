{"id":142135,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDIxMzU=","url":"https://hackerone.com/reports/142135","title":"XSS –≤ upload.php","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-30T21:37:27.191Z","submitted_at":"2016-05-30T21:37:27.191Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"irek","url":"/irek","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-09T14:20:44.482Z","bug_reporter_agreed_on_going_public_at":"2017-01-19T16:02:01.515Z","team_member_agreed_on_going_public_at":"2017-02-09T14:20:44.426Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä!\n–†–∞—Å–∫—Ä—É—Ç–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é xss –Ω–∞ upload.php.\n\n**–î–µ–º–æ [—Ç—É—Ç](https://vk.com/app5486273) –∏–ª–∏ [—Ç—É—Ç](https://irek.wtf/vk.com/transport/).**\n\n–ö–∞–∫ –≤—Å–µ –±—ã–ª–æ?\n–£–≤–∏–¥–µ–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —ç–∫—à–Ω [upload.php?act=transport](https://pu.vk.com/c415824/upload.php?act=transport\u0026to_act=add_doc\u0026hash=8dfd93e60c78ddb4a9cf914c27f7642c\u0026rhash=8171a35e59a63aab65846a26345ddbf6\u0026aid=1\u0026mid=17274528\u0026callback=getUploadSvg), –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É–∂–∏—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ—Ñ–∏—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ã. –ì–ª–∞–∑ –∑–∞—Ü–µ–ø–∏–ª—Å—è –∑–∞ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `eval` –≤ —Å—Ç—Ä–æ–∫–µ 25. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä `callback`, –∑–Ω–∞—á–µ–Ω–∏–µ–º –∫–æ—Ç–æ—Ä–æ–≥–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ `getUploadSvg`.  –ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `sendData` (—Å—Ç—Ä–æ–∫–∏ 11-52) –∏, –ø–æ–º–∏–º–æ —ç—Ç–æ–≥–æ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –∫—É—Å–æ–∫ –∫–æ–¥–∞ (—Å—Ç—Ä–æ–∫–∏ 55-64):\n\n    var _ua = navigator.userAgent;\n    var locDomain = location.host.toString().match(/[a-zA-Z]+\\.[a-zA-Z]+\\.?$/)[0];\n    if (/opera/i.test(_ua) || !/msie 6/i.test(_ua) || document.domain != locDomain) {\n      document.domain = locDomain;\n    }\n    if (window.parent) {\n      parent.getUploadSvg(function(data) {\n        sendData('/c415824/upload.php?transport=iframe\u0026act=add_doc\u0026hash=8dfd93e60c78ddb4a9cf914c27f7642c\u0026rhash=8171a35e59a63aab65846a26345ddbf6\u0026aid=1\u0026mid=17274528\u0026pda=', data);\n      });\n    }\n\n, –≥–¥–µ –µ—Å—Ç—å –¥–≤–∞ —É—Å–ª–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ üë≥üèæ. –í –ø–µ—Ä–≤–æ–º –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è `document.domain` –¥–ª—è –∫—Ä–æ—Å—Å–¥–æ–º–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –∞ –≤–æ –≤—Ç–æ—Ä–æ–º –≤—Å–µ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–∫–Ω–∞ `parent.getUploadSvg`, –≥–¥–µ `getUploadSvg` —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `callback` ~~(–∫–∞–∫ —É–∂–µ –±—ã–ª–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ)~~ –∏ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –Ω–∞ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –ø–æ–¥ –ø–∞—Ç—Ç–µ—Ä–Ω `/^[a-zA-Z0-9]*$/`). –¢–æ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `parent.{–∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ callback}` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç, —è–≤–ª—è—é—â–∏–π—Å—è –∞–Ω–æ–Ω–∏–º–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π. –≠—Ç–∞ –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `data`, –∞ –≤ –µ—ë —Ç–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `sendData` (—Å—Ç—Ä–æ–∫–∞ 62):\n\n    sendData('/c415824/upload.php?transport=iframe\u0026act=add_doc\u0026hash=8dfd93e60c78ddb4a9cf914c27f7642c\u0026rhash=8171a35e59a63aab65846a26345ddbf6\u0026aid=1\u0026mid=17274528\u0026pda=', data);\n\n\n–¢—É—Ç –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π URL, –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ø–∞–¥–∞—é—Ç –ø–æ—á—Ç–∏ –≤—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–æ—Ö–æ–¥—è –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é. –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä —ç—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `data`, –æ –∫–æ—Ç–æ—Ä–æ–π –ø–∏—Å–∞–ª —á—É—Ç—å –≤—ã—à–µ.\n\n–†–∞–∑–±–µ—Ä–µ–º —Å–∞–º—É —Ñ—É–Ω–∫—Ü–∏—é `sendData`. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ `url`, `file` –∏ `sequel `. –ü–æ –ø–æ–Ω—è—Ç–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º, –Ω–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ –¥–≤–∞. –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É 16\n\n    var plain = /iphone|ipod|ipad|opera mini|opera mobi/i.test(navigator.userAgent);\n\n–∏ –±–ª–æ–∫ –∫–æ–¥–∞ —É—Å–ª–æ–≤–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤ —Å—Ç—Ä–æ–∫–∞—Ö 29-41\n\n    if (plain) {\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n      if (dataUrl.length \u003e 15000) {\n        fdataUrl = dataUrl.substr(0, 15000);\n        ndataUrl = dataUrl.substr(15000);\n        dataUrl = fdataUrl;\n        more = 1;\n      }\n\n      xhr.send(ajx2q({Data: dataUrl, more: more, sequel: sequel || 0}));\n    } else {\n\n–û—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –º—ã –Ω–∞ —ç—Ç–æ–º –ø–æ—Ç–æ–º—É, —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ 40 –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `ajx2q `, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –∏, –ø–æ—ç—Ç–æ–º—É, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ—Ñ–∏—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —é–∑–µ—Ä–∞–≥–µ–Ω—Ç–æ–≤ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏—é `/iphone|ipod|ipad|opera mini|opera mobi/i`. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏ —Ö–∞–∫ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ï—Å–ª–∏ –Ω–µ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ —Å–µ–π –¥–æ—Å–∞–¥–Ω—ã–π —Ñ–∞–∫—Ç, —Ç–æ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `sendData` —Å –ø–æ–º–æ—â—å—é `XMLHttpRequest` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ URL, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –º–æ–∂–µ–º –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å. –í —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é `eval`, —á—Ç–æ –∫—Ä—É—Ç–æ –µ—Å–ª–∏ –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—ã–¥–∞–≤–∞—Ç—å –Ω—É–∂–Ω—ã–π –Ω–∞–º –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç POST-–∑–∞–ø—Ä–æ—Å. –ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –º–æ–∂–µ–º –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ URL, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –∑–∞–ø—Ä–æ—Å, —è –Ω–∞—á–∞–ª –¥—É–º–∞—Ç—å –Ω–∞–¥ —Ç–µ–º –∫–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å –º–æ–∏–º js-–∫–æ–¥–æ–º. –¢—É—Ç —è –≤—Å–ø–æ–º–Ω–∏–ª –æ —Ç–æ–º, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏ –∫–∞–∫ [imagejs](http://jklmnn.de/imagejs/) –∏ [share.php](https://vk.com/share.php?url=https://irek.wtf/shareit.php). –ü–µ—Ä–≤–æ–µ –Ω–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å—Ç—Ä–æ–∏—Ç—å js-–∫–æ–¥ –ø—Ä—è–º–æ —Ñ–∞–π–ª—ã –∫–∞—Ä—Ç–∏–Ω–æ–∫ (Gif, Bitmap, WebP, Netbpm Anymap, Progressive Graphics) –∏ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –≤–∞–ª–∏–¥–Ω—ã. –ê –≤ share.php –∫–∞–∫-—Ä–∞–∑ –µ—Å—Ç—å –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ([–ø—Ä–∏–º–µ—Ä](https://pu.vk.com/c539421/upload.php?act=proxy_img\u0026url=https%3A%2F%2Firek.wtf%2Fpikachu.gif\u0026hash=f5b4a65619ba2c63a7bb018db018bfce)). –¢—É—Ç —è —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –¥—Ä—É–≥–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π - —Ö—ç—à–∏. –≠—Ç–æ –±—ã–ª–∞ –±–æ–ª—å, –Ω–æ –º–µ—Ç–æ–¥–æ–º —Ç—ã–∫–∞ —è –ø–æ–Ω—è–ª, —á—Ç–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—É `upload_fails.php` –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –¥–æ–±–∞–≤–∏—Ç—å –∫ –Ω–∏–º `role=share`, —Ç–æ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –≤–∞–ª–∏–¥–Ω—ã–µ —Ö—ç—à–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–∫—Ä–∞—Ñ—Ç–∏—Ç—å –∫–æ–Ω–µ—á–Ω—ã–π URL. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ –¥–µ–º–æ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ—á–∫–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –æ–Ω–∏ —Ç–∞–º –Ω–µ —Å–ª—É—á–∞–π–Ω–æ). –û—Å—Ç–∞–ª–æ—Å—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–±–ª–µ–º–æ–π. –ó–∞–∫–ª—é—á–∞–µ—Ç—Å—è –æ–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ `sendData` –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è. –ù–∞–¥–æ –Ω–∞–π—Ç–∏ —Ç–∞–∫—É—é js-—Ñ—É–Ω–∫—Ü–∏—é, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —É—Å–ª–æ–≤–∏—è:\n\n* –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ —Å–∏–º–≤–æ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —á–µ—Ä–µ–∑ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä `callback` –∏ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–π;\n* —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥—Ä—É–≥—É—é callback-—Ñ—É–Ω–∫—Ü–∏—é –∏ –≤—ã–∑–≤–∞—Ç—å –µ—ë –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –æ–±—ä–µ–∫—Ç.\n\n–ù–µ–º–Ω–æ–≥–æ `for (... in window)` –∏ —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –Ω–∞–π–¥–µ–Ω–∞ - `requestAnimationFrame` ([–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://developer.mozilla.org/ru/docs/DOM/window.requestAnimationFrame)).\n\n–î–∞–ª–µ–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¥–µ–º–æ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å [—Ç—É—Ç](https://vk.com/app5486273) –∏–ª–∏ [—Ç—É—Ç](https://irek.wtf/vk.com/transport/). –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `alert(document.cookie);`.\n\n–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–ª—É—á–∏–ª–∏ xss –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤, —Å—Ç—Ä–æ–∫–∞ user-agent –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –ø–æ–¥ –ø–∞—Ç—Ç–µ—Ä–Ω `/iphone|ipod|ipad|opera mini|opera mobi/i` –∏ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `requestAnimationFrame ` (–∏–ª–∏ —Å –≤–µ–Ω–¥–æ—Ä–Ω—ã–º–∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ `mozRequestAnimationFrame`, `webkitRequestAnimationFrame`, `msRequestAnimationFrame`).","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-18T16:02:01.556Z","allow_singular_disclosure_after":-146525956.55233318,"singular_disclosure_allowed":true,"vote_count":38,"voters":["delimitry","bobrov","hunter","suv","bogdantcaciuc","kedrisch-4-t","spam404","s_p_q_r","ali","w2w","and 28 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":992324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"–ö–∞–∫ –æ–∫–∞–∑–∞–ª–æ—Å—å, —É hash –¥–ª—è proxy_img –µ—Å—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è. –°–µ–π—á–∞—Å –æ–±–Ω–æ–≤–∏–ª –µ–≥–æ, —Ç–∫ –∫–∞–∫ —Å–æ –≤—á–µ—Ä–∞—à–Ω–∏–º –ø–µ—Ä–µ—Å—Ç–∞–ª–æ —Ä–∞–±–æ—Ç–∞—Ç—å.  –í–µ—á–µ—Ä–æ–º –ø–æ—Å—Ç–∞–≤–ª—é –Ω–∞ cron –∑–∞–¥–∞—á—É –æ–±–Ω–æ–≤–ª—è—Ç—å –µ–≥–æ –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞. –ê –ø–æ–∫–∞ –Ω–µ —É–¥–∏–≤–ª—è–π—Ç–µ—Å—å –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å","automated_response":false,"created_at":"2016-05-31T13:14:18.774Z","updated_at":"2016-05-31T13:14:18.774Z","actor":{"username":"irek","cleared":false,"url":"/irek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993035,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"–ò—Å–ø—Ä–∞–≤–∏–ª–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.","automated_response":false,"created_at":"2016-05-31T17:16:58.524Z","updated_at":"2016-05-31T17:16:58.524Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"irek","url":"/irek"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993040,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-05-31T17:18:14.363Z","updated_at":"2016-05-31T17:18:14.363Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"irek","url":"/irek"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":993059,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"–î–∞, –ø–æ—Ö–æ–∂–µ, –∏—Å–ø—Ä–∞–≤–∏–ª–∏.","automated_response":false,"created_at":"2016-05-31T17:24:26.305Z","updated_at":"2016-05-31T17:24:26.305Z","actor":{"username":"irek","cleared":false,"url":"/irek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"–û–≥–æ! $1.5k –∑–∞ xss! –ö—Ä—É—Ç–æ! –°–ø–∞—Å–∏–±–æ!","automated_response":false,"created_at":"2016-05-31T17:25:33.272Z","updated_at":"2016-05-31T17:25:33.272Z","actor":{"username":"irek","cleared":false,"url":"/irek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1430405,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"–ù–∏—á–µ–≥–æ –µ—Å–ª–∏ –∑–∞–¥–∏—Å–∫–ª–æ–∑–∏–º?","automated_response":false,"created_at":"2017-01-19T16:02:01.535Z","updated_at":"2017-01-19T16:02:01.535Z","first_to_agree":true,"actor":{"username":"irek","cleared":false,"url":"/irek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"irek, –∫–∞–∫ –¥–∏—Å–∫–ª–æ–∑–∏–º?\n–ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ —Ç–æ–ª—å–∫–æ summary?","automated_response":false,"created_at":"2017-02-09T12:28:24.321Z","updated_at":"2017-02-09T12:28:24.321Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1474429,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"–•–æ—Ç–µ–ª–æ—Å—å –±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é, –µ—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–æ—Ç–∏–≤.","automated_response":false,"created_at":"2017-02-09T13:20:43.633Z","updated_at":"2017-02-09T13:20:43.633Z","actor":{"username":"irek","cleared":false,"url":"/irek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/245/a4b727bea8d748cade6f2cc716348c1b43725754_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-09T14:20:44.452Z","updated_at":"2017-02-09T14:20:44.452Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1474560,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-09T14:20:44.502Z","updated_at":"2017-02-09T14:20:44.502Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}