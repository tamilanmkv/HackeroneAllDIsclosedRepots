{"id":146939,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDY5Mzk=","url":"https://hackerone.com/reports/146939","title":"DOM XSS в /activation.php?act=activate_mobile","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-24T04:12:59.876Z","submitted_at":"2016-06-24T04:12:59.876Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"abr1k0s","url":"/abr1k0s","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-22T21:11:41.578Z","bug_reporter_agreed_on_going_public_at":"2016-08-23T21:11:35.777Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Поинтересовался тут функцией showOrderBox в API. Увидел там \"Тестовое спецпредложение. Тестовое спецпредложение для разработчиков приложений.\"\nПри щелчке по кнопке \"перейти в группу\" попал на страницу /activation.php?act=activate_mobile\u0026hash=мой_хэш\u0026return=%2Foffersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\n\nОбратил внимание на параметр return. Увидел, что значение попадает в вывод страницы, предоставляя возможность осуществить xss атаку.\n\nСформировал следующую ссылку:\n/activation.php?act=activate_mobile\u0026hash=мой_хэш\u0026return=javascript:alert(1);//offersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\n\nПолучил alert при вводе в поле ввода правильного кода из смс.\n\nФрагмент уязвимого кода js: \n    params = {code: code, hash: 'a0096404730f329021'};\n    callback = function(t) {\n      if (t) {\n        cur.phoneValidationMsg(t);\n        return stop();\n      }\n      document.location = winToUtf('javascript:alert(1);//offersdesk?act=start_offer\u0026amp;offer_id=1237\u0026amp;hash=17634e2103b0a99782\u0026amp;aid=4846993\u0026amp;app_currency=0\u0026amp;from=');\n    }","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-22T21:11:35.826Z","allow_singular_disclosure_after":-159381098.98052356,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mdv","kunal94","jens","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1037314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Скриншоты","automated_response":false,"created_at":"2016-06-25T21:33:45.730Z","updated_at":"2016-06-25T21:33:45.730Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":101647,"filename":"xss_phone_sms.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/101/647/27475225e4a26da9c3bc32883df84a50869a84d1/xss_phone_sms.jpg?response-content-disposition=attachment%3B%20filename%3D%22xss_phone_sms.jpg%22%3B%20filename%2A%3DUTF-8%27%27xss_phone_sms.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRIN5EFBE%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134314Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIBhBo9%2BUqNxY%2Bdl%2FBu6j6mVjFeVGWlX5BwuNk30B2pI7AiBQHUUbG%2FDPlDr8hIO32FMCMyDmnYxvDdVBvosTOZwinyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM8sXPkJOx9vMC77IEKtcDIV9fcoJlSEMqzyGBN8r5cvnWs1RDUOFGGZvMSBD3mEA7oDpMSi%2BV7Zp9cOht07PFLX%2BkJK8eC1UTkCn542dx8VJGQsKAyVMnUijrNudvAtZaz4XmN54QO8IAmSWJAz1M4dpRjKM3mpj%2FRtGlWd3KN52y5erIqbsZL2gDnrA%2FRb3fgap6IHD7xfj6d0gbxTW4t4%2FdNxTbdiUOs%2BzGzj%2FLTVG1Y2pAFSOg%2FtQWuve8SbkTy352fvT3gWDrJKVFK4FnKn4DMECasTJgeWjjC5%2FMBxmNQ4Ck1dV%2Bd2U1r3%2FXszmBUhzCVAnW%2BBtuglfqKxlek0HFP2W%2FAgf7HsdcRXu4XQ9grbRgh1ZNM9yCRee%2FQ8AoIWmoCQS%2BbBfiZfI9t95HA%2Fnu0iExODE3gc%2FeDNILImEbUu8YNyftwi4u%2BBTFJzhLm45mJqK2nq8%2F1P%2BZ%2FjDCVTu7n6SR3CDOMKZAj5KEc2HF25gj0XTKyS4MKzzEI3%2B1%2BX1BRUu%2Ft%2Foofn%2BCL69KENTohq5xEcSjfjHYy%2FruEuKnSzzB2Olo0%2Fch%2Bgu9EjjuR5sCj5hDvticB%2BiLsNWB0Sjpt4T5BO2Gz9yWZ5R7UDjFjBikyO0qI3cmEMuMQ9c4%2Bi%2BthNSEMOrskIsGOqYBSW5YtERPJhE422%2BOJ%2FODVERL3856%2BJxv6Gylf0pw9PAOnyl%2FoQCO3GPLC6BDKKKCT0DANAMHRViXtizwdYWxIVcxRRpAFRuplthRNuoekn7M%2BD9Vyq2Ves6bm56gWv49amyryPOpp3Kpzb30DAEAyzl0ZK%2BqfWyDzq5HLSIy5lGtjLObsOuLdF%2BYMEHir%2BrCGGp%2FmWPemSN9vmdtiNbqa6zyiUuPDw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0d7ac4b748ad701a50b2e56621de5ae1ae1b58e9b4435b92464ec34dc1195dd5"},{"id":101646,"filename":"xss_phone_sms2.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/101/646/ad4f938a8430ef646c2055391a3b930f2d96426b/xss_phone_sms2.jpg?response-content-disposition=attachment%3B%20filename%3D%22xss_phone_sms2.jpg%22%3B%20filename%2A%3DUTF-8%27%27xss_phone_sms2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRIN5EFBE%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134314Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIBhBo9%2BUqNxY%2Bdl%2FBu6j6mVjFeVGWlX5BwuNk30B2pI7AiBQHUUbG%2FDPlDr8hIO32FMCMyDmnYxvDdVBvosTOZwinyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM8sXPkJOx9vMC77IEKtcDIV9fcoJlSEMqzyGBN8r5cvnWs1RDUOFGGZvMSBD3mEA7oDpMSi%2BV7Zp9cOht07PFLX%2BkJK8eC1UTkCn542dx8VJGQsKAyVMnUijrNudvAtZaz4XmN54QO8IAmSWJAz1M4dpRjKM3mpj%2FRtGlWd3KN52y5erIqbsZL2gDnrA%2FRb3fgap6IHD7xfj6d0gbxTW4t4%2FdNxTbdiUOs%2BzGzj%2FLTVG1Y2pAFSOg%2FtQWuve8SbkTy352fvT3gWDrJKVFK4FnKn4DMECasTJgeWjjC5%2FMBxmNQ4Ck1dV%2Bd2U1r3%2FXszmBUhzCVAnW%2BBtuglfqKxlek0HFP2W%2FAgf7HsdcRXu4XQ9grbRgh1ZNM9yCRee%2FQ8AoIWmoCQS%2BbBfiZfI9t95HA%2Fnu0iExODE3gc%2FeDNILImEbUu8YNyftwi4u%2BBTFJzhLm45mJqK2nq8%2F1P%2BZ%2FjDCVTu7n6SR3CDOMKZAj5KEc2HF25gj0XTKyS4MKzzEI3%2B1%2BX1BRUu%2Ft%2Foofn%2BCL69KENTohq5xEcSjfjHYy%2FruEuKnSzzB2Olo0%2Fch%2Bgu9EjjuR5sCj5hDvticB%2BiLsNWB0Sjpt4T5BO2Gz9yWZ5R7UDjFjBikyO0qI3cmEMuMQ9c4%2Bi%2BthNSEMOrskIsGOqYBSW5YtERPJhE422%2BOJ%2FODVERL3856%2BJxv6Gylf0pw9PAOnyl%2FoQCO3GPLC6BDKKKCT0DANAMHRViXtizwdYWxIVcxRRpAFRuplthRNuoekn7M%2BD9Vyq2Ves6bm56gWv49amyryPOpp3Kpzb30DAEAyzl0ZK%2BqfWyDzq5HLSIy5lGtjLObsOuLdF%2BYMEHir%2BrCGGp%2FmWPemSN9vmdtiNbqa6zyiUuPDw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=91142da3d3d89efeeb8be80a956e7b280451b89a9f098f66d5e6777807b230b3"}],"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041912,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Здравствуйте! \n\nСпасибо за репорт. Мы его исследуем и сообщим Вам о результатах.","automated_response":false,"created_at":"2016-06-27T22:53:01.131Z","updated_at":"2016-06-27T22:53:01.131Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый день. Есть какие-нибудь новости по баге?","automated_response":false,"created_at":"2016-07-12T16:36:14.856Z","updated_at":"2016-07-12T16:36:14.856Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073787,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Починили, проверьте, пожалуйста.","automated_response":false,"created_at":"2016-07-18T13:35:59.005Z","updated_at":"2016-07-18T13:35:59.005Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"abr1k0s","url":"/abr1k0s"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1078131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"На данный момент я больше не могу воспроизвести уязвимость. Все ок.","automated_response":false,"created_at":"2016-07-20T14:58:10.439Z","updated_at":"2016-07-20T14:58:10.439Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1150262,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Спасибо за репорт, но это self-xss.","automated_response":false,"created_at":"2016-08-23T21:08:53.684Z","updated_at":"2016-08-23T21:08:53.684Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1150272,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-23T21:11:35.803Z","updated_at":"2016-08-23T21:11:35.803Z","first_to_agree":true,"actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1211642,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-22T21:11:41.664Z","updated_at":"2016-09-22T21:11:41.664Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}