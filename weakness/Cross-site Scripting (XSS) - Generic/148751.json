{"id":148751,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg3NTE=","url":"https://hackerone.com/reports/148751","title":"Stored XSS in comments","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T20:48:22.410Z","submitted_at":"2016-07-01T20:48:22.410Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kelunik","url":"/kelunik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-01T22:18:55.990Z","bug_reporter_agreed_on_going_public_at":"2016-07-01T22:18:55.918Z","team_member_agreed_on_going_public_at":"2016-07-01T22:16:23.865Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Comments can contain an author's website. This website is used in the href attribute of link elements and isn't filtered. Thus it allows URLs like `javascript:alert(1)` to be used. These URLs must be filtered by protocol, e.g. only allow http and https.\n\nThese attacks are blocked by the default CSP, but clients not supporting CSP or changed CSPs may be affected.\n\nThis issue affects [Airship](https://github.com/paragonie/airship) Version 1.1.2 and lower.","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102860,"file_name":"Airship_Stored_Comment_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/860/3926829deb47cf05da993fb27411f85bdda292fc/Airship_Stored_Comment_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Airship_Stored_Comment_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Airship_Stored_Comment_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY5I5ZOTN%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134346Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQCqf43kV8RTzzmWR1TXeEdpx%2Fd5zGOFNpfZDgSM2xJuCQIhAMLYAxjZR7PGO9btJ9wGFbOqf%2FTbE2pC%2FdkQgyPDWZD8KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzmKazqBIClFAMqc2Iq1wNPV39BSW59qP%2ByHsmBjxY6m%2Fb7a6U5448PKOSe8dVf6ZB9c%2BLac%2F0Gz8ADXdDYKsvWZv%2FAmBj5%2FhHzWjVphb45t9jx%2BhpJI0AITzRmRN5aq7TLFOZDfehY6xr7qR34eKZAu9XJrbi4QdAu%2BNSUgERhmM4muMj19K4msZk8sFVbAKLF%2BU6gGnywSDktUJmbSxfnY6ZesCS5elWm1qPvYsKCbrl5y57ovXEaa7NAn6XfLDrVTRtpY8qRzPQbURfe%2FnNfBCEGQCwCuB8zQszv%2B2O4z6L6fFCLSm2gccXmLLJqlgBN7EwqRjH0XLKpn1vWKBfmNtQJMcfcBOgesSBjohFRDqs9VtzSm8Ar%2FZ3tQRyj3E5FFBVh7SFXfbH0zIPhcJnR7J%2Ft20n0T0BoFfeC4Lh04EDdGi1xF35UayBRbz0euxaVcKV0UA%2BktOyHmbRzgaonWDeZCOaJtjFZCGnWooRLI6KrYUmAIMrnyQoKS2q8DQKxvweDK7%2FuWfo1ovNRy%2BMy3v8N%2B%2B6q1M2DXNkYeXZoalrKF%2BzGC2C%2FRVd1z2LoHJiVHopIG7T4Lyax%2BX9LY1Z9oVqxPxTo9SgiI1kD69%2Bl5MKWzogETScQuH%2Bvi36SPh1QbdmYvwgw5O6QiwY6pAEabkl2EyHSmga%2FQVBclzYljmd0Pvwag9ITi%2BNlOViZyzeqV8k%2F8Q8ny0OOVtCp3iCSdWDf1LHd%2BqKtTjKS7CIODHKRsg4m3sx7QNZBHT5H00n5U2ZVgN4N9m3YxiNqVHw1I0Jv0KF1%2BS2XFhkFHuxBokXIzihowuz57pmo5yGw3bX16HVqCrlEZdpJDLSrVWPAr55aHcggcNaCjNyYlZGc9VtWCw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=65574d840c81c047248e7254ca3af5930f0745cd89c83b590952c005e4efc8ef","file_size":29371,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-31T22:16:23.937Z","allow_singular_disclosure_after":-163956442.0911492,"singular_disclosure_allowed":true,"vote_count":6,"voters":["michiel","klau5","paragonie-scott","dyabla","rfkrishnan","kelunik"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1049939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not sure how to classify this one. In one regard, it sort of is a \"stored XSS\" because it's stored in the URL and causes Javascript to execute. However, it's also not the sort of thing that pwns the user who lands on the page.\n\nEither way, it ought to be fixed.","automated_response":false,"created_at":"2016-07-01T21:28:41.482Z","updated_at":"2016-07-01T21:28:41.482Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049950,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://github.com/paragonie/airship/commit/4e14bc54ae76ff32f4edb448d5741d99176921f2 should fix it.","automated_response":false,"created_at":"2016-07-01T21:33:08.461Z","updated_at":"2016-07-01T21:33:08.461Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kelunik","url":"/kelunik"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049952,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-07-01T21:34:31.090Z","updated_at":"2016-07-01T21:34:31.090Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Paragon Initiative Enterprises"}},"bounty_amount":"25.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"paragonie","collaborator":{"username":"kelunik","url":"/kelunik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're right, it's not executing immediately at least and is usually blocked by the CSP as well.","automated_response":false,"created_at":"2016-07-01T21:35:40.297Z","updated_at":"2016-07-01T21:35:40.297Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just verified that the same doesn't apply to the Bridge, but it's not a link there, just plain text.","automated_response":false,"created_at":"2016-07-01T21:46:56.998Z","updated_at":"2016-07-01T21:46:56.998Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049999,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-01T22:16:23.889Z","updated_at":"2016-07-01T22:16:23.889Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050004,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-01T22:18:55.944Z","updated_at":"2016-07-01T22:18:55.944Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1050005,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-01T22:18:56.009Z","updated_at":"2016-07-01T22:18:56.009Z","actor":{"username":"kelunik","cleared":false,"url":"/kelunik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/390/cd4f69721a9c608e87a1b4718b6d29581b0ccbe6_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2154,"category":"team","content":"This one was a grey area. One one hand, it's literally stored and it's literally a Javascript payload that a user could accidentally execute. On the other hand, it pushes the envelope of what counts as a vulnerability or not. (We decided to award a bounty as per our stated policy to err on the side of generosity when in doubt.) That being said, there's no real world use-case for a guest to share a non-HTTP(S) URL in their attribution for blog comments.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":51441,"username":"paragonie-scott","name":"Scott Arciszewski","bio":"@CiPHPerCoder on Twitter","cleared":false,"website":"https://paragonie.com/blog/author/scott-arciszewski","location":"Orlando, FL","created_at":"2016-01-17T06:06:42.628Z","url":"https://hackerone.com/paragonie-scott","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcndjIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--48e805bcd9d1c48bfef880bf59cee9b034b26f2f/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/Helper410.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}