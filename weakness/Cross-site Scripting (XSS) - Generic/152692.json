{"id":152692,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI2OTI=","url":"https://hackerone.com/reports/152692","title":"Persistent Cross-Site Scripting in WooCommerce WordPress plugin","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-20T21:40:12.449Z","submitted_at":"2016-07-20T21:40:12.449Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"beurtschipper","url":"/beurtschipper","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-16T19:22:31.176Z","bug_reporter_agreed_on_going_public_at":"2017-10-17T19:22:15.704Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI've discovered a persistent Cross-Site Scripting vulnerability in the WooCommerce. Yesterday I created a support ticket on the website, but today someone told me about the bug bounty program, so here we go. \n\nThe vulnerability was discovered during a month long security project to find vulnerabilities in WordPress plugins. For more information about the project see:\nhttps://sumofpwn.nl\nMy advisory can be found in the attachment in text format. If there are any questions please let me know, I'm happy to help.\n\nWith kind regards,\n\nSipke","bounty_amount":"75.0","formatted_bounty":"$75","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":106245,"file_name":"Persistent_Cross-Site_Scripting_in_WooCommerce.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/106/245/79cd8f9236bc9da02ad2515c7816f5f58a161421/Persistent_Cross-Site_Scripting_in_WooCommerce.txt?response-content-disposition=attachment%3B%20filename%3D%22Persistent_Cross-Site_Scripting_in_WooCommerce.txt%22%3B%20filename%2A%3DUTF-8%27%27Persistent_Cross-Site_Scripting_in_WooCommerce.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTTPJWCNM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134528Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDOwM9%2B2Ol25EbTHv2AOl1ZXwoFCdY81Kf4Cj%2BZw5bGagIhALNw4OtUKzuuJ5JDnXIMoizsmzLoA6B3TMlT4JOm5OV%2FKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBja9Y5H4vqpYK%2BZIq1wMKEFztYF934tg2oiDnz06aS%2BIxaoyblb3k6%2F%2BxBMgQzBtDrU0ocKh0rsBsPTyultSX957Ztb0Xxm%2BlSHqRsjq6d7mkuWsgkJaqQC34P%2FPoowX%2BlH2ZrTK%2FmkJH0GzYvbYPapiuIgj7k6s%2BThAEuj5K1dIvpyoPZSWU4lDCKAHDR63JJK4rjQBzSsyouhVced%2BThWTOJVdRFvPpVLh85ANN2kni9b%2BvA%2BYr4QNdI7bXX3vCy%2Bmlxmt9OtrkNSzeMBq%2B4UjjQL%2BALBrQRVk2zZ5rDj%2ByazHJ4N56LN4FxJEAdf%2BKr7nn9dZ2DExdIbY7%2Blz79tlyq02tT%2B98LGY82aPEMuTJbBZN6Znugvuj3qTN5Ajkz33XEdb09pTvqYEHwNQvHa8molgvM8Hr0UftpVOr%2FcSDQ%2Be7ClWky3g9k3C7fx8DtVeV3YKXMiauv6oe6iv529tf7ZQLwVbk8MDZHKluj8DVRfRr7MlmTLozZouf9SJ7q02NxX1M1zjSiK9%2Bb3knUL5CRpQRCENhmDWhXpTY5NtCVb6swQ3By1ka7LxXtkUadmYfSCwXxpca0jIGluHz9THdy%2Fc3993usF1hP11r0y8u18g%2BZLF5OCf8pMK8LDv4nKUjODow6e2QiwY6pAHH%2FNyAbORzwpluWJFiLzeFhl5RjYZpJEx0nM7ZKbFuGASfNSFcAHpRW7ZXX%2BBSHdPdxqv%2BQd1FC1QHUbL0ZWNROontBy0xjQujOuLkMDUyDfIqsPUVcZohJWSYUkM5yYj9wg6BrbGLNW9NinBFdcPB5%2BIeF%2Bg7o5tKzk0UaPV%2FO3FiQPt3VlESRyrk8YbEQk7JEub211414ZV4sdV3jLFmf60bgw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0fc1cc7eb45b37bf08374c22612eca1812d8c26ab649561c29b75583a5ac41ce","file_size":5362,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-11-16T19:22:15.757Z","allow_singular_disclosure_after":-123099792.60845979,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","khizer47","muhaddix","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1080467,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nThanks for the report. Upon inspection it seems that this function was intended to allow image upload when the URL does not contain the file name which is common with some feeds, e.g. image.php?image=10\n\nTo work around this, we can validate a whitelist of allowed image types both before and after filename generation from the file's headers. You can see my commit to do this here:\n\nhttps://github.com/woothemes/woocommerce/commit/4f5896d90836e9e1b0f5b2fdad50810fab270da3\n\nCan you confirm this satisfies your report?\n\nThis would only be exploitable by someone with API access so doesn't seem high risk. To upload HTML files you'd also need to be considered an admin user for unfiltered uploads, so 3rd parties using API keys wouldn't be able to upload HTML via the API.\n\nRegardless, this will go out with our next fix release (2.6.4) which should be released within the next 2-3 weeks when ready.\n\nThanks\n\n","automated_response":false,"created_at":"2016-07-21T15:47:04.818Z","updated_at":"2016-07-21T15:47:04.818Z","actor":{"username":"mikejolley","cleared":false,"url":"/mikejolley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1080685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Mike,\n\nThe code commit looks well and I think this will solve the problem. Thank you for solving it. :)\n\nI agree that this isn't a high risk issue, because the change of it getting exploited is low. I consider it low to medium, because of the amount of WooCommerce installations/plugins and the impact on individual installations. \n\nWhat is not clear to me is why 3rd parties can't make a WordPress installation vulnerable to this attack. Isn't it possible for an admin to give an API key with unfiltered upload rights to a third party or a plugin?\n\nWith kind regards,\n\nSipke","automated_response":false,"created_at":"2016-07-21T17:26:48.448Z","updated_at":"2016-07-21T17:26:48.448Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1082245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't think so - the 3rd party won't be 'logged in', they will just have API access with their valid credentials.","automated_response":false,"created_at":"2016-07-22T13:47:02.283Z","updated_at":"2016-07-22T13:47:02.283Z","actor":{"username":"mikejolley","cleared":false,"url":"/mikejolley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1082323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For this POC I created an API key with Read/Write permissions. If the owner of the API key has the right permissions then the API key will have so as well.","automated_response":false,"created_at":"2016-07-22T14:21:58.641Z","updated_at":"2016-07-22T14:21:58.641Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1084431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As an addition: the right needed to upload html files is not *unfiltered_upload* but *unfiltered_html*, which is enabled for super admins, admins and editors.","automated_response":false,"created_at":"2016-07-24T13:13:22.284Z","updated_at":"2016-07-24T13:13:22.284Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1094932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nCan I get an update of the status of this?\n\nWith kind regards,\n\nSipke","automated_response":false,"created_at":"2016-07-29T11:09:09.350Z","updated_at":"2016-07-29T11:09:09.350Z","actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1101771,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi. Thanks again for the report. This issue was fixed in the 2.6.4 release -- https://wordpress.org/plugins/woocommerce/changelog/.","automated_response":false,"created_at":"2016-08-02T09:13:08.722Z","updated_at":"2016-08-02T09:13:08.722Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"beurtschipper","url":"/beurtschipper"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1101774,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-08-02T09:13:16.763Z","updated_at":"2016-08-02T09:13:16.763Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"75.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"beurtschipper","url":"/beurtschipper"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2073569,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-10-17T19:22:15.725Z","updated_at":"2017-10-17T19:22:15.725Z","first_to_agree":true,"actor":{"username":"beurtschipper","cleared":false,"url":"/beurtschipper","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/625/dd7df1c933e04d0149bf0b5760a04212cf881c70_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2163355,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-16T19:22:31.195Z","updated_at":"2017-11-16T19:22:31.195Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}