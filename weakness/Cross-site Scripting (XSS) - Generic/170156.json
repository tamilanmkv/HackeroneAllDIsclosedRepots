{"id":170156,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzAxNTY=","url":"https://hackerone.com/reports/170156","title":"Reflected XSS in Step 2 of the Installation","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-18T05:04:27.335Z","submitted_at":"2016-09-18T05:04:27.335Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pavanw3b","url":"/pavanw3b","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2367,"url":"https://hackerone.com/revive_adserver","handle":"revive_adserver","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Revive Adserver","twitter_handle":"revive_adserver","website":"https://www.revive-adserver.com","about":"Revive Adserver is a free open source ad serving system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-9472"],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-02T05:59:06.669Z","bug_reporter_agreed_on_going_public_at":"2017-07-03T05:59:01.406Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**\"Cricetinae\"** :)\n\n### Short Description\nThe **dbName** parameter in Step 2 of Installation Wizard is vulnerable to Cross-Site Scripting vulnerability when the form is returned with error.\n\n### Vulnerability Details\nCross-Site Scripting issue let's one to run a javascript of choice. It helps most of the client side risks including but not limited to phishing, temporary deface, browser key-logger and others. Exploitation frameworks like BeEF eases the offensive attack.\n\n### Attack Vector\nThough this may be treated as a Self-XSS, the place where the issue is affecting is sensitive. If the user who is going to set up the Revive Adserver, follows an untrusted malicious guide which contains specially crafted XSS payload, can help in gaining access to the database by tricking him to enter the credential in attacker's site by redirecting or any other way.\n\t\n### Dependency\n1. Occurs at the time of installation when the Database Name contains invalid characters.\n2. Chrome's default XSS Protection blocks simple XSS payloads. Please use firefox for reproduction.\n\n### Steps to Reproduce\n1. Navigate to Installation\n2. Agree to the terms and condition in the first step\n3. In the second step, please enter  `something\u003cscript\u003ealert('xss');\u003c/script\u003e` for Database Name field\n4. Note the javascript alert box triggered from the above payload entered in dbName parameter\n\n### HTTP Request\n`POST /revive-adserver/www/admin/install.php HTTP/1.1\n..\n..\nConnection: close`\n\n`_qf__install-db-form=\u0026action=database\u0026moreFieldsShown=\u0026dbName=something\u003cscript\u003ealert('xss');\u003c/script\u003e\u0026dbUser=root\u0026dbPassword=roots\u0026dbHost=localhost\u0026dbType=mysql\u0026dbLocal=0\u0026dbPort=3306\u0026dbTableType=MYISAM\u0026dbTablePrefix=rv_\u0026save=Continue+%C2%BB`\n`\n\n###HTTP Response\n`HTTP/1.1 200 OK\n`\n..\n`\u003cspan id='errorMessages'\u003e\n                          Database names cannot contain \"/\", \"\\\", \".\", or characters that are not allowed in filenames \u003cbr/\u003e                          Installation failed to create the database something\u003cscript\u003ealert('xss');\u003c/script\u003e\u003c/span\u003e`\n        \n###Test Environment Details\n**Version**: Latest as on Sept 17: revive-adserver-3.2.4 downloaded from official website\n**Setup type**: local\n**Browser**: Firefox 47.0\n**OS**: Mac OS X\n\nCheers,\nPavan","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":121116,"file_name":"revive_adserver_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/121/116/bd8cc8b4a0750bf87e615a21076fb6d8c14bf83e/revive_adserver_xss.png?response-content-disposition=attachment%3B%20filename%3D%22revive_adserver_xss.png%22%3B%20filename%2A%3DUTF-8%27%27revive_adserver_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135056Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c0c4c46d3be3d4520494c8303bd903c4d5cf6ff2dd5cbb693cbe9b83b79122cc","file_size":457189,"type":"image/png"}],"allow_singular_disclosure_at":"2017-08-02T05:59:01.454Z","allow_singular_disclosure_after":-132306715.01669163,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","kiraak-boy","pavanw3b","sumit7"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1203391,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. We'll try to reproduce and fix in the forthcoming 4.0.0 release. We'll send a patch for approval in a few days.","automated_response":false,"created_at":"2016-09-19T08:10:47.732Z","updated_at":"2016-09-19T08:10:47.732Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1203618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the Triage.\nI filed #170384 but a another parameter. I'm not sure if I should submit a new report in this case.","automated_response":false,"created_at":"2016-09-19T11:16:45.988Z","updated_at":"2016-09-19T11:16:45.988Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1203714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The **dbUser** parameter is also vulnerable to XSS when the form is returned with error.\nRef: #170384 ","automated_response":false,"created_at":"2016-09-19T12:22:30.155Z","updated_at":"2016-09-19T12:22:30.155Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1218442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is the patch that should fix the issue. We have a release planned for tomorrow, so it would be great if you could double check.\n\nBTW, how would you like to be referred to in the security advisory?","automated_response":false,"created_at":"2016-09-27T09:53:13.199Z","updated_at":"2016-09-27T09:53:13.199Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":123316,"filename":"h1-170156.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/316/4e7ac576ebfdc1d42b8f1b8b61a89704e4513db5/h1-170156.patch?response-content-disposition=attachment%3B%20filename%3D%22h1-170156.patch%22%3B%20filename%2A%3DUTF-8%27%27h1-170156.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135056Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=efdda5a0c2f707be57af632caf49b4d8d17fd6037389c13fbf54202406b489ec"}],"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1218465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for letting me know about this, @mbeccati. Glad to hear that. I see there is escape in the output but I'm not 100% sure about how the framework/language does that. I would like to test it live and confirm.\n\nFeel free to my nickname - **pavanw3b** in the advisory.","automated_response":false,"created_at":"2016-09-27T10:05:46.031Z","updated_at":"2016-09-27T10:05:46.031Z","actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1218771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In order to test live, you just need to edit the *www/admin/templates/install/messages.html* file and retry your attack vector.","automated_response":false,"created_at":"2016-09-27T12:22:26.339Z","updated_at":"2016-09-27T12:22:26.339Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1218772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Or *patch -p1 \u003c /path/to/h1-170156.patch* run in the base Revive folder.","automated_response":false,"created_at":"2016-09-27T12:23:31.135Z","updated_at":"2016-09-27T12:23:43.247Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1220876,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-09-28T10:54:03.339Z","updated_at":"2016-09-28T10:54:03.339Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pavanw3b","url":"/pavanw3b"},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1798385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-07-03T05:59:01.430Z","updated_at":"2017-07-03T05:59:01.430Z","first_to_agree":true,"actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1884469,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-02T05:59:06.694Z","updated_at":"2017-08-02T05:59:06.694Z","actor":{"url":"/revive_adserver","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Revive Adserver"}},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}