{"id":179426,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzk0MjY=","url":"https://hackerone.com/reports/179426","title":"Reflected XSS on blockchain.info","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-01T16:53:12.047Z","submitted_at":"2016-11-01T16:53:12.047Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kasperkarlsson","url":"/kasperkarlsson","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":424,"url":"https://hackerone.com/blockchain","handle":"blockchain","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/UQsMoZVQXUcyXoNuxqAX2xvm/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/UQsMoZVQXUcyXoNuxqAX2xvm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Blockchain","twitter_handle":"blockchain","website":"https://www.blockchain.com/","about":"Blockchain.com is the most popular place to securely buy, store, and trade Bitcoin, Ethereum and other top cryptocurrencies."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-06T16:08:43.220Z","bug_reporter_agreed_on_going_public_at":"2017-02-11T12:45:03.064Z","team_member_agreed_on_going_public_at":"2017-03-06T16:08:43.168Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The application at https://blockchain.info is vulnerable to reflected XSS/HTML injection through the URL at the block-index page.\n\nProof of concept\n===\nThe following PoC contains the payload `\"\u003e\u003ch1\u003eXSS here` which displays the text in heading size.\nhttps://blockchain.info/en/block-index/1160457/%22%3E%3Ch1%3EXSS%20here\nAnother example with some scrolling text `\"\u003e\u003cmarquee\u003eXSS here`:\nhttps://blockchain.info/en/block-index/1160457/%22%3E%3Cmarquee%3EXSS%20here\n\nPrint screens from the two PoCs above are attached to this report. This was tested using Mozilla Firefox 49.0.2 and Google Chrome 54.0.2840.71.\n\nDue to the strict Content Security Policy which even blocks 'self', arbitrary javascript cannot be executed through this vulnerability without some CSP bypass. Great! :)\n\nRecommended solution\n===\nMake sure to properly encode the last part of the URL before printing it to the page. Another possible solution is to make sure the URL matches a strict whitelist regexp, so that this part of the URL is not put on the page at all if it looks fishy.","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":131610,"file_name":"blockchain_info_block-index_XSS_h1_Firefox.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/131/610/b96bcdc1181d773e737bd2d197f52d966692f17c/blockchain_info_block-index_XSS_h1_Firefox.png?response-content-disposition=attachment%3B%20filename%3D%22blockchain_info_block-index_XSS_h1_Firefox.png%22%3B%20filename%2A%3DUTF-8%27%27blockchain_info_block-index_XSS_h1_Firefox.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135403Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d917ca40b685e49922a9f6649edc6a019f9a7b5f1950b5be44f39761361809b2","file_size":109008,"type":"image/png"},{"id":131611,"file_name":"blockchain_info_block-index_XSS_marquee_Chrome.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/131/611/7cf0e1d000421ad8f353599886b882ecf69b8737/blockchain_info_block-index_XSS_marquee_Chrome.png?response-content-disposition=attachment%3B%20filename%3D%22blockchain_info_block-index_XSS_marquee_Chrome.png%22%3B%20filename%2A%3DUTF-8%27%27blockchain_info_block-index_XSS_marquee_Chrome.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135403Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5add8a765327019aa32cdec34525f4afc97a55ec36f5239d6c2f24738a12496e","file_size":45124,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-13T12:45:03.097Z","allow_singular_disclosure_after":-144551340.27777255,"singular_disclosure_allowed":true,"vote_count":11,"voters":["bl4de","mik317","mpz","supernatural","eveeez","sumit7","spetr0x","mandark","romex29","drh4kor","and 1 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1278841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"An updated PoC, which causes a redirect:\nhttps://blockchain.info/en/block-index/1160457/%22%3E%3Cmeta%20http-equiv=%22refresh%22%20content=%220%3B%20url=http://example.com/%22%3E\nThis could e.g. be used to send a victim to a phishing page.","automated_response":false,"created_at":"2016-11-01T17:26:13.909Z","updated_at":"2016-11-01T17:26:13.909Z","actor":{"username":"kasperkarlsson","cleared":false,"url":"/kasperkarlsson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1278901,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Great find, @kasperkarlsson. Thanks for the redirect PoC to help us properly evaluate severity. We're working on a fix, and will follow up with a bounty. I agree this is at least Medium severity.","automated_response":false,"created_at":"2016-11-01T17:47:35.302Z","updated_at":"2016-11-01T17:47:35.302Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1279028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have never gotten a report triaged this fast before - impressive! Thanks for the feedback and please let me know if there is any way I can help.","automated_response":false,"created_at":"2016-11-01T18:40:59.312Z","updated_at":"2016-11-01T18:40:59.312Z","actor":{"username":"kasperkarlsson","cleared":false,"url":"/kasperkarlsson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1296116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to check in briefly, we're still working on deploying a fix.","automated_response":false,"created_at":"2016-11-12T04:06:12.934Z","updated_at":"2016-11-12T04:06:12.934Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1296595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right! Thanks for the update.","automated_response":false,"created_at":"2016-11-12T19:30:36.281Z","updated_at":"2016-11-12T19:30:36.281Z","actor":{"username":"kasperkarlsson","cleared":false,"url":"/kasperkarlsson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1311170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kasperkarlsson:\n\nWe deployed a fix for this particular endpoint and then noticed there are some other vulnerable endpoints that we're deploying similar fixes for. Are you able to confirm that the one you reported is fixed?","automated_response":false,"created_at":"2016-11-21T23:40:20.931Z","updated_at":"2016-11-21T23:40:20.931Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1311171,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-11-21T23:41:25.553Z","updated_at":"2016-11-21T23:41:25.553Z","actor":{"url":"/blockchain","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UQsMoZVQXUcyXoNuxqAX2xvm/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Blockchain"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"blockchain","collaborator":{"username":"kasperkarlsson","url":"/kasperkarlsson"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1311765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that this patch is working.\n\nGreat job and thank you very much for the bounty!","automated_response":false,"created_at":"2016-11-22T07:51:17.954Z","updated_at":"2016-11-22T07:51:17.954Z","actor":{"username":"kasperkarlsson","cleared":false,"url":"/kasperkarlsson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1313345,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.","automated_response":false,"created_at":"2016-11-22T18:44:55.003Z","updated_at":"2016-11-22T18:44:55.003Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1313346,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-11-22T18:45:07.354Z","updated_at":"2016-11-22T18:45:07.354Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kasperkarlsson","url":"/kasperkarlsson"},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1479157,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-11T12:45:03.080Z","updated_at":"2017-02-11T12:45:03.080Z","first_to_agree":true,"actor":{"username":"kasperkarlsson","cleared":false,"url":"/kasperkarlsson","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/967/bd4c94d43596b9c551e3a5e24b5c9f373046f945_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1522106,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-06T16:08:43.194Z","updated_at":"2017-03-06T16:08:43.194Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1522107,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-06T16:08:43.234Z","updated_at":"2017-03-06T16:08:43.234Z","actor":{"username":"kristovblockchain","cleared":false,"url":"/kristovblockchain","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"blockchain","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}