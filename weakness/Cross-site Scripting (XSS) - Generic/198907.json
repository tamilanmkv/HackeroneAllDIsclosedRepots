{"id":198907,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTg5MDc=","url":"https://hackerone.com/reports/198907","title":"HTML Injection possible due to bad filter","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-17T03:11:25.656Z","submitted_at":"2017-01-17T03:11:25.656Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackb898","url":"/jackb898","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-10T12:01:31.776Z","bug_reporter_agreed_on_going_public_at":"2017-01-23T03:16:12.216Z","team_member_agreed_on_going_public_at":"2017-02-10T12:01:31.728Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI have found an area where it may be possible to run certain HTML/JS scripts.\n\nTO REPRODUCE:\n1. Go to documents\n\n2. Upload anything and edit it\n\n3. On the edit page in tags, enter code without a closing bracket ex. \u003cimg src=x\n\n4. Click enter\n\n5. It will be parsed in that area, but after saving it, it won't parse.\n\nPOTENTIAL:\nI'm still looking into this, as this could be a possible XSS vuln if I can find vectors without closing brackets that have harmful code.\n\nWHY IT WORKS:\nThe reason this works is because your filter only looks for opening AND closing brackets, when it is possible to run code without closing the brackets.\n\nThanks,\nKicker\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-22T03:16:12.259Z","allow_singular_disclosure_after":-146227451.64268127,"singular_disclosure_allowed":true,"vote_count":11,"voters":["thaivu","mpz","brodie_codie","eveeez","kunal94","jackb898","kiraak-boy","vraj","japz","rbcafe","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1424512,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Please, include working proof of concept with XSS. ","automated_response":false,"created_at":"2017-01-17T10:11:12.799Z","updated_at":"2017-01-17T10:11:12.799Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1424996,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Exe I will followup later today if I find a harmful payload that can run","automated_response":false,"created_at":"2017-01-17T15:08:50.122Z","updated_at":"2017-01-17T15:08:50.122Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1426540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright @exe, here is a much better report.\n\n### DESCRIPTION:\nThis vulnerability occurs in https://vk.com/docs when you click the pencil to edit a document and go to tags. You can type code like \n`\u003cimg src=x onerror=alert(1) foo=` and it will be parsed and run.\n\n### HOW TO REPRODUCE:\n1. Login to any account on VK (desktop)\n\n2. On the left menu, click Documents\n\n3. Upload any random document (doesn't effect vulnerability) or use an uploaded document for the next step\n\n4.  Click the pencil next to the document to edit it\n\n5. On the editing menu, scroll to Tags and type some code without closing brackets \n(ex. `\u003ciframe src=\"cookielogger/iplogger.com\" foo=`)\n\n6.  Click enter and the code will be parsed and run\n\n### WHY IT WORKS\nThis vulnerability works because of an issue that might be a larger issue, which is the filter. The filter used on the tag feature removes all text between two brackets, ex. if you type \u003cimg src=x\u003e the filter removes the brackets and img src=x between, resulting in no text. If you do unicode, it parses but doesn't run, so that is secure, but the filter doesn't remove anything if you don't close the brackets. Not closing brackets, while it does break certain code, doesn't break most HTML code, meaning you can run harmful code such as an iframe to a cookie logger.\n    \nIn conclusion for this section/ shortened message: There may be other areas vulnerable to this if they use this filter, so definitely check for that.\n\n\n\n### WHY IT IS HARMFUL\nThis could be used harmfully by black hats, as they could tell a friend to go to documents and edit and paste the code for some admin permissions (just made that up, could be any scenario), and upon clicking enter, it could log  their cookies/ip or lead to a phishing site to get their password.\n\n### SUGGESTED REMEDIATION\nI suggest that you use the filter used for usernames, which removes special characters, and this would prevent XSS from executing in the tags.\n\nThanks,\nKicker\n","automated_response":false,"created_at":"2017-01-18T02:33:32.405Z","updated_at":"2017-01-18T02:36:10.470Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427096,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report. We will investigate this issue and write you back.","automated_response":false,"created_at":"2017-01-18T10:27:31.489Z","updated_at":"2017-01-18T10:27:31.489Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1428933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you want the report Type and Severity corrected, please change it to Type: XSS and severity: Medium (that's this vulnerability's severity in my opinion)","automated_response":false,"created_at":"2017-01-19T00:28:03.164Z","updated_at":"2017-01-19T00:28:03.164Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432326,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We resolved this issue. Please, check. \n\nThat was a self-xss vulnerability. We do not pay for them, but thank you for the report. ","automated_response":false,"created_at":"2017-01-20T11:21:16.856Z","updated_at":"2017-01-20T11:21:16.856Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jackb898","url":"/jackb898"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1437457,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@exe i can confirm it is fixed. May we disclose this?","automated_response":false,"created_at":"2017-01-23T03:16:12.235Z","updated_at":"2017-01-23T03:16:12.235Z","first_to_agree":true,"actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1474389,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-02-09T12:57:54.278Z","updated_at":"2017-02-09T12:57:54.278Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1474391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How should we disclose this report? Full or limited?","automated_response":false,"created_at":"2017-02-09T12:58:44.568Z","updated_at":"2017-02-09T12:58:44.568Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mihver1 doesn't matter to me, whatever your company wants.","automated_response":false,"created_at":"2017-02-10T01:42:55.329Z","updated_at":"2017-02-10T01:42:55.329Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1476901,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2017-02-10T12:00:49.988Z","updated_at":"2018-02-28T13:10:59.933Z","additional_data":{"added_weaknesses":[{"id":60,"name":"Cross-site Scripting (XSS) - Generic"}],"removed_weaknesses":[{"id":58,"name":"Command Injection - Generic"}]},"actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476902,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-10T12:01:31.745Z","updated_at":"2017-02-10T12:01:31.745Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1476903,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-10T12:01:31.790Z","updated_at":"2017-02-10T12:01:31.790Z","actor":{"username":"mihver1","cleared":false,"url":"/mihver1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}