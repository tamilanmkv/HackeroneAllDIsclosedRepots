{"id":24684,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDY4NA==","url":"https://hackerone.com/reports/24684","title":"Potential XSS vulnerability to HTML minification","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-08-17T04:09:46.269Z","submitted_at":"2014-08-17T04:09:46.269Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"filedescriptor","url":"/filedescriptor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-17T15:55:59.407Z","bug_reporter_agreed_on_going_public_at":"2018-03-18T15:55:49.142Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have already reported it through email but I was advised to post it here.\r\n\r\nOriginal request: https://support.cloudflare.com/hc/requests/166005\r\n\r\nThe issue\r\n---------\r\n\r\nThe HTML minification function optimizes the HTML content without validating the HTML syntax. In particular circumstances this may lead to XSS vulnerability.\r\n\r\nDetails\r\n-------\r\n\r\nThe HTML minification strips off any space between an less than sign(\u003c) and an element name, making every XSS prevention that relies on tag stripping mechanism vulnerable.\r\n\r\nFor example, PHP's strip_tags() function is one of them. The way it handles malicious text is to remove complete tags, so if it encounters anything other than a valid tag it will do nothing.\r\n\r\nNow, if I am going to input the following secquence: _a less than sign(\u003c) followed by a space, followed by an element name, followed by a greater than sign(\u003e)_, e.g.```\u003c img\u003e```, the function will ignore it since it is not a valid tag according to HTML specification, and browsers will not parse it so the output remains safe.\r\n\r\nHowever, when HTML minification comes to play, it strips off the space between the less than sign and the element name, turning the safe text into a tag, which is unexpected to the function's intention.\r\n\r\nNeedless to say, it is not limited to the particular function or language.\r\n\r\nPoC\r\n---\r\n```php\r\n\u003c?php echo strip_tags('\u003c svg onload=alert(1)\u003e'); ?\u003e\r\n```\r\n\r\nComparing the results:\r\n\r\nNormal: \r\n```html\r\n\u003c svg onload=alert(1)\u003e\r\n```\r\n\r\nMinified: \r\n```html\r\n\u003csvg onload=alert(1)\u003e\r\n```","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-17T15:55:49.229Z","allow_singular_disclosure_after":-109982029.82705025,"singular_disclosure_allowed":true,"vote_count":21,"voters":["jokebookservice1","foobar7","inhibitor181","avlidienbrunn","spam404","tungpun","bugdiscloseguys","abr1k0s","eveeez","apapedulimu","and 11 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":112661,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for submission. I have escalated your report to our engineers for review.","automated_response":false,"created_at":"2014-08-20T16:35:55.496Z","updated_at":"2014-08-20T16:35:55.496Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":129061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update? It seems the bug was fixed.","automated_response":false,"created_at":"2014-09-18T10:33:04.412Z","updated_at":"2014-09-18T10:33:04.412Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":129236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nOur engineers is reviewing the bug and we should have an update soon.","automated_response":false,"created_at":"2014-09-18T17:20:15.290Z","updated_at":"2014-09-18T17:20:15.290Z","actor":{"username":"dngo","cleared":false,"url":"/dngo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/378/f1a4953335a4480e4fc117e8c3b33f97378d65b8_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":140266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nApologies for the delay in updating you. Our engineers are still working on this and once a fix hits production, we will endeavour to update you.","automated_response":false,"created_at":"2014-10-10T16:54:30.772Z","updated_at":"2014-10-10T16:54:30.772Z","actor":{"username":"matthewgall","cleared":false,"url":"/matthewgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/593/ebff87f1f73b91d9e1f9e49c53ad190f6939aeb0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":177833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I do believe the fix has already hit production, just wondering is there any update?","automated_response":false,"created_at":"2014-12-13T04:08:55.464Z","updated_at":"2014-12-13T04:08:55.464Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, any updates on this issue?","automated_response":false,"created_at":"2015-03-12T09:28:40.728Z","updated_at":"2015-03-12T09:28:40.728Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":380416,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"We believe this issue has been resolved. Please take a moment to reassess and let us know if you disagree.","automated_response":false,"created_at":"2015-04-15T10:02:46.743Z","updated_at":"2015-04-15T10:02:46.743Z","actor":{"username":"matthewgall","cleared":false,"url":"/matthewgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/593/ebff87f1f73b91d9e1f9e49c53ad190f6939aeb0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":380428,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I can confirm this is fixed.","automated_response":false,"created_at":"2015-04-15T10:11:26.801Z","updated_at":"2015-04-15T10:11:26.801Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448243,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello,\n\nThanks - This is a case where the bug was already being addressed and the fix was already on the roadmap. Thank-you however for your submission!\n\nMarc","automated_response":false,"created_at":"2015-06-09T21:51:56.212Z","updated_at":"2015-06-09T21:51:56.212Z","actor":{"username":"cjunky","cleared":false,"url":"/cjunky","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448563,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey thanks for fixing it. Any chance to get a T-shirt or something?","automated_response":false,"created_at":"2015-06-10T02:14:06.591Z","updated_at":"2015-06-10T02:14:06.591Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448592,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, I dont see why not :)\n\nSend me your name, address and T-shirt size, and I will get one shipped out to you.\n\nCheers!\n\nMarc","automated_response":false,"created_at":"2015-06-10T02:50:09.460Z","updated_at":"2015-06-10T02:50:09.460Z","actor":{"username":"cjunky","cleared":false,"url":"/cjunky","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448621,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How should I send you the information? I don't feel like posting it here is an option (public disclosure will leak it).","automated_response":false,"created_at":"2015-06-10T03:41:40.293Z","updated_at":"2015-06-10T03:42:16.344Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you want, send it directly to my company email - marc@cloudflare.com\nIf you are feeling particularly paranoid, ping me tomorrow and I will send you my work PGP key.\n\nMarc","automated_response":false,"created_at":"2015-06-10T04:27:22.524Z","updated_at":"2015-06-10T04:27:22.524Z","actor":{"username":"cjunky","cleared":false,"url":"/cjunky","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448703,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Thanks for your valid bug report, we'll follow up with you in the near future regarding reward fulfilment. Thank you!","automated_response":false,"created_at":"2015-06-10T05:26:10.343Z","updated_at":"2015-06-10T05:26:10.343Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2503655,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-03-18T15:55:49.184Z","updated_at":"2018-03-18T15:55:49.184Z","first_to_agree":true,"actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2625044,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-17T15:55:59.437Z","updated_at":"2018-04-17T15:55:59.437Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}