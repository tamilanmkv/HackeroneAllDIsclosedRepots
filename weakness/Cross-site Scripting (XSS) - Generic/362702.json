{"id":362702,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjI3MDI=","url":"https://hackerone.com/reports/362702","title":"XSS in express-useragent through HTTP User-Agent","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-06-06T11:28:49.469Z","submitted_at":"2018-06-06T11:28:49.469Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b9b86c2fc8409c628fb3de6","url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-06T13:34:36.850Z","bug_reporter_agreed_on_going_public_at":"2018-07-06T13:34:36.730Z","team_member_agreed_on_going_public_at":"2018-07-06T10:37:28.062Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, \n\nI would like to report an XSS in express-useragent  module  due  a lack of validating User-Agent header. Please note I already created an [Github issue](https://github.com/biggora/express-useragent/issues/98) and asked for CVE ( [CVE-2018-9863](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9863)). I did not know about Node.js third-party modules on hackerone.\n\n## Description\nexpress-useragent is simple NodeJS/ExpressJS middleware exposing User-Agent details to your application and views. Basically it parses User-Agent and return it in structured JSON format.\n\n## The issue\nwhile parsing User-Agent there are no escaping or sanitization mechanism. User-Agent header is controlled by the user. An attacker can craft a malicious script and inject it through the HTTP header.\n\n## Steps to reproduce\n* git clone https://github.com/biggora/express-useragent \n* cd express-useragent\n* ```node test/http.js```  (an HTTP server should listen on 3000 tcp)\n* ```curl \"http://localhost:3000\" -H 'User-Agent: \u003cscript\u003ealert(\"XSS\")\u003c/script\u003e' \u003e poc.html```\n* open poc.html with your favorite web browser\n* you should see an alertbox popup \n\n### Proof of concept (screenshots)\n{F305913}\n{F305914}\n\n### Proof of concept with a fix (video) {F305912}\n\n## Mitigation\nCorrectly escape and sanitize user input ( HTTP User-Agent ). Please note I proposed a fix in the video\n\n## Impact\n\nAn attacker could execute javascript code that could lead to XSS.","vulnerability_information_html":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003eI would like to report an XSS in express-useragent  module  due  a lack of validating User-Agent header. Please note I already created an \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbiggora%2Fexpress-useragent%2Fissues%2F98\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGithub issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and asked for CVE ( \u003ca href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2018-9863\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVE-2018-9863\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). I did not know about Node.js third-party modules on hackerone.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eexpress-useragent is simple NodeJS/ExpressJS middleware exposing User-Agent details to your application and views. Basically it parses User-Agent and return it in structured JSON format.\u003c/p\u003e\n\n\u003ch2 id=\"the-issue\"\u003eThe issue\u003c/h2\u003e\n\n\u003cp\u003ewhile parsing User-Agent there are no escaping or sanitization mechanism. User-Agent header is controlled by the user. An attacker can craft a malicious script and inject it through the HTTP header.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003egit clone \u003ca title=\"https://github.com/biggora/express-useragent\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbiggora%2Fexpress-useragent\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/biggora/express-useragent\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003ecd express-useragent\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003enode test/http.js\u003c/code\u003e  (an HTTP server should listen on 3000 tcp)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecurl \u0026quot;http://localhost:3000\u0026quot; -H \u0026#39;User-Agent: \u0026lt;script\u0026gt;alert(\u0026quot;XSS\u0026quot;)\u0026lt;/script\u0026gt;\u0026#39; \u0026gt; poc.html\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eopen poc.html with your favorite web browser\u003c/li\u003e\n\u003cli\u003eyou should see an alertbox popup \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"proof-of-concept-screenshots\"\u003eProof of concept (screenshots)\u003c/h3\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2018-04-09_18-50-35_(1).png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-50-35_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-50-35_%25281%2529.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=b9733510ada02cba923ec3bceffedc7d83dee0f0283f0890d931729abfd0238c\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-50-35_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-50-35_%25281%2529.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=b9733510ada02cba923ec3bceffedc7d83dee0f0283f0890d931729abfd0238c\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2018-04-09_18-51-21_(1).png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-51-21_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-51-21_%25281%2529.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=c7314a410617de2156a5e9fae155936427c249b2541eb1ee469f87a773e605b2\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-51-21_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-51-21_%25281%2529.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=c7314a410617de2156a5e9fae155936427c249b2541eb1ee469f87a773e605b2\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"proof-of-concept-with-a-fix-video-express_useragent_xss-mkv-f305912\"\u003eProof of concept with a fix (video) \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"express_useragent_xss.mkv\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/912/8c4e45709d9acdfbb5f4a707c76fc698192695a3/express_useragent_xss.mkv?response-content-disposition=attachment%3B%20filename%3D%22express_useragent_xss.mkv%22%3B%20filename%2A%3DUTF-8%27%27express_useragent_xss.mkv\u0026amp;response-content-type=video%2Fx-matroska\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=5c9484b79d84a4acc0db224f8c052ee0616a6f530a6597b42342423ba5a034b7\" data-attachment-type=\"video/x-matroska\"\u003eexpress_useragent_xss.mkv (F305912)\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003cp\u003eCorrectly escape and sanitize user input ( HTTP User-Agent ). Please note I proposed a fix in the video\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could execute javascript code that could lead to XSS.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":305912,"file_name":"express_useragent_xss.mkv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/912/8c4e45709d9acdfbb5f4a707c76fc698192695a3/express_useragent_xss.mkv?response-content-disposition=attachment%3B%20filename%3D%22express_useragent_xss.mkv%22%3B%20filename%2A%3DUTF-8%27%27express_useragent_xss.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=5c9484b79d84a4acc0db224f8c052ee0616a6f530a6597b42342423ba5a034b7","file_size":10922503,"type":"video/x-matroska"},{"id":305913,"file_name":"Screenshot_from_2018-04-09_18-50-35_(1).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/913/2cf634e9d3228e78c63df9b9457467db928168b8/Screenshot_from_2018-04-09_18-50-35_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-50-35_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-50-35_%25281%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=b9733510ada02cba923ec3bceffedc7d83dee0f0283f0890d931729abfd0238c","file_size":16277,"type":"image/png"},{"id":305914,"file_name":"Screenshot_from_2018-04-09_18-51-21_(1).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/305/914/8773f06a8e47477582c406f804456e7c06e028cd/Screenshot_from_2018-04-09_18-51-21_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2018-04-09_18-51-21_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2018-04-09_18-51-21_%25281%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=c7314a410617de2156a5e9fae155936427c249b2541eb1ee469f87a773e605b2","file_size":49524,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["b9b86c2fc8409c628fb3de6","ozymanberg","0xcyber-pirate"],"structured_scope":{"databaseId":11571,"asset_type":"SOURCE_CODE","asset_identifier":"express-useragent","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2894629,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-16T18:53:36.963Z","updated_at":"2018-06-16T18:53:36.963Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2894646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ibrahimd \n\nThanks for reporting this issue.\nI will invite the package maintainer to this issue.\n\nI'm not sure I follow the actual vulnerability. The POC happens when the useragent string is sent back to the client that requests it. The purpose of the middleware is to parse useragent data and it will be odd to escape it in the middleware.\n\nIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ibrahimd\"\u003e@ibrahimd\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m not sure I follow the actual vulnerability. The POC happens when the useragent string is sent back to the client that requests it. The purpose of the middleware is to parse useragent data and it will be odd to escape it in the middleware.\u003c/p\u003e\n\n\u003cp\u003eIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-16T18:58:57.143Z","updated_at":"2018-06-16T18:58:57.143Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2896719,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-17T15:35:10.728Z","updated_at":"2018-06-17T15:35:10.728Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2896723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree with @lirantal.","markdown_message":"\u003cp\u003eI agree with \u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-17T15:38:37.778Z","updated_at":"2018-06-17T15:38:37.778Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2896954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nSorry for the slow response. I agree with @lirantal:\n```\nIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)\n```\nBur here is the catch, I think that @bougakovgeorge should at least escape greater/less sign **\u003c\u003e** from the user agent value. By removing *\u003c\u003e* most if not all XSS vectors that require **\u003c\u003e** won't work. \nHere is a list of some user agents:\n* Mozilla/5.0 (Android 4.4; Mobile; rv:41.0) Gecko/41.0 Firefox/41.0\n* Mozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20100101 Firefox/10.0\n* Mozilla/5.0 (TV; rv:44.0) Gecko/44.0 Firefox/44.0\n\nAs you can see on the above list none of the user agent contains **\u003c\u003e* *, we could use a white list of allowed characters to minimize  XSS injection. I would like to suggest to update provided examples on github showing a secure way on how to implement the middleware for both client/server side.\n\nServer side:\n\nAs we know the middleware returns a JSON so we should set this HTTP HEADER `Content-Type: application/json` to prevent an XSS to be executed in modern web browsers.\n\nClient side:\n\nHere, its more complicated because it really depends on how the developer will use the return valued. Its more about which context the value will be reflected but in any case the user should sanitize the returned value before outputting/reflecting it.\n\nIf you need more information let me know,\n@ibrahimd  ","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nSorry for the slow response. I agree with \u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eIMO it will be the responsibility of the user using this middleware to understand which context it is used and escape it properly (it can be JSON, markdown, HTML, JS, etc)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBur here is the catch, I think that \u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e should at least escape greater/less sign \u003cstrong\u003e\u0026lt;\u0026gt;\u003c/strong\u003e from the user agent value. By removing \u003cem\u003e\u0026lt;\u0026gt;\u003c/em\u003e most if not all XSS vectors that require \u003cstrong\u003e\u0026lt;\u0026gt;\u003c/strong\u003e won\u0026#39;t work. \u003cbr\u003e\nHere is a list of some user agents:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMozilla/5.0 (Android 4.4; Mobile; rv:41.0) Gecko/41.0 Firefox/41.0\u003c/li\u003e\n\u003cli\u003eMozilla/5.0 (X11; Linux x86_64; rv:10.0) Gecko/20100101 Firefox/10.0\u003c/li\u003e\n\u003cli\u003eMozilla/5.0 (TV; rv:44.0) Gecko/44.0 Firefox/44.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAs you can see on the above list none of the user agent contains *\u003cem\u003e\u0026lt;\u0026gt;\u003c/em\u003e *, we could use a white list of allowed characters to minimize  XSS injection. I would like to suggest to update provided examples on github showing a secure way on how to implement the middleware for both client/server side.\u003c/p\u003e\n\n\u003cp\u003eServer side:\u003c/p\u003e\n\n\u003cp\u003eAs we know the middleware returns a JSON so we should set this HTTP HEADER \u003ccode\u003eContent-Type: application/json\u003c/code\u003e to prevent an XSS to be executed in modern web browsers.\u003c/p\u003e\n\n\u003cp\u003eClient side:\u003c/p\u003e\n\n\u003cp\u003eHere, its more complicated because it really depends on how the developer will use the return valued. Its more about which context the value will be reflected but in any case the user should sanitize the returned value before outputting/reflecting it.\u003c/p\u003e\n\n\u003cp\u003eIf you need more information let me know,\u003cbr\u003e\n\u003ca href=\"/ibrahimd\"\u003e@ibrahimd\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-17T18:02:53.242Z","updated_at":"2018-06-17T18:02:53.242Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2897154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You must be mistaken. I am NOT the maintainer of the library, I just responded to your issue. @biggora (https://github.com/biggora) is the maintainer.","markdown_message":"\u003cp\u003eYou must be mistaken. I am NOT the maintainer of the library, I just responded to your issue. \u003ca href=\"/biggora\"\u003e@biggora\u003c/a\u003e (\u003ca title=\"https://github.com/biggora\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbiggora\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/biggora\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) is the maintainer.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-17T20:58:29.808Z","updated_at":"2018-06-17T20:58:29.808Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2897169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bougakovgeorge,  my apologies, I thought you were the maintainer, because @lirantal  said that he will invite the package maintainer.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e,  my apologies, I thought you were the maintainer, because \u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e  said that he will invite the package maintainer.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-17T21:06:44.847Z","updated_at":"2018-06-17T21:06:44.847Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2897172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bougakovgeorge  I have also invited Alexy but unfortunately he hasn't yet joined this issue. If you're able to ping him we'll appreciate it.\n\n@ibrahimd updating the examples is ok. About blacklisting the \u003c \u003e it's again up to the maintainer's since one can argue that it is a free text field (there's nothing that forbids those chars as far as I know).","markdown_message":"\u003cp\u003e\u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e  I have also invited Alexy but unfortunately he hasn\u0026#39;t yet joined this issue. If you\u0026#39;re able to ping him we\u0026#39;ll appreciate it.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ibrahimd\"\u003e@ibrahimd\u003c/a\u003e updating the examples is ok. About blacklisting the \u0026lt; \u0026gt; it\u0026#39;s again up to the maintainer\u0026#39;s since one can argue that it is a free text field (there\u0026#39;s nothing that forbids those chars as far as I know).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-17T21:13:54.356Z","updated_at":"2018-06-17T21:13:54.356Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2960498,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-29T21:51:22.992Z","updated_at":"2018-06-29T21:51:22.992Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"useragent","new_scope":"express-useragent","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2960499,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ibrahimd I tried inviting the author again.\nIf there will be no sign from him on this report during next week I will proceed with closing this report as informative.\n\nIf you're able to help contact him and ask him to join this conversation I will greatly appreciate it so we can check with him about adding security disclosures in the README and updating the examples.","markdown_message":"\u003cp\u003e\u003ca href=\"/ibrahimd\"\u003e@ibrahimd\u003c/a\u003e I tried inviting the author again.\u003cbr\u003e\nIf there will be no sign from him on this report during next week I will proceed with closing this report as informative.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;re able to help contact him and ask him to join this conversation I will greatly appreciate it so we can check with him about adding security disclosures in the README and updating the examples.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T21:53:00.466Z","updated_at":"2018-06-29T21:53:00.466Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2965905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lirantal  thanks for the update.\n\nI'm a little bit disappointed with the idea if we can't get the module author to participate to this thread during the next week, you will close the report as `informative`. I work hard to report only valid bugs to rise my hackerone's signal and reputation. \n\nIn the end I will gladly accept your final decision.  \n\nI'll send him a PR, he seems to be responsive to pull requests, in the description section I'll explain our situation here.","markdown_message":"\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e  thanks for the update.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m a little bit disappointed with the idea if we can\u0026#39;t get the module author to participate to this thread during the next week, you will close the report as \u003ccode\u003einformative\u003c/code\u003e. I work hard to report only valid bugs to rise my hackerone\u0026#39;s signal and reputation. \u003c/p\u003e\n\n\u003cp\u003eIn the end I will gladly accept your final decision.  \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll send him a PR, he seems to be responsive to pull requests, in the description section I\u0026#39;ll explain our situation here.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T12:00:09.986Z","updated_at":"2018-06-30T12:00:09.986Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2966103,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ibrahimd I will follow-up and do my best to get him on the conversation. I saw already that you opened the issue in their repository and there wasn't any response from the author, only from a contributor who isn't stepping in to fill the gap so we'd need the module maintainer for this.\n\nWill definitely appreciate if you can also ping him and get him to join this conversation.","markdown_message":"\u003cp\u003e\u003ca href=\"/ibrahimd\"\u003e@ibrahimd\u003c/a\u003e I will follow-up and do my best to get him on the conversation. I saw already that you opened the issue in their repository and there wasn\u0026#39;t any response from the author, only from a contributor who isn\u0026#39;t stepping in to fill the gap so we\u0026#39;d need the module maintainer for this.\u003c/p\u003e\n\n\u003cp\u003eWill definitely appreciate if you can also ping him and get him to join this conversation.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T15:01:16.099Z","updated_at":"2018-06-30T15:01:16.099Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2966779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would totally help you fix it, I just can’t imagine and/or replicate the issue with just a browser.","markdown_message":"\u003cp\u003eI would totally help you fix it, I just can’t imagine and/or replicate the issue with just a browser.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T22:06:49.877Z","updated_at":"2018-06-30T22:06:49.877Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2968349,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bougakovgeorge reproduction steps using a browser:\n1. install [User-Agent Switcher - chrome extension](https://chrome.google.com/webstore/detail/user-agent-switcher/clddifkhlkcojbojppdojfeeikdkgiae?hl=en)\n2. create a new user-agent\n3. name your new user-agent whatever you want  {F314226}\n4. set user-agent value to: `\u003cscript\u003ealert(0)\u003c/script\u003e`  {F314226}\n5. select the new user agent \n6. start one of the test examples: `node test/express.js`\n7. browse: `http://localhost:3000` using chrome\n8. the XSS value will be reflected but not triggered due the fact its reflected inside JSON context.\n\nFrom here we know that the user agent is not sanitized, let's edit one of the examples (express.js) simulating a scenario of developer who want to display the user agent of the visitor:\n\n1. edit test/express.js:\n\n```javascript\n...\napp.get('/', function (req, res) {\n    res.send(\"User-Agent: \" + req.useragent.source);\n});\n...\n```\n2. save changes and run again the server: `node express.js`\n3. visit `http://localhost:3000` using chrome (make sure user-agent switch is on and using custom payload)\n4. XSS window should pop up. {F314225}\n\n@lirantal I am sure you're doing your best, I'll do my best as well. If you need anything else please let me know.","markdown_message":"\u003cp\u003e\u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e reproduction steps using a browser:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003einstall \u003ca href=\"/redirect?url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fuser-agent-switcher%2Fclddifkhlkcojbojppdojfeeikdkgiae%3Fhl%3Den\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eUser-Agent Switcher - chrome extension\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ecreate a new user-agent\u003c/li\u003e\n\u003cli\u003ename your new user-agent whatever you want  \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-Agent_switcher-new_user-agent.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-Agent_switcher-new_user-agent.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-Agent_switcher-new_user-agent.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=288fc38ca119dcc8c554de6ab77c30dcfdf4e39d28f155206c841e083f20d7b6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-Agent_switcher-new_user-agent.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-Agent_switcher-new_user-agent.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=288fc38ca119dcc8c554de6ab77c30dcfdf4e39d28f155206c841e083f20d7b6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eset user-agent value to: \u003ccode\u003e\u0026lt;script\u0026gt;alert(0)\u0026lt;/script\u0026gt;\u003c/code\u003e  \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-Agent_switcher-new_user-agent.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-Agent_switcher-new_user-agent.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-Agent_switcher-new_user-agent.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=288fc38ca119dcc8c554de6ab77c30dcfdf4e39d28f155206c841e083f20d7b6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-Agent_switcher-new_user-agent.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-Agent_switcher-new_user-agent.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=288fc38ca119dcc8c554de6ab77c30dcfdf4e39d28f155206c841e083f20d7b6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eselect the new user agent \u003c/li\u003e\n\u003cli\u003estart one of the test examples: \u003ccode\u003enode test/express.js\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003ebrowse: \u003ccode\u003ehttp://localhost:3000\u003c/code\u003e using chrome\u003c/li\u003e\n\u003cli\u003ethe XSS value will be reflected but not triggered due the fact its reflected inside JSON context.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eFrom here we know that the user agent is not sanitized, let\u0026#39;s edit one of the examples (express.js) simulating a scenario of developer who want to display the user agent of the visitor:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eedit test/express.js:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eUser-Agent: \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euseragent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003esave changes and run again the server: \u003ccode\u003enode express.js\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003evisit \u003ccode\u003ehttp://localhost:3000\u003c/code\u003e using chrome (make sure user-agent switch is on and using custom payload)\u003c/li\u003e\n\u003cli\u003eXSS window should pop up. \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"User-agent_XSS-popup.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-agent_XSS-popup.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-agent_XSS-popup.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=d4b77f346ceecc222aafcbe22e1fb7eb96f7704058e48f75d5d030e27e087370\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-agent_XSS-popup.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-agent_XSS-popup.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T054348Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026amp;X-Amz-Signature=d4b77f346ceecc222aafcbe22e1fb7eb96f7704058e48f75d5d030e27e087370\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e I am sure you\u0026#39;re doing your best, I\u0026#39;ll do my best as well. If you need anything else please let me know.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T11:19:30.526Z","updated_at":"2018-07-01T11:19:30.526Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":314226,"filename":"User-Agent_switcher-new_user-agent.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/226/46a757f7678d9bc23f46fd3b502a73b8236a07af/User-Agent_switcher-new_user-agent.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-Agent_switcher-new_user-agent.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-Agent_switcher-new_user-agent.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=288fc38ca119dcc8c554de6ab77c30dcfdf4e39d28f155206c841e083f20d7b6"},{"id":314225,"filename":"User-agent_XSS-popup.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/225/a76578c5b52dbd4944a3da8ff86fa850008bb1c3/User-agent_XSS-popup.PNG?response-content-disposition=attachment%3B%20filename%3D%22User-agent_XSS-popup.PNG%22%3B%20filename%2A%3DUTF-8%27%27User-agent_XSS-popup.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=d4b77f346ceecc222aafcbe22e1fb7eb96f7704058e48f75d5d030e27e087370"}],"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2968377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can switch your UA without any extensions, but only an idiot will switch his user agent to ‘\u003cscript\u003emaliciouscode();\u003c/script\u003e’ and visit a JSON page. Also, if a web developer needs to see what browser user uses, they can see the UA string using ‘window.navigator.useragent’ which is perfectly safe.\nAlso, AFAIK HTTP protocol specification does not forbid \u003c\u003e characters and escaping and/or them will be a violation of specification.","markdown_message":"\u003cp\u003eYou can switch your UA without any extensions, but only an idiot will switch his user agent to ‘\u0026lt;script\u0026gt;maliciouscode();\u0026lt;/script\u0026gt;’ and visit a JSON page. Also, if a web developer needs to see what browser user uses, they can see the UA string using ‘window.navigator.useragent’ which is perfectly safe.\u003cbr\u003e\nAlso, AFAIK HTTP protocol specification does not forbid \u0026lt;\u0026gt; characters and escaping and/or them will be a violation of specification.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T11:53:53.095Z","updated_at":"2018-07-01T11:53:53.095Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2968628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bougakovgeorge Let's try to keep it civilized and respectful. We all have good intentions.\nRegardless to a fix or not, do you agree to add a disclaimer in the README ?","markdown_message":"\u003cp\u003e\u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e Let\u0026#39;s try to keep it civilized and respectful. We all have good intentions.\u003cbr\u003e\nRegardless to a fix or not, do you agree to add a disclaimer in the README ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T16:23:11.522Z","updated_at":"2018-07-01T16:23:11.522Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2968893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I also have good intentions, and a disclaimer can be nice, but I just can’t imagine a **real** scenario where this exploit can be used and executed. I also think that if you patch this library to escape these symbols, you need to make it an option and don’t force it. Also, I don’t think that this module is still maintained and [I repeat] I am not the maintainer or a contributor of this module. I just wanted to use it in my service, implemented it and wanted to open an issue and a pull request to add macOS Mojave support and I just saw your issue and expressed my opinion. Sorry for any misunderstanding caused.\n\nSide note: Is your main goal “to rise my (ibrahimd’s) hackerone's signal and reputation.”? It’s kinda strange...","markdown_message":"\u003cp\u003eI also have good intentions, and a disclaimer can be nice, but I just can’t imagine a \u003cstrong\u003ereal\u003c/strong\u003e scenario where this exploit can be used and executed. I also think that if you patch this library to escape these symbols, you need to make it an option and don’t force it. Also, I don’t think that this module is still maintained and [I repeat] I am not the maintainer or a contributor of this module. I just wanted to use it in my service, implemented it and wanted to open an issue and a pull request to add macOS Mojave support and I just saw your issue and expressed my opinion. Sorry for any misunderstanding caused.\u003c/p\u003e\n\n\u003cp\u003eSide note: Is your main goal “to rise my (ibrahimd’s) hackerone\u0026#39;s signal and reputation.”? It’s kinda strange...\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T18:00:31.922Z","updated_at":"2018-07-01T18:00:31.922Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2968988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bougakovgeorge I appreciate your involvement in the conversation, though I don't like that insinuation in that side note. Maybe you need to read my comment https://hackerone.com/reports/362702#activity-2894646 again.\n\nThank you for your contribution in triaging the security report.","markdown_message":"\u003cp\u003e\u003ca href=\"/bougakovgeorge\"\u003e@bougakovgeorge\u003c/a\u003e I appreciate your involvement in the conversation, though I don\u0026#39;t like that insinuation in that side note. Maybe you need to read my comment \u003ca title=\"https://hackerone.com/reports/362702#activity-2894646\" href=\"https://hackerone.com/reports/362702#activity-2894646\"\u003ehttps://hackerone.com/reports/362702#activity-2894646\u003c/a\u003e again.\u003c/p\u003e\n\n\u003cp\u003eThank you for your contribution in triaging the security report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T19:00:58.359Z","updated_at":"2018-07-01T19:00:58.359Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2969088,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I didn’t mean to insult anyone, but Ibrahim wrote the exact thing I included in the side note. Is there any way I can leave this conversation because I am totally the wrong guy to be here. I am not a maintainer, I don’t even have write access to the repo, so can you please exclude me from this mailing list?","markdown_message":"\u003cp\u003eI didn’t mean to insult anyone, but Ibrahim wrote the exact thing I included in the side note. Is there any way I can leave this conversation because I am totally the wrong guy to be here. I am not a maintainer, I don’t even have write access to the repo, so can you please exclude me from this mailing list?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T20:32:07.999Z","updated_at":"2018-07-01T20:32:07.999Z","actor":{"username":"ba3142c38d7de2241d2c522","cleared":false,"url":"/ba3142c38d7de2241d2c522","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2969157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, I'll go ahead and remove you from the thread.\nThanks for joining in the first place and willing to help!\n","markdown_message":"\u003cp\u003eSure, I\u0026#39;ll go ahead and remove you from the thread.\u003cbr\u003e\nThanks for joining in the first place and willing to help!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-01T21:26:00.915Z","updated_at":"2018-07-01T21:26:00.915Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2969160,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-01T21:26:10.902Z","updated_at":"2018-07-01T21:26:10.902Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/ba3142c38d7de2241d2c522","username":"ba3142c38d7de2241d2c522"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2998151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lirantal as you could noticed, four days ago  I tried to reach out the owner of the module on twitter, no response yet. This morning I sent him a message on facebook waiting for a feedback. I think that's the best I can do in this situation.  ","markdown_message":"\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e as you could noticed, four days ago  I tried to reach out the owner of the module on twitter, no response yet. This morning I sent him a message on facebook waiting for a feedback. I think that\u0026#39;s the best I can do in this situation.  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T08:22:45.129Z","updated_at":"2018-07-06T08:22:45.129Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2999158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agree.\nShould we go ahead and resolve this report as informative and disclose it?","markdown_message":"\u003cp\u003eAgree.\u003cbr\u003e\nShould we go ahead and resolve this report as informative and disclose it?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T10:16:15.081Z","updated_at":"2018-07-06T10:16:15.081Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2999466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, go ahead.","markdown_message":"\u003cp\u003eYes, go ahead.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T10:33:50.577Z","updated_at":"2018-07-06T10:33:50.577Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2999477,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Closing report.","markdown_message":"\u003cp\u003eClosing report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T10:37:11.446Z","updated_at":"2018-07-06T10:37:11.446Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2999478,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-06T10:37:28.097Z","updated_at":"2018-07-06T10:37:28.097Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3000160,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-06T13:34:36.773Z","updated_at":"2018-07-06T13:34:36.773Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3000161,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-06T13:34:36.894Z","updated_at":"2018-07-06T13:34:36.894Z","actor":{"username":"b9b86c2fc8409c628fb3de6","cleared":false,"url":"/b9b86c2fc8409c628fb3de6","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}