{"id":44217,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDIxNw==","url":"https://hackerone.com/reports/44217","title":"Application XSS filter function Bypass may allow Multiple stored XSS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-18T10:18:23.387Z","submitted_at":"2015-01-18T10:18:23.387Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"securityidiots","url":"/securityidiots","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-06-28T15:50:24.029Z","bug_reporter_agreed_on_going_public_at":"2015-05-29T15:50:03.272Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nAs i analysed the application behavior and the security structure, i found out that the application is using \"Greedy XSS Regex filter\" against XSS and removes any the whole string from '\u003c' to '\u003e'. So i tried some basic bypass which allowed me to insert tags and other characters into the string.\r\n\r\nHere is the the payload:\r\n\u003c%0crameset%20src=''\u003e \r\n\r\nNow if we see the whole application is using same filter against XSS which makes this bypass to be universally working on nearly all the input fields, which means we can say an attacker can successfully bypass and enter XSS payload in database but when the string prints in the frontend there is another filter, which encode all html entities before printing.\r\n\r\nNice but now enough as many of the inputs could in the below condition will end up with a successful XSS exploitation.\r\n1. Input under javascript.\r\n2. Any string not properly encoded before printing.\r\n3. JSON output with HTML headers.\r\n\r\nI have already reported some issues in vimeo where input injected directly into javascript and do not need any html characters, another issue of JSON output with HTML headers. \r\n\r\nBelow you can see both reports:\r\nhttps://hackerone.com/reports/43934\r\nhttps://hackerone.com/reports/44215\r\n\r\nIn the first screenshot you can see profile update request where i updates my profile and injected those HTML characters, in second screenshot you can see it injected in the response as stored XSS.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":27291,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/291/7903324a132a49983c17a10bf5f1839dcea86cdc/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150047Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5417b0f0d083e3e95f2eeb33deeda4e8487b844d358d6823554ecc3975c19727","file_size":56986,"type":"image/png"},{"id":27292,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/027/292/21a28db1a5002c0f15c809764c5b39a7d4202c21/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150047Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a0233b7802af861be99c5a3b839493754618ba9089c8779f080acbe68defc106","file_size":65879,"type":"image/png"}],"allow_singular_disclosure_at":"2015-06-28T15:50:04.097Z","allow_singular_disclosure_after":-198457843.72716218,"singular_disclosure_allowed":true,"vote_count":6,"voters":["mpz","eveeez","vulnh0lic","japz","spetr0x","shahmeer-amir"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":330542,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@securityidiots, can you provide reproduction steps for arbitrary XSS (instead of the frameset)? I've tried your example and it appears that it's being properly encoded at least on my profile page settings. ","automated_response":false,"created_at":"2015-02-11T23:01:56.000Z","updated_at":"2015-02-11T23:01:56.000Z","actor":{"username":"mandatory","cleared":false,"url":"/mandatory","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":332391,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Its already patched","automated_response":false,"created_at":"2015-02-14T21:59:07.083Z","updated_at":"2015-02-14T21:59:07.083Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340473,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Looks like this was patched by a separate fix.","automated_response":false,"created_at":"2015-02-26T03:53:44.213Z","updated_at":"2015-02-26T03:53:44.213Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"securityidiots","url":"/securityidiots"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":393942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks Like Vimeo Resolved 3 Bugs Long Back , None Deserves For a Bounty? ","automated_response":false,"created_at":"2015-04-29T12:01:57.836Z","updated_at":"2015-04-29T12:01:57.836Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":396009,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\n@naren @andrewp Vimeo have resolved the bugs and still atfer a long wait i havent received any bounty. please let me know the reason for such a long delay.\n\nhttps://hackerone.com/reports/44157\nhttps://hackerone.com/reports/44217\nhttps://hackerone.com/reports/44239\n","automated_response":false,"created_at":"2015-05-01T11:03:37.790Z","updated_at":"2015-05-01T11:03:37.790Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":431476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewp hello sleeping beauty!! time to wake up","automated_response":false,"created_at":"2015-05-29T07:40:57.412Z","updated_at":"2015-05-29T07:40:57.412Z","actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":432213,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-05-29T15:50:03.315Z","updated_at":"2015-05-29T15:50:03.315Z","first_to_agree":true,"actor":{"username":"securityidiots","cleared":false,"url":"/securityidiots","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/651/6b855209ff953c324d792a42e83f85b355e296cb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":494536,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-06-28T15:50:24.151Z","updated_at":"2015-06-28T15:50:24.151Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1430295,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-01-19T15:10:54.433Z","updated_at":"2017-01-19T15:10:54.433Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"securityidiots","url":"/securityidiots"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}