{"id":54327,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDMyNw==","url":"https://hackerone.com/reports/54327","title":"Persistent cross-site scripting (XSS) in map attribution","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-02T00:56:42.619Z","submitted_at":"2015-04-02T00:56:42.619Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ph3t","url":"/ph3t","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-1000042"],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-30T20:59:53.184Z","bug_reporter_agreed_on_going_public_at":"2016-03-01T15:03:35.245Z","team_member_agreed_on_going_public_at":"2016-03-30T20:59:52.799Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nI have found a Persistent Cross Site Scripting vulnerability when using a custom style uploaded by myself.\r\n\r\nMapbox Studio allows create and upload styles for your maps. So if we create a new style with javascript code as attribution value it will be executed when loading a map that uses our evil style. I used the following javascript code for testing:\r\n\u003e\"\u003e\u003cimg src=x onerror=alert(document.cookie)\u003e\r\n\r\nTo reproduce this vulnerability you must download the Mapbox Studio from [here](https://www.mapbox.com/mapbox-studio/). Then you must write a random name and description. In the Attribution field you must inject the javascript code you want to execute. Save the changes again, upload the project and close the Mapbox Studio.\r\nNow, log into your Mapbox account and go to Styles, select the style you have just created, this will expand the div, and click on \"New project\". The code will be already executed, but the vulnerability is not as much exploitable as we want.\r\nWe want everybody can execute our javascript code so, choose the settings you want in the project we created and save it. Go to your [project list](https://www.mapbox.com/projects/) and search the project we have just saved. If we share this project, everybody who access to it will execute the code we have injected, including people without Mapbox account.\r\n\r\nPoC: https://api.tiles.mapbox.com/v4/pr0ph3t.lkag551j/page.html?access_token=pk.eyJ1IjoicHIwcGgzdCIsImEiOiJuRlQ1RDk0In0.qWRU_9DCEAMsAYIEpNTpnw#3/0.00/0.00\r\n\r\nDemo video: https://youtu.be/NHjTqjndRik\r\n\r\nRegards,\r\nJuan Broull√≥n Sampedro.","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-31T15:03:35.606Z","allow_singular_disclosure_after":-174528405.70563495,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sw33tlie","ph3t","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":369410,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Juan, thank you for the report. I can confirm this issue and we have started to work on a fix.","automated_response":false,"created_at":"2015-04-02T18:41:51.336Z","updated_at":"2015-04-02T18:41:51.336Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":370992,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Juan,\n\nWe determined that this is vulnerability in one of our JavaScript libraries, Mapbox.js. We'll be making a public release of this library shortly. In the meantime, we've deployed an internal fix for this issue on the project share page. Can you verify that the project share page is no longer vulnerable?\n\nThanks again for the report.","automated_response":false,"created_at":"2015-04-03T17:06:55.823Z","updated_at":"2015-04-03T17:06:55.823Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, \n\nI still can execute the XSS as you can see in the attached image.\n\nRegards!","automated_response":false,"created_at":"2015-04-03T19:25:51.453Z","updated_at":"2015-04-03T19:25:51.453Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":33682,"filename":"Captura_de_pantalla_2015-04-03_a_las_21.23.31.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/682/9382f60e5e099db32cd1383a2a7805dd32aacf23/Captura_de_pantalla_2015-04-03_a_las_21.23.31.png?response-content-disposition=attachment%3B%20filename%3D%22Captura_de_pantalla_2015-04-03_a_las_21.23.31.png%22%3B%20filename%2A%3DUTF-8%27%27Captura_de_pantalla_2015-04-03_a_las_21.23.31.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ba1d5c81e35ad40d5705dbff39644e41061bc227ee5fddb28b288dff809da4b2"}],"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about that, I think some of our CDN nodes did not have their caches invalidated. Would you mind trying again?","automated_response":false,"created_at":"2015-04-03T21:08:03.954Z","updated_at":"2015-04-03T21:08:03.954Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371268,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem!\n\nI have tried with other payloads also and the javascript is correctly filtered in the shared page, but it is being executed in the editor following the same steps.\n\nI have attached a screenshot.","automated_response":false,"created_at":"2015-04-03T21:31:46.454Z","updated_at":"2015-04-03T21:31:46.454Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":33698,"filename":"Captura_de_pantalla_2015-04-03_a_las_23.29.43.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/698/ef968c47049d42ea0e934176ae6b758455913c05/Captura_de_pantalla_2015-04-03_a_las_23.29.43.png?response-content-disposition=attachment%3B%20filename%3D%22Captura_de_pantalla_2015-04-03_a_las_23.29.43.png%22%3B%20filename%2A%3DUTF-8%27%27Captura_de_pantalla_2015-04-03_a_las_23.29.43.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151021Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=10f0cc12528a40038921594440644220bbc0e8afbd9c3216421472b66d132cc3"}],"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you, I had missed that you reported the editor as vulnerable in your original report. I've rolled out a fix there, and we are currently reviewing if any other pages on www.mapbox.com are affected.","automated_response":false,"created_at":"2015-04-03T22:10:59.736Z","updated_at":"2015-04-03T22:10:59.736Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":371298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry if I didn't say clearly it was vulnerable, I focused the report in the final map vulnerability.","automated_response":false,"created_at":"2015-04-03T22:15:00.031Z","updated_at":"2015-04-03T22:15:00.031Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":373676,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your patience. We are now preparing a public release of Mapbox.js which includes sanitization of the incoming attribution. As an additional precaution, we are adding sanitization of the attribution in the map data API which Mapbox.js uses.","automated_response":false,"created_at":"2015-04-06T22:21:00.921Z","updated_at":"2015-04-06T22:21:00.921Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":373681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're welcome, let me know when you upload it and I will continue testing.","automated_response":false,"created_at":"2015-04-06T22:26:24.760Z","updated_at":"2015-04-06T22:28:08.879Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":375759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e As an additional precaution, we are adding sanitization of the attribution in the map data API which Mapbox.js uses.\n\nThis has now been deployed.\n\nWe have also released Mapbox.js versions 2.1.7 and 1.6.5, making public the mitigations that were previously applied to the editor and share pages. In certain uncommon scenarios (using `L.mapbox.map` or `L.mapbox.tileLayer` to load untrusted TileJSON content from a non-Mapbox URL), users of Mapbox.js could be vulnerable to this XSS vector even after the API-level mitigations. I've sent a security advisory covering those scenarios to nodesecurity.io.\n\nI now consider this fully resolved on our end. Is there anything else you want to confirm or add?","automated_response":false,"created_at":"2015-04-09T00:22:33.256Z","updated_at":"2015-04-09T00:22:33.256Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":375893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it's fixed.","automated_response":false,"created_at":"2015-04-09T06:26:05.669Z","updated_at":"2015-04-09T06:26:05.669Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":376109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-04-09T16:54:27.844Z","updated_at":"2015-04-09T16:54:27.844Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ph3t","url":"/ph3t"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":376111,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2015-04-09T16:55:16.769Z","updated_at":"2015-04-09T16:55:16.769Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mapbox"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"ph3t","url":"/ph3t"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818909,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-01T15:03:35.276Z","updated_at":"2016-03-01T15:03:35.276Z","first_to_agree":true,"actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":836578,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May I disclose this vulnerability?\n\nThank you.","automated_response":false,"created_at":"2016-03-12T14:47:46.955Z","updated_at":"2016-03-12T14:47:46.955Z","actor":{"username":"ph3t","cleared":false,"url":"/ph3t","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/684/6cad2fe0171fe59a58e987bf54392e21f1e54242_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878836,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-03-30T20:38:49.413Z","updated_at":"2016-03-30T20:38:49.413Z","additional_data":{"old_title":"Mapbox Persistent Cross Site Scripting using custom styles","new_title":"Persistent cross-site scripting (XSS) in map attribution"},"actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":878883,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-03-30T20:59:52.823Z","updated_at":"2016-03-30T20:59:52.823Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":878884,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-30T20:59:53.207Z","updated_at":"2016-03-30T20:59:53.207Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1574,"category":"team","content":"@ph3t reported a persistent cross-site scripting (XSS) issue in the [map attribution](https://www.mapbox.com/help/attribution/) control for Mapbox.js maps. This allowed a potential attacker to have full control over a user's Mapbox.com session and execute arbitrary JavaScript commands. It also allowed for the execution of arbitrary JavaScript in websites using Mapbox.js with the uncommon usage scenario of loading untrusted TileJSON.\n\n@ph3t's proof of concept used our [Mapbox Studio Classic](https://www.mapbox.com/mapbox-studio-classic/) desktop application to add a custom attribution with an XSS payload (`\"\u003e\u003cimg src=\"x onerror=alert(document.cookie)\u003e`) to a custom map style. @ph3t then uploaded the custom style to their account on mapbox.com and created a new project using the malicious style. Saving the project allowed @ph3t to send a URL of the project with the executable XSS payload to a potential victim.\n\nBy default the attribution control contains a link to Mapbox (`\"\u003ca href=\"https://www.mapbox.com\u003eMapbox\u003c/a\u003e\"`). Support for HTML in the map attribution is necessary and after @ph3t's report, we first deployed a patch to our mapping API for server-side sanitization of user-provided attribution controls. We also released a [client-side sanitization fix](https://github.com/mapbox/mapbox.js/commit/538d229ab6767bb4c3f3969c417f9884189c1512) in Mapbox.js v2.1.7 and v1.6.5 to mitigate the uncommon usage scenario of using untrusted TileJSON. The patches used [sanitize-caja](https://github.com/mapbox/sanitize-caja) to sanitize any script content added to the [attribution property](https://github.com/mapbox/tilejson-spec/blob/adde70cde80ebfdb9609980750691edc3f7492ef/2.1.0/schema.json#L19-L21) of untrusted TileJSON.\n\nAdditional details can be found in the [Node Security project advisory](https://nodesecurity.io/advisories) submitted for this issue, [#49 - Content Injection via TileJSON attribute](https://nodesecurity.io/advisories/49).","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":39856,"username":"alulsh","name":"Alexandra Ulsh","bio":"","cleared":false,"website":"http://alexandraulsh.com","location":"Washington, D.C.","created_at":"2015-09-09T10:35:58.141Z","url":"https://hackerone.com/alulsh","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBZzhYIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--86d585e59347ae653fd2545d196c1547468212a4/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/IMG_5872.JPG"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}