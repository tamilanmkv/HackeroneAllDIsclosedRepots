{"id":618031,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MTgwMzE=","url":"https://hackerone.com/reports/618031","title":"Stored XSS in Discounts section","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-18T09:14:02.574Z","submitted_at":"2019-06-18T09:14:02.574Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mosuan","url":"/mosuan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/119/698/8130fe2599fbd3053111d0cadc59a024e8d028ff_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-27T15:00:15.658Z","bug_reporter_agreed_on_going_public_at":"2019-06-27T07:21:18.986Z","team_member_agreed_on_going_public_at":"2019-06-27T15:00:14.763Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"self-xss\n\n## Impact\n\n1.add `Products`, shop name is '\"'\u003e\u003cimg src=x onerror=alert(domain.domain)\u003e'\n2.click `Discounts-\u003ecode`, https://mosuan-img-src-x.myshopify.com/admin/discounts/367541518396\n3.add comments, Choose the goods just now.\n4.alert","vulnerability_information_html":"\u003cp\u003eself-xss\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e1.add \u003ccode\u003eProducts\u003c/code\u003e, shop name is \u0026#39;\u0026quot;\u0026#39;\u0026gt;\u0026lt;img src=x onerror=alert(domain.domain)\u0026gt;\u0026#39;\u003cbr\u003e\n2.click \u003ccode\u003eDiscounts-\u0026gt;code\u003c/code\u003e, \u003ca title=\"https://mosuan-img-src-x.myshopify.com/admin/discounts/367541518396\" href=\"/redirect?url=https%3A%2F%2Fmosuan-img-src-x.myshopify.com%2Fadmin%2Fdiscounts%2F367541518396\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mosuan-img-src-x.myshopify.com/admin/discounts/367541518396\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n3.add comments, Choose the goods just now.\u003cbr\u003e\n4.alert\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":511301,"file_name":"1560849217964.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/511/301/68e423fef295baacbb22942dbe228a053d9ff1c7/1560849217964.jpg?response-content-disposition=attachment%3B%20filename%3D%221560849217964.jpg%22%3B%20filename%2A%3DUTF-8%27%271560849217964.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063027Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=d848aba9eb59110892c7575b0ddcacddc4ba8e89b801f91e24918e74c22da1e4","file_size":269139,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":72,"voters":["webhak","secator","spam404","sameerphad72","zeroxyele","mygf","tungpun","masonhck357","imranhudaa","cr4xerbik4sh","and 62 more..."],"severity":{"rating":"medium","score":6.2,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5119972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry, my english is very poor","markdown_message":"\u003cp\u003esorry, my english is very poor\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-18T09:15:00.712Z","updated_at":"2019-06-18T09:15:00.712Z","actor":{"username":"mosuan","cleared":false,"url":"/mosuan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/119/698/8130fe2599fbd3053111d0cadc59a024e8d028ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5120656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"goods name is '\"'\u003e\u003cimg src=x onerror=alert(domain.domain)\u003e'","markdown_message":"\u003cp\u003egoods name is \u0026#39;\u0026quot;\u0026#39;\u0026gt;\u0026lt;img src=x onerror=alert(domain.domain)\u0026gt;\u0026#39;\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-18T09:37:04.820Z","updated_at":"2019-06-18T09:37:04.820Z","actor":{"username":"mosuan","cleared":false,"url":"/mosuan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/119/698/8130fe2599fbd3053111d0cadc59a024e8d028ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5121928,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and our engineering team is investigating.","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue, and our engineering team is investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-18T13:50:34.653Z","updated_at":"2019-06-18T13:50:34.653Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5122155,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding an initial amount of $500, and will award the remainder (if any) once the issue is resolved.","markdown_message":"\u003cp\u003eThanks again for your report. We\u0026#39;re awarding an initial amount of $500, and will award the remainder (if any) once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-18T14:30:35.062Z","updated_at":"2019-06-18T14:30:35.062Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"mosuan","url":"/mosuan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5122157,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-18T14:30:57.784Z","updated_at":"2019-06-18T14:30:57.784Z","additional_data":{"old_title":"self-xss","new_title":"Stored XSS in Discounts section"},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5161498,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We recently deployed a fix for this issue, so the bug should no longer be reproducible. We'll be in touch with you soon regarding a final bounty amount.","markdown_message":"\u003cp\u003eWe recently deployed a fix for this issue, so the bug should no longer be reproducible. We\u0026#39;ll be in touch with you soon regarding a final bounty amount.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-21T14:57:51.853Z","updated_at":"2019-06-21T14:57:51.853Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mosuan","url":"/mosuan"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5162151,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding an additional $500 for a total bounty of $1,000. We look forward to hearing from you again soon. Happy hacking!","markdown_message":"\u003cp\u003eWe\u0026#39;re awarding an additional $500 for a total bounty of $1,000. We look forward to hearing from you again soon. Happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-21T15:43:22.605Z","updated_at":"2019-06-21T15:43:22.605Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"mosuan","url":"/mosuan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5187336,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.","markdown_message":"\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-25T07:56:45.278Z","updated_at":"2019-06-25T07:56:45.278Z","actor":{"username":"mosuan","cleared":false,"url":"/mosuan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/119/698/8130fe2599fbd3053111d0cadc59a024e8d028ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5203736,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T07:21:19.022Z","updated_at":"2019-06-27T07:21:19.022Z","first_to_agree":true,"actor":{"username":"mosuan","cleared":false,"url":"/mosuan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/119/698/8130fe2599fbd3053111d0cadc59a024e8d028ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5206928,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T15:00:14.876Z","updated_at":"2019-06-27T15:00:14.876Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5206929,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T15:00:15.692Z","updated_at":"2019-06-27T15:00:15.692Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":16979,"category":"team","content":"We recently deployed changes to our discount timelines and @mosuan identified that product names were no longer being properly escaped. This resulted in a stored XSS vulnerability when a product with an XSS payload was referenced in the comments for a discount code. This was a valid XSS within the scope of our program because it executed outside of the rich text and theme editors on `/admin` of the store. It was awarded $1000 because exploitation would require access to a staff account with `discounts` permission.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe recently deployed changes to our discount timelines and \u003ca href=\"/mosuan\"\u003e@mosuan\u003c/a\u003e identified that product names were no longer being properly escaped. This resulted in a stored XSS vulnerability when a product with an XSS payload was referenced in the comments for a discount code. This was a valid XSS within the scope of our program because it executed outside of the rich text and theme editors on \u003ccode\u003e/admin\u003c/code\u003e of the store. It was awarded $1000 because exploitation would require access to a staff account with \u003ccode\u003ediscounts\u003c/code\u003e permission.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}