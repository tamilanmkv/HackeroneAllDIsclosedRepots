{"id":685552,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODU1NTI=","url":"https://hackerone.com/reports/685552","title":"XSS in desktop client via invalid server address on login form","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-08-31T15:16:17.398Z","submitted_at":"2019-08-31T15:16:17.398Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jplopezy","url":"/jplopezy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/115/148192f6ec8b1f75f8c9b4c1c8d9be6782aab7c0_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8189"],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-17T00:50:32.231Z","bug_reporter_agreed_on_going_public_at":"2020-08-17T00:50:32.123Z","team_member_agreed_on_going_public_at":"2020-08-05T08:46:59.663Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Team!\n\nI have found this vulnerability that in my time would be called \"cross zone\" but at the moment I don't know.\n\nThe problem is found in the latest version of \"nextcloud.exe\" for your windows version.\n\nThe problem occurs with the initial screen where you ask to connect to a website.\n\nApparently when you put an invalid URI that generates some type of response code like 403, it is reported in a small window, as if it were an alert box, not in the main.\n\nThis \"alert box\" visualizes the response and to my impression (that's why I said the cross zone) has a little more permissions than the internet explorer.\n\nFor example, if the response code has an \u003cS\u003e test\u003c/S\u003e it will interpret it as IE does.\n\nThat's fine, it would only be an html injection.\n\nThe problem, for example, is that it allows you to run a file like the calculator locally without any confirmation.\n\nThis vector works : \u003cA HREF=\"file:///C:/WINDOWS/system32/calc.exe\"\u003eCALC.EXE\u003c/A\u003e\n\nIn my opinion, response code errors are a problem and must be controlled by the application.\n\nFor the demonstration use the burp.\n\nBut basically any personal site where the response code building could be controlled could exploit it.\n\nI attach a video to make everything clearer.\n\n## Impact\n\nThe impact is that you can run local files without authorization (of the application) in a context where you should warn.\n\nIt should be filtered so as not to disturb that it is a vector.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":571293,"file_name":"nextcloud.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/eAe6Aitre3r5FKfjpjomhU1U?response-content-disposition=attachment%3B%20filename%3D%22nextcloud.webm%22%3B%20filename%2A%3DUTF-8%27%27nextcloud.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151739Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=89058285a97d29bfd7c9c853b9552a22f4ba9a6dd1af75fcbad4c35a4cb846f4","file_size":13665823,"type":"video/webm"}],"allow_singular_disclosure_at":"2020-09-04T08:46:59.778Z","allow_singular_disclosure_after":-34756239.70439438,"singular_disclosure_allowed":true,"vote_count":16,"voters":["zzero","mashoud1122","mik317","xko2x","khizer47","sa1tama0","nhlanhla_dludlu","imlefty","taskkill","mr0bart","and 6 more..."],"severity":{"rating":"medium","score":4.7,"author_type":"Team","metrics":{"attack_vector":"physical","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":77,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Desktop Client","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5704995,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-08-31T15:16:17.693Z","updated_at":"2019-08-31T15:16:17.693Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5717283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @jplopezy,\n\nThanks for your report.\nWe are working with our desktop team to look into this.\n\nWe'll keep you posted.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2019-09-03T11:25:13.746Z","updated_at":"2019-09-03T11:25:13.746Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5737230,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-09-05T10:16:29.388Z","updated_at":"2019-09-05T10:16:29.388Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6211538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I hope you are well! something new ?","automated_response":false,"created_at":"2019-11-04T13:07:46.855Z","updated_at":"2019-11-04T13:07:46.855Z","actor":{"username":"jplopezy","cleared":true,"url":"/jplopezy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/115/148192f6ec8b1f75f8c9b4c1c8d9be6782aab7c0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7384170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jplopezy \n\nSo we had some discussion how to fix this. The issue is that in some cases it could have useful information.\nHowever we decided that it is probably better to just remove the message box.\n\nThe PR to do this is in https://github.com/nextcloud/desktop/pull/1885\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2020-03-21T09:10:05.582Z","updated_at":"2020-03-21T09:10:05.582Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8240973,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved for our next maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2020-06-09T09:45:46.446Z","updated_at":"2020-06-09T09:45:46.446Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jplopezy","url":"/jplopezy"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8242631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Name / Pseudonym : Juan Pablo Lopez Yacubian","automated_response":false,"created_at":"2020-06-09T13:09:04.393Z","updated_at":"2020-06-09T13:09:04.393Z","actor":{"username":"jplopezy","cleared":true,"url":"/jplopezy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/115/148192f6ec8b1f75f8c9b4c1c8d9be6782aab7c0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8402818,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-25T06:52:40.163Z","updated_at":"2020-06-25T06:52:40.163Z","additional_data":{"old_severity":null,"new_severity":"Medium (4.7)","old_severity_id":null,"new_severity_id":760400},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8402864,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-06-25T07:00:36.873Z","updated_at":"2020-06-25T07:00:36.873Z","additional_data":{"old_title":"Uncontrolled Response Code Html Injection","new_title":"XSS in desktop client via invalid server address on login form"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8402893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"SA will be published at https://nextcloud.com/security/advisory/?id=NC-SA-2020-027\nRequested CVE: CVE-2020-8189","automated_response":false,"created_at":"2020-06-25T07:03:53.481Z","updated_at":"2020-06-25T07:03:53.481Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8402895,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-06-25T07:04:01.796Z","updated_at":"2020-06-25T07:04:01.796Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"jplopezy","url":"/jplopezy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8851688,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-05T08:46:59.689Z","updated_at":"2020-08-05T08:46:59.689Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8951741,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-17T00:50:32.177Z","updated_at":"2020-08-17T00:50:32.177Z","actor":{"username":"jplopezy","cleared":true,"url":"/jplopezy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/115/148192f6ec8b1f75f8c9b4c1c8d9be6782aab7c0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8951742,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-17T00:50:32.300Z","updated_at":"2020-08-17T00:50:32.300Z","actor":{"username":"jplopezy","cleared":true,"url":"/jplopezy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/115/148192f6ec8b1f75f8c9b4c1c8d9be6782aab7c0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}