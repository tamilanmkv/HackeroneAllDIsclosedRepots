{"id":87835,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzgzNQ==","url":"https://hackerone.com/reports/87835","title":"Webview Vulnerablity [OwnCloudAndroid Application] ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-07T11:57:09.447Z","submitted_at":"2015-09-07T11:57:09.447Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"avicoder_","url":"/avicoder_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2013-4710"],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-11T07:04:45.321Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-09-11T07:04:40.170Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi **OwnCloud Team** ,\r\n\r\n###Vulnerability Description:###\r\n\r\n**What is Webview?:** We can load a remote URL or display HTML pages stored in our application within an activity using WebView. Internally it uses WebKit rendering engine to display web pages. It supports methods to navigate forward and backward, text searches, etc. It has some nice features such as support for the usage of JavaScript.\r\n\r\n###Where I found it?###\r\n\r\nIn **SamlWebViewDialog.java.class** located under the path ` android/src/com/owncloud/android/ui/dialog/` \r\n\r\nI clipped the important code which introduced this vulnerability in your app.\r\n\r\n            if (mSsoWebView == null) {\r\n            // initialize the WebView\r\n            mSsoWebView = new SsoWebView(getActivity().getApplicationContext());\r\n            mSsoWebView.setFocusable(true);\r\n            mSsoWebView.setFocusableInTouchMode(true);\r\n            mSsoWebView.setClickable(true);\r\n            \r\n            WebSettings webSettings = mSsoWebView.getSettings();\r\n            webSettings.setJavaScriptEnabled(true);\r\n            webSettings.setBuiltInZoomControls(false);\r\n            webSettings.setLoadWithOverviewMode(false);\r\n            webSettings.setSavePassword(false);\r\n            webSettings.setUserAgentString(MainApp.getUserAgent());\r\n            webSettings.setSaveFormData(false);\r\n            \r\n            CookieManager cookieManager = CookieManager.getInstance();\r\n            cookieManager.setAcceptCookie(true);\r\n            cookieManager.removeAllCookie();\r\n            \r\n            mSsoWebView.loadUrl(mInitialUrl);\r\n        }\r\n        \r\n\r\nhere you can see that:\r\n\r\n    `webSettings.setJavaScriptEnabled(true);`\r\n\r\nThe *WebView* Object been activated to parse javascript inside it.\r\n\r\n**However by default when we create an WebView object JavaScript is disabled by default until and unless it explicitly declare by the developer.** \r\n\r\nThe untrusted Javascript code can call into the Java Reflection APIs exposed by the Interface and execute arbitrary commands. Some distributions of the Android Browser app have an addJavascriptInterface call tacked on, and thus are vulnerable to RCE.\r\n\r\n###Mitigation:###\r\n\r\nIf you turn off the setJavaScriptEnabled as follows, adversaries will not be able to run any JavaScript in order to perform XSS \r\n`webSettings.setJavaScriptEnabled(False);`\r\n\r\n\r\n###SEVERITY: High ###\r\n\r\nIt is not just limited to XSS because of javascript ! In fact, using this, an attacker can even use JavaScript to invoke certain methods on the phone, such as sending an SMS to another number, making a call, or even getting a remote shell using tools such as Drozer.\r\n\r\n**I highly recommend my article on github for the mitgation and understanding of the attack**\r\n\r\n##https://github.com/vjex/WriteUp/blob/master/WebviewVuln.md##\r\n\r\n###More References:###\r\n\r\n   - http://www.wintellect.com/devcenter/paulballard/new-report-sites-significant-security-vulnerabilities-in-android-devices\r\n   - http://www.cvedetails.com/cve/CVE-2013-4710/\r\n   - https://community.rapid7.com/community/metasploit/blog/2015/01/02/2014-a-year-of-android-exploits-in-metasploit\r\n   - https://github.com/jduck/VulnWebView/\r\n\r\n**Happy to help.**\r\nCheers\r\n#:)#\r\n\r\n@avicoder","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-11T07:04:44.827Z","allow_singular_disclosure_after":-189419552.295087,"singular_disclosure_allowed":true,"vote_count":2,"voters":["amohar","ceortiz"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":579679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","automated_response":true,"created_at":"2015-09-07T11:57:11.647Z","updated_at":"2015-09-07T11:57:11.647Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One more thing I want to make you aware of , you should also disable File System Access:\n\nReason : If an attacker somehow find themselves in a position to inject script into a WebView, then they could exploit the opportunity to access local resources. This can be somewhat prevented by disabling local file system access. It is enabled by default. The Android WebSettings class can be used to disable local file system access via the public method setAllowFileAccess.\n\nwebSettings().setAllowFileAccess(false);\n\nThis restricts the WebView to loading local resources from `file:///android_asset (assets) and file:///android_res (resources).`\n","automated_response":false,"created_at":"2015-09-07T11:58:54.425Z","updated_at":"2015-09-07T11:58:54.425Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579705,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Please note that the `SamlWebViewDialog.java` actually requires Javascript since some Shibboleth / SAML endpoints do actually require JS. Note that these endpoints are considered trusted,  furthermore this functionality needs to be enabled while compiling the application manually.\n\nWith regard to your second comment this applies to be a valid hardening we do however consider endpoints trusted at the moment which means that this would not qualify for a reward. We would however mark the `setAllowFileAccess` issue has applicable (which would give you positive reputation) if you would open a new dedicated issue for this one.","automated_response":false,"created_at":"2015-09-07T12:21:51.988Z","updated_at":"2015-09-07T12:21:51.988Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579712,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the reply.\nIf endpoint are trusted then there is no problem..\n\nI also raise an issue about this ,so I can contribute to it a little. \n Issue # 1143","automated_response":false,"created_at":"2015-09-07T12:30:02.277Z","updated_at":"2015-09-07T12:30:02.277Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And also once it is fixed you can resolve this issue , It is not needed to open other issue just for that! ","automated_response":false,"created_at":"2015-09-07T12:59:33.107Z","updated_at":"2015-09-07T12:59:33.107Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579750,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Fair enough ðŸ˜€","automated_response":false,"created_at":"2015-09-07T13:09:20.901Z","updated_at":"2015-09-07T13:09:20.901Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579751,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Triaged to https://github.com/owncloud/android/issues/1143","automated_response":false,"created_at":"2015-09-07T13:09:35.551Z","updated_at":"2015-09-07T13:09:46.955Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess the recent commit on this issue fixed this bug . you can resolve it or so.","automated_response":false,"created_at":"2015-09-07T14:28:27.254Z","updated_at":"2015-09-07T14:28:44.062Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":579849,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-09-07T14:29:19.217Z","updated_at":"2015-09-07T14:29:19.217Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"avicoder_","url":"/avicoder_"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":584746,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-11T07:04:40.199Z","updated_at":"2015-09-11T07:04:40.199Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":584760,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You should have ask it before ! :/","automated_response":false,"created_at":"2015-09-11T07:06:14.973Z","updated_at":"2015-09-11T07:10:19.497Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":616720,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-10-11T07:04:45.360Z","updated_at":"2015-10-11T07:04:45.360Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":656494,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Thanks a lot for your report. Please note that for the time being we do not award monetary rewards for bugs reported for our own website and infrastructure.\n\nFrom our FAQ:\n\u003e **Q: Why do you exclude the ownCloud websites and infrastructure?**\n\u003e A: For the time being we want to focus our efforts on ownCloud Server instead of vulnerabilities within our website and infrastructure. However, if you find a security bug in our website or infrastructure we welcome any report, though we cannot offer a monetary incentive.\n\nIf you want to ensure that your submission are in-scope you might want to try the code available from https://owncloud.org/install/","automated_response":false,"created_at":"2015-11-13T11:26:54.767Z","updated_at":"2015-11-13T11:26:54.767Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":656938,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"who ask for bounty? :-)","automated_response":false,"created_at":"2015-11-13T17:40:44.424Z","updated_at":"2015-11-13T17:40:44.424Z","actor":{"username":"avicoder_","cleared":false,"url":"/avicoder_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/616/e4186599991ee4dc35358328f7ed273ef1b99315_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}