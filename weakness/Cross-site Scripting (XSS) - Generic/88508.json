{"id":88508,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODUwOA==","url":"https://hackerone.com/reports/88508","title":"XSS when using captions/subtitles on video player based on Flash (requires user interaction)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-11T16:55:43.845Z","submitted_at":"2015-09-11T16:55:43.845Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-31T10:27:29.285Z","bug_reporter_agreed_on_going_public_at":"2017-08-01T10:27:24.173Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Description__\r\n\r\nThe video player based on Flash (not the HTML5 one), shows the captions/subtitles without escaping. This allows to upload a file with captions/subtitles with HTML code, because the content of the file is not escaped when it's stored.\r\nThe way to force the use of the Flash player is using the widget Hubnut, because on Chrome for example the default player is the HTML5 one.\r\n\r\n__Proof of concept__\r\n\r\n1. For easy reproduction of the proof of concept, create a new account or delete every video in your account or make every video private.\r\n2. Upload a video or use an existing video.\r\n3. Go to the Settings of the video.\r\n4. Click on the tab _Advanced_.\r\n5. Download the file _English.vtt_ that I attached to the report.\r\n6. In the section \"Add Captions \u0026 Subtitles\", click on _Choose file_.\r\n7. Select the file you downloaded in step 5.\r\n8. When the file is uploaded, click on _OFF_ in the column _Status_. The value should change to _ON_.\r\n9. Select _English_ in the column _Language_.\r\n10. Select _Captions_ in the column _Type_.\r\n11. Click on _Save Changes_.\r\n12. Using other account, go to https://player.vimeo.com/hubnut/user/[user_url] (like https://player.vimeo.com/hubnut/user/user36690798).\r\n13. Click on _Play_.\r\n14. Click on _CC_ (at the right bottom of the player) and click on _English_,  to activate the captions.\r\n15. `alert(document.domain)` is executed.\r\n\r\nYou can reproduce the issue using this link https://player.vimeo.com/hubnut/user/user36690798.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":53542,"file_name":"English.vtt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/053/542/797a8fe76e0a2c722c9a00379484003b2e6cc4f4/English.vtt?response-content-disposition=attachment%3B%20filename%3D%22English.vtt%22%3B%20filename%2A%3DUTF-8%27%27English.vtt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153759Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ffbe92b1372da8b4c3e44c4a49fda94160cc7558aea8b8cf1f588595690a626a","file_size":107,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-08-31T10:27:24.282Z","allow_singular_disclosure_after":-129791434.95315635,"singular_disclosure_allowed":true,"vote_count":6,"voters":["flamezzz","eveeez","r3y","hacklad","nonamehiiden","mahmoud743"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":591121,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Waiting on the developers to put a fix in place.","automated_response":false,"created_at":"2015-09-17T15:35:45.544Z","updated_at":"2015-09-17T15:35:45.544Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":591672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect!","automated_response":false,"created_at":"2015-09-18T02:31:32.890Z","updated_at":"2015-09-18T02:31:32.890Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":603545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @esevece I don't want you to think we forgot about you were still chugging through some deploys and trying to get the proper fixes in place, ill keep you updated on this...","automated_response":false,"created_at":"2015-09-30T18:00:22.875Z","updated_at":"2015-09-30T18:00:22.875Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":603568,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @securityofthings,\nthank you for the update. I understand, take your time.\n","automated_response":false,"created_at":"2015-09-30T18:09:32.415Z","updated_at":"2015-09-30T18:09:32.415Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":605432,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@esevece we should have this fixed now, I've retested it and it looks good on my side","automated_response":false,"created_at":"2015-10-01T18:25:30.320Z","updated_at":"2015-10-01T18:25:30.320Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@securityofthings sorry for the delay.\nLooks good on my side too.","automated_response":false,"created_at":"2015-10-02T02:10:48.612Z","updated_at":"2015-10-02T02:10:48.612Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606631,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks! As for the bounty I want you to know that it was definitely a nice catch but the user interaction and that using a flash player that isnt used as much determined the pay out.","automated_response":false,"created_at":"2015-10-02T13:55:36.087Z","updated_at":"2015-10-02T13:55:36.087Z","actor":{"username":"securityofthings","cleared":false,"url":"/securityofthings","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/710/0e4d6b62f3b5442e932f1486acde96d43c64b49d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606632,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for your making Vimeo safer!","automated_response":false,"created_at":"2015-10-02T13:55:58.886Z","updated_at":"2015-10-02T13:55:58.886Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606711,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@securityofthings thank you! \nIt's up to you the reward. Thank you for the explanation anyway.","automated_response":false,"created_at":"2015-10-02T15:31:58.564Z","updated_at":"2015-10-02T15:31:58.564Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, bad English in last comment. \nI think that you understood anyway.","automated_response":false,"created_at":"2015-10-02T15:58:45.364Z","updated_at":"2015-10-02T15:58:45.364Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1881916,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Okay, I didn't know I had reported many reports to you. So, sorry again for spamming.","automated_response":false,"created_at":"2017-08-01T10:27:24.222Z","updated_at":"2017-08-01T10:27:24.222Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1968370,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-31T10:27:29.306Z","updated_at":"2017-08-31T10:27:29.306Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}