{"id":335990,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzU5OTA=","url":"https://hackerone.com/reports/335990","title":"Flash-based XSS on mediaelement-flash-audio-ogg.swf of www.lahitapiolarahoitus.fi","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-11T16:16:39.552Z","submitted_at":"2018-04-11T16:16:39.552Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"putsi","url":"/putsi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-13T12:10:12.310Z","bug_reporter_agreed_on_going_public_at":"2018-04-13T12:10:12.243Z","team_member_agreed_on_going_public_at":"2018-04-13T12:08:59.518Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nThe lahitapiolarahoitus.fi contains an SWF-file which is vulnerable to reflected cross-site scripting attacks via crafted URL.\n\n**Description:** \nThe file `https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-audio-ogg.swf` contains a XSS-vulnerability which allows malicious actor to create URLs which contain javascript. When the victim (anonymous or authenticated) opens this URL, the javascript is executed on the victim's session.\n\n**Impact:**\nThe vulnerability allows an attacker to use every functionality on lahitapiolarahoitus.fi that the victim is able to use. In case of an admin-victim, the attacker can use this to gain RCE on the server by uploading a malicious shell-plugin. The vulnerability can also be used to redirect the victim to a malicious third-party domain and also to serve spoofed content on the lahitapiolarahoitus.fi-domain. If the myynti.lahitapiolarahoitus.fi uses domain-wide cookies, this vulnerability can possibly be used to read/write these cookies. \n\n## Browsers / Apps Verified In:\n\n  * Latest Firefox\n  * Latest Internet Explorer\n  * Latest Edge\n\n## Steps To Reproduce:\n\n  1. Go to URL https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-audio-ogg.swf?uid=\"]}))}catch(e){}alert(document.cookie)//\n  2. Notice, that the user's cookies are shown.\n\n## Mitigation\n\nAs the vulnerable files are removed in the latest Wordpress version, simply update your own version to the latest one. If the previous is not possible, just remove the swf-files as those are fairly rarely neede.\n\n## Additional material\n\n  * https://wordpress.org/news/2018/01/wordpress-4-9-2-security-and-maintenance-release/\n\n## Related reports, best practices\n\n  * https://hackerone.com/reports/134546\n\n## Impact\n\nThe vulnerability allows an attacker to use every functionality on lahitapiolarahoitus.fi that the victim is able to use. In case of an admin-victim, the attacker can use this to gain RCE on the server by uploading a malicious shell-plugin. The vulnerability can also be used to redirect the victim to a malicious third-party domain and also to serve spoofed content on the lahitapiolarahoitus.fi-domain. If the myynti.lahitapiolarahoitus.fi uses domain-wide cookies, this vulnerability can possibly be used to read/write these cookies.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["muon4","sameerphad72","eveeez","r3y","its_afolic","cr4xerbik4sh","akashpawar"],"severity":{"rating":"high","score":7.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":6797,"asset_type":"URL","asset_identifier":"www.lahitapiolarahoitus.fi","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2592196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report and http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/. Also, our policy contains a lot of information on what is relevant and what is not.*","automated_response":false,"created_at":"2018-04-11T18:44:29.722Z","updated_at":"2018-04-11T18:44:29.722Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2592213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm going to make a policy decision here and say that we are going to bundle all of these reported issues because\n- they are all systematically about the same issue\n- they are all mitigated in the same way\n\nSo the net list is:\n- https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-audio-ogg.swf?uid=%22%5D%7D))%7Dcatch(e)%7B%7Dalert(document.cookie)//\n- https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-audio.swf?uid=%22%5D%7D))%7Dcatch(e)%7B%7Dalert(document.cookie)//\n- https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-video-hls.swf?uid=%22%5D%7D))%7Dcatch(e)%7B%7Dalert(document.cookie)//\n- https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-video-mdash.swf?uid=%22%5D%7D))%7Dcatch(e)%7B%7Dalert(document.cookie)//\n- https://www.lahitapiolarahoitus.fi/wp-includes/js/mediaelement/mediaelement-flash-video.swf?uid=%22%5D%7D))%7Dcatch(e)%7B%7Dalert(document.cookie)//\n\nWe are going to track all of this reported issues #335990, #335991, #335992, #335993, #335995 under on single report which is going to be #335990. A potential future award will also be subject to bundling. ","automated_response":false,"created_at":"2018-04-11T18:48:52.080Z","updated_at":"2018-04-11T18:49:33.733Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2597247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nSounds reasonable as these seem to also have a same CVE-number ([CVE-2018-5776](https://nvd.nist.gov/vuln/detail/CVE-2018-5776)). ","automated_response":false,"created_at":"2018-04-12T11:37:04.769Z","updated_at":"2018-04-12T11:37:04.769Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2599859,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also needs to be noted that basic patching of versions is a recurring process for us, there will always be a small-medium time window when we are not perfectly fully patched.  This issue is waiting for this normal patching cycle.","automated_response":false,"created_at":"2018-04-13T05:24:35.383Z","updated_at":"2018-04-13T05:24:35.383Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2602864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@putsi could you retest and verify this, the version has been patched.","automated_response":false,"created_at":"2018-04-13T11:54:29.112Z","updated_at":"2018-04-13T11:54:29.112Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2602901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well that was fast. Yes I can confirm that the files are no longer accessible / have been removed as 404 is returned for each.","automated_response":false,"created_at":"2018-04-13T11:56:33.684Z","updated_at":"2018-04-13T11:57:18.549Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2602943,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-04-13T12:03:21.036Z","updated_at":"2018-04-13T12:03:21.036Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"putsi","url":"/putsi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2602944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yay thanks!","automated_response":false,"created_at":"2018-04-13T12:04:07.384Z","updated_at":"2018-04-13T12:04:07.384Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2602951,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved.","automated_response":false,"created_at":"2018-04-13T12:08:14.878Z","updated_at":"2018-04-13T12:08:14.878Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"putsi","url":"/putsi"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2602954,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure.","automated_response":false,"created_at":"2018-04-13T12:08:59.558Z","updated_at":"2018-04-13T12:08:59.558Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2602956,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-04-13T12:10:12.271Z","updated_at":"2018-04-13T12:10:12.271Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2602957,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-13T12:10:12.345Z","updated_at":"2018-04-13T12:10:12.345Z","actor":{"username":"putsi","cleared":true,"url":"/putsi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7112,"category":"team","content":"#Issue\nThe reporter found several flash-files with reflected XXS in the WP installation.\n\n##Fix\n\nThe issue was resolved during normal patching of Wordpress.\n\n##Reasoning\n\nBased on the report, the issue was found to be valid. Working single click open redirects which are easily usable in phishing attacks are always an issue for us. For future readers of this report - rewards for issues that are fixed by normal patching may vary, this also applies to reports based purely on CVE-database information.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}