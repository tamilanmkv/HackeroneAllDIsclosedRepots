{"id":386340,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODYzNDA=","url":"https://hackerone.com/reports/386340","title":"Reflected XSS on ssl-ccstatic.highwebmedia.com  via player.swf","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-07-24T18:19:44.100Z","submitted_at":"2018-07-24T18:19:44.100Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nahamsec","url":"/nahamsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-19T23:35:21.232Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T23:35:21.120Z","team_member_agreed_on_going_public_at":"2018-09-19T22:15:40.049Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey there,\n\nThere's a SWF based XSS on ssl-ccstatic.highwebmedia.com. You may want to update/remove the file.\n\n\n#POC\nhttps://ssl-ccstatic.highwebmedia.com/jwplayer/player.swf?playerready=alert(document.domain)\n\nThanks,\nBen\n\n## Impact\n\n#","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-19T22:15:40.185Z","allow_singular_disclosure_after":-93976694.30854669,"singular_disclosure_allowed":true,"vote_count":7,"voters":["ali","powerjacobb1","eveeez","domssilva","mefkan","cryptographer","v13rsba"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":11723,"asset_type":"URL","asset_identifier":"*.highwebmedia.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3093406,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**\n","automated_response":false,"created_at":"2018-07-24T19:14:17.239Z","updated_at":"2018-07-24T19:14:17.239Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093465,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2018-07-24T19:27:35.455Z","updated_at":"2018-07-24T19:27:35.455Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"email":"ziot","genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3094203,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-07-24T23:40:32.333Z","updated_at":"2018-07-24T23:40:32.333Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":187757,"new_severity_id":187834},"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3094276,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. Since highwebmedia.com is only used for assets and no cookies (relating to authentication) are used on it, the effective scope of this attack is limited. Therefore we'd only rate this a medium severity.\n\nHowever if you know of, or think of other ways this can be expanded let us know and we can readjust.","automated_response":false,"created_at":"2018-07-25T00:01:29.702Z","updated_at":"2018-07-25T00:01:29.702Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3094277,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-07-25T00:01:42.021Z","updated_at":"2018-07-25T00:01:42.021Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Chaturbate"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"nahamsec","url":"/nahamsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3094552,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2018-07-25T00:19:43.359Z","updated_at":"2018-07-25T00:19:43.359Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3095054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe there is impact on the chaturbate.com website due to the crossdomain.xml policy allowing access from highwebmedia.com\n\nhttps://chaturbate.com/crossdomain.xml\n\n```\n\u003c?xml version=\"1.0\" ?\u003e\n\u003ccross-domain-policy\u003e\n\u003csite-control permitted-cross-domain-policies=\"all\"/\u003e\n\u003callow-access-from domain=\"*.highwebmedia.com\"/\u003e\n\u003callow-access-from domain=\"*.chaturbate.com\"/\u003e\n\u003callow-access-from domain=\"chaturbate.com\"/\u003e\n\u003callow-http-request-headers-from domain=\"*.highwebmedia.com\" headers=\"*\"/\u003e\n\u003callow-http-request-headers-from domain=\"*.chaturbate.com\" headers=\"*\"/\u003e\n\u003callow-http-request-headers-from domain=\"chaturbate.com\" headers=\"*\"/\u003e\n\u003c/cross-domain-policy\u003e\n```\n\nAlthough you wouldn't be able to read cookies, you'd be able to send requests on behalf of authenticated users (aka the victim) and read the page contents. This would allow you to exfil their CSRF token and perform state-changing requests such as some of the self-XSS we discovered on the site.\n\nFlash also allows you send custom headers without SOP/CORS restrictions so it'd bypass the referer/header checks as well\n\nYou already deleted the swf file, so it'll be hard to demonstrate, but I'll see if I can build a PoC to show ya'll.","automated_response":false,"created_at":"2018-07-25T03:34:21.140Z","updated_at":"2018-07-25T03:45:12.661Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3097737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The playerready looks to be using an ExternalInterface call, so anything inputed is ran in the browser's javascript. As far as I'm aware, crossdomain.xml would only apply to calls from flash itself, so wouldn't be relevant here.\n\nI have tried to exploit this further and couldn't get anywhere.\n\nApologies, we deleted the files to resolve this ticket. I can send you a copy of the swf if you do not have it to host locally to provide a POC.","automated_response":false,"created_at":"2018-07-25T18:20:40.125Z","updated_at":"2018-07-25T18:20:40.125Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3099533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@williammmllc: no worries on the files, I was able to duplicate the setup in my own environment. I believe you're right about the actionscript calls vs externalinterface, I ran into exactly what you were talking about. \n\nThe only way I know how to escalate it would require using the XSS with a JSONP callback on the domain to spoof a swf using serviceworkers. Without that, I don't think it's possible to use the crossdomain.xml to escalate it.\n\nThanks for investigating","automated_response":false,"created_at":"2018-07-26T02:23:44.928Z","updated_at":"2018-07-26T02:23:44.928Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3099550,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for trying to escalate, we don't use JSONP anywhere either.\n\nI'm going to leave it at medium and mark as resolved. Let me know if you disagree.\n\nThanks","automated_response":false,"created_at":"2018-07-26T02:56:32.427Z","updated_at":"2018-07-26T02:56:32.427Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nahamsec","url":"/nahamsec"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-19T22:15:40.082Z","updated_at":"2018-09-19T22:15:40.082Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360580,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-19T23:35:21.161Z","updated_at":"2018-09-19T23:35:21.161Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360581,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-09-19T23:35:21.313Z","updated_at":"2018-09-19T23:35:21.313Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}