{"id":469841,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Njk4NDE=","url":"https://hackerone.com/reports/469841","title":"Reflected XSS on https://inventory.upserve.com/ (affects IE users only)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-19T02:50:26.635Z","submitted_at":"2018-12-19T02:50:26.635Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stealthy","url":"/stealthy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21981,"url":"https://hackerone.com/upserve","handle":"upserve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Upserve ","twitter_handle":"getupserve","website":"http://upserve.com","about":"Upserve offers cloud point of sale for restaurants, actionable analytics, payment processing, and mobile restaurant management."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-06T19:30:46.064Z","bug_reporter_agreed_on_going_public_at":"2019-08-06T18:07:57.732Z","team_member_agreed_on_going_public_at":"2019-08-06T19:30:45.959Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1200.0","formatted_bounty":"$1,200","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-09-05T18:07:57.838Z","allow_singular_disclosure_after":-41514870.08531912,"singular_disclosure_allowed":true,"vote_count":112,"voters":["sultancad","secator","hunter","mashoud1122","un4gi","spam404","base_64","sameerphad72","prophet","stealthy","and 102 more..."],"severity":{"rating":"medium","score":4.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":32822,"asset_type":"URL","asset_identifier":"inventory.upserve.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3864678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T03:15:34.532Z","updated_at":"2018-12-19T03:17:17.592Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3865595,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T08:59:09.768Z","updated_at":"2018-12-19T08:59:09.768Z","additional_data":{},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865596,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T08:59:14.391Z","updated_at":"2018-12-19T08:59:14.391Z","additional_data":{},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865597,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T08:59:26.341Z","updated_at":"2018-12-19T08:59:26.341Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865601,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T08:59:48.666Z","updated_at":"2018-12-19T08:59:48.666Z","additional_data":{},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865602,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T09:00:07.781Z","updated_at":"2018-12-19T09:00:07.781Z","additional_data":{},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865603,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T09:00:10.856Z","updated_at":"2018-12-19T09:00:10.856Z","additional_data":{},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3865604,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T09:00:20.179Z","updated_at":"2018-12-19T09:00:20.179Z","additional_data":{},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3869775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-20T07:59:46.106Z","updated_at":"2018-12-20T08:04:04.514Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3870162,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-20T08:46:23.251Z","updated_at":"2018-12-20T08:46:23.251Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3877503,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-21T18:58:09.496Z","updated_at":"2018-12-21T18:58:09.496Z","actor":{"url":"/upserve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/981/780e51432acea84f3fe52455f0009230a87ee31e_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Upserve "}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"200.0","genius_execution_id":null,"team_handle":"upserve","collaborator":{"username":"stealthy","url":"/stealthy"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3877659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-21T19:33:10.613Z","updated_at":"2018-12-21T19:33:20.543Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3915233,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-02T14:02:43.608Z","updated_at":"2019-01-02T14:02:43.608Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stealthy","url":"/stealthy"},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5445734,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-27T23:02:58.356Z","updated_at":"2019-07-27T23:02:58.356Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5512043,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T14:19:37.096Z","updated_at":"2019-08-06T14:19:37.096Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5513482,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T18:07:57.759Z","updated_at":"2019-08-06T18:07:57.759Z","first_to_agree":true,"actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5513938,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T19:30:45.986Z","updated_at":"2019-08-06T19:30:45.986Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5513939,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T19:30:46.093Z","updated_at":"2019-08-06T19:30:46.093Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5879463,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T15:52:27.589Z","updated_at":"2019-09-24T15:52:27.589Z","actor":{"username":"upserve-bryan","cleared":false,"url":"/upserve-bryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/914/953184670ceb43d71870f5de769683ac4614b579_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"*.upserve.com","new_scope":"inventory.upserve.com","genius_execution_id":null,"team_handle":"upserve","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":17676,"category":"team","content":"The REQUEST_URI was assigned as the value of a hidden field in the login form without proper escaping resulting in a reflected cross-site scripting bug. Browsers were mitigating the issue and IE was only impacted if XSS protection was disabled. We've improved the sanitization of this field.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe REQUEST_URI was assigned as the value of a hidden field in the login form without proper escaping resulting in a reflected cross-site scripting bug. Browsers were mitigating the issue and IE was only impacted if XSS protection was disabled. We\u0026#39;ve improved the sanitization of this field.\u003c/p\u003e\n"},{"id":17673,"category":"researcher","content":"The value of `REQUEST_URI` was not correctly sanitizing user input, in this case, double-quotes. However, due to URL encoding, this was only exploitable in IE.\n\n    https://inventory.upserve.com/login/?'\"--\u003e\u003cscript\u003econfirm(document.cookie)\u003c/script\u003e\n\nUpserve handled this report quickly and professionally. I am looking forward to working with them again in the future. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe value of \u003ccode\u003eREQUEST_URI\u003c/code\u003e was not correctly sanitizing user input, in this case, double-quotes. However, due to URL encoding, this was only exploitable in IE.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://inventory.upserve.com/login/?\u0026#39;\u0026quot;--\u0026gt;\u0026lt;script\u0026gt;confirm(document.cookie)\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUpserve handled this report quickly and professionally. I am looking forward to working with them again in the future. \u003c/p\u003e\n"}]}