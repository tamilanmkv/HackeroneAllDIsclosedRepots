{"id":876148,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzYxNDg=","url":"https://hackerone.com/reports/876148","title":"DOM XSS on duckduckgo.com search","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-16T18:33:39.971Z","submitted_at":"2020-05-16T18:33:39.971Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cujanovic","url":"/cujanovic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/382/ff3eef97a8a4c4aa0f46b834454237dcf9d7e9b5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":10995,"url":"https://hackerone.com/duckduckgo","handle":"duckduckgo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"DuckDuckGo","twitter_handle":"duckduckgo","website":"https://duckduckgo.com","about":"DuckDuckGo is the Internet privacy company for everyone who's had enough of hidden online tracking."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-26T17:16:30.523Z","bug_reporter_agreed_on_going_public_at":"2020-05-27T17:16:14.044Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nThe is a DOM XSS vulnerability on https://duckduckgo.com search through the `relsexp` parameter.\n\nPoC URL: ` https://duckduckgo.com/?q=a\u0026relsexp=\"\u003e\u003cimg src=/ onerror=alert(document.domain)\u003e\u0026ia=web`\n\nScreenshot:\n{F830875}\n\nVideo:\n{F830880}\n\n## Impact\n\nThe attacker can execute JS code.","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":830875,"file_name":"Screen_Shot_2020-05-16_at_20.21.38.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/JXL5aUExoST5XNgwfTyWiSsW?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-05-16_at_20.21.38.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-05-16_at_20.21.38.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153659Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=107d7640503e7b207a66fa63139d0135e91555eef8cec1586084d2ad395250ac","file_size":676359,"type":"image/png"},{"id":830880,"file_name":"Screen_Recording_2020-05-16_at_20.29.00.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/URXUKkJR65EN2Kz9DXCG4dnp?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2020-05-16_at_20.29.00.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2020-05-16_at_20.29.00.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153659Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=447dc87f7823af3f2f20087a2dd431a6111d7cb8dd625844fce580ae7e897d35","file_size":5573341,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2020-06-26T17:16:14.080Z","allow_singular_disclosure_after":-40774845.766929775,"singular_disclosure_allowed":true,"vote_count":73,"voters":["4n_curze","i_yuzhanin","a_d_a_m","secator","ras-it","prophet","ali","ms-13","since2003","exception","and 63 more..."],"severity":{"rating":"medium","score":6.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":8671,"asset_type":"URL","asset_identifier":"*.duckduckgo.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8030949,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cujanovic,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@turtle_shell","automated_response":false,"created_at":"2020-05-18T07:36:25.569Z","updated_at":"2020-05-18T07:36:25.569Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8030953,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-05-18T07:37:37.320Z","updated_at":"2020-05-18T07:37:37.320Z","additional_data":{"added_weaknesses":[{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"}],"removed_weaknesses":[{"id":63,"name":"Cross-site Scripting (XSS) - DOM"}]},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8030954,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-05-18T07:37:37.447Z","updated_at":"2020-05-18T07:37:37.447Z","additional_data":{"old_severity":"High","new_severity":"Medium (6.4)","old_severity_id":724018,"new_severity_id":724881},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8031209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hey @turtle_shell this is not a Reflected XSS, its a DOM one, it executes in DOM, the payload is not reflected anywhere in the page response.","automated_response":false,"created_at":"2020-05-18T08:12:54.561Z","updated_at":"2020-05-18T08:13:15.877Z","actor":{"username":"cujanovic","cleared":false,"url":"/cujanovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/382/ff3eef97a8a4c4aa0f46b834454237dcf9d7e9b5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8031921,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @cujanovic,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@turtle_shell","automated_response":false,"created_at":"2020-05-18T09:11:23.064Z","updated_at":"2020-05-18T09:11:23.064Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8109865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cujanovic, thank you for your report!\nWe have investigated the issue and we're in the process of fixing it. \nWe'll let you know when the fix is out.","automated_response":false,"created_at":"2020-05-26T16:56:50.597Z","updated_at":"2020-05-26T16:56:50.597Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The issue should be fixed now. @cujanovic can you confirm?\n","automated_response":false,"created_at":"2020-05-27T14:41:01.346Z","updated_at":"2020-05-27T14:41:01.346Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mariag yep, the PoC URL doesn't execute JS anymore.","automated_response":false,"created_at":"2020-05-27T14:43:59.639Z","updated_at":"2020-05-27T14:55:37.930Z","actor":{"username":"cujanovic","cleared":false,"url":"/cujanovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/382/ff3eef97a8a4c4aa0f46b834454237dcf9d7e9b5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8121314,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2020-05-27T17:09:09.425Z","updated_at":"2020-05-27T17:09:09.425Z","actor":{"url":"/duckduckgo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"DuckDuckGo"}},"reporter":{"username":"cujanovic","url":"/cujanovic"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8121318,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2020-05-27T17:09:42.735Z","updated_at":"2020-05-27T17:09:42.735Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8121330,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-05-27T17:11:08.727Z","updated_at":"2020-05-27T17:11:08.727Z","actor":{"username":"mariag","cleared":false,"url":"/mariag","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cujanovic","url":"/cujanovic"},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8121373,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-27T17:16:14.059Z","updated_at":"2020-05-27T17:16:14.059Z","first_to_agree":true,"actor":{"username":"cujanovic","cleared":false,"url":"/cujanovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/382/ff3eef97a8a4c4aa0f46b834454237dcf9d7e9b5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8421375,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-06-26T17:16:30.674Z","updated_at":"2020-06-26T17:16:30.674Z","actor":{"url":"/duckduckgo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/995/8b8a2ef803e7e6b78d77ea654f36894160dba4f6_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"DuckDuckGo"}},"genius_execution_id":null,"team_handle":"duckduckgo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}