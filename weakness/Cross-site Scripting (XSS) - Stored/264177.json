{"id":264177,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjQxNzc=","url":"https://hackerone.com/reports/264177","title":"XSS when replying / forwarding to a malicious email on iOS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-29T04:14:14.746Z","submitted_at":"2017-08-29T04:14:14.746Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pwnsdx","url":"/pwnsdx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-28T15:04:02.595Z","bug_reporter_agreed_on_going_public_at":"2017-12-28T15:04:02.516Z","team_member_agreed_on_going_public_at":"2017-12-28T14:55:00.137Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nMail.ru for iOS\n\nTesting environment\n--\niOS 10\n\nSteps to reproduce\n--\n1) Send you a mail with something like this in the From field: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw\n\nNote: This is a base64 string of \"\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\"\n\n2) Try to forward or reply to that email.\n\nNote: If you kill the app from the iOS multitask and run it again, the reply / forward will show again, executing one more time the JS code.\n\nActual results\n--\nJS alert with current cookies is shown\n\nExpected results, security impact description and recommendations\n--\nNothing happens\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n\nPayload is: `From: =?utf-8?b?PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+?=@pwnsdx.pw`\n\nVideo has been attached.","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":216633,"file_name":"video-export.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/216/633/fb8f39f96675ffec4c0e4f9de6fb654a7dff24c8/video-export.mov?response-content-disposition=attachment%3B%20filename%3D%22video-export.mov%22%3B%20filename%2A%3DUTF-8%27%27video-export.mov\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143334Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2a6a138f8f5f8876d809cc6354458cef26b768f6208dc65c3e91dc7ba7825de5","file_size":609455,"type":"video/mp4"}],"allow_singular_disclosure_at":"2018-01-27T14:55:00.240Z","allow_singular_disclosure_after":-116897913.80712108,"singular_disclosure_allowed":true,"vote_count":8,"voters":["pwnsdx","eveeez","luigigubello","khizer47","cr4xerbik4sh","japz","3apa3a","extr4b4n4n4"],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":238,"asset_type":"APPLE_STORE_APP_ID","asset_identifier":"ru.mail.mail","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1961959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Testing environment\n\nOnly iOS 11* sorry, I can try on older versions but should be the same on all versions supported by the app.","automated_response":false,"created_at":"2017-08-29T04:15:29.857Z","updated_at":"2017-08-29T04:15:29.857Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1962355,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.\n","automated_response":false,"created_at":"2017-08-29T09:07:34.899Z","updated_at":"2017-08-29T09:07:34.899Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1994077,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nCan you demonstrate access to 'Mpop' cookie ?\n\nP.S. we are still working to resolve this problem","automated_response":false,"created_at":"2017-09-13T13:17:05.174Z","updated_at":"2017-09-13T13:17:05.174Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"pwnsdx","url":"/pwnsdx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083982,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2017-10-19T12:47:47.848Z","updated_at":"2017-10-19T12:47:47.848Z","actor":{"username":"nikitastupin","cleared":true,"url":"/nikitastupin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/oxy5KyvvNptCube1aM5Eq5tX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pwnsdx","url":"/pwnsdx"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2248629,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-12-27T16:22:26.261Z","updated_at":"2017-12-27T16:22:26.261Z","additional_data":{"old_severity":"High (8.8)","new_severity":"Medium (5.0)","old_severity_id":71561,"new_severity_id":104191},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2250014,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-12-28T14:55:00.177Z","updated_at":"2017-12-28T14:55:00.177Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2250026,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello,\n\nSorry for taking so long to answer this repor, I completely missed it. Indeed, I was unable to access the session as it had HttpOnly flag.\n\nRegards,\nSabri","automated_response":false,"created_at":"2017-12-28T15:04:02.545Z","updated_at":"2017-12-28T15:04:02.545Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2250027,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-12-28T15:04:02.625Z","updated_at":"2017-12-28T15:04:02.625Z","actor":{"username":"pwnsdx","cleared":false,"url":"/pwnsdx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/095/668/85ec293a7f081face752fdf120e85e9314a2facb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6178,"category":"team","content":"It was possible to trigger XSS vulnerability within webview of iOS Mail.Ru Mail application via crafted e-mail address.\nVulnerability doesn't provide direct access to user session or critical data, and considered medium severity due to possible phishing scenarios.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}