{"id":333008,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzMwMDg=","url":"https://hackerone.com/reports/333008","title":"Persistent XSS in https://sandbox.reverb.com/item/","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-03T20:49:11.135Z","submitted_at":"2018-04-03T20:49:11.135Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bigshaq","url":"/bigshaq","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/237/280/5980a2efdbaac92c70aca72693147dfaf53f7bba_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3094,"url":"https://hackerone.com/reverb","handle":"reverb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Reverb.com","twitter_handle":"reverb","website":"https://sandbox.reverb.com","about":"The best place for musicians to buy and sell the gear they use to create the music they love."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-06T16:08:07.519Z","bug_reporter_agreed_on_going_public_at":"2018-04-06T16:07:46.422Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Description\nI found a Persistent XSS in a listing page. The flaw is in the SoundCloud link that the listing owner can attach(The parameter is called *product[soundcloud_link_attributes][link]*). There's no encoding on the user input and it looks like there's only client-side validation.\n\n# PoC\nThe payload:\n```\nhttps://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15?fuzzing\" onload=alert(document.domain) x=\"\n```\nIf you try to put this payload straight into the \"Edit Listing\" page it'll give you the following error:\n```\nhttps://sandbox.reverb.com/listings/[YOUR_LISTING_ID]/edit\n```\n{F281627}\n\nBut it looks like there's only client side validation, when I tried to enter a valid link:\n```\nhttps://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15\n```\nI got no error message(because it was a valid link)\nBut when I clicked \"Save \u0026 Review Listing\", intercepted the request and tampered the *product[soundcloud_link_attributes][link]* parameter's value to:\n```\nhttps://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15?fuzzing\" onload=alert(document.domain) x=\"\n```\nIt updated successfully and because there's no encoding on this input parameter - it allowed me to inject javascript code that'll be stored on my listing page.\n{F281640}\n\nPoC Video: https://youtu.be/Y-8W422hLOw\n\n## Impact\n\nAn attacker can:\n* Perform a defacement on every possible store in the website (all he need is a single click from the victim)\n* Deny future access from any other shop owner that access this listing(with the self-PXSS that i reported 2 days ago: https://hackerone.com/reports/331725 )\n*  Perform operations in the application on behalf of the victim\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://sandbox.reverb.com/item/\n\n**Verified**\nYes\n\n","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":281627,"file_name":"pxss1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/627/4a3d732deac14520637f00e5133f3243a6f774c7/pxss1.png?response-content-disposition=attachment%3B%20filename%3D%22pxss1.png%22%3B%20filename%2A%3DUTF-8%27%27pxss1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144706Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d2f46879f170ee5b908622a60e11cd2b40926fc8a4bbe67bf80b56cdfaa9f17d","file_size":8533,"type":"image/png"},{"id":281640,"file_name":"alert.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/640/940f3510440dd344d4f236dd6ed1210c623fd2cf/alert.png?response-content-disposition=attachment%3B%20filename%3D%22alert.png%22%3B%20filename%2A%3DUTF-8%27%27alert.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTQR22CE2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144706Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHylhpFJOF4pRe7XlaDX6z3BLEup%2BswnNkaACr%2Fwjwr8AiASjuyeD0TYwrZA5sOldf5eC6UQrO8hSHC9jNR%2BVNumhyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMfK%2BofD1wJOHYcOUJKtcDnC3f8Y3jglGs7z8YlxF9bdYkYlsSrPxEkx9hDqtH%2BQ3u1daZrwyM6F3WHlk0a%2BWNezGk%2FnRxFWuvgXlXXAEBaCUWEe1UXv97gs6KKr%2F4fZ92%2FH3VXeVMioYLi220Z8qDdmiwSK2Z%2FPfK0nlRhO3v9Ee3r3C7BMq5B4DRnfxp0cJyzU%2FHbMNzQNjyO%2BlGzreHCzcyKBe%2FoFAr2W6xbLokCINrIUxMnvI9Mxs7SraD%2FF2sZw8Ln4uZ6aJweQoOPwsnYKkrRjb370Lt%2FREkrEj9pcgae0C9R5BTZegZaqNN6CzMkZfNHB7RmNrhJFg6j7%2BfPYLcWFNxzvJV9dbVJdocqrM5Jmi3hE47KOBrMSGuFrCha2vRk9P64hqfhM1GdDtMLFZZn5VqOJgdyVWZ8bTrZpmlBP%2FJ6YiHIaMTH8G%2FRndaRrVRAR8iOSqWok%2FikWajxMvcVA29H%2F5RznwCFPkLrSbv34tOiWcwVp50Yy3HjkGq4LnY67LMRRRIwThQ9vc%2BM3G9xlb7TwO6%2F3vE5U6azDCH6hDFQ3Xi8ZJVYrTOOWINnf%2BC3BIhvL8Uql%2FhI1vUmbQiAR01xN%2FdEQ9ReTSo0pfJ3SDSXhBXiwUW0IRKspJO189rJyI3MImNkYsGOqYBwdOGh60JXyl1FPj8jwEbnfg6var6H0hyaUwn%2B%2FnamMWODqDwoSJI6f0Q6RJHnQJo2gfc6OFgj1W2B%2FGcJDL4gMvwPBD8bBDDMSaZ3x1nqw%2FhzMwsaQP%2BTnUJEKAVQSe3o5Yvwzg%2FSvpNP%2By981FbIZs9aWoGNPHY48ZIUNdNLCWPS2PxNm9xHrAxEcqn8ib1XLvQQS%2FALl2CG36%2BewUP2tPIf%2BIPmw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b3074044f8948281dce6a7c79bf27fb6d0f416dfe9e5667645aca8a2df5bfb38","file_size":43805,"type":"image/png"}],"allow_singular_disclosure_at":"2018-05-06T16:07:46.515Z","allow_singular_disclosure_after":-108340759.82060799,"singular_disclosure_allowed":true,"vote_count":35,"voters":["kiyell","depthpz","mashoud1122","muon4","flashdisk","dilawer01","michan","eveeez","an0nym0us","lordjerry0x01","and 25 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":6416,"asset_type":"URL","asset_identifier":"sandbox.reverb.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2564738,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-04-04T13:54:53.168Z","updated_at":"2018-04-04T13:54:53.168Z","actor":{"username":"ctennis","cleared":false,"url":"/ctennis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2565533,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-04-04T18:47:44.407Z","updated_at":"2018-04-04T18:47:44.407Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"reverb","collaborator":{"username":"bigshaq","url":"/bigshaq"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2565720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty! (:","automated_response":false,"created_at":"2018-04-04T19:36:44.572Z","updated_at":"2018-04-04T19:36:44.572Z","actor":{"username":"bigshaq","cleared":false,"url":"/bigshaq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/280/5980a2efdbaac92c70aca72693147dfaf53f7bba_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2573866,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-04-06T15:52:32.349Z","updated_at":"2018-04-06T15:52:32.349Z","actor":{"username":"ctennis","cleared":false,"url":"/ctennis","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bigshaq","url":"/bigshaq"},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2573904,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we publicly disclose this report? ","automated_response":false,"created_at":"2018-04-06T16:07:46.458Z","updated_at":"2018-04-06T16:07:46.458Z","first_to_agree":true,"actor":{"username":"bigshaq","cleared":false,"url":"/bigshaq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/280/5980a2efdbaac92c70aca72693147dfaf53f7bba_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2706212,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-05-06T16:08:07.554Z","updated_at":"2018-05-06T16:08:07.554Z","actor":{"url":"/reverb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/094/b7238acaca15ddb329cf25e69c687352247aece5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Reverb.com"}},"genius_execution_id":null,"team_handle":"reverb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}