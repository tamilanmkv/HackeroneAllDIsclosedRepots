{"id":351554,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTE1NTQ=","url":"https://hackerone.com/reports/351554","title":"Persistent XSS - Deleting a project (No Longer Vulnerable in 10.7)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-14T18:02:48.002Z","submitted_at":"2018-05-14T18:02:48.002Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"phillycheeze","url":"/phillycheeze","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-20T20:02:52.445Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-09-20T20:02:30.016Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nWhen deleting a project in gitlab, it is possible to trigger a XSS with a malicious user name string.\n\n**Description:**\nI'd like to first point out that this is no longer vulnerable, but I filed a report anyways since it was never discovered. It looks like this was fixed on \"accident\". Originally, JS was rendering the username via a \".html()\" jquery method, but was refactored to \".text()\" and fixed the vulnerability.\n\nI'm not sure how Gitlab would disclose this, but I have attached the exact commit that fixed the issue. This was done about a month ago, so I wanted to report this just in case Gitlab decides to update the release notes to point out that this was fixed. The original offending line was line 11 of the file in the commit below.\n\nCommit: https://gitlab.com/gitlab-org/gitlab-ee/commit/2024aa5fa593e31b7c4aa30d107cc17d08b0a009\n\nI ranked this a Medium since the number of users that are impacted are probably very low. For someone to become a victim, they must have Master access to a project that is under the malicious user's own account.\n\nThe steps to reproduce are fairly simple but there are some restrictions:\n  * Only members of a project with Master access can become victims of the XSS.\n  * The project must be under a personal \"group\", as in the project must be a personal project, not one under a custom group.\n\n## Steps To Reproduce:\n  1. Set your own username as \"\u003cimg src=x onerror=alert(document.domain)\u003e foo / bar\"\n  1. Under your own profile, create a new project.\n  1. -- the steps below can render the XSS on yourself. To test another user, grant a second user to have Master access on this new project and run the same steps below. --\n  1. Under Project Settings, General, Advanced Options, Danger Zone... click the Remove Project button.\n  1. Notice the XSS renders on the modal that pops up asking for confirmation.\n\n## Supporting Material/References:\nMore information can be provided upon request.\n\n## Impact\n\nThe security impact is the same as any typical persistent xss. I lowered from High -\u003e Medium because of the potential number of users impacted (described above).\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://gitlab.com/group/project/edit\n\n**Verified**\nYes\n\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-20T20:02:30.153Z","allow_singular_disclosure_after":-93898012.79387403,"singular_disclosure_allowed":true,"vote_count":7,"voters":["ali","eveeez","japz","hkr0x01","cryptographer","jatacheers","elf450"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2740822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I forgot to mention in the description, but this is only fixed in the most recent 10.7.x branch of Gitlab. The accidental fix above never made it into the 10.6.x or 10.5.x branches. This might be something that should be back-ported to these versions. ","automated_response":false,"created_at":"2018-05-14T18:07:37.253Z","updated_at":"2018-05-14T18:07:37.253Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2740824,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-05-14T18:08:00.973Z","updated_at":"2018-05-14T18:08:00.973Z","additional_data":{"old_title":"Persistent XSS - Deleting a project (No Longer Vulnerable)","new_title":"Persistent XSS - Deleting a project (No Longer Vulnerable in 10.7)"},"actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2740826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, I'd like to apologize for sending this report 2 weeks after my two previous reports. I know they are similar, but I honestly found this one on accident. I am keeping my username string to the same vulnerable img tag, and it just pops up in unexpected places :(","automated_response":false,"created_at":"2018-05-14T18:09:36.170Z","updated_at":"2018-05-14T18:09:36.170Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2746841,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Phillip,\n\nThank you for reporting this issue.  The normal security release process is to backport to the latest 3 releases, so I have asked the engineering team to track progress and backport in the same release as the others, https://gitlab.com/gitlab-org/gitlab-ce/issues/45994.  We will make the issue public 30 days after the patch is released.  \n\nRegards,\nAntony","automated_response":false,"created_at":"2018-05-15T14:55:02.184Z","updated_at":"2018-05-15T14:55:02.184Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2938146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@asaba I have an issue with this report. You mention this vulnerability in the Gitlab issue here: https://gitlab.com/gitlab-org/gitlab-ce/issues/45994#note_73213022 which has now been made public.\n\nIt says it needs to be backported, yet the latest release (10.6.6) doesn't seem to fix this issue and the release notes don't mention this report or fix.\n\nCould you either a) Delete the comment in the public Gitlab issue and any other comments I may not have found or b) if this was indeed fixed and I'm just missing it, could you point me to where it was fixed.\n\nThanks so much!","automated_response":false,"created_at":"2018-06-26T20:59:50.494Z","updated_at":"2018-06-26T20:59:50.494Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2938157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"or alternatively c) Gitlab is not fixing this security vulnerability (and it was never mentioned in the gitlab issue or this report)","automated_response":false,"created_at":"2018-06-26T21:03:41.011Z","updated_at":"2018-06-26T21:03:41.011Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2938612,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the heads up.  I think this got lost in between the security releases, and since as of the 11.0.x release about 1 month ago, 10.6.6 is no longer supported and won't be receiving any more backports.\n\nRegards,\nAntony","automated_response":false,"created_at":"2018-06-27T00:01:46.716Z","updated_at":"2018-06-27T00:01:46.716Z","actor":{"username":"asaba","cleared":false,"url":"/asaba","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/261/798/9526c5243e43f554dd0a5b900547c1f5ea6751ea_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2941092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, that is unfortunate. Can this be made public along with other my other two reports in hackerone?","automated_response":false,"created_at":"2018-06-27T14:16:04.481Z","updated_at":"2018-06-27T14:16:04.481Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3162098,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Pinging again to have this made public and closed out.","automated_response":false,"created_at":"2018-08-08T15:43:26.764Z","updated_at":"2018-08-08T15:43:26.764Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3265051,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jritchey requesting this be public.","automated_response":false,"created_at":"2018-08-29T17:50:36.189Z","updated_at":"2018-08-29T17:50:36.189Z","actor":{"username":"phillycheeze","cleared":false,"url":"/phillycheeze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3364403,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@phillycheeze Setting to public since this has already been resolved. Apologies for the delay","automated_response":false,"created_at":"2018-09-20T20:02:23.082Z","updated_at":"2018-09-20T20:02:23.082Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"phillycheeze","url":"/phillycheeze"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3364404,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-09-20T20:02:30.069Z","updated_at":"2018-09-20T20:02:30.069Z","first_to_agree":true,"actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3364406,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2018-09-20T20:02:52.374Z","updated_at":"2018-09-20T20:02:52.374Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}