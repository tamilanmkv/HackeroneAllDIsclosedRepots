{"id":507303,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDczMDM=","url":"https://hackerone.com/reports/507303","title":"[file-browser] Inadequate Output Encoding and Escaping ","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-03-10T04:04:35.878Z","submitted_at":"2019-03-10T04:04:35.878Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"johnssimon007","url":"/johnssimon007","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-29T16:24:06.082Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-12-30T16:24:02.252Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report stored xss in file-browser module\nIt allows an attacker to embed malicious js code as filenames,which get executed once browsed to the file over the web browser\n\n# Module\n\n**module name:** file-browser\n**version:** 0.0.5\n**npm page:** https://www.npmjs.com/package/file-browser\n\n## Module Description\nfile-browser is a utility to browse files on your file system using your browser. Its equivalent of creating a file share that can be accessed over http. Using this you can share files between different machines, and across different operating systems.\n\n\n## Vulnerability Description\n\ndue to improper output encoding and escaping ,it was possible for an attacker to embed malicious js code as filenames,which get executed once browsed to the file over the web browser\n## Steps To Reproduce:\n1.  npm -g install file-browser\n\n2.now running below command will start a file server on the specified port:\n  file-browser\n\n3.now create a file with xss payload as filename in current dir\n\ntouch '\"\u003e\u003cimg src=x onerror=alert(\"xss\")\u003e.jpg'\n\n4.now goto url at which the file server is running\n\nhttp://127.0.0.1:8088/lib/template.html\n\nnow xss will popup\n\n## Supporting Material/References:\n\n- [OPERATING SYSTEM VERSION] Kali linux\n- [NODEJS VERSION] 11.8.0\n- [NPM VERSION] 6.5.0\n\n# Wrap up\n\n\u003e Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nthis could have enabled an attacker to execute malicous js code which might lead to session stealing,hooking up browser with frameworks like beef and so on","vulnerability_information_html":"\u003cp\u003eI would like to report stored xss in file-browser module\u003cbr\u003e\nIt allows an attacker to embed malicious js code as filenames,which get executed once browsed to the file over the web browser\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e file-browser\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.0.5\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ca title=\"https://www.npmjs.com/package/file-browser\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Ffile-browser\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/file-browser\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003efile-browser is a utility to browse files on your file system using your browser. Its equivalent of creating a file share that can be accessed over http. Using this you can share files between different machines, and across different operating systems.\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003edue to improper output encoding and escaping ,it was possible for an attacker to embed malicious js code as filenames,which get executed once browsed to the file over the web browser\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e npm -g install file-browser\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e2.now running below command will start a file server on the specified port:\u003cbr\u003e\n  file-browser\u003c/p\u003e\n\n\u003cp\u003e3.now create a file with xss payload as filename in current dir\u003c/p\u003e\n\n\u003cp\u003etouch \u0026#39;\u0026quot;\u0026gt;\u0026lt;img src=x onerror=alert(\u0026quot;xss\u0026quot;)\u0026gt;.jpg\u0026#39;\u003c/p\u003e\n\n\u003cp\u003e4.now goto url at which the file server is running\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://127.0.0.1:8088/lib/template.html\" href=\"/redirect?url=http%3A%2F%2F127.0.0.1%3A8088%2Flib%2Ftemplate.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://127.0.0.1:8088/lib/template.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003enow xss will popup\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e[OPERATING SYSTEM VERSION] Kali linux\u003c/li\u003e\n\u003cli\u003e[NODEJS VERSION] 11.8.0\u003c/li\u003e\n\u003cli\u003e[NPM VERSION] 6.5.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSelect Y or N for the following statements:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ethis could have enabled an attacker to execute malicous js code which might lead to session stealing,hooking up browser with frameworks like beef and so on\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":438480,"file_name":"Screenshot_from_2019-03-10_09-34-59.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/438/480/a266c09967856144c6d7d575aad0bc99bbd46485/Screenshot_from_2019-03-10_09-34-59.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-03-10_09-34-59.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-03-10_09-34-59.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061143Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=234bb7df768f55b0bf8280515b7c5587d3cbfac5a67eb43008a416e096fa278b","file_size":52122,"type":"image/png"}],"allow_singular_disclosure_at":"2020-01-29T16:24:02.334Z","allow_singular_disclosure_after":-28907260.951554537,"singular_disclosure_allowed":true,"vote_count":1,"voters":["duckoverflow"],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4293060,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-03-10T04:04:41.704Z","updated_at":"2019-03-10T04:04:41.704Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4319575,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T22:39:58.586Z","updated_at":"2019-03-13T22:39:58.586Z","additional_data":{"old_title":"Stored xss due to Inadequate Output Encoding and Escaping ","new_title":"[file-browser] Inadequate Output Encoding and Escaping "},"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4319594,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\n\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T22:43:32.663Z","updated_at":"2019-03-13T22:43:32.663Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4732936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Theres seems to be no response from package manager @ronperris .what should we do now?.disclose and close this issue as resolved?","markdown_message":"\u003cp\u003eTheres seems to be no response from package manager \u003ca href=\"/ronperris\"\u003e@ronperris\u003c/a\u003e .what should we do now?.disclose and close this issue as resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-03T17:07:21.995Z","updated_at":"2019-05-03T17:07:21.995Z","actor":{"username":"johnssimon007","cleared":false,"url":"/johnssimon007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6660266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we just close this as resolved ","markdown_message":"\u003cp\u003eCan we just close this as resolved \u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-30T16:18:28.449Z","updated_at":"2019-12-30T16:18:28.449Z","actor":{"username":"johnssimon007","cleared":false,"url":"/johnssimon007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6660292,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-30T16:22:42.787Z","updated_at":"2019-12-30T16:22:42.787Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"johnssimon007","url":"/johnssimon007"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6660296,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-30T16:24:02.265Z","updated_at":"2019-12-30T16:24:02.265Z","first_to_agree":true,"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6900476,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-29T16:24:06.101Z","updated_at":"2020-01-29T16:24:06.101Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}