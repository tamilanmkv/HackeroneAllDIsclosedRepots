{"id":610219,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MTAyMTk=","url":"https://hackerone.com/reports/610219","title":"Stored XSS via Create Project (Add new translation project)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-12T14:28:32.362Z","submitted_at":"2019-06-12T14:28:32.362Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"th3_alchem1st","url":"/th3_alchem1st","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/134/882/2beb5379620c650fabafc69061a17cf9cb9cccf9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-09T13:43:21.812Z","bug_reporter_agreed_on_going_public_at":"2019-06-25T13:44:29.474Z","team_member_agreed_on_going_public_at":"2019-07-09T13:43:21.692Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, Input validation and/or sanitisation is not currently applied in the **Project Name** field in https://\u003cdomain\u003e/create/project/. As, a result, it is possible to have a stored XSS that will affect all the users in the Weblate application. To identify this XSS I used the Docker environment from https://github.com/WeblateOrg/docker.\n\n**Steps to reproduce:**\n\n1. Administrator creates a project and then adds a user in that project.\n2. Depending on permissions the user will login go to **watched projects** pick the project -\u003e **Manage** -\u003e **Settings** and will have the ability to change the Project Name. Here I changed it to `\u003csvg/onload=alert(document.domain)\u003e` and hit save.\n3. When the user visits his `/accounts/profile/` page, he will trigger the Stored XSS.\n\nI also found that even a user that doesn't have access to that project, but I guess the project is public, he will also get xss'ed. Furthermore, with this he also has the ability to xss the Admin, all the have to do is visit the `/accounts/profile/` page.\n\nSo, this has the potential to affect all users.\n\n## Impact\n\nInput validation and/or sanitisation on the Project Name field.\n\nPlease let me know if you require any additional information regarding this issue.\n\nThanks.","vulnerability_information_html":"\u003cp\u003eHi, Input validation and/or sanitisation is not currently applied in the \u003cstrong\u003eProject Name\u003c/strong\u003e field in https://\u0026lt;domain\u0026gt;/create/project/. As, a result, it is possible to have a stored XSS that will affect all the users in the Weblate application. To identify this XSS I used the Docker environment from \u003ca title=\"https://github.com/WeblateOrg/docker\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fdocker\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/docker\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAdministrator creates a project and then adds a user in that project.\u003c/li\u003e\n\u003cli\u003eDepending on permissions the user will login go to \u003cstrong\u003ewatched projects\u003c/strong\u003e pick the project -\u0026gt; \u003cstrong\u003eManage\u003c/strong\u003e -\u0026gt; \u003cstrong\u003eSettings\u003c/strong\u003e and will have the ability to change the Project Name. Here I changed it to \u003ccode\u003e\u0026lt;svg/onload=alert(document.domain)\u0026gt;\u003c/code\u003e and hit save.\u003c/li\u003e\n\u003cli\u003eWhen the user visits his \u003ccode\u003e/accounts/profile/\u003c/code\u003e page, he will trigger the Stored XSS.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI also found that even a user that doesn\u0026#39;t have access to that project, but I guess the project is public, he will also get xss\u0026#39;ed. Furthermore, with this he also has the ability to xss the Admin, all the have to do is visit the \u003ccode\u003e/accounts/profile/\u003c/code\u003e page.\u003c/p\u003e\n\n\u003cp\u003eSo, this has the potential to affect all users.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eInput validation and/or sanitisation on the Project Name field.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you require any additional information regarding this issue.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":507694,"file_name":"xss-weblate.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/507/694/36e1f8aafdec09fcbf3db41c9de2b6c32a0ee342/xss-weblate.png?response-content-disposition=attachment%3B%20filename%3D%22xss-weblate.png%22%3B%20filename%2A%3DUTF-8%27%27xss-weblate.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=d5271a316c53d20ec0b6f27d7153189f28b62e85684adfd418fe4a47cfed5c2f","file_size":42770,"type":"image/png"}],"allow_singular_disclosure_at":"2019-07-25T13:44:29.569Z","allow_singular_disclosure_after":-45161144.794911355,"singular_disclosure_allowed":true,"vote_count":11,"voters":["mashoud1122","th3_alchem1st","akaash_pantherdefence","xaleraf4ra","cryptographer","0x08","jyiue","paradoxbacklash","mxgc","lgian","and 1 more..."],"severity":{"rating":"medium","score":4.7,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":175,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/WeblateOrg/docker","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5069493,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T14:29:17.048Z","updated_at":"2019-06-12T14:29:17.048Z","additional_data":{"old_title":"Stored XSS via Create Project","new_title":"Stored XSS via Create Project (Add new translation project)"},"actor":{"username":"th3_alchem1st","cleared":false,"url":"/th3_alchem1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/882/2beb5379620c650fabafc69061a17cf9cb9cccf9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5073276,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-12T18:19:59.011Z","updated_at":"2019-06-12T18:19:59.011Z","additional_data":{"old_severity":"Medium (6.3)","new_severity":"Medium (4.7)","old_severity_id":423007,"new_severity_id":423808},"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5073278,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report. It's a bug in third party library we use. I've proposed the fix them here: https://github.com/fabianlindfors/multi.js/pull/34\n\nIt has been fixed directly in Weblate by https://github.com/WeblateOrg/weblate/commit/337797d2e12c082752d4205f282a092eed4bdde6","markdown_message":"\u003cp\u003eThanks for your report. It\u0026#39;s a bug in third party library we use. I\u0026#39;ve proposed the fix them here: \u003ca title=\"https://github.com/fabianlindfors/multi.js/pull/34\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffabianlindfors%2Fmulti.js%2Fpull%2F34\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/fabianlindfors/multi.js/pull/34\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt has been fixed directly in Weblate by \u003ca title=\"https://github.com/WeblateOrg/weblate/commit/337797d2e12c082752d4205f282a092eed4bdde6\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fweblate%2Fcommit%2F337797d2e12c082752d4205f282a092eed4bdde6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/weblate/commit/337797d2e12c082752d4205f282a092eed4bdde6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-12T18:20:27.899Z","updated_at":"2019-06-12T18:20:27.899Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"th3_alchem1st","url":"/th3_alchem1st"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5080646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!!Great response time!","markdown_message":"\u003cp\u003eThanks!!Great response time!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-13T15:32:31.955Z","updated_at":"2019-06-13T15:32:31.955Z","actor":{"username":"th3_alchem1st","cleared":false,"url":"/th3_alchem1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/882/2beb5379620c650fabafc69061a17cf9cb9cccf9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5191435,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-25T13:44:29.527Z","updated_at":"2019-06-25T13:44:29.527Z","first_to_agree":true,"actor":{"username":"th3_alchem1st","cleared":false,"url":"/th3_alchem1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/882/2beb5379620c650fabafc69061a17cf9cb9cccf9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5281608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Shall we?\n\nThanks.","markdown_message":"\u003cp\u003eShall we?\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-09T13:41:28.939Z","updated_at":"2019-07-09T13:41:28.939Z","actor":{"username":"th3_alchem1st","cleared":false,"url":"/th3_alchem1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/134/882/2beb5379620c650fabafc69061a17cf9cb9cccf9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5281622,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-09T13:43:21.746Z","updated_at":"2019-07-09T13:43:21.746Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5281623,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-09T13:43:21.835Z","updated_at":"2019-07-09T13:43:21.835Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}