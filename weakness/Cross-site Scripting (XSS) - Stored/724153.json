{"id":724153,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MjQxNTM=","url":"https://hackerone.com/reports/724153","title":"XSS (leads to arbitrary file read in Rocket.Chat-Desktop)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-10-28T19:11:09.189Z","submitted_at":"2019-10-28T19:11:09.189Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sectex","url":"/sectex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-01-02T16:19:08.554Z","bug_reporter_agreed_on_going_public_at":"2020-01-02T16:19:08.515Z","team_member_agreed_on_going_public_at":"2020-01-02T16:18:18.276Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description:** Rocket.Chat allows administrative users to customize the home body. Since `\u003cscript\u003e` tags are removed, I think that running scripts should not be allowed. However, event handlers are not removed, allowing you to inject your own scripts.\n\n## Releases Affected:\n\n  * Rocket.Chat-Desktop-Client: v2.15.5\n  * Rocket.Chat-Server: v2.0.0\n  * Apps-Engine-Version: v1.5.2\n\n## Steps To Reproduce (from initial installation to vulnerability):\n\n  - Go to `Administration » Layout » Content`\n  - Set `Home Body` to `\u003cimg src=0 onerror=\"alert(0)\"/\u003e`\n  - Visit `/home`\n\n### Arbitrary file read in Rocket.Chat-Desktop\n\n  - Go to `Administration » Layout » Content`\n  - Set `Home Body` to `\u003ciframe src=\"file://c:/windows/system32/drivers/etc/hosts\" onload=\"alert(iframe.contentDocument.body.innerHTML)\" id=\"iframe\"\u003e\u003c/iframe\u003e`\n  - Visit `/home`\n\n## Supporting Material/References:\n\n  * {F613006}\n  * {F613007}\n  * {F620074}\n\n## Impact\n\n* Attackers can execute scripts which leads to arbitrary file read and rce in Rocket.Chat-Desktop","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":613006,"file_name":"admin-panel.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RRG2vdBhWcrhTEwKmrFCfdYz?response-content-disposition=attachment%3B%20filename%3D%22admin-panel.png%22%3B%20filename%2A%3DUTF-8%27%27admin-panel.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152026Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ca2c752da16dd96ba84a02dfcf504bba169866a8eaf974ed783bfc9d338b3187","file_size":62776,"type":"image/png"},{"id":613007,"file_name":"alert.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BMQe9NQrEi1rk4dTifu39cMi?response-content-disposition=attachment%3B%20filename%3D%22alert.png%22%3B%20filename%2A%3DUTF-8%27%27alert.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152026Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6f22f3c8db48ee72031b99b6312caa1c99c477ad7745682ddecc522745e92424","file_size":50117,"type":"image/png"},{"id":620074,"file_name":"arbitrary_file_read.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nQtJYBMvQRabVVWMKukXTU7W?response-content-disposition=attachment%3B%20filename%3D%22arbitrary_file_read.mp4%22%3B%20filename%2A%3DUTF-8%27%27arbitrary_file_read.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152026Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7fcd1da8effd5cbf99165bd49ad7ee6639ac3d3a9b8c59c09fb206eb56b513f7","file_size":902197,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-02-01T16:18:18.343Z","allow_singular_disclosure_after":-53391728.64838303,"singular_disclosure_allowed":true,"vote_count":10,"voters":["0xmagna","mashoud1122","streghdev","sourceflow","cryptographer","mhaja7","majidhussien","thasmokey","b7845ae0fc9e3b4a2072a01","cailleach_"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6158103,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've noticed that fixing the initial xss won't fix the arbitrary file read problem, since `\u003ciframe src=\"https://sectex.dev/dev/index.html\"\u003e\u003c/iframe\u003e` will also lead to arbitrary file read.","automated_response":false,"created_at":"2019-10-28T19:53:25.348Z","updated_at":"2019-10-28T19:53:25.348Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6173023,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've cloned [Rocket.Chat.Electron](https://github.com/RocketChat/Rocket.Chat.Electron) and found out that removing line 46 in `/src/scripts/webview.js` will fix the arbitrary file read problem.\n\n`/src/scripts/webview.js` (line 41- 46):\n````javascript\nwebviewObj = document.createElement('webview');\nwebviewObj.classList.add('webview');\nwebviewObj.setAttribute('server', host.url);\nwebviewObj.setAttribute('preload', '../preload.js');\nwebviewObj.setAttribute('allowpopups', 'on');\n// webviewObj.setAttribute('disablewebsecurity', 'on');\n```\n","automated_response":false,"created_at":"2019-10-30T12:40:18.458Z","updated_at":"2019-10-30T12:40:18.458Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6173631,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-10-30T14:11:03.349Z","updated_at":"2019-10-30T14:11:03.349Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":551766},"actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6173635,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @sectex \n\nthanks for your report - and for your recommendation! We are currently looking into this and will be in touch soon.\n\nBest Markus","automated_response":false,"created_at":"2019-10-30T14:11:08.777Z","updated_at":"2019-10-30T14:11:08.777Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6430608,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @sectex \n\nabout this one: we have issued a fix that has been merged and will go out with the next version.\nPlease let us know if you think the problem still persists.\n\nMany thanks for reporting this to us. You helped to make Rocket.Chat more secure for millions of users!\n\nBest\nMarkus","automated_response":false,"created_at":"2019-11-29T03:44:36.740Z","updated_at":"2019-11-29T03:44:36.740Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sectex","url":"/sectex"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6506608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm that the arbitrary file read-problem is fixed in v2.17.0.\nThe initial XSS issue isn't fixed, but since you need administrative permissions and can also provide scripts via `Administration » Layout » Custom Scripts` I think the impact is very low.\n\n### Releases:\n* Rocket.Chat-Server: v3.0.0-develop\n* Apps-Engine-Version: v1.11.0\n* Rocket.Chat-Desktop: v2.17.0\n\nBest\nSecTex","automated_response":false,"created_at":"2019-12-09T20:39:18.934Z","updated_at":"2019-12-09T20:39:18.934Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6665427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @markus-rocketchat,\nIs it ok to disclose this one? ","automated_response":false,"created_at":"2019-12-31T13:37:01.896Z","updated_at":"2019-12-31T13:37:01.896Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6674563,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-02T16:18:18.291Z","updated_at":"2020-01-02T16:18:18.291Z","first_to_agree":true,"actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6674572,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-01-02T16:19:08.527Z","updated_at":"2020-01-02T16:19:08.527Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6674573,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-01-02T16:19:08.565Z","updated_at":"2020-01-02T16:19:08.565Z","actor":{"username":"sectex","cleared":false,"url":"/sectex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CSUnU375phaRJUJwg9DWs52s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}