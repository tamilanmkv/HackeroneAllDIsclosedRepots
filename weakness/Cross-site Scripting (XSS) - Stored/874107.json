{"id":874107,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzQxMDc=","url":"https://hackerone.com/reports/874107","title":"[my.games] Stored XSS via untrusted bucket","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-14T11:37:28.792Z","submitted_at":"2020-05-14T11:37:28.792Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"byq","url":"/byq","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-04T16:10:16.616Z","bug_reporter_agreed_on_going_public_at":"2020-05-18T11:17:50.433Z","team_member_agreed_on_going_public_at":"2020-06-04T16:10:16.512Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nhttps://my.games/\n\nDetails\n--\nIf you check page source of https://my.games, you can notice that site gets static files (scripts, styles, images) using following URL declaration:\nhttps://my.games/hotbox/mygames/frontend/v3-6-13/img/share/main.png\n\n**mygames** here is a name of S3 bucket.\nAfter creating own S3 bucket in AWS and using https://my.games/hotbox/BUCKET_NAME/, I got \"NoSuchBucket\" error.\n\nBut my comrade investigated, that *hotbox* is one of the available types of S3 bucket in MCS.\n\n...\n\nPreconditions\n--\n1) Create your S3 bucket at https://mcs.mail.ru/app/services/storage/buckets/.\n2) Upload any malicious file (e.g. HTML page).\n3) Make this file public.\n\nSteps to reproduce\n--\n1)  Open following link in browser:\nhttps://my.games/hotbox/YOUR_BUCKET_NAME/YOUR_FILE_NAME\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\nhttps://my.games/hotbox/foobar1337/oops.html\n{F828044}\n\n## Impact\n\nAn attacker can host any malicious file on **my.games** domain.","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":828044,"file_name":"hotbox.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/DW2ZB8BKf6uo7QGcDpu57J16?response-content-disposition=attachment%3B%20filename%3D%22hotbox.png%22%3B%20filename%2A%3DUTF-8%27%27hotbox.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153646Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=86c604629c5ba85e43316f685efb8d7d0cbb1ee6fe3dc4d60496df588b978456","file_size":9946,"type":"image/png"}],"allow_singular_disclosure_at":"2020-06-17T11:17:50.492Z","allow_singular_disclosure_after":-41573935.92954047,"singular_disclosure_allowed":true,"vote_count":11,"voters":["act1on3","mashoud1122","brahim_boufakri01","ali","naategh","klau5","iamcoolcat","ba2sik","sn0wb4ll","danielcollins104","and 1 more..."],"severity":{"rating":"medium","score":4.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":46691,"asset_type":"OTHER","asset_identifier":"MY.GAMES","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7999169,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2020-05-14T11:38:28.684Z","updated_at":"2020-05-14T11:38:28.684Z","actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"email":"waken","genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7999174,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2020-05-14T11:39:41.684Z","updated_at":"2020-05-14T11:39:41.684Z","actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"email":"sergeviper","genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7999209,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2020-05-14T11:43:17.444Z","updated_at":"2020-05-14T11:43:17.444Z","actor":{"username":"waken","cleared":false,"url":"/waken","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBaFdyIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--f1df5da93f6f9e1eedc35a7db0e8414622c1a42f/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--77c08f2719fd83c761685e25b4e275ffff9dba3e/unnamed.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7999210,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2020-05-14T11:43:18.472Z","updated_at":"2020-05-14T11:43:18.472Z","actor":{"username":"sergeviper","cleared":false,"url":"/sergeviper","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7999242,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report to Mail.Ru Group! We appreciate your time for helping us to make our web services safer.\n\nYour report have passed an initial review and was assigned to security engineer. Security engineer will contact you only if there are any questions on reproducing the bug or some additional information from you is required. He will manage the patching process. Once the bug is completely fixed, this report is transferred to \"Resolved\" state, it can take some time.\n\nUnfortunately,  your report is not eligible for monetary reward (check the [rules](https://hackerone.com/mailru)). We say \"thank you\" for your help and contribution.","automated_response":false,"created_at":"2020-05-14T11:46:28.664Z","updated_at":"2020-05-14T11:46:28.664Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8031883,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","automated_response":false,"created_at":"2020-05-18T09:07:31.094Z","updated_at":"2020-05-18T09:07:31.094Z","actor":{"username":"majes7ic","cleared":false,"url":"/majes7ic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"byq","url":"/byq"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8033649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The fix is confirmed.","automated_response":false,"created_at":"2020-05-18T11:17:25.647Z","updated_at":"2020-05-18T11:17:25.647Z","actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8033652,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-18T11:17:50.455Z","updated_at":"2020-05-18T11:17:50.455Z","first_to_agree":true,"actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8069482,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2020-05-21T14:32:48.152Z","updated_at":"2020-05-21T14:32:48.152Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8199897,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-04T12:27:51.382Z","updated_at":"2020-06-04T12:27:51.382Z","additional_data":{"old_severity":"Low","new_severity":"Medium (4.2)","old_severity_id":721574,"new_severity_id":740628},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8202756,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-04T16:10:16.545Z","updated_at":"2020-06-04T16:10:16.545Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8202757,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-06-04T16:10:16.653Z","updated_at":"2020-06-04T16:10:16.653Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8205822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @3apa3a,\n\nMay I add more detailed summary?","automated_response":false,"created_at":"2020-06-04T21:54:13.723Z","updated_at":"2020-06-04T21:54:13.723Z","actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8213739,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, you can add a summary at your wish","automated_response":false,"created_at":"2020-06-05T15:57:22.903Z","updated_at":"2020-06-05T15:57:22.903Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8213808,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Or we can perform a full disclosure","automated_response":false,"created_at":"2020-06-05T15:58:08.573Z","updated_at":"2020-06-05T15:58:08.573Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8216921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@3apa3a, lets perform a full disclosure.\nThanks.","automated_response":false,"created_at":"2020-06-05T21:47:33.816Z","updated_at":"2020-06-05T21:47:33.816Z","actor":{"username":"byq","cleared":true,"url":"/byq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uNECWFiUfUbTGcG1AisitBfx/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":22827,"category":"team","content":"Proxy pass for the path in my.games domain was misconfigured to point to the root of public S3 storage, allowing to place static content in the domain path leading to XSS possibility.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}