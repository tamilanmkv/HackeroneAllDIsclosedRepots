{"id":1042141,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQyMTQx","url":"https://hackerone.com/reports/1042141","title":"Some build dependencies are downloaded over an insecure channel (without subsequent integrity checks)","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2020-11-24T11:16:10.779Z","submitted_at":"2020-11-24T11:16:10.822Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jub0bs","url":"/jub0bs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/qX8TTT53LWPd6ffViJtFzBht/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-01-26T16:46:32.183Z","bug_reporter_agreed_on_going_public_at":"2021-01-25T20:53:11.875Z","team_member_agreed_on_going_public_at":"2021-01-26T16:46:32.100Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The [`script` phase of pdns's `.travis.yml` file](https://github.com/PowerDNS/pdns/blob/master/.travis.yml#L29) runs a script named `./build-scripts/travis.sh`. The main path of execution of this script downloads two dependencies (`libsodium_dev` and `libsodium13`) via `wget` over an insecure channel (i.e. using `http` rather than `https`). Further evidence of this can be found in the Travis build logs:\n\n* https://travis-ci.com/github/PowerDNS/pdns/jobs/446241837#L888\n* https://travis-ci.com/github/PowerDNS/pdns/jobs/446241837#L900\n\nAs far as I can tell, no sanity check is performed after these two dependencies have been downloaded.\n\n---\n\nIncidentally, an insecure channel is also used elsewhere in the project:\n\n* https://github.com/PowerDNS/pdns/blob/1640981aa5dee878959cdf18b44088dc3bfdc342/build-scripts/travis.sh#L211\n* https://github.com/PowerDNS/pdns/blob/1640981aa5dee878959cdf18b44088dc3bfdc342/build-scripts/travis.sh#L345\n* https://github.com/PowerDNS/pdns/blob/1640981aa5dee878959cdf18b44088dc3bfdc342/build-scripts/travis.sh#L367\n* https://github.com/PowerDNS/pdns/blob/fb8b7ee85f5d595f3f92ea86859843b0a5719979/build-scripts/test-recursor-bulk#L16\n\n## Impact\n\nDependencies downloaded over an insecure channel can be intercepted and tampered with by a person in the middle (i.e. some agent controlling an intermediate node on the network path between Travis CI's build servers and where those dependencies are hosted).\n\nMoreover, as no integrity checks seem to be performed after download, a person-in-the-middle attack would go undetected and could compromise the integrity of the build artifacts. I think you'll agree that, given the sensitive nature of a tool like PowerDNS, the possibility of corruption of the build artifacts should be eliminated.\n\nPlease do not dismiss the possibility of such an attack too quickly, as it is [not as far-fetched as one would think](https://medium.com/bugbountywriteup/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb). Some ISPs [routinely tamper with http traffic](https://thenextweb.com/insights/2017/12/11/comcast-continues-to-inject-its-own-code-into-websites-you-visit/) and [rogue ISPs are not unheard of](https://arstechnica.com/tech-policy/2010/05/rogue-isp-ordered-to-liquidate-owes-ftc-108-million/).","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["pyrrhon","elz2204","aslonjon"],"severity":{"rating":"medium","score":6.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":42903,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/PowerDNS/pdns","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9911023,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi,\n\nThank your for this report. We don't really care about the risk of a man-in-the-middle attacker tampering with these files because we only use Travis CI for running our tests. There are simply no build artifacts to consider. Our packages are built on private workers, and don't use these files.\n\nBest regards,\n\nRemi","automated_response":false,"created_at":"2020-11-24T11:50:37.452Z","updated_at":"2020-11-24T11:50:37.452Z","actor":{"username":"rgacogne","cleared":false,"url":"/rgacogne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/055/239/a3503ea8f701a567579e9aa3c6eebafbec50fe2d_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9911054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rgacogne Thanks for your reply. Fair enough. Better be safe than sorry!","automated_response":false,"created_at":"2020-11-24T11:54:47.172Z","updated_at":"2020-11-24T11:54:47.172Z","actor":{"username":"jub0bs","cleared":false,"url":"/jub0bs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qX8TTT53LWPd6ffViJtFzBht/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10477068,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this?","automated_response":false,"created_at":"2021-01-25T20:53:11.901Z","updated_at":"2021-01-25T20:53:11.901Z","first_to_agree":true,"actor":{"username":"jub0bs","cleared":false,"url":"/jub0bs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qX8TTT53LWPd6ffViJtFzBht/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10485292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-26T16:46:32.122Z","updated_at":"2021-01-26T16:46:32.122Z","actor":{"username":"rgacogne","cleared":false,"url":"/rgacogne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/055/239/a3503ea8f701a567579e9aa3c6eebafbec50fe2d_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10485293,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-26T16:46:32.213Z","updated_at":"2021-01-26T16:46:32.213Z","actor":{"username":"rgacogne","cleared":false,"url":"/rgacogne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/055/239/a3503ea8f701a567579e9aa3c6eebafbec50fe2d_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}