{"id":144782,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDQ3ODI=","url":"https://hackerone.com/reports/144782","title":"CVE-2016-0772 - python: smtplib StartTLS stripping attack","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-14T21:25:40.562Z","submitted_at":"2016-06-14T21:25:40.562Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hxd","url":"/hxd","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27,"url":"https://hackerone.com/ibb-python","handle":"ibb-python","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Python (IBB)","twitter_handle":"","website":"http://www.python.org/news/security","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-30T17:19:36.337Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-07-31T17:19:23.214Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"python smtplib starttls stripping attack\n\n* affects: (basically all versions of smtplib with starttls support and projects relying on it)\n * python 2.7.2 - 2.7.11 (dates back ~14 years)\n * python 3.0 - 3.5.1 (dates back ~7 years)\n\nPython's implementation of `smtplib` fails to raise an exception upon an unexpected response during negotiation of tls via the starttls protocol. This allows a MiTM capable of injecting smtp messages to force smtplib to **silently** abort tls negotiation proceeding to transmit cleartext. (impacting confidentiality)\nFor more details see [1]\npotentially affects a variety of open source projects from Django, web2py, ...\n\ninitially reported to python PSRT (timeline see [1]) with details, PoC [2] and patch [2]. The patch was accepted and recently landed in python 2.7/3.x [3,4].\nfull details and the actual research material that was securely disclosed to Python PSRT will be made available at [1] (currently a preliminary vulnerability note)\n\nthe PoC `striptls` [2] is a generic protocol independent tls interception proxy written in python that is also capable of probing for various starttls stripping vectors in smtp, pop3, imap, ftp, xmpp, acap and irc. It is also available via `pip install striptls` (pretty handy for sniffing/proxying proprietary protocols based on top of implicit/explicit tls)\n\nVendor announcements: [5,6,7]\n\nthe preliminary vulnerability note [1] will be updated in accordance with the Python software release scheduled for June 26th.\n\n[1] https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772\n[2] https://github.com/tintinweb/striptls\n[3] https://hg.python.org/cpython/rev/d590114c2394\n[4] https://hg.python.org/cpython/rev/b3ce713fb9be\n[5] http://www.openwall.com/lists/oss-security/2016/06/14/9\n[6] https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-0772\n[7] https://access.redhat.com/security/cve/cve-2016-0772\n\n","vulnerability_information_html":"\u003cp\u003epython smtplib starttls stripping attack\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eaffects: (basically all versions of smtplib with starttls support and projects relying on it)\n\n\u003cul\u003e\n\u003cli\u003epython 2.7.2 - 2.7.11 (dates back ~14 years)\u003c/li\u003e\n\u003cli\u003epython 3.0 - 3.5.1 (dates back ~7 years)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePython\u0026#39;s implementation of \u003ccode\u003esmtplib\u003c/code\u003e fails to raise an exception upon an unexpected response during negotiation of tls via the starttls protocol. This allows a MiTM capable of injecting smtp messages to force smtplib to \u003cstrong\u003esilently\u003c/strong\u003e abort tls negotiation proceeding to transmit cleartext. (impacting confidentiality)\u003cbr\u003e\nFor more details see [1]\u003cbr\u003e\npotentially affects a variety of open source projects from Django, web2py, ...\u003c/p\u003e\n\n\u003cp\u003einitially reported to python PSRT (timeline see [1]) with details, PoC [2] and patch [2]. The patch was accepted and recently landed in python 2.7/3.x [3,4].\u003cbr\u003e\nfull details and the actual research material that was securely disclosed to Python PSRT will be made available at [1] (currently a preliminary vulnerability note)\u003c/p\u003e\n\n\u003cp\u003ethe PoC \u003ccode\u003estriptls\u003c/code\u003e [2] is a generic protocol independent tls interception proxy written in python that is also capable of probing for various starttls stripping vectors in smtp, pop3, imap, ftp, xmpp, acap and irc. It is also available via \u003ccode\u003epip install striptls\u003c/code\u003e (pretty handy for sniffing/proxying proprietary protocols based on top of implicit/explicit tls)\u003c/p\u003e\n\n\u003cp\u003eVendor announcements: [5,6,7]\u003c/p\u003e\n\n\u003cp\u003ethe preliminary vulnerability note [1] will be updated in accordance with the Python software release scheduled for June 26th.\u003c/p\u003e\n\n\u003cp\u003e[1] \u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-0772\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[2] \u003ca title=\"https://github.com/tintinweb/striptls\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fstriptls\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/striptls\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[3] \u003ca title=\"https://hg.python.org/cpython/rev/d590114c2394\" href=\"/redirect?url=https%3A%2F%2Fhg.python.org%2Fcpython%2Frev%2Fd590114c2394\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hg.python.org/cpython/rev/d590114c2394\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[4] \u003ca title=\"https://hg.python.org/cpython/rev/b3ce713fb9be\" href=\"/redirect?url=https%3A%2F%2Fhg.python.org%2Fcpython%2Frev%2Fb3ce713fb9be\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hg.python.org/cpython/rev/b3ce713fb9be\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[5] \u003ca title=\"http://www.openwall.com/lists/oss-security/2016/06/14/9\" href=\"/redirect?url=http%3A%2F%2Fwww.openwall.com%2Flists%2Foss-security%2F2016%2F06%2F14%2F9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.openwall.com/lists/oss-security/2016/06/14/9\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[6] \u003ca title=\"https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-0772\" href=\"/redirect?url=https%3A%2F%2Fbugzilla.redhat.com%2Fshow_bug.cgi%3Fid%3DCVE-2016-0772\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-0772\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[7] \u003ca title=\"https://access.redhat.com/security/cve/cve-2016-0772\" href=\"/redirect?url=https%3A%2F%2Faccess.redhat.com%2Fsecurity%2Fcve%2Fcve-2016-0772\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://access.redhat.com/security/cve/cve-2016-0772\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-30T17:19:23.340Z","allow_singular_disclosure_after":-136638622.7018307,"singular_disclosure_allowed":true,"vote_count":3,"voters":["secbughunter","dyabla","ranov"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1051477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"updated vulnerability note, all information is now public (+1 week after official python release)\nsee: https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772","markdown_message":"\u003cp\u003eupdated vulnerability note, all information is now public (+1 week after official python release)\u003cbr\u003e\nsee: \u003ca title=\"https://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ftintinweb%2Fpub%2Ftree%2Fmaster%2Fpocs%2Fcve-2016-0772\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/tintinweb/pub/tree/master/pocs/cve-2016-0772\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-03T21:18:05.589Z","updated_at":"2016-07-03T21:18:05.589Z","actor":{"username":"hxd","cleared":false,"url":"/hxd","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1098383,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-31T17:19:08.615Z","updated_at":"2016-07-31T17:19:08.615Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hxd","url":"/hxd"},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1098384,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-31T17:19:15.863Z","updated_at":"2016-07-31T17:19:15.863Z","actor":{"url":"/ibb-python","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Python (IBB)"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-python","collaborator":{"username":"hxd","url":"/hxd"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1098385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-31T17:19:23.299Z","updated_at":"2016-07-31T17:19:23.299Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1162745,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T17:19:36.553Z","updated_at":"2016-08-30T17:19:36.553Z","actor":{"url":"/ibb-python","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Python (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}