{"id":199438,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTk0Mzg=","url":"https://hackerone.com/reports/199438","title":"SWEET32 TLS attack","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2017-01-18T18:03:52.961Z","submitted_at":"2017-01-18T18:03:52.961Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pkkothawade","url":"/pkkothawade","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-2183"],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-01T18:37:05.005Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-01-21T20:06:25.790Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Researchers have found new attack against 3DES-CBC cipher in TLS,that they can decrypt customer data using a method called SWEET32 Birthday Attack.\n\nThis Vulnerability has got CVE-2016-2183 and has cvss score 5.0\n\nThis vulnerability can be found manually by simply using nmap script\n\nnmap -Pn -p --script ssl-enum-ciphers ip\n\nMitigation for SWEET32 attack\n\n-\u003ePrefer minimum 128-bit cipher suites\n\n-\u003eLimit the length of TLS sessions with a 64-bit cipher, which could be done with TLS renegotiation or closing and starting a new connection\n\n-\u003e Disable cipher suites using 3DES","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":153392,"file_name":"legal_robots_sweet32.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/153/392/8b8373775f87df8bddc49b593536171a4cc1527b/legal_robots_sweet32.JPG?response-content-disposition=attachment%3B%20filename%3D%22legal_robots_sweet32.JPG%22%3B%20filename%2A%3DUTF-8%27%27legal_robots_sweet32.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVIDF5ZMX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140032Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQDQQQUuKj8T5pdoqR2Krp3zajoi1gg54vXvD2Ne1FwhmAIhAKKfb3UfAQbrUu4HHC%2B4UyMY7m5fBTHvtLlTV0hUevF7KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igy%2F64SgTlh6KUEnD5Uq1wMsL4Z6ljP60c3R7lO1zjypi9biR2g5iQoP%2FT3s6lOKdbpGuE3RHjMeja9YKKN7goc11u6bYdonocyi6RU8RN2An2aRnhfVo3l%2FZlMwpffUbu5JHc7OKmtZqUXTysPRszIl1CCSQ50yZBwtNWg%2Fxavv6bNKeHjCjYNwQxGBqC%2ByBW24czUMzGzaD5uFMoYGAMoWIxFJ6iHFG8UfXfoB1shKsZ3jkdkCp2MI12RtkuUec%2F0QW%2BSUqdLWUg2p3%2B1H%2FJaoFmNN5Utibk4elkj5kRmoejx7EnpbtxcHN1J6Ccb1mMlapHFqvmkcjE8fLu3vLMoRZX0qMhHcbtwHM4mmdbMGDcLaK4ZzuGUfKK3tlGfzyb%2BJEOYnCFd1OBdp9DB9bhiSMWyc1JifbNweT%2F1X1i3QMSQ%2BviuXf%2Bxvep9dRJ8nErGx9JdRp3yS8jCqdzkSh9FhreaRloo4jHkFXz72rd1zbbphih0VnX1T1kREihWx9RKRGpfOf2ct6w59fDThEMiXM7%2B1ZWMP1qPO2XDz8hAqeQqURPDe5AmiGn%2FZKFThe%2F8xzj0%2B5M2W36t3rKudZmsfzk9t0V0gZgIgIqXzHYE871rDImxmRy6q2HeWGIt10F1JC%2Fc9vpEwvO6QiwY6pAFAIHM092pG3M%2B23%2BPi00SqMMlTN%2FebpZH7d1Rq7%2BpDNNT62MHysMiTIJwmN0mj3cgRIiDLQKqFPlp97hcSQcDzJF%2F5WJ%2FSpWbDFtqVjRTP9eZ3KoMBEOEbvq2IGUFF14lCJNIXEj03clafpnnHjjr5akYILvb51xnKlHai4iTUO00TgVrv5%2FXDjYcFV06nU8YCB3mUWnDHCpTI6c%2BltGO9Yt9pxQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bbc52a92e7583babea5056239e8d9193405d7344b050c002a8197f6ebb6923b6","file_size":123856,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["smsecurity","ramsexy","rbcafe","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1434588,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for the report. However, I think you may have some incorrect information. According to the results from the [SSL Labs report for legalrobot.com](https://www.ssllabs.com/ssltest/analyze.html?d=www.legalrobot.com\u0026s=104.25.126.5\u0026latest), we only allow the following cipher suites:\n\n| TLS 1.2 (we could not determine if the server has a preference)                                      |     | \n|------------------------------------------------------------------------------------------------------|-----| \n| TLS_RSA_WITH_AES_128_CBC_SHA (0x2f)                                                                  | 128 | \n| TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)   ECDH secp256r1 (eq. 3072 bits RSA)   FS                | 128 | \n| TLS_RSA_WITH_AES_128_GCM_SHA256 (0x9c)                                                               | 128 | \n| TLS_RSA_WITH_AES_128_CBC_SHA256 (0x3c)                                                               | 128 | \n| TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 (0xc023)   ECDH secp256r1 (eq. 3072 bits RSA)   FS           | 128 | \n| TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xc027)   ECDH secp256r1 (eq. 3072 bits RSA)   FS             | 128 | \n| TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02b)   ECDH secp256r1 (eq. 3072 bits RSA)   FS           | 128 | \n| TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)   ECDH secp256r1 (eq. 3072 bits RSA)   FS             | 128 | \n| TLS_RSA_WITH_AES_256_CBC_SHA (0x35)                                                                  | 256 | \n| TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)   ECDH secp256r1 (eq. 3072 bits RSA)   FS                | 256 | \n| TLS_RSA_WITH_AES_256_GCM_SHA384 (0x9d)                                                               | 256 | \n| TLS_RSA_WITH_AES_256_CBC_SHA256 (0x3d)                                                               | 256 | \n| TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 (0xc024)   ECDH secp256r1 (eq. 3072 bits RSA)   FS           | 256 | \n| TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02c)   ECDH secp256r1 (eq. 3072 bits RSA)   FS           | 256 | \n| TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xc030)   ECDH secp256r1 (eq. 3072 bits RSA)   FS             | 256 | \n| TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xc028)   ECDH secp256r1 (eq. 3072 bits RSA)   FS             | 256 | \n| TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca9)   ECDH secp256r1 (eq. 3072 bits RSA)   FS     | 256 | \n| OLD_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 (0xcc14)   ECDH secp256r1 (eq. 3072 bits RSA)   FS | 256 | \n| TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca8)   ECDH secp256r1 (eq. 3072 bits RSA)   FS       | 256 | \n| OLD_TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xcc13)   ECDH secp256r1 (eq. 3072 bits RSA)   FS   | 256 | \n\n\n\n| TLS 1.1 (suites in server-preferred order)                                            |     | \n|---------------------------------------------------------------------------------------|-----| \n| TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)   ECDH secp256r1 (eq. 3072 bits RSA)   FS | 128 | \n| TLS_RSA_WITH_AES_128_CBC_SHA (0x2f)                                                   | 128 | \n| TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)   ECDH secp256r1 (eq. 3072 bits RSA)   FS | 256 | \n| TLS_RSA_WITH_AES_256_CBC_SHA (0x35)                                                   | 256 | \n\n\n\n| TLS 1.0 (suites in server-preferred order)                                             |     | \n|----------------------------------------------------------------------------------------|-----| \n| TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)   ECDH secp256r1 (eq. 3072 bits RSA)   FS  | 128 | \n| TLS_RSA_WITH_AES_128_CBC_SHA (0x2f)                                                    | 128 | \n| TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)   ECDH secp256r1 (eq. 3072 bits RSA)   FS  | 256 | \n| TLS_RSA_WITH_AES_256_CBC_SHA (0x35)                                                    | 256 | \n| TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)   ECDH secp256r1 (eq. 3072 bits RSA)   FS | 112 | \n| TLS_RSA_WITH_3DES_EDE_CBC_SHA (0xa)                                                    | 112 | \n\n\nSo perhaps have a look at the full report on ssllabs.com. From there, you can see that we do not use 64 bit cipher suites. All TLS 1.1 and 1.2 are at least 128 bit, though some of the older, low priority TLS 1.0 suites are 112 bit.\n\nSomething important to consider about the SWEET 32 attack: it's largely a problem for services that transfer a significant amount of data over a single TLS session - like a VPN. Even if we were using 64 bit cyphers (which we're not), an attacker would need to examine between 2^29 and 2^36 encrypted 8-bit blocks - that's a whopping 280 to 785GB of traffic from one user during the same TLS session. We use several levels of rate limiting to mitigate other types of attacks, so it would be *extremely difficult* (never say never!) for a user to generate that much traffic without being challenged for a CAPTCHA. To stay under our rate limits, it would be several weeks (or months) before a user could generate that much traffic, even unintentionally. We also automatically log users out well before they could reach that amount of traffic.\n\nWe really do appreciate the report. However, it looks like this one needs some more work. I'll go ahead and set the status to \"Needs more info\" in case I'm missing something.","automated_response":false,"created_at":"2017-01-21T13:01:20.591Z","updated_at":"2017-01-21T13:01:20.591Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434590,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-01-21T13:04:05.696Z","updated_at":"2017-01-21T13:04:05.696Z","additional_data":{"old_title":"legalrobot.com is vulnerable to SWEET32 attack","new_title":"SWEET32 TLS attack"},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434757,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"can you please verify it manually using nmap script why to rely on automated scan report.\nTLS 1.0\nTLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 2048) - C (is using 64 bit cipher)\nverify it manually using nmap with below script\nnmap -Pn -p 443 --script ssl-enum-ciphers 104.25.127.5\nResult clearly shows it is vulnerable to sweet32 attack. as shown  in attached POC\n","automated_response":false,"created_at":"2017-01-21T15:26:21.405Z","updated_at":"2017-01-21T15:26:21.405Z","actor":{"username":"pkkothawade","cleared":false,"url":"/pkkothawade","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1435016,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the info. Yes, I see the output from nmap (we use that tool as well). However, I think you are misinterpreting the output. **Just because a tool warns you about a potential problem doesn't mean it exists in practice.** Using nmap to list the supported cipher suites is one thing, but we use the SSL Labs tool to get more detail on how those cipher suites are being implemented. I suspect SSL Labs uses nmap in their processes but they don't stop there, as your analysis did. If you look at the handshake simulation section of the SSL Labs report, you can see that TLS_RSA_WITH_3DES_EDE_CBC_SHA is only used on Windows XP machines running IE8 (look carefully at the priority of cipher suites). Our web app doesn't work on IE8 - it is not possible for a user to even log in. If a user can't log in, it's not possible for an attacker to observe any sensitive traffic, not to mention the significant amount of data required for the attack. As I detailed above, Sweet32 is primarily a concern for long-lived connections that exchange a whole lot of blocks, like VPNs.\n\nMore mitigating factors: we don't use cookie-based authentication and we do support 2FA. With cookie-based authentication, the token is sent with every request so it is likely to encounter the cookie while digging through 280-785GB of traffic. 2FA is also important because even if an attacker was able to observe and decrypt the exact blocks containing a user's login credentials (statistically very very unlikely, given the volume of data), they couldn't use those credentials on another connection. Also keep in mind there are no reports of this exploit in the wild - this isn't like heart bleed.\n\nAnother matter, your attached \"POC\" is not really a proof-of-concept. It is the print from a standard security tool. A proof of concept would be, for example, a simple demonstration of negotiating a TLS connection with our server using a vulnerable cipher suite, logging in (even manually), then exchanging a *significant* amount of data with our server on that connection (and somehow not getting blocked by CloudFlare or the other automated security tools we use).\n\nSo I'm going to go ahead and close this report as Informative. We will also disclose the full report since there is some useful detail in here that could help the community understand Sweet32 and its real world implications.\n\nWe truly do appreciate your effort to keep our company and our user's data safe and secure. Thanks and happy hacking!","automated_response":false,"created_at":"2017-01-21T20:06:12.752Z","updated_at":"2017-01-21T20:06:12.752Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1435017,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-21T20:06:25.812Z","updated_at":"2017-01-21T20:06:25.812Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1449743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As you belief this vulnerability will not cause any damage and have decided not to fix it..i request you to please disclose it publicly else patch it.","automated_response":false,"created_at":"2017-01-28T19:04:54.256Z","updated_at":"2017-01-28T19:04:54.256Z","actor":{"username":"pkkothawade","cleared":false,"url":"/pkkothawade","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks - disclosing now.","automated_response":false,"created_at":"2017-02-01T18:36:54.973Z","updated_at":"2017-02-01T18:36:54.973Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1456807,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-02-01T18:37:04.989Z","updated_at":"2017-02-01T18:37:04.989Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}