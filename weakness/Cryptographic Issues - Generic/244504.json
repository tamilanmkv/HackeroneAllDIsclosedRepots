{"id":244504,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ1MDQ=","url":"https://hackerone.com/reports/244504","title":"Possible SOP bypass in www.starbucks.com due to insecure crossdomain.xml","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-06-29T20:05:48.533Z","submitted_at":"2017-06-29T20:05:48.533Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackb898","url":"/jackb898","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-23T20:36:57.779Z","bug_reporter_agreed_on_going_public_at":"2017-08-24T20:36:51.148Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello. I was penetration testing your website, and noticed that your crossdomain.xml file allowed many sites access. I went through and, for all the sites that had *.website.com with them, I scanned them for subdomains.\n\nI found that a subdomain for ███████.com (a site in your crossdomain.xml as *███████), m███████, was vulnerable to takeover. \n\nI'm not going to take it over since they do not have a white hat hacker program, but if someone were to take it over, they could make flash files on it to retrieve sensitive information from starbucks.com, and do it with no issue. Another factor that makes it even worse is that it's possible to use any headers also (\u003callow-http-request-headers-from domain=\"*\" headers=\"*\"/\u003e).\n\nIt's similar to if your site had this line in the crossdomain.xml: \u003callow-access-from domain=\"*\" /\u003e\n\nSCENARIO:\nThis is a scenario of how it would most likely be exploited\n1. A black hat is trying to hack into Starbucks\n2. He goes to the crossdomain.xml file looking for \u003callow-access-from domain=\"*\" /\u003e, but he notices lots of different websites are allowed access\n3. He decides to check the domains with *. before them for vulnerable subdomains\n4. He finds m██████, and notices *███████ has access\n5. He takes over m██████ and uploads a malicious flash file to send HTTP requests and see their responses. \n\n\nHOW TO FIX THIS\nPretty simple, obvious fix, but you have two routes you can take for it.\nFirst option: You can just remove \u003callow-access-from domain=\"*████████\" /\u003e from your crossdomain.xml file. (I didn't find any other subdomains vulnerable to takeover that were in there)\n\nSecond option: You can talk to ███████, the company that owns █████.com, and tell them to disconnect the DNS records linking m████████ and m██████.███\n\nMORE INFORMATION\nHere is more information on how it could be exploited: http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/ (read between Abusing CORS via Flash Files down to Bypassing XMLHttpRequest Header Validation)\n\n\n\nThanks,\nJack\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-23T20:36:51.190Z","allow_singular_disclosure_after":-127763520.86912614,"singular_disclosure_allowed":true,"vote_count":26,"voters":["flashdisk","jon_bottarini","dilawer01","edoverflow","akaash_pantherdefence","brodie_codie","eveeez","r3y","akhilmm","an0nym0us","and 16 more..."],"severity":{"rating":"high","score":7.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13020,"asset_type":"URL","asset_identifier":"www.starbucks.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1792575,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation. \n\nRegards.","automated_response":false,"created_at":"2017-06-29T21:11:58.193Z","updated_at":"2017-06-29T21:11:58.193Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1792588,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2017-06-29T21:16:39.525Z","updated_at":"2018-02-28T13:11:18.624Z","additional_data":{"added_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}],"removed_weaknesses":[{"id":32,"name":"Cryptographic Issues - Generic"}]},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1792591,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-06-29T21:18:43.283Z","updated_at":"2017-12-27T22:11:15.559Z","additional_data":{"old_title":"Subdomain takeover on external site leads to issue with crossdomain.xml","new_title":"Possible SOP bypass in www.████ due to insecure crossdomain.xml"},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1792775,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-06-29T22:14:03.144Z","updated_at":"2017-12-27T22:11:15.523Z","additional_data":{"old_title":"Possible SOP bypass in www.██████ due to insecure crossdomain.xml","new_title":"Possible SOP bypass in www.starbucks.com due to insecure crossdomain.xml"},"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1793234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for fixing the title. I really didn't know how to describe or categorize it.","automated_response":false,"created_at":"2017-06-30T02:49:45.249Z","updated_at":"2017-06-30T02:49:45.249Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1795317,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @kicker!\nWe'll be making an update to remove this from our cross domain.  Meanwhile, we've contacted the company in question and are working with them to address the subdomain configuration on their side.\n\nWe'll be back in touch soon with an update. ","automated_response":false,"created_at":"2017-06-30T21:33:43.792Z","updated_at":"2017-06-30T21:33:43.792Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1796968,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks. I'll be offline for about 2 weeks beginning tomorrow in case you're trying to ask me anything.","automated_response":false,"created_at":"2017-07-01T22:22:26.146Z","updated_at":"2017-07-01T22:22:26.146Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1835787,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @kicker,\n\nWe've worked with the company who owns ███████ and they have updated their configuration so takeover should no longer be possible.  That said, the crossdomain entry is scheduled for removal and we're going to hold off on resolving this one until that is completed.  This shouldn't take too much longer.\n\nThanks again for this report!\n","automated_response":false,"created_at":"2017-07-14T14:42:38.359Z","updated_at":"2017-09-25T20:49:44.593Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"jackb898","url":"/jackb898"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1838350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty! May we disclose this after the entry is removed?","automated_response":false,"created_at":"2017-07-15T20:53:39.306Z","updated_at":"2017-07-15T20:53:39.306Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1886081,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just curious if you have an estimated time of removing the crossdomain entry?","automated_response":false,"created_at":"2017-08-02T18:30:52.298Z","updated_at":"2017-08-02T18:30:52.298Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1913364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kicker,\n\nI'm expecting a release to address this very soon and will provide another update as soon as I have confirmation it has been deployed.\nOnce this is closed out we can disclose.\n\nThanks!","automated_response":false,"created_at":"2017-08-08T13:41:36.450Z","updated_at":"2017-08-08T13:41:36.450Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1950794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, I see you've updated the crossdomain.xml files across your domains. That should resolve the issue as far as I can tell.","automated_response":false,"created_at":"2017-08-24T01:53:52.814Z","updated_at":"2017-08-24T01:53:52.814Z","actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1952562,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@kicker, \n \nThank you for confirming. Looking forward to working with you in the future. Happy hacking!\n\nBest Regards, \n@overice ","automated_response":false,"created_at":"2017-08-24T18:04:27.879Z","updated_at":"2017-08-24T18:04:27.879Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jackb898","url":"/jackb898"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1953049,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-08-24T20:36:51.169Z","updated_at":"2017-08-24T20:36:51.169Z","first_to_agree":true,"actor":{"username":"jackb898","cleared":true,"url":"/jackb898","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2018038,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-23T20:36:57.858Z","updated_at":"2017-09-23T20:36:57.858Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2918510,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-06-21T22:28:48.294Z","updated_at":"2018-06-21T22:28:48.294Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.4)","old_severity_id":null,"new_severity_id":171644},"actor":{"username":"doggos","cleared":false,"url":"/doggos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/277/976/e6a23fde0d47001c23dfed7d3c2fef3eb608463e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2918512,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-06-21T22:28:59.512Z","updated_at":"2018-06-21T22:28:59.512Z","additional_data":{"old_severity":"Medium (5.4)","new_severity":"High (7.1)","old_severity_id":171644,"new_severity_id":171645},"actor":{"username":"doggos","cleared":false,"url":"/doggos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/277/976/e6a23fde0d47001c23dfed7d3c2fef3eb608463e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694132,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2018-11-21T18:59:43.467Z","updated_at":"2018-11-21T18:59:43.467Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"www.starbucks.com","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":20505,"category":"researcher","content":"Ah, my early reports. I've come quite a ways from reporting things before I understood exactly what they were. Nonetheless I got pretty creative here and recognized that a problem existed in this configuration, one that turned out to be a high impact problem. For web developers: *always* keep your crossdomain.xml allowed domains up to date if you have something other than wildcard allowed! Thank you to the Starbucks team for an efficient and helpful response.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":87732,"username":"jackb898","name":"Jack Burton","bio":"","cleared":true,"website":"https://medium.com/the-volatile-triad","location":"Houston, Texas","created_at":"2016-06-25T15:29:25.034Z","url":"https://hackerone.com/jackb898","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/CBcmZYZbwyyEjGj5BP7AQ4FK/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}