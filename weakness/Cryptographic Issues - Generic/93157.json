{"id":93157,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MzE1Nw==","url":"https://hackerone.com/reports/93157","title":"SPF Protection not used, I can hijack your email server","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-10-09T21:15:40.866Z","submitted_at":"2015-10-09T21:15:40.866Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lovepakistan","url":"/lovepakistan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/hidkHLEzLgv3WZ5ZLfWMdayP/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-08T16:07:59.034Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-18T03:14:14.883Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n\nCompanies like Twiter,Facebook and even Hackerone implemented a strict email security policy (combining SPF, DKIM, and DMARC) but I don't see that from gratipay You should apply strict SMPT policy to stop spoofed email sending from your domain. POC is attached.\n\nExploit scenario:\n\nAn attacker would send a Fake email from security@gratipay.com saying that Please change your password, The victim is aware of phishing attacks, But when he sees that the mail originated from security@gratipay.com , He has no other way than to believe it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his gratipay.com id and password (SESSION COOKIE). The results can be more dangerous.\n\nCode to Exploit:\n\n\u003c?php\n$to = \"VICTIM@example.com\";\n$subject = \"Password Change\";\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\n$headers = \"From: security@agratipay.com\";\nmail($to,$subject,$txt,$headers);\n?\u003e\nYou should do the fix (see the fix below) To prevent misunderstanding and to protect your users.\n\nFIX\n\nReplace ~all with -all to prevent fake email.\n\nPOC IS ATTACHED HERE\n\nRead why i am saying you to replace ~ with - : http://www.howtoforge.com/forums/archive/index.php/t-9007.html","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":56844,"file_name":"gratipay.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/056/844/8457bc19030e34a5b17132fcbacf3ca17dbbf29e/gratipay.png?response-content-disposition=attachment%3B%20filename%3D%22gratipay.png%22%3B%20filename%2A%3DUTF-8%27%27gratipay.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154318Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f9f54beabd1c08353ab8b43ed8a864677d54e5df59b16591b30e729860568ac2","file_size":21628,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-19T03:14:15.015Z","allow_singular_disclosure_after":-175609742.9917095,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":625588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, @lovepakistan ! This is to confirm that we have received your report and are taking steps to validate your findings.\n\nThanks again,\n\nHammad, Gratipay Security","automated_response":false,"created_at":"2015-10-19T23:27:07.990Z","updated_at":"2015-10-19T23:27:07.990Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":637586,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are the results I see for a few reference companies:\n\n```bash\n$ dig txt google.com|grep spf\ngoogle.com.             3027    IN      TXT     \"v=spf1 include:_spf.google.com ~all\"\n$ dig txt facebook.com|grep v=spf1\nfacebook.com.           407     IN      TXT     \"v=spf1 redirect=_spf.facebook.com\"\n$ dig txt _spf.facebook.com|grep v=spf1\n_spf.facebook.com.      754     IN      TXT     \"v=spf1 ip4:69.63.179.25 ip4:69.63.178.128/25 ip4:69.63.184.0/25 ip4:66.220.144.128/25 ip4:66.220.155.0/24 ip4:69.171.232.0/25 i\" \"p4:66.220.157.0/25 ip4:69.171.244.0/24 mx -all\"\n$ dig txt twitter.com|grep v=spf1\ntwitter.com.            178     IN      TXT     \"v=spf1 ip4:199.16.156.0/22 ip4:199.59.148.0/22 ip4:8.25.194.0/23 ip4:8.25.196.0/23 ip4:204.92.114.203 ip4:204.92.114.204/31 ip4:23.21.83.90 include:_spf.google.com include:_thirdparty.twitter.com -all\"\n$ dig txt hackerone.com|grep v=spf1\nhackerone.com.          299     IN      TXT     \"v=spf1 include:_spf.google.com include:u620743.wl.sendgrid.net include:mail.zendesk.com include:mktomail.com -all\"\n$\n```\n\nFacebook, Twitter, and Hackerone use Fail (dash, -). Google is still using SoftFail (tilde, ~). The difference between the two is that SoftFail is for implementations \"[in transition](http://www.openspf.org/SPF_Record_Syntax)\" (Wikipedia suggests it is a \"[debugging aid](https://en.wikipedia.org/wiki/Sender_Policy_Framework#Qualifiers)\").\n\nOoh! But, what's this? It looks like we are already using Fail:\n\n```bash\n$ dig txt gratipay.com|grep v=spf1\ngratipay.com.           3599    IN      TXT     \"v=spf1 include:email.freshdesk.com include:spf.mandrillapp.com include:_spf.google.com -all\"\n```\n\n@lovepakistan Please present better evidence that we are using SoftFail. Also, your POC code has the domain `agratipay.com`, not `gratipay.com`. How were you able to generate the screenshot you presented, when your code has `agratipay.com` and we are already using `-all`?","automated_response":false,"created_at":"2015-10-29T20:13:20.441Z","updated_at":"2015-10-29T20:13:20.441Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":640002,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2015-10-31T18:20:28.391Z","updated_at":"2015-10-31T18:20:28.391Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":748734,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Closing for now to keep the dashboard clean. Please reply with more information and we will reopen the ticket.\n\nThank you for the report.","automated_response":false,"created_at":"2016-01-08T08:46:48.295Z","updated_at":"2016-01-08T08:46:48.295Z","actor":{"username":"hammad","cleared":false,"url":"/hammad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/304/4c0c09c1a7cfe31747e8ac35dd1db26a4efc30ca_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":801413,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-02-17T14:25:49.072Z","updated_at":"2016-02-17T14:25:49.072Z","additional_data":{"duplicate_report_id":116930},"actor":{"username":"rohitcoder","cleared":false,"url":"/rohitcoder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":802383,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-18T03:14:14.916Z","updated_at":"2016-02-18T03:14:14.916Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":805939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Close it.","automated_response":false,"created_at":"2016-02-20T14:39:28.558Z","updated_at":"2016-02-20T14:39:28.558Z","actor":{"username":"lovepakistan","cleared":false,"url":"/lovepakistan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/hidkHLEzLgv3WZ5ZLfWMdayP/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1440652,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2017-01-24T11:57:32.435Z","updated_at":"2017-01-24T11:57:32.435Z","additional_data":{"duplicate_report_id":200745},"actor":{"username":"khalidamin","cleared":false,"url":"/khalidamin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XHZ3xacxvtgBhmGUx5TBPSzn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1441773,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2017-01-24T19:49:13.785Z","updated_at":"2017-01-24T19:49:13.785Z","actor":{"username":"khalidamin","cleared":false,"url":"/khalidamin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XHZ3xacxvtgBhmGUx5TBPSzn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/khalidamin","username":"khalidamin"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1442734,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2017-01-25T08:53:13.488Z","updated_at":"2017-01-25T08:53:13.488Z","additional_data":{"duplicate_report_id":200988},"actor":{"username":"yynl","cleared":false,"url":"/yynl","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1913877,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-08-08T16:07:58.990Z","updated_at":"2017-08-08T16:07:58.990Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}