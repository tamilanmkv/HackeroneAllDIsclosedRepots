{"id":363934,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjM5MzQ=","url":"https://hackerone.com/reports/363934","title":"SEGV in parse_rat()","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2018-06-10T14:07:46.091Z","submitted_at":"2018-06-10T14:07:46.091Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"etsukata","url":"/etsukata","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-13T11:45:55.917Z","bug_reporter_agreed_on_going_public_at":"2018-06-11T12:43:22.608Z","team_member_agreed_on_going_public_at":"2018-06-13T11:45:55.846Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"- A crafted string can cause SEGV(READ memory access to 0x000000000000) when parsed as rational number\n- ruby 2.5.1p57 on Fedora 28\n\n```\n$ ruby -e 'Rational(\"2e-9942067\")'\n-e:1: warning: in a**b, b may be too big\n-e:1: [BUG] Segmentation fault at 0x0000000000000000\nruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0011 e:000010 CFUNC  :Rational\nc:0002 p:0006 s:0006 e:000005 EVAL   -e:1 [FINISH]\nc:0001 p:0000 s:0003 E:001c20 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n-e:1:in `\u003cmain\u003e'\n-e:1:in `Rational'\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f43188c73f2 RBP: 0x00007ffccfd58780 RSP: 0x00007ffccfd58708\n RAX: 0x0000000000000001 RBX: 0x000055fd76c814b8 RCX: 0x0000000000000000\n RDX: 0xfff0000000000000 RDI: 0x000055fd76c814b8 RSI: 0x0000000000000000\n  R8: 0x000055fd76d349b0  R9: 0x0000000000000001 R10: 0x0000000000000000\n R11: 0x0000000000000000 R12: 0x00007ffccfd58790 R13: 0x0000000000000005\n R14: 0x0000000000000001 R15: 0x0000000000000000 EFL: 0x0000000000010286\n\n-- C level backtrace information -------------------------------------------\n/lib64/libruby.so.2.5(0x7f4318a54199) [0x7f4318a54199]\n/lib64/libruby.so.2.5(0x7f4318a543d0) [0x7f4318a543d0]\n/lib64/libruby.so.2.5(0x7f4318917a4c) [0x7f4318917a4c]\n/lib64/libruby.so.2.5(0x7f43189e3596) [0x7f43189e3596]\n/lib64/libpthread.so.0(0x7f4318678fb0) [0x7f4318678fb0]\n/lib64/libruby.so.2.5(rb_bigzero_p+0x42) [0x7f43188c73f2]\n/lib64/libruby.so.2.5(0x7f43189b16e8) [0x7f43189b16e8]\n/lib64/libruby.so.2.5(0x7f43189b988b) [0x7f43189b988b]\n/lib64/libruby.so.2.5(0x7f43189b9afc) [0x7f43189b9afc]\n/lib64/libruby.so.2.5(0x7f43189ba52f) [0x7f43189ba52f]\n/lib64/libruby.so.2.5(0x7f4318a3d083) [0x7f4318a3d083]\n/lib64/libruby.so.2.5(0x7f4318a49943) [0x7f4318a49943]\n/lib64/libruby.so.2.5(0x7f4318a426d6) [0x7f4318a426d6]\n/lib64/libruby.so.2.5(0x7f4318a46b9d) [0x7f4318a46b9d]\n/lib64/libruby.so.2.5(0x7f431891b32c) [0x7f431891b32c]\n/lib64/libruby.so.2.5(ruby_exec_node+0x21) [0x7f431891d2b1]\n/lib64/libruby.so.2.5(ruby_run_node+0x22) [0x7f431891f8b2]\n/usr/bin/ruby-mri(0x55fd74db09bf) [0x55fd74db09bf]\n/lib64/libc.so.6(__libc_start_main+0xeb) [0x7f4317b0a1bb]\n/usr/bin/ruby-mri(_start+0x2a) [0x55fd74db09fa]\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: -e\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n    4 /usr/lib64/ruby/enc/encdb.so\n    5 /usr/lib64/ruby/enc/trans/transdb.so\n    6 /usr/lib64/ruby/rbconfig.rb\n    7 /usr/share/rubygems/rubygems/compatibility.rb\n    8 /usr/share/rubygems/rubygems/defaults.rb\n    9 /usr/share/rubygems/rubygems/deprecate.rb\n   10 /usr/share/rubygems/rubygems/errors.rb\n   11 /usr/share/rubygems/rubygems/version.rb\n   12 /usr/share/rubygems/rubygems/requirement.rb\n   13 /usr/share/rubygems/rubygems/platform.rb\n   14 /usr/share/rubygems/rubygems/basic_specification.rb\n   15 /usr/share/rubygems/rubygems/stub_specification.rb\n   16 /usr/share/rubygems/rubygems/util/list.rb\n   17 /usr/lib64/ruby/stringio.so\n   18 /usr/share/ruby/uri/rfc2396_parser.rb\n   19 /usr/share/ruby/uri/rfc3986_parser.rb\n   20 /usr/share/ruby/uri/common.rb\n   21 /usr/share/ruby/uri/generic.rb\n   22 /usr/share/ruby/uri/ftp.rb\n   23 /usr/share/ruby/uri/http.rb\n   24 /usr/share/ruby/uri/https.rb\n   25 /usr/share/ruby/uri/ldap.rb\n   26 /usr/share/ruby/uri/ldaps.rb\n   27 /usr/share/ruby/uri/mailto.rb\n   28 /usr/share/ruby/uri.rb\n   29 /usr/share/rubygems/rubygems/specification.rb\n   30 /usr/share/rubygems/rubygems/exceptions.rb\n   31 /usr/share/rubygems/rubygems/defaults/operating_system.rb\n   32 /usr/share/rubygems/rubygems/dependency.rb\n   33 /usr/share/rubygems/rubygems/core_ext/kernel_gem.rb\n   34 /usr/share/ruby/monitor.rb\n   35 /usr/share/rubygems/rubygems/core_ext/kernel_require.rb\n   36 /usr/share/rubygems/rubygems.rb\n   37 /usr/share/rubygems/rubygems/path_support.rb\n   38 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/version.rb\n   39 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/core_ext/name_error.rb\n   40 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/levenshtein.rb\n   41 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/jaro_winkler.rb\n   42 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checker.rb\n   43 /usr/share/ruby/delegate.rb\n   44 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/name_error_checkers/class_name_checker.rb\n   45 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/name_error_checkers/variable_name_checker.rb\n   46 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/name_error_checkers.rb\n   47 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/method_name_checker.rb\n   48 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/key_error_checker.rb\n   49 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/spell_checkers/null_checker.rb\n   50 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean/formatters/plain_formatter.rb\n   51 /usr/share/gems/gems/did_you_mean-1.2.0/lib/did_you_mean.rb\n   52 /usr/share/rubygems/rubygems/bundler_version_finder.rb\n\n* Process memory map:\n\n55fd74db0000-55fd74db1000 r-xp 00000000 fd:00 3017898                    /usr/bin/ruby-mri\n55fd74fb0000-55fd74fb1000 r--p 00000000 fd:00 3017898                    /usr/bin/ruby-mri\n55fd74fb1000-55fd74fb2000 rw-p 00001000 fd:00 3017898                    /usr/bin/ruby-mri\n55fd7695d000-55fd76d77000 rw-p 00000000 00:00 0                          [heap]\n7f4316dfd000-7f4317004000 r--s 00000000 fd:00 3020748                    /usr/lib64/libc-2.27.so\n7f4317004000-7f43172bf000 r--s 00000000 fd:00 3017890                    /usr/lib64/libruby.so.2.5.1\n7f43172bf000-7f43172d6000 r-xp 00000000 fd:00 3015147                    /usr/lib64/libgcc_s-8-20180502.so.1\n7f43172d6000-7f43174d5000 ---p 00017000 fd:00 3015147                    /usr/lib64/libgcc_s-8-20180502.so.1\n7f43174d5000-7f43174d6000 r--p 00016000 fd:00 3015147                    /usr/lib64/libgcc_s-8-20180502.so.1\n7f43174d6000-7f43174d7000 rw-p 00017000 fd:00 3015147                    /usr/lib64/libgcc_s-8-20180502.so.1\n7f43174d7000-7f43174de000 r-xp 00000000 fd:00 3149600                    /usr/lib64/ruby/stringio.so\n7f43174de000-7f43176de000 ---p 00007000 fd:00 3149600                    /usr/lib64/ruby/stringio.so\n7f43176de000-7f43176df000 r--p 00007000 fd:00 3149600                    /usr/lib64/ruby/stringio.so\n7f43176df000-7f43176e0000 rw-p 00000000 00:00 0 \n7f43176e0000-7f43176e2000 r-xp 00000000 fd:00 558677                     /usr/lib64/ruby/enc/trans/transdb.so\n7f43176e2000-7f43178e2000 ---p 00002000 fd:00 558677                     /usr/lib64/ruby/enc/trans/transdb.so\n7f43178e2000-7f43178e3000 r--p 00002000 fd:00 558677                     /usr/lib64/ruby/enc/trans/transdb.so\n7f43178e3000-7f43178e4000 rw-p 00000000 00:00 0 \n7f43178e4000-7f43178e6000 r-xp 00000000 fd:00 3149550                    /usr/lib64/ruby/enc/encdb.so\n7f43178e6000-7f4317ae5000 ---p 00002000 fd:00 3149550                    /usr/lib64/ruby/enc/encdb.so\n7f4317ae5000-7f4317ae6000 r--p 00001000 fd:00 3149550                    /usr/lib64/ruby/enc/encdb.so\n7f4317ae6000-7f4317ae7000 rw-p 00000000 00:00 0 \n7f4317ae7000-7f4317c9c000 r-xp 00000000 fd:00 3020748                    /usr/lib64/libc-2.27.so\n7f4317c9c000-7f4317e9c000 ---p 001b5000 fd:00 3020748                    /usr/lib64/libc-2.27.so\n7f4317e9c000-7f4317ea0000 r--p 001b5000 fd:00 3020748                    /usr/lib64/libc-2.27.so\n7f4317ea0000-7f4317ea2000 rw-p 001b9000 fd:00 3020748                    /usr/lib64/libc-2.27.so\n7f4317ea2000-7f4317ea6000 rw-p 00000000 00:00 0 \n7f4317ea6000-7f4318038000 r-xp 00000000 fd:00 3020753                    /usr/lib64/libm-2.27.so\n7f4318038000-7f4318238000 ---p 00192000 fd:00 3020753                    /usr/lib64/libm-2.27.so\n7f4318238000-7f4318239000 r--p 00192000 fd:00 3020753                    /usr/lib64/libm-2.27.so\n7f4318239000-7f431823a000 rw-p 00193000 fd:00 3020753                    /usr/lib64/libm-2.27.so\n7f431823a000-7f431825a000 r-xp 00000000 fd:00 3021642                    /usr/lib64/libcrypt.so.1.1.0\n7f431825a000-7f4318459000 ---p 00020000 fd:00 3021642                    /usr/lib64/libcrypt.so.1.1.0\n7f4318459000-7f431845a000 r--p 0001f000 fd:00 3021642                    /usr/lib64/libcrypt.so.1.1.0\n7f431845a000-7f4318463000 rw-p 00000000 00:00 0 \n7f4318463000-7f4318466000 r-xp 00000000 fd:00 3020750                    /usr/lib64/libdl-2.27.so\n7f4318466000-7f4318665000 ---p 00003000 fd:00 3020750                    /usr/lib64/libdl-2.27.so\n7f4318665000-7f4318666000 r--p 00002000 fd:00 3020750                    /usr/lib64/libdl-2.27.so\n7f4318666000-7f4318667000 rw-p 00003000 fd:00 3020750                    /usr/lib64/libdl-2.27.so\n7f4318667000-7f4318680000 r-xp 00000000 fd:00 3020765                    /usr/lib64/libpthread-2.27.so\n7f4318680000-7f4318880000 ---p 00019000 fd:00 3020765                    /usr/lib64/libpthread-2.27.so\n7f4318880000-7f4318881000 r--p 00019000 fd:00 3020765                    /usr/lib64/libpthread-2.27.so\n7f4318881000-7f4318882000 rw-p 0001a000 fd:00 3020765                    /usr/lib64/libpthread-2.27.so\n7f4318882000-7f4318886000 rw-p 00000000 00:00 0 \n7f4318886000-7f4318b32000 r-xp 00000000 fd:00 3017890                    /usr/lib64/libruby.so.2.5.1\n7f4318b32000-7f4318d31000 ---p 002ac000 fd:00 3017890                    /usr/lib64/libruby.so.2.5.1\n7f4318d31000-7f4318d39000 r--p 002ab000 fd:00 3017890                    /usr/lib64/libruby.so.2.5.1\n7f4318d39000-7f4318d3a000 rw-p 002b3000 fd:00 3017890                    /usr/lib64/libruby.so.2.5.1\n7f4318d3a000-7f4318d4a000 rw-p 00000000 00:00 0 \n7f4318d4a000-7f4318d6f000 r-xp 00000000 fd:00 3020739                    /usr/lib64/ld-2.27.so\n7f4318e23000-7f4318e49000 r--s 00000000 fd:00 3020765                    /usr/lib64/libpthread-2.27.so\n7f4318e49000-7f4318f50000 rw-p 00000000 00:00 0 \n7f4318f68000-7f4318f6a000 r--s 00000000 fd:00 3017898                    /usr/bin/ruby-mri\n7f4318f6a000-7f4318f6b000 ---p 00000000 00:00 0 \n7f4318f6b000-7f4318f6f000 rw-p 00000000 00:00 0 \n7f4318f6f000-7f4318f70000 r--p 00025000 fd:00 3020739                    /usr/lib64/ld-2.27.so\n7f4318f70000-7f4318f71000 rw-p 00026000 fd:00 3020739                    /usr/lib64/ld-2.27.so\n7f4318f71000-7f4318f72000 rw-p 00000000 00:00 0 \n7ffccf55c000-7ffccfd5b000 rw-p 00000000 00:00 0                          [stack]\n7ffccfd85000-7ffccfd88000 r--p 00000000 00:00 0                          [vvar]\n7ffccfd88000-7ffccfd8a000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted (core dumped)\n```\n\n## Impact\n\nAn attacker can cause DoS by sending a crafted string which is parsed as rational number","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2864426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Version info\n\n- Affected\n  - 2.5.1\n  - 2.6.0-preview2\n- Not Affected\n  - 2.4.4","automated_response":false,"created_at":"2018-06-10T14:48:07.917Z","updated_at":"2018-06-10T14:48:07.917Z","actor":{"username":"etsukata","cleared":false,"url":"/etsukata","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2866891,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thank you for your reporting this issue.\nIt is our policy to handle SEGV as a normal bug but not a security issue.\nCould you register a ticket to https://bugs.ruby-lang.org/?","automated_response":false,"created_at":"2018-06-11T12:19:19.473Z","updated_at":"2018-06-11T12:19:19.473Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2867777,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-11T12:43:22.652Z","updated_at":"2018-06-11T12:43:22.652Z","first_to_agree":true,"actor":{"username":"etsukata","cleared":false,"url":"/etsukata","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2879047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-06-13T11:45:55.876Z","updated_at":"2018-06-13T11:45:55.876Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2879048,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-06-13T11:45:55.945Z","updated_at":"2018-06-13T11:45:55.945Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}