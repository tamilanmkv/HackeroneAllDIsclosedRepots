{"id":390847,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTA4NDc=","url":"https://hackerone.com/reports/390847","title":"Prototype Pollution Vulnerability in cached-path-relative Package","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-06T10:10:37.304Z","submitted_at":"2018-08-06T10:10:37.304Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cris_semmle","url":"/cris_semmle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16472"],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-02T10:51:09.802Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-11-02T10:51:02.901Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a prototype pollution attack in cached-path-relative.\nIt allows an attacker to inject properties on Object.prototype which are then inherited by all the JS objects through the prototype chain.\n\n# Module\n\n**module name:** cached-path-relative\n**version:** 1.0.1\n**npm page:** `https://www.npmjs.com/package/cached-path-relative`\n\n## Module Description\n\nMemoize the results of the path.relative function. path.relative can be an expensive operation if it happens a lot, and its results shouldn't change for the same arguments.\n\n## Module Stats\n\n352,446 downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nIf the attacker can control both the path and the cached value, she can deploy a prototype pollution attack and thus overwrite arbitrary properties on Object.prototype.\n\n## Steps To Reproduce:\n\n```js\nvar relative = require('cached-path-relative');\nrelative('__proto__', 'x');\nconsole.log({}.x);\n```\n\n## Patch\n\nInitialize the cache using Object.create(null) or use the Map data structure.\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nI am not sure how clients of this module use the API, but if attacker can control both the values passed to cached-path-relative, the attacker can write arbitrary properties on Object.prototype.","vulnerability_information_html":"\u003cp\u003eI would like to report a prototype pollution attack in cached-path-relative.\u003cbr\u003e\nIt allows an attacker to inject properties on Object.prototype which are then inherited by all the JS objects through the prototype chain.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e cached-path-relative\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.0.1\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/cached-path-relative\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eMemoize the results of the path.relative function. path.relative can be an expensive operation if it happens a lot, and its results shouldn\u0026#39;t change for the same arguments.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e352,446 downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eIf the attacker can control both the path and the cached value, she can deploy a prototype pollution attack and thus overwrite arbitrary properties on Object.prototype.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003erelative\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ecached-path-relative\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003erelative\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e__proto__\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ex\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eInitialize the cache using Object.create(null) or use the Map data structure.\u003c/p\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: N\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eI am not sure how clients of this module use the API, but if attacker can control both the values passed to cached-path-relative, the attacker can write arbitrary properties on Object.prototype.\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-02T10:51:02.987Z","allow_singular_disclosure_after":-65473103.03170289,"singular_disclosure_allowed":true,"vote_count":1,"voters":["n00bsec"],"severity":{"rating":"high","score":7.6,"author_type":"User","metrics":{"attack_vector":"adjacent","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"low"}},"structured_scope":{"databaseId":13977,"asset_type":"SOURCE_CODE","asset_identifier":"cached-path-relative","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3150327,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-06T10:23:14.192Z","updated_at":"2018-08-06T10:23:14.192Z","additional_data":{"old_title":"Prototype Pollution Attack in cached-path-relative","new_title":"Prototype Pollution Vulnerability in cached-path-relative"},"actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3150328,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-06T10:23:22.435Z","updated_at":"2018-08-06T10:23:22.435Z","additional_data":{"old_title":"Prototype Pollution Vulnerability in cached-path-relative","new_title":"Prototype Pollution Vulnerability in cached-path-relative Package"},"actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3150478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @cris_semmle,\n\nThank you for the report. We are currently reviewing this and will get in touch with you once our review is complete. \n\nRegards,\n@dukefleed","markdown_message":"\u003cp\u003eHello \u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. We are currently reviewing this and will get in touch with you once our review is complete. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/dukefleed\"\u003e@dukefleed\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-06T11:13:17.435Z","updated_at":"2018-08-06T11:13:17.435Z","actor":{"username":"dukefleed","cleared":false,"url":"/dukefleed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/358/4957a9bf08fe3fed492a5def8b2afd61e032c96f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3279759,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-01T21:08:33.435Z","updated_at":"2018-09-01T21:08:33.435Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3279760,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cris_semmle,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @cris_semmle,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-01T21:08:48.671Z","updated_at":"2018-09-01T21:08:48.671Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3279761,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-01T21:09:36.318Z","updated_at":"2018-09-01T21:09:36.318Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"cached-path-relative","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3304323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Due to inactivity from the maintainer I opened an issue in the repository: https://github.com/ashaffer/cached-path-relative/issues/3\n","markdown_message":"\u003cp\u003eDue to inactivity from the maintainer I opened an issue in the repository: \u003ca title=\"https://github.com/ashaffer/cached-path-relative/issues/3\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fashaffer%2Fcached-path-relative%2Fissues%2F3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/ashaffer/cached-path-relative/issues/3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-07T07:06:00.001Z","updated_at":"2018-09-07T07:06:00.001Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3575165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Due to inactivity in the GitHub repository for an issue opened about security concerns as well as inviting the maintainer here I will proceed with disclosing the far-overdue report.","markdown_message":"\u003cp\u003eDue to inactivity in the GitHub repository for an issue opened about security concerns as well as inviting the maintainer here I will proceed with disclosing the far-overdue report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-02T10:50:36.472Z","updated_at":"2018-11-02T10:50:36.472Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3575166,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-02T10:50:42.812Z","updated_at":"2018-11-02T10:50:42.812Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cris_semmle","url":"/cris_semmle"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3575169,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-02T10:51:02.921Z","updated_at":"2018-11-02T10:51:02.921Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3575171,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-02T10:51:09.678Z","updated_at":"2018-11-02T10:51:09.678Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3575178,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-02T10:53:48.769Z","updated_at":"2018-11-02T10:53:48.769Z","additional_data":{"added_weaknesses":[{"id":48,"name":"Denial of Service"}],"removed_weaknesses":[]},"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3605423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In a follow-up GitHub thread this issue has been resolved: https://github.com/ashaffer/cached-path-relative/issues/3\nVersion 1.0.2 now addresses the issue","markdown_message":"\u003cp\u003eIn a follow-up GitHub thread this issue has been resolved: \u003ca title=\"https://github.com/ashaffer/cached-path-relative/issues/3\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fashaffer%2Fcached-path-relative%2Fissues%2F3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/ashaffer/cached-path-relative/issues/3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVersion 1.0.2 now addresses the issue\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-07T22:36:09.999Z","updated_at":"2018-11-07T22:36:09.999Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}