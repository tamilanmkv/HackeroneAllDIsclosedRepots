{"id":430831,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzA4MzE=","url":"https://hackerone.com/reports/430831","title":"Prototype pollution attack in node.extend","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-30T11:42:18.593Z","submitted_at":"2018-10-30T11:42:18.593Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asgerf","url":"/asgerf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16491"],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-30T14:01:57.458Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-10-31T14:01:47.886Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a prototype pollution vulnerability in node.extend.\nIt allows an attacker to inject properties on Object.prototype.\n\n# Module\n\n**module name:** node.extend\n**version:** 2.0.0\n**npm page:** `https://www.npmjs.com/package/node.extend`\n\n## Module Description\n\nA port of jQuery.extend that actually works on node.js\n\n## Module Stats\n\n267,701 downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nThis is a variant of this vulnerability:\nhttps://hackerone.com/reports/310443\n\n`node.extend` can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\n\n## Steps To Reproduce:\nCraft an object of form `{__proto__: {...}}` and send it to `node.extend`:\n```javascript\nlet extend = require('node.extend');\nextend(true, {}, JSON.parse('{\"__proto__\": {\"isAdmin\": true}}'));\nconsole.log({}.isAdmin); // true\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N]\n- I opened an issue in the related repository: [N]\n\n## Impact\n\nDenial of service, possibly more depending on the application.\nSee https://hackerone.com/reports/310443","vulnerability_information_html":"\u003cp\u003eI would like to report a prototype pollution vulnerability in node.extend.\u003cbr\u003e\nIt allows an attacker to inject properties on Object.prototype.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e node.extend\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 2.0.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/node.extend\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eA port of jQuery.extend that actually works on node.js\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e267,701 downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThis is a variant of this vulnerability:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003enode.extend\u003c/code\u003e can be tricked into adding or modifying properties of the Object prototype. These properties will be present on all objects.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eCraft an object of form \u003ccode\u003e{__proto__: {...}}\u003c/code\u003e and send it to \u003ccode\u003enode.extend\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eextend\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enode.extend\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eextend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e{\u0026quot;__proto__\u0026quot;: {\u0026quot;isAdmin\u0026quot;: true}}\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAdmin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N]\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service, possibly more depending on the application.\u003cbr\u003e\nSee \u003ca title=\"https://hackerone.com/reports/310443\" href=\"https://hackerone.com/reports/310443\"\u003ehttps://hackerone.com/reports/310443\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-11-30T14:01:47.988Z","allow_singular_disclosure_after":-65634933.32538905,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sameerphad72","tiger24","mygf"],"severity":{"rating":"medium","score":5.7,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":18764,"asset_type":"SOURCE_CODE","asset_identifier":"node.extend","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3554955,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi \u003cHACKER\u003e,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n\nAlex","markdown_message":"\u003cp\u003eHi \u0026lt;HACKER\u0026gt;,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n\n\u003cp\u003eAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T12:43:43.464Z","updated_at":"2018-10-30T12:43:43.464Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3559688,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-30T22:52:21.521Z","updated_at":"2018-10-30T22:52:21.521Z","actor":{"username":"ljharb","cleared":false,"url":"/ljharb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/312/851/eecdb3fe4c5534775bf78793164260663e9cf21e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3559780,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is also the same as https://hackerone.com/reports/381185","markdown_message":"\u003cp\u003eThis is also the same as \u003ca title=\"https://hackerone.com/reports/381185\" href=\"https://hackerone.com/reports/381185\"\u003ehttps://hackerone.com/reports/381185\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T23:20:24.249Z","updated_at":"2018-10-30T23:20:24.249Z","actor":{"username":"ljharb","cleared":false,"url":"/ljharb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/312/851/eecdb3fe4c5534775bf78793164260663e9cf21e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3559991,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've released a fix in v2.0.1 and backported it to v1.1.7; hopefully that's sufficient to close this issue :-)","markdown_message":"\u003cp\u003eI\u0026#39;ve released a fix in v2.0.1 and backported it to v1.1.7; hopefully that\u0026#39;s sufficient to close this issue :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T00:31:19.048Z","updated_at":"2018-10-31T00:31:19.048Z","actor":{"username":"ljharb","cleared":false,"url":"/ljharb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/312/851/eecdb3fe4c5534775bf78793164260663e9cf21e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3560776,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @ljharb for your super quick patch!\nI can confirm it works for me in 2.0.1 and 1.1.7.\n@asgerf when you can confirm this is fixed in 2.0.1 and 1.1.7 I will move to resolve and disclose.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/ljharb\"\u003e@ljharb\u003c/a\u003e for your super quick patch!\u003cbr\u003e\nI can confirm it works for me in 2.0.1 and 1.1.7.\u003cbr\u003e\n\u003ca href=\"/asgerf\"\u003e@asgerf\u003c/a\u003e when you can confirm this is fixed in 2.0.1 and 1.1.7 I will move to resolve and disclose.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T06:26:25.650Z","updated_at":"2018-10-31T06:26:25.650Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3563453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can also confirm the fix in 2.0.1 and 1.1.7. Thanks for the quick fix.","markdown_message":"\u003cp\u003eCan also confirm the fix in 2.0.1 and 1.1.7. Thanks for the quick fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T13:59:14.778Z","updated_at":"2018-10-31T13:59:14.778Z","actor":{"username":"asgerf","cleared":false,"url":"/asgerf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/q5oTdS6oJaM29wThEKhh22Pr/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3563466,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Confirmed, closing this one.","markdown_message":"\u003cp\u003eConfirmed, closing this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T14:01:17.900Z","updated_at":"2018-10-31T14:01:17.900Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asgerf","url":"/asgerf"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3563468,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Versions 2.0.1 and 1.1.7 fix this issue.","markdown_message":"\u003cp\u003eVersions 2.0.1 and 1.1.7 fix this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T14:01:47.914Z","updated_at":"2018-10-31T14:01:47.914Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3738951,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T14:01:57.506Z","updated_at":"2018-11-30T14:01:57.506Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3920693,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T16:43:13.300Z","updated_at":"2019-01-03T16:43:13.300Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"node.extend","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3920810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE requested, report is disclosed now.","markdown_message":"\u003cp\u003eCVE requested, report is disclosed now.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T17:05:54.160Z","updated_at":"2019-01-03T17:05:54.160Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4095657,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-05T10:54:59.923Z","updated_at":"2019-02-05T10:54:59.923Z","additional_data":{"old_severity":"Low","new_severity":"Medium (5.7)","old_severity_id":231322,"new_severity_id":292234},"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}