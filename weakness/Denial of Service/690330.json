{"id":690330,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTAzMzA=","url":"https://hackerone.com/reports/690330","title":"scripts loader (denial of service) vulnerability","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-09-07T23:24:10.493Z","submitted_at":"2019-09-07T23:24:10.493Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"badisman","url":"/badisman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/614/3028a5d60a32a9e6aaff730d6c8e780707ec87b9_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8724,"url":"https://hackerone.com/mariadb","handle":"mariadb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"MariaDB","twitter_handle":"mariadb_org","website":"https://mariadb.org","about":"MariaDB is a high performance, open source database that helps the world's busiest websites deliver more content, faster."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-6389"],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-19T15:35:17.212Z","bug_reporter_agreed_on_going_public_at":"2020-02-18T15:35:12.389Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1) vulnerability description\n\nWordPress allows users to load multiple JS files and CSS files through load-scripts.php files at once. For example, https://wpwebsite.com/wp-admin/load-scripts.php?c=1\u0026load[]=jquery-ui-core,editor\u0026ver=4.9.1, file load-scripts.php will load jquery-ui-core and editor files automatically and return the contents of the file.\n\nHowever, the number and size of files are not restricted in the process of loading JS files, attackers can use this function to deplete server resources and launch denial of service attacks.\n\n(check references for more details about the vulnerability)\n2) attack details\n\n*affected link : https://mariadb.org/wp-admin/load-scripts.php\n\n*proof of concept ( description );\n\nthe load-scripts.php file was receiving a parameter called load[]. This parameter is an array that was receiving the names of the JS files that needed to be loaded. In this case, it was receiving jQuery UI Core, which is the name of one of the Javascript files used by the WordPress login page. (it can be longer, this is just an example)\nAs no rate-limiting is setup for this URL - then DoS comes real\n\n*proof of concept ( link ) ; https://mariadb.org/wp-admin/load-scripts.php?c=1\u0026load[]=jquery-ui-core\u0026ver=4.9.1\n\n3)  how to fix\n\nThe web application firewall will mitigate attacks by adding the following to .htaccess -file:\n\n\u003cFiles load-scripts.php\u003e\n\nOrder allow, deny\n\nDeny from all\n\n\u003c/Files\u003e\n\n\n4) vulnerability classification:\n\n*owasp 2017  top 10 (A9 Using Components with Known Vulnerabilities )\n\n*CVE( Common Vulnerabilities and Exposures ) : https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389\n\n\n5) references:\n\nhttps://blog.threatpress.com/wordpress-vulnerability-dos/\n\nhttps://baraktawily.blogspot.com/2018/02/how-to-dos-29-of-world-wide-websites.html\n\n## Impact\n\ndenial of service","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-19T15:35:12.437Z","allow_singular_disclosure_after":-49333368.14740732,"singular_disclosure_allowed":true,"vote_count":19,"voters":["a_d_a_m","ali","realtess","lam0rt3","zelzal","sourceflow","cryptographer","pallemadhu","hakmod","alphaqx","and 9 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":10338,"asset_type":"URL","asset_identifier":"mariadb.org","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5758365,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @badismansouri!\n\nThank you for the report. We have fixed this  problem by enforcing throttling of requests.\n\nMariaDB Security Team","automated_response":false,"created_at":"2019-09-09T03:30:20.610Z","updated_at":"2019-09-09T03:30:20.610Z","actor":{"username":"vicentiu","cleared":false,"url":"/vicentiu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"badisman","url":"/badisman"},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7080993,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"HI,\nCan this be disclosed?","automated_response":false,"created_at":"2020-02-18T15:35:12.407Z","updated_at":"2020-02-18T15:35:12.407Z","first_to_agree":true,"actor":{"username":"badisman","cleared":false,"url":"/badisman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/614/3028a5d60a32a9e6aaff730d6c8e780707ec87b9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7370242,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-03-19T15:35:17.241Z","updated_at":"2020-03-19T15:35:17.241Z","actor":{"url":"/mariadb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/724/6a67872926e894490b4fdc36cd6a3f59e300616b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"MariaDB"}},"genius_execution_id":null,"team_handle":"mariadb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}