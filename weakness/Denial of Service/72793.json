{"id":72793,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjc5Mw==","url":"https://hackerone.com/reports/72793","title":"Prevent Shop Admin From Seeing his Installed Apps / Install Persistent Unremovable App","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-26T21:06:02.130Z","submitted_at":"2015-06-26T21:06:02.130Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"prakharprasad","url":"/prakharprasad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-09-29T01:27:12.441Z","bug_reporter_agreed_on_going_public_at":"2015-09-29T01:27:12.239Z","team_member_agreed_on_going_public_at":"2015-09-28T21:07:06.998Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nThis is an interesting vulnerability, when a Shopify app whose `redirect_uri` points to a malformed URI handler like **shit:google.com** gets installed to a Shop then, it will effectively prevent the admins to see and remove installed apps to his/her shop. \r\n\r\n**Reproduction**\r\n\r\n1. Create a Shopify App at https://app.shopify.com/services/partners/api_clients/new\r\n2. Enter any for the App and set its **Application Callback URL** to **shit:google.com**\r\n3. Save the App.\r\n4. Create an OAuth URL for the App, Like - https://vulnstore.myshopify.com/admin/oauth/authorize?scope=read_customers\u0026client_id=cad94488c733b0f377a9a1d7952db802\r\n5. Now try to install the app by clicking \"Install \u003cAppName\u003e\" in the OAuth permission dialogue. It won't redirect after clicking.\r\n6. Go and visit https://vulnstore.myshopify.com/admin/apps The page will throw internal server 500 and usual error message.\r\n\r\nThis will not let admin remove any of his app till the *malicious app* is deleted by the app developer.\r\n\r\nPOC App: https://[store].myshopify.com/admin/oauth/authorize?scope=read_customers\u0026client_id=cad94488c733b0f377a9a1d7952db802 \r\n\r\nIf you have any doubt in reproduction, you can watch the following short screencast as well - https://www.dropbox.com/s/1h8gjg07r5h9gkj/Shopify%20DoS.mov?dl=0\r\n\r\nRegards,\r\nPrakhar Prasad","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-28T21:07:07.147Z","allow_singular_disclosure_after":-187899225.4792091,"singular_disclosure_allowed":true,"vote_count":1,"voters":["drsniper"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":509986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey! any updates here ? ","automated_response":false,"created_at":"2015-07-15T10:22:00.377Z","updated_at":"2015-07-15T10:22:00.377Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":517814,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating the issue.","automated_response":false,"created_at":"2015-07-20T19:53:45.219Z","updated_at":"2015-07-20T19:53:45.219Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":529419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Clayton, do  you have any update ? ","automated_response":false,"created_at":"2015-07-29T01:43:16.528Z","updated_at":"2015-07-29T01:43:16.528Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":543045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just checked and the vulnerability seems fixed. ","automated_response":false,"created_at":"2015-08-10T16:36:13.882Z","updated_at":"2015-08-10T16:36:13.882Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":571925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @clayton, any updates here ?","automated_response":false,"created_at":"2015-09-01T15:43:37.009Z","updated_at":"2015-09-01T15:43:37.009Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":572208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, no update yet. I'll let you know as soon as I have more information.","automated_response":false,"created_at":"2015-09-01T16:39:51.665Z","updated_at":"2015-09-01T16:39:51.665Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":572211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not fixed at all. Rest assured that we will keep you updated with any information as it is available, and there is no need to ask for updates.","automated_response":false,"created_at":"2015-09-01T16:40:43.510Z","updated_at":"2015-09-01T16:40:43.510Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600873,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @prakharprasad,\n\nThe fix for this issue was deployed on Friday, so I'll mark this as resolved now. Since this issue is a denial of service issue, with no danger to user's data, the issue is not eligible for a bounty. (Denial of service issues are not eligible for rewards in our bug bounty program).\n\nThank you again for submitting the issue.","automated_response":false,"created_at":"2015-09-28T21:06:42.583Z","updated_at":"2015-09-28T21:06:42.583Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"prakharprasad","url":"/prakharprasad"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600874,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-09-28T21:06:50.440Z","updated_at":"2015-09-28T21:06:50.440Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":600876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-28T21:07:07.023Z","updated_at":"2015-09-28T21:07:07.023Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":601095,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-09-29T01:27:12.292Z","updated_at":"2015-09-29T01:27:12.292Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":601096,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-09-29T01:27:12.463Z","updated_at":"2015-09-29T01:27:12.463Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}