{"id":923240,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjMyNDA=","url":"https://hackerone.com/reports/923240","title":"[3DS][StreetPass] Heap Overflow in Swapnote parser leads to userland StreetPass RCE","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-07-14T14:28:07.331Z","submitted_at":"2020-07-14T14:28:07.331Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mrnbayoh","url":"/mrnbayoh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16634,"url":"https://hackerone.com/nintendo","handle":"nintendo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/634/999cefca933756faeeb2ea39c07557943437c94f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/634/999cefca933756faeeb2ea39c07557943437c94f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nintendo","twitter_handle":"","website":"http://www.nintendo.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-01-18T04:43:50.652Z","bug_reporter_agreed_on_going_public_at":"2020-12-18T12:52:51.617Z","team_member_agreed_on_going_public_at":"2021-01-18T04:43:50.583Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"1682.0","formatted_bounty":"$1,682","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":30,"voters":["krypt1c","gamer7112","parsiya","prophet","mrnbayoh","0nlymohammed","demonia","fadel","h4x0r_dz","mrsinister15","and 20 more..."],"severity":{"rating":"high","score":8.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8602730,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-15T02:53:32.081Z","updated_at":"2020-07-15T02:53:32.081Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8658908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-20T23:04:50.285Z","updated_at":"2020-07-20T23:04:50.285Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8658958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-07-20T23:19:12.654Z","updated_at":"2020-07-20T23:19:12.654Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8673732,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-07-22T04:23:31.138Z","updated_at":"2020-07-22T04:23:31.138Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9065254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-28T12:42:27.385Z","updated_at":"2020-08-28T12:42:27.385Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9210435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-09-14T07:21:53.487Z","updated_at":"2020-09-14T07:21:53.487Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9215930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-09-14T14:48:40.744Z","updated_at":"2020-09-14T14:48:40.744Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9874358,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-11-20T03:00:33.446Z","updated_at":"2020-11-20T03:00:33.446Z","actor":{"url":"/nintendo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/634/999cefca933756faeeb2ea39c07557943437c94f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nintendo"}},"bounty_amount":"1682.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nintendo","collaborator":{"username":"mrnbayoh","url":"/mrnbayoh"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9874737,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-11-20T04:32:35.684Z","updated_at":"2020-11-20T04:32:35.684Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mrnbayoh","url":"/mrnbayoh"},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10143495,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-18T12:52:51.636Z","updated_at":"2020-12-18T12:52:51.636Z","first_to_agree":true,"actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10143785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-12-18T13:26:20.219Z","updated_at":"2020-12-18T13:26:20.219Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10269773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-01-05T01:03:20.991Z","updated_at":"2021-01-05T01:03:20.991Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10297969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-01-07T17:52:34.721Z","updated_at":"2021-01-07T17:52:34.721Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10396171,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2021-01-18T04:43:20.542Z","updated_at":"2021-01-18T04:43:20.542Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10396173,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-18T04:43:50.599Z","updated_at":"2021-01-18T04:43:50.599Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10396174,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-18T04:43:50.670Z","updated_at":"2021-01-18T04:43:50.670Z","actor":{"username":"tattsun","cleared":false,"url":"/tattsun","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nintendo","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":26278,"category":"team","content":"-","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60412,"username":"tattsun","name":"Ramen Chevalier","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2016-03-11T10:24:56.230Z","url":"https://hackerone.com/tattsun","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"id":25910,"category":"researcher","content":"#Affected Systems\n- System: Nintendo 3DS\n- Version: \u003c= 11.13\n- Region: ALL\n\n#Description\nWhen parsing `TLRF` chunks in message files the application calls `memcpy` using user provided sizes to copy controlled data over a fixed-size buffer. Thus one can overflow heap chunks which is enough to get code execution (unsafe unlink). Since messages can be exchanged through StreetPass, one can get remote code execution in userland.\nFor example these kinds of calls are made:\n```\nu32 offset_0 = *(u32*)(TLRF_buffer + 0x6DC);\nu32 size_0 = *(u32*)(TLRF_buffer + 0x70C);\n memcpy(heap_buffer_0, TLRF_buffer + offset_0, size_0);\n[...]\nu32 offset_1 = *(u32*)(TLRF_buffer + 0x6EC);\nu32 size_1 = *(u32*)(TLRF_buffer + 0x71C); \nmemcpy(heap_buffer_1, TLRF_buffer + offset_1, size_1);\n```\n\n## Impact\n\nAn attacker is able to get RCE in userland through the Swapnote application.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":189059,"username":"mrnbayoh","name":"nba::yoh","bio":"","cleared":false,"website":null,"location":"","created_at":"2017-08-03T22:13:34.989Z","url":"https://hackerone.com/mrnbayoh","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}