{"id":1167767,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY3NzY3","url":"https://hackerone.com/reports/1167767","title":"Unexpected federated shares added via public link","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2021-04-18T13:00:13.625Z","submitted_at":"2021-04-18T13:00:13.710Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-26T15:55:55.138Z","bug_reporter_agreed_on_going_public_at":"2021-04-20T13:42:52.000Z","team_member_agreed_on_going_public_at":"2021-04-26T15:55:55.038Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"So I'm not 100% sure if this is an security issue or not. But it is in my opinion at least unexpected and could be handled better to make sure people trust the system.\n\n1. Get a public link share (again plenty of those around)\n2. Click the 'add to your Nextcloud'\n3. A federated share is added/created\n\nHowever now the owner of the public link at 1 has a new federated share added.\nWithout any idea where it comes from. Which would be reason for concern in my book. Esp for people that do not know about the functionality etc.\n\n## Impact\n\nMissing descriptions or notifications can limit the trust in the system. Esp for regular users without technical knowledge on how things work.\nI'd expect a notification. Or at the very least a description in the sharing tab (? is that the correct name?) for the federated share 'mounted from public link X'","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["wi11","grmx","ract","ekgaribadmi","meispi","adass"],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11429517,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-04-18T13:00:14.356Z","updated_at":"2021-04-18T13:00:14.356Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11453246,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report :)\n\nWe have discussed this issue internally, and whilst this is not the optimal UX, we believe the risk here is minimal and would want to move this to a public GitHub ticket  therefore. - Your suggestion with indicating the source of the share sounds very sensible.\n\nDo you mind opening a ticket at http://github.com/nextcloud/server and mentioning me @LukasReschke? If you prefer, we can do so ourselves :)","automated_response":false,"created_at":"2021-04-20T12:49:02.594Z","updated_at":"2021-04-20T12:49:02.594Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11453675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Feel free to open it yourself","automated_response":false,"created_at":"2021-04-20T13:42:46.040Z","updated_at":"2021-04-20T13:42:46.040Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11453678,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-04-20T13:42:52.040Z","updated_at":"2021-04-20T13:42:52.040Z","first_to_agree":true,"actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11517341,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Issue on GitHub is at https://github.com/nextcloud/server/issues/26773\n\nThanks again for all your submissions. Much appreciated :)","automated_response":false,"created_at":"2021-04-26T15:55:55.060Z","updated_at":"2021-04-26T15:55:55.060Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11517342,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-26T15:55:55.182Z","updated_at":"2021-04-26T15:55:55.182Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}