{"id":1167916,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY3OTE2","url":"https://hackerone.com/reports/1167916","title":"Default Nextcloud Server and Android Client leak sharee searches to Nextcloud","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2021-04-18T18:12:19.132Z","submitted_at":"2021-04-18T18:12:19.193Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-22905"],"singular_disclosure_disabled":false,"disclosed_at":"2021-06-15T19:11:31.101Z","bug_reporter_agreed_on_going_public_at":"2021-06-15T19:11:31.053Z","team_member_agreed_on_going_public_at":"2021-06-01T18:04:38.330Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"On a clean Nextcloud setup the functionality \"Search global and public address book for users\" is enabled.\n\nNow when searching for a sharee to share with. The lookup parameter is not passed to the server. Resulting in\nhttps://github.com/nextcloud/server/blob/master/apps/files_sharing/lib/Controller/ShareesAPIController.php#L144\n\nthe lookup being true. So the lookup server of Nextcloud will be searched by default.\nIt seems that the lookup server is down now. But this seems to be an error I assume?\n\n## Impact\n\nAnybody sharing trough the android app. Leaks their sharee searches to the Nextcloud lookup server.\nNow the server can can only see the origin Nextcloud server (or rather the IP of that). Still. This should not be leaked by default.\n\nOn the web and desktop there is first a local search. And only if the user explicitly presses the search globally the lookup server is queried. (to be fair this could also be more clear that it actually sends data to other systems)","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-07-01T18:04:38.463Z","allow_singular_disclosure_after":-8796278.849581828,"singular_disclosure_allowed":true,"vote_count":52,"voters":["wi11","obsesif","run_win","0x3f","alp","ali","realtess","akashhamal0x01","grmx","cryptographer","and 42 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":1,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.nextcloud.client","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11430546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-04-18T18:12:19.654Z","updated_at":"2021-04-18T18:12:19.654Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11432685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good morning,\n\nThanks for your report. We'll try to validate it and get back to you.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2021-04-19T06:08:08.206Z","updated_at":"2021-04-19T06:08:08.206Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11435691,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have opened a ticket for the product team and will get back to you once we have updates.","automated_response":false,"created_at":"2021-04-19T09:55:28.236Z","updated_at":"2021-04-19T09:55:28.236Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11586470,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $750. This is a combined reward also for the iOS and Deck app with the same issue.\n\nThanks a lot for making the internet a safer place and keep hacking. Please keep in mind that we didn't patch the vulnerability yet, so please do not share this information with any third-parties.","automated_response":false,"created_at":"2021-05-01T08:03:56.182Z","updated_at":"2021-05-01T08:03:56.182Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"rtod","url":"/rtod"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11587428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Again, thanks!\n\nI assume that the Android patch will also soon be released?","automated_response":false,"created_at":"2021-05-01T11:11:27.945Z","updated_at":"2021-05-01T11:11:27.945Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11600658,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The Android team told us they are aiming to release a patch for this issue this week. I'll verify this with them to confirm.","automated_response":false,"created_at":"2021-05-03T15:31:29.644Z","updated_at":"2021-05-03T15:31:29.644Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11680151,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest android releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2021-05-10T08:55:15.304Z","updated_at":"2021-05-10T08:55:15.304Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rtod","url":"/rtod"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11683203,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for the bounty!\nQuick fix and seems to do the trick.\n\nCrediting again:\n\nName: rtod\nEmail: robottod@protonmail.com","automated_response":false,"created_at":"2021-05-10T12:40:42.250Z","updated_at":"2021-05-10T12:40:42.250Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11686936,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-05-10T15:18:54.568Z","updated_at":"2021-05-10T15:18:54.568Z","cve_ids":["CVE-2021-22905"],"actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11950784,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Advisory at https://github.com/nextcloud/security-advisories/security/advisories/GHSA-22v9-q3r6-x7cj","automated_response":false,"created_at":"2021-06-01T18:04:38.361Z","updated_at":"2021-06-01T18:04:38.361Z","first_to_agree":true,"actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12131934,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-06-15T19:11:31.075Z","updated_at":"2021-06-15T19:11:31.075Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12131935,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-06-15T19:11:31.140Z","updated_at":"2021-06-15T19:11:31.140Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}