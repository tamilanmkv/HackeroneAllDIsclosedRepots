{"id":304386,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQzODY=","url":"https://hackerone.com/reports/304386","title":"Unrestricted access to https://██████.█████myteksi.net/","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-12T22:26:21.523Z","submitted_at":"2018-01-12T22:26:21.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reptou","url":"/reptou","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1659,"url":"https://hackerone.com/grab","handle":"grab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Grab","twitter_handle":"GrabSG","website":"https://grab.com","about":"Grab is Southeast Asia's #1 ride-hailing app, food delivery service and cashless payment solution."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-02-12T07:09:58.517Z","bug_reporter_agreed_on_going_public_at":"2018-02-12T07:09:58.437Z","team_member_agreed_on_going_public_at":"2018-02-12T06:03:27.760Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again Grab Security Team !\n\nFollowing my previous research, it seems that your Microservices architecture you are currently running on *.█████myteksi.net is publicly exposed on another endpoint : https://█████████.█████myteksi.net. \n\n**Summary:** \n\nWhen researching and starting a new enumeration of your different subdomains, I found that https://███.████████myteksi.net is related to your Eureka / Zuul environment and is reachable without any filtering. \n\n**Description:**\n\nThis is a quite complex architecture, but I think that it reveals a lot of debug information that could help an attack find a vector, and certainly enables him to do some actions on this infrastructure without any control (this has to be confirmed as I do not want to perform any modification on your curent environment). \n\nIn order to understand the way this infrastructure works, I read the following documentation to discover some endpoints and see what could be achieved : http://cloud.spring.io/spring-cloud-static/Finchley.M5/single/spring-cloud.html#_health_indicator_2\n\nRegarding information gathering, there are different endpoints reachable for example :\n\n* https://█████.███████myteksi.net/info\n* https://████.██████myteksi.net/dump\n* https://███████.█████████myteksi.net/trace\n* https://████████.██████████myteksi.net/configprops\n* https://████████.███myteksi.net/env (from this one you got the eureka username and I guess the password too even if this is hidden ;-))\n* https://█████.████myteksi.net/beans\n* https://█████.█████myteksi.net/metrics\n* https://███.████myteksi.net/autoconfig\n* https://███.█████████myteksi.net/routes\n* https://██████████.█████████myteksi.net/features\n\nFor the action to be done, we may notice the following (extract from the documentation) :\n\n```\nFor a Spring Boot Actuator application there are some additional management endpoints:\n\n* POST to /env to update the Environment and rebind @ConfigurationProperties and log levels\n* /refresh for re-loading the boot strap context and refreshing the @RefreshScope beans\n* /restart for closing the ApplicationContext and restarting it (disabled by default)\n* /pause and /resume for calling the Lifecycle methods (stop() and start() on the ApplicationContext) \n```\nAs stated previously, I did not try these actions, but I have a good confidence that it will be executed without any restriction. \n\nFrom my point of view, this is an internal infrastructure that should not be exposed to any Internet user (as for the eureka endpoint previously reported). \n\n## Browsers Verified In:\n\nN/A\n\n## Steps To Reproduce:\n\n  1. Just try previous URL with correct HTTP Verb if necessary (GET / POST...)\n\nPlease let me know your thoughts on this,\n\nThank you !\n\nReptou\n\n## Impact\n\nThis is quite difficult to know exactly what could be achieved as the infrastructure is complex. However, I would say that it could first enable an attacker to understand better your infrastructure and identify weaknesses. The other point is that if the attacker is able to perform some actions, this could lead to DoS of this service in some cases and, of course, unexpected behaviour (modfying env properties ...)","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["europa","bugdiscloseguys","eveeez","khizer47","t4ym","linkks","cr4xerbik4sh","japz","scraps","mr_unkn0n","and 8 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":1668,"asset_type":"URL","asset_identifier":"*.myteksi.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2281851,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @reptou, \n\nWe're looking into this one. Thank you. ","automated_response":false,"created_at":"2018-01-13T01:30:37.374Z","updated_at":"2018-01-13T01:30:37.374Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have deployed a fix to address the issue. Can you verify if this has been fixed and you're no longer able to reproduce the behaviour ?\n","automated_response":false,"created_at":"2018-01-14T05:32:27.128Z","updated_at":"2018-01-14T05:32:27.128Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prakharprasad-grab \n\nThank you for the update ! It looks like you set maybe ip filtering at the tengine web server level as i get 403 forbidden error now when testing ? It looks good for me now. \n\nCould you please tell me if this was related to your production infrastructure ?\n\nI will keep you updated if I find something that could bypass this security control of course.\n\nThank you !\n\nReptou ","automated_response":false,"created_at":"2018-01-14T05:45:46.957Z","updated_at":"2018-01-14T05:45:46.957Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283175,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the confirmation. \n\nMy sincere apologies but we cannot share more information at this time.  We'll be more than happy to know if you can bypass the controls :)\n\nThank you for working with us to keep Grab safe. \n\n\n","automated_response":false,"created_at":"2018-01-14T06:18:20.773Z","updated_at":"2018-01-14T06:18:59.264Z","actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"reptou","url":"/reptou"},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2283211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok no problem I understand :) thank you and maybe see you on another report ;)\n\nReptou","automated_response":false,"created_at":"2018-01-14T07:47:01.501Z","updated_at":"2018-01-14T07:47:01.501Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2299502,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-01-19T06:01:41.541Z","updated_at":"2018-01-19T06:01:41.541Z","actor":{"url":"/grab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/659/d5a2e407a772cb09a7ef57167580acf021c9c407_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Grab"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"grab","collaborator":{"username":"reptou","url":"/reptou"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2299519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty :)","automated_response":false,"created_at":"2018-01-19T06:20:07.367Z","updated_at":"2018-01-19T06:20:07.367Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373647,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-02-12T06:03:27.800Z","updated_at":"2018-02-12T06:03:27.800Z","first_to_agree":true,"actor":{"username":"prakhar-prasad","cleared":false,"url":"/prakhar-prasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/224/234/a23e49a91c5319938ae464cb4ead093397823f68_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373698,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-02-12T07:09:58.480Z","updated_at":"2018-02-12T07:09:58.480Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2373699,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-02-12T07:09:58.547Z","updated_at":"2018-02-12T07:09:58.547Z","actor":{"username":"reptou","cleared":true,"url":"/reptou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/085/428ad242b9fdc52408f1a040adcb0c92b98f9d77_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"grab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}