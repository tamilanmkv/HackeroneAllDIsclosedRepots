{"id":309714,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDk3MTQ=","url":"https://hackerone.com/reports/309714","title":"[support.wordcamp.org] - publicly accessible .svn repository","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2018-01-27T08:46:18.037Z","submitted_at":"2018-01-27T08:46:18.037Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kazan71p","url":"/kazan71p","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-02-01T08:28:39.063Z","bug_reporter_agreed_on_going_public_at":"2018-02-01T08:28:38.992Z","team_member_agreed_on_going_public_at":"2018-01-31T17:02:33.051Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nFound that .svn repo is publicly accessible. We can verify it by loading https://support.wordcamp.org/.svn/entries in any browser. This is very dangerous as an attacker may download entire source code. More details about this vulnerability provided here:\n\nhttp://www.adamgotterer.com/post/28125474053/hacking-the-svn-directory-archive\n\nBy using https://github.com/anantshri/svn-extractor we can try to download entire svn repository without any authentication and restore the source code. We can also see commit history, users that performed commits and all repository related metadata.\n\n```\n$ python svn-extractor.py --url \"https://support.wordcamp.org/\"\n```\nI wasn't able to donwload php source code,  because you are using old version of SVN and server will try to execute php scripts even with `svn-base` extension - https://support.wordcamp.org/.svn/text-base/view-attachment.php.svn-base\n\nBut we still can get layout of remote application:\n```\ntree\n.\n├── ajax-predefined.php\n├── ajax-quote.php\n├── api.php\n├── base-init.php\n├── bg-left.gif\n├── bin\n├── config-sample.php\n├── design.css\n├── favicon.ico\n├── font\n│   ├── genericons-regular-webfont.eot\n│   ├── genericons-regular-webfont.svg\n│   ├── genericons-regular-webfont.ttf\n│   └── genericons-regular-webfont.woff\n├── footer.php\n├── header.php\n├── images\n│   ├── 24px-white.gif\n│   ├── button-grad-active.png\n│   ├── button-grad.png\n│   ├── icon_attachment.png\n│   ├── white-grad-active.png\n│   └── white-grad.png\n├── includes\n│   ├── class.bp-options.php\n│   ├── constants.php\n│   ├── crud.php\n│   ├── db.php\n│   ├── form.php\n│   ├── mime.php\n│   ├── misc.php\n│   ├── plugin.php\n│   ├── schema.php\n│   ├── sp-stats-class.php\n│   ├── support-functions.php\n│   ├── upgrade.php\n│   ├── viewing.php\n│   ├── wp-functions.php\n│   ├── wp-meta.php\n│   └── wp-user.php\n├── index.php\n├── init.php\n├── installer.php\n├── js\n│   ├── common.js\n│   ├── jquery-1.7.2.min.js\n│   ├── jquery.autosize-min.js\n│   ├── jquery-fieldselection.js\n│   ├── jquery-latest.js\n│   └── thread.js\n├── login.php\n├── message-attachment.php\n├── message-image.php\n├── plugins\n│   ├── customcss.php\n│   ├── customjs.php\n│   ├── fauxlders.php\n│   ├── force-ssl.php\n│   ├── kissmetrics.php\n│   ├── sidebar-history.php\n│   ├── sidebar-mods.php\n│   ├── sidebar-summary.php\n│   └── thread-status.php\n├── predefined-edit.php\n├── readme.txt\n├── settings.php\n├── sidebar-thread.php\n├── stats.php\n├── thread-addnote.php\n├── thread-bulk.php\n├── thread-create.php\n├── thread-delete.php\n├── thread-new.php\n├── thread-notify.php\n├── thread.php\n├── thread-reply.php\n├── thread-status.php\n├── thread-tags.php\n├── user-edit.php\n├── user.php\n└── view-attachment.php\n```\nAnd list of usernames that performed commits:\n```\nList of Usernames used to commit in svn are listed below\n1 : xknown\n2 : kovshenin\n3 : iandunn\n4 : briancolinger\n5 : westi\n6 : polldaddy\n7 : thingalon\n8 : apokalyptik\n9 : josephscott\n10 : johnny5\n11 : eoigal\n12 : lessbloat\n13 : shaunandrews\n14 : jkudish\n```\n\nThe fix is very easy, add following line to .htaccess file:\n```\nRewriteRule (\\.svn)/(.*?) - [F,L]\n```\n\n## Impact\n\nAnyone can get remote application layout, usernames involved in development. If SVN gets updated or server configuration change it is also possible to download the source code.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-03-02T17:02:33.143Z","allow_singular_disclosure_after":-113953207.09452057,"singular_disclosure_allowed":true,"vote_count":10,"voters":["jokebookservice1","fousekis","remonsec","ali","powerjacobb1","eveeez","whitesector","apapedulimu","bb00x","japz"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":2756,"asset_type":"URL","asset_identifier":"*.wordcamp.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2325203,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, @kazan71p. I'm assigning this to one of our \"meta\" maintainers to take a look.","automated_response":false,"created_at":"2018-01-28T11:38:34.578Z","updated_at":"2018-01-28T11:38:34.578Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2339000,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report Alex, I added your suggested `RewriteRule` to block access to that folder.\n\nThe SVN repository it has checked out is https://supportpress.svn.wordpress.org/trunk, which is an open-source project, so there isn't any private info there, but of course it's still best to block access anyway.\n\nI'll request disclosure, and move this to our bounty queue. We're a bit behind on determining awards, though, so it may take us a bit to get to that.","automated_response":false,"created_at":"2018-01-31T17:01:31.807Z","updated_at":"2018-01-31T17:01:31.807Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kazan71p","url":"/kazan71p"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2339006,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-01-31T17:02:33.085Z","updated_at":"2018-01-31T17:02:33.085Z","first_to_agree":true,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2339009,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-01-31T17:02:56.668Z","updated_at":"2018-01-31T17:02:56.668Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":112786,"new_severity_id":113966},"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2339031,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Because the repository was public anyway, there was no real security issue here. Still, we appreciate the thorough report. We'd like to send you some swag as a thanks. Please fill out your address and shirt size in your profile and let me know when you have.\n\nWe have been having some issues with our swag being back ordered, so it might take a little while to get it shipped on our end, but I can't start the process until I have the information.\n\nThanks,\nAaron","automated_response":false,"created_at":"2018-01-31T17:08:23.283Z","updated_at":"2018-01-31T17:11:38.185Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"WordPress"}},"reporter":{"username":"kazan71p","url":"/kazan71p"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2341280,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the swag, I've added information to my h1 profile.","automated_response":false,"created_at":"2018-02-01T08:28:21.840Z","updated_at":"2018-02-01T08:28:21.840Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2341282,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-02-01T08:28:39.025Z","updated_at":"2018-02-01T08:28:39.025Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2341283,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-02-01T08:28:39.098Z","updated_at":"2018-02-01T08:28:39.098Z","actor":{"username":"kazan71p","cleared":true,"url":"/kazan71p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/515/f5115b4063836f00a8d58de708ab6cd1ad61f53e_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2341928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have forwarded the necessary information to the person that handles our swag. Thanks again for your help, and I'll try to update you on the progress of the swag when I hear.","automated_response":false,"created_at":"2018-02-01T14:21:14.304Z","updated_at":"2018-02-01T14:21:14.304Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}