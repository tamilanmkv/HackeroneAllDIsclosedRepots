{"id":684099,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODQwOTk=","url":"https://hackerone.com/reports/684099","title":"Periscope-all Firebase database takeover","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-08-29T03:22:26.687Z","submitted_at":"2019-08-29T03:22:26.687Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"deeptiman","url":"/deeptiman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-25T22:01:29.016Z","bug_reporter_agreed_on_going_public_at":"2019-09-17T19:21:21.872Z","team_member_agreed_on_going_public_at":"2019-09-25T22:01:28.938Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nI found one public Firebase database of periscope.tv and I can able to insert data to this database and i only used it once for the testing purposes, so other database queries also possible.\n\nPlease follow the below link to check the inserted test data.\n\n###Periscope-all Firebase URL :- \n\nhttps://█████████/.json\n\n## Impact\n\nThis is quite serious because by using this database attacker can use this for malicious purposes and also an attacker can track this database if periscope uses it for future perspective and at that time it will be much easier for the attacker to steal the data from this repository and later it will harm the reputation of the Periscope.\n\nSo please immediately change the rule of the database to private so that nobody can able to access it outside.\n\nThanks\nDeeptiman Pattnaik","bounty_amount":"560.0","formatted_bounty":"$560","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-17T19:21:21.952Z","allow_singular_disclosure_after":-62625366.35792623,"singular_disclosure_allowed":true,"vote_count":40,"voters":["tolga","msultan","yxw21","sameerphad72","mik317","imranhudaa","tulswani","elmahdi","domssilva","khizer47","and 30 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":1064,"asset_type":"URL","asset_identifier":"*.periscope.tv","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5687358,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nApologies, I forgot to attach the takeover screenshot on my submission. Please find the attached screenshot.\n\nThanks\nDeeptiman Pattnaik","automated_response":false,"created_at":"2019-08-29T03:59:39.298Z","updated_at":"2019-08-29T03:59:39.298Z","actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5694034,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report @deeptiman,\n\nWe were able to see the POC you uploaded to `https://███/.json` endpoint. However, we would like to ask a few questions to ensure we understand how you were able to perform this firebase takeover. Can you provide us steps to reproduce which explain how you were able to upload a file to `https://███/.json` endpoint? Did you find any secret tokens which enabled this attack? Did you have to create or access an account on `firebase` to upload a file to `███████` subdomain? \n\nThank you for thinking of Twitter security.","automated_response":false,"created_at":"2019-08-29T21:04:21.781Z","updated_at":"2019-09-23T21:16:51.155Z","actor":{"username":"bugtriage-sophia","cleared":false,"url":"/bugtriage-sophia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5694240,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @bugtriage-sophia,\n\nThanks for the reply, please follow the below to reproduce the issue.\n\n##Steps to reproduce\n1. Get the APK of periscope app you can use any of the tool to get the APK from the device for this POC i have used \"APK Extractor\" https://play.google.com/store/apps/details?id=com.ext.ui\u0026hl=en\n\n2. Decompile the APK using apktool, follow the below command to extract the source code from the APK.\n    https://ibotpeaches.github.io/Apktool/\n\n    ````````````````````````````````````````````````\n    apktool d Periscope_tv.periscope.android.apk -o ████\n    ````````````````````````````````````````````````\n3. Go to the res/values/strings.xml and look for this and search for \"firebase\" keyword\n\n4. And you will find this URL \"https://████\"\n\n5. Next, go to the browser and paste this URL \"https://█████/.json\"\n\n6. You will observe \"null\" response will come, so it means the firebase database is public but in general, it should show \"Permission Denied\" based on the firebase database rule. https://firebase.google.com/docs/rules\n\n##Security Impact\nAs it's public now it's very simple for the attacker to perform queries into the database. In my POC I took the approach to make one Android application to insert a sample data to confirm the takeover.\n\n###Android Code Snippet\n`````````````````````````````````````````````````````````\npublic class SampleFirebaseActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_sample_firebase);\n\n        Firebase.setAndroidContext(this);\n        Firebase.getDefaultConfig().setPersistenceEnabled(true);\n\n        Firebase firebase = new Firebase(\"https://████████/\");\n\n        firebase.child(\"test\").setValue(\"Periscope Firebase Database take over by Deeptiman Pattnaik\");\n        \n    }\n}\n`````````````````````````````````````````````````````````\n\nThe above application doesn't need any acces_token to insert data to the firebase database it's completely open and anybody can access it without any access credentials.\n\nSo in order to avoid this type of vulnerability, it's always better to make the rules of the database to private.\n\n\nThanks\nDeeptiman Pattnaik\n","automated_response":false,"created_at":"2019-08-29T21:48:12.365Z","updated_at":"2019-09-23T21:17:57.191Z","actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5700722,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report @deeptiman,\n\nWe were able to reproduce the behavior you described and will get back to you when we have more information.\n\nThank you for thinking of Twitter security. ","automated_response":false,"created_at":"2019-08-30T19:39:06.883Z","updated_at":"2019-08-30T19:39:06.883Z","actor":{"username":"bugtriage-sophia","cleared":false,"url":"/bugtriage-sophia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5701587,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2019-08-30T22:55:00.473Z","updated_at":"2019-08-30T22:55:00.473Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5767977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jwaddle,\n\nDo you have any update for my report?\n\nThanks \nDeeptiman Pattnaik\n","automated_response":false,"created_at":"2019-09-10T03:17:04.982Z","updated_at":"2019-09-10T03:17:04.982Z","actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5773873,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @deeptiman,\n\n  I'm trying to determine the potential impact.  You can help in that process by giving specifics on what bad things attackers can do to Twitter or its users by exploiting this vulnerability.","automated_response":false,"created_at":"2019-09-10T18:33:04.823Z","updated_at":"2019-09-10T18:33:04.823Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5774568,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jwaddle,\n\nFirst of all, it's very simple to understand that,   the criticality of an open database with large storage space. It allows an attacker to store highly sensitive compromised data in the Periscope Firebase database anonymously. \n\n An attacker can store many different forms of data in this Firebase database such as -: malicious links, stolen credit card details, user's stolen email's password or some organization's financial information.\n\nMost importantly Firebase allows to store hyperlink in the database, so it's an open advantage for the attacker to design an application to fool the end-user to click on the suspicious links unknowingly. Whereas there is no way of accusing the anonymous attackers of owning the data being stored in the Periscope Firebase database because the complete proprietary owner of the database belongs to Twitter. It will cause severe damage to Twitter's public reputation and may follow a lawsuit from the federal authority for allowing or giving open access to any anonymous attackers store records illegally. \n\n\n###Recent Attacks\n\nThere are some recent attacks occurred for Firebase database misconfiguration and allowing any user to access companies records publicly. I will advise you to please follow the below links, perhaps Periscope may not have the plan to store records in this Firebase database but it will help you to be aware of the sensitivity of misconfiguring the Firebase database.\n\n1. https://www.xda-developers.com/user-data-leak-misconfigured-firebase-backends/\n2. https://medium.com/@fs0c131y/how-i-found-the-database-of-the-donald-daters-app-af88b06e39ad\n3. https://blog.netspi.com/when-databases-attack-entry-points/\n\n###A blog regarding storing stolen records in your database \n\n1. https://www.foregenix.com/blog/magento-websites-stolen-credit-card-data-stored-in-your-database\n\n###Resolve Insecurities\n\nThere are guidelines available by Firebase to resolve the insecurities and misconfiguration, please follow this link\n\n1. https://firebase.google.com/docs/database/security/resolve-insecurities\n\n###Firebase GDPR Ready\n\nFirebase is strongly GDPR compliant model and some key questions have been categorized by Firebase to protect user's privacy and the responsibility of a data protection officer to control the data of an organization.\n\n```````````````````````````````````````````````````````````````````````````````````````````````````````````````````````\n1. How does your organization ensure user transparency and control around data use?\n2. Are you sure that your organization has the right consents in a place where these are needed under the GDPR?\n3. Does your organization have the right systems to record user preferences and consents?\n4. How will you show regulators and partners that you meet the principles of the GDPR and are an accountable organization?\n```````````````````````````````````````````````````````````````````````````````````````````````````````````````````````\n\nI will highly recommend following the below guidelines available for Firebase GDPR ready.\n\n1. https://firebase.google.com/support/privacy\n2. https://www.termsfeed.com/blog/gdpr-firebase-dpo/\n3. https://firebase.google.com/terms/data-processing-terms\n\nAnd one more thing I'd like to point out that this Firebase database link is found in the production periscope Android app, so it's a live database and it needs to be configured securely. And as always it's a best practice to secure companies property properly.\n\nPlease go through the above details and let me know.\n\nThanks\nDeeptiman Pattnaik\n\n","automated_response":false,"created_at":"2019-09-10T20:56:35.091Z","updated_at":"2019-09-10T20:56:35.091Z","actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5802118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jwaddle,\n\n I can see now the Periscope Firebase says \"Permission Denied\", which is correct in terms of unauthorized access. So, this issue resolved now.\n\nhttps://██████████/.json\n\nJust want to know, am I eligible for bounty? \n\nThanks\nDeeptiman Pattnaik","automated_response":false,"created_at":"2019-09-13T18:38:05.508Z","updated_at":"2019-09-23T21:16:35.568Z","actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @deeptiman,\n\n  Yes, as you can see the team has addressed the issue, and the bounty committee will meet in the next day or two to discuss awards.\n\nThank you again for your report!","automated_response":false,"created_at":"2019-09-16T19:03:06.680Z","updated_at":"2019-09-16T19:03:06.680Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5828699,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2019-09-17T19:12:45.254Z","updated_at":"2019-09-17T19:12:45.254Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"560.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"deeptiman","url":"/deeptiman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5828700,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-09-17T19:13:08.119Z","updated_at":"2019-09-17T19:13:08.119Z","actor":{"username":"acamacho","cleared":false,"url":"/acamacho","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"deeptiman","url":"/deeptiman"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5828740,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello @acamacho,\n\nThank you for the bounty. \n\nI have one request, can we disclose this report?\n\nThanks \nDeeptiman Pattnaik","automated_response":false,"created_at":"2019-09-17T19:21:21.903Z","updated_at":"2019-09-17T19:21:21.903Z","first_to_agree":true,"actor":{"username":"deeptiman","cleared":false,"url":"/deeptiman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KT54sp7BfrMmCAqdJL1AhxT5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5847315,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @deeptiman,\n\n Yes, of course!  Please request disclosure through HackerOne's UI: https://docs.hackerone.com/programs/disclosure.html#requesting-disclosure\n\n","automated_response":false,"created_at":"2019-09-19T20:31:01.806Z","updated_at":"2019-09-19T20:31:01.806Z","actor":{"username":"jwaddle","cleared":false,"url":"/jwaddle","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5891632,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-25T22:01:28.970Z","updated_at":"2019-09-25T22:01:28.970Z","actor":{"username":"ngholap","cleared":false,"url":"/ngholap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5891633,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-09-25T22:01:29.040Z","updated_at":"2019-09-25T22:01:29.040Z","actor":{"username":"ngholap","cleared":false,"url":"/ngholap","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}