{"id":723118,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MjMxMTg=","url":"https://hackerone.com/reports/723118","title":"[IDOR] API endpoint leaking sensitive user information","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-10-26T03:24:42.481Z","submitted_at":"2019-10-26T03:24:42.481Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"t4kemyh4nd","url":"/t4kemyh4nd","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":32400,"url":"https://hackerone.com/razer","handle":"razer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Razer","twitter_handle":"","website":"http://www.razer.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-09T03:25:47.508Z","bug_reporter_agreed_on_going_public_at":"2019-12-10T03:25:40.772Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nHi, the backend on the insider.razer.com website seems to be using XenForo. Some actions on the api.php have been left misconfigured by the developers, which lead to leaking of sensitive information.\n\n## Steps To Reproduce:\n\n1. Go to a random user's profile, say, ttps://insider.razer.com/index.php?members/kajira.714/\n2. Look at all the information that can be accessed publicly.\n3. Now go to https://insider.razer.com/api.php?action=getuserprofile\u0026user_id=714, and as you can see, a lot of user metadata is getting leaked, like the email ID, FB and Twitter ID, RZR_ID, CSRF token etc.\n\n## Impact\n\nSince the endpoint https://insider.razer.com/api.php?action=getuserprofile\u0026user_id=714 has a simple numeric ID for users, attacker can easily brute-force it and by exploiting the IDOR, get sensitive information of all the users on insider.razer.com.\n\nI'm self -closing out report #723035 which is the same bug, as it was also found by me along with a friend.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHi, the backend on the insider.razer.com website seems to be using XenForo. Some actions on the api.php have been left misconfigured by the developers, which lead to leaking of sensitive information.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to a random user\u0026#39;s profile, say, ttps://insider.razer.com/index.php?members/kajira.714/\u003c/li\u003e\n\u003cli\u003eLook at all the information that can be accessed publicly.\u003c/li\u003e\n\u003cli\u003eNow go to \u003ca title=\"https://insider.razer.com/api.php?action=getuserprofile\u0026amp;user_id=714\" href=\"/redirect?url=https%3A%2F%2Finsider.razer.com%2Fapi.php%3Faction%3Dgetuserprofile%26user_id%3D714\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://insider.razer.com/api.php?action=getuserprofile\u0026amp;user_id=714\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and as you can see, a lot of user metadata is getting leaked, like the email ID, FB and Twitter ID, RZR_ID, CSRF token etc.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince the endpoint \u003ca title=\"https://insider.razer.com/api.php?action=getuserprofile\u0026amp;user_id=714\" href=\"/redirect?url=https%3A%2F%2Finsider.razer.com%2Fapi.php%3Faction%3Dgetuserprofile%26user_id%3D714\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://insider.razer.com/api.php?action=getuserprofile\u0026amp;user_id=714\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has a simple numeric ID for users, attacker can easily brute-force it and by exploiting the IDOR, get sensitive information of all the users on insider.razer.com.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m self -closing out report \u003ca href=\"/reports/723035\"\u003e#723035\u003c/a\u003e which is the same bug, as it was also found by me along with a friend.\u003c/p\u003e\n","bounty_amount":"375.0","formatted_bounty":"$375","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-01-09T03:25:40.823Z","allow_singular_disclosure_after":-30683777.577013895,"singular_disclosure_allowed":true,"vote_count":168,"voters":["hexpwn","thaivu","mashoud1122","friyin","pr3r00t","spam404","bibekshah","fpatrik","mik317","limerence","and 158 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":37640,"asset_type":"OTHER","asset_identifier":"Group 2 assets (Rewards based on Impact)","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6142442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Requested to close out #723035 on that report itself.","markdown_message":"\u003cp\u003eRequested to close out \u003ca href=\"/reports/723035\"\u003e#723035\u003c/a\u003e on that report itself.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-26T03:42:31.547Z","updated_at":"2019-10-26T03:42:31.547Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6142454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"N/A or informative, both will do.","markdown_message":"\u003cp\u003eN/A or informative, both will do.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-26T03:47:15.921Z","updated_at":"2019-10-26T03:47:15.921Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6143251,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-26T08:40:44.352Z","updated_at":"2019-10-26T08:40:44.352Z","additional_data":{"old_severity":"High","new_severity":"Medium (6.5)","old_severity_id":548829,"new_severity_id":548883},"actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6143260,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission @t4kemyh4nd,\n\nThis appears to be a valid finding. The information you have provided here will be forwarded onto the team. You will receive updates when, and if, there will be any to share. Please note that the status and severity are subject to change.\n\nCheers, \n@chessmast3r  ","markdown_message":"\u003cp\u003eThank you for your submission \u003ca href=\"/t4kemyh4nd\"\u003e@t4kemyh4nd\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis appears to be a valid finding. The information you have provided here will be forwarded onto the team. You will receive updates when, and if, there will be any to share. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eCheers, \u003cbr\u003e\n\u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-26T08:42:27.205Z","updated_at":"2019-10-26T08:42:27.205Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6143296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @chessmast3r and sorry for the misunderstanding, we thought that collaborator option would be enabled for Razer but wasn’t. Kindly close the other report.\n\nRegards,\nAmeya","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e and sorry for the misunderstanding, we thought that collaborator option would be enabled for Razer but wasn’t. Kindly close the other report.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAmeya\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-26T08:58:58.482Z","updated_at":"2019-10-26T08:58:58.482Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6182354,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We will look into this report. ","markdown_message":"\u003cp\u003eWe will look into this report. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-31T12:12:11.404Z","updated_at":"2019-10-31T12:12:11.404Z","actor":{"username":"justinimmanuel","cleared":false,"url":"/justinimmanuel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6205784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this bug seems to be fixed now as it gives an error “missing hash” like the xenforo API should. Can we close this?\n\nRegards\nAmeya","markdown_message":"\u003cp\u003eHi, this bug seems to be fixed now as it gives an error “missing hash” like the xenforo API should. Can we close this?\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nAmeya\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-03T18:44:09.973Z","updated_at":"2019-11-03T18:44:09.973Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6296966,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @t4kemyh4nd, \n\nWe have determined that this issue is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \n\nThanks!\n@chinch1lla ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/t4kemyh4nd\"\u003e@t4kemyh4nd\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eWe have determined that this issue is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\n\u003ca href=\"/chinch1lla\"\u003e@chinch1lla\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-13T12:41:06.048Z","updated_at":"2019-11-13T12:41:06.048Z","actor":{"username":"chinch1lla","cleared":false,"url":"/chinch1lla","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3PY2FU5wvpPhJAVRPEwkHabD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"reporter":{"username":"t4kemyh4nd","url":"/t4kemyh4nd"},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6297031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI confirm this is fixed. Good work. Any updates on the bounty?\n\nRegards,\nAmeya","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI confirm this is fixed. Good work. Any updates on the bounty?\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAmeya\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-13T12:50:06.395Z","updated_at":"2019-11-13T12:50:06.395Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6375199,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Bug resolved, no payout.","markdown_message":"\u003cp\u003eBug resolved, no payout.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-22T04:27:07.675Z","updated_at":"2019-11-22T04:27:07.675Z","actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6509284,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for helping Razer secure its customers' information.  The response to our program has been far more enthusiastic than originally expected.  Our target to award bounties is 15 days from triage and we know it has been much longer than that.  Please accept our apologies for the very lengthy delay in payout.\n","markdown_message":"\u003cp\u003eThank you for helping Razer secure its customers\u0026#39; information.  The response to our program has been far more enthusiastic than originally expected.  Our target to award bounties is 15 days from triage and we know it has been much longer than that.  Please accept our apologies for the very lengthy delay in payout.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-10T03:12:58.620Z","updated_at":"2019-12-10T03:12:58.620Z","actor":{"url":"/razer","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Razer"}},"bounty_amount":"375.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"razer","collaborator":{"username":"t4kemyh4nd","url":"/t4kemyh4nd"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6509306,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-10T03:25:40.794Z","updated_at":"2019-12-10T03:25:40.794Z","first_to_agree":true,"actor":{"username":"t4kemyh4nd","cleared":false,"url":"/t4kemyh4nd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aqxHyEPSS27VEDnjS82KRG8C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6722551,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-09T03:25:47.534Z","updated_at":"2020-01-09T03:25:47.534Z","actor":{"url":"/razer","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Z49PFcR6KPvfqpAhqzW5ojdc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Razer"}},"genius_execution_id":null,"team_handle":"razer","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}