{"id":764243,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjQyNDM=","url":"https://hackerone.com/reports/764243","title":"API - Amazon S3 bucket misconfiguration","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-12-25T02:31:24.148Z","submitted_at":"2019-12-25T02:31:24.148Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"c37m","url":"/c37m","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KrAqw24Wr2Js9AL9KuRnM7vX/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41881,"url":"https://hackerone.com/bcm","handle":"bcm","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"BCM Messenger","twitter_handle":"BCM_SOCIAL","website":"https://bcm-im.com","about":"Born for the freedom of communication"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-14T23:54:07.670Z","bug_reporter_agreed_on_going_public_at":"2020-03-15T23:54:07.524Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear, BCM Messenger \n##Description\nMy discovering was starting from com.bcm.messenger,\nFirst, i trace what application send and receive from the network so i use [Frida tool](https://www.frida.re) to [bypass SSL pinning](https://medium.com/@buff3r/root-detection-ssl-pinning-bypass-with-frida-framework-31769d31723a),\nThen i was able to trace application  http traffic, and since API data is not encrypted and there's nothing protect API such as token... \nthat's make the `API Opened to public` .\n\nSo in this point : \nhttp://47.52.75.65:8080//v1/attachments/s3/upload_certification application send demand to upload image (profile image )\n Api respond with : \n```json\n{\"downloadUrl\":\"https://d3v5qmgpw891au.cloudfront.net/profile/1CDfyqYQfPRs2m1a1VSMaD89GZ63Mwu78N/7a6998d3f4ab421e9619627b33f1ce6b\",\"fields\":[{\"key\":\"key\",\"value\":\"profile/1CDfyqYQfPRs2m1a1VSMaD89GZ63Mwu78N/7a6998d3f4ab421e9619627b33f1ce6b\"},{\"key\":\"X-Amz-Credential\",\"value\":\"AKIA3NG2JXZC3SY2WNXE/20191225/ap-east-1/s3/aws4_request\"},{\"key\":\"X-Amz-Date\",\"value\":\"20191225T002608Z\"},{\"key\":\"X-Amz-Algorithm\",\"value\":\"AWS4-HMAC-SHA256\"},{\"key\":\"Policy\",\"value\":\"eyAiZXhwaXJhdGlvbiI6ICIyMDE5LTEyLTI1VDAwOjU2OjA4LjAwMFoiLAogICJjb25kaXRpb25zIjogWwogICAgeyJidWNrZXQiOiAiYmNtLWhrIn0sCiAgICBbImVxIiwgIiRrZXkiLCAicHJvZmlsZS8xQ0RmeXFZUWZQUnMybTFhMVZTTWFEODlHWjYzTXd1NzhOLzdhNjk5OGQzZjRhYjQyMWU5NjE5NjI3YjMzZjFjZTZiIl0sCiAgICBbImNvbnRlbnQtbGVuZ3RoLXJhbmdlIiwgMSwgNjcxMDg4NjRdLAogICAgeyJ4LWFtei1jcmVkZW50aWFsIjogIkFLSUEzTkcySlhaQzNTWTJXTlhFLzIwMTkxMjI1L2FwLWVhc3QtMS9zMy9hd3M0X3JlcXVlc3QifSwKICAgIHsieC1hbXotYWxnb3JpdGhtIjogIkFXUzQtSE1BQy1TSEEyNTYifSwKICAgIHsieC1hbXotZGF0ZSI6ICIyMDE5MTIyNVQwMDI2MDhaIiB9CiAgXQp9\"},{\"key\":\"X-Amz-Signature\",\"value\":\"dc4f9003a5613f72ee7b13154deaa503dcc23eb233d6fb651e12b907926f86ce\"}],\"postUrl\":\"https://bcm-hk.s3.ap-east-1.amazonaws.com/\"}\n```\nSo as you can see, the bucket name is bcm-hk with \u003caccess-key-id\u003e = `AKIA3NG2JXZC3SY2WNXE` \n\nBy this json data  we can upload any file with any size to this bucket for (current user) .\n \n##PoC :\nI Write a Python3 script ( {F668054} ) make the upload file fast and easy :\nUSAGE : `python aws.py filename`\n\n\nChose any file with any size , the file will uploaded and encoded with base65 \nRequirement : requests,json,base64,mimetypes,sys \n{F668052}\n\nFile saved in : \nhttps://bcm-hk.s3.ap-east-1.amazonaws.com/profile%2F14HXhz8Aef9NnH1Ubvwb5gEXUebzZjtEem%2F23a3ca622f9d4e52bc69387451580ae8\n\n## Impact\n\n## Risk : \nSince the registration is free, and no limit of how much account can be opened from one user (no email check , no phone check ...)  attacker or ATTACKERS  find this bucket as free cloud service they will upload what they want and share they files using your resources (in groups,in their communities  ... ) so you will get fake users or hackers.\n\n\n\nBest regards ,\nMohamed Slamat\nm.slamat@outlook.com","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":668052,"file_name":"poc_IC_bcm.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/uzm7L5p6VHtqsGos7Li9vYrW?response-content-disposition=attachment%3B%20filename%3D%22poc_IC_bcm.png%22%3B%20filename%2A%3DUTF-8%27%27poc_IC_bcm.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152435Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cc32300b8121b23b7acc5685b6fb24c42a1b2f4347c0f5d7e18e12c50c3163b5","file_size":86786,"type":"image/png"},{"id":668054,"file_name":"aws.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2D7hjDeWL9vMqsQuHLckHnvH?response-content-disposition=attachment%3B%20filename%3D%22aws.py%22%3B%20filename%2A%3DUTF-8%27%27aws.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152435Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5f909f69b989a1db9143769fcc1576959a745a986e79134396add0c32052b658","file_size":2940,"type":"text/x-python"}],"allow_singular_disclosure_at":"2020-04-14T23:54:07.610Z","allow_singular_disclosure_after":-47057427.95940302,"singular_disclosure_allowed":true,"vote_count":24,"voters":["a_d_a_m","bl4de","ali","nipe","brumens","idiablos","tuplesec","what_web","sa1tama0","klau5","and 14 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":35498,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.bcm.messenger","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6660523,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anyone  :) ? ","automated_response":false,"created_at":"2019-12-30T17:00:56.747Z","updated_at":"2019-12-30T17:00:56.747Z","actor":{"username":"c37m","cleared":false,"url":"/c37m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KrAqw24Wr2Js9AL9KuRnM7vX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7297658,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We verified the problem. Thank you for this report!","automated_response":false,"created_at":"2020-03-12T11:31:50.392Z","updated_at":"2020-03-12T11:31:50.392Z","actor":{"url":"/bcm","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"BCM Messenger"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"bcm","collaborator":{"username":"c37m","url":"/c37m"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7299480,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bcm_messenger, Thank you for the bounty ! \nThe bug it seems fixed, \nMay I ask, If you agree with the CVSS ? \n\nBest,\n","automated_response":false,"created_at":"2020-03-12T13:47:38.747Z","updated_at":"2020-03-12T13:47:38.747Z","actor":{"username":"c37m","cleared":false,"url":"/c37m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KrAqw24Wr2Js9AL9KuRnM7vX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7307273,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-03-13T07:18:49.857Z","updated_at":"2020-03-13T07:18:49.857Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":595762,"new_severity_id":658727},"actor":{"username":"bcm_messenger","cleared":false,"url":"/bcm_messenger","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/673/350/397f00c47d588d4adf6ce636194cd620d18265f0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7307277,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Change severity to medium. And extra $200 reward.","automated_response":false,"created_at":"2020-03-13T07:19:04.447Z","updated_at":"2020-03-13T07:19:04.447Z","actor":{"url":"/bcm","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"BCM Messenger"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"bcm","collaborator":{"username":"c37m","url":"/c37m"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7307278,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-03-13T07:19:17.177Z","updated_at":"2020-03-13T07:19:17.177Z","actor":{"username":"bcm_messenger","cleared":false,"url":"/bcm_messenger","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/673/350/397f00c47d588d4adf6ce636194cd620d18265f0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"c37m","url":"/c37m"},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7308239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bcm_messenger , \nThank you for the extra bounty :) \nHave a nice day .\nThanks","automated_response":false,"created_at":"2020-03-13T09:15:36.671Z","updated_at":"2020-03-13T09:15:36.671Z","actor":{"username":"c37m","cleared":false,"url":"/c37m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KrAqw24Wr2Js9AL9KuRnM7vX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7323953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"hi @bcm_messenger \nAfter fixing the bug, can you accept the disclosure ? ","automated_response":false,"created_at":"2020-03-15T23:54:07.548Z","updated_at":"2020-03-15T23:54:07.548Z","first_to_agree":true,"actor":{"username":"c37m","cleared":false,"url":"/c37m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KrAqw24Wr2Js9AL9KuRnM7vX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7665474,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-04-14T23:54:07.695Z","updated_at":"2020-04-14T23:54:07.695Z","actor":{"url":"/bcm","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/881/942a0196aba739f0c60f967235fea7dee78efb21_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"BCM Messenger"}},"genius_execution_id":null,"team_handle":"bcm","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}