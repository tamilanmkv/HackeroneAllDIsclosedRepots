{"id":796379,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTYzNzk=","url":"https://hackerone.com/reports/796379","title":"[Critical] Insufficient Access Control On Registration Page of Webapps Website Allows Privilege Escalation to Administrator ","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-02-14T02:36:19.299Z","submitted_at":"2020-02-14T02:36:19.299Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hunt4p1zza","url":"/hunt4p1zza","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yG7Sytapy7fzy4kb6GyXeSaN/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-27T14:20:32.011Z","bug_reporter_agreed_on_going_public_at":"2020-05-19T20:14:56.031Z","team_member_agreed_on_going_public_at":"2020-05-27T14:20:31.926Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHello.\n\nDue to insufficient access controls and poor implementation of the registration at https://████████/████/login.cfm it was possible to register while privilege escalating to an administrator.\n\n**Description:**\nIt was possible to tamper with the registration request at https://█████████/██████/screen_questions.cfm which is aimed to ███████ applications for education in order to sign-up with administrator privileges. As a result, it was possible to gain access to personally identifiable information (PII) of all the applicants in the system, including SSNs, names, phones and emails.\n\nAt this point I stopped digging further and I started writing this report.\n\n**Note:** Please can you liaise with the system's administrator and kindly ask them to remove the below accounts from the system after this has been triaged and resolved:\n\n```\n██████\n█████████\n███\n█████████\n██████\n███\n█████████\n█████████\n```\n\nApologies for creating all these accounts, most of them are just low privileged applicants, but I was confused as to why this attack worked and it took few attempts to figure it out.\n\nPlease let me know when this is resolved and I will remove any evidence that include PII data from my local system which are only kept locally.\n\n## Impact\nAn attacker can gain administrative access in the system allowing them to expose sensitive PII information, such as including SSNs, names, phones and emails. Having this access, an attacker could completely take over the website and perform further attacks against it from this authenticated viewpoint - however I did not perform this. Attackers may sell this PII information on black-markets for profit.\n\nIf this was exploited and published there would be severe reputational and legal ramifications for DoD.\n\n## Step-by-step Reproduction Instructions\n\n1. Initially, enable your web intercepting proxy such as Burp Suite\n2. Next, browse to the initial registration page at: https://████/████████/screen_questions.cfm and choose options in the dropdown lists: █████████\n3. Next, you will be taken at the actual registration page at https://████/████████/newuser.cfm?loc_class=L (you can probably skip step 2 and come right here)\n4. Fill in this form with some information and a legitimate looking SSN number. Keep in mind that if the SSN is registered in the system, the website will error, so you will have to try another one.\n5. Intercept the request and modify it so that the `user_type` parameter has value 4, and the `fname` and `lname` parameters have values `Hackerone\u003c%` and `test\u003c%xss`. I believe it is `\u003c%` that is causing this privilege escalate issue, but as I am not 100% positive I am giving you the full values. The request should look like mine: █████\n6. If all went well, you should be logged in and prompted with a Privacy page which you need to accept.\n7. Notice how this account has administrator access, an example is shown below: █████████\n\nFinally, I created 2 short PoC videos showing how I was able to register as admin and how I was able to access PII data:\n\nCreate admin account video: ██████\n\nAccess PII data video: {F716040}\n\n## Product, Version, and Configuration (If applicable)\nThe https://█████████ website is under █████████ which is part of DoD, as shown: █████████\n\n## Suggested Mitigation/Remediation Actions\nUnfortunately, I am not 100% positive on what exactly is causing this flaw, but injection of `\u003c%` is required. This could be mitigated by applying strict user input validation in the `fname` and `lname` fields. Please see the link below for more information:\n\nhttps://owasp.org/www-project-cheat-sheets/cheatsheets/Input_Validation_Cheat_Sheet\n\nI would also recommend that you review the current user access types and levels in accordance with the findings above to ensure that setting the `user_type` to other numbers than the default one when registering (5) does not allow users to gain more privileges than they are authorized to. \n\nAdditionally, review the whole codebase for broken access control, the following cheatsheet from OWASP provides more information:\n\nhttps://owasp.org/www-project-cheat-sheets/cheatsheets/Access_Control_Cheat_Sheet\n\nFinally, the web application appears to be very susceptible to common web application attacks and I would recommend that this undertakes a full thorough security test if possible or a code review, if of course it is required and cannot be decommissioned. \n\nPS: I will do my best to submit reports in terms of the rest of flaws I was able to spot while looking at it.\n\n## Impact\n\nAn attacker can gain administrative access in the system allowing them to expose sensitive PII information, such as including SSNs, names, phones and emails. Having this access, an attacker could completely take over the website and perform further attacks against it from this authenticated viewpoint - however I did not perform this. Attackers may sell this PII information on black-markets for profit.\n\nIf this was exploited and published there would be severe reputational and legal ramifications for DoD.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["brahim_boufakri01","piyushshukla25","rrivera","stargazer42","jthart","jaywills"],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7049465,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2020-02-14T02:36:19.522Z","updated_at":"2020-02-14T02:36:19.522Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7049677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One of the accounts I had created with `user_type`=1 appeared to be of applicant level while trying to investigate this. However, I tried logging in with this later to test other functionalities and to my surprise I was super system administrator. I was really confused by this, but there may be some delay when the site applies permissions as I tried playing with the `user_type` a lot to verify it.\n \nI am attaching a new PoC video showing how I was able to access the site with my super admin account: ██████ \n\nPlease let me know if you need me to provide you with the credentials.","automated_response":false,"created_at":"2020-02-14T04:05:12.117Z","updated_at":"2020-05-27T12:55:01.420Z","actor":{"username":"hunt4p1zza","cleared":true,"url":"/hunt4p1zza","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yG7Sytapy7fzy4kb6GyXeSaN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7053288,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-14T13:00:54.512Z","updated_at":"2020-02-14T13:00:54.512Z","additional_data":{"old_severity":null,"new_severity":"Critical","old_severity_id":null,"new_severity_id":633764},"actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7053289,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2020-02-14T13:00:55.504Z","updated_at":"2020-02-14T13:00:55.504Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7055649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hunt4p1zza good report man.  Do me a favor in the future though and try not to upload anything that has PII in it.  No big deal, I reached out to H1 to have the 2nd video deleted.  ","automated_response":false,"created_at":"2020-02-14T17:31:13.826Z","updated_at":"2020-02-14T17:31:13.826Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7055657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ag3nt-j1 thank you. What you say makes perfect sense, duly noted! I will only be uploading sanitized images and we will see on case per case if you guys need a video which is more difficult to edit.\n\nAppreciate the feedback!","automated_response":false,"created_at":"2020-02-14T17:33:26.568Z","updated_at":"2020-02-14T17:33:26.568Z","actor":{"username":"hunt4p1zza","cleared":true,"url":"/hunt4p1zza","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yG7Sytapy7fzy4kb6GyXeSaN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7145503,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2020-02-25T12:30:47.785Z","updated_at":"2020-02-25T12:30:47.785Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"hunt4p1zza","url":"/hunt4p1zza"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8052106,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If you don't mind, I think it will be nice if we disclosed this :)","automated_response":false,"created_at":"2020-05-19T20:14:56.052Z","updated_at":"2020-05-19T20:14:56.052Z","first_to_agree":true,"actor":{"username":"hunt4p1zza","cleared":true,"url":"/hunt4p1zza","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yG7Sytapy7fzy4kb6GyXeSaN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8119549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-05-27T14:20:31.946Z","updated_at":"2020-05-27T14:20:31.946Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119550,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-27T14:20:32.035Z","updated_at":"2020-05-27T14:20:32.035Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8119553,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2020-05-27T14:20:38.936Z","updated_at":"2020-05-27T14:20:38.936Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}