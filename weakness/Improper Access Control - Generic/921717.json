{"id":921717,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjE3MTc=","url":"https://hackerone.com/reports/921717","title":"Improper access control to messages of Social app","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-12T22:16:43.535Z","submitted_at":"2020-07-12T22:16:43.535Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sanktjodel","url":"/sanktjodel","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8278"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-17T16:36:32.453Z","bug_reporter_agreed_on_going_public_at":"2020-11-17T16:36:32.381Z","team_member_agreed_on_going_public_at":"2020-11-17T10:03:41.439Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The Social App (https://apps.nextcloud.com/apps/social) lacks access controls in the `displayPost` function (`/@{username}/{token}`) allowing an unauthenticated user to view any message content by knowing or guessing the message ID.\n\nThe vulnerable code is at https://github.com/nextcloud/social/blob/97fb063479d4c0ad6fccdea3774601a619f8a886/lib/Controller/ActivityPubController.php#L367.\nNote the TODO comment and the lack of authentication and authorization checks.\n\nThe following is a sample curl request to access a direct (private) message (replace the host, username, and the token value):\n\n```\ncurl -X 'GET' -H 'Accept: application/activity+json' 'http://{nextcloudHost}/apps/social/@{username}/{token}'|jq\n```\n\nThe `token` value consists of digits only and is based on the unix time.\nAn attacker would have to know or guess (e.g. brute force) this message ID.\n\n## Impact\n\nAn unauthenticated attacker can view any social message, including private (direct) messages from one user to another.\nThe attacker would have to know or guess the token value.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-17T10:03:41.574Z","allow_singular_disclosure_after":-25767525.412269615,"singular_disclosure_allowed":true,"vote_count":2,"voters":["ankitpuri","helphen"],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8574717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2020-07-12T22:16:44.556Z","updated_at":"2020-07-12T22:16:44.556Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8577944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report.\nThat looks indeed fishy. I will forward your report to the author of the app.","automated_response":false,"created_at":"2020-07-13T06:58:29.826Z","updated_at":"2020-07-13T06:58:29.826Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8577946,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-07-13T06:58:46.902Z","updated_at":"2020-07-13T06:58:46.902Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8582513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nIt is a known issue but I will work on a fix as soon as possible.\n\nThanks for your report/remember!\n\nMaxence.","automated_response":false,"created_at":"2020-07-13T12:50:41.763Z","updated_at":"2020-07-13T12:50:41.763Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8772141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nA PR is available on https://github.com/nextcloud/social/pull/952 that should filter the displayed post using the current viewer if authenticated.\n\nRegards,\n\nMaxence.","automated_response":false,"created_at":"2020-07-27T21:02:29.463Z","updated_at":"2020-07-27T21:02:29.463Z","actor":{"username":"maxence","cleared":false,"url":"/maxence","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9709772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue has been fixed over 3 months ago. Can we resolve this issue and make it public?","automated_response":false,"created_at":"2020-11-03T05:14:01.300Z","updated_at":"2020-11-03T05:14:01.300Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9711128,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in a maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","automated_response":false,"created_at":"2020-11-03T08:36:39.504Z","updated_at":"2020-11-03T08:36:39.504Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sanktjodel","url":"/sanktjodel"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9721144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.\n\nName: Roger Meyer\nWebsite: https://twitter.com/sanktjodel","automated_response":false,"created_at":"2020-11-04T05:55:23.251Z","updated_at":"2020-11-04T05:55:23.251Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9842687,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"The social app is not eligible for bounties.","automated_response":false,"created_at":"2020-11-17T09:50:42.041Z","updated_at":"2020-11-17T09:50:42.041Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842716,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-17T09:54:18.014Z","updated_at":"2020-11-17T09:54:18.014Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.0)","old_severity_id":777157,"new_severity_id":908175},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842726,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-11-17T09:55:21.036Z","updated_at":"2020-11-17T09:55:21.036Z","additional_data":{"old_title":"Social App lacks access controls on messages allowing unauthenticated users to view any message","new_title":"Unauthenticated access to messages of Social app"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842729,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-11-17T09:55:57.372Z","updated_at":"2020-11-17T09:55:57.372Z","additional_data":{"old_title":"Unauthenticated access to messages of Social app","new_title":"Improper access control to messages of Social app"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842733,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-11-17T09:56:05.736Z","updated_at":"2020-11-17T09:56:05.736Z","additional_data":{"added_weaknesses":[{"id":26,"name":"Improper Access Control - Generic"}],"removed_weaknesses":[{"id":27,"name":"Improper Authentication - Generic"}]},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842828,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE pending: CVE-2020-8278\nAdvisory will be published at https://nextcloud.com/security/advisory/?id=NC-SA-2020-042","automated_response":false,"created_at":"2020-11-17T10:03:23.440Z","updated_at":"2020-11-17T10:03:23.440Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9842838,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-17T10:03:41.461Z","updated_at":"2020-11-17T10:03:41.461Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9846649,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-11-17T16:36:32.414Z","updated_at":"2020-11-17T16:36:32.414Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9846650,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-17T16:36:32.608Z","updated_at":"2020-11-17T16:36:32.608Z","actor":{"username":"sanktjodel","cleared":false,"url":"/sanktjodel","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}