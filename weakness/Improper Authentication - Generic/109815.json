{"id":109815,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk4MTU=","url":"https://hackerone.com/reports/109815","title":"Direct URL access to completed reports","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-10T21:39:50.462Z","submitted_at":"2016-01-10T21:39:50.462Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"roshanpty","url":"/roshanpty","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-06T00:57:57.911Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-05T00:57:37.807Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Access to non-HTML contents such as CSV report is not restricted to authenticated users.\n\nAnyone would be able to access a CSV report by giving the direct URL and downloading it. The URL could be obtained from browser history. The following URL is an example.\n\nhttps://coinbase-tmp.s3.amazonaws.com/f83af6cee5520796d9876723e59225b772abfd89fff6f5d8fee3069f6e4738b07481896312c41d8bf43413a57b5b19a907fb3729f886c336caac8c49d1d302ae/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-10-21%3A31%3A51.csv\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-06T00:57:38.102Z","allow_singular_disclosure_after":-176732810.64944598,"singular_disclosure_allowed":true,"vote_count":1,"voters":["omarelfarsaoui"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":755744,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report, we're going to explore whether we can use signed download links to mitigate this issue.\n","automated_response":false,"created_at":"2016-01-13T04:39:15.313Z","updated_at":"2016-01-13T04:39:15.313Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've refactored the reports download mechanism so an authenticated session is required to download a report.\n\nThe fix does not apply retroactively to existing reports. However, reports expire in S3 after 7 days so 7 days from now all reports will require an authenticated session to download.\n\nCan you confirm you're no longer able to reproduce the issue for new reports?","automated_response":false,"created_at":"2016-01-25T22:38:13.252Z","updated_at":"2016-01-25T22:38:13.252Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Coinbase team, \n\nLooks like the fix isn't intact. Even newly generated reports can be downloaded without an authentication if the direct URL can be obtained.\n\nTry accessing the following link \nhttps://coinbase-tmp.s3.amazonaws.com/de6154fb5ccca18a6fab5ffae41cfc6fcafffd125a667dec678396418fb82262b5c165cf49ca5c37a07baa9df1bc6fad82562def0d6817c5c83bfeb628674e55/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-26-04%3A28%3A00.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJ2QUFAAIC5QIWRYA%2F20160126%2Fus-east-1%2Fs3%2Faws4_request\u0026X-Amz-Date=20160126T042803Z\u0026X-Amz-Expires=300\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fdce38a12a35ae9a8f262f4980332dce0006756364f38753acd96828a68ae6e6\n\nI think the issue is happening because the source for the report file isn't the same as coinbase.com.\n\nAs an alternative you may try to include a dynamic token in the download URL, which is generated each time the download button is clicked and is valid only one time or for a short period of time.","automated_response":false,"created_at":"2016-01-26T04:34:04.135Z","updated_at":"2016-01-26T04:34:04.135Z","actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":772914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That link includes a signed timestamp. It's only valid for 5 minutes (see screenshot for what happens when I try to use it).\n\nI could lower it to one minute, but I think the issue is already essentially fixed at this point.","automated_response":false,"created_at":"2016-01-26T19:02:07.205Z","updated_at":"2016-01-26T19:02:07.205Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":70963,"filename":"Screen_Shot_2016-01-26_at_2.00.07_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/070/963/dfb13464b3f2e86512cc34e87405167bf695cc3a/Screen_Shot_2016-01-26_at_2.00.07_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-01-26_at_2.00.07_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-01-26_at_2.00.07_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRJF6VFL6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132428Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCID1So1KYRjOmBFJqLsqO1j9SSUCF9kJ%2FHqahOyDLmrnJAiAr2q5Z8bAgCyaCmyDSz7xwtmUTDOoz04myJOluBHRCeyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMvFUMWX6P00RsVarQKtcDflFFNScU3coA1YbnKy4lPXtwGDNsJcqhfcCTaePuAuK6nWvl5xRbjzjOBPvBHaTAnb2Iw%2B6Jdj2uyjmRMn%2F5%2F5AzD5di2wWOcC0am9iLaFmORG4VIVXTc8aAiiwqjNAu7dH2hTUNL9bwPzYUBq3%2FjwvNZUM%2FmpdXfugOwAP%2FP3w9e9PqozA16XzrwGIunimlg58HKZfOM0xp%2FESLFXRHAssX6DaYqQQyV5%2F0triAQeOx328GOBUjfGTiAl1aoS1J0%2FqN%2BmywXW%2FqqkEfAQ2n2f18dX2dkbwMnyQ4F47zR6jJw3CdBkeCPRDbbhcu8YGu2%2F%2BzzM9B4uguhR76M3KYB3dr919eRp%2F%2BcOfUxc8TC3gXMmp1jh0ywwC27sBrzUgZdh%2B2g4artPxRaRZPHbQvC%2F1OZ0MxZYsQmEItbUc65WqfO6PSdLbymEFDMyN5ona14j%2BaQHfp1MWNaO02I2WPYO5mZIsPuHjCO5MYUldcsrZMP7pydKVo87gkO2fPB2orxw1RGazxVwGy5R2PDIV7HsKH4KSOqhGLTTYcSjZvxzmTWIy013yrXhU3CEdFUoB7QifSN1bUli2cMIaUe7sr75onhlaNnQxqLv%2By7jqQ9RiOHvcMM4XIMInwkIsGOqYBzgDHFUI%2FtkToYUBHsGsXyI9vGkS81IUV4PSjgSfvCFIGR%2BPjro3EYi30Oc%2FQZijhik3H1oI82Vno5zo%2BVnueR7%2BkGCloKvMkJAe%2F77e%2BPPRDClquvRG9ERm7ELsd6WvljYOJTmuP4pWPW%2B2d%2BQu26lThNein0I5abJKiu%2FYvnXDmBeYAgLMwbyg9Lq3qT5qMKsr3i1aOgHcGHtYldnzNcLqwaNJYhw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d9910f46f0806b1406aad838783e2f32b9e582b14e7f78b321835983bc936d4b"}],"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah I missed that. Looks like the issue is fixed. \u003cthumbs up\u003e","automated_response":false,"created_at":"2016-01-26T20:37:54.176Z","updated_at":"2016-01-26T20:37:54.176Z","actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774498,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-01-27T21:59:41.012Z","updated_at":"2016-01-27T21:59:41.012Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"roshanpty","url":"/roshanpty"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774499,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-01-27T21:59:57.144Z","updated_at":"2016-01-27T21:59:57.144Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"roshanpty","url":"/roshanpty"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":785695,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-02-05T00:57:37.833Z","updated_at":"2016-02-05T00:57:37.833Z","first_to_agree":true,"actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":825877,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-03-06T00:57:57.941Z","updated_at":"2016-03-06T00:57:57.941Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":963537,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2016-05-18T18:14:18.866Z","updated_at":"2016-05-18T18:14:18.866Z","additional_data":{"duplicate_report_id":139593},"actor":{"username":"lccunha","cleared":false,"url":"/lccunha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/562/b025a5d8b6828835c53bff4cd51b40afe563e00b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":966559,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","automated_response":false,"created_at":"2016-05-20T15:52:24.835Z","updated_at":"2016-05-20T15:52:24.835Z","actor":{"username":"lccunha","cleared":false,"url":"/lccunha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/562/b025a5d8b6828835c53bff4cd51b40afe563e00b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/lccunha","username":"lccunha"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}