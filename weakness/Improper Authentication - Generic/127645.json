{"id":127645,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjc2NDU=","url":"https://hackerone.com/reports/127645","title":"Session Impersonation in riders.uber.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-04-01T19:57:11.651Z","submitted_at":"2016-04-01T19:57:11.651Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"durga","url":"/durga","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T22:35:03.743Z","bug_reporter_agreed_on_going_public_at":"2016-04-04T15:27:47.155Z","team_member_agreed_on_going_public_at":"2016-06-13T22:35:03.496Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Steps:**\n* First log in as attacker in riders.uber.com.\n* Victim now opens  https://login.uber.com/login in same browser (eg: net cafe).\n* It asks you to enter login credentials even though another session is alive.\n* If victim enters his account credentials, he will be taken to riders site.\n* Even though riders domain is logged in with attacker account, it still takes him to that attacker logged in session.\n\n**Should be:**\n* Shouldn't show login when session is alive.\n* Should have cleared old account and let new user login.\n\n**Problems:**\n* Serious consequences could be, user might assuming he is updating his account and may enter his credit card details in attacker account.\n\n**POC**\nhttps://drive.google.com/file/d/0B9ftrLQ2j3woVktxY181U1pSMk0/view?usp=sharing\n(sending link as attachment is 11.X mb)\n\nThanks","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-04T15:27:47.601Z","allow_singular_disclosure_after":-171583705.9549563,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":883860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@durga this seems like an attack scenario where two users have to share the same computer for this to work. If this is the case this bug is out of scope as per our rules:\n\u003ePhysical or social engineering attempts (this includes phishing attacks against Uber employees)\n\nCan you clarify?","automated_response":false,"created_at":"2016-04-01T20:43:32.045Z","updated_at":"2016-04-01T20:43:32.045Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883861,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2016-04-01T20:43:39.690Z","updated_at":"2016-04-01T20:43:39.690Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883876,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@mandatoryuber  It doesn't necessarily has to be considered as social engineering. Lets take I have 2 accounts, one personal and another business account. I use both the accounts based on requirement, this issue will cause lots of trouble to such users. Hope it makes sense.","automated_response":false,"created_at":"2016-04-01T20:50:36.387Z","updated_at":"2016-04-01T20:51:00.376Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm talking about the \"Physical\" portion? Again, please elaborate on how this attack works - are two users at the same computer?","automated_response":false,"created_at":"2016-04-01T20:53:00.920Z","updated_at":"2016-04-01T20:53:00.920Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883896,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, assuming user uses same computer for both accounts. He switches between them based on his requirement.\n\n\n","automated_response":false,"created_at":"2016-04-01T20:58:04.647Z","updated_at":"2016-04-01T20:58:04.647Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883900,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Ok, that's why this falls under the \"Physical\" attacks section of rules and is out of scope. Generally speaking, if you have access to someone's computer then their is not much you can do to prevent an attack. Thank you for the report regardless and let us know if you find anything else!","automated_response":false,"created_at":"2016-04-01T20:59:44.808Z","updated_at":"2016-04-01T20:59:44.808Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mandatoryuber Just a moment please, I will explain again","automated_response":false,"created_at":"2016-04-01T21:01:14.624Z","updated_at":"2016-04-01T21:01:25.960Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess you are thinking about multiple users using single computer.\n\nBut take this case of 1 user having 2 accounts (Same user). one personal account and one business account. ","automated_response":false,"created_at":"2016-04-01T21:03:43.531Z","updated_at":"2016-04-01T21:13:10.132Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let say I logged in as personal account. Later I try to login with business account, but system takes me to personal account. Now as a user, how would I know that? ","automated_response":false,"created_at":"2016-04-01T21:05:26.636Z","updated_at":"2016-04-01T21:05:26.636Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":883927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mandatoryuber Do you still receive these replies? or its closed permanently? Please reply back to my previous comment. Thanks in advance.","automated_response":false,"created_at":"2016-04-01T21:12:15.333Z","updated_at":"2016-04-01T21:12:15.333Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":887647,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-04T15:27:47.178Z","updated_at":"2016-04-04T15:27:47.178Z","first_to_agree":true,"actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":890610,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@durga,\n\nThis seems more like a application logic issue versus a security issue. I agree the functionality could be somewhat confusing, but I'm not seeing the security impact.\n\nCan you expound on how you would use this to attack someone?\n\nCheers,\nRob","automated_response":false,"created_at":"2016-04-05T20:35:19.652Z","updated_at":"2016-04-05T20:35:19.652Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":891151,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fletcher,\n\nThanks for you reply. Let me explain what is happening here again.\n\nIt guess, SSO/Session implementation is working like this.\n\n1) login.uber.com is a centralized server, where authentication happens.\n2) All other services (riders.uber.com, developer.ber.com etc) gets the authorization token, and creates their own session.\n3) When user logout of any service, it clears their service session and redirects the user to login.uber.com to clear global session.\n4) But what about other service session tokens???\n\nriders.uber.com is the case, let say, \n1) login into riders.uber.com \u0026 partners.uber.com\n2) Logout from partners.uber.com, it logouts from both partners.uber.com \u0026 login.uber.com but not from riders.uber.com\n\nSo, when using multiple domains, you need to keep the shared cookies/sessions in sync, meaning that if you log out from an app, you need to also delete the auth cookie to ensure that users are globally logged out across all services. \n\nAnother issue I submitted along with this is https://hackerone.com/reports/127627 (similar issue). I would like to say, SSO/Session implementation is not adequate.\n\n**Coming to security issues:**\n1) Serious consequences could be, user might be assuming he is updating his account and may enter his credit card details in attacker account when they share the device (eg: office environment, public internet cafe etc).\n2) User might be having multiple accounts, he might be switching himself between his accounts (business \u0026 personal account), he can mistakenly add office card in personal or vice versa.\n\nThis url (https://riders.uber.com/oauth/callback?code={AUTH_TOKEN}) is vulnerable to CSRF attacks, luckily internal server error is throwing up. Otherwise, this would have been more critical issue (attacker could have attacked easily), please add state param to your sso implementation.\n\nThanks\n","automated_response":false,"created_at":"2016-04-06T05:03:04.746Z","updated_at":"2016-04-06T05:03:23.239Z","actor":{"username":"durga","cleared":false,"url":"/durga","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":892146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @durga,\n\nThanks for those details - that helps me better understand your thought process! Your understanding of our SSO setup is essentially accurate.\n\nThat being said, this is not an issue we consider in-scope as @mandatoryuber (and @notcollin in #127627) alluded to based on needing physical access.\n\nThanks for your reports and good luck bug hunting in the future!\n\nCheers,\nRob\n","automated_response":false,"created_at":"2016-04-06T16:18:47.610Z","updated_at":"2016-04-06T16:18:47.610Z","actor":{"username":"fletcher","cleared":false,"url":"/fletcher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/090/8b777383ddc3ab23063609c8beb1cb1f689a75c1_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012099,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Publicly disclosing this per the researcher's request. ","automated_response":false,"created_at":"2016-06-13T22:35:03.598Z","updated_at":"2016-06-13T22:35:03.598Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012100,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-13T22:35:03.774Z","updated_at":"2016-06-13T22:35:03.774Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}