{"id":129381,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjkzODE=","url":"https://hackerone.com/reports/129381","title":"niche s3 buckets are readable/writeable/deleteable by authorized AWS users","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-08T23:08:55.724Z","submitted_at":"2016-04-08T23:08:55.724Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-02T14:48:02.066Z","bug_reporter_agreed_on_going_public_at":"2017-03-03T14:47:50.566Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI've discovered that the AWS buckets by niche, niche-s3-production,  is accessible for authorized AWS users using the AWS command line tools.\n\n##Issue\nAs such, I have confirmed:\n- I can list all files in the bucket with the command ``` aws s3 ls s3://niche-s3-production```\n- I can copy files from the server with the command ``` aws s3 cp s3://niche-s3-production/[PATH]/[FILE] ./```\n- I can copy to the server with ```aws s3 cp test.txt s3://niche-s3-production```\n- I can remove files with ``` aws s3 rm s3://niche-s3-production/[PATH]/[FILE]```\n\nYou will see that I have left the empty file test.txt in the bucket root.\n\nThis also impacts the niche-s3-development and niche-s3-staging buckets.\n\n##Vulnerability\n- Authorized AWS users can access any content in the publics (I only tested downloading one file from the compaign_posts path because files can have their own permissions)\n- People can host and serve viruses from your buckets\n- Twitter staff may unknowingly download a virus from what they think is a trusted bucket when they think files may have been placed in specific locations by other coworkers\n\n##Remediation\nRemediation is to review, audit and update all buckets owned by niche and the access control lists so this is not available to authorized users, only via the web through an authorized account controlled by the site.\n\nPete","bounty_amount":"700.0","formatted_bounty":"$700","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-02T14:47:50.616Z","allow_singular_disclosure_after":-142814951.21113455,"singular_disclosure_allowed":true,"vote_count":38,"voters":["delimitry","ramsexy","gerben_javado","metawolf","ysx","powerjacobb1","mpz","madrobot","xyodh","eveeez","and 28 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":897470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, in my haste I realize I was unclear -- all three niche.co buckets are accessible to aws users:\n- niche-s3-production\n- niche-s3-staging\n- niche-s3-development\n\nI went back to see if there might be sensitive information disclosed as production contains a log directory, recognizing I did not want/intend to compromise the integrity of niche.co but wanted to help determine the potential severity of this.\n\nI randomly tested two or three files in the logs folder but they appear to have private access permissions so I could not download them. However, I did not attempt to sync the entire folder to my computer which would check every file.  In your review, you may also want to confirm those permissions per log file given the potential for sensitive information to be included in them.\n\nPete","automated_response":false,"created_at":"2016-04-09T15:16:53.373Z","updated_at":"2016-04-09T15:16:53.373Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902483,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-04-12T22:45:42.102Z","updated_at":"2016-04-12T22:45:42.102Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":903890,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-04-13T17:37:57.218Z","updated_at":"2016-04-13T17:37:57.218Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":904604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mfinifter\nlooks like they missed the ability for me to upload files to all three buckets - they should see text.txt in the root of each.\n\nHowever, I confirmed I can no longer remove files or list them. I also tried to list files from specific folders but didn't have permissions.\n\nEDIT\nOpps, looks like the permissions were not added fully recursively - I was able to download the following file ```s3://niche-s3-production/campaign_posts/pictures/000/000/008/original/BVVTucbCMMAAcRE1.jpg``` -- recognizing an attacker would need to know a full path to files, they still shouldn't be accessible without the request being signed.\n\nI also placed a file in the same folder --- test.txt. Sorry.","automated_response":false,"created_at":"2016-04-13T23:57:55.153Z","updated_at":"2016-04-14T00:01:15.332Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906657,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Thanks for the additional info.  I'll follow up on this.","automated_response":false,"created_at":"2016-04-14T20:10:20.061Z","updated_at":"2016-04-14T20:10:20.061Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906659,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-04-14T20:10:37.895Z","updated_at":"2016-04-14T20:10:37.895Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Np, happy to help. Let me know when to test again.","automated_response":false,"created_at":"2016-04-14T20:18:52.163Z","updated_at":"2016-04-14T20:18:52.163Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906699,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should be fixed now.  You should not be able to upload anymore.\n\nRegarding the file you were able to download, I'm told that this is intentional because this is a public asset.\n\nThanks again.","automated_response":false,"created_at":"2016-04-14T20:30:26.235Z","updated_at":"2016-04-14T20:30:26.235Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I should be able to confirm in an hour or so.\n\nWanted to flag, it's their call, but even being public, that's not the best way to handle things... If an attacker gets access, files are easily served. Anything coming out of the bucket should have a signature so they can control it. Additionally, if permissions are incorrectly applied or a file incorrectly placed, it may be unintentionally accessible.\n\nHackerone is a good example - all attachments have a signed URL, even public reports... \n\nBut as I said, your/their call.","automated_response":false,"created_at":"2016-04-14T20:37:49.895Z","updated_at":"2016-04-14T20:37:49.895Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @mfinifter,\nnope, can still write to the root of all three buckets... should be test.txt sitting in each.\n\npete","automated_response":false,"created_at":"2016-04-14T21:55:11.278Z","updated_at":"2016-04-14T21:55:11.278Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906844,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-04-14T22:02:11.539Z","updated_at":"2016-04-14T22:02:11.539Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":906845,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-04-14T22:02:20.214Z","updated_at":"2016-04-14T22:02:20.214Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908150,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-04-15T16:47:11.180Z","updated_at":"2016-04-15T16:47:11.180Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @andrewsorensen,\nlooks good. Confirmed:\n- can't write to production, staging or development root\n- can't write to production /campaign_posts/pictures/000/000/008/original or any folder in that path\n- can't download from that same path above as I could before\n\nI know niche isn't eligible for bounties by default but I'm wondering if this would be a high impact vulnerability and as such, considered?\n\nThanks!\npete","automated_response":false,"created_at":"2016-04-15T17:00:36.393Z","updated_at":"2016-04-15T17:00:51.889Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":908445,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2016-04-15T18:52:31.485Z","updated_at":"2016-04-15T18:52:31.485Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"700.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":908447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks guys. And my pleasure - I'm glad I could help!!\n\nAll the best.\npete","automated_response":false,"created_at":"2016-04-15T18:54:17.573Z","updated_at":"2016-04-15T18:54:17.573Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1517558,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Is it ok to disclose this?","automated_response":false,"created_at":"2017-03-03T14:47:50.591Z","updated_at":"2017-03-03T14:47:50.591Z","first_to_agree":true,"actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1578577,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-02T14:48:02.099Z","updated_at":"2017-04-02T14:48:02.099Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}