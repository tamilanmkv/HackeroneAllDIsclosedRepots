{"id":131202,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzEyMDI=","url":"https://hackerone.com/reports/131202","title":"[Critical] - Steal OAuth Tokens","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-15T21:03:27.349Z","submitted_at":"2016-04-15T21:03:27.349Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-11T18:03:59.776Z","bug_reporter_agreed_on_going_public_at":"2016-06-17T06:27:36.118Z","team_member_agreed_on_going_public_at":"2016-07-11T18:03:59.518Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis bug is caused because of the same mis-configuration as #128119. Only this time Microsoft Outlook auth is vulnerable instead of Facebook. this time I will try to be as clear as possible. after sign up of Twitter, Twitter asks users to import contacts (and it only requires on authorization) - or simply going to https://twitter.com/who_to_follow/import will do that.\n\nI believe you have configured your oauth redirect_uri as twitter.com in your app settings. Meaning Microsoft will accept:\n- http://twitter.com as valid\n- http://anything.twitter.com as valid\n- https://twitter.com as valid\n- https://anything.twitter.com/path/?anything as valid\n\nSo the forumla of a valid redirect_uri for twitter app is http(s?)://*.twitter.com/*\n\nOkay, so now we make an open redirect. \n\nhttps://cards.twitter.com/cards/18ce53y6aap/yyms redirects to http://test.com and qualifies to bypass http(s?)://*.twitter.com/* and we will add ```%2523``` behind it like https://cards.twitter.com/cards/18ce53y6aap/yyms%2523 for microsoft to decode and send as a Hash %2523 -\u003e %23 -\u003e # with our stolen access_token.\n\nWe can then obtain this token using ```location.hash``` and all the user had to do is a single click (if already authorized - lots of people have)\n\nTo make things more clear, here is *unlisted* YouTube video to demonstrate how this works: https://youtu.be/apwbVpa2r6Y (also attached)\n\nThanks,\nPaulos\n","bounty_amount":"840.0","formatted_bounty":"$840","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":85930,"file_name":"Twitter_Outlook_Bypass.avi","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/930/c49c6df3b8e4b95b1ba32e52cfc59bd250ba0794/Twitter_Outlook_Bypass.avi?response-content-disposition=attachment%3B%20filename%3D%22Twitter_Outlook_Bypass.avi%22%3B%20filename%2A%3DUTF-8%27%27Twitter_Outlook_Bypass.avi\u0026response-content-type=video%2Fx-msvideo\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRIN5EFBE%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133749Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIBhBo9%2BUqNxY%2Bdl%2FBu6j6mVjFeVGWlX5BwuNk30B2pI7AiBQHUUbG%2FDPlDr8hIO32FMCMyDmnYxvDdVBvosTOZwinyqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM8sXPkJOx9vMC77IEKtcDIV9fcoJlSEMqzyGBN8r5cvnWs1RDUOFGGZvMSBD3mEA7oDpMSi%2BV7Zp9cOht07PFLX%2BkJK8eC1UTkCn542dx8VJGQsKAyVMnUijrNudvAtZaz4XmN54QO8IAmSWJAz1M4dpRjKM3mpj%2FRtGlWd3KN52y5erIqbsZL2gDnrA%2FRb3fgap6IHD7xfj6d0gbxTW4t4%2FdNxTbdiUOs%2BzGzj%2FLTVG1Y2pAFSOg%2FtQWuve8SbkTy352fvT3gWDrJKVFK4FnKn4DMECasTJgeWjjC5%2FMBxmNQ4Ck1dV%2Bd2U1r3%2FXszmBUhzCVAnW%2BBtuglfqKxlek0HFP2W%2FAgf7HsdcRXu4XQ9grbRgh1ZNM9yCRee%2FQ8AoIWmoCQS%2BbBfiZfI9t95HA%2Fnu0iExODE3gc%2FeDNILImEbUu8YNyftwi4u%2BBTFJzhLm45mJqK2nq8%2F1P%2BZ%2FjDCVTu7n6SR3CDOMKZAj5KEc2HF25gj0XTKyS4MKzzEI3%2B1%2BX1BRUu%2Ft%2Foofn%2BCL69KENTohq5xEcSjfjHYy%2FruEuKnSzzB2Olo0%2Fch%2Bgu9EjjuR5sCj5hDvticB%2BiLsNWB0Sjpt4T5BO2Gz9yWZ5R7UDjFjBikyO0qI3cmEMuMQ9c4%2Bi%2BthNSEMOrskIsGOqYBSW5YtERPJhE422%2BOJ%2FODVERL3856%2BJxv6Gylf0pw9PAOnyl%2FoQCO3GPLC6BDKKKCT0DANAMHRViXtizwdYWxIVcxRRpAFRuplthRNuoekn7M%2BD9Vyq2Ves6bm56gWv49amyryPOpp3Kpzb30DAEAyzl0ZK%2BqfWyDzq5HLSIy5lGtjLObsOuLdF%2BYMEHir%2BrCGGp%2FmWPemSN9vmdtiNbqa6zyiUuPDw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=12535051a8b45e91f14fe8f604384b87d3feaf8beb976dd1c0422417cfbf998b","file_size":4265688,"type":"video/x-msvideo"}],"allow_singular_disclosure_at":"2016-07-17T06:27:56.425Z","allow_singular_disclosure_after":-165222592.90555674,"singular_disclosure_allowed":true,"vote_count":23,"voters":["wkcaj","bogdantcaciuc","zombiehelp54","try_to_hack","1337fenrir","realtess","raushanraj","dudez","supernatural","detroitsmash","and 13 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":910697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also please do note: this can be used to do serious things like read mail by modifying the scope to ```scope=https://outlook.office.com/Mail.read``` \nPoint being, a similar bug was found in Facebook by one of my friends \u0026 the bounty was ~7.5K - Here is video demonstrating the hack in Facebook: https://www.youtube.com/watch?v=Vasghvk_8p4\n","automated_response":false,"created_at":"2016-04-18T00:35:58.628Z","updated_at":"2016-04-18T00:37:55.675Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912535,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, thanks for your report. \n\nCan you please provide us with the injection what was used in your proof of concept video? This would be a create help in our evaluation of this report. \n\nThanks for thinking of Twitter security. ","automated_response":false,"created_at":"2016-04-18T17:54:13.609Z","updated_at":"2016-04-18T17:54:13.609Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913219,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@bugtriage-rob this is the URL I used: \nhttps://account.live.com/Consent/Update?ru=https://login.live.com/oauth20_authorize.srf%3flc%3d1033%26state%3dservice%253Dmsn2%2526start%253D2016-04-18%252021%253A10%253A34%2526trigger_event%253Dtrue%2526scope%3dwl.basic%2520wl.emails%2520wl.contacts_emails%26redirect_uri%3dhttps%253A%252F%252Fcards.twitter.com%252Fcards%252F18ce53y6aap%2523%252Fyyms%26client_id%3d000000004403A722%26response_type%3dcode%26contextid%3d02872644FC281255\u0026mkt=EN-US\u0026uiflavor=web\u0026id=279469\u0026client_id=000000004403A722\u0026rd=twitter.com\u0026scope=wl.basic+wl.emails+wl.contacts_emails\u0026cscope=\n\nNotice the redirect_uri is double-encoded with a %2523 following it. meaning the normal value is \nhttps://cards.twitter.com/cards/18ce53y6aap/yyms#\n\nThat said, I have removed the token and some other parameters and it seems it may only work for one user (my account), but you obviously will still see the issue and configure your redirect_uri in your app settings asap.\n\nThanks,\n","automated_response":false,"created_at":"2016-04-18T21:20:20.333Z","updated_at":"2016-04-18T21:20:20.333Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":916155,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-04-19T23:15:46.017Z","updated_at":"2016-04-19T23:15:46.017Z","actor":{"username":"arkadiyt","cleared":false,"url":"/arkadiyt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":923051,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2016-04-22T18:04:36.942Z","updated_at":"2016-04-22T18:04:36.942Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"840.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"paulos_","url":"/paulos_"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":923062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arkadiyt I am assuming you are going to revisit #82564 because that one is more severe.\n ","automated_response":false,"created_at":"2016-04-22T18:07:17.007Z","updated_at":"2016-04-22T18:07:17.007Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":923656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twitter @andrewsorensen I assume this is fixed.","automated_response":false,"created_at":"2016-04-22T22:01:21.611Z","updated_at":"2016-04-22T22:01:21.611Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":934339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twitter @andrewsorensen reply to #134754 please. tnx","automated_response":false,"created_at":"2016-04-29T22:55:32.768Z","updated_at":"2016-04-29T22:55:32.768Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":945452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twitter @andrewsorensen I kindly ask you to re-review and read my response on #134754 as it has no relation to this report and if no response is made, I will make the issue public via blog-post in Friday this time next week. please play fair and respond to messages. \n\nThanks,\nP ","automated_response":false,"created_at":"2016-05-07T20:13:51.600Z","updated_at":"2016-05-07T20:13:51.600Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":969135,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@twitter @andrewsorensen seems fixed. can you check?","automated_response":false,"created_at":"2016-05-22T22:08:01.527Z","updated_at":"2016-05-22T22:08:01.527Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":970791,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-05-23T19:51:38.187Z","updated_at":"2016-05-23T19:51:38.187Z","actor":{"username":"arkadiyt","cleared":false,"url":"/arkadiyt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"paulos_","url":"/paulos_"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":971310,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arkadiyt confirmed! :)","automated_response":false,"created_at":"2016-05-24T01:16:06.371Z","updated_at":"2016-05-24T01:16:06.371Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1018544,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-06-17T06:27:36.279Z","updated_at":"2016-06-17T06:27:36.279Z","first_to_agree":true,"actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1063516,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-11T18:03:59.580Z","updated_at":"2016-07-11T18:03:59.580Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1063517,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-11T18:03:59.801Z","updated_at":"2016-07-11T18:03:59.801Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}