{"id":141541,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDE1NDE=","url":"https://hackerone.com/reports/141541","title":"User with no permissions can access full wdcalendar feed","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-27T20:13:45.187Z","submitted_at":"2016-05-27T20:13:45.187Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1492,"url":"https://hackerone.com/drchrono","handle":"drchrono","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"drchrono","twitter_handle":"drchrono","website":"https://www.drchrono.com","about":"EHR, Practice Management, Medical Billing \u0026 Revenue Cycle Management available on iPad, iPhone, web ... and a healthcare API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-25T16:02:11.700Z","bug_reporter_agreed_on_going_public_at":"2016-10-26T16:02:11.193Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI've found a vulnerability related to access the calendar when a user has no permissions.\n\n##Vulnerability\nI've create a doctor's account with a user who has no permission. Browsing the site, I noticed a call to ```https://1337test.drchrono.com/wdcalendar/datafeed/105756?method=list\u0026showdate=5%2F27%2F2016\u0026viewtype=examroom\u0026timezone=0\u0026doctors[]=99120```\n\nUsing this URL via the account with no permissions appears to return the full calendar feed (I've trimmed it for this report):\n\n{\"templates\": [], \"start\": \"05/27/2016 00:00\", \"end\": \"05/28/2016 00:00\", \"events\": [[\"30273638\", \"Daniel Kivatinos: Exam 4\", \"05/27/2016 09:00\", \"05/27/2016 09:45\", \"0\", \"0\", \"0\", \"2\", \"4\", \"#BFBFFF\", {\"provider_id\": 99120, \"secondary_insurer\": \" \", \"primary_insurer\": \" \", \"billing_status\": \"\", \"duration\": 45, \"appt_is_break\": false, \"scheduled_time\": \"09:00 AM\", \"appointment_status\": \"\", \"patient_name\": \"Daniel Kivatinos\", \"chartid\": \"KIDA000005\", \"provider\": \"[ [ 5*5 ] ] [ [ 5*5 ] ]\", \"patient_id_for_photo\": 59493758, \"exam_room_name\": \"Exam 4\", \"real_examroom\": 4, \"view_id\": \"30273638\", \"display_examroom\": 4, \"reason\": \"General Visit\", \"birthday\": \"03/20/1980\", \"date\": \"Friday May 27\", \"referring_doctor\": \"\", \"patient_phone\": \"\", \"office_name\": \"[ [ 5*5 ] ]\", \"copay\": \"No copay information on file\", \"patient_provider\": \"[ [ 5*5 ] ] [ [ 5*5 ] ]\", \"gender\": \"Male\", \"age\": \"36\", \"readable_datetime\": \"Fri May 27 at 09:00 AM\", \"office_id\": 105756, \"billing_status_disabled\": false, \"created_at_utc\": \"2016-05-25T20:21:28+00:00\", \"notes\": \"\"}, 99120, \"\"], \n\n##Steps to reproduce\n1. Create a doctor's account\n2. Add a staff member with no permissions\n3. If you have access to a proxy like burp, use it and visit the calendar\n4. Log out and log in as the staff member\n5. Open the proxy and grab the wdcalendar feed url\n6. Paste it in the browser\n\nYou now have access to the calendar data\n\n##Vulnerability\nThis seems to be a pretty significant information disclosure vulnerability. Each patient's billing information is available, some personal information (gener, age, phone, etc), appointment notes, etc. All appointments appear available as well.\n\nPlease let me know if you have any questions.\nPete","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-25T16:02:11.454Z","allow_singular_disclosure_after":-153869935.10160032,"singular_disclosure_allowed":true,"vote_count":5,"voters":["vijay_kumar","dpgribkov","secdoor","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":990913,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi All,\nsorry - looks like most, if not all, wdcalendar endpoints don't have permissions. I also found:\n\n- ```https://1337test.drchrono.com/wdcalendar/photo/59493766``` which returns:\n{\"url\": \"https://645953a9c2c98894ea6d-615e987a2b08362dcf1e6ff810ff03b3.ssl.cf5.rackcdn.com/CACHE/images/patient_photos/5d18eb8c-5a01-4421-ac6f-66ebc42b124d/2234b1dfca9b0d9b531b0264648df712.jpg\", \"patient_id\": 59493766}\n\n- ```https://1337test.drchrono.com/wdcalendar/previous-appointment/30273668/``` which returns:\n{\"scheduled_time\": \"2016/05/29 16:45\", \"doctor_name\": \"[ [ 5*5 ] ] [ [ 5*5 ] ]\", \"patient_name\": \"Jenny Harris\", \"duration\": 45, \"doctor_id\": 99120, \"patient_id\": 59493766, \"id\": \"30273680\"}\n\nPete","automated_response":false,"created_at":"2016-05-30T14:16:57.148Z","updated_at":"2016-05-30T14:16:57.148Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993632,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-05-31T20:31:59.965Z","updated_at":"2016-05-31T20:31:59.965Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994227,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"There's actually no permission that protects all patient/appointment data. There are permissions preventing editing such data, but any staff member can see their doctor's patients' data.","automated_response":false,"created_at":"2016-06-01T02:06:06.690Z","updated_at":"2016-06-01T02:06:06.690Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kgarcia,\nI don't follow this at all. Using the account in question, with no permissions, I have no access to the calendar and receive the notice that I do not have permission to access this page. However, using that endpoint, I am able to get the information I'm told I don't have permission to access?\n\nHow can it be informative that via one url I'm told \"You do not have permission to access this page\" yet I can get that exact data via the the data feed?","automated_response":false,"created_at":"2016-06-01T02:20:46.772Z","updated_at":"2016-06-01T02:20:46.772Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994245,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see an explicit permission regarding \"viewing\" patient appointments:\n\nAccess Scheduling - Allow the user to **view**, add, and edit patient appointments and other scheduling features\n","automated_response":false,"created_at":"2016-06-01T02:27:52.295Z","updated_at":"2016-06-01T02:27:52.295Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995354,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"You're correct, my mistake.\n","automated_response":false,"created_at":"2016-06-01T18:50:01.854Z","updated_at":"2016-06-01T18:50:01.854Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":995355,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","automated_response":false,"created_at":"2016-06-01T18:50:35.181Z","updated_at":"2016-06-01T18:50:35.181Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":997526,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-06-02T23:14:52.443Z","updated_at":"2016-06-02T23:14:52.443Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1001899,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-06-06T21:17:38.190Z","updated_at":"2016-06-06T21:17:38.190Z","actor":{"url":"/drchrono","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"drchrono"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"drchrono","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1001900,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-06-06T21:17:46.871Z","updated_at":"2016-06-06T21:17:46.871Z","actor":{"username":"kgarcia","cleared":false,"url":"/kgarcia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268887,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-10-26T16:02:11.217Z","updated_at":"2016-10-26T16:02:11.217Z","first_to_agree":true,"actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1319252,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-11-25T16:02:11.739Z","updated_at":"2016-11-25T16:02:11.739Z","actor":{"url":"/drchrono","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/492/22504e1f134263ff85b7870959fa127edcd98bd0_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"drchrono"}},"genius_execution_id":null,"team_handle":"drchrono","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}