{"id":19640,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY0MA==","url":"https://hackerone.com/reports/19640","title":"Session Hijacking attack (Different Scenario)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-07-10T06:00:49.279Z","submitted_at":"2014-07-10T06:00:49.279Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shahmeer-amir","url":"/shahmeer-amir","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-17T22:35:24.956Z","bug_reporter_agreed_on_going_public_at":"2014-07-10T19:38:49.361Z","team_member_agreed_on_going_public_at":"2014-07-17T22:35:24.576Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey \r\nI was able to replay a cookie of a current active session and hijack that by replaying the cookie. Now this is different from any conventional vanilla session hijacking because it works even when the user is not logged in. But the condition is that the victim's session must be active at the time of replay\r\n1. Capture a cookie from one account using tamper data just note that you learn the Referer and X-XHR-Referer values\r\n\r\n2. Open a new windows click on the same link without logging in. For example in the victim account i clicked on \"bugs\" so here in order to replay the cookie i have to click on bugs again. Replay the X-XHR value with the other one. Replay the session cookie and you are in. You hacked the account.\r\n\r\nI hope this impresses you because i have been trying hard to get you guys impressed. Although i have managed to do with the other ones :)\r\nWaiting for your reply","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-09T19:38:49.570Z","allow_singular_disclosure_after":-226347636.34729087,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sw33tlie","ronygigi","spetr0x","dyabla","osama-amin"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":86945,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just found out that this can be done even when the X-XHR-Referer values are not same.","automated_response":false,"created_at":"2014-07-10T06:03:57.086Z","updated_at":"2014-07-10T06:03:57.086Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87116,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"This looks a theoretical issue at first glance. Did you find a way to actually intercept an HTTP header? Everything on www.hackerone.com is served over HTTPS. Thanks!","automated_response":false,"created_at":"2014-07-10T15:24:01.267Z","updated_at":"2014-07-10T15:24:01.267Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87118,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I would have to disagree this is not a theoretical scenario. I know everything is served over HTTPS but an attacker capturing a session cookie during the victim is logged in. It would be of no use if the attacker could replay the cookies if he was also logged in. But he can replay and gain access to the session by replaying the cookie externally from the application. I intercepted my requests using tamper data and replayed the cookies. Were you able to reproduce my steps?","automated_response":false,"created_at":"2014-07-10T15:28:04.627Z","updated_at":"2014-07-10T15:28:04.627Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87166,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Yes, but that's intended behaviour. How would an attacker get the victim's session cookie?","automated_response":false,"created_at":"2014-07-10T17:29:00.523Z","updated_at":"2014-07-10T17:29:00.523Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87173,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Well that should not intended behavior. Not making a standard or anything but most of the session hijacking reports that are accepted and disclosed do not emphasize on cookie stealing part. An attacker having network access could get the cookies of the victim but the attacker gaining access to the session because of the cookies replay inspite of not being logged in is the main game here.  Binding sessions to browsers is the best way to prevent this issue. I hope i am clear enough to explain the severity here","automated_response":false,"created_at":"2014-07-10T17:39:04.241Z","updated_at":"2014-07-10T17:39:04.241Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87224,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"But if you have the power of network access, why would you go after cookies or session tokens? So much more interesting data to go after. Tying the session to a browser doesn't make much sense to protect against this scenario though. The attacker has network access anyway, so he can just spoof an identical browser fingerprint and obtain access to the same session. Almost anything is defeated when an attacker has access to decrypted network traffic. That is why we make it extremely hard to get access to someone's network traffic (in a decrypted form).\n\nWhile I agree that tying sessions to browsers (like Google and Facebook do) increases security somewhat, it is still a best practice to have, but not a security vulnerability if you don't have it. It is a best practice we intentionally decided not to implement at this time. I'm certain that we will add more robust session management further down the road, but it is not something we can focus on right now.\n\nThank you.","automated_response":false,"created_at":"2014-07-10T19:12:25.758Z","updated_at":"2014-07-10T19:13:04.260Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Forget the network access. Just tell me you are on HTTPS cookies cannot be stolen because there is no XSS. There were two reports on session hijacking just capture cookies and replay. You fixed those did you not. Despite in the real world scenario there was no way an attacker could have gotten the cookies. But all the reports coming to you now will be best practices because there is little chance of any exploitation.\n https://hackerone.com/reports/737\nSee the report. I am not quoting or anything but there is 0 % chance of it's exploitability. All i am saying that there is potential risk in there. Your best point of focus should be protection of the user's information and data. Reports like these are best practices that ensure better protection. Security is at strong as it's weak link. And this here is a weak link. Rethink this if you may","automated_response":false,"created_at":"2014-07-10T19:21:24.768Z","updated_at":"2014-07-10T19:21:24.768Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We fixed the #737 because it was a replay attack that was replaying a session that should've been ended already. I agree that it's hard to obtain a cookie, but with #737 it would've worked forever. That is not the case with what you are reporting here. If the user sign out or his session expires, you can not lift on the same session anymore (due to the fix we implemented for #737 :). The fact that this was possible with #737 made us fix it right away.\n\n\u003e But all the reports coming to you now will be best practices because there is little chance of any exploitation.\n\nWe're happy to receive those, but many of them we already know about. Tying sessions to browser fingerprints/IP geolocations is not something that hasn't crossed our minds before. There were many researchers before you who reported the same scenario. We still consider it a won't fix and I'm certain we'll be implementing this further down the road, but just not now. It's not an imminent threat, so we won't treat it that way.","automated_response":false,"created_at":"2014-07-10T19:25:56.696Z","updated_at":"2014-07-10T19:26:38.699Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, before referring to other public reports and comparing them, I'd advise you to read carefully what was reported in that other report. Don't make conclusions too fast. For instance in #737, this is the catch that made us patch it asap:\n\n\u003e the user receives a new session cookie, which is not authenticated at this point. However, the authenticated session cookie used by a user before logging out is still active.","automated_response":false,"created_at":"2014-07-10T19:29:47.397Z","updated_at":"2014-07-10T19:30:07.638Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I told you before saying that i am making anything a standard. Even if the user does logout of the session. The other end of the captured cookies will still remain intact with the session. Meaning that an attacker could take that session for as long as he wants. This is also a replay attack but the only condition is that the user should remain logged in when the replay is made. This is just another form of session hijacking that i thought might be creative to report to you. Although i really thought this would impress you guys. And again i am not making reports as a standard. It's just really weird to see that some reports scanned with automated scanners are accepted and the creative ones are ignored. ","automated_response":false,"created_at":"2014-07-10T19:38:04.679Z","updated_at":"2014-07-10T19:38:04.679Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-07-10T19:38:49.376Z","updated_at":"2014-07-10T19:38:49.376Z","first_to_agree":true,"actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87240,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I told you before saying that i am making anything a standard.\n\nYou are free to do that :), but we consider this not a serious threat but a best practice that we'll eventually build.\n\n\u003e This is also a replay attack but the only condition is that the user should remain logged in when the replay is made. \n\nYup, and that small caveat (*the user has to remain logged in*) made us prioritize this much lower than #737 and finally led to the decision for won't fix. I hope you can understand this. We have to prioritize between building features that make the product better and fix potential security issues. This highly hypothetical report didn't make the cut for fixing right away.\n","automated_response":false,"created_at":"2014-07-10T19:45:17.855Z","updated_at":"2014-07-10T19:46:45.847Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not much low. But you can consider this as low. But Won't fix hurts :)\nHurts bad. That was as creative as i could get in session attacks. I understand because there is no other way i can convince you","automated_response":false,"created_at":"2014-07-10T19:48:26.579Z","updated_at":"2014-07-10T19:48:26.579Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Why does won't fix hurt? It's up to us to prioritize what we want to fix right away and what we want to address later. Won't fix does not mean you found something that was incorrect or not a security vulnerability -- I would've closed it as N/A otherwise. You found something valid, but just not high priority enough to fix. \n\nWon't fix also doesn't mean we will never address this. We will in the future. But then again, improved session management (overview of active sessions, tie to browser fingerprints, kill individual sessions) is something that has been on our roadmap for a while and many researchers have reported similar things. In my opinion, this is much more a low hanging fruit report than a highly creative bug :). We get this stuff a lot.","automated_response":false,"created_at":"2014-07-10T19:52:46.731Z","updated_at":"2014-07-10T19:52:46.731Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":87254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That topic is debatable but i do not want to carry on because i know its gonna take an extra gigabyte on your server to do this. :)\nWhat i meant was that if a report is marked as Won't fix it means that the report is valid and also with sprinkles of invalid on it. Which eventually marks it as invalid so it's like it went in vain. Well nice debating with you.","automated_response":false,"created_at":"2014-07-10T20:02:45.943Z","updated_at":"2014-07-10T20:02:45.943Z","actor":{"username":"shahmeer-amir","cleared":false,"url":"/shahmeer-amir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/590/76b985f4674f1b538145a09c06dc63d374e8d16e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":90758,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-07-17T22:35:24.591Z","updated_at":"2014-07-17T22:35:24.591Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":90759,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-07-17T22:35:24.969Z","updated_at":"2014-07-17T22:35:24.969Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}