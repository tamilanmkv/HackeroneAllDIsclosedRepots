{"id":202501,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDI1MDE=","url":"https://hackerone.com/reports/202501","title":"Restricted user is able to delete filter sets of admin users in https://infrastructure.newrelic.com/accounts/{{ACC#}}/settings/filterSets","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-02-01T01:01:45.812Z","submitted_at":"2017-02-01T01:01:45.812Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-24T15:07:46.232Z","bug_reporter_agreed_on_going_public_at":"2020-08-20T02:50:22.786Z","team_member_agreed_on_going_public_at":"2020-08-24T15:07:46.141Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"At this endpoint: `https://infrastructure.newrelic.com/accounts/████/settings/filterSets` the application does not properly check to ensure that a user with restricted settings is able to delete filters of other users, including a filter of an admin. \n\n## Step by step instructions\n\n1. Admin creates a New Relic account, invites User1 as a restricted user to join the team\n2. The admin creates a filter by navigating to Infrastructure \u003e Inventory \u003e Add Filter (`https://infrastructure.newrelic.com/accounts/███████/inventory`)\n3. User2 joins the team, then clicks on \"Infrastructure\" tab\n4. User2 clicks on \"Settings\", within Infrastructure. \n5. At this URL, User2 can click on the trash can icon next to the filter that the admin made, and then refresh the page. \n6. The admin's filter is deleted\n\nThe application on this page believes that the restricted user has an elevated privilege on this page, when in reality User2 is still a restricted user and should only have view-only settings. \n\nPlease let me know if you have any additional questions, thanks.\n\nJon Bottarini ","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-09-19T02:50:22.836Z","allow_singular_disclosure_after":-33477079.315333135,"singular_disclosure_allowed":true,"vote_count":3,"voters":["wi11","faizannehal","iamcoolcat"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1455460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Correction in step by step instructions: \"User1\" is a typo, it should say: \"User2\". ","automated_response":false,"created_at":"2017-02-01T03:13:12.527Z","updated_at":"2017-02-01T03:13:12.527Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456739,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-02-01T18:10:58.757Z","updated_at":"2017-02-01T18:10:58.757Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1456752,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @jon_bottarini,\n\nThanks for submitting this issue. We've confirmed this on our end and are working with the engineering team involved. We've also determined that this is eligible for a bounty!\n\nNote that the Restricted Users defects are related; please feel free to submit additional issues you find in that same vein, but they will not be eligible for an additional bounty.\n\nThanks again for working with us to help keep New Relic secure!","automated_response":false,"created_at":"2017-02-01T18:18:45.840Z","updated_at":"2017-02-01T18:18:45.840Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1456813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dmcmahon  - \n\nWhen you state: Restricted Users defects are related - do you mean *all* the Restricted User defects are related, or just the two I had reported?\n\nThank you very much for the bounty and quick payout! Much appreciated! ","automated_response":false,"created_at":"2017-02-01T18:39:23.170Z","updated_at":"2017-02-01T18:39:23.170Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1456844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jon_bottarini,\n\nCurrently, we're improving the logic around authorizing actions by Restricted Users. Once that is resolved, *all* of these issues should go away as that logic is used across the application.","automated_response":false,"created_at":"2017-02-01T18:49:23.280Z","updated_at":"2017-02-01T18:49:23.280Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1456848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dmcmahon Understood, thank you for the clarification. If you could please let me know once that application logic has been implemented and you believe the Restricted User issues are resolved, I would love to try and break it again :) \n\nCheers, \n\nJon ","automated_response":false,"created_at":"2017-02-01T18:50:49.146Z","updated_at":"2017-02-01T18:50:49.146Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1750117,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @jon_bottarini,\n\nWe believe this issue to be fixed.\n\nPlease let us know if you have confirmed on your end that this issue is corrected, and we can mark this as Resolved.","automated_response":false,"created_at":"2017-06-12T17:43:47.461Z","updated_at":"2017-06-12T17:43:47.461Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1766971,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello, this is still not resolved. A restricted user is still able to delete filter sets created by administrators without issue following the steps I outlined above. Let me know if this is still in the pipeline to be fixed, thanks! \n\n","automated_response":false,"created_at":"2017-06-19T23:03:51.541Z","updated_at":"2017-06-19T23:03:51.541Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766999,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @jon_bottarini,\n\nThanks for confirming that you're still able to replicate this issue.\n\nAs with your other report, the root cause here has been fixed, but the fix is not yet live in Production. As soon as that change makes it live, I will reach out again.\n\nOnce again, thanks for your report and your help with keeping New Relic secure.","automated_response":false,"created_at":"2017-06-19T23:16:09.837Z","updated_at":"2017-06-19T23:16:09.837Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1792485,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dmcmahon - Just wanted to follow up with you and see if this has been pushed to prod. Thanks! ","automated_response":false,"created_at":"2017-06-29T20:35:18.785Z","updated_at":"2017-06-29T20:35:18.785Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1800401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jon_bottarini,\n\nThanks for reaching out.\n\nAs of right now, this change is in testing. This is part of a much larger operational change, but I will update as soon as they take it live.","automated_response":false,"created_at":"2017-07-03T20:45:29.345Z","updated_at":"2017-07-03T20:45:29.345Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1883717,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jon_bottarini,\n\nThis change is now active and you should no longer be able to reproduce this issue. I'll finally close this issue, but please reach out again if you see anything else.\n\nOnce again, thank you for your help in keeping New Relic and our customers secure!","automated_response":false,"created_at":"2017-08-01T21:27:53.078Z","updated_at":"2017-08-01T21:27:53.078Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8984372,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-20T02:50:22.810Z","updated_at":"2020-08-20T02:50:22.810Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9024668,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-24T15:07:46.165Z","updated_at":"2020-08-24T15:07:46.165Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9024669,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-24T15:07:46.256Z","updated_at":"2020-08-24T15:07:46.256Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}