{"id":209008,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDkwMDg=","url":"https://hackerone.com/reports/209008","title":"Authentication Bypass - Chaining two vulnerabilities leads to account takeover at en.instagram-brand.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-02-26T02:41:50.008Z","submitted_at":"2017-02-26T02:41:50.008Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dermeister","url":"/dermeister","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-22T14:12:38.392Z","bug_reporter_agreed_on_going_public_at":"2019-05-23T14:12:37.712Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Product / URL**\nhttps://en.instagram-brand.com/wp-json/brc/v1/login/\n\n**Description and Impact**\nAn attacker can perform account takeover by leveraging following two vulnerabilities:\n\nAuth Bypass = Username Enumeration + Login Brute Force\n\n\n\nA. Username Enumeration:\n-------------------------------\n\nFor the site https://en.instagram-brand.com/, it is made sure that a malicious user cannot enumerate usernames of the users by implementing CAPTCHAs at Sign Up (https://en.instagram-brand.com/register/signup) and Forgot Password (https://en.instagram-brand.com/register/signin) pages.\nThis is made the site secure.\nBut I have found a way to bypass this protection. The endpoint: https://en.instagram-brand.com/wp-json/brc/v1/resend-verify has absolutely no rate limiting, thus a malicious user can take its advantage to enumerate usernames.\n\n**Another thing of concern is that, if a valid username is found, then the Instagram site sends an account verification link to that email. Even if the account is previously verified !! And if those victims try to login, then they can't. The site asks to first verify their account by clicking on the account activation links !!**\n\nAn attacker can harvest the usernames and abuse this functionality to bother the victims.\n\n**Following is the analysis:**\n1) The endpoint to which the actual request goes - https://en.instagram-brand.com/wp-json/brc/v1/resend-verify\n2) The total number of requests/attempts you were able to make - 1001 (you can do it infinite)\n3) The time in which you made those requests/attempts - 10 minutes\n4) Some demonstration that you weren't actually just silently locked out -Refer the attached exploit.\n\n**Exploit Developed:**\n1. Save the files email.txt and InstagramBrandEnumerationExploit.rb in a folder.\n2. Run the exploit like this: ruby InstagramBrandEnumerationExploit.rb\n3. Observe in the console that the right emails are disclosed within seconds.\n\n\n**Reproduction Instructions / Proof of Concept**\n1. Sign Up using any email address.\n2. Attach a local intercepting proxy.\n3. After signing up, a resend email button will appear.\n4. Click on it and intercept the request.\n5. For the parameter, 'email' in the request body, put your payloads i.e. email addresses to need to be enumerated.\n6. Send the request.\n7. Observe the response. It is verbose and states clearly if the user exists or not.\n8. Now try to login using any of the victim's email.\n9. Observe that the web app does not let you login.\n\n**The HTTP Request is:**\n\n`POST /wp-json/brc/v1/resend-verify HTTP/1.1\nHost: en.instagram-brand.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-WP-Nonce: 30436dbdab\nContent-Type: application/x-www-form-urlencoded\nReferer: https://en.instagram-brand.com/register/signup\nContent-Length: 29\nCookie: pll_language=en; _ga=GA1.2.2112289023.1486871994; _gat=1\nConnection: keep-alive`\n\n`email=\u003cyour email here\u003e`\n\n\n\n\nB. Login Brute Force\n-----------------------\n\nThe endpoint https://en.instagram-brand.com/wp-json/brc/v1/login/ does not have any rate limiting. This still allows an attacker to make the following number of guesses from one single system single threaded : 100 per min, 6,000 per hour, 1,44,000 per day or 43,20,000/month. No additional protection mechanism such as Captcha (pre-auth) or account lockout requiring additional email/phone verification (pre- or post-auth) were identified at any time. I could make 1020 attempts in 10 minutes.\n\n**Solution:**\nImplement a Captcha after a reasonable number of failed login attempts against one account at the application-layer. The Captcha should not only be shown to offending IP addresses, but to anyone who attempts to login to the account under attack. Another option is to enable an account lockout policy which effectively locks down an account that has been attacked (e.g. after 20 failed consecutive logins) and requires out-of-band validation by the real account owner (e.g. email, mobile) before becoming accessible again.\n\n\n**Reproduction Instructions / Proof of Concept**\nI have developed an exploit in Ruby to demonstrate this attack. \nIts usage:\n1. Save the InstagramBrandLoginBruteForce.rb in any folder.\n2. Have a long list of passwords in passlist.txt file and keep it in the same folder.\n3. On line number 7, enter the name of the victim's email who you want to target. This can also come from username enumeration list fetched from the exploit InstagramBrandEnumerationExploit.rb\n4. Using cmd, navigate to that folder and run it like this: ruby InstagramBrandLoginBruteForce.rb\n5. Observe the results.\n\n\n**Additional Note:**\nI have used single threading for these attacks, but these can be more powerful if multi threading is used.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eProduct / URL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://en.instagram-brand.com/wp-json/brc/v1/login/\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fwp-json%2Fbrc%2Fv1%2Flogin%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/wp-json/brc/v1/login/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription and Impact\u003c/strong\u003e\u003cbr\u003e\nAn attacker can perform account takeover by leveraging following two vulnerabilities:\u003c/p\u003e\n\n\u003cp\u003eAuth Bypass = Username Enumeration + Login Brute Force\u003c/p\u003e\n\n\u003ch2 id=\"a-username-enumeration\"\u003eA. Username Enumeration:\u003c/h2\u003e\n\n\u003cp\u003eFor the site \u003ca title=\"https://en.instagram-brand.com/\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, it is made sure that a malicious user cannot enumerate usernames of the users by implementing CAPTCHAs at Sign Up (\u003ca title=\"https://en.instagram-brand.com/register/signup\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fregister%2Fsignup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/register/signup\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and Forgot Password (\u003ca title=\"https://en.instagram-brand.com/register/signin\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fregister%2Fsignin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/register/signin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) pages.\u003cbr\u003e\nThis is made the site secure.\u003cbr\u003e\nBut I have found a way to bypass this protection. The endpoint: \u003ca title=\"https://en.instagram-brand.com/wp-json/brc/v1/resend-verify\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fwp-json%2Fbrc%2Fv1%2Fresend-verify\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/wp-json/brc/v1/resend-verify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has absolutely no rate limiting, thus a malicious user can take its advantage to enumerate usernames.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAnother thing of concern is that, if a valid username is found, then the Instagram site sends an account verification link to that email. Even if the account is previously verified !! And if those victims try to login, then they can\u0026#39;t. The site asks to first verify their account by clicking on the account activation links !!\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAn attacker can harvest the usernames and abuse this functionality to bother the victims.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFollowing is the analysis:\u003c/strong\u003e\u003cbr\u003e\n1) The endpoint to which the actual request goes - \u003ca title=\"https://en.instagram-brand.com/wp-json/brc/v1/resend-verify\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fwp-json%2Fbrc%2Fv1%2Fresend-verify\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/wp-json/brc/v1/resend-verify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) The total number of requests/attempts you were able to make - 1001 (you can do it infinite)\u003cbr\u003e\n3) The time in which you made those requests/attempts - 10 minutes\u003cbr\u003e\n4) Some demonstration that you weren\u0026#39;t actually just silently locked out -Refer the attached exploit.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eExploit Developed:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSave the files email.txt and InstagramBrandEnumerationExploit.rb in a folder.\u003c/li\u003e\n\u003cli\u003eRun the exploit like this: ruby InstagramBrandEnumerationExploit.rb\u003c/li\u003e\n\u003cli\u003eObserve in the console that the right emails are disclosed within seconds.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction Instructions / Proof of Concept\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSign Up using any email address.\u003c/li\u003e\n\u003cli\u003eAttach a local intercepting proxy.\u003c/li\u003e\n\u003cli\u003eAfter signing up, a resend email button will appear.\u003c/li\u003e\n\u003cli\u003eClick on it and intercept the request.\u003c/li\u003e\n\u003cli\u003eFor the parameter, \u0026#39;email\u0026#39; in the request body, put your payloads i.e. email addresses to need to be enumerated.\u003c/li\u003e\n\u003cli\u003eSend the request.\u003c/li\u003e\n\u003cli\u003eObserve the response. It is verbose and states clearly if the user exists or not.\u003c/li\u003e\n\u003cli\u003eNow try to login using any of the victim\u0026#39;s email.\u003c/li\u003e\n\u003cli\u003eObserve that the web app does not let you login.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eThe HTTP Request is:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ePOST /wp-json/brc/v1/resend-verify HTTP/1.1\u003cbr\u003e\nHost: en.instagram-brand.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\u003cbr\u003e\nAccept: */*\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nX-WP-Nonce: 30436dbdab\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nReferer: https://en.instagram-brand.com/register/signup\u003cbr\u003e\nContent-Length: 29\u003cbr\u003e\nCookie: pll_language=en; _ga=GA1.2.2112289023.1486871994; _gat=1\u003cbr\u003e\nConnection: keep-alive\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eemail=\u0026lt;your email here\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"b-login-brute-force\"\u003eB. Login Brute Force\u003c/h2\u003e\n\n\u003cp\u003eThe endpoint \u003ca title=\"https://en.instagram-brand.com/wp-json/brc/v1/login/\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fwp-json%2Fbrc%2Fv1%2Flogin%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/wp-json/brc/v1/login/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e does not have any rate limiting. This still allows an attacker to make the following number of guesses from one single system single threaded : 100 per min, 6,000 per hour, 1,44,000 per day or 43,20,000/month. No additional protection mechanism such as Captcha (pre-auth) or account lockout requiring additional email/phone verification (pre- or post-auth) were identified at any time. I could make 1020 attempts in 10 minutes.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSolution:\u003c/strong\u003e\u003cbr\u003e\nImplement a Captcha after a reasonable number of failed login attempts against one account at the application-layer. The Captcha should not only be shown to offending IP addresses, but to anyone who attempts to login to the account under attack. Another option is to enable an account lockout policy which effectively locks down an account that has been attacked (e.g. after 20 failed consecutive logins) and requires out-of-band validation by the real account owner (e.g. email, mobile) before becoming accessible again.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction Instructions / Proof of Concept\u003c/strong\u003e\u003cbr\u003e\nI have developed an exploit in Ruby to demonstrate this attack. \u003cbr\u003e\nIts usage:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSave the InstagramBrandLoginBruteForce.rb in any folder.\u003c/li\u003e\n\u003cli\u003eHave a long list of passwords in passlist.txt file and keep it in the same folder.\u003c/li\u003e\n\u003cli\u003eOn line number 7, enter the name of the victim\u0026#39;s email who you want to target. This can also come from username enumeration list fetched from the exploit InstagramBrandEnumerationExploit.rb\u003c/li\u003e\n\u003cli\u003eUsing cmd, navigate to that folder and run it like this: ruby InstagramBrandLoginBruteForce.rb\u003c/li\u003e\n\u003cli\u003eObserve the results.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eAdditional Note:\u003c/strong\u003e\u003cbr\u003e\nI have used single threading for these attacks, but these can be more powerful if multi threading is used.\u003c/p\u003e\n","bounty_amount":"175.0","formatted_bounty":"$175","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":164169,"file_name":"emails.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/164/169/a8a0218626004f41642c65e317726684c8cc35dd/emails.txt?response-content-disposition=attachment%3B%20filename%3D%22emails.txt%22%3B%20filename%2A%3DUTF-8%27%27emails.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=c39ae4f7f538663dacf2d33d6b6e505d0d160a67feb6297b79ee310c30568c9d","file_size":248,"type":"text/plain"},{"id":164170,"file_name":"InstagramBrandBruteForceResults1.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/164/170/839265f3c3f9c20cf3256354515c9bd1cc8f0d12/InstagramBrandBruteForceResults1.PNG?response-content-disposition=attachment%3B%20filename%3D%22InstagramBrandBruteForceResults1.PNG%22%3B%20filename%2A%3DUTF-8%27%27InstagramBrandBruteForceResults1.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=abea79cef77ea50fb7a5c86ef25625dd4ea03bcc4d8405f8c977721a4b41e504","file_size":20849,"type":"image/png"},{"id":164171,"file_name":"InstagramBrandLoginBruteForce.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/164/171/b45274cfcb3fa4640db090c5ae57ac692298f928/InstagramBrandLoginBruteForce.rb?response-content-disposition=attachment%3B%20filename%3D%22InstagramBrandLoginBruteForce.rb%22%3B%20filename%2A%3DUTF-8%27%27InstagramBrandLoginBruteForce.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=2372dc0d3e62032e5c9a4bb2a9fa7d6b22d0cb8edb8d4ece7797d822fd9df774","file_size":1781,"type":"text/plain"},{"id":164172,"file_name":"InstagramBrandEnumerationExploit.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/164/172/b684eaefabe5e10793782a5b2c002b4301d5b03a/InstagramBrandEnumerationExploit.rb?response-content-disposition=attachment%3B%20filename%3D%22InstagramBrandEnumerationExploit.rb%22%3B%20filename%2A%3DUTF-8%27%27InstagramBrandEnumerationExploit.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=643bf27d27a8054fed3db3b3a83b97f4837b99278f6871ba75de97bd9dc7c8ac","file_size":1878,"type":"text/plain"},{"id":164173,"file_name":"InstagramBrandUsernameEnumeration.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/164/173/60f2a5c0b90acd848cf40012dcfc28fc4b1c4225/InstagramBrandUsernameEnumeration.png?response-content-disposition=attachment%3B%20filename%3D%22InstagramBrandUsernameEnumeration.png%22%3B%20filename%2A%3DUTF-8%27%27InstagramBrandUsernameEnumeration.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=fdf51c4d655fea4bb90f6025254055c1c6c461d41d240653798f15396f54112b","file_size":142500,"type":"image/png"}],"allow_singular_disclosure_at":"2019-06-22T14:12:37.808Z","allow_singular_disclosure_after":-48005010.232471645,"singular_disclosure_allowed":true,"vote_count":25,"voters":["base_64","mygf","nessun00x","indianaussieguy","tems","ddpanku1","cryptographer","spetr0x","clarckowen_","th3r4id","and 15 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1511901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report - we'll take a look into this, but in general we do not consider username enumeration or brute force attacks of this nature (43,20,000/month barely makes a dent in the searchable space of an 8 character password) to be vulnerabilities.","markdown_message":"\u003cp\u003eThanks for the report - we\u0026#39;ll take a look into this, but in general we do not consider username enumeration or brute force attacks of this nature (43,20,000/month barely makes a dent in the searchable space of an 8 character password) to be vulnerabilities.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-28T20:24:49.959Z","updated_at":"2017-02-28T20:24:49.959Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1512164,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-28T22:26:29.724Z","updated_at":"2017-02-28T22:26:29.724Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1514811,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Friends,\n\nI would like to mention 2 points that **raises the severity** of this issue:\n\n1. Although in the exploit and in the report, I have written that an attacker can do 43,20,000/month. But that is when single thread program is used. If **multi-threads** are used then this attack can be **more powerful**. The intruder feature of burp makes up-to 99 threads and this increases the boundaries of the damage.\n2. If the attacker knows the email of a victim. Say abc@pqr.com. He can completely DOS that user. This is by using that end point to send password reset emails to that user. Even if the victim ignores this and tries to login, the application treats the user as a new user and does not let that user to login and ask him/her to first click on the password reset link. **Thus, an attacker can frustrate a particular user by doing this using the automated exploit.**\n\nRegards,\nDerMeister","markdown_message":"\u003cp\u003eHi Friends,\u003c/p\u003e\n\n\u003cp\u003eI would like to mention 2 points that \u003cstrong\u003eraises the severity\u003c/strong\u003e of this issue:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAlthough in the exploit and in the report, I have written that an attacker can do 43,20,000/month. But that is when single thread program is used. If \u003cstrong\u003emulti-threads\u003c/strong\u003e are used then this attack can be \u003cstrong\u003emore powerful\u003c/strong\u003e. The intruder feature of burp makes up-to 99 threads and this increases the boundaries of the damage.\u003c/li\u003e\n\u003cli\u003eIf the attacker knows the email of a victim. Say \u003ca title=\"abc@pqr.com\" href=\"mailto:abc@pqr.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@pqr.com\u003c/a\u003e. He can completely DOS that user. This is by using that end point to send password reset emails to that user. Even if the victim ignores this and tries to login, the application treats the user as a new user and does not let that user to login and ask him/her to first click on the password reset link. \u003cstrong\u003eThus, an attacker can frustrate a particular user by doing this using the automated exploit.\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nDerMeister\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-02T03:52:39.013Z","updated_at":"2017-03-02T03:52:39.013Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1552658,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delay, the client is still working on this too. Hopefully it won't be too much longer.","markdown_message":"\u003cp\u003eSorry for the delay, the client is still working on this too. Hopefully it won\u0026#39;t be too much longer.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T16:54:22.955Z","updated_at":"2017-03-20T16:54:22.955Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1556248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok..Thanks for letting me know that.","markdown_message":"\u003cp\u003eok..Thanks for letting me know that.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-22T04:12:44.516Z","updated_at":"2017-03-22T04:12:44.516Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1632228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry again for the delay - the client has now implemented fixes for these issues. There should now be brute force prevention on the login endpoint, as well as a more generic response to reset requests so that valid email addresses cannot be determined.\n\nCan you please look again and let us know if you feel the issue is resolved?","markdown_message":"\u003cp\u003eSorry again for the delay - the client has now implemented fixes for these issues. There should now be brute force prevention on the login endpoint, as well as a more generic response to reset requests so that valid email addresses cannot be determined.\u003c/p\u003e\n\n\u003cp\u003eCan you please look again and let us know if you feel the issue is resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-24T21:53:47.476Z","updated_at":"2017-04-24T21:53:47.476Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1646432,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty ,\n\nThe above bug is **not completely fixed**.\n\nWhat is fixed:\n1. The fact that username enumeration was possible. Now it is fixed cause the app sends a generic message so an attacker cannot determine whether a particular email exists or not.\n\nWhat is NOT fixed:\n1. Rate limiting is not applied at this email verify resend end point: https://en.instagram-brand.com/wp-json/brc/v1/resend-verify  as a result of which an attacker can bombard victims with mails. I have attached a PoC demonstrating this. PFA.\n\nWhat is NOT properly fixed:\n1. Now we cannot brute force login. It seems that rate limiting is there. But the problem is that now instead of presenting a CAPTCHA to suspicious malicious users, the web app simple says that username/password are incorrect. This is not a good design in my opinion. Because if an attacker does this to a victim's email, then the victim will be denied of service. This will happen when both attacker and victim are using same public IP (a common scenario in corporations, universities). So I would recommend not to block an account instead present the attacker with CAPTCHA.\n\nRegards,\nDerMeister","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThe above bug is \u003cstrong\u003enot completely fixed\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eWhat is fixed:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe fact that username enumeration was possible. Now it is fixed cause the app sends a generic message so an attacker cannot determine whether a particular email exists or not.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhat is NOT fixed:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRate limiting is not applied at this email verify resend end point: \u003ca title=\"https://en.instagram-brand.com/wp-json/brc/v1/resend-verify\" href=\"/redirect?url=https%3A%2F%2Fen.instagram-brand.com%2Fwp-json%2Fbrc%2Fv1%2Fresend-verify\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.instagram-brand.com/wp-json/brc/v1/resend-verify\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  as a result of which an attacker can bombard victims with mails. I have attached a PoC demonstrating this. PFA.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhat is NOT properly fixed:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNow we cannot brute force login. It seems that rate limiting is there. But the problem is that now instead of presenting a CAPTCHA to suspicious malicious users, the web app simple says that username/password are incorrect. This is not a good design in my opinion. Because if an attacker does this to a victim\u0026#39;s email, then the victim will be denied of service. This will happen when both attacker and victim are using same public IP (a common scenario in corporations, universities). So I would recommend not to block an account instead present the attacker with CAPTCHA.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nDerMeister\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-01T13:56:49.184Z","updated_at":"2017-05-01T13:56:49.184Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PFA.","markdown_message":"\u003cp\u003ePFA.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-01T14:16:34.959Z","updated_at":"2017-05-01T14:16:34.959Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":181045,"filename":"Retest_InstagramBrand1.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/181/045/ef29f15eebc231776b7b7bf29321e4fcd58e5a9a/Retest_InstagramBrand1.PNG?response-content-disposition=attachment%3B%20filename%3D%22Retest_InstagramBrand1.PNG%22%3B%20filename%2A%3DUTF-8%27%27Retest_InstagramBrand1.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045608Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=3978a5849827717179d2e1a406e3f2d41e69ec3d8ae32737c10e148194713f9f"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1672889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi.....Any updates on this?","markdown_message":"\u003cp\u003eHi.....Any updates on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-14T11:14:39.062Z","updated_at":"2017-05-14T11:14:39.062Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1681359,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @dermeister - we consider the last two items you noted, lack of rate limiting on the password reset endpoint, and account blocking vs. captchas for brute force login protection as `wontfix` as they don't present security issues per-se.\n\nThank you for your report, I'm going to mark this as Resolved and we'll follow up with a bounty decision.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/dermeister\"\u003e@dermeister\u003c/a\u003e - we consider the last two items you noted, lack of rate limiting on the password reset endpoint, and account blocking vs. captchas for brute force login protection as \u003ccode\u003ewontfix\u003c/code\u003e as they don\u0026#39;t present security issues per-se.\u003c/p\u003e\n\n\u003cp\u003eThank you for your report, I\u0026#39;m going to mark this as Resolved and we\u0026#39;ll follow up with a bounty decision.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-17T18:19:01.896Z","updated_at":"2017-05-17T18:19:01.896Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dermeister","url":"/dermeister"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1700391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty ,\n\nAny updates on this?\n\nBest Regards,\nDerMeister","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eAny updates on this?\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nDerMeister\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-25T12:01:03.934Z","updated_at":"2017-05-25T12:01:03.934Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dermeister - One more thing that I realized I hadn't addressed in your report. You had previously stated:\n\n\u003eIf the attacker knows the email of a victim. Say abc@pqr.com. He can completely DOS that user. This is by using that end point to send password reset emails to that user. Even if the victim ignores this and tries to login, the application treats the user as a new user and does not let that user to login and ask him/her to first click on the password reset link. Thus, an attacker can frustrate a particular user by doing this using the automated exploit.\n\nI've been unable to reproduce this behavior - simply sending a password reset link doesn't seem to lock the user out of their account. Is that still happening for you? Any tips for reproducing it?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/dermeister\"\u003e@dermeister\u003c/a\u003e - One more thing that I realized I hadn\u0026#39;t addressed in your report. You had previously stated:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf the attacker knows the email of a victim. Say \u003ca title=\"abc@pqr.com\" href=\"mailto:abc@pqr.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@pqr.com\u003c/a\u003e. He can completely DOS that user. This is by using that end point to send password reset emails to that user. Even if the victim ignores this and tries to login, the application treats the user as a new user and does not let that user to login and ask him/her to first click on the password reset link. Thus, an attacker can frustrate a particular user by doing this using the automated exploit.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI\u0026#39;ve been unable to reproduce this behavior - simply sending a password reset link doesn\u0026#39;t seem to lock the user out of their account. Is that still happening for you? Any tips for reproducing it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-26T18:26:48.763Z","updated_at":"2017-05-26T18:26:48.763Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1729475,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nickdaugherty \n\nFirst of all sorry for the late reply. Had a busy week. \nI have re-tested your above mentioned concern. It is fixed now. Cannot be reproduced.\n\nBest Regards,\nDerMeister","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nickdaugherty\"\u003e@nickdaugherty\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eFirst of all sorry for the late reply. Had a busy week. \u003cbr\u003e\nI have re-tested your above mentioned concern. It is fixed now. Cannot be reproduced.\u003c/p\u003e\n\n\u003cp\u003eBest Regards,\u003cbr\u003e\nDerMeister\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-05T03:38:03.906Z","updated_at":"2017-06-05T03:38:03.906Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731408,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thank you for the confirmation!","markdown_message":"\u003cp\u003eGreat, thank you for the confirmation!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-05T17:58:26.585Z","updated_at":"2017-06-05T17:58:26.585Z","actor":{"username":"nickdaugherty","cleared":false,"url":"/nickdaugherty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/778/73bab647e605318906a1a3197d4e578d5dd6de30_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1737870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is this bug eligible for a bounty?","markdown_message":"\u003cp\u003eIs this bug eligible for a bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-07T16:10:46.193Z","updated_at":"2017-06-07T16:10:46.193Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1739083,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-07T21:55:57.586Z","updated_at":"2017-06-07T21:55:57.586Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"175.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"dermeister","url":"/dermeister"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1744068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Guys, I am not happy with the bounty. This bug deserves more. \n\n####Justification:\nI have reported 2 bugs and took efforts to chain them and present in front of you. The report is very well written that there was no need for you to ask me for any clarification. I have also took so much efforts to develop the Ruby exploits which made this issue very clear. I have been more patient in order to resolve it. Waited for so many months......... :(\n","markdown_message":"\u003cp\u003eGuys, I am not happy with the bounty. This bug deserves more. \u003c/p\u003e\n\n\u003ch4 id=\"justification\"\u003eJustification:\u003c/h4\u003e\n\n\u003cp\u003eI have reported 2 bugs and took efforts to chain them and present in front of you. The report is very well written that there was no need for you to ask me for any clarification. I have also took so much efforts to develop the Ruby exploits which made this issue very clear. I have been more patient in order to resolve it. Waited for so many months......... :(\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-09T11:59:30.285Z","updated_at":"2017-06-09T11:59:30.285Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1746234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additional comments: For the low severity #209352 issue. Cross domain leakage of sensitive info, you gave $100 and for this clever issue you are only giving $175. This is not fair !!","markdown_message":"\u003cp\u003eAdditional comments: For the low severity \u003ca href=\"/reports/209352\"\u003e#209352\u003c/a\u003e issue. Cross domain leakage of sensitive info, you gave $100 and for this clever issue you are only giving $175. This is not fair !!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-10T03:27:25.437Z","updated_at":"2017-06-10T03:27:25.437Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Team,\n\nWould you mind a public disclosure of this bug. I want to share security testing knowledge in the community.\n\nThanks,\nSaurabh","markdown_message":"\u003cp\u003eHello Team,\u003c/p\u003e\n\n\u003cp\u003eWould you mind a public disclosure of this bug. I want to share security testing knowledge in the community.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSaurabh\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:12:19.356Z","updated_at":"2019-05-23T14:12:19.356Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910481,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello Team,\n\nWould you mind a public disclosure of this bug. I want to share security testing knowledge in the community.\n\nThanks,\nSaurabh","markdown_message":"\u003cp\u003eHello Team,\u003c/p\u003e\n\n\u003cp\u003eWould you mind a public disclosure of this bug. I want to share security testing knowledge in the community.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSaurabh\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T14:12:37.741Z","updated_at":"2019-05-23T14:12:37.741Z","first_to_agree":true,"actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5168535,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-22T14:12:38.422Z","updated_at":"2019-06-22T14:12:38.422Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5211105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for the disclosure.","markdown_message":"\u003cp\u003eThanks a lot for the disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-28T04:08:37.596Z","updated_at":"2019-06-28T04:08:37.596Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}