{"id":21083,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTA4Mw==","url":"https://hackerone.com/reports/21083","title":"Account Hijacking (Only rare case scenario)","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-07-22T19:40:36.283Z","submitted_at":"2014-07-22T19:40:36.283Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xtross1","url":"/xtross1","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-08-23T18:23:38.527Z","bug_reporter_agreed_on_going_public_at":"2014-07-24T18:23:25.942Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nThis is a logical flaw in the application which may allow any arbitrary user to obtain account access of another user.\r\nBelow is the exploit scenario which may lead to potential account takeover in certain circumstances:\r\n* User changes email while he is logged in his own account (Some wrong email)\r\n* User enters an incorrect mail\r\n* Another user (user-2) receives the verification link\r\n* User- 2 clicks on the link (as of yet the new email doesn't get assoc. with the account)\r\n* Now, User-2 clicks on forgot password - the reset link is sent on the User-2 's email address.\r\n* User-2 clicks on that link, and changes the password.\r\n\r\nSuccessfully gains any hackerone's account.\r\n\r\nThe glitch - User-1 needs to set wrong email by-mistake.\r\n\r\nPossible Fix: \r\n\u003e Authentication after the reset link is sent via the old creds.\r\n\u003e Use Codes which can be sent to emails and not Links for verification","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-23T18:23:26.147Z","allow_singular_disclosure_after":-225142836.59563366,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":94253,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"What is the difference between sending a code to that email address or sending a link with a code? ","automated_response":false,"created_at":"2014-07-23T08:43:44.649Z","updated_at":"2014-07-23T08:43:44.649Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":94372,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Yep my bad, send code/link to the old (user-1) account to make sure the changes are allowed - could be one method of mitigating\nOther could be : After the point (4) -\u003e force user-2 to authenticate first. Don't allow user-2 to reset the password via \"forget password\" since the URL gets sent to the new account(user-2) even when the email is not assoc. with the hackerone account.","automated_response":false,"created_at":"2014-07-23T15:03:05.111Z","updated_at":"2014-07-23T15:03:05.111Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":95160,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for submitting this, but we decided not to deploy a fix at this time. We believe this is not a very realistic threat scenario and we are okay with the *minor* risk here.","automated_response":false,"created_at":"2014-07-24T09:56:05.182Z","updated_at":"2014-07-24T09:56:05.182Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":95420,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I hope public disclosure is ok ?","automated_response":false,"created_at":"2014-07-24T18:23:25.958Z","updated_at":"2014-07-24T18:23:34.235Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":103900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Team,\nSorry to bother you guys, isn't this vulnerability somewhat similar to  this report - https://hackerone.com/reports/17383    ???\n\nBoth have a similar logical flaw.","automated_response":false,"created_at":"2014-08-09T17:48:29.442Z","updated_at":"2014-08-09T17:48:29.442Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":107368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you explain why you think they're similar? I don't think I completely understand the point you're trying to make. Thanks!","automated_response":false,"created_at":"2014-08-14T05:24:13.928Z","updated_at":"2014-08-14T05:24:13.928Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":107461,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here the verification link which is sent to the user-2 is verified directly when he clicks on it.\nIdeally, the CORRECT workflow should be as follows - \nUser-2 receives an verification link for changed email -\u003e Once the link is accessed, he should login to perform the change email action\n\nOver here the INCORRECT workflow followed is :\nUser-2 receives an verification link for changed email -\u003e Only clicking on the link by user-2, directly changes the email address of the hackerone account.\nFurthermore, once the link is clicked, the email is changed for hackerone account, now the user-2 can use the password reset function to change the password of the hackerone account and since the email is now changed from user-1's account to user-2's account (just by a click of the link), the user-2 can take control of hackerone account.\n\nHere is how this actively exploited : \nhttp://www.techweekeurope.co.uk/news/attackers-spread-typosquatting-scams-39324\nAND\nhttp://www.wired.co.uk/news/archive/2011-09/09/typosquatting\n","automated_response":false,"created_at":"2014-08-14T10:05:14.198Z","updated_at":"2014-08-14T10:05:14.198Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":110708,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any chance this might get fixed?","automated_response":false,"created_at":"2014-08-18T08:06:47.796Z","updated_at":"2014-08-18T08:06:47.796Z","actor":{"username":"xtross1","cleared":false,"url":"/xtross1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/210/2a44eb68ed05dcce4d8082bcdbd9132630beb0cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":114521,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-08-23T18:23:38.543Z","updated_at":"2014-08-23T18:23:38.543Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}