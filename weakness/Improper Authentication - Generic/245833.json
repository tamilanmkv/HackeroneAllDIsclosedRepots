{"id":245833,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDU4MzM=","url":"https://hackerone.com/reports/245833","title":"The user, who was deleted from Github Organization, still can access all functions of federalist, in case he didn't do logout","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-04T13:48:23.900Z","submitted_at":"2017-07-04T13:48:23.900Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":50592,"url":"https://hackerone.com/gsa_bbp","handle":"gsa_bbp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GSA Bounty","twitter_handle":null,"website":"http://gsa.gov","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-05T19:48:53.548Z","bug_reporter_agreed_on_going_public_at":"2017-09-04T18:04:02.976Z","team_member_agreed_on_going_public_at":"2017-09-05T19:48:53.464Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHi. I found a non-critical session management bug, which still can have serious impact in some scenarios.\nWhen user perform login to the Federalist through Github, federalist checks his Organization ID (but only upon login).\nWhen the user was deleted from organization for some reasons, but he was logged in the Federalist (or saved his session cookies), he can still do any action on behalf of organization (create sites, delete sites etc).\n\n##Reproduction Steps \u0026 POC\n1) Add a test user to your organization, which have access to the federalist.\n2) Login to the Federalist.\n3) Remove the user from organization, or leave organization\n4) Try to create or delete the site. Federalist doesn't know that this user has no permissions, and will allow him to use functions.\n\n##Suggested fix\nYou should implement Organization ID checking in the requests.\nUpon login, the endpoint `/v0/me` is called (once). But it can be a good idea to call it in a random periods of time and check the organization ID, and in case it will return 403 - invalidate user session.\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":14,"voters":["bl4de","spam404","cuso4","edoverflow","eveeez","r3y","its_afolic","mr_r3boot","japz","wslack","and 4 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":81507,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/18F/federalist","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1802014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that the issue can not affect integrity of the app, and has limited opportunity of exploitation.\nBut it is still possible next scenario (chained with insufficient session expiration):\n1) The user Github account was deleted from Organization.\n2) But employee who worked with this account saved his session cookies/did not do logout from Federalist still has access. (it is bug #1)\n3) The Github account changed password, assigned to other OrgID, was given to the different employee, etc.\n4) First employee with no access to the Github account, still has access to the Federalist (his session still valid, even if new employee will login and obtain different session - for some reasons first will not expire - bug #2). Both new and old employee have two valid sessions on same account, and full control over the Federalist functions.","automated_response":false,"created_at":"2017-07-04T14:08:15.380Z","updated_at":"2017-07-04T14:15:24.255Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1807014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think the impact of the issue can be lowered from `Medium` to `Low`. Let me know please, do this issue worth fix, or not. If not - i'll close the ticket.","automated_response":false,"created_at":"2017-07-05T13:16:24.704Z","updated_at":"2017-07-05T13:16:24.704Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1809433,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs \n\nThanks for your submission. We will review it and get back to you.","automated_response":false,"created_at":"2017-07-06T00:22:48.585Z","updated_at":"2017-07-06T00:22:48.585Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1810764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Issue created: https://github.com/18F/federalist/issues/1057","automated_response":false,"created_at":"2017-07-06T13:54:15.039Z","updated_at":"2017-07-06T13:54:15.039Z","actor":{"username":"jseppi","cleared":false,"url":"/jseppi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/387/972024bbd271356385d763e52932ebf4b887dea6_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815089,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @sp1d3rs thank you for another report! \nWe were able to validate this and are moving this to `Triaged` state. \nKeep hacking! Keep those reports coming!","automated_response":false,"created_at":"2017-07-07T17:48:23.601Z","updated_at":"2017-07-07T17:48:23.601Z","actor":{"username":"rockyrobot","cleared":false,"url":"/rockyrobot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/256/061431018bdae2144e25297602c95722e8f2beed_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1817507,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @sp1d3rs - thanks for another great report! We look forward to more reports from you in the future! ","automated_response":false,"created_at":"2017-07-09T04:02:58.041Z","updated_at":"2017-07-09T04:02:58.041Z","actor":{"url":"/gsa_bbp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GSA Bounty"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gsa_bbp","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1833379,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Pull request to mitigate this issue: https://github.com/18F/federalist/pull/1064","automated_response":false,"created_at":"2017-07-13T18:10:07.937Z","updated_at":"2017-07-13T18:10:07.937Z","actor":{"username":"jseppi","cleared":false,"url":"/jseppi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/387/972024bbd271356385d763e52932ebf4b887dea6_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1843442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Updated my test instance, issue looks fixed for me.","automated_response":false,"created_at":"2017-07-17T16:05:54.901Z","updated_at":"2017-07-17T16:05:59.157Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1938738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rockyrobot, the issue was fixed, can we move the report to the `Resolved` state?","automated_response":false,"created_at":"2017-08-18T11:52:55.654Z","updated_at":"2017-08-18T11:52:55.654Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1945213,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your report! We look forward to more reports from you in the future. ","automated_response":false,"created_at":"2017-08-22T02:50:53.406Z","updated_at":"2017-08-22T02:50:53.406Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1956128,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","automated_response":false,"created_at":"2017-08-25T22:36:34.592Z","updated_at":"2017-08-25T22:36:34.592Z","additional_data":{"old_team":"TTS Private Bug Bounty","new_team":"TTS Bug Bounty"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975499,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I reviewed this report, and feel ok to fully disclose it:)","automated_response":false,"created_at":"2017-09-04T18:04:03.001Z","updated_at":"2017-09-04T18:04:03.001Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1978110,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-05T19:48:53.490Z","updated_at":"2017-09-05T19:48:53.490Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1978111,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-09-05T19:48:53.576Z","updated_at":"2017-09-05T19:48:53.576Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gsa_bbp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5269,"category":"researcher","content":"*Thanks to the 18F team for the great experience, fast fix and the bounty!*\n\nThis report describes authentication issue, when the user, whose privileges was removed, still could access control panel instruments.\nIssue was fixed by implementing periodic user permissions checks.\n\n##References\n[Running Federalist locally](https://federalist-docs.18f.gov/pages/how-federalist-works/running-federalist-locally/ \"Running Federalist locally\")","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":79690,"username":"sp1d3rs","name":"Dr. Jones","bio":"Human. Possibly","cleared":true,"website":"https://xp.ht","location":"Xen","created_at":"2016-05-23T03:07:23.595Z","url":"https://hackerone.com/sp1d3rs","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}