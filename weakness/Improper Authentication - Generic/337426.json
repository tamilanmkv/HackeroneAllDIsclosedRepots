{"id":337426,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzc0MjY=","url":"https://hackerone.com/reports/337426","title":"Authorization Token is Not expiring After Logout","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-04-13T19:51:06.718Z","submitted_at":"2018-04-13T19:51:06.718Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"saneh","url":"/saneh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27430,"url":"https://hackerone.com/passit","handle":"passit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Passit","twitter_handle":"passitdotio","website":"https://passit.io","about":"An open source app that uses an established and modern cryptographic library to secure your passwords online so you can access them anywhere."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-11T14:19:59.150Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-07-12T14:19:57.053Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n**Summary:** Authorization Token is Not expiring After Logout\n\n**Description:** Hello Team,\n\nI have observed the application is assigning auth token after successful login to every user which is part of every request user made to application. If user click on logout sill auth token is not expiring which is not a good security practise. An attacker can steal the auth token via Man in the Middle attack because HSTS is not implemented. \n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n1. Login to Application and configure the burp suite.\n2. Click on Add new password, fill all the required details and click on save. capture the request in burp suite, send the request to repeater and forward to the application. Application will add the entry under user account.\n 3. Click on Logout.\n4. Goto burp suite repeater tab and forward the request to application. It will create one more entry to user account with previous auth token.\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nAuth token should be expired after user logout. If an attacker get access to auth token he can user this token after user logout of application to delete/add password list.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Authorization Token is Not expiring After Logout\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Hello Team,\u003c/p\u003e\n\n\u003cp\u003eI have observed the application is assigning auth token after successful login to every user which is part of every request user made to application. If user click on logout sill auth token is not expiring which is not a good security practise. An attacker can steal the auth token via Man in the Middle attack because HSTS is not implemented. \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to Application and configure the burp suite.\u003c/li\u003e\n\u003cli\u003eClick on Add new password, fill all the required details and click on save. capture the request in burp suite, send the request to repeater and forward to the application. Application will add the entry under user account.\n\n\u003col\u003e\n\u003cli\u003eClick on Logout.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eGoto burp suite repeater tab and forward the request to application. It will create one more entry to user account with previous auth token.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAuth token should be expired after user logout. If an attacker get access to auth token he can user this token after user logout of application to delete/add password list.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-11T14:19:57.176Z","allow_singular_disclosure_after":-75223111.28468716,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","r0p3","saneh","cryptographer","the_baghdad_sniper","juba_","wat3r"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":8266,"asset_type":"URL","asset_identifier":"app.passit.io","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2604983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, attacker can delete the account of user using his auth token even user clicked on logout","markdown_message":"\u003cp\u003eAlso, attacker can delete the account of user using his auth token even user clicked on logout\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-13T20:40:08.881Z","updated_at":"2018-04-13T20:40:08.881Z","actor":{"username":"saneh","cleared":false,"url":"/saneh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2607480,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Makes sense, should be a simple fix. Pretty sure the server already has a logout api, it just isn't being used by the client. Thanks for reporting.","markdown_message":"\u003cp\u003eMakes sense, should be a simple fix. Pretty sure the server already has a logout api, it just isn\u0026#39;t being used by the client. Thanks for reporting.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-14T13:23:28.694Z","updated_at":"2018-04-14T13:23:28.694Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2607522,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in source. app.passit.io will have this fixed on the next release. \n\nhttps://gitlab.com/passit/passit-frontend/commit/b8afd642804a80647587d01e6e7cd21b56853357\n\nPotential follow up work - all users to optionally log out all devices. I'll keep this issue open until fix is on app.passit.io Thanks for the report.","markdown_message":"\u003cp\u003eFixed in source. app.passit.io will have this fixed on the next release. \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://gitlab.com/passit/passit-frontend/commit/b8afd642804a80647587d01e6e7cd21b56853357\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fpassit%2Fpassit-frontend%2Fcommit%2Fb8afd642804a80647587d01e6e7cd21b56853357\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/passit/passit-frontend/commit/b8afd642804a80647587d01e6e7cd21b56853357\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePotential follow up work - all users to optionally log out all devices. I\u0026#39;ll keep this issue open until fix is on app.passit.io Thanks for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-14T14:00:19.423Z","updated_at":"2018-04-14T14:00:19.423Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2609630,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you David for the quick response. \n\nAlso, will wait for your next message. Let me know if anything is required from my side.","markdown_message":"\u003cp\u003eThank you David for the quick response. \u003c/p\u003e\n\n\u003cp\u003eAlso, will wait for your next message. Let me know if anything is required from my side.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-14T18:01:28.304Z","updated_at":"2018-04-14T18:01:28.304Z","actor":{"username":"saneh","cleared":false,"url":"/saneh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2615749,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed on app.passit.io. Let me know if you believe otherwise. Thank you.","markdown_message":"\u003cp\u003eFixed on app.passit.io. Let me know if you believe otherwise. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-15T18:06:52.696Z","updated_at":"2018-04-15T18:06:52.696Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"saneh","url":"/saneh"},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3035030,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Just going through old issues to mark public when that seems appropriate.","markdown_message":"\u003cp\u003eJust going through old issues to mark public when that seems appropriate.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-12T14:19:57.103Z","updated_at":"2018-07-12T14:19:57.103Z","first_to_agree":true,"actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3177067,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-11T14:19:59.215Z","updated_at":"2018-08-11T14:19:59.215Z","actor":{"url":"/passit","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Passit"}},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}