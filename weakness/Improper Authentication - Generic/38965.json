{"id":38965,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODk2NQ==","url":"https://hackerone.com/reports/38965","title":"Phabricator Diffusion application allows unauthorized users to delete mirrors","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-12-10T15:33:37.117Z","submitted_at":"2014-12-10T15:33:37.117Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nullsub","url":"/nullsub","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/470/2fbec5598f656107a3ddd37f9e0f563a6494f29b_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-01-09T23:26:33.210Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-12-10T23:26:18.896Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have succesfully reproduced this issue following these steps:\r\n \r\n- Creating a repository with an administrator user\r\n \r\n- Checking that my \"guest\" user hasn't access to the newly created repository:\r\n \r\n  http://phabricator/diffusion/TEST/edit/\r\n \r\n- However, the guest user does have access to delete the mirror:\r\n \r\n  http://phabricator/diffusion/TEST/mirror/delete/1/\r\n \r\n You can review the lack of permission-checks in the file: applications/diffusion/controller/DiffusionMirrorDeleteController.php","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-01-09T23:26:19.022Z","allow_singular_disclosure_after":-213118091.9204784,"singular_disclosure_allowed":true,"vote_count":1,"voters":["wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":175755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, looking into this...","automated_response":false,"created_at":"2014-12-10T16:58:40.390Z","updated_at":"2014-12-10T16:58:40.390Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":175765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fix out for review: https://secure.phabricator.com/D10957","automated_response":false,"created_at":"2014-12-10T17:06:38.205Z","updated_at":"2014-12-10T17:06:38.205Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":175771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fine to me, I just tested and works as expected now :)\n\nbtw, thanks for being so quick reviewing the bugs I filled!","automated_response":false,"created_at":"2014-12-10T17:17:18.925Z","updated_at":"2014-12-10T17:17:18.925Z","actor":{"username":"nullsub","cleared":false,"url":"/nullsub","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/470/2fbec5598f656107a3ddd37f9e0f563a6494f29b_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":176039,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should now be fixed in HEAD. Thanks for the report! Let us know if you run into anything else.","automated_response":false,"created_at":"2014-12-10T23:24:39.367Z","updated_at":"2014-12-10T23:24:39.367Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nullsub","url":"/nullsub"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":176041,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"In assessing an award, I am primarily considering the relatively low impact of this issue. Although attackers could delete mirrors, this is unlikely to have a major security impact in most cases, and checks lower in the stack prevented attackers from creating or editing mirrors (which would have been more severe).","automated_response":false,"created_at":"2014-12-10T23:25:55.899Z","updated_at":"2014-12-10T23:25:55.899Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"nullsub","url":"/nullsub"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":176042,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This can be disclosed at any time, since the fix is already available publicly.","automated_response":false,"created_at":"2014-12-10T23:26:18.911Z","updated_at":"2014-12-10T23:26:18.911Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":176053,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty, I think the amount is fair given the severity of the bug. Also, kudos to you and your team, the project looks quite nice and one can tell that you guys have taken security seriously, should I find something else I will keep you posted.\n\nRegards,\nM","automated_response":false,"created_at":"2014-12-10T23:41:29.034Z","updated_at":"2014-12-10T23:41:29.034Z","actor":{"username":"nullsub","cleared":false,"url":"/nullsub","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/470/2fbec5598f656107a3ddd37f9e0f563a6494f29b_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":307450,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-01-09T23:26:33.651Z","updated_at":"2015-01-09T23:26:33.651Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}