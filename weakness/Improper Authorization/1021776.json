{"id":1021776,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDIxNzc2","url":"https://hackerone.com/reports/1021776","title":"Attacker can generate cancelled transctions in a user's transaction history using only Steam ID","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-10-29T14:20:09.187Z","submitted_at":"2020-10-29T14:20:09.241Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pmnh","url":"/pmnh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48311,"url":"https://hackerone.com/cs_money","handle":"cs_money","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"CS Money","twitter_handle":"csmoneytrade","website":"https://cs.money","about":"CS:GO trading platform that helps people to trade, buy, sell and search for the best skins and deals they could possibly find."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-02-03T13:05:45.548Z","bug_reporter_agreed_on_going_public_at":"2020-12-31T01:05:26.116Z","team_member_agreed_on_going_public_at":"2021-02-03T13:05:45.454Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe API endpoint `/create-payment` requires only the steam ID of the account to create the payment. When this endpoint is called using the `cardpay` flow, it returns a transaction ID on the Cardpay system. The attacker can access this transaction, and immediately cancel it (or pay it ;) ), which leads to a visible cancelled transaction in the cs.money user's transaction history.\n\nAlthough there is no impact to the user, they will certainly be confused.\n\n## Steps To Reproduce:\nInvoke the API call `/create-payment` as below:\n\n```\nPOST https://cs.money/create-payment HTTP/1.1\nHost: cs.money\nContent-Type: application/json;charset=UTF-8\nCookie: steamid=████████; \n\n{\"merchant\":\"cardpay\",\"amount\":10}\n```\n\nYou will get a response with a Cardpay order ID and URL:\n```\nHTTP/1.1 200 OK\n...\n{\"merchant\":\"cardpay\",\"orderId\":2034944,\"success\":true,\"url\":\"https://cardpay.com/MI/payment.html?uuid=DaG438Bda6GC13h5db1bGD01\"}\n```\n\nYou can then cancel the payment by hitting the Cardpay cancel URL:\n```\nhttps://cardpay.com/MI/cancel.html?uuid=DaG438Bda6GC13h5db1bGD01\n```\n\nThis will result in a cancelled transaction showing in the user's transaction history of the amount specified by the attacker. The attacker could repeat this numerous times until the account is banned by cs.money (this occurred on one of my test accounts).\n\n## Impact\n\nConfusion for the user due to the ability to create many cancelled transactions, potentially leading to the account being banned.","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":124,"name":"Improper Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":60,"voters":["gatolouco","base_64","bombon","ali","sudi","mattberg","realtess","ms-13","dmc3","h4x0r_dz","and 50 more..."],"severity":{"rating":"medium","score":6.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":45901,"asset_type":"URL","asset_identifier":"cs.money","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9673967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note: to reproduce this on an account you control, you need to:\n\n * Create a Steam account\n * Create an account on cs.money with your Steam account\n * Identify the steamid associated with your account and use it in the POST requests above\n\nOne observation: in some cases the \"cardpay\" payment method actually returns a \"g2a\" provider URL. The \"g2a\" provider is not vulnerable to this issue. This seems to be account-specific and may be a functional defect or undocumented business logic in the site.","automated_response":false,"created_at":"2020-10-29T17:43:38.512Z","updated_at":"2020-10-29T17:43:38.512Z","actor":{"username":"pmnh","cleared":true,"url":"/pmnh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9704414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nSorry for the long reply.\nWe are going to see in that tomorrow.","automated_response":false,"created_at":"2020-11-02T16:23:06.544Z","updated_at":"2020-11-02T16:23:06.544Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9776460,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"No fix needed for some of the following reasons.\n1. No exact security issue;\n2. Reproducability steps are not that clear and root cause is unknown;\n3. The JWT is incoming in upcoming future, so the usability of such issue would be little to none.\n","automated_response":false,"created_at":"2020-11-10T09:18:41.792Z","updated_at":"2020-11-10T09:18:41.792Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9778179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI don't agree with the closure reasons. Writing data to another user's account is certainly a security issue (although the impact of the data is low). The steps listed are clearly stated and very easy to reproduce.\n\nAlso, with your point 3, this is not a valid reason - the issue affects the site currently, saying you are going to fix it later doesn't mean the issue does not exist today.\n\nThanks,\n@pmnh","automated_response":false,"created_at":"2020-11-10T11:51:01.424Z","updated_at":"2020-11-10T11:51:01.424Z","actor":{"username":"pmnh","cleared":true,"url":"/pmnh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9778395,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nWe've re-tested the issue.\nSuppose had some problems before.\nGoing to triage this and add to the work in the next sprint, sorry for misunderstanding.","automated_response":false,"created_at":"2020-11-10T12:19:22.741Z","updated_at":"2020-11-10T12:19:22.741Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9778397,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2020-11-10T12:19:34.343Z","updated_at":"2020-11-10T12:19:34.343Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9778403,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-11-10T12:19:49.064Z","updated_at":"2020-11-10T12:19:49.064Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9778829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reconsidering!","automated_response":false,"created_at":"2020-11-10T13:16:43.841Z","updated_at":"2020-11-10T13:16:43.841Z","actor":{"username":"pmnh","cleared":true,"url":"/pmnh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9813685,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-11-13T12:50:56.117Z","updated_at":"2020-11-13T12:50:56.117Z","actor":{"url":"/cs_money","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"CS Money"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"cs_money","collaborator":{"username":"pmnh","url":"/pmnh"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9898741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\nThe issue should be fixed on production, we've validated it from our side, if you could, please do the same.","automated_response":false,"created_at":"2020-11-23T13:16:00.273Z","updated_at":"2020-11-23T13:16:00.273Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9910434,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-11-24T10:36:06.628Z","updated_at":"2020-11-24T10:36:06.628Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"pmnh","url":"/pmnh"},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10240572,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-31T01:05:26.142Z","updated_at":"2020-12-31T01:05:26.142Z","first_to_agree":true,"actor":{"username":"pmnh","cleared":true,"url":"/pmnh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10561688,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-02-03T13:05:45.473Z","updated_at":"2021-02-03T13:05:45.473Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10561689,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-02-03T13:05:45.572Z","updated_at":"2021-02-03T13:05:45.572Z","actor":{"username":"triage_team","cleared":false,"url":"/triage_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10561707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @triage_team,\n\nThanks for disclosing, can you please redact the steam ID?\n\nThanks!\n@pmnh","automated_response":false,"created_at":"2021-02-03T13:06:58.697Z","updated_at":"2021-02-03T13:08:00.668Z","actor":{"username":"pmnh","cleared":true,"url":"/pmnh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"cs_money","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}