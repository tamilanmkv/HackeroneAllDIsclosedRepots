{"id":715413,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MTU0MTM=","url":"https://hackerone.com/reports/715413","title":"curl successfully matches IP address literal in URL against IP address literal in certificate Common Name","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2019-10-16T11:24:19.420Z","submitted_at":"2019-10-16T11:24:19.420Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lersek-rh","url":"/lersek-rh","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-14553"],"singular_disclosure_disabled":true,"disclosed_at":"2021-01-08T09:18:29.536Z","bug_reporter_agreed_on_going_public_at":"2021-01-08T09:18:29.493Z","team_member_agreed_on_going_public_at":"2021-01-08T08:20:59.522Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nA user may invoke the curl command line utility with an IP address literal in the URL, such as\n\n    https://192.168.124.2/...\n\nIf the HTTPS server presents a certificate whose Common Name matches this IP address literal as a *string* (that is, Common Name is the ASCII string `192.168.124.2`), then curl accepts the certificate (assuming it is properly signed by a trusted CA).\n\nThis is wrong. Per [RFC-2818, section *3.1.  Server Identity*](https://tools.ietf.org/html/rfc2818#section-3.1):\n\n    In some cases, the URI is specified as an IP address rather than a\n    hostname. In this case, the iPAddress subjectAltName must be present\n    in the certificate and must exactly match the IP in the URI.\n\nThat is, if the user-specified URL contains an IPv4 or IPv6 address literal, then the server certificate may only match the URL if the certificate contains the same *numeric* IP address in the *SAN*, as a `GEN_IP` entry.\n\nCurl should first attempt `X509_VERIFY_PARAM_set_ip_asc()`, and call `X509_VERIFY_PARAM_set1_host()` only if the former fails.\n\n## Steps To Reproduce:\n\n  1. Generate a new certificate request, for example with the [`genkey` utility](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-web_servers#s3-apache-mod_ssl-genkey), specifying the server's IPv4 or IPv6 address on the command line / in the Common Name field. (My `genkey` is from `crypto-utils-2.4.1-42.el7.x86_64`.)\n  1. Sign the certificate request with a local CA such that `curl` trust the local CA.\n  1. Configure Apache's `mod_ssl` such that it listen on the IPv4 or IPv6 address in question.\n  1. Fetch an URI with curl from the web server, using the `https` scheme, and the IP address.\n  1. Curl accepts the certificate.\n\n## Supporting Material/References:\nThis issue with curl popped up while discussing the edk2 patch series mitigating CVE-2019-14553:\n\nhttps://bugzilla.tianocore.org/show_bug.cgi?id=960\nhttp://mid.mail-archive.com/20190927034441.3096-1-Jiaxin.wu@intel.com\n\n## Impact\n\nI'm not sure this problem can be used for an *attack*. It's just that string representations of IP addresses are not unique. URL to Subject Name matching should use canonical representations only.","weakness":{"id":28,"name":"Improper Certificate Validation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6054346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report, we will investigate.\n\nI didn't see this in the report: can you clarify which TLS library and version your curl version was built to use when you spotted this behavior? It could also help us to know which curl version you used!","automated_response":false,"created_at":"2019-10-16T12:00:54.170Z","updated_at":"2019-10-16T12:00:54.170Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6054831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My OS is `Red Hat Enterprise Linux Workstation release 7.5 (Maipo)`, and I use the `curl` binary from the `curl` package. The package version is\n\n    $ rpm -q curl\n    curl-7.29.0-46.el7.x86_64\n\nThe `curl` binary seems to link against:\n\n    libssl3.so =\u003e /lib64/libssl3.so (0x00007fcf3a9c5000)\n    libssl.so.10 =\u003e /lib64/libssl.so.10 (0x00007fcf37b52000)\n\nThose files come from the following packages:\n\n    $ rpm -qf /lib64/libssl.so.10\n    openssl-libs-1.0.2k-12.el7.x86_64\n    $ rpm -qf /lib64/libssl3.so\n    nss-3.36.0-7.el7_5.x86_64\n\n(BTW I've filed a parallel report with Red Hat Product Security.)\n\nThanks!","automated_response":false,"created_at":"2019-10-16T13:12:38.540Z","updated_at":"2019-10-16T13:12:38.540Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6054889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The source code for the above packages can be downloaded here:\n- http://vault.centos.org/7.5.1804/os/Source/SPackages/curl-7.29.0-46.el7.src.rpm\n- http://vault.centos.org/7.5.1804/os/Source/SPackages/openssl-1.0.2k-12.el7.src.rpm\n- http://vault.centos.org/7.6.1810/os/Source/SPackages/nss-3.36.0-7.el7_5.src.rpm","automated_response":false,"created_at":"2019-10-16T13:21:35.720Z","updated_at":"2019-10-16T13:21:35.720Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6054958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's an awfully old curl version, [released in early 2013](https://curl.haxx.se/changes.html#7_29_0). Perhaps needless to say, we've changed a significant amount of code since then and I doubt the NSS backend works the same way these days.\n\nWould it be possible for you to build a current version with NSS and check if the problem persists?\n\nWhen curl is built to use NSS, the cert name verification function is provided by NSS itself. This bug is then either curl not using NSS correctly or a bug in NSS. Or in that version combination. I couldn't figure out if that is an old or a new NSS version.\n\n@kdudka, do you perhaps recall if this particular thing might've been addressed in NSS already in the past?","automated_response":false,"created_at":"2019-10-16T13:29:50.422Z","updated_at":"2019-10-16T13:29:50.422Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6055038,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bagder can you please give me the download locations for curl and NSS (just so I test exactly that you want me to)? I'm OK to to build released tarballs, git trees at release tags, or git trees at current master branches; whichever you prefer. Thanks.","automated_response":false,"created_at":"2019-10-16T13:38:55.414Z","updated_at":"2019-10-16T13:39:05.563Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6059113,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The latest NSS release seems to be here: https://ftp.mozilla.org/pub/security/nss/releases/NSS_3_46_1_RTM/src/\nThe latest curl release is here: https://curl.haxx.se/download.html","automated_response":false,"created_at":"2019-10-16T21:03:39.117Z","updated_at":"2019-10-16T21:03:39.117Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6061875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bagder thanks, I'll report back.\n\nMeanwhile, can I CC David Woodhouse \u003cdwmw2@infradead.org\u003e on this ticket somehow? I filed this ticket at his request in the first place.\n\nThanks!\nLaszlo","automated_response":false,"created_at":"2019-10-17T08:18:44.314Z","updated_at":"2019-10-17T08:18:44.314Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6061883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can invite him as a \"participant\" on this issue. I'll do it now!","automated_response":false,"created_at":"2019-10-17T08:20:33.785Z","updated_at":"2019-10-17T08:20:33.785Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6062312,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We use the default `SSL_AuthCertificate()` hook from NSS and `SSL_SetURL()` to pass the URL over to NSS.  I am not sure if NSS provides some API to better control this behavior.","automated_response":false,"created_at":"2019-10-17T08:38:32.679Z","updated_at":"2019-10-17T08:38:32.679Z","actor":{"username":"kdudka","cleared":false,"url":"/kdudka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6064464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The symptom reproduces with the [latest](https://hackerone.com/reports/715413#activity-6059113) NSS and curl releases.\n\nCertificate\n=\n\n    Certificate:\n        Data:\n            Version: 1 (0x0)\n            Serial Number:\n                d1:ea:de:57:cb:4b:44:7e\n        Signature Algorithm: sha256WithRSAEncryption\n            Issuer: C=HU, ST=Pest, L=Budapest, O=Laszlo Ersek Home Office, OU=Certificate Authority, CN=Laszlo Ersek CA/emailAddress=lersek@redhat.com\n            Validity\n                Not Before: Oct 17 12:52:20 2019 GMT\n                Not After : Nov 16 12:52:20 2019 GMT\n            Subject: CN=192.168.124.2\n            Subject Public Key Info:\n                Public Key Algorithm: rsaEncryption\n                    Public-Key: (2048 bit)\n                    Modulus:\n                        00:aa:0b:10:03:b2:b1:a5:e5:06:94:b7:4d:08:79:\n                        91:7d:e6:90:8f:c6:48:47:53:fe:4e:ea:75:c7:78:\n                        d1:61:8d:4c:03:ab:3d:b7:35:7d:58:b6:4a:fd:2d:\n                        08:ed:17:2e:e8:a8:73:d9:45:21:28:04:26:f1:46:\n                        32:3d:4c:72:cd:2f:19:74:b4:03:92:1e:04:0b:28:\n                        22:66:63:fb:6a:a2:ee:7d:7f:62:3d:fe:c2:6c:53:\n                        c1:eb:4d:86:a6:5d:b2:7e:07:ec:16:07:16:2b:27:\n                        ba:43:4b:4a:96:5d:68:d6:56:9b:7d:8b:b5:a3:f9:\n                        6f:09:dd:29:c7:91:44:9d:08:f4:a4:37:f1:83:06:\n                        36:e4:28:a7:67:c7:34:14:88:d1:15:67:c2:9a:81:\n                        b7:7c:37:bd:95:da:d2:57:c5:06:ca:ca:ab:48:a5:\n                        58:12:a4:0c:dc:9c:81:e1:1c:34:4e:2c:54:6c:81:\n                        cc:c8:ba:c2:e8:de:97:02:46:87:c8:36:69:7a:d6:\n                        92:b5:0f:e4:40:b1:83:43:b7:78:10:15:87:57:60:\n                        ae:0c:4c:2f:89:b1:e1:5b:7c:56:d1:98:9b:cb:e0:\n                        96:f2:d6:ae:5f:79:79:91:0c:1b:ce:91:35:80:7e:\n                        99:11:be:7f:8c:64:b3:7a:40:ca:f8:95:b3:00:9b:\n                        ae:ff\n                    Exponent: 65537 (0x10001)\n        Signature Algorithm: sha256WithRSAEncryption\n             96:77:96:5d:e7:f7:f8:39:7a:34:2f:df:98:c7:0e:00:55:d2:\n             49:ce:a5:d3:31:9d:5e:ef:8b:0a:a6:28:4f:f6:e7:07:13:a8:\n             df:91:05:60:47:a2:c8:3b:45:ef:3b:c6:9f:06:b1:5f:48:a4:\n             35:17:1c:d0:ba:9a:4a:f2:0c:c5:ee:d1:e6:7d:6b:34:4f:6b:\n             38:f5:04:5b:b5:0f:af:18:39:a0:e3:b2:32:01:90:35:34:bf:\n             76:76:ed:94:24:37:b9:1e:1c:76:fe:62:e7:31:c1:98:4c:ab:\n             82:63:99:9b:fb:70:82:c1:a4:1a:8c:d0:af:06:3a:81:94:c0:\n             31:09:e4:da:b4:db:f8:e3:8d:e4:da:ca:6e:29:fc:da:60:98:\n             60:8b:15:78:f5:9d:c8:60:4a:5c:cf:13:0a:84:b5:f1:78:55:\n             68:5c:ae:4a:9a:9b:00:cb:f9:fe:f8:b9:a3:f3:58:80:b9:0f:\n             35:91:43:f8:f4:83:a6:b2:f6:f3:d7:50:cc:19:8e:b8:0f:df:\n             4a:c2:31:18:c8:6d:38:39:09:c5:be:c7:64:61:5c:14:35:9c:\n             e8:31:bb:86:cd:c7:aa:a2:0f:4b:c1:7c:ef:3a:c4:d2:3e:48:\n             14:5f:62:9d:50:97:91:f9:16:41:b6:29:6a:4d:50:9b:c9:25:\n             84:82:52:6d\n\nCurl and NSS versions\n=\n    $ curl --version\n    curl 7.66.0 (x86_64-pc-linux-gnu) libcurl/7.66.0 NSS/3.46.1 zlib/1.2.7\n    Release-Date: 2019-09-11\n    Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s rtsp smb smbs smtp smtps telnet tftp \n    Features: AsynchDNS HTTPS-proxy IPv6 Largefile libz NTLM NTLM_WB SSL UnixSockets\n\nTest\n=\n    $ curl \\\n        --cacert /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem \\\n        --verbose \\\n        --head \\\n        https://192.168.124.2/RHEL-7.4-20170711.0-Server-x86_64-boot.iso\n\n    *   Trying 192.168.124.2:443...\n    * TCP_NODELAY set\n    * Connected to 192.168.124.2 (192.168.124.2) port 443 (#0)\n    * Initializing NSS with certpath: sql:/etc/pki/nssdb\n    *   CAfile: /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\n      CApath: none\n    * ALPN/NPN, server did not agree to a protocol\n    * SSL connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n    * Server certificate:\n    *       subject: CN=192.168.124.2\n    *       start date: Oct 17 12:52:20 2019 GMT\n    *       expire date: Nov 16 12:52:20 2019 GMT\n    *       common name: 192.168.124.2\n    *       issuer: E=lersek@redhat.com,CN=Laszlo Ersek CA,OU=Certificate Authority,O=Laszlo Ersek Home Office,L=Budapest,ST=Pest,C=HU\n    \u003e HEAD /RHEL-7.4-20170711.0-Server-x86_64-boot.iso HTTP/1.1\n    \u003e Host: 192.168.124.2\n    \u003e User-Agent: curl/7.66.0\n    \u003e Accept: */*\n    \u003e\n    * Mark bundle as not supporting multiuse\n    \u003c HTTP/1.1 200 OK\n    HTTP/1.1 200 OK\n    \u003c Date: Thu, 17 Oct 2019 13:02:07 GMT\n    Date: Thu, 17 Oct 2019 13:02:07 GMT\n    \u003c Server: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.2k-fips\n    Server: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.2k-fips\n    \u003c Last-Modified: Tue, 11 Jul 2017 05:01:59 GMT\n    Last-Modified: Tue, 11 Jul 2017 05:01:59 GMT\n    \u003c ETag: \"1c800000-5540399693fc0\"\n    ETag: \"1c800000-5540399693fc0\"\n    \u003c Accept-Ranges: bytes\n    Accept-Ranges: bytes\n    \u003c Content-Length: 478150656\n    Content-Length: 478150656\n    \u003c Content-Type: application/octet-stream\n    Content-Type: application/octet-stream\n\n    \u003c\n    * Connection #0 to host 192.168.124.2 left intact\n","automated_response":false,"created_at":"2019-10-17T13:11:41.247Z","updated_at":"2019-10-17T13:11:41.247Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6065052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for taking the time and effort to confirm this.\n\nThe [NSS API documentation](https://www-archive.mozilla.org/projects/security/pki/nss/ref/ssl/sslfnc.html#1088888) seriously and truly suck, but I've tried to read up on details that could mention if we would need to do anything special to make it do or not do this but I've found nothing of that sort.\n\nI'm now thinking: is this an NSS bug?","automated_response":false,"created_at":"2019-10-17T13:56:08.529Z","updated_at":"2019-10-17T13:56:08.529Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6065091,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm now instead questioning how \"wrong\" this is. It seems IP address in the CN field \"is a thing\" done for compatibility with old legacy systems.\n\n[geocerts.com](https://www.geocerts.com/support/ip-address-in-ssl-certificate) seems to offer it. \n\n[leaderssl.com](https://www.leaderssl.com/articles/381-issuing-ssl-certificate-for-an-ip-address) says this (emphasis added by me):\n\n\u003e There are some problems with handling iPAddress in the SAN in Windows prior to version 10. To cope with these issues, **you must add an IP address to the outdated commonName field** of the X.509 v.3 certificate. If the certificate contains an IP address in the SAN extension with iPAddress and in commonName, then the certificate check will succeed. It is worth noting that downside of this implementation is inability to include multiple IP addresses in the common name of single certificate. \n\n[globalsign.com](https://support.globalsign.com/customer/en/portal/articles/1216536-securing-a-public-ip-address---ssl-certificates) says:\n\n\u003e If you are targeting Windows 10 and later, you can populate the IP address in either field. If however, you are targeting Windows 8.1 and earlier, you should only specify the IP address as the common name.","automated_response":false,"created_at":"2019-10-17T14:04:11.576Z","updated_at":"2019-10-17T14:04:11.576Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6065738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bagder I'd like David to comment on both questions :) (i.e. whether the behavior is due to an issue in NSS, and/or the behavior is actually expected for compatibility).\n\nShould David register in this bug tracker first, for you to invite him to this ticket?\n\nRegarding the second and third references (leaderssl.com and globalsign.com, respectively): the leaderssl.com language is quite alright, because if a certificate carries the IP address in both the CN (textually) and in the SAN.iPAddress (numerically), then both old Windows clients and new (strict) clients will (allegedly) to accept it.\n\nHowever, the globalsign.com language renders it dead in the water: *If however, you are targeting Windows 8.1 and earlier, you should __only__ specify the IP address as the common name*. (Emphasis mine.) Thus, if an organization intends to enable older Windows clients to access their site over HTTPS, they *can't* conform to the strict SAN.iPAddress requirement. And so if curl insisted on that kind of verification, it couldn't fetch those pages :(\n\nThis is terrible.","automated_response":false,"created_at":"2019-10-17T15:10:38.541Z","updated_at":"2019-10-17T15:11:18.318Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6065819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"David got an email that should let him join here and access this issue. I'm not exactly sure what he needs to do for that but I've invited other people in other issues in the past without problems so I figure it is fairly straight forward.\n\nI think this issue is about supporting legacy systems or actually servers that are setup to support legacy systems so probably NSS and other TLS libraries still do this because this habit is still present on the web.\n\nI don't think this is strictly speaking a curl problem in the case of NSS since NSS is the one doing the certificate verification for us and we just gets an \"OK\" from it back. We *might* have the same issue with the OpenSSL backend though and in that case we \"own\" the problem since the verification code is ours. Since the OpenSSL backend is also the *by far* most popular and widely used code with curl, that could be worth checking out too. (Basically nobody is using curl with NSS anymore since Redhat abandoned it in later Fedora/Red Hat versions.)","automated_response":false,"created_at":"2019-10-17T15:19:11.169Z","updated_at":"2019-10-17T15:19:11.169Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6065869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OpenSSL is definitely affected; David is fixing that problem in OpenSSL itself, so that applications can continue using plain `SSL_set1_host()`.\n\nhttps://github.com/openssl/openssl/pull/9201\n\nIt now worries me though that the PR above will cause OpenSSL to reject server certificates that *intentionally* carry the IP address in the CN only, for compatibility with Windows clients up to 8.1. Sigh.","automated_response":false,"created_at":"2019-10-17T15:25:30.500Z","updated_at":"2019-10-17T15:25:30.500Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6065914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"curl is not using the OpenSSL name verifiction code though (I figure maybe it should, if a new enough OpenSSL is used), so even if OpenSSL changes curl might still be affected...","automated_response":false,"created_at":"2019-10-17T15:31:18.571Z","updated_at":"2019-10-17T15:31:18.571Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6066057,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For checking (fresh) curl with the (fresh) OpenSSL backend, can I use a Fedora 30 virtual machine? Is that recent enough? @kdudka what's your take on that?\n\n(I'd like to avoid building \u0026 testing another upstream library that's also a system library... I know how to deal with `C_INCLUDE_PATH`, `LIBRARY_PATH`, `LD_LIBRARY_PATH` etc, but it's still a mess, and an invalid test result (due to the test application linking against an old system library) is always a concern.)","automated_response":false,"created_at":"2019-10-17T15:49:01.114Z","updated_at":"2019-10-17T15:49:01.114Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6066302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lersek-rh I am just a package maintainer (and occasional upstream contributor).  I would suggest to reach out to our TLS/crypto experts at Red Hat.  If the issue is not confidential, rhel-crypto@redhat.com is the appropriate channel for such questions, secalert@redhat.com otherwise.","automated_response":false,"created_at":"2019-10-17T16:22:09.258Z","updated_at":"2019-10-17T16:22:09.258Z","actor":{"username":"kdudka","cleared":false,"url":"/kdudka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6066903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e For checking (fresh) curl with the (fresh) OpenSSL backend, can I use a Fedora 30 virtual machine\n\nOh certainly that'll be perfect. Since the check is done by curl code, the exact OpenSSL version is less important.","automated_response":false,"created_at":"2019-10-17T17:39:59.028Z","updated_at":"2019-10-17T17:39:59.028Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6070458,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-10-18T07:07:22.480Z","updated_at":"2019-10-18T07:07:22.480Z","actor":{"username":"dwmw2","cleared":false,"url":"/dwmw2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6070483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have no great objection to accepting an IP address in a CN, for legacy reasons.\nWhat would be a problem is *not* accepting the IP address if it's only present as an `iPAddress` in the SAN.","automated_response":false,"created_at":"2019-10-18T07:16:16.365Z","updated_at":"2019-10-18T07:16:16.365Z","actor":{"username":"dwmw2","cleared":false,"url":"/dwmw2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6071778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e What would be a problem is not accepting the IP address if it's only present as an iPAddress\n\nThanks! Yes that would indeed be wrong. But such an omission would also feel more like a regular bug than a security flaw since it would probably rather deny otherwise perfectly fine certificates. Like perhaps for \"https://1.1.1.1\" ...","automated_response":false,"created_at":"2019-10-18T09:37:42.997Z","updated_at":"2019-10-18T09:37:42.997Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6074342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kdudka I emailed secalert in parallel with this report; they have the ID of this ticket. The downstream ticket is #498367; if you'd like to join that, I might try to add you.\n\n@bagder I originally started filing this bug at https://github.com/curl/curl/issues -- as suggested by David --, but there the ticket template said, \"if this is security related, please use hackerone.com instead\". I had my reservations about that (we had been discussing the topic for a week or so on the open edk2-devel list, after all...), but I figured \"better safe than sorry\"...\n\nI'll report back with the Fedora 30 results soon.","automated_response":false,"created_at":"2019-10-18T15:11:44.139Z","updated_at":"2019-10-18T15:11:44.139Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6074834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On an up-to-date Fedora (edit: Fedora 30) installation:\n\n    $ curl --version\n\n    curl 7.65.3 (x86_64-redhat-linux-gnu) libcurl/7.65.3 OpenSSL/1.1.1d-fips\n    zlib/1.2.11 brotli/1.0.7 libidn2/2.2.0 libpsl/0.20.2 (+libidn2/2.0.5)\n    libssh/0.9.0/openssl/zlib nghttp2/1.39.2\n    Release-Date: 2019-07-19\n    Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps\n    pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp\n    Features: AsynchDNS brotli GSS-API HTTP2 HTTPS-proxy IDN IPv6 Kerberos\n    Largefile libz Metalink NTLM NTLM_WB PSL SPNEGO SSL TLS-SRP UnixSockets\n\nand\n\n    $ curl --silent -v -I \\\n        https://192.168.124.2/RHEL-7.4-20170711.0-Server-x86_64-boot.iso\n\n    *   Trying 192.168.124.2:443...\n    * TCP_NODELAY set\n    * Connected to 192.168.124.2 (192.168.124.2) port 443 (#0)\n    * ALPN, offering h2\n    * ALPN, offering http/1.1\n    * successfully set certificate verify locations:\n    *   CAfile: /etc/pki/tls/certs/ca-bundle.crt\n      CApath: none\n    } [5 bytes data]\n    * TLSv1.3 (OUT), TLS handshake, Client hello (1):\n    } [512 bytes data]\n    * TLSv1.3 (IN), TLS handshake, Server hello (2):\n    { [89 bytes data]\n    * TLSv1.2 (IN), TLS handshake, Certificate (11):\n    { [849 bytes data]\n    * TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n    { [333 bytes data]\n    * TLSv1.2 (IN), TLS handshake, Server finished (14):\n    { [4 bytes data]\n    * TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n    } [70 bytes data]\n    * TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):\n    } [1 bytes data]\n    * TLSv1.2 (OUT), TLS handshake, Finished (20):\n    } [16 bytes data]\n    * TLSv1.2 (IN), TLS handshake, Finished (20):\n    { [16 bytes data]\n    * SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n    * ALPN, server did not agree to a protocol\n    * Server certificate:\n    *  subject: CN=192.168.124.2\n    *  start date: Oct 17 12:52:20 2019 GMT\n    *  expire date: Nov 16 12:52:20 2019 GMT\n    *  common name: 192.168.124.2 (matched)\n    *  issuer: C=HU; ST=Pest; L=Budapest; O=Laszlo Ersek Home Office;\n    OU=Certificate Authority; CN=Laszlo Ersek CA;\n    emailAddress=lersek@redhat.com\n    *  SSL certificate verify ok.\n    } [5 bytes data]\n    \u003e HEAD /RHEL-7.4-20170711.0-Server-x86_64-boot.iso HTTP/1.1\n    \u003e Host: 192.168.124.2\n    \u003e User-Agent: curl/7.65.3\n    \u003e Accept: */*\n    \u003e\n    { [5 bytes data]\n    * Mark bundle as not supporting multiuse\n    \u003c HTTP/1.1 200 OK\n    \u003c Date: Fri, 18 Oct 2019 15:27:07 GMT\n    \u003c Server: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.2k-fips\n    \u003c Last-Modified: Tue, 11 Jul 2017 05:01:59 GMT\n    \u003c ETag: \"1c800000-5540399693fc0\"\n    \u003c Accept-Ranges: bytes\n    \u003c Content-Length: 478150656\n    \u003c Content-Type: application/octet-stream\n    \u003c\n    * Connection #0 to host 192.168.124.2 left intact\n    HTTP/1.1 200 OK\n    Date: Fri, 18 Oct 2019 15:27:07 GMT\n    Server: Apache/2.4.6 (Red Hat Enterprise Linux) OpenSSL/1.0.2k-fips\n    Last-Modified: Tue, 11 Jul 2017 05:01:59 GMT\n    ETag: \"1c800000-5540399693fc0\"\n    Accept-Ranges: bytes\n    Content-Length: 478150656\n    Content-Type: application/octet-stream\n","automated_response":false,"created_at":"2019-10-18T15:31:46.991Z","updated_at":"2019-10-18T15:33:01.134Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6074920,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I respect and appreciate your \"better safe than sorry\" reaction. That's healthy and sound!\n\nHowever, I don't think I can view this as a security problem now after what we've seen and learned here. It seems clear that some certificates still use IP numbers in the CN field and expect (some) clients to work with that. That is the explanation why NSS and curl's OpenSSL code supports that.\n\nDoes anyone disagree with that?","automated_response":false,"created_at":"2019-10-18T15:41:02.063Z","updated_at":"2019-10-18T15:41:02.063Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6088198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Although I am not an expert in this area, I agree with @bagder.","automated_response":false,"created_at":"2019-10-21T05:57:45.925Z","updated_at":"2019-10-21T05:57:45.925Z","actor":{"username":"kdudka","cleared":false,"url":"/kdudka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6089232,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Considered not to be a security issue.","automated_response":false,"created_at":"2019-10-21T07:35:44.425Z","updated_at":"2019-10-21T07:35:44.425Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6094879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm OK with this resolution. Thanks.","automated_response":false,"created_at":"2019-10-21T12:13:34.451Z","updated_at":"2019-10-21T12:13:34.451Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10302513,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-08T08:20:59.542Z","updated_at":"2021-01-08T08:20:59.542Z","first_to_agree":true,"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/y9xzl5ayi7du4kz3l6pa6sff2ha5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22final-12-1000x1000.jpg%22%3B%20filename%2A%3DUTF-8%27%27final-12-1000x1000.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151952Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a9316647ce4342179cf0ea78e530a23f1a9c8e40fe7be5ed5ea168398c7d0b10"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10303185,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Agree to disclosing this report; per badger's comment dated 21 Oct 2019, \"Considered not to be a security issue\". Thanks.","automated_response":false,"created_at":"2021-01-08T09:18:29.511Z","updated_at":"2021-01-08T09:18:29.511Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10303186,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-08T09:18:29.559Z","updated_at":"2021-01-08T09:18:29.559Z","actor":{"username":"lersek-rh","cleared":false,"url":"/lersek-rh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}