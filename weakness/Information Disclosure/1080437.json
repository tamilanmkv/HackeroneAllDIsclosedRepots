{"id":1080437,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDgwNDM3","url":"https://hackerone.com/reports/1080437","title":"Bumble API exposes read status of chat messages","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-01-17T18:39:23.945Z","submitted_at":"2021-01-17T18:39:23.992Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ndrong","url":"/ndrong","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21554,"url":"https://hackerone.com/bumble","handle":"bumble","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bumble","twitter_handle":"bumble","website":"https://bumble.com/","about":"Bumble - Date, Meet, Network Better"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-03-13T10:49:49.910Z","bug_reporter_agreed_on_going_public_at":"2021-02-11T10:49:49.633Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\nThe Bumble app allows matches to chat with each other. In the mobile apps it is possible to see whether a message has been delivered (the webapp does not offer this feature), but the read status of messages is never disclosed. However, by issuing a POST request to the API endpoint at `https://am1.bumble.com/mwebapi.phtml?SERVER_OPEN_CHAT`, it is possible for users to retrieve the read status of individual message within all their chats.\n\n# Steps to reproduce\n1. Log in to the webapp at `https://bumble.com`.\n2. Use an intercepting proxy (e.g. Burp Suite) to record traffic between the client and the server.\n3. Open an existing chat.\n4. Looking at the traffic log, notice an outgoing POST request to `https://am1.bumble.com/mwebapi.phtml?SERVER_OPEN_CHAT`, retrieving the chat messages from the backend.\n5. Observe the response to the aforementioned request: it contains an array of `chat_messages`, where each `badoo.bma.ChatMessage` contains a boolean key `read`, displaying the read status of the message.\n\n# Screenshots\n**Chat A as shown in the iOS app**  *(\"bezorgd\" is Dutch for \"delivered\")*\n{F1161099}\n\n**Chat B as shown in the iOS app**  *(\"bezorgd\" is Dutch for \"delivered\")*\n{F1161098}\n\n**Request (and response) for chat A, showing that it has not been read by the other user**\n{F1161096}\n\n**Request (and response) for chat B, showing that it has been read by the other user**\n{F1161097}\n\n## Impact\n\nThe Bumble app implies that the read status of messages is not shared with others, due to the fact that it shows a \"delivered\" status below messages, while never showing a read status. Due to the information disclosure in the aforementioned API endpoint, users may view the read status of all messages within their chats, potentially violating the privacy of the user on the other end (who most likely expects this information to be kept private).","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-03-13T10:49:49.725Z","allow_singular_disclosure_after":-18325995.788146622,"singular_disclosure_allowed":true,"vote_count":69,"voters":["ec0","moloshy","lowtoe","foobar7","th4nu_0x0","prakash142","ali","realtess","ms-13","0nlymohammed","and 59 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":60620,"asset_type":"URL","asset_identifier":"bma.bumble.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":10397587,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @ndrong and thanks for your report,\n\nDo I need a live match to reproduce this or could you do it with a test account as well? If you could do it with a test account, can you please tell me how to set it up?\n\nBest regards,\n@turtle_shell","automated_response":false,"created_at":"2021-01-18T08:54:18.582Z","updated_at":"2021-01-18T08:54:18.582Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10399680,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @turtle_shell,\n\nThanks for your response!\nI'm afraid you'll need a live match to reproduce this (as far as I can tell from the functionality of the app). I suppose it would be possible to create two test accounts to facilitate this, but you'd have to swipe on the accounts until both have 'liked' each other, which is probably a bit cumbersome (as it would be a manual process)... If there's anything I can do to help in reproducing this, please do let me know!\n\nBest,\n\nNoam","automated_response":false,"created_at":"2021-01-18T13:02:40.429Z","updated_at":"2021-01-18T13:02:40.429Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10409214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ndrong I think it will be easier if I send this one to the team. I had to wait 1 month for my first match with my personal account :(\n\nBest regards,\n@turtle_shell","automated_response":false,"created_at":"2021-01-19T14:44:03.956Z","updated_at":"2021-01-19T14:44:03.956Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":10410675,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey.\nThank you for the report.\nWe are on this and will be updating you once our internal investigation finishes.\n","automated_response":false,"created_at":"2021-01-19T16:34:08.142Z","updated_at":"2021-01-19T16:34:08.142Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10634773,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello.\nWe managed to fix the issue. Please, confirm this from your side.\nThank you for helping us to be secure.\nGood luck in bug hunting!","automated_response":false,"created_at":"2021-02-10T13:32:13.699Z","updated_at":"2021-02-10T13:32:13.699Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bumble"}},"bounty_amount":"600.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"bumble","collaborator":{"username":"ndrong","url":"/ndrong"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10634774,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2021-02-10T13:32:28.621Z","updated_at":"2021-02-10T13:32:28.621Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ndrong","url":"/ndrong"},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10643309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @turtle_shell and @uyga,\n\nThanks for the swift triaging and the bounty!\nI just checked and can confirm that the issue has been patched by always returning a read status of `false` for chat messages.\n\nBest,\n\nNoam","automated_response":false,"created_at":"2021-02-11T10:48:34.474Z","updated_at":"2021-02-11T10:48:34.474Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10643315,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@uya","automated_response":false,"created_at":"2021-02-11T10:49:49.660Z","updated_at":"2021-02-11T10:49:49.660Z","first_to_agree":true,"actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10643317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Apologies, I made a typo and accidentally posted the disclosure request before I could fix it... Apparently I can't edit the comment so here goes attempt no. 2:\n\n@uyga, mind if we go for a limited disclosure (i.e. only the hacker summary and, if you wish, a summary by Bumble)?","automated_response":false,"created_at":"2021-02-11T10:51:36.116Z","updated_at":"2021-02-11T10:51:36.116Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10643342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ndrong \n\nWe are perfectly fine with the limited disclosure of this finding from your side. \nMay I just ask you to provide the exact disclosure text before you publish it?\n\nRegards.","automated_response":false,"created_at":"2021-02-11T10:57:24.017Z","updated_at":"2021-02-11T10:57:24.017Z","actor":{"username":"41414141","cleared":false,"url":"/41414141","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10643368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @41414141,\n\nThanks for your quick reply!\nOf course, I've added a short text to the 'hacker summary' at the top of the report just now.\nIf you'd like to add anything, just let me know!\n\nBest,\n\nNoam","automated_response":false,"created_at":"2021-02-11T11:02:47.139Z","updated_at":"2021-02-11T11:02:47.139Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10645201,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ndrong\n\nThank you, that looks good. Feel free to disclose.\n\nRegards.","automated_response":false,"created_at":"2021-02-11T13:42:23.860Z","updated_at":"2021-02-11T13:42:23.860Z","actor":{"username":"41414141","cleared":false,"url":"/41414141","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10646095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @41414141! I already requested disclosure for this report, I believe it is now up to you to accept 'limited disclosure', see also: https://docs.hackerone.com/programs/disclosure.html :)\n\nBest,\n\nNoam","automated_response":false,"created_at":"2021-02-11T14:50:47.679Z","updated_at":"2021-02-11T14:50:47.679Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10901220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @41414141 and team,\n\nThis report is pending automatic dislocure within 7 days. Could you verify whether limited disclosure is enabled for this report? If not, could you enable this before disclosure?\n\nLooking forward to your response!\n\nBest,\n\nNoam","automated_response":false,"created_at":"2021-03-06T13:33:00.486Z","updated_at":"2021-03-06T13:33:00.486Z","actor":{"username":"ndrong","cleared":false,"url":"/ndrong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10982231,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-13T10:49:49.971Z","updated_at":"2021-03-13T10:49:49.971Z","actor":{"url":"/bumble","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/554/13fb93fae5496e8e259a0f2a2fba3a72ca10550b_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Bumble"}},"genius_execution_id":null,"team_handle":"bumble","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":26602,"category":"researcher","content":"The Bumble app allows matches to chat with each other. In the mobile apps it is possible to see whether a message has been delivered (the webapp does not offer this feature), but the read status of messages is never disclosed. However, by issuing a POST request to an API endpoint, it was possible for users to retrieve the read status of individual messages within all of their chats. Bumble has resolved this issue by always returning a read status of `false`, regardless of the actual read status of a message.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":1253508,"username":"ndrong","name":"Noam Drong","bio":"","cleared":false,"website":"https://n04m.nl","location":"","created_at":"2020-07-19T18:03:33.101Z","url":"https://hackerone.com/ndrong","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/6xaBrLrypy1SPQHCFR4UWQAs/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}