{"id":1173411,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTczNDEx","url":"https://hackerone.com/reports/1173411","title":"Nextcloud update checks leaks information","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2021-04-23T18:40:54.418Z","submitted_at":"2021-04-23T18:40:54.452Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rtod","url":"/rtod","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-05-01T10:53:03.940Z","bug_reporter_agreed_on_going_public_at":"2021-05-01T10:49:53.263Z","team_member_agreed_on_going_public_at":"2021-05-01T10:53:03.861Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI think this is more of a privacy concern than a security concern. However I wanted to check here first. Please direct me to an other suitable location if needed.\n\nIt is in relation to https://github.com/nextcloud/server/blob/master/lib/private/Updater/VersionCheck.php#L78\n\nThis is sending several things related to servers to Nextcloud. Especially the 'installedat' seems to have a very high likely hood to be unique for an instance. Allowing Nextcloud to track instances when doing the requests.\n\nI especially wonder why you chose this method here. Instead of the 'appstore' approach were you just have an big blob and have the server figure everything out.\n\nOther than that I could not find any mention about what data is send to Nextclouds servers and why.  One could argue that pinging the updates.nextcloud.com has a legitimate reason. However I doubt that regarding the more track sensitive information. And even then it would be OK if you'd communicate about this clearly.\n\nAgain sorry if this is the wrong place. But I didn't wanna post this publicly if it is in any way sensitive.\n\n## Impact\n\nThis could potentially cause legal issues if you are sending data that is not needed and identifiable.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["wi11","rzx007x","ekgaribadmi"],"severity":{"rating":"none","author_type":"User"},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11494888,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2021-04-23T18:40:55.587Z","updated_at":"2021-04-23T18:40:55.587Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11511490,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have filed an internal ticket for this and will get back to you once we have more information about the expected behaviour.","automated_response":false,"created_at":"2021-04-26T10:17:07.047Z","updated_at":"2021-04-26T10:17:07.047Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11587163,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I've reached out to the internal stakeholders and they clarified that this is used for staggered release rollouts and no personal data is being stored. They will however be working on documenting this behaviour.\n\nThe verbatim message from the team:\n\n\u003e You are right, this is pretty much a unique identifier of servers. We mostly use this to do our staggered roll-outs of new releases (see https://nextcloud.com/release-channels and https://github.com/nextcloud/updater_server). As the server installation time stamp is not personal data nor related to it, nor do we store it with IP addresses (we don't store those at all), we don't think this violates any compliance rules.\n\u003e\n\u003e It does help us know how the roll-out of security updates is going, allowing us to make informed decisions around security breaches and responsible disclosure for example.\n\u003e\n\u003e However, it does make sense to improve documentation of this. We'll be working on adding a note to the documentation.","automated_response":false,"created_at":"2021-05-01T10:02:44.944Z","updated_at":"2021-05-01T10:02:44.944Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11587342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Like I said. there might be good reasons for this.\nHowever I would expect better from Nextcloud (as privacy etc are big statements on your part).\n\n1. Adding documentation is a good idea I think\n2. Allowing users to opt out would be better\n3. Alternatively having randomization here. So that the values that are send change every 3 months or so. That way you can still do your stages rollouts. But there are no tracking worries anymore.\n\nIn any case thanks for the explanation.","automated_response":false,"created_at":"2021-05-01T10:49:44.380Z","updated_at":"2021-05-01T10:49:44.380Z","actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11587344,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-01T10:49:53.295Z","updated_at":"2021-05-01T10:49:53.295Z","first_to_agree":true,"actor":{"username":"rtod","cleared":false,"url":"/rtod","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11587355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-05-01T10:53:03.887Z","updated_at":"2021-05-01T10:53:03.887Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11587356,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-05-01T10:53:03.984Z","updated_at":"2021-05-01T10:53:03.984Z","actor":{"username":"lukasreschkenc","cleared":false,"url":"/lukasreschkenc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}