{"id":1276373,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjc2Mzcz","url":"https://hackerone.com/reports/1276373","title":"Information disclosure -\u003e 2fa bypass -\u003e POST exploitation ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-07-23T18:33:23.314Z","submitted_at":"2021-07-23T18:33:23.387Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akashhamal0x01","url":"/akashhamal0x01","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":443,"url":"https://hackerone.com/algolia","handle":"algolia","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Algolia","twitter_handle":"algolia","website":"https://algolia.com","about":"Hosted search API that delivers instant and relevant results from the first keystroke"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-09-08T13:40:42.147Z","bug_reporter_agreed_on_going_public_at":"2021-09-06T09:20:41.932Z","team_member_agreed_on_going_public_at":"2021-09-08T13:40:42.026Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Greetings!\n\nSo i was testing algolia.com. Impressed to find out that there are mitigations in place to prevent POST exploitation such as : \n\nWhen 2fa is enabled we need \"old password\"  to update following things : \n\n- To update the password\n- To disable the 2fa, etc (might more more....)\n\nAnd we need 2fa codes to do following actions : \n\n- To change email\n- To download recovery codes \n- To delete account, etc (might be more...)\n\nSo given these security checks, even if an account is compromised ( attacker don't know password or have access to 2fa or anything but only access to account)\n\nFor example, just consider a scene that the victim is  using your website in cyber cafe and forgets to for example logout.\n\nSo the attacker will check all functionalities to make victims account his/her but provided that he/she needs to have either access to 2fa or know password then he/she will be helpless. So now attacker starts to find vulnerabilities in website!\n\nSo here i found that the \"gauth_secret\" is potentially leaked in response (which is not normal and is unnecesarry to leak), which means that the attacker who got access to the account can take advantage of this information leakage , use that \"gauth_secret\" value in authenticator app and then bypass the checks by providing the correct codes!\n\nSo this way an attacker can bypass authentication and execute critical actions like :\n\n- updating mail , deleting acc , etc\n\n# Steps to reproduction :\n\nfirst login into algolia.com and then \n\n- Go to \"https://www.algolia.com/account/support\" \n- There will be 2 buttons : \"Revoke\" and \"Renew\", click on \"Renew\" and intercept that request using proxy like burp suite\n- Now  send that request to repeater and forward that request\n-  In repeater, replay the request and check response and look for \"gauth_secret\" and then copy the value of that key\n- download google authenticator app and then paste it , then it will show the codes\n- Now u can execute actions as you know the 2fa codes now!\n\n## Impact\n\nSince there are checks implemented for every critical action , i think the leakage of \"gauth_secret\" here let attacker bypass those checks by knowing 2fa\n\nSo now the attacker can delete account, update email and do much more critical actions and totally compromise victims account\n\n\nSolution : Don't leak the gauth_secret in response","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-10-06T09:20:42.050Z","allow_singular_disclosure_after":-447330.878312598,"singular_disclosure_allowed":true,"vote_count":67,"voters":["run_win","fqdn","sudi","realtess","sodium_","burhan__xd","hotmuffin","akashhamal0x01","01alsanosi","ganofins","and 57 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":310,"asset_type":"URL","asset_identifier":"www.algolia.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":12652999,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As a reference : https://hackerone.com/reports/699082","automated_response":false,"created_at":"2021-07-23T18:50:16.406Z","updated_at":"2021-07-23T18:50:16.406Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12659129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"another reference : https://hackerone.com/reports/970157","automated_response":false,"created_at":"2021-07-24T12:08:13.248Z","updated_at":"2021-07-24T12:08:13.248Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12659243,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also do adjust the severity because it bypasses critical checks!","automated_response":false,"created_at":"2021-07-24T12:36:33.935Z","updated_at":"2021-07-24T12:36:33.935Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12706252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi team, its been 4 days. is there any initial response? ","automated_response":false,"created_at":"2021-07-28T01:44:00.226Z","updated_at":"2021-07-28T01:44:00.226Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12707963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @akashhamal0x01,\n\nThank you for your report, we are looking into it.\n\nCheers,","automated_response":false,"created_at":"2021-07-28T07:27:23.879Z","updated_at":"2021-07-28T07:27:23.879Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12708569,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-07-28T08:34:12.181Z","updated_at":"2021-07-28T08:34:12.181Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12812882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @stephanej been long is there any update?","automated_response":false,"created_at":"2021-08-03T23:33:44.582Z","updated_at":"2021-08-03T23:33:44.582Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12821555,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @akashhamal0x01,\n\nWe are still working on it. I'll reward you in the meantime.\n\nCheers,","automated_response":false,"created_at":"2021-08-04T12:27:35.381Z","updated_at":"2021-08-04T12:27:35.381Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12821563,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for helping us identifying this issue!","automated_response":false,"created_at":"2021-08-04T12:28:10.563Z","updated_at":"2021-08-04T12:28:10.563Z","actor":{"url":"/algolia","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/443/6dc48cd913e21beebc873e81aaf28fd3b6b9e12e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Algolia"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"algolia","collaborator":{"username":"akashhamal0x01","url":"/akashhamal0x01"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12821596,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@stephanej, thanks for the update and bounty :). Looking forward towards resolution!","automated_response":false,"created_at":"2021-08-04T12:31:41.698Z","updated_at":"2021-08-04T12:31:41.698Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12821825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@stephanej also do disclose this report fully when the issue is resolved! thanks again","automated_response":false,"created_at":"2021-08-04T13:00:36.382Z","updated_at":"2021-08-04T13:00:36.382Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13023423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @stephanej i re-checked and the issue has been resolved as i no longer can see google auth token being leaked in response :). Looking forward to hear from you!","automated_response":false,"created_at":"2021-08-17T02:41:45.896Z","updated_at":"2021-08-17T02:41:45.896Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13331431,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @akashhamal0x01, indeed, the fix was pushed in production on Aug 9th.","automated_response":false,"created_at":"2021-09-06T09:18:49.019Z","updated_at":"2021-09-06T09:18:49.019Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"akashhamal0x01","url":"/akashhamal0x01"},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13331459,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"hi @stephanej full disclosure please :), would be glad!","automated_response":false,"created_at":"2021-09-06T09:20:41.960Z","updated_at":"2021-09-06T09:20:41.960Z","first_to_agree":true,"actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13332282,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@stephanej can we disclose it now? since the issue has been fixed there is no point of waiting for 30 days for disclosure :) hope you understand :D","automated_response":false,"created_at":"2021-09-06T09:49:27.312Z","updated_at":"2021-09-06T09:49:27.312Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13363153,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@stephanej any update on disclosure?","automated_response":false,"created_at":"2021-09-08T09:28:39.839Z","updated_at":"2021-09-08T09:28:39.839Z","actor":{"username":"akashhamal0x01","cleared":false,"url":"/akashhamal0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13368113,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-09-08T13:40:42.055Z","updated_at":"2021-09-08T13:40:42.055Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13368114,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-08T13:40:42.195Z","updated_at":"2021-09-08T13:40:42.195Z","actor":{"username":"stephanej","cleared":false,"url":"/stephanej","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"algolia","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}