{"id":152834,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTI4MzQ=","url":"https://hackerone.com/reports/152834","title":"[gratipay.com] Cross Site Tracing","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-07-21T09:18:17.365Z","submitted_at":"2016-07-21T09:18:17.365Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahsan","url":"/ahsan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-21T13:32:01.664Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-07-21T12:25:08.883Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Hello team,**\n\nI was checking if TRACE method is enabled on gratipay.com or not? I opened up my terminal (CLI) and executed this command: curl -v -X TRACE http://gratipay.com\n\nThe response may not actually shows it is vulnerable, but it is not as well a message for properly configured \"no\" to Cross Site Tracing attack.\n\nAnd it showed up this response:\n```\n*   Trying 54.235.170.226...\n* Connected to gratipay.com (54.235.170.226) port 80 (#0)\n\u003e TRACE / HTTP/1.1\n\u003e Host: gratipay.com\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Server: gunicorn\n\u003c Date: Thu, 21 Jul 2016 09:15:54 GMT\n\u003c X-Frame-Options: SAMEORIGIN\n\u003c Cache-Control: no-cache\n\u003c X-Xss-Protection: 1; mode=block\n\u003c Location: https://gratipay.com/\n\u003c X-Content-Type-Options: nosniff\n\u003c X-Gratipay-Version: 1977\n\u003c Via: 1.1 vegur\n\u003c X-Cache: MISS from cache1\n\u003c X-Cache-Lookup: NONE from cache1:8080\n\u003c Transfer-Encoding: chunked\n\u003c Connection: keep-alive\n\u003c\n* Connection #0 to host gratipay.com left intact\n```\n\n**While, it should show this error**\n```\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e405 Not Allowed\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ccenter\u003e\u003ch1\u003e405 Not Allowed\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003enginx\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n##PoC\nWe can inject headers in the response:\n\n_Command:_ `curl -v -X TRACE -H \"Header: value=Testing\" http://gratipay.com/`\n\n_Response:_\n```\n*   Trying 54.235.170.226...\n* Connected to gratipay.com (54.235.170.226) port 80 (#0)\n\u003e TRACE / HTTP/1.1\n\u003e Host: gratipay.com \n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e Header: value=Testing --\u003e *** YOU CAN SEE HEADER INJECTED***\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Server: gunicorn\n\u003c Date: Thu, 21 Jul 2016 09:17:01 GMT\n\u003c X-Frame-Options: SAMEORIGIN\n\u003c Cache-Control: no-cache\n\u003c X-Xss-Protection: 1; mode=block\n\u003c Location: https://gratipay.com/\n\u003c X-Content-Type-Options: nosniff\n\u003c X-Gratipay-Version: 1977\n\u003c Via: 1.1 vegur\n\u003c X-Cache: MISS from cache1\n\u003c X-Cache-Lookup: NONE from cache1:8080\n\u003c Transfer-Encoding: chunked\n\u003c Connection: keep-alive\n\u003c\n* Connection #0 to host gratipay.com left intact\n```\n\nFor more information: https://www.owasp.org/index.php/Cross_Site_Tracing\n\n*Cheers,\nAhsan*","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["leet-boy","an0nym0us"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1079896,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi ahsantahirat, \n\nThanks for you report. Since the header you provided is not present in the response and that we are redirecting any HTTP request to the HTTPS website (`Location: https://gratipay.com/` in the response), which forbids the TRACE method, I don't think we are vulnerable anymore. If you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\n\nI'm closing this as duplicate of the original report about this issue.\n\nThanks for making Gratipay a safer place!","automated_response":false,"created_at":"2016-07-21T10:57:20.986Z","updated_at":"2016-07-21T10:57:20.986Z","original_report_id":109054,"actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nothing more, but may I ask, why did I loss -5 reputation? #109054 is resolved, I should get +2?","automated_response":false,"created_at":"2016-07-21T11:40:51.697Z","updated_at":"2016-07-21T11:40:51.697Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Your report is Closed as Duplicate (Resolved and Public at time of submission): -5\ncf. https://hackerone.com/blog/introducing-reputation\n\nNote that an easy way to see the list of the disclosed reports is to go on http://inside.gratipay.com/appendices/disclosures. It's automatically updated :-)","automated_response":false,"created_at":"2016-07-21T11:44:38.987Z","updated_at":"2016-07-21T11:44:38.987Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nashe_, I saw that report before I reported this! And I thought that you will also fix this in HTTP, as you've fixed in HTTPS.","automated_response":false,"created_at":"2016-07-21T11:47:20.114Z","updated_at":"2016-07-21T11:47:20.114Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079990,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What is the reasoning that makes you think it needs to be fixed in HTTP?","automated_response":false,"created_at":"2016-07-21T11:48:42.146Z","updated_at":"2016-07-21T11:48:42.146Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079992,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, it properly works in cURL","automated_response":false,"created_at":"2016-07-21T11:49:26.288Z","updated_at":"2016-07-21T11:49:26.288Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1079993,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"And as a best practice too!","automated_response":false,"created_at":"2016-07-21T11:49:39.993Z","updated_at":"2016-07-21T11:49:39.993Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080066,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The PoC is not working: you tell that \"*We can inject headers in the response:*\" but no additional header can be found in the response, there is not data in the body… everything is showing that the TRACE request has no effect at all (anyway, the goal is not to inject headers in the response). We're just redirecting everything to the HTTPS service.\n\nAs far I know, a vulnerable service would at least return something different while submitting different inputs, since that's this behaviour which is desired (like returning the request in the body of the response). \n\nI don't think that returning a specific message even if we are not vulnerable is a \"best practice\", we are already doing the redirection to the real service which is not vulnerable too. That's why I'm closing as \"Duplicate\".\n\nThis is the same scenario than in your reports #151302, #142465… you are reporting non-applicable issues that has already been publicly disclosed, please understand I can't mark this issue as \"Reported\" just to maintain your reputation high, more especially because of the [HackTheWorld2016](https://hackerone.com/hacktheworld/2016). \n\nI'll close as \"Informative\" for this time, but if you don't try to make applicable reports in the future, I'll be forced to mark them as \"Not applicable\", resulting effectively in more reputation loss. ","automated_response":false,"created_at":"2016-07-21T12:24:15.872Z","updated_at":"2016-07-21T12:24:15.872Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080067,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2016-07-21T12:24:23.090Z","updated_at":"2016-07-21T12:24:23.090Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080068,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Closing as \"Informative\", as stated.","automated_response":false,"created_at":"2016-07-21T12:25:02.046Z","updated_at":"2016-07-21T12:25:02.046Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080069,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-21T12:25:08.910Z","updated_at":"2016-07-21T12:25:08.910Z","first_to_agree":true,"actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for changing the status to Informative\n\n\u003e\u003e you tell that \"We can inject headers in the response:\" but no additional header can be found in the response\n\nCommand:\n`curl -v -X TRACE -H \"myHeader: value=Testing\" http://www.gratipay.com`\n\nResponse:\n```\n* Connected to www.gratipay.com (54.235.170.226) port 80 (#0)\n\u003e TRACE / HTTP/1.1\n\u003e Host: www.gratipay.com\n\u003e User-Agent: curl/7.49.1\n\u003e Accept: */*\n\u003e myHeader: value=Testing\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Server: gunicorn\n\u003c Date: Thu, 21 Jul 2016 12:34:25 GMT\n\u003c X-Frame-Options: SAMEORIGIN\n\u003c Cache-Control: no-cache\n\u003c X-Xss-Protection: 1; mode=block\n\u003c Location: https://gratipay.com/\n\u003c X-Content-Type-Options: nosniff\n\u003c X-Gratipay-Version: 1977\n\u003c Via: 1.1 vegur\n\u003c X-Cache: MISS from cache1\n\u003c X-Cache-Lookup: NONE from cache1:8080\n\u003c Transfer-Encoding: chunked\n\u003c Connection: keep-alive\n\u003c\n* Connection #0 to host www.gratipay.com left intact\n```\n\nmyHeader is injected! Just for clarification. :)","automated_response":false,"created_at":"2016-07-21T12:35:09.345Z","updated_at":"2016-07-21T12:35:09.345Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1080093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Injected in the request, yes? ","automated_response":false,"created_at":"2016-07-21T12:36:05.362Z","updated_at":"2016-07-21T12:36:05.362Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1095179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for wasting your time! My mistake :)","automated_response":false,"created_at":"2016-07-29T13:55:27.570Z","updated_at":"2016-07-29T13:55:45.963Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1095239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries, it's not a waste of time ;-)","automated_response":false,"created_at":"2016-07-29T14:28:22.355Z","updated_at":"2016-07-29T14:28:22.355Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1095249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":":)","automated_response":false,"created_at":"2016-07-29T14:31:30.105Z","updated_at":"2016-07-29T14:31:30.105Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1943375,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2017-08-21T13:32:01.631Z","updated_at":"2017-08-21T13:32:01.631Z","actor":{"username":"edio","cleared":false,"url":"/edio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/501/c186a057285438756d4c4d27cbf3b8965cf1f51b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}