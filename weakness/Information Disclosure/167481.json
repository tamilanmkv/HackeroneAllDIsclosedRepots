{"id":167481,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjc0ODE=","url":"https://hackerone.com/reports/167481","title":"Android - Possible to intercept broadcasts about uploaded files","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-11T00:49:12.872Z","submitted_at":"2016-09-11T00:49:12.872Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bagipro","url":"/bagipro","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-23T17:12:48.422Z","bug_reporter_agreed_on_going_public_at":"2017-03-23T17:12:48.390Z","team_member_agreed_on_going_public_at":"2017-03-23T16:53:18.902Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi.\nThere are the moments of sending unprotected broadcasts\nhttps://github.com/nextcloud/android/blob/master/src/com/owncloud/android/files/services/FileUploader.java#L1170\nhttps://github.com/nextcloud/android/blob/master/src/com/owncloud/android/files/services/FileUploader.java#L1116\nhttps://github.com/nextcloud/android/blob/master/src/com/owncloud/android/files/services/FileUploader.java#L1136\nhttps://github.com/nextcloud/android/blob/600225c7c9684295bfdb43bcf7d078113b8b2f73/src/com/owncloud/android/services/SyncFolderHandler.java#L186\nhttps://github.com/nextcloud/android/blob/600225c7c9684295bfdb43bcf7d078113b8b2f73/src/com/owncloud/android/services/SyncFolderHandler.java#L201\netc\nA malware can simply create a receiver:\n```xml\n\u003creceiver android:exported=\"true\" android:enabled=\"true\" android:name=\".InterceptReceiver\"\u003e\n\t\u003cintent-filter android:priority=\"999\"\u003e\n\t\t\u003caction android:name=\"FileUploader.UPLOAD_START\"/\u003e\n\t\t\u003caction android:name=\"FileUploader.UPLOAD_FINISH\"/\u003e\n\t\t\u003caction android:name=\"FileUploader.UPLOADS_ADDED\"/\u003e\n\t\u003c/intent-filter\u003e\n\u003c/receiver\u003e\n```\n(and other actions)\nAnd receive the broadcasts **first** than your own receivers\nMore info about priority here\nhttps://developer.android.com/guide/topics/manifest/intent-filter-element.html#priority\n\nIt will disclose info about account, file info, etc\n\nThe one thing you should do is to change all calls of ```Context.sendStickyBroadcast``` on ```LocalBroadcastManager.sendBroadcast``` and all calls of ```Context.registerReceiver``` on ```LocalBroadcastManager.registerReceiver```\nhttps://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html\ninstead on using ```removeStickyBroadcast(intent);```\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-22T16:53:18.928Z","allow_singular_disclosure_after":-141080195.40548104,"singular_disclosure_allowed":true,"vote_count":15,"voters":["kapytein","alesandroortiz","sheikhrishad0","nipe","prob0x01","eveeez","sumit7","spetr0x","muhaddix","alxg","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1186841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2016-09-11T00:49:13.199Z","updated_at":"2016-09-11T00:49:13.199Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1190938,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. We'll analyze this and get back later to you.","automated_response":false,"created_at":"2016-09-13T13:44:02.467Z","updated_at":"2016-09-13T13:44:02.467Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1250003,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. Any movements?","automated_response":false,"created_at":"2016-10-16T20:19:28.294Z","updated_at":"2016-10-16T20:19:28.294Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1406301,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi! No changes?","automated_response":false,"created_at":"2017-01-07T15:51:59.782Z","updated_at":"2017-01-07T15:51:59.782Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for the report and the patience. You are right - I just have to think if your proposed solution is best or if we should go with setPackage on the intent level. Thank you very much - this will be fixed in the upcoming bugfix release.","automated_response":false,"created_at":"2017-02-10T18:02:50.810Z","updated_at":"2017-02-10T18:02:50.810Z","actor":{"username":"mdjanic","cleared":false,"url":"/mdjanic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477780,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. I believe that using LocalBroadcastManager is the best solution, because it's the easiest one. You have to make less changes to achieve the same result","automated_response":false,"created_at":"2017-02-10T19:27:04.913Z","updated_at":"2017-02-10T19:27:04.913Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, no changes?","automated_response":false,"created_at":"2017-03-23T16:33:37.854Z","updated_at":"2017-03-23T16:33:37.854Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed already.","automated_response":false,"created_at":"2017-03-23T16:35:44.013Z","updated_at":"2017-03-23T16:35:44.013Z","actor":{"username":"mdjanic","cleared":false,"url":"/mdjanic","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559798,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. As per our Android Team this should have been resolved in the 1.4.2 release. The change can be found at https://github.com/nextcloud/android/pull/662. ","automated_response":false,"created_at":"2017-03-23T16:50:28.565Z","updated_at":"2017-03-23T16:50:28.565Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559799,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Unfortunately, this does not qualify for a monetary award as per our [bug bounty policy](https://hackerone.com/nextcloud): \n\n\u003e Bugs in the Nextcloud Android client (Download / Source Code) (__we do exclude bugs that do require the existence of another malicious app on the system__)\n\nHowever, we'd be happy to offer you some swags as a token of appreciation. Please apologize again for the long delay on our end to get this resolved.","automated_response":false,"created_at":"2017-03-23T16:51:48.068Z","updated_at":"2017-03-23T16:51:48.068Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559801,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2017-03-23T16:52:24.137Z","updated_at":"2017-03-23T16:52:24.137Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559802,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2017-03-23T16:52:35.229Z","updated_at":"2017-03-23T16:52:35.229Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559803,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2017-03-23T16:52:42.120Z","updated_at":"2017-03-23T16:52:42.120Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bagipro","url":"/bagipro"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559804,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2017-03-23T16:52:50.653Z","updated_at":"2017-03-23T16:52:50.653Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559805,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-23T16:53:18.914Z","updated_at":"2017-03-23T16:53:18.914Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559839,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-23T17:12:48.406Z","updated_at":"2017-03-23T17:12:48.406Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559840,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-23T17:12:48.434Z","updated_at":"2017-03-23T17:12:48.434Z","actor":{"username":"bagipro","cleared":true,"url":"/bagipro","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}