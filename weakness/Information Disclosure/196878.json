{"id":196878,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTY4Nzg=","url":"https://hackerone.com/reports/196878","title":"bug reporting template encourages users to paste config file with passwords","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-09T12:40:38.155Z","submitted_at":"2017-01-09T12:40:38.155Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hanno","url":"/hanno","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-19T08:10:18.555Z","bug_reporter_agreed_on_going_public_at":"2017-04-19T08:10:18.517Z","team_member_agreed_on_going_public_at":"2017-04-05T09:46:23.350Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The dangerous bug reporting template\n=============================\n\nThe github bug reporting template for nextcloud's server and some apps contains this:\n\n**The content of config/config.php:**\n\n```\nIf you have access to your command line run e.g.:\nsudo -u www-data php occ config:list system\nfrom within your instance's installation folder\n\nor \n\nInsert your config.php content here\n(Without the database password, passwordsalt and secret)\n```\n\nThis is obviously very problematic. From the wording and instructions it is very likely that users will do the wrong thing: Paste the config.php without removing all passwords, for various reasons:\n* It's likely to assume that many users won't read the detailed instructions and will just do the first thing they're told: Insert the content of config/config.php.\n* The instruction with sudo and www-data is specific to certain server configurations and may not work everywhere, thus it will fail for some users who will try the next option, namely inserting config.php directly.\n* The instruction \"Without the database password, passwordsalt and secret\" is incomplete. There can be more sensitive fields in the config file, e.g. \"mail_smtppassword\".\n\nNot surprisingly users misread these instructions and paste sensitive passwords. See e.g.:\nhttps://github.com/nextcloud/calendar/issues/151\nhttps://github.com/nextcloud/calendar/issues/155\n\nProposed remediation\n=================\n\nI think it's necessary that you search all existing bug reports that have been created with this template for sensitive passwords and remove them. It is probably also appropriate to inform the affected users.\n\nI also believe encouraging users to paste a config file with passwords is inherently dangerous and no amount of warnings will prevent all users from making mistakes. In general I think it should always be a guiding principle of software design to make it hard for users to make security mistakes.\n\nThere are various ways the situation could be improved, this is what I could think of:\n* Provide a way in the webinterface to let users view a version of the config file where all sensitive values are removed (like the command line instruction, but more accessible).\n* Change the instruction and avoid all references to pasting the raw config file content. If there's a need to get the config file in rare circumstances a developer could ask a bug reporter for it, ideally via private channels and only post a manually vetted version to the bug report.\n\nLeakage of instanceid\n=================\n\nOne additional observation: The \"occ config:list\" command removes dbpassword, secret and mail_smtppassword, but it leaves instanceid intact. I'm not familiar enough to judge how sensitive this value is, but it seems to be an unique identifier for each owncloud installation. It would probably be wise to remove that, too.\n\nAffects owncloud and nextcloud\n========================\n\nThis issue affects the development of both owncloud and nextcloud in the same way. Thus I will report it to both projects.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-05T09:46:23.388Z","allow_singular_disclosure_after":-139983191.74253935,"singular_disclosure_allowed":true,"vote_count":10,"voters":["geeknik","eveeez","mariuszpoplawski","khizer47","linkks","japz","sumit7","spetr0x","mrr3boot","dolph1n"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1408286,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2017-01-09T12:40:38.268Z","updated_at":"2017-01-09T12:40:38.268Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1413205,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. We've discussed this internally and will come up with a Nextcloud application that allows exporting the required data in the near future.","automated_response":false,"created_at":"2017-01-11T10:30:04.045Z","updated_at":"2017-01-11T10:30:04.045Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1413209,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Since this is not a vulnerability per se in our software we can't award a monetary reward for it at the moment though.","automated_response":false,"created_at":"2017-01-11T10:30:34.687Z","updated_at":"2017-01-11T10:30:34.687Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1481784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I plan to disclose this issue eventually. Given that this needs some coordination, I'm hereby announcing that I plan to disclose this for both own/nextcloud three months after the initial report (which makes it April 9th).\n\nIt is currently not clear to me how you plan to remedy this. I feel it's especially important that you make sure no past bug reports contain sensitive data and I suggest you do that before disclosure.","automated_response":false,"created_at":"2017-02-13T10:46:30.832Z","updated_at":"2017-02-13T10:46:30.832Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1489482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, @hanno. We're in the moment working on a bug reporting application that automatically sanitises potential private information. In addition, we'll write an automated scanner to check on all existing issues for leaked information and will act accordingly in case we find sensitive configuration values.\n\nI'll keep you updated on this one.","automated_response":false,"created_at":"2017-02-16T16:27:41.915Z","updated_at":"2017-02-16T16:27:41.915Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1559338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The disclosure date I set is nearing and I still don't see any action on this. Please note that search engine caches may reveal passwords even after they've been removed, so deleting the sensitive data shouldn't be a last day before disclosure action.","automated_response":false,"created_at":"2017-03-23T13:07:09.620Z","updated_at":"2017-03-23T13:07:09.620Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1580016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Apologize, for the delayed response on this. We had a hack week last week which kinda made the actual reply go under. But we did spend significant time on investigating that.\n\nHowever, please let me remark:\n\n1. We did act on this issue. In fact, 10 days ago we added a small script that searches for sensitive issues and we've redacted them. (https://github.com/nextcloud/github_helper/tree/efbe77cbde107b59b6bfcb95d081cc083af44b72/sensitive-issue-searcher). We found in total 23 occurences back then. Furthermore, we plan to integrate this script in our CI steps. \n2. We have adjusted the issue template yesterday to prominently highlight such issues: https://github.com/nextcloud/server/pull/4189\n3. We have prominently highlighted the issue template application and improved it which automatically prefills the configuration.\n\nSo while we did not reply super quickly on this one to you. Publicly claiming we did nothing is far from the truth either…","automated_response":false,"created_at":"2017-04-03T10:20:33.849Z","updated_at":"2017-04-03T10:21:16.174Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1581614,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update.\n\nI'm still seeing a couple of issues that include passwords where I'm not sure if they're real or what users have replaced:\nhttp://github.com/nextcloud/server/issues/2046\nhttps://github.com/nextcloud/server/issues/919\nhttps://github.com/nextcloud/server/issues/1854\nhttps://github.com/nextcloud/server/issues/2399\n\nI'd propose to just replace all unclear values following dbpassword and mail_smtppassword with something that's clearly a replacement value.","automated_response":false,"created_at":"2017-04-03T20:23:38.290Z","updated_at":"2017-04-03T20:23:38.290Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let me comment on those:\nhttps://github.com/nextcloud/server/issues/919:\n```php\n   'overwrite.cli.url' =\u003e 'https://my.oc.com',\n   'dbtype' =\u003e 'mysql',\n   'version' =\u003e '9.1.0.15',\n   'dbname' =\u003e 'owncloud',\n   'dbhost' =\u003e 'localhost',\n   'dbtableprefix' =\u003e 'own_',\n   'dbuser' =\u003e 'mydbuser',\n   'dbpassword' =\u003e '██████',\n```\n=\u003e replaced everything with my* (see url), therefor ████████ is mostlikely also a replacement.\n\nhttps://github.com/nextcloud/server/issues/919:\n```php\n  'dbname' =\u003e 'asasf',\n  'dbhost' =\u003e 'localhost',\n  'dbtableprefix' =\u003e '',\n  'dbuser' =\u003e 'asdasdf',\n  'dbpassword' =\u003e '███████',\n```\n=\u003e all values have been replaced with asdf key row values, therefor █████ is mostlikely also a replacement. Assumption is backed up by the fact that the user is a fulltime employee...\n\nhttps://github.com/nextcloud/server/issues/1854\n```php\n'instanceid' =\u003e '***********_',\n'passwordsalt' =\u003e '**_***********_',\n'secret' =\u003e '**_*******_',\n```\n=\u003e generated values have been replaced with the same characters as the db and smtp password,  therefor passwords are mostlikely also a replacement.\n\nhttps://github.com/nextcloud/server/issues/2399\n=\u003e is also a replacement (confirmed via office communication since I also wondered back then) and also the automatically set values (similar as report above) are also replaced with foobar.\n\nI never the less replaced the words with our famous `***REMOVED SENSITIVE VALUE***` value.","automated_response":false,"created_at":"2017-04-04T08:22:28.096Z","updated_at":"2017-04-05T09:08:23.790Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1584494,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The issue template has been adjusted on all repositories with the following changes:\n1. The first thing in the \"Server configuration\" section is to promote the issue template app:\nhttps://github.com/nextcloud/activity/blame/master/issue_template.md#L20-L22\n2. The section has been renamed to \"Nextcloud configuration\" and the text has been adjusted:\nhttps://github.com/nextcloud/activity/blame/master/issue_template.md#L52-L63\n\nTogether with the cleaning of the found issues from you and us, I see this issue as resolved...\n","automated_response":false,"created_at":"2017-04-05T09:01:46.012Z","updated_at":"2017-04-05T09:01:46.012Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1584535,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again.\n\n","automated_response":false,"created_at":"2017-04-05T09:45:29.067Z","updated_at":"2017-04-05T09:45:29.067Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hanno","url":"/hanno"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1584536,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-05T09:46:23.370Z","updated_at":"2017-04-05T09:46:23.370Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1587496,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Owncloud has asked for an additional week before disclosure and I've agreed to that. So tentative disclosure date would be april 17th.","automated_response":false,"created_at":"2017-04-06T17:34:32.029Z","updated_at":"2017-04-06T17:34:32.029Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public now\nhttps://blog.hboeck.de/archives/885-Passwords-in-the-Bug-Reports-OwncloudNextcloud.html\nhttps://www.golem.de/news/owncloud-nextcloud-passwoerter-im-bugtracker-1704-127346.html","automated_response":false,"created_at":"2017-04-19T08:10:18.533Z","updated_at":"2017-04-19T08:10:18.533Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1620293,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-19T08:10:18.570Z","updated_at":"2017-04-19T08:10:18.570Z","actor":{"username":"hanno","cleared":false,"url":"/hanno","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/918/74da560ef66bf8cc239e219843444b441a7dfac6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3817,"category":"team","content":"@hanno reported an issue within the Nextcloud bug reporting template on GitHub, the original template asked persons to paste their configuration file and had a notice that sensitive content such as the database password should be removed. The reporter argued that this was not good enough and that he discovered issues containing user credentials.\n\nWe've checked all reported issues and found **a total of 23 occurrences** of passwords within tickets. Those have been redacted. Also, we've adjusted the issue template to make this more clear and are offering an issue template application which automatically fills out and sanitizes sensitive information.\n\nWe want to thank @hanno for reporting this back to us and help protecting our millions of users. We want however to note, that this affected an absolute minimum of users.\n\n----\nPress article (German): https://www.golem.de/news/owncloud-nextcloud-passwoerter-im-bugtracker-1704-127346.html\nPersonal blog (English):  https://blog.hboeck.de/archives/885-Passwords-in-the-Bug-Reports-OwncloudNextcloud.html\nTweet: https://twitter.com/hanno/status/848832642653073412","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":37891,"username":"lukasreschke","name":"Lukas Reschke","bio":"","cleared":false,"website":"https://statuscode.ch","location":"Switzerland","created_at":"2015-08-05T13:37:40.660Z","url":"https://hackerone.com/lukasreschke","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBaFlXIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--247fe95a40e99ca7d18708743afb883e8a4441f1/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/878997_(1).png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}