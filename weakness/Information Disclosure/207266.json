{"id":207266,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDcyNjY=","url":"https://hackerone.com/reports/207266","title":"Information leakage via CSV when content is valid JavaScript","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-18T05:31:54.750Z","submitted_at":"2017-02-18T05:31:54.750Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mikkocarreon","url":"/mikkocarreon","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-23T14:44:32.654Z","bug_reporter_agreed_on_going_public_at":"2017-05-23T14:44:32.604Z","team_member_agreed_on_going_public_at":"2017-05-23T00:07:56.960Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe function \"**Download as CSV**\" might leak information to 3rd domains. The exploitation seems unlikely and purely theoretical but it might work in some cases. \n\n**Description (Include Impact):**\nTake downloading payments as CSV, for example, which is recently launched. The response to \nhttps://hackerone.com/settings/bounties.csv\nreturns CSV which is indeed, a comma separated values. There is a field which is influenced by user input i.e. report_title.\nAnd, as we all know, `script` inclusions are exempt from SOP. So, if the returned CSV forms valid JavaScript, it's possible that we can read information.\n\n### Steps To Reproduce\nFor demonstration;\nI created an HTML page as follows;\n```html\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cmeta charset='utf-8'/\u003e\n    \u003cscript\u003e\n        var report_id,report_title,program_name,total_amount,amount,bonus_amount,currency,awarded_at,status;\n    \u003c/script\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cscript src='https://hackerone.com/settings/bounties.csv'\u003e\u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\nAnd, edited returned response (using BurpSuite) as follows;\n```JavaScript\nreport_id,report_title,program_name,total_amount,amount,bonus_amount,currency,awarded_at,status\n████████\n████\n█████████\n████████\n██████\n████████\n```\n\nSo, what I did is added ```=` ```  right after first word of first report. Similarly added ``` `//``` right after last word of last report.\nThis makes it a valid JavaScript, and `XSS` a valid variable which now have all details in it. \n\n### Optional: Your Environment (Browser version, Device, etc)\nFirefox version 45.7.0\nUA:  Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0\nSafari may also work.\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-22T00:07:57.002Z","allow_singular_disclosure_after":-135870907.8077989,"singular_disclosure_allowed":true,"vote_count":29,"voters":["sp1d3rs","bogdantcaciuc","spam404","flashdisk","zombiehelp54","ankitsingh","mpz","gamliel","madrobot","supernatural","and 19 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1492609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've made a working POC, but highly customized to my requirements :P\n\nYou should change script src URL to;\nhttps://hackerone.com/reports/207275/export/raw?include_internal_activities=true\n\nI assume the report is visible to you. If not, it wont' work :(\nThen open the document in Firefox or Safari, and when finished loading open your browser's console and type in;\n`duplicate;`","automated_response":false,"created_at":"2017-02-18T06:12:25.543Z","updated_at":"2017-02-18T06:12:25.543Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1495930,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @mikkocarreon,\n\nThis sounds interesting - could you please submit a test report on our programme as a PoC so we can see this in action (with step by step instructions and successful reading of data from the foreign domain?). Please mention I asked you to do this and do not normally use @security for test reports. We do not have access to other programmes data.\n\nCheers!","automated_response":false,"created_at":"2017-02-21T00:52:10.018Z","updated_at":"2017-02-21T00:52:10.018Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1495985,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi asuka,\nI've filed a demo report which is https://hackerone.com/reports/207802\n\nFor demo, you can just visit;\nhttp://request.rootme.in/h1csv.html\n\n\nI've set the param `include_internal_activities` to `false` so that it doesn't result in **Unauthorized**.","automated_response":false,"created_at":"2017-02-21T03:04:19.014Z","updated_at":"2017-02-21T03:06:08.225Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1495998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In case you want a quick fix;\n\\- Switch to POST method\n\nIt's, imo, is best preventive measure. Since this isn't a state changing action, you don't necessarily require an anti-csrf token.","automated_response":false,"created_at":"2017-02-21T03:34:15.377Z","updated_at":"2017-02-21T03:34:15.377Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1500559,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I do not see the report leaked, just a blank page. It looked like the inclusion was blocked due to a MIME-type mismatch as well. Could you please verify this again and provide step-by-step instructions?","automated_response":false,"created_at":"2017-02-23T00:34:35.450Z","updated_at":"2017-02-23T00:34:35.450Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1500625,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi asuka,\n\nAccording to MDN, Safari doesn't support `X-Content-Type-Options`. So, imo, it should work in Safari.\nHowever, you can download and use an older version of Firefox, before 50.\n\nI've already included browser I've tested it on. Your best bet, I think, is to use an older version of Firefox. I'll check it myself with Safari, and will let you know.","automated_response":false,"created_at":"2017-02-23T01:52:50.488Z","updated_at":"2017-02-23T01:52:50.488Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":163006,"filename":"Screenshot_from_2017-02-23_07-28-52.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/163/006/094cdcca1942ad3d5769cc28bcc5182b7cbd0f1f/Screenshot_from_2017-02-23_07-28-52.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2017-02-23_07-28-52.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2017-02-23_07-28-52.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSZC7DXM7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140304Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC%2BDPA%2BSA%2BpuJvH4UEzvWiP4UFbtskzj7xfN6rqlPo4hwIhAOElSqCIqXNISLvxjY33BSsqOOcMi8dDWLDb%2FHD9us3YKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwLzMOGCwg6RS74p74q1wP3%2BrYZeAM77Rmdm64%2BCSKI7bN93GsX7JZ2tRccS6J5LGMRJTs%2By2W6iZRVDq3XbBt0e6p3WHVjfBqyc9ME6wkTlY9d%2Fv3J1DB8BCqWSb%2BRKzvSiDC8qrGE542%2FrwTG4%2F%2F%2B2GZboS%2Bwx6a4S2dscyeGXoZ%2FpJf5Uq70DiwjHjChb4otA36pPHn6Cbuljknt8dm165HwajfM%2FYT9DsRnV1w0OsaZyXvEEhwGsPTVDhkOXnM85nNGqSZ3QDaL%2FFoqr9dtCpsUJbXrXwy5kt3x0oz1dJ01X%2BzIddVtQMPL2ptVZ7U9zvXOF0wODPRFZiOr31TkuvFOSwxvOXUum3Wvfo9vzLL2sp7049bpk2pDp0SX1ErSpZmBqjAE1Syh%2Bgl%2BQXOk5uGw1WkZ%2Bi%2BVM0miZCx%2Fzk0YwCnQVNh8OZjtqzLjisdsfijlbUNbtSb%2F2rqQk5byOsnNd8EOB%2Fk4YSlr9Ml9Z%2FBjM39hyAylCG6PZXUBPl4i%2FIRvue2kJRbtUIpgVYXpDngioq0oVUItMzpWv1Dpeb3i%2BGYq1GpN7Q2SSm%2FKrlHtq%2FAe%2FUyoxvBMaLL9j8sY6VSMaDAw3WBbjN8GeRsrk6lj%2FvPn7De7XtYE3zRUmOhj70LaDvgw%2FfCQiwY6pAEB7X%2FT8tdYZNLCr%2BSBWKV0iIWafrBI43qKIrIcnQBlJSwVNOZ8Gcvl0OoNDa0QYgNpFyVQok8yJDR3W7a4ZqF2ZSs2yTdzPkNqbsgUkg9RTuuVzr%2BJ0IWfPqfOclYjbyvg8xSLdadzgsszfk0wXK8O0D9utoO42Qj4fAyRHUrDx8JxY18uWRPyFpidRfVqDlD%2FMzGvphFE58fBjncDPhIagYIJNw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2bd8c280e0cb8d1b84acd528817f3f663c1112f7eb58e461c89b3fa33ceb168"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1505195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asuka,\nApologies for delay here. Safari for Windows is too old while only versions above 9 support Template literals as said in MDN.\nI hope you're able to reproduce it. Let me know if you have any questions.","automated_response":false,"created_at":"2017-02-25T09:10:12.292Z","updated_at":"2017-02-25T09:10:12.292Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1531513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\nI've confirmed that it works in latest versions of Safari. And, in case, you haven't been able to reproduce the issue, I've prepared a video POC;\nhttps://youtu.be/TTBSjALrtX8\nYou can download previous versions of Firefox from https://ftp.mozilla.org/pub/firefox/releases/.","automated_response":false,"created_at":"2017-03-10T05:41:56.792Z","updated_at":"2017-03-10T05:41:56.792Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1535062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're still looking into this @mikkocarreon, we'll get back to you shortly.","automated_response":false,"created_at":"2017-03-12T02:26:13.558Z","updated_at":"2017-03-12T02:26:13.558Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1569773,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2017-03-29T08:35:51.194Z","updated_at":"2018-02-28T13:11:03.764Z","additional_data":{"added_weaknesses":[{"id":45,"name":"Cross-Site Request Forgery (CSRF)"}],"removed_weaknesses":[{"id":18,"name":"Information Disclosure"}]},"actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1569778,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-03-29T08:36:27.007Z","updated_at":"2017-03-29T08:36:27.007Z","additional_data":{"old_title":"Information leakage via CSV","new_title":"Information leakage via CSV when contents are valid javascript"},"actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1569785,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@mikkocarreon Sorry for our slowness, we're going to fix it!","automated_response":false,"created_at":"2017-03-29T08:37:33.430Z","updated_at":"2017-03-29T08:37:33.430Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1609497,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@mikkocarreon we deployed a fix, can you confirm it doesn't work anymore?","automated_response":false,"created_at":"2017-04-13T12:16:22.520Z","updated_at":"2017-04-13T12:16:22.520Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"mikkocarreon","url":"/mikkocarreon"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1610026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jjoos \nI don't see any changes. I can confirm it's not fixed. Could you please tell me what change I should see?\nRegards,","automated_response":false,"created_at":"2017-04-13T16:59:00.766Z","updated_at":"2017-04-13T16:59:00.766Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1611231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jjoos \nMy apologies, I didn't notice the changes in bounties.csv. There are, however, other places where one can download CSV directly via simple GET request. For example;\nview-source:https://hackerone.com/dashboard/raw.csv?end=2017-04-14\u0026start=2017-01-14\u0026interval=week\nThere may be other I'm unaware of. Though, they may not present any security risks at the moment, future changes in JavaScript or ECMAScript may allow reading such. So, please review it thoroughly.\n\nApart from CSV one, I've also covered raw reports which aren't CSV. Not only CSV but anything that forms valid JavaScript can be leaked crossdomain if it responds to normal GET requests. The POC I've attached shows exactly the same. I'm being able to read reports crossdomain.\nI only saw changes in bounties.csv whereas others are untouched. I can still read reports crossdomain as I've already demonstrated. Please let me know if I'm missing something.\nRegards,","automated_response":false,"created_at":"2017-04-14T08:31:43.765Z","updated_at":"2017-04-14T08:31:43.765Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1628080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates here?","automated_response":false,"created_at":"2017-04-22T12:23:50.721Z","updated_at":"2017-04-22T12:23:50.721Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646094,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't see any user controlled input in the link (the dashboard one) you provided and since this isn't working anymore in newer browser version I don't think it makes sense to change this to all of these url's.\n\n\u003e I only saw changes in bounties.csv whereas others are untouched.\nWhat other urls did you mean, the raw report one? I don't see any realistic exploitation scenario since a report needs to be in a very specific format and that implies the attacker already has control over it.\n\nAre there any other url's that have a realistic attack scenario?","automated_response":false,"created_at":"2017-05-01T08:41:28.560Z","updated_at":"2017-05-01T08:41:28.560Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1646198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jjoos,\n\n\u003e What other urls did you mean, the raw report one? I don't see any realistic exploitation scenario since a report needs to be in a very specific format and that implies the attacker already has control over it.\n\nI agree but if we look back, bounties.csv also didn't have any realistic attack scenario. And, who knows, future changes in JavaScript may allow reading such. \n\nI believe it's trivial to remediate the issue, so why not? Anyway, it's up to your decision. ","automated_response":false,"created_at":"2017-05-01T09:55:47.132Z","updated_at":"2017-05-01T09:55:47.132Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One possible realistic attack scenario I could think of is-\n\\- a user can leak internal members' comments on his/her report\n\nFor example, a user can submit report such that its title ultimately forms a valid JavaScript statement. So, later when the report is closed or whatever, s/he can ask to visit a link where s/he exploits the vulnerability being described. This will disclose internal comments, if any, to reporter. \n\nThis seems practical as user only has to add a backtick in report's title and later close it accordingly. I hope that makes sense. ","automated_response":false,"created_at":"2017-05-01T12:43:26.649Z","updated_at":"2017-05-01T12:43:26.649Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1646394,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"\u003e I agree but if we look back, bounties.csv also didn't have any realistic attack scenario. And, who knows, future changes in JavaScript may allow reading such.\n\nWell you provided one, also as browsers (since this isn't exploitable on the most modern browsers) will become more secure this type of issues will become less important.\n\n\u003e This seems practical as user only has to add a backtick in report's title and later close it accordingly. I hope that makes sense.\n\nAgree that one could still be fixed, I'll create an internal task for it and re-open this report, thank you!","automated_response":false,"created_at":"2017-05-01T13:19:41.284Z","updated_at":"2017-05-01T13:19:41.284Z","actor":{"username":"jjoos","cleared":false,"url":"/jjoos","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/059/21840b8ea35224c071947ddcac0b9eb0801e0235_original.gif/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1680817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see it's fixed now. Nice, you've switched to POST method.","automated_response":false,"created_at":"2017-05-17T16:27:11.617Z","updated_at":"2017-05-17T16:27:11.617Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1684727,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for confirming the fix - we'll get back to you shortly RE: bounty!","automated_response":false,"created_at":"2017-05-18T22:19:34.417Z","updated_at":"2017-05-18T22:19:34.417Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mikkocarreon","url":"/mikkocarreon"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693445,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks, @mikkocarreon, for the report, including the great POC.\n\nAs this only affects old browser versions, we're awarding our minimum bounty, plus an added extra bounty for the POC.\n\nHappy hacking!","automated_response":false,"created_at":"2017-05-23T00:07:01.385Z","updated_at":"2017-05-23T00:07:01.385Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"mikkocarreon","url":"/mikkocarreon"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693446,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I know you preferred not to disclose this report, but our policy is that we publicly disclose all our resolved issues. Please feel free to publish your blog post and update your summary to point to it, though.","automated_response":false,"created_at":"2017-05-23T00:07:56.977Z","updated_at":"2017-05-23T00:07:56.977Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e As this only affects old browser versions, we're awarding our minimum bounty\n\n[Here](https://hackerone.com/reports/207266#activity-1531513), I had confirmed that it worked in latest versions of Safari which, I believe, is the most used browser by HackerOne community. Safari still doesn't support `X-Content-Type-Options`. So, I wouldn't say it required older browser versions.\n\nAnyway, could you please redact my bounties details from initial report? And, I guess, you should also change report title.","automated_response":false,"created_at":"2017-05-23T07:02:52.281Z","updated_at":"2017-05-23T07:04:07.085Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694135,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-05-23T07:54:27.270Z","updated_at":"2017-05-23T07:54:27.270Z","additional_data":{"old_title":"Information leakage via CSV when contents are valid javascript","new_title":"Information leakage via CSV when content is valid JavaScript"},"actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1694140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mikkocarreon, as per your request I redacted the bounty details from the initial report. Feel free to disclose if you're happy with the report in this state, or let me know if there is any other info you'd like to see redacted.","automated_response":false,"created_at":"2017-05-23T07:59:37.729Z","updated_at":"2017-05-23T07:59:37.729Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1695132,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-23T14:44:32.619Z","updated_at":"2017-05-23T14:44:32.619Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1695133,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-23T14:44:32.673Z","updated_at":"2017-05-23T14:44:32.673Z","actor":{"username":"mikkocarreon","cleared":false,"url":"/mikkocarreon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":3784,"category":"researcher","content":"Write-up: https://blog.cm2.pw/h1-xssi/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":134707,"username":"mikkocarreon","name":"Mikko","bio":"","cleared":false,"website":"https://cm2.pw/?..;/foo=bar;/..;/%3csvg/onload=alert%601%60%3e","location":"United Kingdom","created_at":"2017-01-07T11:45:53.813Z","url":"https://hackerone.com/mikkocarreon","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"legacy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}