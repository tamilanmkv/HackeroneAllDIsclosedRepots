{"id":221328,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEzMjg=","url":"https://hackerone.com/reports/221328","title":"HTTP 401 response injection on \"amp.twimg.com/amplify-web-player/prod/source.html\" through \"image_src\" parameter","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-16T05:28:10.070Z","submitted_at":"2017-04-16T05:28:10.070Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zlz","url":"/zlz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vguW8buhDGXNqiNQRoHZFHsN/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-08T17:57:25.706Z","bug_reporter_agreed_on_going_public_at":"2017-05-02T18:16:58.329Z","team_member_agreed_on_going_public_at":"2017-05-08T17:57:25.652Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Overview\n\u003e The `image_src` parameter on `amp.twimg.com` accepts images from any arbitrary host, therefore, enabling attackers to supply image destinations that respond with a \"HTTP 401 Unauthorized\" response.\n\n# Description\n\u003e HTTP 401 attacks occur when there is no whitelisting or proxying images and/or pages that are autoloaded into the page. The issue with these attacks is that (1) users are prompted to enter credentials that are sent to a potentially attacker owned host, and (2) information disclosure concerning the IP address/browser details of the user.\n\n\u003e {F176242}\n\u003e * Here is an example prompt displayed when a user runs this with internet explorer. The website could be changed to something more succeptible, e.x. \"twitler.com\".\n\n# Proof of concept\n\u003e The full URL with the payload included is located here:\nhttps://amp.twimg.com/amplify-web-player/prod/source.html?url=n/a\u0026image_src=https://897theriver.com/admin\u0026player_swf_url=https://897theriver.com/admin\u0026page=amplify_card\n\n### Below are the steps to follow\n\u003e 1. Load the following page on the current Firefox, internet explorer, or Safari version.\n\u003e 1. Modify the \"image_src\" parameter to a page ran by yourself with a 401 response (e.x. http://897theriver.com/admin).\n\u003e 1. Load the page\n\n# Impact\n\u003e Since the victim is not expecting the \"401 Unauthorized\" prompt that forwards credentials to an attacker, he/she will most likely enter their credentials expecting the panel to be owned by Twitter (kind of like iframing a login panel on an XSS). If this were any less severe it would be most likely categorized as \"having too much user interaction\", but since it is very in your face, *enter credentials* I decided to report it.\n\n\u003e This attack could easily be used to gather data and steal accounts.\n\n# Remediation\n\u003e Proxy/whitelist images included on the page. An example script would only allow images from a certain host and/or load the images into twimg (twimg.com/proxy.php?image=remote), then display them to the user.","bounty_amount":"560.0","formatted_bounty":"$560","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":176242,"file_name":"prompt.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/242/6999c8ea3e3b5b64d4c9cecf5b8ccbacc2490142/prompt.PNG?response-content-disposition=attachment%3B%20filename%3D%22prompt.PNG%22%3B%20filename%2A%3DUTF-8%27%27prompt.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=10fcbdaa02f269f456d5c487a7ed6ef9037f10b571331952bdd336c8afd346ab","file_size":13804,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-01T18:16:58.361Z","allow_singular_disclosure_after":-137620202.28727648,"singular_disclosure_allowed":true,"vote_count":29,"voters":["sp1d3rs","thaivu","bogdantcaciuc","bl4de","zlz","jon_bottarini","ashish_r_padelkar","ysx","asad0x01_","bugdiscloseguys","and 19 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1613653,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"# Note\n\u003e {F176244}\n\u003e * To remove the \"insecure warning\" from internet explorer and Firefox simply host the attacker's site with SSL.","automated_response":false,"created_at":"2017-04-16T05:43:53.923Z","updated_at":"2017-04-16T05:43:53.923Z","actor":{"username":"zlz","cleared":true,"url":"/zlz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vguW8buhDGXNqiNQRoHZFHsN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":176244,"filename":"clean.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/176/244/215e07daa7b486136a837e6861f2938cba922ba8/clean.PNG?response-content-disposition=attachment%3B%20filename%3D%22clean.PNG%22%3B%20filename%2A%3DUTF-8%27%27clean.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d0e568d02f21710c785772b79b73991aaed01f1680def189aab2c0cebfc5aca9"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1616788,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-04-17T23:21:16.824Z","updated_at":"2017-04-17T23:21:16.824Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":37018},"actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1616793,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-04-17T23:24:15.437Z","updated_at":"2017-04-17T23:24:15.437Z","actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1649585,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-05-02T18:06:29.568Z","updated_at":"2017-05-02T18:06:29.568Z","actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zlz","url":"/zlz"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1649626,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I can confirm this to be fixed. Public disclosure?","automated_response":false,"created_at":"2017-05-02T18:16:58.343Z","updated_at":"2017-05-02T18:16:58.343Z","first_to_agree":true,"actor":{"username":"zlz","cleared":true,"url":"/zlz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vguW8buhDGXNqiNQRoHZFHsN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1650445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for asking. You can request public disclosure through the drop down following the [public \ndisclosure process](https://support.hackerone.com/hc/en-us/articles/205269479-How-does-public-disclosure-work-).\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-05-02T23:46:39.447Z","updated_at":"2017-05-02T23:46:39.447Z","actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1652911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think my last comment was to request this to be disclosed. Is there a certain time period you'd like to wait, or.. ?","automated_response":false,"created_at":"2017-05-04T03:52:32.360Z","updated_at":"2017-05-04T03:52:32.360Z","actor":{"username":"zlz","cleared":true,"url":"/zlz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vguW8buhDGXNqiNQRoHZFHsN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657568,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2017-05-05T22:20:41.804Z","updated_at":"2017-05-05T22:20:41.804Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"560.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"zlz","url":"/zlz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1657842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks so much! :)","automated_response":false,"created_at":"2017-05-06T04:55:56.843Z","updated_at":"2017-05-06T04:55:56.843Z","actor":{"username":"zlz","cleared":true,"url":"/zlz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vguW8buhDGXNqiNQRoHZFHsN/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1661052,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-05-08T17:57:25.674Z","updated_at":"2017-05-08T17:57:25.674Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1661053,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-05-08T17:57:25.736Z","updated_at":"2017-05-08T17:57:25.736Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}