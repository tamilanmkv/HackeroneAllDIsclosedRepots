{"id":247628,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDc2Mjg=","url":"https://hackerone.com/reports/247628","title":"Reading redacted data via hackbot's answers","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-10T06:40:27.817Z","submitted_at":"2017-07-10T06:40:27.817Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-27T17:27:52.565Z","bug_reporter_agreed_on_going_public_at":"2017-07-27T16:40:08.082Z","team_member_agreed_on_going_public_at":"2017-07-27T17:27:52.428Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHello, I have found a way to use hackbot's automated duplication answers to reveal redacted data via brute force. This is restricted by the length of the report and number of radacted items. For short report with little content and just 1-2 redacted texts this is rather easy to accomplish, but for very long report this is nearly impossible without luck and a lot of time.\n\n\n**Impact**\nBecause hackbot posts comments in order to help customers identify duplicated reports, I wanted to try and see if I can somehow manage to make it disclose other information. I have then seen that the bot identifies duplicated reports from other public reports unrelated to the program. To my surprise, I have then observed that the bot does not identify duplicated reports while using the same redacted text (the black squares), but it has identified the real text that it has already been redacted.\n\nIMO, this is a medium  issue because:\n- Someone actually wanted to hide information form public eyes and this information can be identified AND it does not require any other user's action.\n- This method is not usable in EVERY case and only affects public reports OR reports from the same program.\n\n\n### Steps To Reproduce\n\n1. Create a test program\n2. With a hacker create a submission (example for my test was with subject \"testredact\" and the content \"testredact password is 123456789\".\n3. Login with an admin and redact a certain part of the text (in my test I redacted 123456789)\n4. Login with another hacker and submit a new report while trying to mimic the redacted report\n\nSo, using the data from my tests this has been accomplished :\n- By making a new submission with the same subject, but the content \"testredact password is 123456xxx\", the hackbot told me that the report is 78% the same\n- By making a new submission with the same subject, but the content \"testredact password is 123456781\", the hackbot told me that the report is 88% the same\n- By making a new submission with the same subject, and the same content \"testredact password is 123456789\", the hackbot told me that the report is 100% the same\n\nThis method should also works against public reports that have redacted content and a user can simply create his own test program in order to try and identify redacted text.\n\n__IMO, the hackbot should not try and identify redacted texts__\n\n### Optional: Supporting Material/References (Screenshots)\n\nI have uploaded a screenshot where you can see the 100% and the 88% identified text (last 2 tests from my replication steps)","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":201571,"file_name":"Screenshot_from_2017-07-10_07_46_16.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/571/77427d314e860d86a101343dda855d61f3201a2e/Screenshot_from_2017-07-10_07_46_16.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2017-07-10_07_46_16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2017-07-10_07_46_16.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T142949Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=204c8f089e1164ef42d06a502de05cc915027e3b1a67c7d5f12296b5cf1fa603","file_size":528264,"type":"image/png"}],"allow_singular_disclosure_at":"2017-08-26T16:40:08.197Z","allow_singular_disclosure_after":-130196980.99293838,"singular_disclosure_allowed":true,"vote_count":86,"voters":["jokebookservice1","bug1riage-jobert","jin","rhynorater","tomdev","sp1d3rs","foobar7","mashoud1122","jobert","base_64","and 76 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1819390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @inhibitor181 \n\nInteresting find. I think internal exploitation here is farfetched - redaction is typically used to redact sensitive information before public disclosure. Are you able to reproduce the same behaviour on publicly disclosed reports with redacted information? \n\nCheers!","automated_response":false,"created_at":"2017-07-10T09:52:30.777Z","updated_at":"2017-07-10T09:52:30.777Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1819491,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @asuka .\n\nYes, I am able to do this against public reports with redacted text. I have used as my target the report from https://hackerone.com/reports/239503\n\nThe subject + summary is identical (used the content from export function) and instead of the black squares I bruteforced the `user` parameter and identified the beginning of the username up to 9 chars. As I am in luck, the video from that report actually shows the redacted info and the results of the request validate this.\n\nSo, the requests are like this\n```\nuser=\u0026token= =\u003e (83%) Report #239503 by exr (resolved): Open Redirect \u0026 Information Disclosure [mijn.werkenbijdefensie.nl] (Jun 2017 - 27 days)\n```\n```\nuser=593681\u0026token=s =\u003e (85%) Report #239503 by exr (resolved): Open Redirect \u0026 Information Disclosure [mijn.werkenbijdefensie.nl] (Jun 2017 - 27 days)\n```\n```\nuser=59368126b5\u0026token= =\u003e (87%) Report #239503 by exr (resolved): Open Redirect \u0026 Information Disclosure [mijn.werkenbijdefensie.nl] (Jun 2017 - 27 days)\n```\n\nSo, as you can see the percentage of correctitude goes up","automated_response":false,"created_at":"2017-07-10T10:24:15.409Z","updated_at":"2017-07-10T10:24:15.409Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1828352,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @inhibitor181, what an interesting report.\n\nAs you already mention, the longer the report or comment is, the harder (albeit impossible) it becomes to use this method to identify the redacted information. \n\nHowever, given the fact that the vulnerability *is* present and could be exploited on public reports that meet the required conditions, this definitely warrants a fix. \n\nI have identified the root cause of this issue and we're looking into getting a fix for this out. We'll keep you posted! ","automated_response":false,"created_at":"2017-07-12T13:14:24.746Z","updated_at":"2017-07-12T13:14:24.746Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1835400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We deployed a fix for this issue. Can you confirm that your POC is not working anymore?","automated_response":false,"created_at":"2017-07-14T11:58:00.070Z","updated_at":"2017-07-14T11:58:00.070Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1835426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Heya @tomdev . I tested this again and it seems to be fixed. The redacted strings not taken in consideration anymore and if you try to guess them, you lower your percentage of correctitude even if the guessed chars are correct or not.\n\nAwesome, this really was interesting :)","automated_response":false,"created_at":"2017-07-14T12:04:02.366Z","updated_at":"2017-07-14T12:04:02.366Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1835483,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks @inhibitor181 for pointing out this issue. We will look into the bounty eligibility for this report and come back to you soon.","automated_response":false,"created_at":"2017-07-14T12:24:44.406Z","updated_at":"2017-07-14T12:24:44.406Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1870841,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. While the impact of this vulnerability is limited by the length of the content of the report, you did uncover an underlying issue in the way we were storing search vector data. Investigation turned out that the vulnerability you reported was the only place where we were not updating the redacted information.\n\nBounty decision is based on the potential impact and we've added an additional bonus for the creativity of the report.","automated_response":false,"created_at":"2017-07-27T14:54:09.808Z","updated_at":"2017-07-27T14:54:09.808Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1871000,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thx for the bounty! Do you want to disclose this?","automated_response":false,"created_at":"2017-07-27T16:40:08.125Z","updated_at":"2017-07-27T16:40:08.125Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1871101,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-07-27T17:27:52.477Z","updated_at":"2017-07-27T17:27:52.477Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1871102,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-07-27T17:27:52.629Z","updated_at":"2017-07-27T17:27:52.629Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}