{"id":268382,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjgzODI=","url":"https://hackerone.com/reports/268382","title":"Nginx misconfiguration leading to direct PHP source code download","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-14T15:44:38.882Z","submitted_at":"2017-09-14T15:44:38.882Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-07-29T17:01:53.757Z","bug_reporter_agreed_on_going_public_at":"2018-04-10T01:03:05.484Z","team_member_agreed_on_going_public_at":"2019-07-29T17:01:53.566Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Poc:\nhttps://www.data.gov/app/plugins/saml-20-single-sign-on/saml/config/config.php","vulnerability_information_html":"\u003cp\u003ePoc:\u003cbr\u003e\n\u003ca title=\"https://www.data.gov/app/plugins/saml-20-single-sign-on/saml/config/config.php\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Fapp%2Fplugins%2Fsaml-20-single-sign-on%2Fsaml%2Fconfig%2Fconfig.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/app/plugins/saml-20-single-sign-on/saml/config/config.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":132,"voters":["sp1d3rs","neelponkia","mashoud1122","bl4de","spam404","mik317","sameerphad72","ahiezer","dhakal_ananda","aishkendle","and 122 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":1008,"asset_type":"URL","asset_identifier":"https://data.gov","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1997223,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation. \n\nRegards.\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation. \u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T15:50:29.002Z","updated_at":"2017-09-14T15:50:29.002Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997224,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Description:\n========\ndata.gov uses nginx as the web server. Due to the server misconfiguration, instead of processing the file, the .php source code is send to the client requesting from the direct url.\n\nImpact:\n=====\nattacker can download any .php file on the web leading to huge information about the server. data.gov implement saml (open-source), the config.php file in the saml config folder can be downloaded by the direct url request, it contains sensitive information such as: auth.adminpassword, tecnical contact email, and (possibly) database password.\n\nProblem Analysis:\n===========\n- all the .php files with no closing tag ?\u003e are affected.\n\nRecommendation:\n============\n- review nginx configuration","markdown_message":"\u003ch1 id=\"description\"\u003eDescription:\u003c/h1\u003e\n\n\u003cp\u003edata.gov uses nginx as the web server. Due to the server misconfiguration, instead of processing the file, the .php source code is send to the client requesting from the direct url.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact:\u003c/h1\u003e\n\n\u003cp\u003eattacker can download any .php file on the web leading to huge information about the server. data.gov implement saml (open-source), the config.php file in the saml config folder can be downloaded by the direct url request, it contains sensitive information such as: auth.adminpassword, tecnical contact email, and (possibly) database password.\u003c/p\u003e\n\n\u003ch1 id=\"problem-analysis\"\u003eProblem Analysis:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eall the .php files with no closing tag ?\u0026gt; are affected.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"recommendation\"\u003eRecommendation:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003ereview nginx configuration\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2017-09-14T15:52:58.154Z","updated_at":"2017-09-14T15:52:58.154Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997226,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @tolo7010 \n\nThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/tolo7010\"\u003e@tolo7010\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have validated this issue and forwarded the report to the responsible team for this application. They will evaluate and let us know whether or not they will be implementing a fix.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T15:55:25.109Z","updated_at":"2017-09-14T15:55:25.109Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":" Thank you for your report, the Data.gov is actively investigating. We hope to provide an updated status as soon as we can.","markdown_message":"\u003cp\u003eThank you for your report, the Data.gov is actively investigating. We hope to provide an updated status as soon as we can.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T16:23:59.552Z","updated_at":"2017-09-14T16:23:59.552Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1997837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tolo7010 thank you for your valid report! Can you verify a fix in https://github.com/GSA/datagov-deploy/pull/236 ? Thanks again","markdown_message":"\u003cp\u003e\u003ca href=\"/tolo7010\"\u003e@tolo7010\u003c/a\u003e thank you for your valid report! Can you verify a fix in \u003ca title=\"https://github.com/GSA/datagov-deploy/pull/236\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FGSA%2Fdatagov-deploy%2Fpull%2F236\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/GSA/datagov-deploy/pull/236\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ? Thanks again\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T20:18:08.717Z","updated_at":"2017-09-14T20:18:08.717Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1997920,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jjediny the reproduction doesn't work anymore, fixed confirmed.\n\nRegards,\nTolo","markdown_message":"\u003cp\u003e\u003ca href=\"/jjediny\"\u003e@jjediny\u003c/a\u003e the reproduction doesn\u0026#39;t work anymore, fixed confirmed.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nTolo\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T20:59:37.631Z","updated_at":"2017-09-14T20:59:37.631Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The data.gov team managing triage is separate from bounty team, that said we'd agree with that","markdown_message":"\u003cp\u003eThe data.gov team managing triage is separate from bounty team, that said we\u0026#39;d agree with that\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-14T21:09:41.019Z","updated_at":"2017-09-14T21:09:41.019Z","actor":{"username":"jjediny","cleared":false,"url":"/jjediny","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2009626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nginx misconfiguration was affecting only files within https://www.data.gov/app/plugins/saml-20-single-sign-on/ WordPress plugin.\nThe only place that `auth.adminpassword` could be used is web panel https://www.data.gov/app/plugins/saml-20-single-sign-on/saml/www/ which was never available due to same misconfiguration. After the fix it's returning `403 Access Denied`. All the configuration is done on WordPress Admin side so that `saml/www/` panel is not used at all","markdown_message":"\u003cp\u003eNginx misconfiguration was affecting only files within \u003ca title=\"https://www.data.gov/app/plugins/saml-20-single-sign-on/\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Fapp%2Fplugins%2Fsaml-20-single-sign-on%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/app/plugins/saml-20-single-sign-on/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e WordPress plugin.\u003cbr\u003e\nThe only place that \u003ccode\u003eauth.adminpassword\u003c/code\u003e could be used is web panel \u003ca title=\"https://www.data.gov/app/plugins/saml-20-single-sign-on/saml/www/\" href=\"/redirect?url=https%3A%2F%2Fwww.data.gov%2Fapp%2Fplugins%2Fsaml-20-single-sign-on%2Fsaml%2Fwww%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.data.gov/app/plugins/saml-20-single-sign-on/saml/www/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which was never available due to same misconfiguration. After the fix it\u0026#39;s returning \u003ccode\u003e403 Access Denied\u003c/code\u003e. All the configuration is done on WordPress Admin side so that \u003ccode\u003esaml/www/\u003c/code\u003e panel is not used at all\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T18:21:52.683Z","updated_at":"2017-09-20T18:21:52.683Z","actor":{"username":"kvuppala","cleared":false,"url":"/kvuppala","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2009634,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for your report! We have determined that this is a `High` severity issue, so we will be issuing a $750 bounty. Thanks again for your report and we look forward to more reports from you in the future! ","markdown_message":"\u003cp\u003eThanks for your report! We have determined that this is a \u003ccode\u003eHigh\u003c/code\u003e severity issue, so we will be issuing a $750 bounty. Thanks again for your report and we look forward to more reports from you in the future! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T18:26:38.929Z","updated_at":"2017-09-20T18:26:38.929Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2009647,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Congratulations! This has been resolved. ","markdown_message":"\u003cp\u003eCongratulations! This has been resolved. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T18:32:21.008Z","updated_at":"2017-09-20T18:32:21.008Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2009973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for my first bounty rewarded! it encourages me alot.\n\nRegards.","markdown_message":"\u003cp\u003eThanks for my first bounty rewarded! it encourages me alot.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-20T21:01:19.129Z","updated_at":"2017-09-20T21:01:19.129Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584393,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-10T01:03:05.522Z","updated_at":"2018-04-10T01:03:05.522Z","first_to_agree":true,"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5455533,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-29T17:01:53.606Z","updated_at":"2019-07-29T17:01:53.606Z","actor":{"username":"ryan-ahearn","cleared":false,"url":"/ryan-ahearn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455534,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-29T17:01:53.796Z","updated_at":"2019-07-29T17:01:53.796Z","actor":{"username":"ryan-ahearn","cleared":false,"url":"/ryan-ahearn","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}