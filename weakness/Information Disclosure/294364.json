{"id":294364,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTQzNjQ=","url":"https://hackerone.com/reports/294364","title":"De-anonymization by visiting specially crafted bookmark.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-12-02T00:41:24.597Z","submitted_at":"2017-12-02T00:41:24.597Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"qab","url":"/qab","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-03T04:35:59.675Z","bug_reporter_agreed_on_going_public_at":"2018-07-03T02:57:43.147Z","team_member_agreed_on_going_public_at":"2018-07-03T04:35:59.595Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is a way to import logs in 'about:memory' from local disk, however, (tested on windows) you can pass a network url that may point to attack controlled server which logs IP's. This connection is done by windows (presumably) and so doesn't hide real IP of Tor user.\n\n1. Have victim drag and drop an anchor tag pointing to 'about:memory?file=\\\\localhost\\\\q.json.gz' inside bookmarks bar.\n2. Victim then clicks on bookmark to visit URL.\n3. An unproxied connection is made to 'localhost'\n\n## Impact\n\nDe-anonymization. If coupled with a bug to open privileged pages (which about:memory is) one could theoretically achieve a very dangerous exploit to expose real ips of victims.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-02T02:57:43.207Z","allow_singular_disclosure_after":-100784536.00962028,"singular_disclosure_allowed":true,"vote_count":15,"voters":["test0x00","miguel_santareno","ali","eveeez","an0nym0us","apapedulimu","wragg-s","w00t1","arifkhan","0619","and 5 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2195161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The URL should be 'about:memory?file=\\\\\\localhost\\\\\\q.json.gz' (two slashes each)","automated_response":false,"created_at":"2017-12-02T00:42:59.870Z","updated_at":"2017-12-02T00:42:59.870Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200348,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for this report. This is https://bugzilla.mozilla.org/show_bug.cgi?id=1413868, I believe, and got reported to us a couple of weeks ago. We even paid a bug bounty for that one. The testcase you  have is interesting, though. I guess this is a Windows-only issue or did you get it or a similar trick on other systems to run as well?","automated_response":false,"created_at":"2017-12-04T22:14:04.813Z","updated_at":"2017-12-04T22:14:04.813Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2200882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I only tested on windows so far, network drives may be supported on other OS's from a quick google search. I don't have access to the bug, so I hope this isn't a complete dupe and still worth something. ","automated_response":false,"created_at":"2017-12-05T03:57:00.132Z","updated_at":"2017-12-05T03:57:00.132Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2205149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your bug seems to be a special case of the one reported at Mozilla: the possibility of proxy bypass via SMB URLs which the user gets to paste/bookmark etc (by social engineering). It's a dupe in the sense that the underlying problem is the same, your test case is different though.\n\nI am not sure how I may reward you for that. I think a bounty is out of scope as we already paid a bounty for the underlying bug. What I can do right now is offering you a Tor t-shirt as a special thanks for your bug hunting. Would you want to get one? If so, please shoot me an email (gk[@]torproject[.]org without the brackets) and I'll put you in contact with the right folks.","automated_response":false,"created_at":"2017-12-06T20:48:47.922Z","updated_at":"2017-12-06T20:48:47.922Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2205748,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I understand. Thank you for the offer!","automated_response":false,"created_at":"2017-12-07T01:59:08.233Z","updated_at":"2017-12-07T01:59:08.233Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2205957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May I get access to https://bugzilla.mozilla.org/show_bug.cgi?id=1413868? My bugzilla email is qab@ksu.edu","automated_response":false,"created_at":"2017-12-07T06:12:20.912Z","updated_at":"2017-12-07T06:12:20.912Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2206077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, I added you to the bug.","automated_response":false,"created_at":"2017-12-07T08:15:33.609Z","updated_at":"2017-12-07T08:15:33.609Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2206119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! You can close this bug if you like.","automated_response":false,"created_at":"2017-12-07T08:41:54.166Z","updated_at":"2017-12-07T08:41:54.166Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2274231,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Okay, after thinking about it for a while Iet's call this resolved to help you with your HackerOne reputation. It's resolved in the sense that we'll track this in Mozilla's bug tracker as Firefox is affected as well. Thanks for reporting and looking into Tor Browser, though!","automated_response":false,"created_at":"2018-01-10T07:23:23.508Z","updated_at":"2018-01-10T07:23:23.508Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"qab","url":"/qab"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2274235,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"I set the award to \"Swag\" in the hope you'd at least like to get some Tor swag for your efforts. If that's not the case let us know.","automated_response":false,"created_at":"2018-01-10T07:25:32.369Z","updated_at":"2018-01-10T07:25:32.369Z","actor":{"url":"/torproject","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Tor"}},"reporter":{"username":"qab","url":"/qab"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2977531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I believe this is now fixed according to latest update news in Tor. ","automated_response":false,"created_at":"2018-07-03T02:57:43.171Z","updated_at":"2018-07-03T02:57:43.171Z","first_to_agree":true,"actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2977664,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-07-03T04:35:59.619Z","updated_at":"2018-07-03T04:35:59.619Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2977665,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-07-03T04:35:59.698Z","updated_at":"2018-07-03T04:35:59.698Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6312042,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2019-11-15T07:44:58.709Z","updated_at":"2019-11-15T07:44:58.709Z","actor":{"url":"/torproject","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Tor"}},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}