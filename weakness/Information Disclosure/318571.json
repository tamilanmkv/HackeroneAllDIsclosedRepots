{"id":318571,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTg1NzE=","url":"https://hackerone.com/reports/318571","title":"Imformation Disclosure on id.rapida.ru","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-02-22T14:33:34.824Z","submitted_at":"2018-02-22T14:33:34.824Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"danila","url":"/danila","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-11T09:18:58.446Z","bug_reporter_agreed_on_going_public_at":"2018-05-12T09:18:46.573Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Привет,\nПроисходит раскрытие путей на id.rapida.ru/dp.php\nШаги для воспроизведения:\n1) Перейти на https://id.rapida.ru/login\n2) Попробовать авторизоваться через телефон, ожидая смс-код.\n3) Попробовать ввести не рабочий смс код(любой)\n4) В респонсе можно увидеть пути\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Thu, 22 Feb 2018 14:29:05 GMT\nContent-Type: application/json; charset=utf-8\nContent-Length: 1369\nConnection: close\nVary: Accept-Encoding\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Headers: Content-Type\nAccess-Control-Allow-Methods: POST, OPTIONS\nAccess-Control-Allow-Credentials: true\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\nPragma: no-cache\nContent-Security-Policy-Report-Only: default-src https:; script-src https: 'unsafe-eval' 'unsafe-inline'; style-src https: 'unsafe-inline'; img-src https: data:; font-src https: data:; report-uri /csp-report\nStrict-Transport-Security: max-age=31536000;\n\n{\"status\":\"error\",\"statusMessage\":\"\\u041e\\u0434\\u043d\\u043e\\u0440\\u0430\\u0437\\u043e\\u0432\\u044b\\u0439 \\u043f\\u0430\\u0440\\u043e\\u043b\\u044c \\u0432\\u0432\\u0435\\u0434\\u0435\\u043d \\u043d\\u0435\\u043a\\u043e\\u0440\\u0440\\u0435\\u043a\\u0442\\u043d\\u043e. \\u041d\\u043e\\u0432\\u044b\\u0439 \\u043f\\u0430\\u0440\\u043e\\u043b\\u044c \\u043e\\u0442\\u043f\\u0440\\u0430\\u0432\\u043b\\u0435\\u043d\",\"data\":[],\"time\":0,\"errorCode\":-14,\"version\":\"\"}\u003cbr /\u003e\n\u003cb\u003eWarning\u003c/b\u003e:  file_put_contents(): Only 0 of 4780 bytes written, possibly out of free disk space in \u003cb\u003e/var/www/vhosts/id.rapida.ru/www/backend/Libs/Logger/OLogger.php\u003c/b\u003e on line \u003cb\u003e68\u003c/b\u003e\u003cbr /\u003e\n\u003cbr /\u003e\n\u003cb\u003eFatal error\u003c/b\u003e:  Uncaught exception 'Libs\\Errors\\Exceptions\\OBaseException' with message 'Unable to open log file.' in /var/www/vhosts/id.rapida.ru/www/backend/Libs/Logger/OLogger.php:70\nStack trace:\n#0 /var/www/vhosts/id.rapida.ru/www/backend/Libs/Logger/ODeferredLogger.php(30): Libs\\Logger\\OLogger-\u0026gt;WriteMessage('2018-02-22T17:2...')\n#1 /var/www/vhosts/id.rapida.ru/www/backend/Libs/Logger/OLog.php(37): Libs\\Logger\\ODeferredLogger-\u0026gt;flush()\n#2 /var/www/vhosts/id.rapida.ru/www/backend/Libs/Errors/OHandler.php(66): Libs\\Logger\\OLog::Flush()\n#3 [internal function]: Libs\\Errors\\OHandler-\u0026gt;HandleFatalError()\n#4 {main}\n  thrown in \u003cb\u003e/var/www/vhosts/id.rapida.ru/www/backend/Libs/Logger/OLogger.php\u003c/b\u003e on line \u003cb\u003e70\u003c/b\u003e\u003cbr /\u003e\n```\n\n## Impact\n\nДальнейшая эксплуатация для заливки шела через всякие sql инъекции и.т.д","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":265877,"file_name":"______________(644).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/877/6aaa9a2aa09b9b2107841c0753c626f1bab3e0ed/______________%28644%29.png?response-content-disposition=attachment%3B%20filename%3D%22______________%2528644%2529.png%22%3B%20filename%2A%3DUTF-8%27%27______________%2528644%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144441Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=223756fabb9dabc423271b831fa14dd7c1e0f02730bc01fafa348da56e389672","file_size":168848,"type":"image/png"}],"allow_singular_disclosure_at":"2018-06-11T09:18:46.751Z","allow_singular_disclosure_after":-105254754.95869097,"singular_disclosure_allowed":true,"vote_count":13,"voters":["danila","ali","w2w","zayn1337","eveeez","whitesector","iframe","cryptographer","dolph1n","itnota","and 3 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2421878,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.s Оказывается это не на конкретно это действие, а, видимо, почти на любое. Пример:","automated_response":false,"created_at":"2018-02-22T14:42:48.396Z","updated_at":"2018-02-22T14:42:48.396Z","actor":{"username":"danila","cleared":false,"url":"/danila","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":265878,"filename":"______________(645).png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/878/7c96b378f87d0d8991bbdaf547fee173adf8028e/______________%28645%29.png?response-content-disposition=attachment%3B%20filename%3D%22______________%2528645%2529.png%22%3B%20filename%2A%3DUTF-8%27%27______________%2528645%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144441Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=345e16dcede4ed780f616669f216aed11a1348068f1c5e7ca5d68872d5b87d59"}],"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2434032,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Привет!\nНе удается воспроизвести, есть еще какие-либо рабочие примеры?","automated_response":false,"created_at":"2018-02-26T12:10:00.114Z","updated_at":"2018-02-26T12:10:00.114Z","actor":{"username":"blanche","cleared":false,"url":"/blanche","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2434066,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Привет. А попробуй еще раз :)\n```\nPOST /dp.php HTTP/1.1\nHost: id.rapida.ru\nConnection: close\nContent-Length: 55\nAccept: application/json, text/plain, */*\nOrigin: https://id.rapida.ru\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36\nContent-Type: application/json;charset=UTF-8\nReferer: https://id.rapida.ru/9253\nAccept-Language: ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7\nCookie: твои куки\n\n{\"function\":\"GetUserPaymentTemplatesList\", \"params\":{}}\n```\np.s просто видимо место на диске освободилось, я его снова подзаполнил немного и вот стектрейс","automated_response":false,"created_at":"2018-02-26T12:25:36.902Z","updated_at":"2018-02-26T12:26:10.140Z","actor":{"username":"danila","cleared":false,"url":"/danila","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2434807,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Да, теперь получилось, спасибо :)","automated_response":false,"created_at":"2018-02-26T16:25:09.328Z","updated_at":"2018-02-26T16:25:09.328Z","actor":{"username":"blanche","cleared":false,"url":"/blanche","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2437193,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Кажись фиксед. ","automated_response":false,"created_at":"2018-02-27T05:41:50.316Z","updated_at":"2018-02-27T05:41:50.316Z","actor":{"username":"danila","cleared":false,"url":"/danila","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2438405,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-02-27T11:59:44.341Z","updated_at":"2018-02-27T11:59:44.341Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"QIWI"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"danila","url":"/danila"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2438410,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Спасибо за помощь!","automated_response":false,"created_at":"2018-02-27T12:00:22.906Z","updated_at":"2018-02-27T12:00:22.906Z","actor":{"username":"vankyver","cleared":false,"url":"/vankyver","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"danila","url":"/danila"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2733292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-05-12T09:18:46.685Z","updated_at":"2018-05-12T09:18:46.685Z","first_to_agree":true,"actor":{"username":"danila","cleared":false,"url":"/danila","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2865673,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-06-11T09:18:58.468Z","updated_at":"2018-06-11T09:18:58.468Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"QIWI"}},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":7667,"category":"researcher","content":"Переполнение логгера вызывало ошибку с путями","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":39411,"username":"danila","name":"Danila xawdx Chalykin","bio":"~Web is our daily bread~","cleared":false,"website":null,"location":"Almaty","created_at":"2015-09-01T06:16:25.925Z","url":"https://hackerone.com/danila","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/039/411/5cc7b39e3810ce641dd0b59cbe5edd4bb2d71c1c_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}