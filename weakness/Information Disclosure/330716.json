{"id":330716,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzA3MTY=","url":"https://hackerone.com/reports/330716","title":"F5 BIG-IP Cookie Remote Information Disclosure","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-28T09:44:30.271Z","submitted_at":"2018-03-28T09:44:30.271Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"petruknisme","url":"/petruknisme","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-06-21T11:24:16.526Z","bug_reporter_agreed_on_going_public_at":"2018-06-21T11:24:16.412Z","team_member_agreed_on_going_public_at":"2018-06-21T07:46:14.709Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** \nThe remote host for myynti.lahitapiolarahoitus.fi is appears to be an F5 BIG-IP load balancer(or behind load balancer) and the unencrypted cookie may disclose BigIP pool name, backend's IP address and port, routed domain.\n\n**Description:** \nThe remote host appears to be an F5 BIG-IP load balancer. The load balancer encodes the IP address of the actual web server that it is acting on behalf of within a cookie. Additionally, information after 'BIGipServer' is configured by the user and may be the logical name of the device. These values may disclose sensitive information, such as internal IP addresses and names.\n\nAs you can see, when i'm testing with curl, it will show like this\n```\n\u003c Set-Cookie: BIGipServermy██████████oitus-fi_pool=2079████████6.0000; path=/\n\u003c Set-Cookie: TS013d0012=0147052ac538e5a096f03ce792d4dfca4fa7aa1446dea5089d1317f68b65cec609e178c83e1b5a758b8525b5d28fa72da9dc462362; Path=/\n```\n\n**Impact:**\nAttacker can leaks backend information (pool name, backend's IP address and port, routed domain) through cookies inserted by the BigIP system.\n\n## Browsers / Apps Verified In:\n\n  * Metasploit\n\n## Steps To Reproduce:\n\n  For this case, you can use metasploit auxilary module to scan vuln:\n```\nuse auxiliary/gather/f5_bigip_cookie_disclosure\nset RHOST myynti.lahitapiolarahoitus.fi\nrun\n```\n\n## Additional material\n\n  * I've attaching screenshot in this report\n\n```\nmsf auxiliary(gather/f5_bigip_cookie_disclosure) \u003e run\n\n[*] Starting request /\n[+] F5 BigIP load balancing cookie \"BIGipServermy█████oitus-fi_pool = 2079██████████6.0000\" found\n[+] Load balancing pool name \"my██████oitus-fi_pool\" found\n[+] Backend 19█████████2:81 found\n```\n\n## Remediations\n\n  * Encrypting the cookies from BigIP : http://www.systemadvise.com/2016/11/f5-big-ip-cookie-remote-information.html\n\n## Related reports, best practices\n\n  * https://support.f5.com/csp/article/K14784?sr=45997495\n  * http://www.systemadvise.com/2016/11/f5-big-ip-cookie-remote-information.html\n  * https://www.rapid7.com/db/modules/auxiliary/gather/f5_bigip_cookie_disclosure\n\n## Impact\n\nAttacker can leaks backend information (pool name, backend's IP address and port, routed domain) through cookies inserted by the BigIP system.","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":279438,"file_name":"tapiola-bigipdisclosure.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/279/438/d9da518e570fc4bfa0621d9b2b71d65544d7d588/tapiola-bigipdisclosure.png?response-content-disposition=attachment%3B%20filename%3D%22tapiola-bigipdisclosure.png%22%3B%20filename%2A%3DUTF-8%27%27tapiola-bigipdisclosure.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144647Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=44e403e011567203497352595f579b8f0a5298a4fb104459126920060f089572","file_size":32538,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["ali","eveeez","an0nym0us","apapedulimu","khizer47","t4ym","arifmkhls","japz","cryptographer","klau5","and 8 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6798,"asset_type":"URL","asset_identifier":"myynti.lahitapiolarahoitus.fi","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2539832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report and http://blog.bugcrowd.com/advice-for-writing-a-great-vulnerability-report/. Also, our policy contains a lot of information on what is relevant and what is not.*","automated_response":false,"created_at":"2018-03-28T09:47:31.104Z","updated_at":"2018-03-28T09:47:31.104Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2723724,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Although very minor, we will fix this configuration issue.","automated_response":false,"created_at":"2018-05-10T11:21:48.803Z","updated_at":"2018-05-10T11:21:48.803Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2723725,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Basic award for very minor technical issues.","automated_response":false,"created_at":"2018-05-10T11:22:16.665Z","updated_at":"2018-05-10T11:22:16.665Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"petruknisme","url":"/petruknisme"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2725338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! :)","automated_response":false,"created_at":"2018-05-10T16:00:26.897Z","updated_at":"2018-05-10T16:00:26.897Z","actor":{"username":"petruknisme","cleared":false,"url":"/petruknisme","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2902309,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi, could you please verify if our fix is any good?","automated_response":false,"created_at":"2018-06-18T18:31:56.900Z","updated_at":"2018-06-18T18:31:56.900Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2911603,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey,\nSorry for my late response. I can confirm that this issue is fixed. \n\n```\nmsf5 auxiliary(gather/f5_bigip_cookie_disclosure) \u003e run\n\n[*] Starting request /\n[-] F5 BigIP load balancing cookie not found\n[*] Auxiliary module execution completed\nmsf5 auxiliary(gather/f5_bigip_cookie_disclosure) \u003e \n```","automated_response":false,"created_at":"2018-06-20T12:37:47.132Z","updated_at":"2018-06-20T12:37:47.132Z","actor":{"username":"petruknisme","cleared":false,"url":"/petruknisme","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2914581,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your input and effort.","automated_response":false,"created_at":"2018-06-21T07:45:50.524Z","updated_at":"2018-06-21T07:45:50.524Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"petruknisme","url":"/petruknisme"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2914583,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We can disclose this publicly.","automated_response":false,"created_at":"2018-06-21T07:46:14.743Z","updated_at":"2018-06-21T07:46:14.743Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2915877,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Okay! Thanks :)","automated_response":false,"created_at":"2018-06-21T11:24:16.446Z","updated_at":"2018-06-21T11:24:16.446Z","actor":{"username":"petruknisme","cleared":false,"url":"/petruknisme","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2915878,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-06-21T11:24:16.566Z","updated_at":"2018-06-21T11:24:16.566Z","actor":{"username":"petruknisme","cleared":false,"url":"/petruknisme","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7750,"category":"team","content":"##Issue\n\nThe reporter found that the f5 Big-IP cookies potentially reveal BigIP pool name, backend's IP address and port, routed domain.\n\n##Fix\n\nThere is an option in Big-IP to fix this. Just click, apply and you are done.\n\n##Reasoning\n\nThe issue is not critical,but it was an easy fix. Note: we will apply this to all domains and no further reports on this for other domains will be accepted never ever.\n","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}