{"id":343464,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDM0NjQ=","url":"https://hackerone.com/reports/343464","title":"Team object in GraphQL discloses team group names and permissions","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-04-26T14:11:21.961Z","submitted_at":"2018-04-26T14:11:21.961Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haxta4ok00","url":"/haxta4ok00","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-04T01:08:39.247Z","bug_reporter_agreed_on_going_public_at":"2018-05-04T01:08:39.149Z","team_member_agreed_on_going_public_at":"2018-05-03T20:15:46.943Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nHi team. We can disclosed your team member groups ;)\n**Description:**\nBecause of the communications error, we can disclose the data - `team_member_groups{id,name,permissions}`\n### Steps To Reproduce\n\n1. {\"query\": \"query {team(handle:\\\\\\\"security\\\\\\\"){id,name,handle,██████{total_count},team_member_groups{id,name,permissions}}}\"}\n\nResult:\n`{\"data\":{\"team\":{\"id\":\"Z2lkOi8vaGFja2Vyb25lL1RlYW0vMTM=\",\"name\":\"HackerOne\",\"handle\":\"security\",\n\"██████\":{\"total_count\":30},\"team_member_groups\":[{\"id\":\"7506\",\"name\":\"Support\",\"permissions\":[\"support_mutation\"]},{\"id\":\"8126\",\"name\":\"Report Only\",\"permissions\":[\"report_management\"]},{\"id\":\"8023\",\"name\":\"Support - SAML\",\"permissions\":[\"support_saml\"]},{\"id\":\"8024\",\"name\":\"Support - Directory\",\"permissions\":[\"support_directory\"]},{\"id\":\"9492\",\"name\":\"Support - Customer Success\",\"permissions\":[\"support_customer_success\"]},{\"id\":\"9880\",\"name\":\"Support - Sales\",\"permissions\":[\"support_sales\"]},{\"id\":\"11365\",\"name\":\"Support - Finance\",\"permissions\":[\"support_finance\"]},{\"id\":\"11947\",\"name\":\"Support - Marketing\",\"permissions\":[\"support_marketing\"]},{\"id\":\"16233\",\"name\":\"Support - Human Resources\",\"permissions\":[\"support_hr\"]},{\"id\":\"19143\",\"name\":\"Support - Hacker Success\",\"permissions\":[\"support_hacker_success\"]},{\"id\":\"21045\",\"name\":\"Program Management\",\"permissions\":[\"program_management\"]},{\"id\":\"21046\",\"name\":\"Support - Open Source Review\",\"permissions\":[\"support_open_source_review\"]},{\"id\":\"34558\",\"name\":\"Kerk Squad\",\"permissions\":[\"report_management\"]},{\"id\":\"34881\",\"name\":\"Support - SQL Query Analyzer\",\"permissions\":[\"support_sql_query_analyzer\"]},{\"id\":\"134\",\"name\":\"Admin\",\"permissions\":[\"user_management\",\"program_management\"]},{\"id\":\"135\",\"name\":\"Standard\",\"permissions\":[\"report_management\",\"reward_management\"]}]}}}`\n\n████████\n\nSorry i bad speak english\nI hope you understand me\nThank you,haxta4ok00\n\n## Impact\n\nDisclosed name and permissions groups","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-02T20:15:47.102Z","allow_singular_disclosure_after":-105993156.21359386,"singular_disclosure_allowed":true,"vote_count":69,"voters":["irvinlim","jokebookservice1","kiyell","rhynorater","thaivu","europa","mashoud1122","str0k1rch","hunter","muon4","and 59 more..."],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2668552,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-04-26T14:21:18.357Z","updated_at":"2018-04-26T14:21:18.357Z","additional_data":{"old_title":"GraphQL disclosed name and permissions your groups","new_title":"GraphQL disclosed name and permissions team groups"},"actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2668600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Full impact -- All programs except private ones that are not available for visibility: public , ████████(not fully public), ████████(private, but I am excluded from this program), █████████(private)","automated_response":false,"created_at":"2018-04-26T14:39:39.736Z","updated_at":"2018-05-03T20:15:07.057Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2670493,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2018-04-26T22:06:07.539Z","updated_at":"2018-04-26T22:06:07.539Z","additional_data":{"old_title":"GraphQL disclosed name and permissions team groups","new_title":"Team object in GraphQL discloses team group names and permissions"},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2670496,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2018-04-26T22:06:32.229Z","updated_at":"2018-04-26T22:06:32.229Z","additional_data":{"added_weaknesses":[{"id":18,"name":"Information Disclosure"}],"removed_weaknesses":[]},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2670497,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-04-26T22:06:47.240Z","updated_at":"2018-04-26T22:06:47.240Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.0)","old_severity_id":null,"new_severity_id":145911},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2670500,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @haxta4ok00 - thanks for your report. We were able to reproduce the behavior you describe and can confirm that this shouldn't be disclosed. We'll get back to you soon, probably at the end of this week. Thanks again, nice find!","automated_response":false,"created_at":"2018-04-26T22:07:32.301Z","updated_at":"2018-04-26T22:07:32.301Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2673310,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @haxta4ok00 - thanks again for pointing out this security vulnerability. We've determined that the severity of this vulnerability is medium, which is why we're rewarding you with a $2,500 bounty. Even though the data itself isn't particularly sensitive, this issue can be used to determine whether external programs in our Directory are running private programs. This was a good find, thanks!","automated_response":false,"created_at":"2018-04-27T16:35:25.889Z","updated_at":"2018-04-27T16:35:25.889Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"haxta4ok00","url":"/haxta4ok00"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2673327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert -- Thank you very much for a bounty!","automated_response":false,"created_at":"2018-04-27T16:43:06.465Z","updated_at":"2018-04-27T16:43:06.465Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2697076,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert -- To my regret, I did not have time to check the probability of displaying all the group members on the screen :( I can only assume that this could lead, if not was a fixed :) .Now I can confirm this -- fixed","automated_response":false,"created_at":"2018-05-03T17:00:12.888Z","updated_at":"2018-05-03T17:00:12.888Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2697703,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for verifying, it's appreciated!","automated_response":false,"created_at":"2018-05-03T20:13:46.262Z","updated_at":"2018-05-03T20:13:46.262Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"haxta4ok00","url":"/haxta4ok00"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2697713,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-05-03T20:15:46.987Z","updated_at":"2018-05-03T20:15:46.987Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2698065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jobert , can delete attachment?","automated_response":false,"created_at":"2018-05-03T22:30:26.990Z","updated_at":"2018-05-03T22:32:50.306Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2698164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @haxta4ok00 - yeah, no problem. I moved it to an internal comment on the report for tracking purposes. This is ready to be disclosed. Thanks for checking!","automated_response":false,"created_at":"2018-05-03T23:09:59.541Z","updated_at":"2018-05-03T23:10:12.244Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2698262,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-05-04T01:08:39.192Z","updated_at":"2018-05-04T01:08:39.192Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2698263,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-05-04T01:08:39.279Z","updated_at":"2018-05-04T01:08:39.279Z","actor":{"username":"haxta4ok00","cleared":true,"url":"/haxta4ok00","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/049/175/8449afdd3403f4de00b34719ee09823bad1c0a06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}