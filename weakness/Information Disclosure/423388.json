{"id":423388,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjMzODg=","url":"https://hackerone.com/reports/423388","title":"H1514 Get access to non public information by pivoting with graphql queries","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-10-13T15:40:09.333Z","submitted_at":"2018-10-13T15:40:09.333Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emitrani","url":"/emitrani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-11-03T23:20:11.797Z","bug_reporter_agreed_on_going_public_at":"2019-11-03T23:20:11.734Z","team_member_agreed_on_going_public_at":"2019-11-01T15:36:00.768Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi security team,\n\n**Summary:** It is possible to pivot with queries to get access to information you shouldn't have access to according to docs located at https://help.shopify.com/en/api/graphql-admin-api/reference/queryroot\n\n**Description:** I will try to write up all the ones I can find related to information disclosure where a user with only access to Apps can get from other parts of the store using the graphiql app.\n\n* Example 1:\nUser with no home access can use locations query to find out store locations and address\n{F360024}\nIt is also possible to use inventoryLevel(inventoryItemId) to get access to inventory without access\n\n* Example 2:\nMarketing activities with no marketing access\n{F360044}\neven though it is possible to ask for more this is the basic query I used. Note it doesn't say access denied.\n`query{marketingActivities(first:100){edges{node{id,title, createdAt, budget{total{amount}}}}}}`\n\n* Example 3:\nPublications and api keys(I suspect app access makes you see api keys but still)\n{F360060}\nQuery I used:\n`query{publications(first: 100){edges{node{name, id, supportsFuturePublishing, app{apiKey}}}}}`\n\n## Impact\n\nThis means the graphql can be used to disclose information about other parts of the store that a low permissions user shouldn't have access to.\n\nBest,\nEray","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":360024,"file_name":"image_(1).png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/024/0bcc70c9f2f217aae4b34870fdc8c6c3f83da2de/image_%281%29.png?response-content-disposition=attachment%3B%20filename%3D%22image_%25281%2529.png%22%3B%20filename%2A%3DUTF-8%27%27image_%25281%2529.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145855Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a7178bb1d3036782fc782be08ffe3b5399f9443b0e74350c13584755cd492a1f","file_size":129034,"type":"image/png"},{"id":360044,"file_name":"marketing.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/044/60329fa1f8f445ce09a7e22d42546ff6f3e8f6bd/marketing.JPG?response-content-disposition=attachment%3B%20filename%3D%22marketing.JPG%22%3B%20filename%2A%3DUTF-8%27%27marketing.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145855Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1543fa846471d4cf82b66dc79711016056749d49959ae1ae8cb06434a0c47c8c","file_size":132585,"type":"image/jpeg"},{"id":360060,"file_name":"publications.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/060/e17211ce1c31ee32ab38142a3c8bcaadff74616a/publications.JPG?response-content-disposition=attachment%3B%20filename%3D%22publications.JPG%22%3B%20filename%2A%3DUTF-8%27%27publications.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145855Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e257b89d34c097d316212c841947f06c30e623366a4db35bcb30e16cc4363dac","file_size":238882,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["drsniper","spam404","ali","adriy1","cryptographer","dolph1n","sohaip_hackerdz","jesuser14","uservoid","ytatack","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3522271,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report, and sorry for the long wait.\n\nIt's intentional that store locations are accessible to all apps and users. However, marketing activities and publications were meant to be limited to particular API access scopes and user permissions.\n\nWe'll get back to you soon regarding a bounty payout.","automated_response":false,"created_at":"2018-10-23T20:54:28.485Z","updated_at":"2018-10-23T20:54:28.485Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3522344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for triage @clayton and I don't mind the wait as i'm sure you guys got a lot of reports during the event and I submitted this pretty late.","automated_response":false,"created_at":"2018-10-23T21:06:32.419Z","updated_at":"2018-10-23T21:06:32.419Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3527658,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for this report, we're awarding 500$ with a 3x bonus for being a graphql bug, for a total of 1500$.","automated_response":false,"created_at":"2018-10-24T17:25:07.621Z","updated_at":"2018-10-24T17:25:07.621Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"1000.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"emitrani","url":"/emitrani"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3527687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Woah thanks for the 3x. I look forward to working with you guys through the public program in the future.","automated_response":false,"created_at":"2018-10-24T17:29:59.375Z","updated_at":"2018-10-24T17:29:59.375Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3989293,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi again @emitrani and sorry for the delay; as you can imagine we had a lot on our plate after H1-514. We've now updated our GraphQL permissions checks, so we're closing off this report.\n\nFor your example 1 there's no change; by design, store locations are accessible to all users regardless of permissions. For example 2, Marketing and Discounts permission is now required for access to marketing activities. For example 3, Products permission is now required for access to publications.\n\nThanks again for your report, and we look forward to hearing from you again soon!","automated_response":false,"created_at":"2019-01-16T21:12:45.735Z","updated_at":"2019-01-16T21:12:45.735Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"emitrani","url":"/emitrani"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3990599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @clayton,\n\nI don't think you are completely done with this report given the new changes to how application permissions work. If requested I can send a new report as well but here is what I've observed:\n\nSince I don't have a Shopify Plus store I can't fully test this but I have a hunch. \n\nWe know that only account owner is allowed to access  Exchange Marketplace app \n{F407770}\n\nHowever if given access to apps or only graphql app a user will be able to grab the token for the app through gql queries like `{appInstallations(first:100)   {edges{node{id, launchUrl, app{apiKey, features}}}}}` notice the account doesn't have access to app launch url. \n{F407769}\n\nThis is why I think the per user app permissions can be bypassed by graphql app as when it was designed anyone who had access to that graphql would have access to any other application. \n\nNotice no required access prompt in docs:\n\n{F407771}\n\nYou can either warn users graphql app gives permission to all other apps or implement finer access control. \n\nLet me know what you think.","automated_response":false,"created_at":"2019-01-17T07:18:10.098Z","updated_at":"2019-01-17T07:20:34.119Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":407771,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/407/771/983dcef560003ab222885c38c409c1735cafa75a/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145856Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=78f82985d2765ae37b0fd4962e34044fd494fe6f271ccbcea651a8c14ec204cf"},{"id":407770,"filename":"query.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/407/770/bcc4414c71fae040045273dcd19e9534274eeb28/query.PNG?response-content-disposition=attachment%3B%20filename%3D%22query.PNG%22%3B%20filename%2A%3DUTF-8%27%27query.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145856Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=43a9090093c80a4e11ae746710f0b6843295a07aa0472ca7f80fea30224d0b66"},{"id":407769,"filename":"exchange.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/407/769/4bc536a451a38e20c84dfa8191ce44feeaa3515a/exchange.PNG?response-content-disposition=attachment%3B%20filename%3D%22exchange.PNG%22%3B%20filename%2A%3DUTF-8%27%27exchange.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ5B5ZLR7W%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145856Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDznwDn3DlLBhpUQR2HsgV%2FXq95UR4rgunTAtaALtJfOwIhAPs6S1Tcddn1VigtqMJZu1ze7EJhUESTAidgv9nNGvTkKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwZmyQg19q82eNvWTYq1wPVa9iL33aSnxoe9uhB7r2aVM0UjDJv7L7h4wpacx0zTD7Cg8zZaNStfUkAQ4PRdT1iVaYXFqr3oEtcRoGLKhag7I7AYV4CfabHIx%2FljtUdbse7EzqrV%2BLQvKbTG6z1i6zNoig4BjAmqV%2BbJNhSJroBCOPElku0SEqEghibUoxjbjpR4CBXjTIJwAUpnCgLLy91sSgp9KNeTgb1AkQk9PEiYIt%2BjjRn7YHGTo0lsLEhUWc0hsx6VLMRCiSyU6pMLzMGyTS6q7VECFtTn5Z0xG6cXCTKHB3pYQ1zLLYN8ml68bLOIBj9DG3soHxXVeXkifKnxu13VQyp3%2Fs7gxFDt1C7HjJ71usGGrh%2BfYBJJFBMGndfS1DoK%2Bopk8YhA2hlX3szEJmyZfm0KUVaG%2FoWbCJlR3fqXIBJ1cKXRlMooUSiLaTSXt07k2ZqF9w0HUl1IdVQzbNbJBH%2BnkPxpioMdR%2BthDqTyEJ4NZO1WuIxKWGZYyMyXsZaWNopcb1ntUTbg6h9jL8PBR4KRpM%2FHAsw70cht3GV%2BEt83AJHQMRTRifsEIkEWjFR47llnjXkbbepxcng%2ByfEEKZRp237bvaIzCz%2FOBASo1zhQretKmelA0U4%2BEADJwrI3hIwr4yRiwY6pAEjctaIC5qKHFIiVu1bdWXuftBXGyVKZyt2TIP%2B2%2FEEDUKSn7h674C0WnV7bDgpkWP3Jm2QA8%2B4oAW2qew892kEhCJxDwZz%2BXR81EJw6%2FG5A5FZJ8bUl63WLiuBkwA0Dx%2Bf%2FkeTcR6awW4gpgHN5q2%2B02FvrdW8HWnLO9b%2FdddTJiHpMjGB2dteCQWg1L0LIQ%2FyL7kCQpQu%2F5PLB76pfiUetgXbFQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b7c73c10ad21333d3e09fd8ce979d3b080e707d12390eb13bc4c1a12685438a3"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3993231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@emitrani If you're talking about the `apiKey` value, that's just an identifier, not an authentication token.","automated_response":false,"created_at":"2019-01-17T14:34:22.719Z","updated_at":"2019-01-17T14:34:56.470Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3993408,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I need a partner shop to test it fully. Any chance you can give it to my `wearehackerone` email? \n\nAs far as I can tell we can't access publications through the app but I'm thinking someone without access to app x can still request it through graphql and need partner to test that. We can get information about app pricing, any errors given by the app etc if this works. Here is the query I was trying with a user who will only have access to the graphql api.\n\n`{appInstallations(first:100) {edges{node{id,publication{name}, launchUrl, app{apiKey, features, pricingDetails, published, feedback{messages{message}} }}}}}`\n\nNote with recent changes `publication{name}` will return several errors like\n\n```\n \"message\": \"access denied\",\n      \"locations\": [\n        {\n          \"line\": 1,\n          \"column\": 45\n        }\n      ],\n      \"path\": [\n        \"appInstallations\",\n        \"edges\",\n        4,\n        \"node\",\n        \"publication\"\n      ]\n```\n\nbut we can get information like:\n\n```\n \"node\": {\n            \"id\": \"gid://shopify/AppInstallation/75431936022\",\n            \"publication\": null,\n            \"launchUrl\": \"https://emitrani.myshopify.com/admin/apps/google-shopping-2\",\n            \"app\": {\n              \"apiKey\": \"a78e004f44cded1b6998e7a6e081a230\",\n              \"features\": [\n                \"Easily sync your products\",\n                \"Run a Google Shopping Campaign\",\n                \"Track your campaign results\"\n              ],\n              \"pricingDetails\": \"Free to install\",\n              \"published\": true,\n              \"feedback\": {\n                \"messages\": [\n                  {\n                    \"message\": \"Google Shopping is disconnected because your Merchant Center account has been suspended.\"\n                  }\n                ]\n              }\n            }\n          }\n        },\n```\n\nWith an app user doesn't have access to:\n\n```\n \"node\": {\n            \"id\": \"gid://shopify/AppInstallation/75493900310\",\n            \"launchUrl\": \"https://emitrani.myshopify.com/admin/apps/exchange-sell-your-shopify-store\",\n            \"app\": {\n              \"pricingDetailsSummary\": \"Free to install\",\n              \"apiKey\": \"96bb4269bedec4d9e67ceebfee9e1bf7\",\n              \"features\": [],\n              \"pricingDetails\": null,\n              \"failedRequirements\": [],\n              \"published\": false,\n              \"feedback\": null\n            }\n          }\n```","automated_response":false,"created_at":"2019-01-17T15:13:02.885Z","updated_at":"2019-01-17T15:13:02.885Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3993412,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Some fields might be empty because of a lack of activity no errors were given to query `{appInstallations(first:100) {edges{node{id, launchUrl, app{pricingDetailsSummary, apiKey, features, pricingDetails, failedRequirements{action{url, title}}, published, feedback{messages{message}, link{url}} }}}}}` even though user shouldn't have access to exchange app. ","automated_response":false,"created_at":"2019-01-17T15:13:48.388Z","updated_at":"2019-01-17T15:13:48.388Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3993565,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I need a partner shop to test it fully.\n\nIf you haven't already done so, you can sign up for a partner account here:\n\nhttps://app.shopify.com/services/partners/signup/whitehat\n\nYou'll then be able to create development stores through that account. Does that get you what you need?","automated_response":false,"created_at":"2019-01-17T15:39:20.490Z","updated_at":"2019-01-17T15:39:20.490Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3993609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My shop is part of that but I still can't use the https://changelog.shopify.com/posts/grant-your-staff-access-to-specific-apps-and-channels update here. Maybe I'm missing something I will check it again later tonight. ","automated_response":false,"created_at":"2019-01-17T15:46:12.747Z","updated_at":"2019-01-17T15:46:12.747Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3993699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That feature is only available in Shopify Plus stores. We're currently sorting out a way to give hackers access to these features and will get back to you soon.\n\nIf you happen to find any further GraphQL issues (whether in that feature or elsewhere), please open a report in our main program (https://hackerone.com/shopify).","automated_response":false,"created_at":"2019-01-17T16:02:45.232Z","updated_at":"2019-01-17T16:02:45.232Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6194260,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-01T15:36:00.815Z","updated_at":"2019-11-01T15:36:00.815Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6206360,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-03T23:20:11.749Z","updated_at":"2019-11-03T23:20:11.749Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6206361,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-11-03T23:20:11.811Z","updated_at":"2019-11-03T23:20:11.811Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7146762,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2020-02-25T14:36:42.661Z","updated_at":"2020-02-25T14:36:42.661Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"your-store.myshopify.com","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}