{"id":430854,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzA4NTQ=","url":"https://hackerone.com/reports/430854","title":"Kaspersky Password Manager allows websites to access user's address data","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-30T13:30:18.432Z","submitted_at":"2018-10-30T13:30:18.432Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"palant","url":"/palant","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2379,"url":"https://hackerone.com/kaspersky","handle":"kaspersky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Kaspersky","twitter_handle":"kaspersky","website":"http://www.kaspersky.com","about":"Kaspersky is the worldâ€™s largest privately-held vendor of endpoint protection and cybersecurity solutions for business and consumers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-24T08:59:07.600Z","bug_reporter_agreed_on_going_public_at":"2019-10-25T08:59:04.503Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"*Note*: According to https://www.securityweek.com/kaspersky-adds-password-manager-bug-bounty-program and some other sources, Kaspersky Password Manager is in scope for this program. The program description doesn't reflect this however.\n\n**Summary**\n\nIt is possible for websites to read out addresses that the user stores in Kaspersky Password Manager.\n\n**Description**\nKaspersky Password Manager injects its user interface into untrusted web pages, there are no protections in place. This makes it easy for websites to instrument the user interface, e.g. to fill in addresses without the user's consent or knowledge.\n\n**Environment**\n- Scope: Application\n- Product name: Kaspersky Password Manager, browser extensions installed\n- Product version: 9.0.1.447\n- OS name and version (incl SP): Windows 10 Version 1803\n- Attack type: Information Disclosure\n- Maximum user privileges needed to reproduce your issue: no privileges\n\n**Steps to reproduce**\n1. Make sure to unlock Kaspersky Password Manager and to add an address. The actual address part should be a single line (filling in fails for multiline values with my PoC which could certainly be addressed if necessary).\n2. Download the attached extract_address.html and open it via any web server (localhost will do).\n3. Go to http://.../extract_address.html with your browser (I tried Firefox 62 but this should work in Chrome as well) and wait a few seconds.\n\nAn alert message will pop up telling your name and address. This information could be sent to a third party without you noticing anything.\n\n## Impact\n\nThis allows to deanonymize and to track users, the address being a particularly valuable piece of information. Privacy conscious users will still be recognized reliably, even if clearing cookies and using proxy servers. In addition, advertisers will certainly love the possibility of telling exactly where the person lives - makes for some great targeting.","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-24T08:59:04.574Z","allow_singular_disclosure_after":-59378439.43267181,"singular_disclosure_allowed":true,"vote_count":64,"voters":["thecybermentor","mashoud1122","sameerphad72","dhakal_ananda","ali","ko2sec","what_web","osama-hamad","exception","bb00x","and 54 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3562262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi man.\n\nThx for the info. I've reproduced on both Firefox and Chrome. Stay tuned for the following updates, we have to assess its real severity and impact.","automated_response":false,"created_at":"2018-10-31T11:21:30.591Z","updated_at":"2018-10-31T11:21:30.591Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3562263,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-10-31T11:21:45.636Z","updated_at":"2018-10-31T11:21:45.636Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3645068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thx for your efforts to make our products more secure! The vulnerability will be fixed in the future product releases.","automated_response":false,"created_at":"2018-11-14T20:40:58.595Z","updated_at":"2018-11-14T20:40:58.595Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3722452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will there be a bug bounty as well?","automated_response":false,"created_at":"2018-11-28T14:05:39.321Z","updated_at":"2018-11-28T14:05:39.321Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3739605,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, Palant!\nWe would like to thank you for this report. Your help is appreciated for us.\nYour research and your reports will allow to make our products better.\nKaspersky Password Manager is currently out of scope of our bug bounty program. \nHowever, for your efforts and as an exception, we award you $300 for the bug. \nThank you for helping to make our products secure.","automated_response":false,"created_at":"2018-11-30T15:59:27.176Z","updated_at":"2018-11-30T15:59:27.176Z","actor":{"url":"/kaspersky","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kaspersky"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kaspersky","collaborator":{"username":"palant","url":"/palant"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4270071,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fixed version of the product has been released. A downloader from our official site installs KPM 9.2 now.\n\nhttps://www.kaspersky.com/downloads/thank-you/password-manager-pc","automated_response":false,"created_at":"2019-03-06T18:44:12.500Z","updated_at":"2019-03-06T18:44:12.500Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"palant","url":"/palant"},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4657027,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-04-28T17:26:59.224Z","updated_at":"2019-04-28T17:26:59.224Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":231356,"new_severity_id":359398},"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455830,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-29T17:55:07.547Z","updated_at":"2019-07-29T17:55:07.547Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5498154,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Hi man.\n\nYou've requested too many tickets for disclosure at the same time.","automated_response":false,"created_at":"2019-08-04T16:26:09.584Z","updated_at":"2019-08-04T16:26:09.584Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5498376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So what does it mean exactly? I would have requested disclosure earlier but supposedly these or related tickets weren't fixed yet.","automated_response":false,"created_at":"2019-08-04T18:33:00.054Z","updated_at":"2019-08-04T18:33:00.054Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5502105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It means that we can't allow disclosure of this report now. But you can request disclosure later.","automated_response":false,"created_at":"2019-08-05T12:08:36.532Z","updated_at":"2019-08-05T12:08:36.532Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5791150,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-09-12T13:04:03.958Z","updated_at":"2019-09-12T13:04:03.958Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5791293,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi man.\n\nCould you delay disclosure of this report to the date you previously defined for your recently submitted reports (i. e. the month of November)?","automated_response":false,"created_at":"2019-09-12T13:31:42.224Z","updated_at":"2019-09-12T13:31:42.224Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5791305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Why that? This is not in any way related to these reports, and it's rather old.","automated_response":false,"created_at":"2019-09-12T13:35:44.996Z","updated_at":"2019-09-12T13:35:44.996Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5791389,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is an additional work for us to prepare a security advisory. It's more comfortable if we describe all these issues in one advisory, when the remaining vulnerabilities will have been fixed.","automated_response":false,"created_at":"2019-09-12T13:49:34.139Z","updated_at":"2019-09-12T13:52:09.793Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5794067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am going to request disclosure for three reports on 2019-10-25 and two more on 2019-10-27. Will I get \"You've requested too many tickets for disclosure at the same time\" again if I add this one to the mix?","automated_response":false,"created_at":"2019-09-12T19:13:02.902Z","updated_at":"2019-09-12T19:13:02.902Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5794157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Deleted.","automated_response":false,"created_at":"2019-09-12T19:29:28.640Z","updated_at":"2019-09-12T19:30:30.822Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5794171,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think we could prepare one common security advisory for mentioned reports and allow you to disclose them in the time frame you mentioned above.","automated_response":false,"created_at":"2019-09-12T19:32:19.286Z","updated_at":"2019-09-12T19:32:19.286Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5794747,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, let's target 2019-11-25 as disclosure date for this one as well then. I'll request disclosure 30 days in advance.","automated_response":false,"created_at":"2019-09-12T20:40:31.208Z","updated_at":"2019-09-12T20:40:31.208Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5799592,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Cancelled for a while.","automated_response":false,"created_at":"2019-09-13T12:08:40.917Z","updated_at":"2019-09-13T12:08:40.917Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6133415,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-25T08:59:04.522Z","updated_at":"2019-10-25T08:59:04.522Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6389176,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-11-24T08:59:07.624Z","updated_at":"2019-11-24T08:59:07.624Z","actor":{"url":"/kaspersky","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Kaspersky"}},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6398026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://support.kaspersky.com/general/vulnerability.aspx?el=12430#251119_2","automated_response":false,"created_at":"2019-11-25T12:11:44.359Z","updated_at":"2019-11-25T12:11:44.359Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}