{"id":484377,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODQzNzc=","url":"https://hackerone.com/reports/484377","title":"Information Disclosure (can access all ███s) within ███████ view █████████ Portal","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-23T01:42:53.755Z","submitted_at":"2019-01-23T01:42:53.755Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"archang31","url":"/archang31","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/126/990/7df24ea25420aa0632d62cccc775e5cd7868a5b1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-08T18:58:30.363Z","bug_reporter_agreed_on_going_public_at":"2019-02-07T15:48:31.703Z","team_member_agreed_on_going_public_at":"2019-10-08T18:58:30.238Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** Once ███████ authenticated (I did not mess around to see if I could reproduce without authentication), any user can view any ██████████ simply by changing the offasgid HTTP GET parameter value in the ██████ view █████████ portal link.\n\n**Description:**\nI was looking through my previous ███████s and noticed I was receiving urls like https://█████████/portal/viewrfo.aspx?offasgid=MjAwODAyMTg1Nw== . This url is clearly expecting a HTTP GET parameter offasgid with some base64 encoded value. Decoding this value, you get 2008021857 . The █████ in question was my first █████ from February 2008. From testing several IDs, I determined the format is {year}{██████████ #} so 2008, ████████ # 021857.  I simply incremented this value to 2008021858, base64 encoded this value, and browsed to https://███/portal/viewrfo.aspx?offasgid=MjAwODAyMTg1Ng==  . Here, I was able to see ███████.  I also tested the next value ( https://███/portal/viewrfo.aspx?offasgid=MjAwODAyMTg1NQ== ) and got █████. Finally, I opened a new private browser window (so no cookies) and browsed directly to that last link. I had to reauthenticate, but I then was able to directly assess ██████████. At this point, I stopped interacting with the website to submit this vulnerability. \n\nNOTE: I did not save any record of these ███████s outside except the single attached screenshot.\nNOTE2: I tried a couple more values during this write-up to better understand the ID. I initially thought the 02 from 2008021858 was the month {year}{month}{id} but its just {year}{id}. I used 2018000001 and ended up with an ████████ from 20171001 (the very first day of the 2018 fiscal year). I also tested a couple IDs to see how far back the data goes. I used 1999000001 to pull an ██████ from 19980327. I believe this is the very first █████ in the system. I tried 1997000001 as well, and it simply returned a blank ████ (i.e. the ID does not exist).\n\n## Impact\nIn a relatively simple and predictable manner (due to the sequential IDs), any user with access to █████ can incrementally view every ███ issued by ████████ dating back to 1998. This data includes SSN last 4, EFMP information, branch, and assignment information. From this data, one can extract all sorts of information about the U.S. █████████ personnel including total ██████████ strength, ████ strength by branch, assignment history, strength by base, etc.\n\n## Step-by-step Reproduction Instructions\n\n1. Log into ██████████ (https://███.██████████.███████.mil/)\n2. Browse to any █████████ you want to view like https://████/portal/viewrfo.aspx?offasgid=MjAxOTAxMDg2NQ== if you want to view my most recent ███.\n3. Modify offasgid value as desired to view any other ███████ (they seem to be incrementing IDs by year)\n\n## Product, Version, and Configuration (If applicable)\n\n## Suggested Mitigation/Remediation Actions\nFirst, the offasgid needs to be random and not a predictable value. Secondly, there needs to be some access check based on the provided cookie (user credentials) to ensure that user should be able to access that record.\n\n## Impact\n\nIn a relatively simple and predictable manner (due to the sequential IDs), any user with access to ████ can incrementally view every ███████ issued by ██████ dating back to 1998. This data includes SSN last 4, EFMP information, branch, and assignment information. From this data, one can extract all sorts of information about U.S. ████ personnel including total ███ strength, ████████ strength by branch, assignment history, strength by base, etc.","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["archang31","mik317","domssilva","armansameer","theoneronin","elfpotion","cyberrumor"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4021588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-01-23T01:42:54.289Z","updated_at":"2019-01-23T01:42:54.289Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4024313,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-23T13:21:41.108Z","updated_at":"2019-01-23T13:21:41.108Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":284957},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4024314,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-01-23T13:21:42.951Z","updated_at":"2019-01-23T13:21:42.951Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4051722,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Looks like the fix was to properly configure access control to all the documents.  When you have a moment can you take a look and verify that the mitigation that was put in place is actually working for you.  Side note, I do not think that they are actually going to address the trivial (ie none) sequence of record IDs or the Base64 encoding. \n\nAlso, sorry for the form letter.  Tied up with about 1 million things going on at the moment...","automated_response":false,"created_at":"2019-01-28T19:58:49.846Z","updated_at":"2019-01-28T19:58:49.846Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4059364,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Awesome - I am impressed at how fast this issue was fixed. I just tested this issue, and it seems fixed. I can access my own ██████████s, and I get a \"You do not have access to this assignment record\" when trying to access other ███s. It also gives the same error when you try to access an ████ that does not even exist which is great (i.e. I can not differentiate between an █████ I simply do not have access too and █████s that do not exist).\n\nNo worries about any delays on your side, and I am sure you are super busy. I am just so happy there is a vuln disclosure process to get these fixed - much better than any experience I have had previously trying to get issues fixed. \n\n","automated_response":false,"created_at":"2019-01-29T15:41:56.674Z","updated_at":"2019-09-25T15:30:52.351Z","actor":{"username":"archang31","cleared":false,"url":"/archang31","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/126/990/7df24ea25420aa0632d62cccc775e5cd7868a5b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4059651,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not a problem, thanks for taking a second look for me.  Looked like it was resolved but as you have a record in there I wanted to make sure you couldn't pivot from that point.  Usually high and critical findings get pretty fast turnaround.  Low level stuff, like low STIG and SRG findings tend to take much longer.","automated_response":false,"created_at":"2019-01-29T16:35:52.135Z","updated_at":"2019-01-29T16:35:52.135Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4059654,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-01-29T16:36:10.326Z","updated_at":"2019-01-29T16:36:10.326Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4059657,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-01-29T16:36:27.058Z","updated_at":"2019-01-29T16:36:27.058Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"archang31","url":"/archang31"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4080191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can I have permission to disclose this vulnerability? I would like to share it with some of my peers to remind them of the vuln program and to show how quickly issues get fixed when reported.","automated_response":false,"created_at":"2019-02-01T15:29:20.452Z","updated_at":"2019-02-01T15:29:20.452Z","actor":{"username":"archang31","cleared":false,"url":"/archang31","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/126/990/7df24ea25420aa0632d62cccc775e5cd7868a5b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4080298,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Damn straight you can and I'd recommend it.  Well written reports like yours are good to share with your peers but also other researcher that are just starting out.","automated_response":false,"created_at":"2019-02-01T15:50:56.375Z","updated_at":"2019-02-01T15:50:56.375Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4080308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did it for you.  Expect this to get processed beginning of next week, I'll need to review and redact.","automated_response":false,"created_at":"2019-02-01T15:51:54.069Z","updated_at":"2019-02-01T15:51:54.069Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4105850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I did not realize agreeing on my end would fully disclose it immediately. The report still contains some names and PII (last 4) that should be redacted.","automated_response":false,"created_at":"2019-02-06T22:05:32.243Z","updated_at":"2019-02-06T22:05:32.243Z","actor":{"username":"archang31","cleared":false,"url":"/archang31","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/126/990/7df24ea25420aa0632d62cccc775e5cd7868a5b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4109505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@archang31, I had no idea initiating the disclosure request on my end would give you an option to accept and have the full report published.  Report was placed in limited disclosure while we get this straightened out.","automated_response":false,"created_at":"2019-02-07T13:04:59.152Z","updated_at":"2019-02-07T13:04:59.152Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4110303,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@ag3nt-j1 No worries. I think the issue was that I was supposed to request disclosure (i.e. initiate the disclosure request) on my end which then gives you the final disclosure authority. Instead, I just posted a comment because I did not realize that I had other options so you started the process giving me the final disclosure authority. \n\nI apologize for the confusion and believe I started the process correctly on my end now. Let me know if you need anything else.","automated_response":false,"created_at":"2019-02-07T15:48:31.732Z","updated_at":"2019-02-07T15:48:31.732Z","first_to_agree":true,"actor":{"username":"archang31","cleared":false,"url":"/archang31","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/126/990/7df24ea25420aa0632d62cccc775e5cd7868a5b1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5988941,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"disclosure approved","automated_response":false,"created_at":"2019-10-08T18:58:30.262Z","updated_at":"2019-10-08T18:58:30.262Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5988942,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-08T18:58:30.381Z","updated_at":"2019-10-08T18:58:30.381Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14097,"category":"team","content":"An information disclosure vulnerability was discovered on a DoD system. ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":194274,"username":"mrconfidential","name":"Jon Bottarini","bio":"","cleared":false,"website":null,"location":"","created_at":"2017-08-23T23:03:34.511Z","url":"https://hackerone.com/mrconfidential","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/rrEVKL2Fzc6YgZyXX7G1NMTg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/rrEVKL2Fzc6YgZyXX7G1NMTg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBNDZxREE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--52805a921991cba71e201d11f91253875e5386d7/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/profile_photo.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}