{"id":5314,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzE0","url":"https://hackerone.com/reports/5314","title":"Coinbase Android Application - Bitcoin Wallet Leaks OAuth Response Code","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-03-31T06:12:33.653Z","submitted_at":"2014-03-31T06:12:33.653Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"prakharprasad","url":"/prakharprasad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-11-26T21:54:19.265Z","bug_reporter_agreed_on_going_public_at":"2014-10-27T21:54:05.952Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nThere's a simple bug here, the Coinbase Android App. \"BitCoin Wallet\" leaks the **OAuth** Response Code which can be obtained using `adb logcat -s Coinbase` command line for testing, and any Android application on the same phone can read the response code for the user by reading the logs. As of now nothing can be harmed with OAuth Response code, but along with the hardcoded `client secret` we can obtain the `access_token`.\r\n\r\nThis bug is similar to this - http://attack-secure.com/all-your-facebook-access-tokens-are-belong-to-us/\r\n\r\nSo using the stolen response code and `client secret` we can derive the `access_token`\r\n\r\nPOC: https://www.dropbox.com/s/zionksi1pt7lot5/Coinbase-Android.mov","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-11-26T21:54:06.325Z","allow_singular_disclosure_after":-216926127.2868367,"singular_disclosure_allowed":true,"vote_count":9,"voters":["kazan71p","realtess","mdv","viyatb","japz","sumit7","bayashka2","pentester5","alexb"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":22626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anybody to respond this ticket?","automated_response":false,"created_at":"2014-04-02T07:09:04.638Z","updated_at":"2014-04-02T07:09:04.638Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":24166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi - Sorry for the delay. We're looking into this one!","automated_response":false,"created_at":"2014-04-04T21:09:48.248Z","updated_at":"2014-04-04T21:09:48.248Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":24838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Have any updates ? ","automated_response":false,"created_at":"2014-04-06T15:26:35.015Z","updated_at":"2014-04-06T15:26:35.015Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":27508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anybody to respond?","automated_response":false,"created_at":"2014-04-09T20:53:05.143Z","updated_at":"2014-04-09T20:53:05.143Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":38922,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey Prahkar - \n\n\u003e\"So using the stolen response code and client secret we can derive the access_token\" \n\nAre you sure this is correct? Not without the manual user interaction of granting that application another access_token. \n\nRegarding the leaked token, we're working on that issue from another report.","automated_response":false,"created_at":"2014-04-25T23:19:43.020Z","updated_at":"2014-04-25T23:19:43.020Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":38963,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"See, we are only able to steal the response code while the user is authorizing (a malicious app on the phone can monitor logs 24x7 for authorisation ) , once the response code is written into `logcat` entry, the malicious app needs to call the Coinbase API with newly written response code and client secret and we get a brand new access token. ","automated_response":false,"created_at":"2014-04-26T02:57:21.087Z","updated_at":"2014-04-26T03:07:50.691Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":39741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, I understand. Let me update our android guys and see what they think. Sorry for the delay here. ","automated_response":false,"created_at":"2014-04-27T18:54:41.968Z","updated_at":"2014-04-27T18:54:41.968Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":39742,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2014-04-27T18:54:48.391Z","updated_at":"2014-04-27T18:54:48.391Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":44161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @magoo - Can you update me with the progress?","automated_response":false,"created_at":"2014-05-05T09:57:13.881Z","updated_at":"2014-05-05T09:57:13.881Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":48141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi - still working on several fixes on the android app to go out at once. Android bugs will take a bit longer for us.","automated_response":false,"created_at":"2014-05-09T18:08:24.006Z","updated_at":"2014-05-09T18:08:24.006Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":56027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @magoo, just a follow up! any updates regarding the bug fix timeline ?","automated_response":false,"created_at":"2014-05-23T22:56:36.445Z","updated_at":"2014-05-23T22:56:36.445Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":79643,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, this is frustrating, you guys don't reply for months ! ","automated_response":false,"created_at":"2014-06-26T20:29:54.679Z","updated_at":"2014-06-26T20:29:54.679Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":82320,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey - didn't want to respond without an update, currently don't have one at the moment. We're trying to hire more mobile engineers to take on some of this work. Sorry for the delay, it's not off the radar, just taking much longer than I'd like.","automated_response":false,"created_at":"2014-07-01T04:46:47.686Z","updated_at":"2014-07-01T04:46:47.686Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":99424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @magoo, it's been 4 months now. Don't you think this ticket is getting stretched **excessively long** ? Any thoughts of sending the payout to me?","automated_response":false,"created_at":"2014-08-02T12:23:51.927Z","updated_at":"2014-08-02T12:23:51.927Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":116070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Mind fixing the bug @magoo? I don't understand what's up with you people !","automated_response":false,"created_at":"2014-08-27T06:38:13.081Z","updated_at":"2014-08-27T06:38:31.896Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":122975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey prakhar - Will try to get you an update on this.","automated_response":false,"created_at":"2014-09-07T22:53:01.901Z","updated_at":"2014-09-07T22:53:01.901Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":123001,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"This is supposed to be fixed, and I dropped the ball on this ticket. We merged this code a long time ago, could you check to see if you can still repro?","automated_response":false,"created_at":"2014-09-07T23:29:36.434Z","updated_at":"2014-09-07T23:29:36.434Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":123005,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Looks fixed to me.","automated_response":false,"created_at":"2014-09-07T23:31:48.130Z","updated_at":"2014-09-07T23:31:48.130Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":123342,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Oof... OK, this was my bad for taking so long to get back to you. Sorry about that. ","automated_response":false,"created_at":"2014-09-08T17:08:57.444Z","updated_at":"2014-09-08T17:08:57.444Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"prakharprasad","url":"/prakharprasad"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":123343,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2014-09-08T17:09:05.753Z","updated_at":"2014-09-08T17:09:05.753Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"prakharprasad","url":"/prakharprasad"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":123477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty, I'd like to get it paid via PayPal through HackerOne instead of Bitcoins ","automated_response":false,"created_at":"2014-09-08T18:33:41.494Z","updated_at":"2014-09-08T18:33:41.494Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149286,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-10-27T21:54:05.968Z","updated_at":"2014-10-27T21:54:05.968Z","first_to_agree":true,"actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":168687,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-11-26T21:54:19.298Z","updated_at":"2014-11-26T21:54:19.298Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}