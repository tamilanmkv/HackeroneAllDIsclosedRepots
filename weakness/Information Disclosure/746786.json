{"id":746786,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDY3ODY=","url":"https://hackerone.com/reports/746786","title":"Disclosure of locally served nerdpacks due to nr-local.net CORS policy misconfiguration","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-11-26T18:03:29.328Z","submitted_at":"2019-11-26T18:03:29.328Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T13:31:07.291Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:36:11.682Z","team_member_agreed_on_going_public_at":"2020-08-13T13:31:07.142Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey team,\n\nI've discovered that webserver which serves NR1 nerdpacks locally (after `nr1 nerdpack:serve` is executed) allows cross-origin requests from every subdomain of `nr-ext.net`. Since the nr-ext.net domain is used as a sandbox for user-supplied apps, an attacker can place there a malicious code that requests the data from a victim's local webserver. Then, when a victim visits the attacker's website, the following data can be transmitted to the attacker:\n* the nerdpacks', nerdlets' and launchers' IDs, which are serving locally at the user's workstation;\n* all corresponding artifacts (app source code, HTMLs, JS scripts, etc.);\n* information needed to connect to websocket live source code updater (not tested).\n\nI'm in doubt about the severity of this issue, because I don't know whether you assume the under-develop apps source code as confidential data. In the same time, I tried to use the disclosed nerdpack ID for doing something more severe, but with no success. You [specify](https://developer.newrelic.com/build-tools/new-relic-one-applications/guide-to-authentication--data-access--and-permissions) that app's ID is used to get access to the corresponding account data, but I wasn't successful with it. So I kindly ask you to determine the severity at your side. I've spent a lot of hours to escalate this further, but the ideas are over :)\n\n##Steps to reproduce\nThe `nr-ext.net` is used as a sandbox for running a user-supplied reactJS apps. NR1 creates an iframe pointing to something like `https://266bd739-2dfd-42e4-b000-be6ac0449ec9.g0.nr-ext.net/?nerdpacks=local\u0026use_version=d19c5d29`, which loads an app in its turn. But, if I just navigate to this URL with browser, the app is not loaded, it works only if it's loaded inside an iframe on NR1 (because of supportive code placed there, I think). That's why it's difficult to force a victim to visit my own app located at nt-ext.net.\nSo, to exploit this successfully, I had to copy a part of one.newrelic.com supportive code to my own domain and then load my own malicious app through iframe, as the legal one.newrelic.com does. So to reproduce this, you should either deploy all my complicated webserver somewhere or just use the one served by me at *xn--1xa.su*.\n\nFirst, you will need to serve some nerdpack locally.\n1) Install nr1 CLI at Ubuntu OS or macOS using a man from https://one.newrelic.com/launcher/developer-center.launcher\n2) Add some profile using the same man.\n3) Create a new nerdpack somewhere with `nr1 create`. You can select default options further.\n4) Navigate to the new nerdpack's dir and serve it locally with `cd your-nerdpack \u0026\u0026 nr1 nerdpack:serve`. You should see the following if everything is OK:\n{F644364}\n5) Navigate to https://a.nr-local.net:9973/nerdlets. This is data, which can be stolen by the attacker's website with iframe pointing to a malicious app inside.\n\nHere you can just visit my own malicious website at\n```\nhttp://xn--1xa.su:8888/launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher#launcher=eyJ0aW1lUmFuZ2UiOnsiYmVnaW5fdGltZSI6bnVsbCwiZW5kX3RpbWUiOm51bGwsImR1cmF0aW9uIjoxODAwMDAwfX0=\u0026pane=eyJuZXJkbGV0SWQiOiIyZWU2ZDk0Ny05NWYzLTRiNGItOTdjOS1hNDlmZTAxODQwZGYubXktbmVyZGxldCJ9\u0026state=IjE5QkMxNDVGLUEzNUEtMUM5OC1DMTQ4LUREMUY1NTM2QTIyNCI=\n```\nto see that the data you've seen at step 5 is available for reading by this malicious website:\n{F644369}\n\nOr, you can deploy this malicious webserver at any your domain and test this there:\n6) Extract a content of {F644370} somewhere\n7) Install python dependencies with `sudo pip install tornado`\n8) Run a server with `python server.py`\n9) Navigate to\n```\nhttp://\u003cYOUR_IP_OR_DOMAIN\u003e:8888/launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher#launcher=eyJ0aW1lUmFuZ2UiOnsiYmVnaW5fdGltZSI6bnVsbCwiZW5kX3RpbWUiOm51bGwsImR1cmF0aW9uIjoxODAwMDAwfX0=\u0026pane=eyJuZXJkbGV0SWQiOiIyZWU2ZDk0Ny05NWYzLTRiNGItOTdjOS1hNDlmZTAxODQwZGYubXktbmVyZGxldCJ9\u0026state=IjE5QkMxNDVGLUEzNUEtMUM5OC1DMTQ4LUREMUY1NTM2QTIyNCI=\n```\nand make sure the app is allowed to see the data you've seen at step 5.\n\n##Remediation\nThe root cause of this issue is misconfigured CORS policy at local nerdpack server.\nEvery published nerdpack is placed at its own associated subdomain of  `.nr-ext.net`. But, every origin ending with `.nr-ext.net` is allowed to read the data from `nr-local.net`, that allows **other** users' apps to read a victim's local server data.\n\nHere are vulnerable code lines of `3pp-cli-nerdpack-serve/src/ws/Orchestrator.js` local nerdpack server:\n```js\napp.use(\n            cors({\n                origin: (origin, callback) =\u003e {\n                    if (\n                        !origin ||\n                        origin.endsWith('.newrelic.com') ||\n                        origin.endsWith('.nr-ext.net')\n                    ) {\n                        callback(null, true);\n                    } else {\n                        callback(new Error('Not allowed by CORS'));\n                    }\n                },\n                credentials: true,\n            })\n        );\n```\n\nYou should make sure here that the subdomain of nr-ext.net is the same as the requested subdomain of nr-local.net, not just allow all subdomains of nr-ext.net.\n\n##PoC video\n{F644376}\n\nPlease let me know if you need some assistance to reproduce or mitigate the issue.\n\n## Impact\n\nDisclosure of:\n* the nerdpacks', nerdlets' and launchers' IDs, which are serving locally at the user's workstation;\n* all corresponding artifacts (app source code, HTMLs, JS scripts, etc.);\n* information needed to connect to websocket live source code updater (not tested).","bounty_amount":"625.0","formatted_bounty":"$625","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":644364,"file_name":"______________2019-11-26___20.36.14.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/No27p5fMrNwqM9p8nEiwVe3Q?response-content-disposition=attachment%3B%20filename%3D%22______________2019-11-26___20.36.14.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-11-26___20.36.14.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c057a1275bf729084bd0d73f260d012768f8b305309ca979af05f7794f8a067b","file_size":105330,"type":"image/png"},{"id":644367,"file_name":"______________2019-11-26___20.41.13.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iT6b7Qg78ZEkGrKEaBKoCBkp?response-content-disposition=attachment%3B%20filename%3D%22______________2019-11-26___20.41.13.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-11-26___20.41.13.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1a941559759664d34c84888a067c0865c4bc14c5d67153c65dfece10e8907acf","file_size":380420,"type":"image/png"},{"id":644369,"file_name":"______________2019-11-26___20.44.52.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EPCbYVPtLZjzRFkVsRDBBrzw?response-content-disposition=attachment%3B%20filename%3D%22______________2019-11-26___20.44.52.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-11-26___20.44.52.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2a33430ebe7da3be4da794e171cf5cbae4a17fea4ec5e3e0c0351862bc9b51ef","file_size":448388,"type":"image/png"},{"id":644370,"file_name":"nr-local-net-data-stealer.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/JheyFfikFkDPYwxaFMtxi9s5?response-content-disposition=attachment%3B%20filename%3D%22nr-local-net-data-stealer.zip%22%3B%20filename%2A%3DUTF-8%27%27nr-local-net-data-stealer.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=bb635f180c6691bfdae9f26df57178d0793008187eb750319c1f96f7e37db0b0","file_size":947268,"type":"application/zip"},{"id":644376,"file_name":"nerdpack-local-data-steal.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nFsNB8akEkXU8eE36SgBcs84?response-content-disposition=attachment%3B%20filename%3D%22nerdpack-local-data-steal.mp4%22%3B%20filename%2A%3DUTF-8%27%27nerdpack-local-data-steal.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1c36082dc78c70fdfa5f08aa26d3d9b5b39175054e6d9298852d624d449e7876","file_size":10227313,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-09-10T09:36:11.726Z","allow_singular_disclosure_after":-34235205.053608134,"singular_disclosure_allowed":true,"vote_count":2,"voters":["wi11","ali"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":31873,"asset_type":"URL","asset_identifier":"one.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6447961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nThank you for bringing this to our attention.\n\nI'm currently investigating this further and will revert back to you with any questions or further information if required.\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-12-02T14:31:00.806Z","updated_at":"2019-12-02T14:31:00.806Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6448068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nI just wanted some clarification on something.\n\nWhen mentioning disclosure you list: \n\n\u003e the nerdpacks', nerdlets' and launchers' IDs, which are serving locally at the user's workstation\n\nWhich I can see in your screenshot and PoC video, but you also mention: \n\n\u003e all corresponding artifacts (app source code, HTMLs, JS scripts, etc.)\n\nDo you mean the names/identifiers of the JS scripts/CSS files are listed such as `artifactid: my-js-script` or do you mean the actual source code of these files is visible/accessible? If visible/accessible I don't see this anywhere in your screenshot/PoC video.\n\nWould you be able to clarify this a little further for me and if possible provide steps/screenshots/video showcasing this?\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-12-02T14:44:38.361Z","updated_at":"2019-12-02T14:44:38.361Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6448081,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-12-02T14:45:39.365Z","updated_at":"2019-12-02T14:45:39.365Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6449209,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @jmcevoy,\n\nYou are correct, all the source codes are disclosed fully. I've just forgotten to inject a corresponding payload into my malicious app. I've fixed this so you can refresh your PoC link right now and you will see all the source codes are disclosed. Please note, that the disclosed source code is already built into the reactJS module.\n\nPoC video:\n{F648538}","automated_response":false,"created_at":"2019-12-02T15:44:16.021Z","updated_at":"2019-12-02T15:44:16.021Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":648538,"filename":"source_code_disclosure.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o8iHwNqypS4ndPTe61mJoq1E?response-content-disposition=attachment%3B%20filename%3D%22source_code_disclosure.mp4%22%3B%20filename%2A%3DUTF-8%27%27source_code_disclosure.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=59aa4798fff9472405ddc5ea4049c52e6e25cacab18d5eca8a5644f324d8966a"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6467086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nThank you for the additional information and video PoC.\n\nUnfortuntely at the moment I've been unable to reproduce this myself.\n\nI've created and served a nerdlet locally on my machine, then navigated to your site to see the results:\n\n```\nhttp://xn--1xa.su:8888/launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher#launcher=eyJ0aW1lUmFuZ2UiOnsiYmVnaW5fdGltZSI6bnVsbCwiZW5kX3RpbWUiOm51bGwsImR1cmF0aW9uIjoxODAwMDAwfX0=\u0026pane=eyJuZXJkbGV0SWQiOiIyZWU2ZDk0Ny05NWYzLTRiNGItOTdjOS1hNDlmZTAxODQwZGYubXktbmVyZGxldCJ9\u0026state=IjE5QkMxNDVGLUEzNUEtMUM5OC1DMTQ4LUREMUY1NTM2QTIyNCI=\n```\n\nThe page was unable to pull data from my local nerdlet. I get the following message in my terminal:\n\n```\n!  Warning: Your SID is [redacted].nr-local.net, but your browser is requesting a different SID.\n    This happens when the profile you are serving as ([redacted_account_name]) does not match the user and region (US/EU) you are logged into.\n```\n\nAnd your page simply shows the following:\n\n{F650261}\n\nI downloaded your `nr-local-net-data-stealer.zip`, unzipped the files, installed the dependencies in a virtual environment and ran your `server.py` file. I'm running this on localhost on my machine, when navigating to:\n\n```\nhttp://localhost:8888/launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher#launcher=eyJ0aW1lUmFuZ2UiOnsiYmVnaW5fdGltZSI6bnVsbCwiZW5kX3RpbWUiOm51bGwsImR1cmF0aW9uIjoxODAwMDAwfX0=\u0026pane=eyJuZXJkbGV0SWQiOiIyZWU2ZDk0Ny05NWYzLTRiNGItOTdjOS1hNDlmZTAxODQwZGYubXktbmVyZGxldCJ9\u0026state=IjE5QkMxNDVGLUEzNUEtMUM5OC1DMTQ4LUREMUY1NTM2QTIyNCI=\n```\n\nI simply get a 500 error.\n\n```\nHTTPServerRequest(protocol='http', host='localhost:8888', method='GET', uri='/launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher', version='HTTP/1.1', remote_ip='::1')\nTraceback (most recent call last):\n  File \"/Users/jmcevoy/data-stealer-nerdpack/nrcors/venv/lib/python3.7/site-packages/tornado/web.py\", line 1697, in _execute\n    result = method(*self.path_args, **self.path_kwargs)\n  File \"server.py\", line 28, in get\n    with open('/var/www/html/nrcors/' + fpath) as f:\nFileNotFoundError: [Errno 2] No such file or directory: '/var/www/html/nrcors/index.html'\nERROR:tornado.access:500 GET /launcher/2ee6d947-95f3-4b4b-97c9-a49fe01840df.my-launcher (::1) 1.00ms\n```\n\nWould you be able to give me some more information on why I might be getting these issues or any steps I'm missing? I could be misunderstanding something to do with how you are running this to achieve your results.\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-12-04T15:38:38.282Z","updated_at":"2019-12-04T15:38:38.282Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":650261,"filename":"Setup_Exercise___New_Relic_One.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pFPBN7qo5oP3JkdzMdcqevex?response-content-disposition=attachment%3B%20filename%3D%22Setup_Exercise___New_Relic_One.png%22%3B%20filename%2A%3DUTF-8%27%27Setup_Exercise___New_Relic_One.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8f039d0fd1281edc67d35e24f883bc0bfa85cd409f490a0e818a4b5d2c129005"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6467089,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-12-04T15:38:55.815Z","updated_at":"2019-12-04T15:38:55.815Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6469788,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @jmcevoy,\n\nI'm sorry, I was mistaken a little with this issue. The cause of your experience with the\n```\n!  Warning: Your SID is [redacted].nr-local.net, but your browser is requesting a different SID.\n    This happens when the profile you are serving as ([redacted_account_name]) does not match the user and region (US/EU) you are logged into.\n```\nis that I've missed that the local nerdpacks server uses SSL certificate to protect the connection. The cause itself is that I (attacker) don't know the real subdomain of the local nerdpack server (e.g. `cceaf5c8a3aea3ca355ebb98cbbb5451.nr-local.net`), so I tried to make a request to for instance `a.nr-local.net`. And it works for me because:\n* both of them are resolved simply into 127.0.0.1 so the browser sends the request to the correct host and port in fact (it's correct assumption);\n*  transmitted host header doesn't matter, the local nerdpack server works with any host header provided (and it's **almost** correct assumption). **I didn't take into account** the certificate verification process made by the browser. It worked at my side because my browser is set to always use a BurpSuite as a proxy, and the BurpSuite **skips** the certificate validation process (what is something new for me).\n\nSo, summing this up:\nWhen I tried to use a PoC, the browser made a request into `a.nr-local.net` through a BurpSuite, which set a connection up to `127.0.0.1` and skips the certificate validation. So it worked good, the browser didn't take into account that a domain, a request is made to, and certificate common name are different.\nWhen you tried to use a PoC, the browser made a request into `a.nr-local.net` directly and rejected a response because of an invalid certificate (certificate is issued for the domain `\u003csid\u003e.nr-local.net` and the domain requested is `a.nr-local.net`.\n\nWell, despite of the above, I've found a way to know the correct local nerdpacks server subdomain (sid) and so bypassed this limitation.\n\nNow, to reproduce the issue you can just visit the link `https://nr3.nr-assets.net/artifact-index-production/0c5931dd-3151-442c-b4d7-d850299529d4/0.1.0/guessSid.html`. This HTML page contains a script which detects correct victim's sid and then redirects him to the PoC URL I've reported in a first message, transmitting this correct sid to there. So the payload placed there will use this correct sid to make a stealing request and everything works fine.\n\nIf you need to deploy a PoC at your side, please follow the steps below:\n1) Install nr1 CLI at Ubuntu OS or macOS using a man from https://one.newrelic.com/launcher/developer-center.launcher\n2) Add some profile using the same man.\n3) Create a new nerdpack somewhere with `nr1 create`. You can select default options further.\n4) Navigate to the new nerdpack's dir and serve it locally with `cd your-nerdpack \u0026\u0026 nr1 nerdpack:serve`. You should see the following if everything is OK:\n{F644364}\n5) Extract content of {F650657} somewhere\n6) Install python dependencies with `sudo pip install tornado`\n7) Run a server with `python server.py \u003cYOUR_IP_OR_DOMAIN\u003e` (e.g. `python server.py localhost`)\n8) Navigate to `https://nr3.nr-assets.net/artifact-index-production/0c5931dd-3151-442c-b4d7-d850299529d4/0.1.0/guessSidOtherDomain.html?domain=\u003cYOUR_IP_OR_DOMAIN\u003e` (e.g. https://nr3.nr-assets.net/artifact-index-production/0c5931dd-3151-442c-b4d7-d850299529d4/0.1.0/guessSidOtherDomain.html?domain=localhost)\n9) Make sure the data is stolen correctly.\n\nI'm sorry for my mistakes, the issue is quite complicated and that's why I was incorrect.\n\nAnd just to be more clear: the main vulnerability cause is just wrong origin validation. You should either restrict all requests from `*.nr-ext.net` at all or (if \"ext\" and \"local\" instances should communicate) just allow only `\u003csid\u003e.nr-ext-net` origin to make requests. Then only the corresponding app will be able to read the local server data, not the malicious ones.","automated_response":false,"created_at":"2019-12-04T23:50:32.862Z","updated_at":"2019-12-04T23:50:32.862Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":650657,"filename":"nr-nerdlets-stealer-2.zip","type":"application/zip","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iwT7jgCKPE4CsKAYg9Pv1UVG?response-content-disposition=attachment%3B%20filename%3D%22nr-nerdlets-stealer-2.zip%22%3B%20filename%2A%3DUTF-8%27%27nr-nerdlets-stealer-2.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8df80389da48b21a7118fa2b6c8e90461dfcf1961fc3784cabb06a9ddae131a0"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6474121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans,\n\nThank you for running more tests and providing updated source code and PoC.\n\nUnfortunately I'm still unable to reproduce this.\n\nI've tried starting up my nerdlet on the command line and navigating to the URL you have specified:\n\n```\nhttps://nr3.nr-assets.net/artifact-index-production/0c5931dd-3151-442c-b4d7-d850299529d4/0.1.0/guessSid.html\n```\n\nHowever the page fails to redirect me and a blank page is just displayed. When checking the console in Chrome I can see that there are some errors, CORS policies appear to be blocking this.\n\n{F651441}\n\nWhen I tried the same URL in Firefox I received a similar issue:\n\n{F651447}\n\nI tried downloading and unpacking `nr-nerdlets-stealer-2.zip`, downloading the requirements with pip, and then running `python server.py localhost`.\n\nThen I navigated to:\n\n```\nhttps://nr3.nr-assets.net/artifact-index-production/0c5931dd-3151-442c-b4d7-d850299529d4/0.1.0/guessSidOtherDomain.html?domain=localhost\n```\n\nI encountered the same issues:\n\n{F651453}\n\nSo far I have been unable to reproduce or verify this issue, it appears that the CORS/security settings on my end are working correctly and preventing this from accessing my local data.\n\nCould there be something specific about your setup that is bypassing security controls or otherwise allowing your nerdlet to steal data from an unrelated local nerdlet?\n\nIf I have missed any steps or am doing something wrong here to reproduce this then please let me know.\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-12-05T14:53:22.693Z","updated_at":"2019-12-05T14:53:22.693Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":651453,"filename":"https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSidOtherDomain_html_domain_localhost_and_Mozilla_Firefox.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UwkgPZ7XuW162daYBQeuELGf?response-content-disposition=attachment%3B%20filename%3D%22https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSidOtherDomain_html_domain_localhost_and_Mozilla_Firefox.png%22%3B%20filename%2A%3DUTF-8%27%27https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSidOtherDomain_html_domain_localhost_and_Mozilla_Firefox.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=96c18bff3a95e3fa1d339d3031fe972ea41571f0067076bebf75ce3cbd21ce08"},{"id":651447,"filename":"Mozilla_Firefox_and_Inbox_-_HackerOne.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/agtgrnyHHmGNXTh7VHekkxqB?response-content-disposition=attachment%3B%20filename%3D%22Mozilla_Firefox_and_Inbox_-_HackerOne.png%22%3B%20filename%2A%3DUTF-8%27%27Mozilla_Firefox_and_Inbox_-_HackerOne.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8aaf5fdcd6d21b428907a040021be3bdfd1f394107250e2bfe88d7a168b082cb"},{"id":651441,"filename":"https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSid_html_and_cd_my-awesome-nerdpack____nr1_nerdpack_serve.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8dvVCDgaCXk1y2mnAHjS7M1V?response-content-disposition=attachment%3B%20filename%3D%22https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSid_html_and_cd_my-awesome-nerdpack____nr1_nerdpack_serve.png%22%3B%20filename%2A%3DUTF-8%27%27https___nr3_nr-assets_net_artifact-index-production_0c5931dd-3151-442c-b4d7-d850299529d4_0_1_0_guessSid_html_and_cd_my-awesome-nerdpack____nr1_nerdpack_serve.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b5d32005d0fe0ec6390cbb140fd0b4847af24047ca1696b29e12d446a23b4527"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6474129,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2019-12-05T14:54:08.679Z","updated_at":"2019-12-05T14:54:08.679Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6474211,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @jmcevoy,\n\nAs far as I see from your screenshots, the browser redirects you to a login page. The URL, which is protected by SOP and you are seeing a warning about, is `login.newrelic.com/loging?....` :\n{F651453}\n\nSo, can you please check if you are signed in the NR1 at the browser you are using to run a PoC? I've retested this using a private browser window and I noticed that the behavior is the same if I'm not signed in NR.\n\nPlease try to sign in the NR1 using the same account you use for deploying and serving the nerdpack before navigating the PoC link.\n\n","automated_response":false,"created_at":"2019-12-05T15:08:18.747Z","updated_at":"2019-12-05T15:08:18.747Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6474242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Joe, please try to navigate directly to the `one.newrelic.com` after signing in the NR. I think there may be some session cookies set, which are specific for NR1.","automated_response":false,"created_at":"2019-12-05T15:13:18.553Z","updated_at":"2019-12-05T15:13:18.553Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6474609,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-12-05T16:08:34.640Z","updated_at":"2019-12-05T16:08:34.640Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":576098,"new_severity_id":582014},"actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6474646,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @skavans,\n\nApologies there may have been an issue with my session previously.\n\nI was able to reproduce this issue after logging in again in my browser and I have now logged the issue with the appropriate team for remediation.\n\nAs always, thank you for your hard work and patience with this.\n\nThanks,\nJoe","automated_response":false,"created_at":"2019-12-05T16:12:42.434Z","updated_at":"2019-12-05T16:12:42.434Z","actor":{"username":"jmcevoy","cleared":false,"url":"/jmcevoy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6474662,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"{F651548}","automated_response":false,"created_at":"2019-12-05T16:16:23.650Z","updated_at":"2019-12-05T16:16:23.650Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","attachments":[{"id":651548,"filename":"homer-cigar-money.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9y4FkZZ55yqUV8Z6xMSBge3A?response-content-disposition=attachment%3B%20filename%3D%22homer-cigar-money.gif%22%3B%20filename%2A%3DUTF-8%27%27homer-cigar-money.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152256Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5a61a167b16f3d107f73ecd78fb483439e2593352d8e6306a6315bd5a92f99b2"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6474668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @jmcevoy.","automated_response":false,"created_at":"2019-12-05T16:17:13.730Z","updated_at":"2019-12-05T16:17:13.730Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8039997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @skavans . It looks like the team addressed this. I'm going to mark it as resolved but if you find a workaround please comment and I'll reopen the ticket and make sure you get the 25% bonus.","automated_response":false,"created_at":"2020-05-18T18:19:32.220Z","updated_at":"2020-05-18T18:19:32.220Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8039998,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-05-18T18:19:40.397Z","updated_at":"2020-05-18T18:19:40.397Z","actor":{"username":"scutler","cleared":false,"url":"/scutler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/460/179/2c3ae155f2d3e021cae9e7e75456335c3c5514cd_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8073739,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @scutler,\n\nUnfortunately, the issue is not fixed. The CORS is still misconfigured allowing requests from any subdomain of `nr-ext.net`.\n\nTo reproduce, follow the following steps:\n1) Install nr1 CLI at Ubuntu OS or macOS using a man from https://one.newrelic.com/launcher/developer-center.launcher\n2) Add some profile using the same man.\n3) Create a new nerdpack somewhere with `nr1 create`. You can select default options further.\n4) Navigate to the new nerdpack's dir and serve it locally with `cd your-nerdpack \u0026\u0026 nr1 nerdpack:serve`.\n5) Navigate to \nhttps://nr3.nr-assets.net/artifact-index-production/b83b9121-ba77-4093-b1a1-7b1e84e27b1a/0.1.0/redir2.svg\nand make sure you then will be redirected to the page which can read your locally running nerdpacks:\n {F838125}","automated_response":false,"created_at":"2020-05-21T23:24:16.008Z","updated_at":"2020-05-21T23:24:16.008Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":838125,"filename":"______________2020-05-22___02.23.53.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9bpeN6zXqpH1NDSPGSgBbGSb?response-content-disposition=attachment%3B%20filename%3D%22______________2020-05-22___02.23.53.png%22%3B%20filename%2A%3DUTF-8%27%27______________2020-05-22___02.23.53.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152257Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=35f8e92f9351be762afda7810c9d566eed5c1289880b086b04b6783444b900a0"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8073798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The correct link is the following:\nhttps://nr3.nr-assets.net/artifact-index-production/b83b9121-ba77-4093-b1a1-7b1e84e27b1a/0.1.0/redir3.svg\n\nPlease use Chrome at reproducing.","automated_response":false,"created_at":"2020-05-21T23:40:58.597Z","updated_at":"2020-05-21T23:40:58.597Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8136365,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Folks,\n\nIm sorry for the annoyance, but check this out also please :)","automated_response":false,"created_at":"2020-05-28T20:06:47.384Z","updated_at":"2020-05-28T20:06:47.384Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8137450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skavans,\n\nNot an annoyance at all. Sorry for the delay. I'm getting a connection refused for o1.su on 8888 when using the SVG. Guessing the server might not be running any longer?\n\nI'll try to get it working locally but if you see the same issue and fix it, let me know.","automated_response":false,"created_at":"2020-05-28T21:58:17.138Z","updated_at":"2020-05-28T21:58:17.138Z","actor":{"username":"dhartnell","cleared":false,"url":"/dhartnell","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8137988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @dhartnell,\n\nI'm sorry, the server was really down :(\nI fixed it so you can reproduce this easily.","automated_response":false,"created_at":"2020-05-28T22:14:13.112Z","updated_at":"2020-05-28T22:14:13.112Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8138124,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Right on! Thanks. I successfully reproduced it. I'll update the engineering team with the details. I'll get you another update when we have it. Here's that 25% bonus for the bypass as well.\n\nCheers!","automated_response":false,"created_at":"2020-05-28T22:21:10.423Z","updated_at":"2020-05-28T22:21:10.423Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"125.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8138130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","automated_response":false,"created_at":"2020-05-28T22:22:03.332Z","updated_at":"2020-05-28T22:22:03.332Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8902596,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-11T09:36:11.708Z","updated_at":"2020-08-11T09:36:11.708Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2020-08-13T08:30:59.201Z","updated_at":"2020-08-13T08:30:59.201Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8926713,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-13T13:31:07.184Z","updated_at":"2020-08-13T13:31:07.184Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8926714,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-13T13:31:07.329Z","updated_at":"2020-08-13T13:31:07.329Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}