{"id":90308,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDMwOA==","url":"https://hackerone.com/reports/90308","title":"User email enumuration using Gmail","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-09-24T10:30:16.848Z","submitted_at":"2015-09-24T10:30:16.848Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-12-23T04:24:31.595Z","bug_reporter_agreed_on_going_public_at":"2015-12-22T19:17:47.186Z","team_member_agreed_on_going_public_at":"2015-12-23T04:24:31.357Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nUsing Gmail it is possible to get the list of email addresses that use/have coinbase accounts. \n\nas a prerequisite: we will need a script to bruteforce a list of email addresses. consider this script:\n```python\nimport random\n#values only contain small letters and numbers\nletters = 'abcdefghijklmnopqrstuvwxyz0123456789'\ndef generateWord():\n        letter = ''\n        for i in range(12): #all possisble values are 12 in length\n                letter += random.choice(letters)\n        return letter\n#add all possible values to list\nfile = open(\"wordList.txt\",\"a\")\ncounter = 1;\nwhile True:\n\n        try:\n                #avoid duplicates\n                generated = generateWord()+\"@gmail.com;\n                file.write(generated)\n                print counter,\"words Generated so far\"\n                counter++;\n        except KeyboardInterrupt:\n                break \n```\nThat script will generate all the list of emails that can be created with *a-z+0-9*. this can easily be used with a dictionary bruteforce attack to generate more realistic emails like dave.egor@gmail.com (note: this is actually pretty much doable with a much powerful botnet who multi-thread this and give back the list of emails). \n\nThen we will add these contacts to our Google Contacts (google.com/contacts), then ask Coinbase to import contacts to invite. (https://www.coinbase.com/invite_friends). after Coinbase imported our contacts, it tries to provide a **feature** to tell if an account already have a Coinbase account or not. (see screenshot)\n\nIts pretty much known most people who use Bitcoin are those who want to hide their real identity. but by using this trick, it is to know the user list. I believe this is some sort of Duplicate of some issue because you probably taught of this, or not. but anyway, I am going to propose a way to fix it\n\n**Recommended Fix:** if a user is already a member to coinbase, the person who is inviting them doesn't need to know that. if he/she is already a member, the person inviting will see them as a normal email and will still see, \"Invite Sent\". but in the background, invite for memebers won't be sent and for non-memeber will be.\n\nThanks,\nP","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":54829,"file_name":"coinbase_enumurate.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/054/829/8317c1fd180ec62d05c7c52586deb0db459de7d4/coinbase_enumurate.JPG?response-content-disposition=attachment%3B%20filename%3D%22coinbase_enumurate.JPG%22%3B%20filename%2A%3DUTF-8%27%27coinbase_enumurate.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154036Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f8e5baf4ebf3e45449c558b7d8c5b0bb314f5c1564ab072bfc5d4ce9f3f58f28","file_size":21481,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-01-21T19:17:47.524Z","allow_singular_disclosure_after":-180562968.57074967,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sw33tlie","hariharan2005","omkarhacks","graciousgrace"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":600556,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-09-28T17:17:01.700Z","updated_at":"2015-09-28T17:17:01.700Z","actor":{"username":"coinbase9001","cleared":false,"url":"/coinbase9001","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nA fix has been merged to prevent enumeration when importing contacts, can you confirm that you are not able to reproduce this behavior anymore?\n\nThank you","automated_response":false,"created_at":"2015-09-28T18:21:33.242Z","updated_at":"2015-09-28T18:21:33.242Z","actor":{"username":"coinbase9001","cleared":false,"url":"/coinbase9001","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coinbase9001 confirmed! quick fix. \n\nThanks,","automated_response":false,"created_at":"2015-09-28T18:34:18.122Z","updated_at":"2015-09-28T18:34:18.122Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600716,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the detailed submission, awarding bounty for best practice.","automated_response":false,"created_at":"2015-09-28T18:48:34.175Z","updated_at":"2015-09-28T18:48:34.175Z","actor":{"username":"coinbase9001","cleared":false,"url":"/coinbase9001","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"paulos_","url":"/paulos_"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600717,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2015-09-28T18:48:54.683Z","updated_at":"2015-09-28T18:48:54.683Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"paulos_","url":"/paulos_"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@coinbase9001 thanks for the bounty. but this really isn't a defense-in-depth thingi, I mean there is no prerequisite here, like needed to be logged in to an account or xss or anything. this is truly exploitable. and an attacker with much resources can leak the entire list of Coinbase's user-list and email (now I know how much disapointting that should be, espeically to a BTC site). my point might not be valid to your perception, but if it were an angle you didn't consider, please reconsider the amount. I truly expected more.\n\nThanks,","automated_response":false,"created_at":"2015-09-28T18:55:45.025Z","updated_at":"2015-09-28T18:55:45.025Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":600780,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @paulos_,\n\nUser existence/enumeration vulnerabilities are specifically excluded in our  [program policy](https://hackerone.com/coinbase). Since we did choose to fix this, we've awarded the minimum $100 bounty as a courtesy.\n\nThanks.","automated_response":false,"created_at":"2015-09-28T19:46:09.999Z","updated_at":"2015-09-28T19:46:09.999Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":729846,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@coinbase2 ofcourse. thanks. :)\ndisclosure?","automated_response":false,"created_at":"2015-12-22T19:17:47.231Z","updated_at":"2015-12-22T19:17:47.231Z","first_to_agree":true,"actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":730461,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-23T04:24:31.384Z","updated_at":"2015-12-23T04:24:31.384Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":730462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-12-23T04:24:33.221Z","updated_at":"2015-12-23T04:24:33.221Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}