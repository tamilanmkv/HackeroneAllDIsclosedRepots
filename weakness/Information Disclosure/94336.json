{"id":94336,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NDMzNg==","url":"https://hackerone.com/reports/94336","title":"Minimum bounty of a private program is visible for users that were removed from the program","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-17T04:45:49.979Z","submitted_at":"2015-10-17T04:45:49.979Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"coolboss","url":"/coolboss","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-10-21T12:48:38.020Z","bug_reporter_agreed_on_going_public_at":"2015-10-21T12:48:37.536Z","team_member_agreed_on_going_public_at":"2015-10-20T19:26:34.517Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nPrivileged information is getting leaked to an unauthorized user in the json response of `https://hackerone.com/reports/\u003creport id\u003e.json`.\n\nIn a team there can be many members, also roles are defined. But an x-member of the team is getting information which should not be visible to him. (As I tested it on sandboxed team but it i believe it is also affecting other private programs )\n\nProof Of Concept :\n================\n1. UserA is part of TeamA.\n2. UserA creates a test report.\n3. Now, UserA can access the report via `Reports` tab.\n4. Admin now removes the UserA from the team.\n5. Now, UserA becomes X-user of the team.\n6. UserA canNOT access the team.\n7. But can access the test report which he/she created.\n\nWhen UserA accesses the report then a request is made to `https://hackerone.com/reports/\u003creport id\u003e.json`. Note the response for my test report.\n\n``\n{id: 94333, url: \"https://hackerone.com/reports/94333\", title: \"asdf\", state: \"Open\", substate: \"new\",…}\nabilities: {can_manage?: false, can_export?: false, can_add_comment?: true, can_change_state?: false,…}\nactivities: []\nbug_reporter_agreed_on_going_public_at: null\ncan_view_team: true\ncreated_at: \"2015-10-17T04:29:44.364Z\"\ncve_ids: []\ndisclosed_at: null\nexternal_advisory_url: null\nhas_bounty?: false\nid: 94333\nis_external_bug: false\nis_member_of_team?: false\nis_participant: true\nminimum_bounty: 1000\npublic: false\nreadable_substate: \"New\"\n....\n``\n\nHere, some fields like `minimum_bounty: 1000` and relevant team details are leaked. These fields are meant for only to people to whom the team is visible.\n\nAttack Scenario :\n==============\nI tested this bug on sandboxed team. But I believe this bug will affect the on going programs. Consider the scenario ...\nPrivate Program invites a User. User submits a bug. This bug will be visible to the user via `Reports` tab. Now, team decides to remove the User and removes him/her. Now, User can still get updates of the programs via the json response. The `team information` and `bounty details` are meant for only researchers who are invited to the program and people who are part of the team. \n\nLet me know if you have any questions.\n\nThanks,\nPranav","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-11-19T19:26:34.957Z","allow_singular_disclosure_after":-186005833.366401,"singular_disclosure_allowed":true,"vote_count":3,"voters":["jensec","japz","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":625069,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This is a very marginal exposure, as a team member that is removed from a team usually already knows all this information. The other option we would have would be to remove all reports from someone that is no longer allowed to access a team, but we've found that too extreme. We will not be fixing this, as we have made a conscious decision here between usability and secrecy.\n\nKind regards, \nDirk","automated_response":false,"created_at":"2015-10-19T16:32:32.646Z","updated_at":"2015-10-19T16:32:32.646Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":625267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your explanation seems valid but only regarding ex-team member being able to access the program's details. I doubt whether you have considered the case of a `researcher` being removed from a `private` program, provided researcher already submitted a report and later program owner makes some changes to the program. This privileged information will also get disclosed via `https://hackerone.com/reports/\u003creport id\u003e.json` to the researcher.\n\nI agree with you that there's a minimal exposure of information. But information is privileged and a `researcher` removed from a program should not be able to access the information. Given that I think the json response should not return the information.\n\nAwaiting for your response.","automated_response":false,"created_at":"2015-10-19T18:31:32.012Z","updated_at":"2015-10-19T18:31:32.012Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":625602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @pranav_hivarekar,\n\nMost of the information returned on the json is relevant to the report so it's reasonable for give access to reporter, even if they're no longer invited to the program (though it rarely happens). However, we think you made a good point that `minimum_bounty` is specific to the program/team and not the report itself. For best practice, we've removed the attribute from the payload from people not needing it.\n\nI agree with @dirk here that the exposure is rather minimal, and it doesn't seem to be a security vulnerability. We still appreciate your input, and would like to keep the closed state Informative. \n\nAgain, thanks for hacking!\n\n-Pei ","automated_response":false,"created_at":"2015-10-19T23:32:27.101Z","updated_at":"2015-10-19T23:32:27.101Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626279,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Pei,\n\nGlad to see that you did worked out and removed the `attribute`. :)\n\nAnyways bit curious to know, why this bug is stilled left out in `Informative` state? Since, you have made some changes, I believe this should be marked as `Resolved`. Also, I agree with all that bug exposed a very minimal amount of information and so it won't qualify for a bounty.\n\nStill I will leave it your discretion whether to change the state or leave it as it is.\n\nAnyways thanks for quick actions. :)\n\nRegards,\nPranav","automated_response":false,"created_at":"2015-10-20T15:56:25.706Z","updated_at":"2015-10-20T15:56:25.706Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626530,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2015-10-20T19:09:10.666Z","updated_at":"2015-10-20T19:09:10.666Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626531,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-10-20T19:09:20.079Z","updated_at":"2015-10-20T19:09:20.079Z","actor":{"username":"pei","cleared":false,"url":"/pei","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/939/2d83322336a492279dc84d8f92f280c2d54fcb5b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"coolboss","url":"/coolboss"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626548,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2015-10-20T19:26:22.251Z","updated_at":"2015-10-20T19:26:22.251Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-10-20T19:26:34.547Z","updated_at":"2015-10-20T19:26:34.547Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":626959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nCan you hide report details and write a summary only? Then we can disclose this.\n\nThanks,\nP","automated_response":false,"created_at":"2015-10-21T02:38:57.704Z","updated_at":"2015-10-21T02:38:57.704Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":627067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, but our policy is that we release the full details of any issue that we mark as resolved. Keep in mind that we may censor sensitive information as required/needed, but I don't see anything that would qualify as such in this report.","automated_response":false,"created_at":"2015-10-21T07:56:08.665Z","updated_at":"2015-10-21T07:56:08.665Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":627267,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Looks great ! :)","automated_response":false,"created_at":"2015-10-21T12:48:37.567Z","updated_at":"2015-10-21T12:48:37.567Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":627268,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-10-21T12:48:38.044Z","updated_at":"2015-10-21T12:48:38.044Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":629501,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2015-10-23T13:11:01.006Z","updated_at":"2015-10-23T13:11:01.006Z","additional_data":{"old_title":"Privileged information of a private/sandboxed program is leaked in json response to an unauthorized user","new_title":"Minimum bounty of a private program is visible for users that were removed from the program"},"actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":950,"category":"team","content":"In the response to a request on `/reports/\u003cid\u003e.json`, as the user that submitted the report, the minimum bounty of a team was returned. \n\nThis leads to a very minor information disclosure in the case a user submitted a report to an invite-only team. If the user is then removed from the program, they will still be able to access the report, and therefore be able to see the minimum bounty amount of the team.\n\nThis was mitigated by removing the minimum bounty from the response.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":13067,"username":"dirk","name":"Dirk Zittersteyn","bio":"","cleared":false,"website":"https://www.foo.com","location":"","created_at":"2014-10-15T13:50:22.541Z","url":"https://hackerone.com/dirk","anc_triager":false,"hackerone_triager":false,"hackerone_employee":true,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBalFPIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--2697aff1623d48613f764de4e0c79bdbdbe79e3c/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/profile_cropped.jpeg"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}