{"id":315205,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTUyMDU=","url":"https://hackerone.com/reports/315205","title":"Debug information disclosure on oauth-redirector.services.greenhouse.io","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-12T14:25:54.376Z","submitted_at":"2018-02-12T14:25:54.376Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ajxchapman","url":"/ajxchapman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":312,"url":"https://hackerone.com/greenhouse","handle":"greenhouse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Greenhouse.io","twitter_handle":"","website":"https://app.greenhouse.io","about":"Software to optimize your entire recruiting and onboarding process."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-29T07:55:34.158Z","bug_reporter_agreed_on_going_public_at":"2020-01-30T07:55:32.690Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nThe configuration of the Sintra framework application hosted at `oauth-redirector.services.greenhouse.io` exposes internal information when exceptions occur. The application is configured with the `show_exceptions` setting which causes internal application configuration, environment variables and source code snippets to be exposed when exceptions occur.\n\n**Description:**\nWhen an unhandled exception occurs (such as providing an invalid `oauth_redirect_uri` cookie value to `/integrations/oauth/create`) the application produces a nicely formatted error page which lists internal application data such as configuration, environment variables and source code snippets.\n\nThis issue was identified whilst assessing the security of the OAuth login function at https://app.greenhouse.io/users/sign_in\n\n## Steps To Reproduce:\n1. Send the following HTTP request to https://oauth-redirector.services.greenhouse.io/integrations/oauth/create?state=x\u0026code=x:\n\n```HTTP\nGET /integrations/oauth/create?state=x\u0026code=x HTTP/1.1\nHost: oauth-redirector.services.greenhouse.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:58.0) Gecko/20100101 Firefox/58.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: oauth_redirect_uri=https%3A%2F%2Fapp.\u003cx\u003egreenhouse.io%2Fusers%2Fauth%2Fgoogle_oauth2%2Fcallback\nConnection: close\n\n```\n\n## Supporting Material/References:\nSee the attached screenshot and saved HTML of an application error.\n\n## Impact\n\nInformation provided by this exception, or other exceptions exposed by the Sintra framework due to the `show_exceptions` configuration setting, could allow an attacker to obtain sensitive internal configuration or source code snippets.","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":83,"name":"Information Exposure Through Debug Information"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":262638,"file_name":"greenhouse.io.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/262/638/6be88f08b116c395a8c3ff125a74e474787ea282/greenhouse.io.html?response-content-disposition=attachment%3B%20filename%3D%22greenhouse.io.html%22%3B%20filename%2A%3DUTF-8%27%27greenhouse.io.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144353Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=934d2d300f66e19e17b217e71380a7c44116d9cb4feb8d766d223d7ab725dac7","file_size":208904,"type":"text/html"},{"id":262639,"file_name":"Screen_Shot_2018-02-12_at_14.08.09.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/262/639/6e5b0847b937a4a71bc1ec4705e2dfeb278f3f45/Screen_Shot_2018-02-12_at_14.08.09.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-12_at_14.08.09.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-12_at_14.08.09.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144353Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=79250ee10f0143728a2dcab7525244bab1fca935f669b796e061c9a0031a93e5","file_size":442200,"type":"image/png"}],"allow_singular_disclosure_at":"2020-02-29T07:55:32.754Z","allow_singular_disclosure_after":-51000500.99419275,"singular_disclosure_allowed":true,"vote_count":28,"voters":["daehee","a_d_a_m","sameerphad72","mik317","ali","realtess","powerjacobb1","eveeez","tuplesec","domssilva","and 18 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":9056,"asset_type":"URL","asset_identifier":"app.greenhouse.io","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2376177,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @noxrnet, \n\nThanks for the submission. We have triaged this issue and will let you know once a fix has been released. ","automated_response":false,"created_at":"2018-02-12T17:34:43.593Z","updated_at":"2018-02-12T17:34:43.593Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2422134,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @noxrnet,\n\nA fix for this issue has been released. Can you confirm it on your end as well?","automated_response":false,"created_at":"2018-02-22T16:55:26.645Z","updated_at":"2018-02-22T16:55:26.645Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2422135,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2018-02-22T16:55:36.439Z","updated_at":"2018-02-22T16:55:36.439Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2422948,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @rongutierrez,\n\nI can confirm I can no longer reproduce this issue. I've tried with injecting the original payload, and other characters which may cause an error and either receive a \"400 Bad Request\" response with no sensitive information, or a \"302 Found\" response to https://app.greenhouse.io/users/sign_in. I consider this issue fixed.\n\nThanks.","automated_response":false,"created_at":"2018-02-22T19:38:12.113Z","updated_at":"2018-02-22T19:38:12.113Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2425816,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for confirming. I will mark this issue resolved and award you a bounty. ","automated_response":false,"created_at":"2018-02-23T14:47:20.984Z","updated_at":"2018-02-23T14:47:20.984Z","actor":{"username":"rongutierrez","cleared":false,"url":"/rongutierrez","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ajxchapman","url":"/ajxchapman"},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2425817,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-02-23T14:47:30.917Z","updated_at":"2018-02-23T14:47:30.917Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Greenhouse.io"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"greenhouse","collaborator":{"username":"ajxchapman","url":"/ajxchapman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4436801,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2019-04-01T22:25:15.793Z","updated_at":"2019-04-01T22:25:15.793Z","actor":{"username":"lcvicknair","cleared":false,"url":"/lcvicknair","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"app.greenhouse.io","genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6916510,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi Team, I'm looking though my old reports to find ones which may be eligible for disclosure. Do you have any issues disclosing this issue?\n\nThanks","automated_response":false,"created_at":"2020-01-30T07:55:32.712Z","updated_at":"2020-01-30T07:55:32.712Z","first_to_agree":true,"actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7181306,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-02-29T07:55:34.183Z","updated_at":"2020-02-29T07:55:34.183Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Greenhouse.io"}},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}