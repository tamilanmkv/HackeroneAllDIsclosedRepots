{"id":215384,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTUzODQ=","url":"https://hackerone.com/reports/215384","title":"[Subgroups] Unprivileged User Can Disclose Private Group Names","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-22T16:14:59.742Z","submitted_at":"2017-03-22T16:14:59.742Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ysx","url":"/ysx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-30T06:18:52.225Z","bug_reporter_agreed_on_going_public_at":"2017-03-30T06:18:52.150Z","team_member_agreed_on_going_public_at":"2017-03-30T02:31:32.767Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi @briann and team,\n\nCongratulations on the launch of GitLab 9.0! While exploring Subgroup functionality, I noticed that an unprivileged user can disclose private group names by incrementing the `parent_id` parameter. \n\n## Proof of Concept\nTo reproduce this issue, I set up a fresh GitLab 9.0 CE server and created a Private Group using the `root` account. Afterwards, I created an unprivileged user (no group or project assignments) and visited the below URL, disclosing the name of `PrivateGroup`.\n\nAttempting to access the `PrivateGroup` via the standard routes (e.g. Group Page) presents the unprivileged user with the expected 404 page.\n\n```\nhttp://\u003cinstance\u003e/groups/new?parent_id=2\n```\n\n### Screenshot\n{F170581}\n\nThanks!","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":170581,"file_name":"ExposedGroupName.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/170/581/7cecbf8f0cedb79ef2cf7b66c2a35ff65797e6c9/ExposedGroupName.png?response-content-disposition=attachment%3B%20filename%3D%22ExposedGroupName.png%22%3B%20filename%2A%3DUTF-8%27%27ExposedGroupName.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRCOM766B%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140517Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC2plSLprTu8RjGD8JYtZWBPt0cszlQG9FE345fmJX2hAIhALFlvJYKDzrEhN7%2FvlACW3w%2FuqitMoDByli%2BB32UD4xHKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igydotw%2BzjeVoEUzifsq1wO17iYJRnZ0fDCk2qA3GFkCAi2TACWamwiykehERisJcA6JAf5%2BKDXCSCA9Z5sJN1RS6yYikkzrd1g0%2FNHQvlKNEb%2F0bkFdpBo983pYtuPm%2FjZwdUmgycUkQTsKElvIdrra2ORU8syHUfTSsU0jkhKy1nTU1EUbOyVSpNZUO9kXRRe3ohujd32sjmj8LzGUv8aTvRQduIzkPVeEQOKzFH7EgJMvdNR3vaK2TDhSXjMkBaQKBFqnh6PEMyOLZDUpbrlIy%2BoEq2r%2B%2F10hoGkdsLCXXLTZ6FqEIiLpzSb0Iu7CYkr0MdHXUykD4DOTntKsy9rifi4r4BROm%2BFSV7DvWqgt3W4BdQyDDpqk1mezBTFX0MzxjgcpwKW8P9MAJbLCDmqfTTPFk4Q3hwN161Se85vO9XLNOyRVtPGBxj7OBbf9ALPJ5O3JeDoWAJMilj8zwYEUZ8HB%2BwxjDJ9XD8WIvUhkGyonPTYta41EE5Apa%2BuA9mDzlzHtztW9QWk0A9Sy6yWDe5RV1BvTfuQDIENmCujUYeHBAI1LctTr5dAfQfpbR25kBWiGSGkGj66CsyM%2Fv4WpFwB06OZt5%2FWKkqDvm8EJ4nRBeXyQEZgKwI6%2BBfR8uHZJrNaXh7ww%2FuiQiwY6pAG6PxCWeEgmj5NWNLAASGSJOsH%2B4v2Ym%2BQKqlIQLRYFFWUC%2FZOjX8OosfCA%2F2VoFSUqa9gE9u1ak8ebfBQMrD4qWG%2BNBuWtrVAT0zNhYQeLm7qYZBf6nK1%2F4Q%2FfiKY5Hwm5q1KG1XzDtwU7hRI5PfdeIVO1imHecmyw8jlgyE%2Bpn%2Bt6DW7WJdNcVKLCb%2BX4TDKDa3Lt%2FOx7FpCltN7n4hWkIyVpiw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9e7967f7dd066b03920c2dabe885cfa4751bef43c8d39ca0f2fd84d686ecb81b","file_size":68294,"type":"image/png"}],"allow_singular_disclosure_at":"2017-04-29T02:31:32.803Z","allow_singular_disclosure_after":-140528025.071141,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","linkks","japz","spetr0x","rashedul_css","wargsec","osho77"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1557443,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Upon attempting to create a Subgroup within a Private Group where access is not permitted, the following error is presented (as expected):\n\n{F170582}","automated_response":false,"created_at":"2017-03-22T16:16:34.685Z","updated_at":"2017-03-22T16:16:34.685Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":170582,"filename":"AddGroup_AccessControl.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/170/582/967d4e6e0a22a5163f8c7319f94fc28c34b191c5/AddGroup_AccessControl.png?response-content-disposition=attachment%3B%20filename%3D%22AddGroup_AccessControl.png%22%3B%20filename%2A%3DUTF-8%27%27AddGroup_AccessControl.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRCOM766B%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140517Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQC2plSLprTu8RjGD8JYtZWBPt0cszlQG9FE345fmJX2hAIhALFlvJYKDzrEhN7%2FvlACW3w%2FuqitMoDByli%2BB32UD4xHKoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5Igydotw%2BzjeVoEUzifsq1wO17iYJRnZ0fDCk2qA3GFkCAi2TACWamwiykehERisJcA6JAf5%2BKDXCSCA9Z5sJN1RS6yYikkzrd1g0%2FNHQvlKNEb%2F0bkFdpBo983pYtuPm%2FjZwdUmgycUkQTsKElvIdrra2ORU8syHUfTSsU0jkhKy1nTU1EUbOyVSpNZUO9kXRRe3ohujd32sjmj8LzGUv8aTvRQduIzkPVeEQOKzFH7EgJMvdNR3vaK2TDhSXjMkBaQKBFqnh6PEMyOLZDUpbrlIy%2BoEq2r%2B%2F10hoGkdsLCXXLTZ6FqEIiLpzSb0Iu7CYkr0MdHXUykD4DOTntKsy9rifi4r4BROm%2BFSV7DvWqgt3W4BdQyDDpqk1mezBTFX0MzxjgcpwKW8P9MAJbLCDmqfTTPFk4Q3hwN161Se85vO9XLNOyRVtPGBxj7OBbf9ALPJ5O3JeDoWAJMilj8zwYEUZ8HB%2BwxjDJ9XD8WIvUhkGyonPTYta41EE5Apa%2BuA9mDzlzHtztW9QWk0A9Sy6yWDe5RV1BvTfuQDIENmCujUYeHBAI1LctTr5dAfQfpbR25kBWiGSGkGj66CsyM%2Fv4WpFwB06OZt5%2FWKkqDvm8EJ4nRBeXyQEZgKwI6%2BBfR8uHZJrNaXh7ww%2FuiQiwY6pAG6PxCWeEgmj5NWNLAASGSJOsH%2B4v2Ym%2BQKqlIQLRYFFWUC%2FZOjX8OosfCA%2F2VoFSUqa9gE9u1ak8ebfBQMrD4qWG%2BNBuWtrVAT0zNhYQeLm7qYZBf6nK1%2F4Q%2FfiKY5Hwm5q1KG1XzDtwU7hRI5PfdeIVO1imHecmyw8jlgyE%2Bpn%2Bt6DW7WJdNcVKLCb%2BX4TDKDa3Lt%2FOx7FpCltN7n4hWkIyVpiw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1b9819d6359d190f5aa8c1eb867fc071e1a66b54ea4e84b6dc6118d6ad7a29c4"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1558233,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @ysx,\n\nI've verified your finding and opened a confidential issue for discussion and remediation: https://gitlab.com/gitlab-org/gitlab-ce/issues/29875\n\nThat issue will be opened to the public when the patch is released. I'll update you here on our progress and when a patch is available. Thanks for the report, nice find!","automated_response":false,"created_at":"2017-03-22T21:09:39.098Z","updated_at":"2017-03-22T21:09:39.098Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572015,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @ysx,\n\nA patch for this vulnerability was included with our security release 9.0.2:\n\nhttps://about.gitlab.com/2017/03/29/gitlab-9-dot-0-dot-2-released/\n\nThanks again for the report! Acknowledgement for this vulnerability was be reflected on our vulnerability acknowledgements page later this evening.","automated_response":false,"created_at":"2017-03-30T02:31:07.513Z","updated_at":"2017-03-30T02:31:07.513Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ysx","url":"/ysx"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572016,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-30T02:31:32.785Z","updated_at":"2017-03-30T02:31:32.785Z","first_to_agree":true,"actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572210,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"\u003e A patch for this vulnerability was included with our security release 9.0.2\n\nGreat to hear.\n\n\u003e Thanks again for the report! Acknowledgement for this vulnerability was be reflected on our vulnerability acknowledgements page later this evening.\n\nThank you @briann – no problem!","automated_response":false,"created_at":"2017-03-30T06:18:52.176Z","updated_at":"2017-03-30T06:18:52.176Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572211,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-30T06:18:52.240Z","updated_at":"2017-03-30T06:18:52.240Z","actor":{"username":"ysx","cleared":false,"url":"/ysx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}