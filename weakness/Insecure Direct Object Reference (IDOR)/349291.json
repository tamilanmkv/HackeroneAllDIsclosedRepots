{"id":349291,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDkyOTE=","url":"https://hackerone.com/reports/349291","title":"IDOR via internal_api \"users\" endpoint ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-09T04:58:41.713Z","submitted_at":"2018-05-09T04:58:41.713Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jon_bottarini","url":"/jon_bottarini","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-04T10:55:54.693Z","bug_reporter_agreed_on_going_public_at":"2020-08-20T02:46:48.295Z","team_member_agreed_on_going_public_at":"2020-09-04T10:55:54.581Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While trying to figure out what the heck is going on with #347664, I stumbled upon another way to perform the \"gift that keeps on giving\" as @ahamlin put it. \n\n# Steps to reproduce:\n\n1. Add a unconfirmed user to your account\n2. Navigate to https://alerts.newrelic.com/accounts/1523936/channels\n3. Click on the unconfirmed user's account (the name will be starred out and obfuscated on this first page), it'll bring up this page with the First 'N Last name exposed:\n\n{F295255}\n\nJSON response:\n```\n{\"firstName\":\"First\",\"lastName\":\"'N Last\",\"email\":\"admin@newrelic.com\",\"channelId\":0,\"gravatarHash\":\"fde93a66cbe380421b712705064c6223\"}\n```\nFull URL: https://alerts.newrelic.com/internal_api/1/accounts/1523936/users/517408\n\n## Impact\n\nIDOR","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":295255,"file_name":"Screen_Shot_2018-05-08_at_9.51.37_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/295/255/44a705bc0b9d9fa4c721f34ee305b2a7f55a6dc5/Screen_Shot_2018-05-08_at_9.51.37_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-05-08_at_9.51.37_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-05-08_at_9.51.37_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144906Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=825f8d3adcd0ce8da3e1516be1d719ff3542cb87e6d0b44f0140aaae014831de","file_size":89439,"type":"image/png"}],"allow_singular_disclosure_at":"2020-09-19T02:46:48.333Z","allow_singular_disclosure_after":-33480138.177944068,"singular_disclosure_allowed":true,"vote_count":76,"voters":["wi11","kraken0110","ali","johndoe1492","ahiezer","mansoor0x01","jgu","sudi","rahulkadavil_","pahadi","and 66 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6454,"asset_type":"URL","asset_identifier":"alerts.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2721656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @jon_bottarini,\n\nWe're at an internal engineering offsite this week, so I'm a little behind in triaging reports. I'll try and get you a real response tomorrow!\n\nIt shouldn't take all too long – after all, we ought to be getting pretty good at reproducing these by now.\n\nCheers,\nAlex","automated_response":false,"created_at":"2018-05-09T23:11:44.445Z","updated_at":"2018-05-09T23:11:44.445Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2726623,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've reproduced this issue. After the last round of these vulnerabilities, we moved towards a model where this data is pulled from the same source (minimizing the number of places where we can mess this up), so I have a sneaking suspicion that this will be fixed from the work to remediate #347665.\n\nI'll have to track down some engineers to investigate, which is a bit difficult due to the aforementioned engineering offsite. If these reports are both due to a single root cause, I'll close this as a duplicate of the other, but if this is a unique bit of broken logic we'll absolutely triage this as usual.\n\nCheers,\nAlex","automated_response":false,"created_at":"2018-05-10T21:48:13.806Z","updated_at":"2018-05-10T21:48:13.806Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2748109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ahamlin! No worries, I think this one would be separate just from my own limited knowledge of where the data is being pulled - but you have the backend knowledge so I'll leave it to your team to look at it. Thanks for the insight on these issues (and other reports). It's very valuable for me to know how the org/codebase is structured so that I can think of ways to bypass it. \n\nAdditionally, I noticed on Twitter that one of the the NR busses broke down on the way to the offsite - hope you weren't on that bus! \n\nCheers, \n\nJon ","automated_response":false,"created_at":"2018-05-15T19:24:14.463Z","updated_at":"2018-05-15T19:24:14.463Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2774731,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @jon_bottarini,\n\nWe've determined that this issue is distinct from #347665, and is actually a result of us failing to totally mitigate #344309. We've reopened the issue with the engineering team, and will keep you updated on its progress.\n\nCheers,\nAlex","automated_response":false,"created_at":"2018-05-21T17:49:45.645Z","updated_at":"2018-05-21T17:49:45.645Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2774733,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-05-21T17:50:05.338Z","updated_at":"2018-05-21T17:50:05.338Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"New Relic"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"jon_bottarini","url":"/jon_bottarini"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2777001,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ahamlin, much appreciated. I thought so too :) \n\nLet me know when they think it's fixed, and I'll start thinking of ways to break it again 👍🏽","automated_response":false,"created_at":"2018-05-22T06:14:09.618Z","updated_at":"2018-05-22T06:14:09.618Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2813840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The UI element should now be properly obfuscated, and we're now working on fixing the internal_api endpoint.\n\nHere's a live view of our engineers diligently working on this class of issues:\n\n{F303049}","automated_response":false,"created_at":"2018-05-29T18:28:38.635Z","updated_at":"2018-05-29T18:28:38.635Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":303049,"filename":"whack-a-finger.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/303/049/138877ff5899a1d7661e866b27c40b0a02882698/whack-a-finger.gif?response-content-disposition=attachment%3B%20filename%3D%22whack-a-finger.gif%22%3B%20filename%2A%3DUTF-8%27%27whack-a-finger.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2T6DG5UU%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144906Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQCyGt%2F6wKTb7WdhbTEehok3geSSNypgF1jy9glhzjfqmQIhAN%2FZ96OUsxT3l%2FcNh%2BJaiqKBQp%2B0XefuAf%2BhfC%2FmhMZBKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxZblqGtDqM2dUzvNgq1wMBRL4HwjcRdARKHRTYG1WTOwsUnNm5pyWIDl6UX7cxu3S9pxhLAGamITa%2Bry536DE0dNafGhdIyPeponbLp8FxjTVDEDmVrSlc3vq07ilX%2FsvaFMPbfLwUFwN8DcJVAZSLYZA6zDdeKNCgrZ1ISy%2BuSl%2F8sa9Nj%2FKFffdAxrEzWdcbmnUnTxt6PFvOqigHySvKHcRU1WUlzR%2BJNQhShWoYk3WMwt3lGEOyDeyEBa1PjWzXfwU5hwfOCygWSHeqe3rws%2Fy%2FAjcJ4Igs3dp7VWi2gpey9dMnBlv29eq43WYKyQ6K0q%2FC9l73EFZqlsoZAnNWCF%2BaMWp%2FSNCQCoi6LiyTT3H7xbPsVAE%2F%2B6%2B%2Fmd5o4HWlwOrPWTPapPHw%2BSF0OGtEIdy9BSNcjjpsTprmH3CxZWrOiVUBzDRDrImWT3QqtKWRETxE5UkMEesELPvS1Vr78fUKmIPG33W64ks49siCJg%2BYlvii52MslCAhwi8OBai4EvmsepnSL4Y7WjbGc31Zh7uWP1tOMXaSXgoK4ZXpbX9aNZgfinEq%2FEdjmz1acLqkVL8LTALuORrCaSQNzbL1VsrMHnDQY5Ip6UHG9W3WhTLOB2rMmAx%2FYtqF%2F2HrLRQRuA5lXPow%2F4aRiwY6pAFiuHIrJ99Gk48YedhIWLylCmpLudXTrjRTQ5%2BPJgz8sHy%2FJL%2BbYgchWh7RyeRvXCGWkecfBiAUWkHftxJlLxZP3R4oliu1hG1pnP80N0SBXLpKCFAQqqhncEnNPuXaqUaPMjKqpRRMw76WlTCCpu34SiacreJDZDO6dLymqMm3OX1OpD5Y13L2IbUTLcllZFway4EkA3FPk2PKaxAARwJYsWedpQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=80df10fc6d6d729d74d7f1689aa4bee263da5325ca1f05ffe8be60ff6d4109b1"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3075241,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @jon_bottarini, this instance of this issue should now be resolved. #347665 may take a bit more time, but we'll let you know once we've taken care of it!\n\nThanks,\nAlex","automated_response":false,"created_at":"2018-07-20T17:23:58.161Z","updated_at":"2018-07-20T17:23:58.161Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jon_bottarini","url":"/jon_bottarini"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3089196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great to hear @ahamlin - Thanks! ","automated_response":false,"created_at":"2018-07-24T04:45:05.812Z","updated_at":"2018-07-24T04:45:05.812Z","actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8984354,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-20T02:46:48.315Z","updated_at":"2020-08-20T02:46:48.315Z","first_to_agree":true,"actor":{"username":"jon_bottarini","cleared":true,"url":"/jon_bottarini","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9127930,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-04T10:55:54.613Z","updated_at":"2020-09-04T10:55:54.613Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9127931,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-04T10:55:54.721Z","updated_at":"2020-09-04T10:55:54.721Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}