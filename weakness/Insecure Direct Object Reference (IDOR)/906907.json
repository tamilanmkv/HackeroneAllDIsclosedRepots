{"id":906907,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDY5MDc=","url":"https://hackerone.com/reports/906907","title":"IDOR with Geolocation data not stripped from images","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-06-24T15:26:46.071Z","submitted_at":"2020-06-24T15:26:46.071Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"do_some_hack","url":"/do_some_hack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-26T15:36:33.868Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-06-26T15:36:31.539Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Vulnerable URL :-   https://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\n\nVulnerability Discription:\nWhen an image is taken using a smartphone or camera certain metadata fields are often attached to it. These fields could include the model of the camera, the time it was taken, whether the flash was used, the shutter speed, focal length, light value and even the location. In Inturn, while uploading the image as a profile picture, the exif data is not stripped from images. The exif data in images contains sensitive data like Geoloacation, latitude, longitude, etc. Also it contains the camera information and other details. \n\nAnd your website vulnerable to image IDOR which allows attacker to see other users images and retrive data using tool.\n\nTools Used: exiftool.\n\nSteps TO reproduce:\n\nUse  2 accounts in two browser\n\nDownload images from here \n\nhttps://github.com/ianare/exif-samples/tree/master/jpg/gps\n\n1)In 1st account in network user can upload files just upload the image their and open image link in new tab.\n\n new tab that image url like\n\nhttps://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\n\n2)In second account do same things and that url like down \n\nhttps://usercontent.irccloud-cdn.com/file/ZUsZU7az/3.jpg\n\n3) Change 1st account Url parameter value to 2nd acoount Url parameter(see poc for it).\n\n4) now image will shows up copy that url again and paste it to image data retrival website\n\nhttp://exif.regex.info/exif.cgi\n\n5) and see sensitive data   exposed.\n\n## Impact\n\n1) By this the attacker tracks your location and use it for personal things.\n2) Sensitive data exposed.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":881191,"file_name":"2020-06-24_08-17-01.mkv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o6p2Wf6DCER29AMPcBRPZxEH?response-content-disposition=attachment%3B%20filename%3D%222020-06-24_08-17-01.mkv%22%3B%20filename%2A%3DUTF-8%27%272020-06-24_08-17-01.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154105Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=51bc2328c8b3defe715d5befe6b509bc82083bf85b3889f6b40d37a66be92906","file_size":12503328,"type":"video/x-matroska"}],"allow_singular_disclosure_at":"2020-07-26T15:36:31.619Z","allow_singular_disclosure_after":-38189074.35254549,"singular_disclosure_allowed":true,"vote_count":41,"voters":["run_win","mohamed-magdi","remonsec","prophet","alp","mik317","ali","ashima255","mansoor0x01","mattberg","and 31 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":256,"asset_type":"URL","asset_identifier":"www.irccloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8402779,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report. We have identified the issue where EXIF info is not being removed and have deployed a fix. The fix applies to all existing file, but existing URLs may still show cached content. Please can you verify from your side?","automated_response":false,"created_at":"2020-06-25T06:44:12.642Z","updated_at":"2020-06-25T06:44:12.642Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"IRCCloud"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"do_some_hack","url":"/do_some_hack"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8407002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty but i am expecting more but its ok.\nand i verified the bug but it still showing me EXIF data  and IDOR still exist.","automated_response":false,"created_at":"2020-06-25T14:21:29.770Z","updated_at":"2020-06-25T14:21:29.770Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8410053,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"As I mentioned, the existing URLs may still be cached. Please try uploading a new image and see if you still get EXIF geo location.\n\nIf by IDOR, you mean that file upload URLs are not private, then yes, this is by design. Files are intended to be shared on public IRC networks with people who are not IRCCloud users. This is similar to imgur URLs.","automated_response":false,"created_at":"2020-06-25T18:23:49.521Z","updated_at":"2020-06-25T18:23:49.521Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8415001,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"you are right i am not able to get EXIF data , now i can say that issue is resolved.","automated_response":false,"created_at":"2020-06-26T08:11:58.557Z","updated_at":"2020-06-26T08:11:58.557Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8415012,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for verifying and reporting the issue.","automated_response":false,"created_at":"2020-06-26T08:12:44.377Z","updated_at":"2020-06-26T08:12:44.377Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"do_some_hack","url":"/do_some_hack"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8415082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello jwheare,\n    I want to disclose this vulnerability.please help me to disclose it.","automated_response":false,"created_at":"2020-06-26T08:19:37.517Z","updated_at":"2020-06-26T08:19:37.517Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8420373,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You can usually request disclosure yourself directly. Here you go.","automated_response":false,"created_at":"2020-06-26T15:36:31.556Z","updated_at":"2020-06-26T15:36:31.556Z","first_to_agree":true,"actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8420933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks","automated_response":false,"created_at":"2020-06-26T16:29:44.561Z","updated_at":"2020-06-26T16:29:44.561Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8757638,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-07-26T15:36:33.900Z","updated_at":"2020-07-26T15:36:33.900Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"IRCCloud"}},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}