{"id":434715,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzQ3MTU=","url":"https://hackerone.com/reports/434715","title":"No session expiry after log-out and session id exposed in URL","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-11-06T06:45:21.009Z","submitted_at":"2018-11-06T06:45:21.009Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"amalyoman","url":"/amalyoman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-24T11:48:12.926Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-04T11:09:19.473Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nThere is no session expiry after log-out which can help an attacker to take-over the full account by reusing it. The `JSESSIONID` which is vulnerable can be used unlimited times even after the password change. The server will keep on creating an unlimited number of sessions after each log-in which will never expire and can be reused again and again. The URL is having the session which can be captured by an attacker, URL should not contain any sensitive information.\n\n##Reproduction Steps\n1. Log in and go to https://sandbox.open-xchange.com/appsuite/ui#!!\u0026app=io.ox/settings\u0026folder=virtual/settings/administration/groups\n2. Enter or change the data\n3. Capture the request\n4. Logout and use the same captured request\n\n##POC Video\n{F371212}\n\n## Impact\n\nBasically, implementing an expiration for the session parameter and removing the sensitive information from URL will resolve this issue.","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":90,"name":"Insufficient Session Expiration"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":371212,"file_name":"81EABDCB-69C3-44F3-B912-C17AF05F688E.MP4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/371/212/8cb5ea9903b266f562bec5820550cabe26bf9707/81EABDCB-69C3-44F3-B912-C17AF05F688E.MP4?response-content-disposition=attachment%3B%20filename%3D%2281EABDCB-69C3-44F3-B912-C17AF05F688E.MP4%22%3B%20filename%2A%3DUTF-8%27%2781EABDCB-69C3-44F3-B912-C17AF05F688E.MP4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTXACUYF6%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145957Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDZ4o5FgQbPOV7cUhasXsMpsRhfie%2BaT3j2%2FpT4vRtXrQIhANTpo%2FcLyZWkchHfmQUF52JZTNkTQv76yqIpKiufRkzIKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgxBFvChFQcfy0iFfX8q1wNyqcNfKQ7lbPM93GK7zsCVuFEl%2FVm4iCcIyQUbJFWfH2jiZwLWzXyXOGtPdAFg6jZ27A3JiIMI2cRQ0ZjefpX23ew4f2EgNrAjI%2BtoD%2F5QRlfpZWkH6iJZQB6Tl2elKHpLsozAmLMg2ZCF27az6tPlE5SwA3JPC5KKlDjsViNs2UljZCi3H9uSwsukoU%2FvdCWTH%2Fn50kTwo3bwe%2FH3PWsruJkAQ7DX1%2Fj9brsxUqDkLoqtLrdoJjkKc0QIPiVbiif2roLjf%2B%2BMNUUjLjPZ27VJBWMgYN3p%2FXN%2Fc2BT1VqWpZMMYQ84FXmc9pAGYMt40reW%2BOqOJwy98WVa3ZnRts3MNHsi7yiH6arhodeoIERCyyc0BhhJEItkxN5Wzyg1DrlhRUS1Y71%2FbjrEz4uBhQSkdwrt3ERf6rlWOARG2SfQdqloTHaxYeaKlkA1gYk2lr8P8v4Z2wcf76dl0kv5neqxZuEP1QXm7QMG6m4bxy4%2BSeNKsdU%2FVA5yixjEwa92C8A1VyBQrxcJgjfs7VfF2qV2iBmnh%2FB2iQg07zl1YJd0cPNun9USqJb8Uqe%2B27IwrOZbWtmOWnBh1TcvDRMDsM%2FPcb7c4FlLVjUX8TDrhUH4Hz0mpfpQPYswtoqRiwY6pAGpulV8rT1rLL2zo7CLXj%2FCsA9YXTe8QLCuwj5BAVEq1XkBbMgCpFE7wCWHjGb7zRvhVV%2BN69FRCvvxudtZT7OkdQfTd7cCnr7vVLgwdFxyTBTiSFdPhCB%2F%2BGa%2FZGSO8Tzmn%2F5kYwNrvNcaCO%2FfxLRKT5QyWFtCeJZaDCV4pXJgLvMY0o61KPcMitqxyN7tABkO5sZ5lEaE04FUiiZgi%2BMqeSxyhg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5e0755e1cae948912554426f2cf347115dd1ea165d23c2baf9e60ec74d377422","file_size":1871662,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["thaivu","sameerphad72","sh1yo","ali","amalyoman","zakariaeddafri","zerocool20","sshadow","osteen_shisia","rock19","and 1 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3591618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for you report, we'll look into this report. Mind however that the `JSESSIONID` name is a bit misleading as it is not related to authentication in our case. It's used to make sure subsequent requests are routed to the right machine within the cluster. You could even remove that parameter and the system would assign you a new one. Authentication data is transferred as cookie, user agent information, IP data etc.","automated_response":false,"created_at":"2018-11-06T07:01:25.219Z","updated_at":"2018-11-06T07:03:38.923Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3591654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland, You are right `JSESSIONID` is not the session id and `open-xchange-secret-c23QtGjVeP6YcP2rKlgg` is the session id.","automated_response":false,"created_at":"2018-11-06T07:26:50.295Z","updated_at":"2018-11-06T07:26:50.295Z","actor":{"username":"amalyoman","cleared":false,"url":"/amalyoman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3592128,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looking at the video suggests that you're not actually logging out (aka. UserIcon -\u003e Logout) but just reload the browser and re-use non-invalidated session data in Burp. Since you're technically not logging off and removing the session from the server, the session stays intact.\n\nHowever in this configuration the idea is to only use \"session\" cookies that expire, which does not be the case for certain API calls. Investigating further.","automated_response":false,"created_at":"2018-11-06T08:43:57.501Z","updated_at":"2018-11-06T08:43:57.501Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3592157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I got your point. Shall i close from my end?","automated_response":false,"created_at":"2018-11-06T08:53:38.525Z","updated_at":"2018-11-06T08:53:38.525Z","actor":{"username":"amalyoman","cleared":false,"url":"/amalyoman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3592233,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","automated_response":false,"created_at":"2018-11-06T09:19:27.154Z","updated_at":"2018-11-06T09:19:27.154Z","actor":{"username":"amalyoman","cleared":false,"url":"/amalyoman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3592246,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I believe we should change this behaviour as the user gets a wrong impression about the status of his/her session. As the user gets a login page its obvious that there is no active session, but actually there is. We'll discuss this internally and i will get back to you soon.","automated_response":false,"created_at":"2018-11-06T09:23:30.504Z","updated_at":"2018-11-06T09:23:30.504Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3592269,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes! That is a point. Please open the report once its confirmed internally.","automated_response":false,"created_at":"2018-11-06T09:30:00.359Z","updated_at":"2018-11-06T09:30:00.359Z","actor":{"username":"amalyoman","cleared":false,"url":"/amalyoman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3592739,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2018-11-06T10:32:30.723Z","updated_at":"2018-11-06T10:32:30.723Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3592741,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Triaging now.","automated_response":false,"created_at":"2018-11-06T10:32:41.486Z","updated_at":"2018-11-06T10:32:41.486Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3715058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.","automated_response":false,"created_at":"2018-11-27T11:24:43.779Z","updated_at":"2018-11-27T11:24:43.779Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3715060,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-11-27T11:24:57.307Z","updated_at":"2018-11-27T11:24:57.307Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"amalyoman","url":"/amalyoman"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3715064,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-11-27T11:25:07.507Z","updated_at":"2018-11-27T11:25:07.507Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"amalyoman","url":"/amalyoman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3715138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome! Thanks a lot for the bounty :)","automated_response":false,"created_at":"2018-11-27T11:45:29.664Z","updated_at":"2018-11-27T11:45:29.664Z","actor":{"username":"amalyoman","cleared":false,"url":"/amalyoman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/879/d1d41330e3a4c32272d91cee9eb1fd2f1ba3d534_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5253094,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-04T11:09:19.502Z","updated_at":"2019-07-04T11:09:19.502Z","first_to_agree":true,"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6860930,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-01-24T11:48:12.847Z","updated_at":"2020-01-24T11:48:12.847Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}