{"id":203002,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDMwMDI=","url":"https://hackerone.com/reports/203002","title":"Incorrect GC behavior in xxlimited could lead to use-after-free","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-02T19:33:06.151Z","submitted_at":"2017-02-02T19:33:06.151Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zeroinside","url":"/zeroinside","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/139/954/cdfb4886a47c85cb48b377316f289aa2704f4524_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27,"url":"https://hackerone.com/ibb-python","handle":"ibb-python","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Python (IBB)","twitter_handle":"","website":"http://www.python.org/news/security","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-12T09:01:08.444Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-10-13T09:00:59.781Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Issue submitted: http://bugs.python.org/issue29398\nxxlimited module exist only in Python3.6 compiled on Linux.\n\n\nStarting program: /usr/bin/python3.6 xlimited.py\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/usr/lib/libthread_db.so.1\".\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff73d73f5 in PyArena_Malloc () from /usr/lib/libpython3.6m.so.1.0\n(gdb) info reg\nrax            0x2000000000000000       2305843009213693952\nrbx            0x4141414141414141       4702111234474983745\nrcx            0xe      14\nrdx            0x0      0\nrsi            0x10     16\nrdi            0x7ffff7f812a0   140737353618080\nrbp            0x7ffff7f812a0   0x7ffff7f812a0\nrsp            0x7fffffffd8d0   0x7fffffffd8d0\nr8             0x10e    270\nr9             0x2      2\nr10            0x2      2\nr11            0x122a0  74400\nr12            0x1      1\nr13            0x7ffff7f812a0   140737353618080\nr14            0x7fffffffda40   140737488345664\nr15            0x7ffff7f28558   140737353254232\nrip            0x7ffff73d73f5   0x7ffff73d73f5 \u003cPyArena_Malloc+21\u003e\neflags         0x10202  [ IF RF ]\ncs             0x33     51\nss             0x2b     43\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0x0      0\n(gdb) \n\nAs presented above, PoC gives good control on RBX passed in PyArena_Malloc() function. Payload is limited to ASCII characters, because of exec() origin. In other variants, PoC leads to double-free. \n\n\n","vulnerability_information_html":"\u003cp\u003eIssue submitted: \u003ca title=\"http://bugs.python.org/issue29398\" href=\"/redirect?url=http%3A%2F%2Fbugs.python.org%2Fissue29398\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://bugs.python.org/issue29398\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nxxlimited module exist only in Python3.6 compiled on Linux.\u003c/p\u003e\n\n\u003cp\u003eStarting program: /usr/bin/python3.6 xlimited.py\u003cbr\u003e\n[Thread debugging using libthread_db enabled]\u003cbr\u003e\nUsing host libthread_db library \u0026quot;/usr/lib/libthread_db.so.1\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eProgram received signal SIGSEGV, Segmentation fault.\u003cbr\u003e\n0x00007ffff73d73f5 in PyArena_Malloc () from /usr/lib/libpython3.6m.so.1.0\u003cbr\u003e\n(gdb) info reg\u003cbr\u003e\nrax            0x2000000000000000       2305843009213693952\u003cbr\u003e\nrbx            0x4141414141414141       4702111234474983745\u003cbr\u003e\nrcx            0xe      14\u003cbr\u003e\nrdx            0x0      0\u003cbr\u003e\nrsi            0x10     16\u003cbr\u003e\nrdi            0x7ffff7f812a0   140737353618080\u003cbr\u003e\nrbp            0x7ffff7f812a0   0x7ffff7f812a0\u003cbr\u003e\nrsp            0x7fffffffd8d0   0x7fffffffd8d0\u003cbr\u003e\nr8             0x10e    270\u003cbr\u003e\nr9             0x2      2\u003cbr\u003e\nr10            0x2      2\u003cbr\u003e\nr11            0x122a0  74400\u003cbr\u003e\nr12            0x1      1\u003cbr\u003e\nr13            0x7ffff7f812a0   140737353618080\u003cbr\u003e\nr14            0x7fffffffda40   140737488345664\u003cbr\u003e\nr15            0x7ffff7f28558   140737353254232\u003cbr\u003e\nrip            0x7ffff73d73f5   0x7ffff73d73f5 \u0026lt;PyArena_Malloc+21\u0026gt;\u003cbr\u003e\neflags         0x10202  [ IF RF ]\u003cbr\u003e\ncs             0x33     51\u003cbr\u003e\nss             0x2b     43\u003cbr\u003e\nds             0x0      0\u003cbr\u003e\nes             0x0      0\u003cbr\u003e\nfs             0x0      0\u003cbr\u003e\ngs             0x0      0\u003cbr\u003e\n(gdb) \u003c/p\u003e\n\n\u003cp\u003eAs presented above, PoC gives good control on RBX passed in PyArena_Malloc() function. Payload is limited to ASCII characters, because of exec() origin. In other variants, PoC leads to double-free. \u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":156968,"file_name":"xlimited.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/156/968/b0c8b50472f209d77d28e68a3ccba35cb9bb3776/xlimited.py?response-content-disposition=attachment%3B%20filename%3D%22xlimited.py%22%3B%20filename%2A%3DUTF-8%27%27xlimited.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045416Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=1515fbbeff0c737778c1f56bcd3008aee8d395fffa8d2feb98a61abd13d76d2c","file_size":193,"type":"text/x-python"}],"allow_singular_disclosure_at":"2019-11-12T09:00:59.889Z","allow_singular_disclosure_after":-35668396.83508015,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","skyscanner4u"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1467671,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T05:26:08.779Z","updated_at":"2017-02-07T05:26:08.779Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":23150,"new_severity_id":24001},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467672,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T05:26:20.987Z","updated_at":"2017-02-07T05:26:20.987Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"zeroinside","url":"/zeroinside"},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467673,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T05:26:24.483Z","updated_at":"2017-02-07T05:26:24.483Z","actor":{"url":"/ibb-python","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Python (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-python","collaborator":{"username":"zeroinside","url":"/zeroinside"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6025384,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-13T09:00:59.799Z","updated_at":"2019-10-13T09:00:59.799Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6285211,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-12T09:01:08.484Z","updated_at":"2019-11-12T09:01:08.484Z","actor":{"url":"/ibb-python","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/027/c46b79d4c73a7b34d61a717ed19ae719a0b67b2e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Python (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-python","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}