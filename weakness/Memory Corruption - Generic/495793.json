{"id":495793,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTU3OTM=","url":"https://hackerone.com/reports/495793","title":"Malformed .MDL triggers an Access Violation on GoldSRC (hl.exe)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-02-14T01:34:41.616Z","submitted_at":"2019-02-14T01:34:41.616Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chippy","url":"/chippy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23363,"url":"https://hackerone.com/valve","handle":"valve","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Valve","twitter_handle":"","website":"https://www.valvesoftware.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-09T00:01:06.274Z","bug_reporter_agreed_on_going_public_at":"2019-10-08T21:21:37.321Z","team_member_agreed_on_going_public_at":"2019-10-09T00:01:06.173Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A malformed player .MDL triggers an exploitable Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\n\n###Crash Information\nFAILURE_ID_HASH_STRING:  um:invalid_pointer_write_exploitable_c0000005_hw.dll!createinterface\nEvent Type: Exception\nException Faulting Address: 0x4c01000\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\nException Sub-Type: Write Access Violation\n\nFOLLOWUP_IP: \nhw!CreateInterface+282aa\n03a554ea d95efc          fstp    dword ptr [esi-4]\n\nPROBLEM_CLASSES: \n\n    ID:     [0n309]\n    Type:   [@ACCESS_VIOLATION]\n    Class:  Addendum\n    Scope:  BUCKET_ID\n    Name:   Omit\n    Data:   Omit\n    PID:    [Unspecified]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n282]\n    Type:   [INVALID_POINTER_WRITE]\n    Class:  Primary\n    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n            BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [Unspecified]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n156]\n    Type:   [ZEROED_STACK]\n    Class:  Addendum\n    Scope:  BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [0x300]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\n    ID:     [0n115]\n    Type:   [EXPLOITABLE]\n    Class:  Addendum\n    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\n            BUCKET_ID\n    Name:   Add\n    Data:   Omit\n    PID:    [0x300]\n    TID:    [0x6e30]\n    Frame:  [0] : hw!CreateInterface\n\nBUGCHECK_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE_ZEROED_STACK_EXPLOITABLE\n\n###Steps for Reproducing the Crash\nPlace the attached .MDL in the games \"Gman\" multiplayer model folder (Steam\\steamapps\\common\\Half-Life\\valve\\models\\player\\gman) Load the attached .MDL by setting the player character to \"Gman\" from the games multiplayer menu. Then, start a local game by typing \"map crossfire\" in console. Finally, execute the command \"thirdperson\" in console. The game will crash.\n\n## Impact\n\nAn attacker hosting a malicious server could compromise a remote client by having them download a custom model, triggering remote code execution on the victim's computer.","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":423561,"file_name":"gman.mdl","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/423/561/1a6bc2d187c4cf8011c26108a201017d743b3f67/gman.mdl?response-content-disposition=attachment%3B%20filename%3D%22gman.mdl%22%3B%20filename%2A%3DUTF-8%27%27gman.mdl\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150604Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2374d0443671980e5f6889a3c8848d9afe72573455e7843fced989dad2a541c9","file_size":1383184,"type":"application/octet-stream"}],"allow_singular_disclosure_at":null,"vote_count":88,"voters":["njbooher","byq","mvc","mashoud1122","sameerphad72","chippy","ahiezer","fe7ch","spraynozzle","brodie_codie","and 78 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":1289,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"hl.exe","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4146668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chippy - Thanks for the report. This report is currently being reviewed and you will be updated when there is additional information to share. ","automated_response":false,"created_at":"2019-02-14T04:59:02.881Z","updated_at":"2019-02-14T04:59:02.881Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4510086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey everyone, just a little bump on this to see where things are. Hope all is well as always","automated_response":false,"created_at":"2019-04-08T18:22:27.998Z","updated_at":"2019-04-08T18:22:27.998Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5404282,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-07-23T21:06:55.789Z","updated_at":"2019-07-23T21:06:55.789Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":297085,"new_severity_id":472217},"actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5404296,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @chippy, sorry about the delay in getting to this issue. I've just validated that it is definitely a memory corruption that is occurring but I'm not convinced that it can be trivially turned into an RCE. Due to that and the fact that this requires some user involvement either to acquire or switch to the model, I think this would be better labeled as high severity. I should have a fix for it in the next beta update, I'll let you know when a build has it.","automated_response":false,"created_at":"2019-07-23T21:12:31.800Z","updated_at":"2019-07-23T21:12:31.800Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5407976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem at all! Glad to hear. Let me know if there's anything I can do to help. Have some interesting server-side reports coming up as well.","automated_response":false,"created_at":"2019-07-24T00:37:33.763Z","updated_at":"2019-07-24T00:37:33.763Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5422791,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Chippy,\n\nThanks for this report. I'm assessing the bounty now based on the bounty schedule that was active when you submitted it.","automated_response":false,"created_at":"2019-07-25T01:47:57.421Z","updated_at":"2019-07-25T01:47:57.421Z","actor":{"url":"/valve","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Valve"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"valve","collaborator":{"username":"chippy","url":"/chippy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5422849,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Much appreciated @valve . Would love to have this one publicly disclosed once the patch is live.","automated_response":false,"created_at":"2019-07-25T02:08:52.098Z","updated_at":"2019-07-25T02:08:52.098Z","actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989302,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is now fixed in the public release. Thanks again @chippy!","automated_response":false,"created_at":"2019-10-08T19:54:05.741Z","updated_at":"2019-10-08T19:54:05.741Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"chippy","url":"/chippy"},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989926,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you @mikela , it was a lot of fun working together on the GoldSRC bounties. I'd like to publicly disclose this since there probably won't be too many more on the older titles.","automated_response":false,"created_at":"2019-10-08T21:21:37.342Z","updated_at":"2019-10-08T21:21:37.342Z","first_to_agree":true,"actor":{"username":"chippy","cleared":true,"url":"/chippy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/796/53e9440cc12550ac6ac6daeb96a5e6b1786087d8_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5990599,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-09T00:01:06.202Z","updated_at":"2019-10-09T00:01:06.202Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5990600,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-09T00:01:06.303Z","updated_at":"2019-10-09T00:01:06.303Z","actor":{"username":"mikela","cleared":false,"url":"/mikela","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"valve","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}