{"id":1212337,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjEyMzM3","url":"https://hackerone.com/reports/1212337","title":"Bypass the fix of report #1078283 due to poor validation","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2021-05-29T02:29:33.482Z","submitted_at":"2021-05-29T02:29:33.525Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lucenaxpl0it","url":"/lucenaxpl0it","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/qK2L4SQ6goP5Lq2q4h2qJG4P/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":134,"url":"https://hackerone.com/khanacademy","handle":"khanacademy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Khan Academy","twitter_handle":"","website":"https://www.khanacademy.org/","about":"Start learning now. Completely free, forever."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-07-08T19:25:27.515Z","bug_reporter_agreed_on_going_public_at":"2021-06-08T19:25:25.298Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Khan Academy Team,\n\nI was able to bypass the fix you implemented for report #1078283. \n\nThe URL validation you implemented on the endpoint `continue` checks the presence of `khanacademy.org` however it doesn't have any boundary checking to ignore domains starting with `.org`, so if an attacker register a domain starting with `org` like this one `orghacker.com.br` and have a subdomain entry of `khanacademy` the attacker is able to bypass the current implementation and lead the victim to his controlled page.\n\n# Steps to reproduce the issue\n\n* Go to this page https://www.khanacademy.org/signup?isteacher=1\u0026referral=LearnStorm\u0026continue=https://khanacademy.orghacker.com.br\n* You'll be redirected to `orghacker.com.br` which is not a domain that Khan Academy owns\n\n## Impact\n\nBypass of current URL validation. Attacker can send a phishing campaign and redirect the request to a server of his control. An attacker might chain the attack to other types of attack too.","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-07-08T19:25:25.415Z","allow_singular_disclosure_after":-8186833.477729411,"singular_disclosure_allowed":true,"vote_count":13,"voters":["sw33tlie","run_win","ali","citril","nafisaqil","pacmanx","kartiksavaliya","ekgaribadmi","pj1328","securewolf","and 3 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":11949954,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @lucenaxpl0it,\n\nThanks for your report! You're right--this will need to be patched. I've let the team know about this hole, and will let you know when I have an update.\n\nbest,\nDiana","automated_response":false,"created_at":"2021-06-01T16:33:11.779Z","updated_at":"2021-06-01T16:33:11.779Z","actor":{"username":"drosile","cleared":false,"url":"/drosile","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Q4ceVVjALdR4FtiZDBdehawK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12025947,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @lucenaxpl0it,\n\nThanks again for your report! We deployed a fix for that this morning.\n\nbest,\nDiana","automated_response":false,"created_at":"2021-06-08T17:48:04.168Z","updated_at":"2021-06-08T17:48:04.168Z","actor":{"username":"drosile","cleared":false,"url":"/drosile","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Q4ceVVjALdR4FtiZDBdehawK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lucenaxpl0it","url":"/lucenaxpl0it"},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12026683,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you! Can we disclose this report?","automated_response":false,"created_at":"2021-06-08T19:25:25.339Z","updated_at":"2021-06-08T19:25:25.339Z","first_to_agree":true,"actor":{"username":"lucenaxpl0it","cleared":false,"url":"/lucenaxpl0it","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/qK2L4SQ6goP5Lq2q4h2qJG4P/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":12407813,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-07-08T19:25:27.647Z","updated_at":"2021-07-08T19:25:27.647Z","actor":{"url":"/khanacademy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Khan Academy"}},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}