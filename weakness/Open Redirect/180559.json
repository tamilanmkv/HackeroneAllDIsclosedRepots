{"id":180559,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODA1NTk=","url":"https://hackerone.com/reports/180559","title":"Content spoofing on yelp.onelogin","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2016-11-07T01:09:36.054Z","submitted_at":"2016-11-07T01:09:36.054Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"japz","url":"/japz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":545,"url":"https://hackerone.com/yelp","handle":"yelp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Yelp","twitter_handle":"","website":"https://www.yelp.com","about":"Connecting people to great local businesses in communities around the world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-09T20:41:14.709Z","bug_reporter_agreed_on_going_public_at":"2016-11-09T01:18:37.866Z","team_member_agreed_on_going_public_at":"2017-11-09T20:41:14.557Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Yelp Team,\n\nI'm not sure if this one is out of scope but i want you guys to be aware of it, I have found that content spoofing is possible on yelp onelogin.\n\n__Reference:__ https://www.owasp.org/index.php/Content_Spoofing\n\n__PoC URL:__\n\nhttps://yelp.onelogin.com/images%20storage%20has%20been%20transfered%20to%20new%20storage%20location,%20please%20go%20to%20www.malicious-site.com/images\n\nCheers\nJapz","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["japz","jong_jong"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1286975,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there!\n\nThanks for submitting your report to us! Please expect a response within a week.\n\nBest,\nThe Yelp Security Team\n","automated_response":true,"created_at":"2016-11-07T01:09:36.247Z","updated_at":"2016-11-07T01:09:36.247Z","actor":{"url":"/yelp","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Yelp"}},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1286976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching PoC screenshot.","automated_response":false,"created_at":"2016-11-07T01:12:00.581Z","updated_at":"2016-11-07T01:12:00.581Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":133261,"filename":"content_spoofing.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/133/261/c03cded1b1e77d187cf9e3c018bae56013210bc7/content_spoofing.JPG?response-content-disposition=attachment%3B%20filename%3D%22content_spoofing.JPG%22%3B%20filename%2A%3DUTF-8%27%27content_spoofing.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a2a17e81578198a97eeaf78829549115f3c4ef412b426184fc511e1afd55789e"}],"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290699,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi there!\n\nThe reported issue does not present a valid security threat at this moment. Essentially, it is the same behavior you will see [elsewhere](https://www.google.com/404---https://www.evil.com..........................). \n\nIf you manage to get script execution via the reflected text, do let us know via a follow up report.\n\nBest,\nThe Yelp Security Team\n","automated_response":false,"created_at":"2016-11-08T21:41:41.667Z","updated_at":"2016-11-08T21:41:41.667Z","actor":{"username":"5a37bf56c8","cleared":false,"url":"/5a37bf56c8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @5a37bf56c8 ,\n\n\u003e it is the same behavior you will see elsewhere\n\nI'm sorry but i have to disagree, your given example __https://www.google.com/404---https://www.evil.com..........................__ was displaying their 404 error page , that is the customize page of google, and if you will observe google was converting __spaces__ into URL encoding which will return __%20__ on the error page , so if you put something like below:\n\n__Attacker text injection:__ https://www.google.com/404---https://please%20go%20to%20www.evil.com%20and%20sign-in\n\n__Error Page returns:__ 404---https://please%20go%20to%20www.evil.com%20and%20sign-in\n\nTherefore on the google error page, they are mitigation the attack by not allowing the attacker to compose a very descriptive message (by converting spaces into URL encoding), so that the victim will not fall into the attack.\n\nOn __Yelp__ scenario , you guys don't have a cuztomize 404 error page which allows the attacker to put a very descriptive message on the page content.\n\n__Attacker text injection:__ https://yelp.onelogin.com/images%20storage%20has%20been%20transfered%20to%20new%20storage%20location,%20please%20go%20to%20www.malicious-site.com/images\n\n__Yelp page returns:__ File not found: /images storage has been transferred to new storage location, please go to www.malicious-site.com/images\n\nOn my PoC , the __yelp page__ returns : *File not found: /images storage has been transferred to new storage location, please go to www.malicious-site.com/images* which can trick the viewers to go to __www.evil.com__\n\nRegards\nJapz","automated_response":false,"created_at":"2016-11-09T01:01:39.292Z","updated_at":"2016-11-09T01:03:17.273Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290981,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Most social engineering tactics fall out of scope, since they require increasingly unlikely user behavior. However, if you find a way to get script execution via the 404 page, do let us know.","automated_response":false,"created_at":"2016-11-09T01:14:41.835Z","updated_at":"2016-11-09T01:14:41.835Z","actor":{"username":"5a37bf56c8","cleared":false,"url":"/5a37bf56c8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290988,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Oh i see, i pretty sure i have read the scope of the program carefully , haven't seen that this is out of scope.\n\nYou may want to update the __Exclusions__ of the program ?\n\nJapz","automated_response":false,"created_at":"2016-11-09T01:18:37.885Z","updated_at":"2016-11-09T01:18:37.885Z","first_to_agree":true,"actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":133602,"filename":"yelp_exclusions.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/133/602/d3cdf23740e5a136b9c38a7174641dcfd40e2854/yelp_exclusions.JPG?response-content-disposition=attachment%3B%20filename%3D%22yelp_exclusions.JPG%22%3B%20filename%2A%3DUTF-8%27%27yelp_exclusions.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZQXPADTK%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135426Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIEnMr4DVhYYTqMb%2BOP2PKHfYpSv9D5BBEJnMqEhFTzeKAiAeXkKMs80U9YQDe4ttV6IqDuQKfy6G4rgQ5lLDs%2FynrSqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMbhflm22iYJYqUsxzKtcDB8Pgwi96hJiplV7WKaw0AR0k%2BEXDFBW%2BG%2BYdpHb62oEWGe8HSRbQaU3Q3Fj%2BSvKqS093fZuQDsCdV4M3iqQIqCtv1Q6GPf9rTsY3aeauyx8etG%2BURaJibQVQc9PwZaDx1L%2BryPnwfQFfT9ayiFdqA9fZYBYVBAdVfr6WiMFuX0XdRnwM7tzE6J0AXxB37N69wBbU2Xb3tKIicAQDLneqa8aoUR3YUFtvOFZAz2Qc931NT%2Br%2FigpMQjz0syuVR2poADAistQGXHWk3I6xFISQymYX7MTDVeyWJZRkAoG5czInm6nDg9jipQu%2BenzxOmQOqUNZ%2FDC76AwjY5aAAvtd6r6JT2V72trR11DROBIsJO%2FIShH7q9JoESyB%2F1o6Q5%2BiuwomCPFU4tVEemlEc5lNYIZamrFJsAH5GaSMDFA6YpipFDWfpviI7f2MiBQlxPJAB5X1QzT5WIXx2PazxnrBI3G29KeYynTTVHHJidcczfgLkVHwxGbuhtijOBi4s%2Fgk0dWW44Ywe3A1G%2BRX8Yj0NVuvt8Pt%2B0N5CI3EdAFGY1U6SFNz7egYzaePbVDnsQZghACy4h1g%2BARgHKr4cJvS8EZ5xhXkVVfycQcZfNVbW3SIBSo%2B4HEJMLbjkIsGOqYB2jUwpV9YeKKeYEkCjUFt285lWr0XRj6ae48f32wMeam4CFHiyCcH0MCoNenFvDHFJCBn4H%2B3DfwYTcQjZpttvBz8T5sl3abGg2MBvdgbzRrwVgocNPq%2FJOcEyipSDakoglRRfC5s4w5bFejabZEOQFOdoE5KginzyfxwFFH009lEzVJiGfKTDbqdNnetBVWk6JyUphW6lwfF1hGZK9Z27qAkF0weOw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9c10d970ef0fca4d5d631d2bcf7c5869e6426d88ee90714dc98c84bbbc74a2f3"}],"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290993,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can see some similar issues here: #106348 #171497 #155189 #138786 #144104","automated_response":false,"created_at":"2016-11-09T01:28:38.537Z","updated_at":"2016-11-09T01:28:38.537Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1311593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@5a37bf56c8 any problem disclosing this ?","automated_response":false,"created_at":"2016-11-22T04:52:13.301Z","updated_at":"2016-11-22T04:52:13.301Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1322131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ping @5a37bf56c8 ","automated_response":false,"created_at":"2016-11-28T01:16:18.879Z","updated_at":"2016-11-28T01:16:18.879Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147347,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Our policy was updated to exclude social engineering / phishing attacks.","automated_response":false,"created_at":"2017-11-09T20:41:14.592Z","updated_at":"2017-11-09T20:41:14.592Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2147348,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-09T20:41:14.746Z","updated_at":"2017-11-09T20:41:14.746Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2279941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dchan , you guys updated the policy and then disclosed the report after 1 year ? , not even asking me if i still want to disclosed it. Actually i don't want to disclosed an informative report. I will appreciate if you can reopen and re-closed without disclosing publicly.\n\nThanks","automated_response":false,"created_at":"2018-01-12T11:13:47.689Z","updated_at":"2018-01-12T11:13:47.689Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2307649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @japzdivino_ \n\nUnfortunately there is no option to reopen / close the report once it becomes public. I should have checked with you before disclosing the report. We will update our process to make sure this doesn't happen again.","automated_response":false,"created_at":"2018-01-22T18:09:37.587Z","updated_at":"2018-01-22T18:09:37.587Z","actor":{"username":"dchan","cleared":false,"url":"/dchan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2307998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dchan i understand, thanks.","automated_response":false,"created_at":"2018-01-22T19:48:22.838Z","updated_at":"2018-01-22T19:48:22.838Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2686673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dchan , i think you can change the visibility to `Public (Limited)` , it will not show the whole report but only the summary, you can write summary if you want.","automated_response":false,"created_at":"2018-05-01T14:39:10.111Z","updated_at":"2018-05-01T14:39:10.111Z","actor":{"username":"japz","cleared":false,"url":"/japz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/078/347/38b576ad263c5255e136ebbd3a19eb61ff7a298d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"yelp","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}