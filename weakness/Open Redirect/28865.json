{"id":28865,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODg2NQ==","url":"https://hackerone.com/reports/28865","title":"Redirect FILTER bypass in report/comment","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-09-21T12:11:18.120Z","submitted_at":"2014-09-21T12:11:18.120Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"coolboss","url":"/coolboss","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-10-19T09:00:10.712Z","bug_reporter_agreed_on_going_public_at":"2014-10-19T08:44:24.442Z","team_member_agreed_on_going_public_at":"2014-10-19T09:00:10.351Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nI made few reports recently. But, I guess you did not understand my perspective. As my video recorder is not working, I am explaining everything in written. \r\n\r\nLately, I reported about 'External Link Warning Bypass to open redirect users' and @michiel attended the report. Actually, the report is combined using 2 bugs to exploit against 'ANY RANDOM VICTIM' against web. It became confusing henceforth. So, I am writing this again and explaining comprehensively.\r\n\r\nStrictly FOLLOW the instructions mentioned below.\r\n==========================================\r\n\r\nFirst :\r\n=====\r\nWhenever, user posts a external link on HackerOne via report/comment then the link is passed through 'REDIRECT FILTER'. This 'REDIRECT FILTER' is supposed to prevent victims from getting open redirected. It presents a page with 'Proceed Button', when pressed redirects to external link. It verifies safety of the user clicking the link and give a nice message.\r\n\r\neg. http://www.google.com (Click this link. This link is external so it will passed through 'REDIRECT FILTER' and a 'Proceed button will be presented.')\r\n\r\n\r\nSecond:\r\n=======\r\nWhenever user posts an internal link. It is trusted and it is not passed through 'REDIRECT FILTER'.\r\n\r\neg. https://hackerone.com (Click this link. This link is not passed through 'REDIRECT FILTER' and will not present a 'Proceed button'.)\r\n\r\n\r\nThird:\r\n=====\r\n1. When you will click 1st link(i.e http://google.com) then a page with url='https://hackerone.com/redirect?signature=43cd652c2f1835df993825d00bed0660f498fc42\u0026url=http%3A%2F%2Fwww.google.com'\r\nwill be presented with a 'Proceed button'.\r\n\r\n2. Modifying the url in THAT TAB will redirect you to that site. \r\n\r\neg. Modify the url in the tab to ---\u003e https://hackerone.com/redirect/secure?signature=43cd652c2f1835df993825d00bed0660f498fc42\u0026url=http%3A%2F%2Fwww.google.com\r\n\r\n3. This will redirect showing a message.\r\n\r\n4. But, WHEN YOU CLICK THE ABOVE LINK. You will be shocked to see that it doesn't get exploited as we expect it to be. It just works when we change the url in the tab.\r\n\r\n5. This is because the link is passed through 'REDIRECT FILTER'.\r\n\r\n\r\n\r\nFourth:\r\n======\r\nLet''s bypass the 'REDIRECT FILTER'.\r\n\r\n1. Now, https://hackerone.com is trusted. And is not passed through redirect filter. (Right click and inspect this link, this is not passed through 'REDIRECT FILTER')\r\n\r\n2. Now, https://hackerone.com/redirect/secure?signature=43cd652c2f1835df993825d00bed0660f498fc42\u0026url=http%3A%2F%2Fwww.google.com\r\nThis is passed through 'REDIRECT FILTER' as it contains '/redirect'.\r\n\r\n3. Bypassing 'REDIRECT FILTER' now.\r\n\r\nhttps://hackerone.com/../redirect/?signature=43cd652c2f1835df993825d00bed0660f498fc42\u0026url=http%3A%2F%2Fwww.google.com\r\n(Right Click this link and Inspect. You will be shocked to see it bypassed 'REDIRECT FILTER')\r\n\r\nFifth :\r\n======\r\nCombining 'Bypassing REDIRECT FILTER' and \"Duplicate report 'adding /secure to redirect'\" to make an exploit working against any random user of HackerOne.\r\n\r\neg. https://hackerone.com/../redirect/secure?signature=43cd652c2f1835df993825d00bed0660f498fc42\u0026url=http%3A%2F%2Fwww.google.com\r\n\r\n(Click this link. And see BOOM ...!)\r\nThis link bypasses 'REDIRECT FILTER' and also have some more impact then all.\r\n\r\n\r\nOnce again, STRICTLY FOLLOW THE INSTRUCTIONS TO REPRODUCE.\r\nHave a good day. :)\r\n\r\nI will be happy to hear reply soon on this. :)\r\n\r\nRegards,\r\nPranav\r\n\r\n\r\n ","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-11-18T09:44:24.777Z","allow_singular_disclosure_after":-217659270.59678036,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sw33tlie","fantam1","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":130535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Once again, STRICTLY FOLLOW THE INSTRUCTIONS TO REPRODUCE.\n===========================================================","automated_response":false,"created_at":"2014-09-21T12:12:03.453Z","updated_at":"2014-09-21T12:12:03.453Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":130542,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POC VIDEO ---\u003e https://www.youtube.com/watch?v=QizMrmD_kCY\u0026feature=youtu.be\nIn the end I made one. Please read thoroughly. \n\nSimple patch:\n===========\n1. Do not trust https://hackerone.com.\n2. Pass every link through 'REDIRECT FILTER'\n\nRegards,\nPranav","automated_response":false,"created_at":"2014-09-21T12:33:15.160Z","updated_at":"2014-09-21T12:33:15.160Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":130678,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for sending this in. We're in the process of replacing the 'passthrough' redirect with plain links (no `target=\"_blank\"`). That would also fix this report. Keeping this in triaged state until we have pushed the fix to production.","automated_response":false,"created_at":"2014-09-22T01:10:40.734Z","updated_at":"2014-09-22T01:10:40.734Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":130685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That sounds great. :)\nThat will fix everything. And thanks @michiel you understood. :)","automated_response":false,"created_at":"2014-09-22T01:18:43.026Z","updated_at":"2014-09-22T01:18:43.026Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":131772,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2014-09-24T18:37:01.229Z","updated_at":"2014-09-24T18:37:01.229Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"coolboss","url":"/coolboss"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":131773,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2014-09-24T18:37:10.110Z","updated_at":"2014-09-24T18:37:10.110Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"coolboss","url":"/coolboss"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":131842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. :)\nGood patch it is.","automated_response":false,"created_at":"2014-09-24T20:40:19.028Z","updated_at":"2014-09-24T20:40:19.028Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":145075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello,\n\nWrote a blog post about this ---\u003e http://www.pranavhivarekar.in/2014/10/hackerone-bug-redirect-filter-bypass.html\n\nHave a look ...! :D\n\nRegards,\nPranav","automated_response":false,"created_at":"2014-10-19T08:44:24.460Z","updated_at":"2014-10-19T08:44:24.460Z","first_to_agree":true,"actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":145078,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-10-19T09:00:10.368Z","updated_at":"2014-10-19T09:00:10.368Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":145079,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-10-19T09:00:10.728Z","updated_at":"2014-10-19T09:00:10.728Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}