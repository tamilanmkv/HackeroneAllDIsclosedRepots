{"id":359453,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTk0NTM=","url":"https://hackerone.com/reports/359453","title":"Insecure opening of external links in app.passit.io/list allows for reverse tabnabbing","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-05-30T01:44:34.725Z","submitted_at":"2018-05-30T01:44:34.725Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kevinhwang","url":"/kevinhwang","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27430,"url":"https://hackerone.com/passit","handle":"passit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Passit","twitter_handle":"passitdotio","website":"https://passit.io","about":"An open source app that uses an established and modern cryptographic library to secure your passwords online so you can access them anywhere."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-11T14:19:19.923Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-07-12T14:19:00.543Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\n\n[https://app.passit.io/list](https://app.passit.io/list) renders external links under attacker control that open in a new tab such that the opened tab has access to the opening tab (where the user was just browsing on [app.passit.io](https://app.passit.io)) via `window.opener`. This is likely due to the lack of specifying a `rel=\"noopener\"` attribute for anchor tags (or whatever the Angular equivalent).\n\nFollowing user-interaction (e.g., a user clicking on a vulnerable link), this allows for [reverse tab-nabbing](https://www.owasp.org/index.php/Reverse_Tabnabbing), where the destination page can access and rewrite the tab that opened it.\n\n## Steps To Reproduce\n\n1. Go to [https://app.passit.io/list](https://app.passit.io/list).\n2. Click \"Add New Password\".\n3. In the \"Name\" form field, enter anything.\n4. In the \"URL\" form field, enter `https://kevinhwang.github.io/reverse-tabnab/redirect/` (the trailing slash is important for my demo app).\n5. (Optional) In the \"Group(s)\" form field, enter a group so you can share this password with other users (victims) and entice them to click the link.\n6. Click \"Save Changes\".\n7. Either on your current account, or that of a user who is part of a group you shared the password with, navigate to [https://app.passit.io/list](https://app.passit.io/list) and view the password entry you just saved.\n8. In the \"URL\" section, click on the square with the arrow coming out of it to open the URL. It should open [https://kevinhwang.github.io/reverse-tabnab/redirect/](https://kevinhwang.github.io/reverse-tabnab/redirect/) in a *new tab*.\n5. Close this newly opened tab.\n4. Observe that the previous tab (in which you were viewing your passwords on [app.passit.io](https://app.passit.io)) was redirected to [https://kevinhwang.github.io/reverse-tabnab/fake-login](https://kevinhwang.github.io/reverse-tabnab/fake-login).\n\n## Impact\n\nSince an attacker can share their \"passwords\" with other users using the \"Groups\" feature of Passit, if a user clicks on any of the links present in their shared password, their browser will open up a new tab which obscures the tab they were using to browse their passwords on [app.passit.io](https://app.passit.io). The attacker can then, as in my demo, redirect the opening tab to a site of their choosing, ideally one that looks exactly like the Passit login page (as a bonus, combine with a [homoglyph attack](https://en.wikipedia.org/wiki/IDN_homograph_attack)).\n\nThis would happen in the background while the new tab opened to the external site was in focus. When the user closes the opened tab, they will see \"Passit\" asking them to re-login, and will likely do so, because they know this tab was just on [app.passit.io](https://app.passit.io), and have no reason to suspect it should have randomly redirected while the tab wasn't visible. This is known as [reverse tab-nabbing](https://www.owasp.org/index.php/Reverse_Tabnabbing).\n\nThus, with user-interaction, an attacker could reasonably target others and phish their Passit credentials.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io%2Flist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.passit.io/list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e renders external links under attacker control that open in a new tab such that the opened tab has access to the opening tab (where the user was just browsing on \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.passit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) via \u003ccode\u003ewindow.opener\u003c/code\u003e. This is likely due to the lack of specifying a \u003ccode\u003erel=\u0026quot;noopener\u0026quot;\u003c/code\u003e attribute for anchor tags (or whatever the Angular equivalent).\u003c/p\u003e\n\n\u003cp\u003eFollowing user-interaction (e.g., a user clicking on a vulnerable link), this allows for \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FReverse_Tabnabbing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ereverse tab-nabbing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, where the destination page can access and rewrite the tab that opened it.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io%2Flist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.passit.io/list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Add New Password\u0026quot;.\u003c/li\u003e\n\u003cli\u003eIn the \u0026quot;Name\u0026quot; form field, enter anything.\u003c/li\u003e\n\u003cli\u003eIn the \u0026quot;URL\u0026quot; form field, enter \u003ccode\u003ehttps://kevinhwang.github.io/reverse-tabnab/redirect/\u003c/code\u003e (the trailing slash is important for my demo app).\u003c/li\u003e\n\u003cli\u003e(Optional) In the \u0026quot;Group(s)\u0026quot; form field, enter a group so you can share this password with other users (victims) and entice them to click the link.\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Save Changes\u0026quot;.\u003c/li\u003e\n\u003cli\u003eEither on your current account, or that of a user who is part of a group you shared the password with, navigate to \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io%2Flist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.passit.io/list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and view the password entry you just saved.\u003c/li\u003e\n\u003cli\u003eIn the \u0026quot;URL\u0026quot; section, click on the square with the arrow coming out of it to open the URL. It should open \u003ca href=\"/redirect?url=https%3A%2F%2Fkevinhwang.github.io%2Freverse-tabnab%2Fredirect%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kevinhwang.github.io/reverse-tabnab/redirect/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in a \u003cem\u003enew tab\u003c/em\u003e.\u003c/li\u003e\n\u003cli\u003eClose this newly opened tab.\u003c/li\u003e\n\u003cli\u003eObserve that the previous tab (in which you were viewing your passwords on \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.passit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) was redirected to \u003ca href=\"/redirect?url=https%3A%2F%2Fkevinhwang.github.io%2Freverse-tabnab%2Ffake-login\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kevinhwang.github.io/reverse-tabnab/fake-login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSince an attacker can share their \u0026quot;passwords\u0026quot; with other users using the \u0026quot;Groups\u0026quot; feature of Passit, if a user clicks on any of the links present in their shared password, their browser will open up a new tab which obscures the tab they were using to browse their passwords on \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.passit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The attacker can then, as in my demo, redirect the opening tab to a site of their choosing, ideally one that looks exactly like the Passit login page (as a bonus, combine with a \u003ca href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FIDN_homograph_attack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehomoglyph attack\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eThis would happen in the background while the new tab opened to the external site was in focus. When the user closes the opened tab, they will see \u0026quot;Passit\u0026quot; asking them to re-login, and will likely do so, because they know this tab was just on \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.passit.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.passit.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and have no reason to suspect it should have randomly redirected while the tab wasn\u0026#39;t visible. This is known as \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FReverse_Tabnabbing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ereverse tab-nabbing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThus, with user-interaction, an attacker could reasonably target others and phish their Passit credentials.\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-11T14:19:00.642Z","allow_singular_disclosure_after":-75223429.14363067,"singular_disclosure_allowed":true,"vote_count":9,"voters":["mashoud1122","eveeez","cryptographer","the_baghdad_sniper","juba_","r1pp3r","antuan","sunlands","isekcarmy505"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":8266,"asset_type":"URL","asset_identifier":"app.passit.io","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2818765,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you, I was able to reproduce the issue. I agree this could be used to phish credentials. ","markdown_message":"\u003cp\u003eThank you, I was able to reproduce the issue. I agree this could be used to phish credentials. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T16:20:51.705Z","updated_at":"2018-05-30T16:20:51.705Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2818862,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Fix via https://gitlab.com/passit/passit-frontend/commit/f2f442663392065f46463faebcf1ce5ed3dbe6eb\n\nThis is go out to app.passit.io on the next release.\n\nAnd I got to learn how stupid window.open behaves.\n\nThank you.","markdown_message":"\u003cp\u003eFix via \u003ca title=\"https://gitlab.com/passit/passit-frontend/commit/f2f442663392065f46463faebcf1ce5ed3dbe6eb\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fpassit%2Fpassit-frontend%2Fcommit%2Ff2f442663392065f46463faebcf1ce5ed3dbe6eb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/passit/passit-frontend/commit/f2f442663392065f46463faebcf1ce5ed3dbe6eb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is go out to app.passit.io on the next release.\u003c/p\u003e\n\n\u003cp\u003eAnd I got to learn how stupid window.open behaves.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T16:46:03.934Z","updated_at":"2018-05-30T16:46:03.934Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kevinhwang","url":"/kevinhwang"},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3035017,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Just going through old issues to mark public when that seems appropriate.","markdown_message":"\u003cp\u003eJust going through old issues to mark public when that seems appropriate.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-12T14:19:00.576Z","updated_at":"2018-07-12T14:19:00.576Z","first_to_agree":true,"actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3177060,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-11T14:19:19.958Z","updated_at":"2018-08-11T14:19:19.958Z","actor":{"url":"/passit","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Passit"}},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}