{"id":55525,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTUyNQ==","url":"https://hackerone.com/reports/55525","title":"Open redirection in OAuth","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-09T19:26:47.044Z","submitted_at":"2015-04-09T19:26:47.044Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"coolboss","url":"/coolboss","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-07-03T17:17:57.442Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-06-03T17:13:26.621Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nWhen we specify an `invalid` scope then the authorize url redirects to the site mentioned in `redirect_uri`. So, attacker can create an app and use it as open redirector to redirect victims to fake sites.\r\neg. Attacker can host same phishing page and hack the victims.\r\n\r\nProof Of Concept :\r\n===============\r\n1. I created an app \r\n\r\n\u003chttps://prans.myshopify.com/admin/oauth/authorize?client_id=616ce3efcd495007438000ad958a6629\u0026scope=read_customers\u0026redirect_uri=http://www.facebook.com/abc/\u003e\r\n\r\n2. Now, visit this ...\r\n\r\nThis will redirect ...\r\n\r\n\u003chttps://prans.myshopify.com/admin/oauth/authorize?client_id=616ce3efcd495007438000ad958a6629\u0026scope=a\u0026redirect_uri=https://www.facebook.com/abc\u003e\r\n\r\n3. This will redirect with an error to ...\r\n\u003chttps://www.facebook.com/abc?error=invalid_scope\u0026hmac=07657fedf1815f84248dfc6c372ba002e3ea5041df849080269786ae732aed99\u0026shop=prans.myshopify.com\u0026signature=6ecc20da3eb66500d9245635ead45315\u0026timestamp=1428607537\u003e\r\n\r\n\r\nSimple patch :\r\n===========\r\nOnly a error should be shown and no redirection should take place so as to protect users.\r\n\r\nThanks,\r\nPranav\r\n\r\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-07-03T17:13:26.869Z","allow_singular_disclosure_after":-198021450.4972031,"singular_disclosure_allowed":true,"vote_count":8,"voters":["drsniper","ankitsingh","burhan__xd","fantam1","666reda","nafisaqil","bc6d6320295947be212f350","sbavis20"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":380952,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hello,\n\nThe redirect_uri parameter is validated against the url that you provide when creating the app, so this feature is safe to use, it does not allow open redirects.","automated_response":false,"created_at":"2015-04-15T20:06:51.513Z","updated_at":"2015-04-15T20:06:51.513Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381019,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hi,\n\nI have reopened this bug because I missed one of the step when reviewing it originally. When the scope is invalid, the hostname of the uri is not actually checked.\n\n","automated_response":false,"created_at":"2015-04-15T20:33:31.597Z","updated_at":"2015-04-15T20:33:31.597Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381030,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Very sorry, I was incorrect. The hostname is validated even when the scope is invalid. I was testing with your app which is registered with facebook.com, so redirecting there is obviously possible. But for any app the URL must match otherwise the redirection does not happen and the following error is given:\n\u003e Oauth error invalid_request: The redirect_uri and application url must have matching hosts","automated_response":false,"created_at":"2015-04-15T20:40:00.809Z","updated_at":"2015-04-15T20:40:00.809Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381061,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Ok @pranav_hivarekar, I understand this issue now, and it's definitely valid. Sorry, it took me a few minutes to get it.","automated_response":false,"created_at":"2015-04-15T20:54:34.172Z","updated_at":"2015-04-15T20:54:34.172Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381100,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2015-04-15T21:21:53.022Z","updated_at":"2015-04-15T21:21:53.022Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381106,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2015-04-15T21:26:08.974Z","updated_at":"2015-04-15T21:26:08.974Z","additional_data":{"duplicate_report_id":55557},"actor":{"username":"lucio","cleared":true,"url":"/lucio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/050/bb234dcfd4639de4529b14592926e18b93ea2349_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":381117,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for this report. We have identified the issue and are working on a fix. We would like to reward this disclosure with a $500 bug bounty","automated_response":false,"created_at":"2015-04-15T21:31:05.640Z","updated_at":"2015-04-15T21:31:05.640Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"coolboss","url":"/coolboss"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":381142,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's a quite common issue. It's a problem the oauth 2.0 protocol. For team members, check either the scope parameter if present. Anyway good catch @pranav_hivarekar, just some reports before mine :D","automated_response":false,"created_at":"2015-04-15T21:49:30.239Z","updated_at":"2015-04-15T21:50:34.917Z","actor":{"username":"lucio","cleared":true,"url":"/lucio","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/050/bb234dcfd4639de4529b14592926e18b93ea2349_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":381970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi everyone,\n\n@Shopify\nI loved your transparency. The way you added @lucio in this report and all. Also, I liked the way that you tested this bug few times and got it validated without getting me into it. :-)\n\n@lucio\nYes. I agree. But it also depends on how @shopify have impemented their oauth. Every site implements it differently. Well. Good luck for me. ;)\n\nWell done everyone ! :-)\n\nRegards,\nPranav ","automated_response":false,"created_at":"2015-04-16T14:50:45.617Z","updated_at":"2015-04-16T14:50:45.617Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We also have an issue with the scope parameter, it was reported separately before. We'll fix both issues. Thanks!","automated_response":false,"created_at":"2015-04-16T15:45:16.150Z","updated_at":"2015-04-16T15:45:16.150Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382311,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2015-04-16T18:37:24.444Z","updated_at":"2015-04-16T18:37:24.444Z","additional_data":{"duplicate_report_id":56227},"actor":{"username":"alpha","cleared":false,"url":"/alpha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/246/e8b4598aaf81648969f1ebf4c96e63155092c651_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382497,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2015-04-16T19:52:19.107Z","updated_at":"2015-04-16T19:52:19.107Z","additional_data":{"duplicate_report_id":56556},"actor":{"username":"adrianbelen","cleared":false,"url":"/adrianbelen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/531/3af3d7d3a3d11e19dd4faa198dbf431a2a1bc758_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":439779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug has been fixed, an invalid scope now renders an error page (screenshot attached).","automated_response":false,"created_at":"2015-06-03T17:13:00.781Z","updated_at":"2015-06-03T17:13:00.781Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":39872,"filename":"Screen_Shot_2015-06-03_at_1.11.39_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/039/872/9cb15a892d8d913a5c8dbdec0592885f60caa4f4/Screen_Shot_2015-06-03_at_1.11.39_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-06-03_at_1.11.39_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-06-03_at_1.11.39_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151057Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f85aa3b0d0e9cad9584374754d933c9a425112b0069d49622c02ddb935a6e202"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":439780,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2015-06-03T17:13:07.986Z","updated_at":"2015-06-03T17:13:07.986Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"coolboss","url":"/coolboss"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":439781,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose publicly?","automated_response":false,"created_at":"2015-06-03T17:13:26.649Z","updated_at":"2015-06-03T17:13:26.649Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":499172,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-07-03T17:17:57.648Z","updated_at":"2015-07-03T17:17:57.648Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}