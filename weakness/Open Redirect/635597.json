{"id":635597,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MzU1OTc=","url":"https://hackerone.com/reports/635597","title":"Wrong Interpretation of URL encoded characters, showing different punny code leads to redirection on different domain","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-07-04T12:19:54.553Z","submitted_at":"2019-07-04T12:19:54.553Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mr_edwards","url":"/mr_edwards","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/067/860/c4b005c6ce54203402e5bef359437411fd994419_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-26T16:55:39.330Z","bug_reporter_agreed_on_going_public_at":"2019-08-18T07:50:01.074Z","team_member_agreed_on_going_public_at":"2019-08-26T16:55:39.215Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary:\nThere is wrong interpretation of URL encoded characters at `https://twitter.com/safety/unsafe_link_warning` endpoint which could lead to different location then what is supposed to.\n\nAlthough it shows warning but doesn't show warning about punny code characters.\n\n##Description:\nOn following characters:\n\n```\n%E2%80%AE - RTLO Character\n%E2%80%8E - LEFT-TO-RIGHT MARK\n%E2%80%91 - Non breaking hyphen\n%E2%80%A9 - PARAGRAPH SEPARATOR\n%E2%80%AA 0 Right-to-left embedding\n```\nInterpretation of these characters is different but when we click continue button it will redirect you to some other location.\n\n## Steps To Reproduce:\n\n1. Go to following URL: https://twitter.com/safety/unsafe_link_warning?unsafe_link=https%3A%2F%2F%E2%80%AEmoc.rettiwt\n2. You will see that its showing : https://twitter.com\n\n{F522041}\n\nBut originally you will be redirected to https://xn--moc-4t7s.rettiwt/ when you click continue button.\n\n##Argument:\n\u003e But it is not possible to have TLD 'rettiwt'.\n* counter:\nWe can have URL as follows:\n```\nhttps://twitter.com/safety/unsafe_link_warning?unsafe_link=https%3A%2F%2F%E2%80%AEmoc.rettiwt.com\n```\n\n{F522042}\n\n\n\n## Supporting Material/References:\n\n  * screenshots.\n\n## Impact\n\nWrong location redirection.","bounty_amount":"560.0","formatted_bounty":"$560","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":522041,"file_name":"Screenshot_from_2019-06-21_15-13-58.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/522/041/507057707670ea247960784e8e409876f4662fa2/Screenshot_from_2019-06-21_15-13-58.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-06-21_15-13-58.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-06-21_15-13-58.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151359Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3395e483700bc3691302c5afbd2c777a610a13620229392290add0544de63279","file_size":118351,"type":"image/png"},{"id":522042,"file_name":"Screenshot_from_2019-07-02_09-18-24.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/522/042/0af1940f69eac2e93694b656c26464353c3373ab/Screenshot_from_2019-07-02_09-18-24.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-07-02_09-18-24.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-07-02_09-18-24.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151359Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2b1b887ea09b75cad967cdd08a8ac674002a9f94e73c75722f2ffd773873bb2f","file_size":113324,"type":"image/png"}],"allow_singular_disclosure_at":"2019-09-17T07:50:01.128Z","allow_singular_disclosure_after":-65258638.418159254,"singular_disclosure_allowed":true,"vote_count":36,"voters":["virenpawar","flawwan","mashoud1122","sameerphad72","spam404","s_p_q_r","mik317","ali","tulswani","nkr","and 26 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":1062,"asset_type":"URL","asset_identifier":"*.twitter.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5253638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that I was said to report again for #623743","automated_response":false,"created_at":"2019-07-04T12:20:29.722Z","updated_at":"2019-07-04T12:20:29.722Z","actor":{"username":"mr_edwards","cleared":true,"url":"/mr_edwards","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/067/860/c4b005c6ce54203402e5bef359437411fd994419_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5262159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report @mr_edwards,\n\nWe were able to reproduce the behavior you described and will get back to you when we have more information.\n\nThank you for thinking of Twitter security.","automated_response":false,"created_at":"2019-07-05T22:56:36.720Z","updated_at":"2019-07-05T22:56:36.720Z","actor":{"username":"bugtriage-alex","cleared":false,"url":"/bugtriage-alex","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5277712,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2019-07-08T21:53:00.552Z","updated_at":"2019-07-08T21:53:00.552Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5277723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're going to look into this and see if there's a reasonable way to mitigate this. It may take a little longer than expected to determine whether or not this will be something we can fix.","automated_response":false,"created_at":"2019-07-08T21:56:03.354Z","updated_at":"2019-07-08T21:56:03.354Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5310526,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2019-07-12T17:53:31.106Z","updated_at":"2019-07-12T17:53:31.106Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"560.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"mr_edwards","url":"/mr_edwards"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5312903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks","automated_response":false,"created_at":"2019-07-13T02:01:07.791Z","updated_at":"2019-07-13T02:01:07.791Z","actor":{"username":"mr_edwards","cleared":true,"url":"/mr_edwards","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/067/860/c4b005c6ce54203402e5bef359437411fd994419_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5594672,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2019-08-16T22:29:32.621Z","updated_at":"2019-08-16T22:29:32.621Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mr_edwards","url":"/mr_edwards"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5599088,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"seems fixed.","automated_response":false,"created_at":"2019-08-18T07:35:28.187Z","updated_at":"2019-08-18T07:35:28.187Z","actor":{"username":"mr_edwards","cleared":true,"url":"/mr_edwards","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/067/860/c4b005c6ce54203402e5bef359437411fd994419_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5599116,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"can we disclose?","automated_response":false,"created_at":"2019-08-18T07:50:01.097Z","updated_at":"2019-08-18T07:50:01.097Z","first_to_agree":true,"actor":{"username":"mr_edwards","cleared":true,"url":"/mr_edwards","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/067/860/c4b005c6ce54203402e5bef359437411fd994419_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5667910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again for your patience and thank you for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2019-08-26T16:55:39.244Z","updated_at":"2019-08-26T16:55:39.244Z","actor":{"username":"agoldman","cleared":false,"url":"/agoldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5667911,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-08-26T16:55:39.357Z","updated_at":"2019-08-26T16:55:39.357Z","actor":{"username":"agoldman","cleared":false,"url":"/agoldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}