{"id":677617,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Nzc2MTc=","url":"https://hackerone.com/reports/677617","title":"Open Redirect on Gitllab Oauth leading to Acount Takeover","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-08-20T16:05:50.921Z","submitted_at":"2019-08-20T16:05:50.921Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"luied1920","url":"/luied1920","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39174,"url":"https://hackerone.com/vercel","handle":"vercel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vercel","twitter_handle":"vercel","website":"https://vercel.com","about":"Creators of Next.js - Vercel is the platform for developing, previewing, and shipping Jamstack sites."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-22T02:27:04.280Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-11-22T02:26:56.249Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary:\nWhen an Open Redirect is used in a phishing attack, the victim receives an email that looks legitimate with a link that points to a correct and expected domain. What the victim may not notice, is that in the middle of a long URL there are parameters that manipulate and change where the link will take them. To make identification of the Open Redirect even more difficult, redirection could take place after the victim provides login on a legitimate website first.\nIn this case, when the victims access the URL, the attacker will receive all the authentication information he needs to take over his account.\n\n\n### Steps To Reproduce:\n\n **1**. After a restrict bypass on the Regex mechanism, the attacker can leak the git/zeit information from the victims\n\n\u003ehttps://zeit.co/api/now/registration/gitlab/connect?mode=login\u0026next=%09http:///zeit.co%40google.com\n*In this example the victim will be redirected to Google, but on a real attack he can be redirected to the attacker's endpoint (Untitled.png)*\n\n  **2**. The victim clicks on the malicious link \n\n*The victim will be redirected to google.com, Leaking: \ntoken\nemail\nsecurityCode\nusername\nloginType*\n**3**. After the the attacker can access\n\u003ehttps://zeit.co/login/?token=*****************\u0026mode=login\u0026email=luied***************.com\u0026securityCode=**********\u0026confirmed=1\u0026username=******\u0026loginType=gitlab\n\n*I logged in on a incognito tab to confirm it (logged in.png)*\n\n## Impact\n\nAttackers can compromise costumers at zeit, by taking out their accounts","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":560275,"file_name":"Untitled.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FQ5TWjwCmH6gGCUREepE8HoQ?response-content-disposition=attachment%3B%20filename%3D%22Untitled.png%22%3B%20filename%2A%3DUTF-8%27%27Untitled.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151702Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=63942c0c10869e85329e2c3975a4b557f68cac12136939c13068949ea452056c","file_size":78939,"type":"image/png"},{"id":560280,"file_name":"logged_in.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nV3HHYLHNYiaSboF2vk6vnPy?response-content-disposition=attachment%3B%20filename%3D%22logged_in.png%22%3B%20filename%2A%3DUTF-8%27%27logged_in.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151702Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e645f6ceb7a6aa6710efca7230e95c6ee3d6f3e7036f36ee45a772891b5fbd06","file_size":120324,"type":"image/png"}],"allow_singular_disclosure_at":"2019-12-22T02:26:56.320Z","allow_singular_disclosure_after":-56983805.93815112,"singular_disclosure_allowed":true,"vote_count":34,"voters":["a_null","msultan","base_64","mik317","imlonghao","realtess","sodium_","h4x0r_dz","m7mdharoun","exception","and 24 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":23160,"asset_type":"URL","asset_identifier":"*.vercel.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5830743,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any update?","automated_response":false,"created_at":"2019-09-18T03:48:08.390Z","updated_at":"2019-09-18T03:48:08.390Z","actor":{"username":"luied1920","cleared":false,"url":"/luied1920","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5951345,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any update?","automated_response":false,"created_at":"2019-10-03T13:46:22.437Z","updated_at":"2019-10-03T13:46:22.437Z","actor":{"username":"luied1920","cleared":false,"url":"/luied1920","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5987513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, thank you for reporting and apologies for the super delayed response. I will get back to you on this before the end of the week â€“ we are investigating it.","automated_response":false,"created_at":"2019-10-08T15:57:19.474Z","updated_at":"2019-10-08T15:57:19.474Z","actor":{"username":"matheus","cleared":false,"url":"/matheus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/247/741/342b3d75fa8ea8f78983b4a112db2ad8c3d4a248_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5995569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @luied1920 we are extremely sorry about the wait.\nWe just fixed this issue.\nCould you verify that please?\n\nThanks.","automated_response":false,"created_at":"2019-10-09T14:24:07.152Z","updated_at":"2019-10-09T14:24:07.152Z","actor":{"username":"arunoda-zeit","cleared":false,"url":"/arunoda-zeit","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6078210,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @arunoda-zeit \nIt's fixed!","automated_response":false,"created_at":"2019-10-19T04:16:43.908Z","updated_at":"2019-10-19T04:16:43.908Z","actor":{"username":"luied1920","cleared":false,"url":"/luied1920","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6264476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @arunoda-zeit, I would like to know if this bug's swag will be different from the one that I received in #541725\n","automated_response":false,"created_at":"2019-11-09T14:16:13.303Z","updated_at":"2019-11-09T14:16:13.303Z","actor":{"username":"luied1920","cleared":false,"url":"/luied1920","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6373769,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-11-22T00:48:56.708Z","updated_at":"2019-11-22T00:48:56.708Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":497163,"new_severity_id":572714},"actor":{"username":"matheus","cleared":false,"url":"/matheus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/247/741/342b3d75fa8ea8f78983b4a112db2ad8c3d4a248_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6373786,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@luied1920 the swag would be the same. Would you like to receive it? ","automated_response":false,"created_at":"2019-11-22T00:58:17.110Z","updated_at":"2019-11-22T00:58:35.639Z","actor":{"username":"matheus","cleared":false,"url":"/matheus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/247/741/342b3d75fa8ea8f78983b4a112db2ad8c3d4a248_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"luied1920","url":"/luied1920"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6373930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @matheus, yes I would like to receive it\nCould we disclose this report?","automated_response":false,"created_at":"2019-11-22T01:35:07.348Z","updated_at":"2019-11-22T01:35:07.348Z","actor":{"username":"luied1920","cleared":false,"url":"/luied1920","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NqfxL981sgPQGdZ1Rx94C2Uv/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6374057,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-22T02:26:56.269Z","updated_at":"2019-11-22T02:26:56.269Z","first_to_agree":true,"actor":{"username":"matheus","cleared":false,"url":"/matheus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/247/741/342b3d75fa8ea8f78983b4a112db2ad8c3d4a248_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6374059,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","automated_response":false,"created_at":"2019-11-22T02:27:04.267Z","updated_at":"2019-11-22T02:27:04.267Z","actor":{"url":"/vercel","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vercel"}},"reporter":{"username":"luied1920","url":"/luied1920"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6605652,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-22T02:27:04.305Z","updated_at":"2019-12-22T02:27:04.305Z","actor":{"url":"/vercel","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vercel"}},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}