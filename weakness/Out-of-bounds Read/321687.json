{"id":321687,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjE2ODc=","url":"https://hackerone.com/reports/321687","title":"`base64url` allocates uninitialized Buffers when number is passed in input on Node.js 4.x and below","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-03-03T23:35:58.959Z","submitted_at":"2018-03-03T23:35:58.959Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chalker","url":"/chalker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-11T20:18:15.861Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-05-11T20:18:07.953Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report an uninitialized Buffer allocation issue in `base64url`.\nIt allows to extract sensitive data from uninitialized memory or to cause a DoS by passing in a large number, in setups where typed user input can be passed (e.g. from JSON), on Node.js 4.x and lower.\n\n# Module\n\n**module name:** `base64url`\n**version:** 2.0.0\n**npm page:** `https://www.npmjs.com/package/base64url`\n\n## Module Description\n\n\u003e Converting to, and from, base64url\n\n## Module Stats\n\n182 924 downloads in the last day\n1 097 142 downloads in the last week\n4 601 176 downloads in the last month\n\n# Vulnerability\n\n## Vulnerability Description\n\nThe problem arises when a number is passed in, e.g. from user-submitted JSON-encoded data.\nThe API should not propagate the already-bad Buffer issue further.\n\nOn Node.js 4.x and below (4.x is still supported), this exposes uninitialized memory, which could contain sensitive data. This can be also used to cause a DoS by consuming the memory when large numbers are passed on input.\n\n## Steps To Reproduce:\n\n`console.log(require('base64url').encode(1000))`  (note uninitialized memory in output)\n`require('base64url').encode(1e8)` (note memory usage and time)\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- Arch Linux Current\n- Node.js 4.8.7\n\n# Wrap up\n\n- I contacted the maintainer to let them know: Y\n- I opened an issue in the related repository:  N\n\nI tried to contact the maintainer over email, first time on 2017-03-02, last time on 2018-02-18, but did not receive a reply.\n\n## Impact\n\nSensitive uninitialized memory exposure\nDenail of Service\nThis issue affects only setups using Node.js 4.x (still supported) or lower.","vulnerability_information_html":"\u003cp\u003eI would like to report an uninitialized Buffer allocation issue in \u003ccode\u003ebase64url\u003c/code\u003e.\u003cbr\u003e\nIt allows to extract sensitive data from uninitialized memory or to cause a DoS by passing in a large number, in setups where typed user input can be passed (e.g. from JSON), on Node.js 4.x and lower.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e \u003ccode\u003ebase64url\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 2.0.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/base64url\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eConverting to, and from, base64url\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e182 924 downloads in the last day\u003cbr\u003e\n1 097 142 downloads in the last week\u003cbr\u003e\n4 601 176 downloads in the last month\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe problem arises when a number is passed in, e.g. from user-submitted JSON-encoded data.\u003cbr\u003e\nThe API should not propagate the already-bad Buffer issue further.\u003c/p\u003e\n\n\u003cp\u003eOn Node.js 4.x and below (4.x is still supported), this exposes uninitialized memory, which could contain sensitive data. This can be also used to cause a DoS by consuming the memory when large numbers are passed on input.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003econsole.log(require(\u0026#39;base64url\u0026#39;).encode(1000))\u003c/code\u003e  (note uninitialized memory in output)\u003cbr\u003e\n\u003ccode\u003erequire(\u0026#39;base64url\u0026#39;).encode(1e8)\u003c/code\u003e (note memory usage and time)\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eArch Linux Current\u003c/li\u003e\n\u003cli\u003eNode.js 4.8.7\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: Y\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository:  N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI tried to contact the maintainer over email, first time on 2017-03-02, last time on 2018-02-18, but did not receive a reply.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSensitive uninitialized memory exposure\u003cbr\u003e\nDenail of Service\u003cbr\u003e\nThis issue affects only setups using Node.js 4.x (still supported) or lower.\u003c/p\u003e\n","weakness":{"id":8,"name":"Out-of-bounds Read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-10T20:18:08.082Z","allow_singular_disclosure_after":-80558208.66838957,"singular_disclosure_allowed":true,"vote_count":4,"voters":["kapytein","bl4de","0x08","nims786"],"severity":{"rating":"high","score":7.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":9722,"asset_type":"SOURCE_CODE","asset_identifier":"base64url","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2577520,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chalker,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chalker\"\u003e@chalker\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-08T07:27:14.972Z","updated_at":"2018-04-08T07:27:14.972Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2577522,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-08T07:28:43.949Z","updated_at":"2018-04-08T07:28:43.949Z","additional_data":{"old_severity":"Medium","new_severity":"High (7.1)","old_severity_id":124633,"new_severity_id":136927},"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2577524,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-08T07:29:02.056Z","updated_at":"2018-04-08T07:29:02.056Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2661116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Tried to ping author on twitter","markdown_message":"\u003cp\u003eTried to ping author on twitter\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-24T19:43:49.017Z","updated_at":"2018-04-24T19:43:49.017Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2729688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chalker no reply from author.\nshall we continue with disclosing?","markdown_message":"\u003cp\u003e\u003ca href=\"/chalker\"\u003e@chalker\u003c/a\u003e no reply from author.\u003cbr\u003e\nshall we continue with disclosing?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-11T15:37:49.099Z","updated_at":"2018-05-11T15:37:49.099Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2730172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, please. I too failed to contact the maintainer previously.\n\nThere is a drop-in replacement afaik, so the fix should be trivial for users.\n\nI think that ~simultaneous disclosure on h1, nswg db and the GitHub repo issue/pr would be ideal here.\nPerhaps I will prepare a PR to the authors repo after a PR to nswg db is opened.","markdown_message":"\u003cp\u003eYes, please. I too failed to contact the maintainer previously.\u003c/p\u003e\n\n\u003cp\u003eThere is a drop-in replacement afaik, so the fix should be trivial for users.\u003c/p\u003e\n\n\u003cp\u003eI think that ~simultaneous disclosure on h1, nswg db and the GitHub repo issue/pr would be ideal here.\u003cbr\u003e\nPerhaps I will prepare a PR to the authors repo after a PR to nswg db is opened.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-11T17:48:33.562Z","updated_at":"2018-05-11T17:49:08.381Z","actor":{"username":"chalker","cleared":false,"url":"/chalker","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2731229,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-11T20:18:01.822Z","updated_at":"2018-05-11T20:18:01.822Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chalker","url":"/chalker"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2731230,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-11T20:18:07.996Z","updated_at":"2018-05-11T20:18:07.996Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2731231,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-11T20:18:15.807Z","updated_at":"2018-05-11T20:18:15.807Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2764950,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-19T07:21:43.991Z","updated_at":"2018-05-19T07:21:43.991Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"base64url","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}