{"id":765825,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjU4MjU=","url":"https://hackerone.com/reports/765825","title":"Git repo on https://██████.mil/ discloses API password","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-29T16:49:49.871Z","submitted_at":"2019-12-29T16:49:49.871Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"al-madjus","url":"/al-madjus","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-03-24T20:49:00.187Z","bug_reporter_agreed_on_going_public_at":"2021-03-22T17:11:56.877Z","team_member_agreed_on_going_public_at":"2021-03-24T20:49:00.098Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nI found a .git repository on https://███████.mil/.git which discloses an API password for Yubikey on 2 different domains, together with full source code. \n\n**Description:**\nFetching the git repository and decompressing the objects results in the ability to read the source code of the server, which includes an API password for the Yubikey hardware authentication software. The API however does not appear to be functional on the main domain, but since the repository is very recent, I cannot be certain that it'll stay non-functional. \nAdditionally, the server discloses info.php at https://███████.mil/info.php. I'm uncertain if this should be reported separately, any comments on this would be very welcome! \n\n## Impact\nI'm rating the impact of this primarily as an information disclosure. The repository appears to have been active within the past months, so any future additions will be disclosed too. \nI was unable to use the found password as the API appears to be currently non-functional, but since the repo is active I would expect the server to be worked upon, and the API to be functional in the future. For this reason I've decided to make you aware of the issue. \nAlso, even if the password were to be changed, it would of course still be disclosed on the repository. \nFurthermore, the repository discloses the full source code of the served pages. \n\n## Step-by-step Reproduction Instructions\n\n1. Fetch the repo with wget:\n\n`wget --no-parent -r https://█████.mil/.git/ --no-check-certificate`\n2. Write the following python script (remember to update the 'pwd' variable): \n\n`import zlib\nimport os\npwd = INSERT FULL PATH WHERE THE REPO WAS DOWNLOADED + '█████████.mil/.git/objects/'\nfor subdir, dirs, files in os.walk(pwd):\n    for file in files:\n        if not file.startswith(\"index\"):\n            filename = subdir + '/' +  file\n            compressed_contents = open(filename, 'rb').read()\n            decompressed_contents = zlib.decompress(compressed_contents)\n            print(str(decompressed_contents) + '\\n')`\n\nThe script is also attached as a file. \n3. Run the script with \n\n`python gitreader.py | grep -i -E -o \".{0,138}restPW.{0,22}\"`\n\nWhich greps the output for the string where the password is, together with the paths/domains. \nOf course, the full contents of the repository are available to look through. \n\nExample output: \n`'https://███`\n\n## Product, Version, and Configuration (If applicable)\n\n## Suggested Mitigation/Remediation Actions\nRemove the .git repository from the server, since it contains sensitive information.\n\n## Impact\n\nI'm rating the impact of this primarily as an information disclosure. The repository appears to have been active within the past months, so any future additions will be disclosed too. \nI was unable to use the found password as the API appears to be currently non-functional, but since the repo is active I would expect the server to be worked upon, and the API to be functional in the future. For this reason I've decided to make you aware of the issue. \nAlso, even if the password were to be changed, it would of course still be disclosed on the repository. \nFurthermore, the repository discloses the full source code of the served pages.","weakness":{"id":24,"name":"Password in Configuration File"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["mr-medi","pronged_fork","chron0x_","0xelkomy","ahiezer","brumens","sa1tama0","yaboyanees","rutrut","5p00n"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6646198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-12-29T16:49:50.147Z","updated_at":"2019-12-29T16:49:50.147Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6658951,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello,\n1: Having some issues with your script. Specifically not getting the same output. Will you provide the specific object with the password?\n2: For our program, you can submit the info.php separately if you would like since it is a separate STIG. The report will end up going to the same system owner though.","automated_response":false,"created_at":"2019-12-30T12:26:06.084Z","updated_at":"2019-12-30T12:26:06.084Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659144,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi, \nTry piping the output of gitreader.py to another file with \n`python gitreader.py \u003e output.txt`\nThen grepping the contents of that file with\n`cat output.txt | grep -i -E -o \".{0,138}restPW.{0,22}\"`\n\n\nAnyway, these are the objects containing the password (subfolder/object): \n\n`█████████\n████████\n█████████\n███████\n███████\n██████\n█████\n███\n██████████\n██████\n███`\n\nI'll report the info.php separately, thank you. \nHappy new year!","automated_response":false,"created_at":"2019-12-30T12:47:50.266Z","updated_at":"2021-03-24T19:50:01.344Z","actor":{"username":"al-madjus","cleared":false,"url":"/al-madjus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If I'm not mistaken, Kali Linux uses python-2 by default, try running the script with `python3` instead and see if it still errors out. ","automated_response":false,"created_at":"2019-12-30T12:55:29.959Z","updated_at":"2019-12-30T12:55:29.959Z","actor":{"username":"al-madjus","cleared":false,"url":"/al-madjus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659453,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-12-30T13:50:52.354Z","updated_at":"2019-12-30T13:50:52.354Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":597892},"actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6659455,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-12-30T13:50:54.617Z","updated_at":"2019-12-30T13:50:54.617Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11080119,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2021-03-22T16:48:58.006Z","updated_at":"2021-03-22T16:48:58.006Z","actor":{"username":"agent-j5","cleared":false,"url":"/agent-j5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"al-madjus","url":"/al-madjus"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11080639,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! Would it be possible to disclosure this report? ","automated_response":false,"created_at":"2021-03-22T17:11:56.904Z","updated_at":"2021-03-22T17:11:56.904Z","first_to_agree":true,"actor":{"username":"al-madjus","cleared":false,"url":"/al-madjus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11110669,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2021-03-24T20:49:00.115Z","updated_at":"2021-03-24T20:49:00.115Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11110670,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-03-24T20:49:00.216Z","updated_at":"2021-03-24T20:49:00.216Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11110673,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2021-03-24T20:49:09.719Z","updated_at":"2021-03-24T20:49:09.719Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}