{"id":1007799,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDA3Nzk5","url":"https://hackerone.com/reports/1007799","title":"Local File Inclusion In Registration Page","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-10-13T23:23:56.794Z","submitted_at":"2020-10-13T23:23:56.819Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"moloshy","url":"/moloshy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T18:27:36.444Z","bug_reporter_agreed_on_going_public_at":"2020-11-10T13:36:23.342Z","team_member_agreed_on_going_public_at":"2020-11-23T18:27:36.323Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nWhen registering on https://████████ it is possible to use path traversal characters in a parameter allowing an attacker to read local files.\n\n**Description:**\nThe registerUserInfoCommand.nextPageName parameter within the registration form is vulnerable to file path manipulation, where it is possible to submit a request containing path traversal characters (e.g. ../../../) followed by a local file, which will return the contents of the file. This can be used to read local files including sensitive configuration files such as /WEB-INF/web.xml, /WEB-INF/app-config.xml and /WEB-INF/spring/explicit-security-config.xml.\n\n## Impact\nAn attacker could read local files on the web server that they would normally not have access to, such as the application source code or configuration files containing sensitive information on how the website is configured. \n\n## Step-by-step Reproduction Instructions\n\n1. Browse to https://██████/████████/register/RegisterUserInfo.htm\n2. Setup an intercepting proxy (e.g. BurpSuite) and click Next, catching the request in Burp (don't worry about filling out the form fields)\n3. For ease here I would recommend copying and pasting the below parameters into the request, replacing the parameters that were there originally.  This request will fetch the /WEB-INF/web.xml configuration file, I have also attached two other requests which grab app-config.xml and explicity-security-config.xml. Once the parameters are there, forward the request to the server and you should see the web.xml file.  \n\n```\nregisterUserInfoCommand.organization=Chantest+Corporation\u0026registerUserInfoCommand.organizationId=49800\u0026registerUserInfoCommand.currPageName=SearchUserOrgInfo.jsp\u0026registerUserInfoCommand.nextPageName=..%2f..%2f..%2fWEB-INF%2fweb.xml\u0026registerUserInfoCommand.prevPageName=jsp%2FRegistration%2FRegisterAccountInfo.jsp\u0026registerUserInfoCommand.submitButton=Choose+This+Organization+and+Continue+%3E\n```\n\n## Product, Version, and Configuration (If applicable)\nN/A\n\n## Suggested Mitigation/Remediation Actions\nRather than placing the filename of the next page directly in a parameter, it would be better to maintain a whitelist of acceptable filenames and use a unique corresponding identifier to access the file. Then any request containing an invalid identifier can just be rejected. Additionally, you could also sanitise any path traversal characters that may be present in a request.\n\n## Impact\n\nAn attacker could read local files on the web server that they would normally not have access to, such as the application source code or configuration files containing sensitive information on how the website is configured.","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["lewiswildgoose","m0chan","0xelkomy","mirazdevox","dastan_9408","t3chn0phil3","shadowcracker","farmerted","enjoyablelogi","ross25"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9514554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2020-10-13T23:23:57.737Z","updated_at":"2020-10-13T23:23:57.737Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9514556,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-10-13T23:24:27.020Z","updated_at":"2020-11-23T18:24:34.917Z","additional_data":{"old_title":"Local File Inclusion On https://█████████","new_title":"Local File Inclusion In Registration Page https://██████████"},"actor":{"username":"moloshy","cleared":false,"url":"/moloshy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9514578,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-10-13T23:24:41.390Z","updated_at":"2020-11-23T18:24:34.911Z","additional_data":{"old_title":"Local File Inclusion In Registration Page https://████████","new_title":"Local File Inclusion In Registration Page"},"actor":{"username":"moloshy","cleared":false,"url":"/moloshy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9514795,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"After submitting this I realised that browsing directly to https://█████████/██████/register/RegisterUserInfo.htm without a session established throws a HTTP 500 Internal Server Error. So instead, you will have to follow the below steps first:\n\n1. Browse to https://█████/███████/register/Register.htm\n2. Click the Start Registration button\n3. Search for an organisation, here I just put 'test' hit search and clicked the Choose This Organization and Continue button for the first result that came up\n4. Now you should be on the RegisterUserInfo.htm page I originally mentioned in the report and can continue with the steps I mentioned in the original submission: submit and catch the request in an intercepting proxy, replacing the parameters with the ones I have provided    ","automated_response":false,"created_at":"2020-10-13T23:37:13.167Z","updated_at":"2020-11-23T18:25:16.687Z","actor":{"username":"moloshy","cleared":false,"url":"/moloshy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9524627,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-10-14T18:53:48.186Z","updated_at":"2020-10-14T18:53:48.186Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":877064},"actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9524628,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2020-10-14T18:53:52.161Z","updated_at":"2020-10-14T18:53:52.161Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9524640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you find a more sensitive file to point to, let us know and we can raise severity. Thanks!","automated_response":false,"created_at":"2020-10-14T18:54:24.934Z","updated_at":"2020-10-14T18:54:24.934Z","actor":{"username":"agent-l8","cleared":false,"url":"/agent-l8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9525235,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @agent-l8 I found a few more files that I can read. The extra files I was able to read are:\n\n/WEB-INF/spring/mvc-config.xml\n/WEB-INF/spring/rest-config.xml\n/WEB-INF/classes/compliance/reports/adminRpt.pre.sql\n/WEB-INF/classes/compliance/reports/adminRpt.full.sql\n/WEB-INF/classes/compliance/reports/complianceStatusRptSql.sql\n/WEB-INF/classes/████.properties\n\nSo the three SQL files contain raw SQL code including table and column names etc. The last file listed there is probably the most sensitive, I found some credentials in there for unit testing:\n\nTest.DB.URL=jdbc:oracle:thin:@localhost:1521:XE\nTest.DB.username=██████████\nTest.DB.password=██████\n\nIs this enough to raise the severity up to high? \n\nCheers,\nJosh","automated_response":false,"created_at":"2020-10-14T20:06:48.242Z","updated_at":"2020-11-23T18:26:30.677Z","actor":{"username":"moloshy","cleared":false,"url":"/moloshy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9778890,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2020-11-10T13:26:11.521Z","updated_at":"2020-11-10T13:26:11.521Z","actor":{"username":"agent-j5","cleared":false,"url":"/agent-j5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"moloshy","url":"/moloshy"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9778995,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi guys,\n\nAre we able to disclose this one? Also is there any update on pushing the severity up to high based off the more sensitive files I found?\n\nCheers,\nJosh","automated_response":false,"created_at":"2020-11-10T13:36:23.354Z","updated_at":"2020-11-10T13:36:23.354Z","first_to_agree":true,"actor":{"username":"moloshy","cleared":false,"url":"/moloshy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/N6pTRwogeYiupyWB7oCHXf65/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9902511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@moloshy I'll be disclosing this report today and yeah based on your last finding on this server before mitigation I think it's fair to up this to a high severity.\n","automated_response":false,"created_at":"2020-11-23T18:16:24.142Z","updated_at":"2020-11-23T18:16:24.142Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902647,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2020-11-23T18:27:36.348Z","updated_at":"2020-11-23T18:27:36.348Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902648,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-11-23T18:27:36.467Z","updated_at":"2020-11-23T18:27:36.467Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902650,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2020-11-23T18:27:44.275Z","updated_at":"2020-11-23T18:27:44.275Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9902655,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"automated_response":false,"created_at":"2020-11-23T18:28:11.568Z","updated_at":"2020-11-23T18:28:11.568Z","additional_data":{"old_severity":"Medium","new_severity":"High","old_severity_id":877064,"new_severity_id":913613},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}