{"id":307666,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDc2NjY=","url":"https://hackerone.com/reports/307666","title":"[serve] Directory index of arbitrary folder available due to lack of sanitization of %2e and %2f characters in url","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-01-21T15:44:02.801Z","submitted_at":"2018-01-21T15:44:02.801Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bl4de","url":"/bl4de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3712"],"singular_disclosure_disabled":false,"disclosed_at":"2018-01-23T16:01:07.919Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-01-23T15:33:07.500Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThis report is about Arbitrary Directory Listing vulnerability I found in serve module.\nVulnerability does not allow to open arbitrary file due to ```send``` module which handles file reading and implements its own validation and protection against Path Traversal attacks.\n\nHowever ```serve``` handles directory listing on its own and does not protect against listing of any directory on the remote server.\n\n**Module:** \n\n```Serve``` is a module which allows to server static files and browse directories in the browser. The vulnerability exists in the latest available version (6.4.8)\n\nLink to npm page: https://www.npmjs.com/package/serve\n\n**Summary:** \n\n```Serve``` does not handle ```%2e``` (.) and ```%2f``` (/) and allows to use them in paths, which can be used do go up through directory tree and lists content of any directory.\n\n\n## Steps To Reproduce:\n\n- install ```serve```\n\n```\n$ npm install serve\n```\n\n- create simple application which uses ```http-pages``` for serving static files from local server:\n\n```javascript\nconst serve = require('serve')\n\nconst server = serve(__dirname, {\n    port: 4444,\n    ignore: []\n})\n```\n\n- run application:\n\n```\n$ node app.js\n```\n\n- open the browser and go to ```http://localhost:4444``` You should see all directories and files in the directory, where ```app.js``` was run:\n\n{F256095}\n\n- now, open the following url: ```http://localhost:4444/..%2f/..%2f/..%2f/..%2f/etc/``` (please adjust the number of ..%2f/ to reflect your system). You'll be able to see the content of ```/etc``` directory:\n\n{F256096}\n\n\n## Supporting Material/References:\n\nConfiguration I've used to find this vulnerability:\n\n- macOS HighSierra 10.13.2\n- node 8.9.3\n- npm 5.5.1\n- curl 7.54.0\n\n## Wrap up\n\nI hope this report will help to keep Node ecosystem more safe. If you have any questions about any details of this finding, please let me know in comment.\n\nThank you\n\nRegards,\n\nRafal 'bl4de' Janicki\n\n## Impact\n\nThis vulnerability allows malisious user to list content of any directory on the remote machine, where ```serve``` runs. Although it's not enough to open and read arbitrary files, this still might expose some sensitive information which can be used in different attacks.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThis report is about Arbitrary Directory Listing vulnerability I found in serve module.\u003cbr\u003e\nVulnerability does not allow to open arbitrary file due to \u003ccode\u003esend\u003c/code\u003e module which handles file reading and implements its own validation and protection against Path Traversal attacks.\u003c/p\u003e\n\n\u003cp\u003eHowever \u003ccode\u003eserve\u003c/code\u003e handles directory listing on its own and does not protect against listing of any directory on the remote server.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eModule:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eServe\u003c/code\u003e is a module which allows to server static files and browse directories in the browser. The vulnerability exists in the latest available version (6.4.8)\u003c/p\u003e\n\n\u003cp\u003eLink to npm page: \u003ca title=\"https://www.npmjs.com/package/serve\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fserve\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/serve\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eServe\u003c/code\u003e does not handle \u003ccode\u003e%2e\u003c/code\u003e (.) and \u003ccode\u003e%2f\u003c/code\u003e (/) and allows to use them in paths, which can be used do go up through directory tree and lists content of any directory.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003einstall \u003ccode\u003eserve\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm install serve\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003ecreate simple application which uses \u003ccode\u003ehttp-pages\u003c/code\u003e for serving static files from local server:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eserve\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eserve\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eserver\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eserve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e4444\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eignore\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003erun application:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node app.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eopen the browser and go to \u003ccode\u003ehttp://localhost:4444\u003c/code\u003e You should see all directories and files in the directory, where \u003ccode\u003eapp.js\u003c/code\u003e was run:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/095/5ad4a888dbbf99e80ed42657a56b6f47bb7f9e16/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053043Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026amp;X-Amz-Signature=7f488db32b4e073b593f36493bd4e83898a80563ae5bcaaa00195a88a75c382e\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/095/5ad4a888dbbf99e80ed42657a56b6f47bb7f9e16/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053043Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026amp;X-Amz-Signature=7f488db32b4e073b593f36493bd4e83898a80563ae5bcaaa00195a88a75c382e\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003enow, open the following url: \u003ccode\u003ehttp://localhost:4444/..%2f/..%2f/..%2f/..%2f/etc/\u003c/code\u003e (please adjust the number of ..%2f/ to reflect your system). You\u0026#39;ll be able to see the content of \u003ccode\u003e/etc\u003c/code\u003e directory:\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/096/57a8271d41ee8ef0567eb54af13e5228336d7aa1/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053043Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026amp;X-Amz-Signature=eacba41b484af747de4efad4e3e465c885bd6e377872bcae35fb4550c5c1e214\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/096/57a8271d41ee8ef0567eb54af13e5228336d7aa1/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053043Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026amp;X-Amz-Signature=eacba41b484af747de4efad4e3e465c885bd6e377872bcae35fb4550c5c1e214\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eConfiguration I\u0026#39;ve used to find this vulnerability:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003emacOS HighSierra 10.13.2\u003c/li\u003e\n\u003cli\u003enode 8.9.3\u003c/li\u003e\n\u003cli\u003enpm 5.5.1\u003c/li\u003e\n\u003cli\u003ecurl 7.54.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"wrap-up\"\u003eWrap up\u003c/h2\u003e\n\n\u003cp\u003eI hope this report will help to keep Node ecosystem more safe. If you have any questions about any details of this finding, please let me know in comment.\u003c/p\u003e\n\n\u003cp\u003eThank you\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eRafal \u0026#39;bl4de\u0026#39; Janicki\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability allows malisious user to list content of any directory on the remote machine, where \u003ccode\u003eserve\u003c/code\u003e runs. Although it\u0026#39;s not enough to open and read arbitrary files, this still might expose some sensitive information which can be used in different attacks.\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":256095,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/095/5ad4a888dbbf99e80ed42657a56b6f47bb7f9e16/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053043Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=7f488db32b4e073b593f36493bd4e83898a80563ae5bcaaa00195a88a75c382e","file_size":97887,"type":"image/png"},{"id":256096,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/096/57a8271d41ee8ef0567eb54af13e5228336d7aa1/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053043Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=eacba41b484af747de4efad4e3e465c885bd6e377872bcae35fb4550c5c1e214","file_size":514557,"type":"image/png"}],"allow_singular_disclosure_at":"2018-02-22T15:33:07.599Z","allow_singular_disclosure_after":-89906256.00685464,"singular_disclosure_allowed":true,"vote_count":10,"voters":["sp1d3rs","muon4","ysx","eveeez","0xchr00t","whitesector","khaledibnalwalid","cr4xerbik4sh","japz","dobbywankenobi"],"severity":{"rating":"critical","score":9.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":5006,"asset_type":"SOURCE_CODE","asset_identifier":"serve","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2304842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e create simple application which uses http-pages for serving static files from local server:\n\nOf course it should be:\n\ncreate simple application which **uses ```serve```** for serving static files from local server:\n\nSorry for this.\n\nRegards,\n\nbl4de","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003ecreate simple application which uses http-pages for serving static files from local server:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eOf course it should be:\u003c/p\u003e\n\n\u003cp\u003ecreate simple application which \u003cstrong\u003euses \u003ccode\u003eserve\u003c/code\u003e\u003c/strong\u003e for serving static files from local server:\u003c/p\u003e\n\n\u003cp\u003eSorry for this.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-21T15:46:23.801Z","updated_at":"2018-01-21T15:46:23.801Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2304936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello @bl4de thanks for reporting this to us. I will be looking at it shortly.","markdown_message":"\u003cp\u003ehello \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e thanks for reporting this to us. I will be looking at it shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-21T17:19:39.067Z","updated_at":"2018-01-21T17:19:39.067Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2304937,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-21T17:20:15.196Z","updated_at":"2018-01-21T17:20:15.196Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"Other module","new_scope":"serve","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @bl4de , thanks again for reporting this. I was able to reproduce the described behavior and will consider this as a security issue. Have you already tried to contact maintaners regarding this?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e , thanks again for reporting this. I was able to reproduce the described behavior and will consider this as a security issue. Have you already tried to contact maintaners regarding this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T10:26:06.031Z","updated_at":"2018-01-22T10:26:06.031Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306169,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-22T10:26:12.928Z","updated_at":"2018-01-22T10:26:12.928Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vdeturckheim \n\nThank you for veryfing the issue.\n\nI did not contact maintainers as due to existence of Node.js ecosystem program my intention was to keep the whole process of reporting and resolving  vulnerability consistent and managed through this report. \n\nAlso I didn't want to open issue in official package GitHub repository to not to raise the flag and put package users into the situation that vulnerability might be exploited against them before maintainers even had a chance to patch it.\n\nFeel free to contact/invite anyone who might be interested/involved.\n\nRegards,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vdeturckheim\"\u003e@vdeturckheim\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for veryfing the issue.\u003c/p\u003e\n\n\u003cp\u003eI did not contact maintainers as due to existence of Node.js ecosystem program my intention was to keep the whole process of reporting and resolving  vulnerability consistent and managed through this report. \u003c/p\u003e\n\n\u003cp\u003eAlso I didn\u0026#39;t want to open issue in official package GitHub repository to not to raise the flag and put package users into the situation that vulnerability might be exploited against them before maintainers even had a chance to patch it.\u003c/p\u003e\n\n\u003cp\u003eFeel free to contact/invite anyone who might be interested/involved.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T10:46:11.396Z","updated_at":"2018-01-22T10:46:11.396Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306226,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Perfect, @bl4de , I have just emailed the lead maintainer of this package (and pinged him through a DM on twitter). ","markdown_message":"\u003cp\u003ePerfect, \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e , I have just emailed the lead maintainer of this package (and pinged him through a DM on twitter). \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T10:53:58.317Z","updated_at":"2018-01-22T10:53:58.317Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! As I am going to spend some time on Node.js ecosystem  program,  I'll be keeping this way of raising issues in the future as well (I mean I will always open report on HackerOne first).\n\nAre you ok with this?\n\nbl4de","markdown_message":"\u003cp\u003eGreat! As I am going to spend some time on Node.js ecosystem  program,  I\u0026#39;ll be keeping this way of raising issues in the future as well (I mean I will always open report on HackerOne first).\u003c/p\u003e\n\n\u003cp\u003eAre you ok with this?\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T10:56:56.363Z","updated_at":"2018-01-22T10:56:56.363Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306500,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bl4de no problem with that. It is procedure to us to ask if you already contacted the maintainer so it might happen often but we are used to contacting them ourselves and this is totally fine!","markdown_message":"\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e no problem with that. It is procedure to us to ask if you already contacted the maintainer so it might happen often but we are used to contacting them ourselves and this is totally fine!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T13:24:45.678Z","updated_at":"2018-01-22T13:24:45.678Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vdeturckheim That's perfect. Let's keep this in that way in the future then.\n\nThanks again for this program and  amazing opportunity to help Node.js ecosystem to be safe :)\n\nRegards,\n\nbl4de \n\n","markdown_message":"\u003cp\u003e\u003ca href=\"/vdeturckheim\"\u003e@vdeturckheim\u003c/a\u003e That\u0026#39;s perfect. Let\u0026#39;s keep this in that way in the future then.\u003c/p\u003e\n\n\u003cp\u003eThanks again for this program and  amazing opportunity to help Node.js ecosystem to be safe :)\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T13:34:05.065Z","updated_at":"2018-01-22T13:34:05.065Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Leo Lamprecht has been invited to this report.","markdown_message":"\u003cp\u003eLeo Lamprecht has been invited to this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T13:58:01.413Z","updated_at":"2018-01-22T13:58:01.413Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306608,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-22T14:03:16.473Z","updated_at":"2018-01-22T14:03:16.473Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306611,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-22T14:05:23.668Z","updated_at":"2018-01-22T14:05:23.668Z","additional_data":{"old_severity":"Low","new_severity":"Critical (9.3)","old_severity_id":110689,"new_severity_id":110862},"actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this, guys!\n\nI'll work on this today and get a patch shipped.\n\nWill keep you updated.","markdown_message":"\u003cp\u003eThanks for reporting this, guys!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll work on this today and get a patch shipped.\u003c/p\u003e\n\n\u003cp\u003eWill keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T14:05:50.551Z","updated_at":"2018-01-22T14:05:50.551Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2306633,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, @notquiteleo .\nI just required a CVE through HackerOne since we do not do it at Foundation level at the moment).","markdown_message":"\u003cp\u003eAwesome, \u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e .\u003cbr\u003e\nI just required a CVE through HackerOne since we do not do it at Foundation level at the moment).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-22T14:11:08.081Z","updated_at":"2018-01-22T14:11:08.081Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2306707,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-22T14:30:51.782Z","updated_at":"2018-01-22T14:30:51.782Z","cve_ids":["CVE-2018-3712"],"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2309901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just posted a fix:\n\nhttps://github.com/zeit/serve/pull/316\n\nCan you verify that it's working by doing `npm install \u0026\u0026 npm link \u0026\u0026 serve` locally?\n\nThanks!","markdown_message":"\u003cp\u003eJust posted a fix:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/zeit/serve/pull/316\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeit%2Fserve%2Fpull%2F316\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeit/serve/pull/316\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCan you verify that it\u0026#39;s working by doing \u003ccode\u003enpm install \u0026amp;\u0026amp; npm link \u0026amp;\u0026amp; serve\u003c/code\u003e locally?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T13:10:40.383Z","updated_at":"2018-01-23T13:10:40.383Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2309960,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @notquiteleo \n\nAs far as I can test the patch, I am not able to reproduce this issue anymore. Seems that ```decodeURIComponent()``` and ```is-path-inside``` do  their job well here  :)\n\nThis is response I get from the server when trying to go \"up\":\n\n```\n$ curl -v --path-as-is http://localhost:4444/..%2f/..%2f/..%2f/..%2f/..%2f/etc/\n*   Trying ::1...\n* Connected to localhost (::1) port 4444 (#0)\n\u003e GET /..%2f/..%2f/..%2f/..%2f/..%2f/etc/ HTTP/1.1\n\u003e Host: localhost:4444\n\u003e User-Agent: curl/7.47.0\n\u003e Accept: */*\n\u003e \n\u003c HTTP/1.1 400 Bad Request\n\u003c Content-Length: 11\n\u003c Date: Tue, 23 Jan 2018 13:37:24 GMT\n\u003c Connection: keep-alive\n\u003c \n* Connection #0 to host localhost left intact\nBad Request\n```\n\nThat's pretty good behaviour tho :)\nGood job!\n\nRegards,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eAs far as I can test the patch, I am not able to reproduce this issue anymore. Seems that \u003ccode\u003edecodeURIComponent()\u003c/code\u003e and \u003ccode\u003eis-path-inside\u003c/code\u003e do  their job well here  :)\u003c/p\u003e\n\n\u003cp\u003eThis is response I get from the server when trying to go \u0026quot;up\u0026quot;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -v --path-as-is http://localhost:4444/..%2f/..%2f/..%2f/..%2f/..%2f/etc/\n*   Trying ::1...\n* Connected to localhost (::1) port 4444 (#0)\n\u0026gt; GET /..%2f/..%2f/..%2f/..%2f/..%2f/etc/ HTTP/1.1\n\u0026gt; Host: localhost:4444\n\u0026gt; User-Agent: curl/7.47.0\n\u0026gt; Accept: */*\n\u0026gt; \n\u0026lt; HTTP/1.1 400 Bad Request\n\u0026lt; Content-Length: 11\n\u0026lt; Date: Tue, 23 Jan 2018 13:37:24 GMT\n\u0026lt; Connection: keep-alive\n\u0026lt; \n* Connection #0 to host localhost left intact\nBad Request\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat\u0026#39;s pretty good behaviour tho :)\u003cbr\u003e\nGood job!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T13:41:13.022Z","updated_at":"2018-01-23T13:41:13.022Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2309971,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@notquiteleo @bl4de awesome, great job by both of you! \n\n@notquiteleo when do you think you will release the patched version? Also, do you know if all versions older than 6.4.8 are affected? \n\nIf that's good for everyone, I'd like to disclose this after release of the patch. ","markdown_message":"\u003cp\u003e\u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e awesome, great job by both of you! \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e when do you think you will release the patched version? Also, do you know if all versions older than 6.4.8 are affected? \u003c/p\u003e\n\n\u003cp\u003eIf that\u0026#39;s good for everyone, I\u0026#39;d like to disclose this after release of the patch. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T13:44:38.382Z","updated_at":"2018-01-23T13:44:38.382Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2309977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vdeturckheim,\n\nI'll be more than happy to see this report disclosed :)\n\nbl4de\n\nPS. Working with you guys is just a pleasure.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vdeturckheim\"\u003e@vdeturckheim\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll be more than happy to see this report disclosed :)\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n\n\u003cp\u003ePS. Working with you guys is just a pleasure.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T13:47:14.847Z","updated_at":"2018-01-23T13:47:14.847Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2310165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for helping out!\n\nI just released `serve` 6.4.9 with that patch: https://github.com/zeit/serve/releases/tag/6.4.9\n\n@vdeturckheim Older versions than 6.4.8 are probably also affected.\n\n@bl4de I'd like to hand you a $500 bounty for catching the bug. Can you reach out to leo@zeit.co with your preferred way of receiving it? I can also offer you 1 year \"Pro\" on Now (https://zeit.co).\n\nLet me know!","markdown_message":"\u003cp\u003eThanks again for helping out!\u003c/p\u003e\n\n\u003cp\u003eI just released \u003ccode\u003eserve\u003c/code\u003e 6.4.9 with that patch: \u003ca title=\"https://github.com/zeit/serve/releases/tag/6.4.9\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fzeit%2Fserve%2Freleases%2Ftag%2F6.4.9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/zeit/serve/releases/tag/6.4.9\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/vdeturckheim\"\u003e@vdeturckheim\u003c/a\u003e Older versions than 6.4.8 are probably also affected.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e I\u0026#39;d like to hand you a $500 bounty for catching the bug. Can you reach out to \u003ca title=\"leo@zeit.co\" href=\"mailto:leo@zeit.co\" rel=\"nofollow noopener noreferrer\"\u003eleo@zeit.co\u003c/a\u003e with your preferred way of receiving it? I can also offer you 1 year \u0026quot;Pro\u0026quot; on Now (\u003ca title=\"https://zeit.co\" href=\"/redirect?url=https%3A%2F%2Fzeit.co\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://zeit.co\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eLet me know!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T15:26:30.002Z","updated_at":"2018-01-23T15:26:30.002Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2310179,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-23T15:31:20.576Z","updated_at":"2018-01-23T15:31:20.576Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"bl4de","url":"/bl4de"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2310180,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's awesome @notquiteleo,  thank you so much!\n\nStay Safe guys!\n\nbl4de \n","markdown_message":"\u003cp\u003eThat\u0026#39;s awesome \u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e,  thank you so much!\u003c/p\u003e\n\n\u003cp\u003eStay Safe guys!\u003c/p\u003e\n\n\u003cp\u003ebl4de \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T15:32:25.002Z","updated_at":"2018-01-23T15:32:25.002Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2310183,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@notquiteleo @bl4de I will disclose this myself and PR https://github.com/nodejs/security-wg in approx 30min.","markdown_message":"\u003cp\u003e\u003ca href=\"/notquiteleo\"\u003e@notquiteleo\u003c/a\u003e \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e I will disclose this myself and PR \u003ca title=\"https://github.com/nodejs/security-wg\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fsecurity-wg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodejs/security-wg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in approx 30min.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T15:33:07.533Z","updated_at":"2018-01-23T15:33:07.533Z","first_to_agree":true,"actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2310198,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vdeturckheim Sure, go ahead. You can make it public now!","markdown_message":"\u003cp\u003e\u003ca href=\"/vdeturckheim\"\u003e@vdeturckheim\u003c/a\u003e Sure, go ahead. You can make it public now!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-23T15:36:19.548Z","updated_at":"2018-01-23T15:36:19.548Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2310428,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-23T16:01:07.866Z","updated_at":"2018-01-23T16:01:07.866Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2361158,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-08T04:50:24.495Z","updated_at":"2018-02-08T04:50:24.495Z","additional_data":{"added_weaknesses":[{"id":19,"name":"Path Traversal"}],"removed_weaknesses":[{"id":89,"name":"Information Exposure Through Directory Listing"}]},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}