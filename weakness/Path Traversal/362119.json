{"id":362119,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjIxMTk=","url":"https://hackerone.com/reports/362119","title":"Arbitrary File Write through archive extraction","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-06-05T16:01:18.154Z","submitted_at":"2018-06-05T16:01:18.154Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"danny_grander","url":"/danny_grander","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/124/877/a29f6f33a6483d7f540131bc62e3f60d070fd2bf_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-1002203"],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-12T14:50:55.133Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-08-12T14:50:48.280Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report arbitrary file write vulnerability in adm-zip module\nIt allows attackers to write arbitrary files when a malicious archive is extracted.\nMore info here: \nhttps://snyk.io/research/zip-slip-vulnerability\nhttps://github.com/snyk/zip-slip-vulnerability#affected-libraries\n\n\n# Module\n\n**module name:** unzipper\n**version:** \u003c0.8.13\n**npm page:** `https://www.npmjs.com/package/unzipper`\n\n## Module Description\nThis is a fork of node-unzip which has not been maintained in a while. This fork addresses the following issues:\n* finish/close events are not always triggered, particular when the input stream is slower than the receivers\n* Any files are buffered into memory before passing on to entry\n\n\n## Module Stats\n\n80k downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\nThe vulnerability is a form of directory traversal that can be exploited by extracting files from an archive. The premise of the directory traversal vulnerability is that an attacker can gain access to parts of the file system outside of the target folder in which they should reside. The attacker can then overwrite executable files and either invoke them remotely or wait for the system or user to call them, thus achieving remote command execution on the victim’s machine. The vulnerability can also cause damage by overwriting configuration files or other sensitive resources, and can be exploited on both client (user) machines and servers.\n\nMore info here: \nhttps://snyk.io/research/zip-slip-vulnerability\nhttps://github.com/snyk/zip-slip-vulnerability\n\n\n## Steps To Reproduce:\n\nSample files can be found here: https://github.com/snyk/zip-slip-vulnerability/tree/master/archives\n\n\n## Patch\n\nVulnerability is already fixed in ver 0.8.13\nWe opened a fix PR on 16th of April, https://github.com/ZJONSSON/node-unzipper/pull/59\n\nCVE id for the vuln was assigned: CVE-2018-1002203\n\n## Supporting Material/References:\n\nThere are multiple libraries affected, across different ecosystems. \nFull list here: https://github.com/snyk/zip-slip-vulnerability#affected-libraries\n\nhttps://snyk.io/research/zip-slip-vulnerability\nhttps://github.com/snyk/zip-slip-vulnerability\n\n# Wrap up\n\n- I contacted the maintainer to let them know: Y, and helped fix the issue\n- I opened an issue in the related repository: N\n\n## Impact\n\nArbitrary file write","vulnerability_information_html":"\u003cp\u003eI would like to report arbitrary file write vulnerability in adm-zip module\u003cbr\u003e\nIt allows attackers to write arbitrary files when a malicious archive is extracted.\u003cbr\u003e\nMore info here: \u003cbr\u003e\n\u003ca title=\"https://snyk.io/research/zip-slip-vulnerability\" href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fresearch%2Fzip-slip-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://snyk.io/research/zip-slip-vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/snyk/zip-slip-vulnerability#affected-libraries\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsnyk%2Fzip-slip-vulnerability%23affected-libraries\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/snyk/zip-slip-vulnerability#affected-libraries\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e unzipper\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e \u0026lt;0.8.13\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/unzipper\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003eThis is a fork of node-unzip which has not been maintained in a while. This fork addresses the following issues:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003efinish/close events are not always triggered, particular when the input stream is slower than the receivers\u003c/li\u003e\n\u003cli\u003eAny files are buffered into memory before passing on to entry\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e80k downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eThe vulnerability is a form of directory traversal that can be exploited by extracting files from an archive. The premise of the directory traversal vulnerability is that an attacker can gain access to parts of the file system outside of the target folder in which they should reside. The attacker can then overwrite executable files and either invoke them remotely or wait for the system or user to call them, thus achieving remote command execution on the victim’s machine. The vulnerability can also cause damage by overwriting configuration files or other sensitive resources, and can be exploited on both client (user) machines and servers.\u003c/p\u003e\n\n\u003cp\u003eMore info here: \u003cbr\u003e\n\u003ca title=\"https://snyk.io/research/zip-slip-vulnerability\" href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fresearch%2Fzip-slip-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://snyk.io/research/zip-slip-vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/snyk/zip-slip-vulnerability\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsnyk%2Fzip-slip-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/snyk/zip-slip-vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eSample files can be found here: \u003ca title=\"https://github.com/snyk/zip-slip-vulnerability/tree/master/archives\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsnyk%2Fzip-slip-vulnerability%2Ftree%2Fmaster%2Farchives\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/snyk/zip-slip-vulnerability/tree/master/archives\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eVulnerability is already fixed in ver 0.8.13\u003cbr\u003e\nWe opened a fix PR on 16th of April, \u003ca title=\"https://github.com/ZJONSSON/node-unzipper/pull/59\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FZJONSSON%2Fnode-unzipper%2Fpull%2F59\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/ZJONSSON/node-unzipper/pull/59\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCVE id for the vuln was assigned: CVE-2018-1002203\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eThere are multiple libraries affected, across different ecosystems. \u003cbr\u003e\nFull list here: \u003ca title=\"https://github.com/snyk/zip-slip-vulnerability#affected-libraries\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsnyk%2Fzip-slip-vulnerability%23affected-libraries\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/snyk/zip-slip-vulnerability#affected-libraries\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://snyk.io/research/zip-slip-vulnerability\" href=\"/redirect?url=https%3A%2F%2Fsnyk.io%2Fresearch%2Fzip-slip-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://snyk.io/research/zip-slip-vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/snyk/zip-slip-vulnerability\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsnyk%2Fzip-slip-vulnerability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/snyk/zip-slip-vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: Y, and helped fix the issue\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eArbitrary file write\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-09-11T14:50:48.394Z","allow_singular_disclosure_after":-72543174.31036763,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","an0nym0us","khizer47","sumit7","cryptographer"],"severity":{"rating":"high","score":8.2,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"high","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2976035,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-02T18:59:21.078Z","updated_at":"2018-07-02T18:59:21.078Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2976037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will PR to our DB.\nThanks a lot @danny_grander","markdown_message":"\u003cp\u003eWill PR to our DB.\u003cbr\u003e\nThanks a lot \u003ca href=\"/danny_grander\"\u003e@danny_grander\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-02T18:59:41.382Z","updated_at":"2018-07-02T19:00:04.423Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3182831,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-12T14:50:41.699Z","updated_at":"2018-08-12T14:50:41.699Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"danny_grander","url":"/danny_grander"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3182832,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-12T14:50:48.313Z","updated_at":"2018-08-12T14:50:48.313Z","first_to_agree":true,"actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3182834,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-12T14:50:54.910Z","updated_at":"2018-08-12T14:50:54.910Z","actor":{"username":"vdeturckheim","cleared":false,"url":"/vdeturckheim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/010/6f383ac0f9296c13b5ac0d38741f0685dbace58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}