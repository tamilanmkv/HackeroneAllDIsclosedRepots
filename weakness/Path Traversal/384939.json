{"id":384939,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODQ5Mzk=","url":"https://hackerone.com/reports/384939","title":"http-live-simulator npm module is prone to path traversal attacks","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-21T12:34:12.401Z","submitted_at":"2018-07-21T12:34:12.401Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lirantal","url":"/lirantal","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-5423"],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-18T13:07:19.601Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-09-18T13:07:07.884Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\nI would like to report Path Traversal vulnerability in http-live-simulator\nIt allows to read arbitrary files from any location on disk\n\n# Module\n\n**module name:** http-live-simulator\n**version:** 1.0.5\n**npm page:** `https://www.npmjs.com/package/http-live-simulator`\n\n## Module Description\n\n\u003e Copy description from npm page\n\n## Module Stats\n\n\u003e Replace stats below with numbers from npm’s module page:\n\n[9] weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\n\u003e Description about how the vulnerability was found and how it can be exploited, how it harms package users (data modification/lost, system access, other.\n\nThe http-live-simulator module doesn't set a root directory and allows any arbitrary paths to be accessed on the file system and returned to requesting clients\n\n## Steps To Reproduce:\n\n\u003e Detailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\n\n1. Install the module locally in an npm project: `npm install http-live-simulator`\n2. Run the live server on a specified port: `node_modules/.bin/http-live --port 8181`\n3. Attempt to access a file from outside that project's directory, such as `curl --path-as-is http://localhost:8181/../../file.txt`\n4. Files output should be returned \n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- MacOS\n- Node.js 8.11.3\n- npm 5.6.0\n\n# Wrap up\n\n\u003e Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\npath traversal vulnerability leading to read access in arbitrary files on disk","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI would like to report Path Traversal vulnerability in http-live-simulator\u003cbr\u003e\nIt allows to read arbitrary files from any location on disk\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e http-live-simulator\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 1.0.5\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/http-live-simulator\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCopy description from npm page\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eReplace stats below with numbers from npm’s module page:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e[9] weekly downloads\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDescription about how the vulnerability was found and how it can be exploited, how it harms package users (data modification/lost, system access, other.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe http-live-simulator module doesn\u0026#39;t set a root directory and allows any arbitrary paths to be accessed on the file system and returned to requesting clients\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDetailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003eInstall the module locally in an npm project: \u003ccode\u003enpm install http-live-simulator\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eRun the live server on a specified port: \u003ccode\u003enode_modules/.bin/http-live --port 8181\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eAttempt to access a file from outside that project\u0026#39;s directory, such as \u003ccode\u003ecurl --path-as-is http://localhost:8181/../../file.txt\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eFiles output should be returned \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eMacOS\u003c/li\u003e\n\u003cli\u003eNode.js 8.11.3\u003c/li\u003e\n\u003cli\u003enpm 5.6.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSelect Y or N for the following statements:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003epath traversal vulnerability leading to read access in arbitrary files on disk\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-18T13:07:08.215Z","allow_singular_disclosure_after":-69352840.84450915,"singular_disclosure_allowed":true,"vote_count":5,"voters":["bl4de","eveeez","apapedulimu","cryptographer","jatacheers"],"severity":{"rating":"high","score":8.6,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":14637,"asset_type":"SOURCE_CODE","asset_identifier":"http-live-simulator","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3078000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-07-21T12:34:18.329Z","updated_at":"2018-07-21T12:34:18.329Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3095489,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lirantal \n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability. I will reach out to the package maintainer to join.\n","markdown_message":"\u003cp\u003eHi @lirantal \u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability. I will reach out to the package maintainer to join.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T07:45:17.248Z","updated_at":"2018-07-25T07:45:17.248Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3095490,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-25T07:45:26.525Z","updated_at":"2018-07-25T07:45:26.525Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3095506,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-25T08:01:29.282Z","updated_at":"2018-07-25T08:01:29.282Z","actor":{"username":"prahladyeri","cleared":false,"url":"/prahladyeri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3095535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@marcinhoppe As discussed, if you can send me a CR on github, I can merge it and release the updated version on npm. Please let me know how to proceed.","markdown_message":"\u003cp\u003e\u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e As discussed, if you can send me a CR on github, I can merge it and release the updated version on npm. Please let me know how to proceed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T08:11:19.189Z","updated_at":"2018-07-25T08:11:19.189Z","actor":{"username":"prahladyeri","cleared":false,"url":"/prahladyeri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3095542,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@prahladyeri We usually ask maintainers to fix those vulnerabilities and the Security WG coordinates the responsible disclosure once the fix is available on NPM. Will you be able to provide a fix?","markdown_message":"\u003cp\u003e\u003ca href=\"/prahladyeri\"\u003e@prahladyeri\u003c/a\u003e We usually ask maintainers to fix those vulnerabilities and the Security WG coordinates the responsible disclosure once the fix is available on NPM. Will you be able to provide a fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T08:13:45.814Z","updated_at":"2018-07-25T08:13:45.814Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3095546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, I can do that. I'll update here once its done so that you can test and confirm.","markdown_message":"\u003cp\u003eYep, I can do that. I\u0026#39;ll update here once its done so that you can test and confirm.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T08:16:57.795Z","updated_at":"2018-07-25T08:16:57.795Z","actor":{"username":"prahladyeri","cleared":false,"url":"/prahladyeri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3097006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I've just published the latest version 1.0.6 that takes care of this. I've fixed this by replacing any reference to back folders by a \"\" (blank), so it returns 404 error in your case:\n\n`pathname = pathname.replace(\"/../\",\"\"); //fix for path traversal bug`\n\n[github link to commit #8e85a1be562248d0d616c0e5092a3d71bbf5fe5f](https://github.com/prahladyeri/http-live-simulator/commit/8e85a1be562248d0d616c0e5092a3d71bbf5fe5f)\n\nPlease test and let me know. Thanks again for your contribution to http-live-simulator.","markdown_message":"\u003cp\u003eHi, I\u0026#39;ve just published the latest version 1.0.6 that takes care of this. I\u0026#39;ve fixed this by replacing any reference to back folders by a \u0026quot;\u0026quot; (blank), so it returns 404 error in your case:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003epathname = pathname.replace(\u0026quot;/../\u0026quot;,\u0026quot;\u0026quot;); //fix for path traversal bug\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fprahladyeri%2Fhttp-live-simulator%2Fcommit%2F8e85a1be562248d0d616c0e5092a3d71bbf5fe5f\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egithub link to commit #8e85a1be562248d0d616c0e5092a3d71bbf5fe5f\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease test and let me know. Thanks again for your contribution to http-live-simulator.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-25T14:32:42.380Z","updated_at":"2018-07-25T14:32:42.380Z","actor":{"username":"prahladyeri","cleared":false,"url":"/prahladyeri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3099880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@prahladyeri Thanks, I can no longer reproduce the issue.\n\n@lirantal Can you verify the fix so that we could proceed with disclosure?","markdown_message":"\u003cp\u003e\u003ca href=\"/prahladyeri\"\u003e@prahladyeri\u003c/a\u003e Thanks, I can no longer reproduce the issue.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e Can you verify the fix so that we could proceed with disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-26T07:16:44.810Z","updated_at":"2018-07-26T07:16:44.810Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3104324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirming that I can't reproduce anymore.","markdown_message":"\u003cp\u003eConfirming that I can\u0026#39;t reproduce anymore.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-27T07:15:38.863Z","updated_at":"2018-07-27T07:15:38.863Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3353412,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-18T13:06:58.362Z","updated_at":"2018-09-18T13:06:58.362Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lirantal","url":"/lirantal"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3353414,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-18T13:07:08.008Z","updated_at":"2018-09-18T13:07:08.008Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3353415,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-18T13:07:19.502Z","updated_at":"2018-09-18T13:07:19.502Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3357604,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T09:28:27.783Z","updated_at":"2018-09-19T09:28:27.783Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"http-live-simulator","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}