{"id":510043,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTAwNDM=","url":"https://hackerone.com/reports/510043","title":"[serve] Path Traversal","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-15T09:29:19.523Z","submitted_at":"2019-03-15T09:29:19.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"johnssimon007","url":"/johnssimon007","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39174,"url":"https://hackerone.com/vercel","handle":"vercel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vercel","twitter_handle":"vercel","website":"https://vercel.com","about":"Creators of Next.js - Vercel is the platform for developing, previewing, and shipping Jamstack sites."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-03T16:55:25.281Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-03T16:55:23.973Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report path traversal vulnerability in serve module\nIt allows an attacker to read system files via path traversal vulnerability\n\n# Module\n\n**module name:** serve\n**version:** 10.1.2\n**npm page:** `https://www.npmjs.com/package/serve`\n\n## Module Description\nAssuming you would like to serve a static site, single page application or just a static file (no matter if on your device or on the local network), this package is just the right choice for you.\n\nIt behaves exactly like static deployments on Now, so it's perfect for developing your static project. Then, when it's time to push it into production, you deploy it.\n\nFurthermore, it provides a neat interface for listing the directory's contents:\n\n\n# Vulnerability\n\n## Vulnerability Description\n\nwith a symlink file on the working dir ,it was possible to fetch files outside of the web root dir\n\n## Steps To Reproduce:\n1.make a directory\n$mkdir test\n\n2.got test dir\n$cd test\n\n3.create a symlink file\n$ln -s ../../ symdir\n\n4.now install serve module:\n$yarn global add serve\n\n5.run serve module\n$serve\n\n## Patch\n\n\u003e If you're able to provide a patch with the fix please post it in this section\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- [OPERATING SYSTEM VERSION] kali linux\n- [NODEJS VERSION] 11.8.0\n- [NPM VERSION] 6.5.0\n\n# Wrap up\n\n\u003e Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\u003e Hunter's comments and funny memes goes here\n\n## Impact\n\nThis could have enabled an attacker to view system files and leverage attacks like remote code execution and so on","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":441823,"file_name":"Screenshot_from_2019-03-15_15-02-00.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/441/823/0bd7336ac8376065e970b92c90eb9725145bafdf/Screenshot_from_2019-03-15_15-02-00.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-03-15_15-02-00.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-03-15_15-02-00.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSWVBQGJF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150808Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIDKFbNpVUzrOPbUQYjhN4DgAxVU5%2FXEKmVfjCMWb%2BNkIAiABDuahSBdMUCytEahxX048K6jzH7PGdOzEr8bjHNv10CqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMFF93LkCZvrkmcBNoKtcDT4JSiF4LJ9dMlVWVXz6ozMkun%2BZIV%2FnNB6qVpNI4VDOdAc06QNZffMvjZwfupMjaAHpuIYcvqlkda6prO9SWrglyS6NCrBHv2gaT40jgHA6ufjwtH7OxGYsx039h%2Bh8lmcb39NUtDqetz1GDVn0P%2BUNi77DW4gUN5GnzWQsten34H99dGqb8t6pYxCQN%2F8DKWHJ%2BalzRH5DiTjmpYvgNaPu2xwo%2F6Zr8S4tdff1lzr%2BcSt%2FZceeJJnqd2Z9QEAJO7SqjLAnxMOiEuHPHYVOEZ3kfA%2B%2Bbt34tKfFC8MGX%2BXh1zYwal1wOrSP2k%2FZSlC9lsLebNN7Iooim1lSpjw7Du5GV89O7g%2F7rGROCUF%2B%2BB24LrVSbZTIggbHns1VxsRvSvZGmJHi7XvmhECvDwu9WmRNJs7XWIMzDD0fOHc22lsbafqmlkdZqwRzJhStehJfZCskFpe6v4wdnRFJqrnSW1n3s9Cn28vHMBxxweBr72n7tIeDBX4PMTrrfy%2B5OhLDCrxYOtKZndzmZHfMzTm0b0uMHvqjv6rofYcR42du%2BPYJ87HhllMZGstEyOaYDwXJ6mUAWqgFU1cRtr5KgJU%2BjBFYZrWtE%2BoZkvuXgEXg40jlw%2BeRQEreWMOGKkYsGOqYBYdUdmtOC7YWorffY3XWIt13STuNB47ZWJ85D8q%2F8hMPTVw3x9BFRZcvFy7ieSMolt4GYUK%2F8moEzkTt%2FanjYuLBUJFMJFunxOEvaMPJA128lGEkS1qX60D7%2BiOofrwvOesADqaqm%2FmYvf6HgURng7sqkiLxzy3mjSpM33Soz6mVH2tmMNYspiP4BF%2BNbXdXLCjYBsB98ENZjOy3b4d4U9P8NkvkUag%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2359bd685bcd6aff4c3289d0dc939ba1e69eb261d2c83cb0ca7396eb000fbc66","file_size":158483,"type":"image/png"}],"allow_singular_disclosure_at":"2019-05-03T16:55:24.072Z","allow_singular_disclosure_after":-77062363.97121423,"singular_disclosure_allowed":true,"vote_count":5,"voters":["bb00x","cryptographer","casualkeystroker","cyberonin","pr49"],"severity":{"rating":"critical","score":9.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4328968,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","automated_response":true,"created_at":"2019-03-15T09:29:25.731Z","updated_at":"2019-03-15T09:29:25.731Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4426764,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as a vulnerability.\n\nI will invite the package maintainer to this issue.\n","automated_response":false,"created_at":"2019-03-31T02:04:37.533Z","updated_at":"2019-03-31T02:04:37.533Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4433301,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","automated_response":false,"created_at":"2019-04-01T13:30:56.568Z","updated_at":"2019-04-01T13:30:56.568Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4456558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nThank you for reporting this issue.\n\nSymlinks are now disabled by default as of version `11.0.0` of `serve`. They can be enabled using the newly added `--symlinks` flag.","automated_response":false,"created_at":"2019-04-03T10:15:38.125Z","updated_at":"2019-04-03T10:15:38.125Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4458149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we move this report to https://hackerone.com/zeit?","automated_response":false,"created_at":"2019-04-03T12:48:15.425Z","updated_at":"2019-04-03T12:48:15.425Z","actor":{"username":"notquiteleo","cleared":false,"url":"/notquiteleo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/441/a2d834813f466cd073def4b1f346275259f6522f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459394,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@notquiteleo I'm not able to access anything at that link, is that private bug bounty group?","automated_response":false,"created_at":"2019-04-03T16:47:03.274Z","updated_at":"2019-04-03T16:47:03.274Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459427,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2019-04-03T16:55:14.764Z","updated_at":"2019-04-03T16:55:14.764Z","actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"johnssimon007","url":"/johnssimon007"},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4459430,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-03T16:55:23.994Z","updated_at":"2019-04-03T16:55:23.994Z","first_to_agree":true,"actor":{"username":"ronperris","cleared":false,"url":"/ronperris","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/267/443/1a8173396b482236436c5172363ceb9f64ef27dd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4460305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We can disclose this report","automated_response":false,"created_at":"2019-04-03T18:36:12.015Z","updated_at":"2019-04-03T18:36:12.015Z","actor":{"username":"johnssimon007","cleared":false,"url":"/johnssimon007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NWPHHm8hwLotSetPuMmFkHCa/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4732872,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-03T16:55:25.323Z","updated_at":"2019-05-03T16:55:25.323Z","actor":{"url":"/vercel","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/174/6accbc4b10e3d000c0acf7de494fe725066475f4_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vercel"}},"genius_execution_id":null,"team_handle":"vercel","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}