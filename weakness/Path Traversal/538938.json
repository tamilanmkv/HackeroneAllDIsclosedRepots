{"id":538938,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81Mzg5Mzg=","url":"https://hackerone.com/reports/538938","title":"[domokeeper] Unintended Require","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-04-16T01:03:04.098Z","submitted_at":"2019-04-16T01:03:04.098Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ermilov","url":"/ermilov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/066/860/675cf13b580684485fa62b5e472d044d85cbccca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-04T09:37:27.121Z","bug_reporter_agreed_on_going_public_at":"2019-07-04T09:37:26.993Z","team_member_agreed_on_going_public_at":"2019-07-04T09:25:59.751Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report Unintended Require vulnerability in `domokeeper`\nIt allows reading arbitary json files and load non-production code.\n\n# Module\n\n**module name:** domokeeper\n**version:** 0.2.0\n**npm page:** `https://www.npmjs.com/package/domokeeper`\n\n## Module Description\n\ndomokeeper server: a pluggable domotic control server for Raspberry Pi 2/3\n\n## Module Stats\n\n[24] downloads in the last day\n[45] downloads in the last week\n[72] downloads in the last month\n\n# Vulnerability\n\n## Vulnerability Description\n\n`domokeeper` is an express server which dynamically loads (with help of `require()`) some parts of the code. As long as the path to required module is passed in a HTTP request without any sanitization, anybody can cause code to load that was not intended to run on the server.\n\nsource code example:\n\nindex.js\nline 83\n```\napp.get('/plugins/:id', function (req, res) {\n  var plugin = require(req.params.id);\n  res.json(plugin);\n})\n```\n\nIn addition, the fact that output of the module is passed to server response directly (in the example above) leads to an information leakage. For example it is possible to read `package.json` file or any other json file.\n\nDetailed description of this bug can be found here: https://nodesecroadmap.fyi/chapter-1/threat-UIR.html\n\n## Steps To Reproduce:\n\n* install `domokeeper`\n\n```\nnpm i domokeeper\n```\n\n* run it\n\n```\nnode node_modules/domokeeper/bin.js\n```\n\n* by default it starts at `localhost:43569`, so by navigating to `http://localhost:43569/plugins/.%2Fpackage.json` in the browser you are able to read the output of `package.json` file\n\n## Patch\n\n## Supporting Material/References:\n\n\u003e State all technical information about the stack where the vulnerability was found\n\n- OS: Linux Mint current\n- Node.js: 8.15.0\n- NPM:6.4.0\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nAn attacker is able to control the x in require(x) and cause code to load that was not intended to run on the server or read json files.","vulnerability_information_html":"\u003cp\u003eI would like to report Unintended Require vulnerability in \u003ccode\u003edomokeeper\u003c/code\u003e\u003cbr\u003e\nIt allows reading arbitary json files and load non-production code.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e domokeeper\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.2.0\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/domokeeper\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003edomokeeper server: a pluggable domotic control server for Raspberry Pi 2/3\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e[24] downloads in the last day\u003cbr\u003e\n[45] downloads in the last week\u003cbr\u003e\n[72] downloads in the last month\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003edomokeeper\u003c/code\u003e is an express server which dynamically loads (with help of \u003ccode\u003erequire()\u003c/code\u003e) some parts of the code. As long as the path to required module is passed in a HTTP request without any sanitization, anybody can cause code to load that was not intended to run on the server.\u003c/p\u003e\n\n\u003cp\u003esource code example:\u003c/p\u003e\n\n\u003cp\u003eindex.js\u003cbr\u003e\nline 83\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eapp.get(\u0026#39;/plugins/:id\u0026#39;, function (req, res) {\n  var plugin = require(req.params.id);\n  res.json(plugin);\n})\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn addition, the fact that output of the module is passed to server response directly (in the example above) leads to an information leakage. For example it is possible to read \u003ccode\u003epackage.json\u003c/code\u003e file or any other json file.\u003c/p\u003e\n\n\u003cp\u003eDetailed description of this bug can be found here: \u003ca title=\"https://nodesecroadmap.fyi/chapter-1/threat-UIR.html\" href=\"/redirect?url=https%3A%2F%2Fnodesecroadmap.fyi%2Fchapter-1%2Fthreat-UIR.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodesecroadmap.fyi/chapter-1/threat-UIR.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003einstall \u003ccode\u003edomokeeper\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enpm i domokeeper\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003erun it\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enode node_modules/domokeeper/bin.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eby default it starts at \u003ccode\u003elocalhost:43569\u003c/code\u003e, so by navigating to \u003ccode\u003ehttp://localhost:43569/plugins/.%2Fpackage.json\u003c/code\u003e in the browser you are able to read the output of \u003ccode\u003epackage.json\u003c/code\u003e file\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eState all technical information about the stack where the vulnerability was found\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cul\u003e\n\u003cli\u003eOS: Linux Mint current\u003c/li\u003e\n\u003cli\u003eNode.js: 8.15.0\u003c/li\u003e\n\u003cli\u003eNPM:6.4.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: N\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker is able to control the x in require(x) and cause code to load that was not intended to run on the server or read json files.\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-03T09:25:59.900Z","allow_singular_disclosure_after":-44398219.034202635,"singular_disclosure_allowed":true,"vote_count":6,"voters":["ermilov","bl4de","mygf","nervx","armansameer","blackageek"],"severity":{"rating":"medium","score":5.9,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":2986,"asset_type":"SOURCE_CODE","asset_identifier":"Other module","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4568444,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nThanks for reporting this to us. Someone will quickly look at this report and triage it.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nThanks for reporting this to us. Someone will quickly look at this report and triage it.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-04-16T01:03:09.749Z","updated_at":"2019-04-16T01:03:09.749Z","actor":{"username":"vdeturckheim_dev","cleared":false,"url":"/vdeturckheim_dev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4807077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @inkz,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/inkz\"\u003e@inkz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-10T09:45:35.554Z","updated_at":"2019-05-10T09:45:35.554Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4807377,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-10T10:11:33.804Z","updated_at":"2019-05-10T10:11:33.804Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.9)","old_severity_id":347555,"new_severity_id":386962},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4807384,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-10T10:13:31.296Z","updated_at":"2019-05-10T10:13:31.296Z","additional_data":{"added_weaknesses":[{"id":19,"name":"Path Traversal"}],"removed_weaknesses":[{"id":71,"name":"Remote File Inclusion"}]},"actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4807409,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nKind regards,\n@beagle  ","markdown_message":"\u003cp\u003eI was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-10T10:25:05.794Z","updated_at":"2019-05-10T10:25:05.794Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5252322,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T09:25:48.302Z","updated_at":"2019-07-04T09:25:48.302Z","actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ermilov","url":"/ermilov"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5252324,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T09:25:59.784Z","updated_at":"2019-07-04T09:25:59.784Z","first_to_agree":true,"actor":{"username":"marcinhoppe","cleared":false,"url":"/marcinhoppe","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5252579,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T09:37:27.024Z","updated_at":"2019-07-04T09:37:27.024Z","actor":{"username":"ermilov","cleared":false,"url":"/ermilov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/066/860/675cf13b580684485fa62b5e472d044d85cbccca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5252580,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T09:37:27.143Z","updated_at":"2019-07-04T09:37:27.143Z","actor":{"username":"ermilov","cleared":false,"url":"/ermilov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/066/860/675cf13b580684485fa62b5e472d044d85cbccca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5273745,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-08T10:45:23.986Z","updated_at":"2019-07-08T10:45:23.986Z","actor":{"username":"jperelli","cleared":false,"url":"/jperelli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/666/583/376c1014f721abc868cc45ab84855d474ff1bb40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5273758,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi I'm the author. Thanks @marcinhoppe for inviting me here.\nI'll try to fix the issue and let you all know when it's ready by commenting here.","markdown_message":"\u003cp\u003eHi I\u0026#39;m the author. Thanks \u003ca href=\"/marcinhoppe\"\u003e@marcinhoppe\u003c/a\u003e for inviting me here.\u003cbr\u003e\nI\u0026#39;ll try to fix the issue and let you all know when it\u0026#39;s ready by commenting here.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-08T10:48:00.524Z","updated_at":"2019-07-08T10:48:00.524Z","actor":{"username":"jperelli","cleared":false,"url":"/jperelli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/666/583/376c1014f721abc868cc45ab84855d474ff1bb40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}