{"id":282748,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODI3NDg=","url":"https://hackerone.com/reports/282748","title":"Detecting Tor Browser UI Language","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-10-25T08:11:59.728Z","submitted_at":"2017-10-25T08:11:59.728Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xiaoyinl","url":"/xiaoyinl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-05-21T08:48:31.664Z","bug_reporter_agreed_on_going_public_at":"2019-05-21T08:48:31.597Z","team_member_agreed_on_going_public_at":"2019-05-21T07:38:22.424Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Suppose that a user downloads a non-English version of Tor Browser from https://www.torproject.org/projects/torbrowser.html.en, there is a way to detect which UI language the user is using. I don't think you want websites to detect this info, because at the first time I launched non-English Tor Browser, there's a warning dialog asking if I want to send my UI language to websites in the \"Accept-Language\" header, which may violate my privacy. **This trick works even if I choose \"Don't send my language\" in that warning dialog**.\n\nSteps to reproduce:\n1. Download and install 简体字 (zh-CN) version (i.e. Simplified Chinese) of Tor Browser from https://www.torproject.org/projects/torbrowser.html.en.\n2. In the Chinese Tor Browser, navigate to https://xiaoyinl.github.io/juyt75/ttude.html. The page should be able to tell you \"Your browser UI language is: Simplified Chinese\".\n3. Launch an English Tor Browser, and navigate to https://xiaoyinl.github.io/juyt75/ttude.html. The page should be able to tell you \"Your browser UI language is: English\".\n\nThe trick is that when I specify a button \u003cinput type=\"submit\"\u003e without a \"value\" property, the default text of the button depends on the UI language. If the UI language is Chinese, its text is 提交查询; if the UI language is English, its text is \"Submit Query\". Thus, these two buttons will have different width. If its width equals the width of \u003cinput type=\"submit\" value=\"Submit Query\"\u003e, the UI language is English. If its width equals the width of \u003cinput type=\"submit\" value=\"提交查询\"\u003e, the UI language is Simplified Chinese.\n\nTo fix this, always use the button with default text in English.","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":46,"name":"Privacy Violation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":232599,"file_name":"screenshot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/232/599/96271073f30294009a2a71e4547bfe0d6c6168dd/screenshot.png?response-content-disposition=attachment%3B%20filename%3D%22screenshot.png%22%3B%20filename%2A%3DUTF-8%27%27screenshot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143745Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b040d6e4b31dbe920cd2a869e6e743b39080be472cd8d89439e983e108b268a","file_size":13338,"type":"image/png"},{"id":232600,"file_name":"PoC.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/232/600/69453f6e49c4705ebd7f26d15539d461b7ac5e65/PoC.html?response-content-disposition=attachment%3B%20filename%3D%22PoC.html%22%3B%20filename%2A%3DUTF-8%27%27PoC.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143745Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=506b84d8358332e325b88da8dcde00038fffa5364a832a37d94d632d95486c7a","file_size":1693,"type":"text/html"}],"allow_singular_disclosure_at":"2019-06-20T07:38:22.510Z","allow_singular_disclosure_after":-72946762.91918929,"singular_disclosure_allowed":true,"vote_count":64,"voters":["rootz491","nrockhouse","vavkamil","foobar7","sameerphad72","mik317","catferq","samet","xiaoyinl","an0nym0us","and 54 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2109766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, sorry for my impatience, but is there any update on this one? Thank you!","automated_response":false,"created_at":"2017-10-28T03:03:07.573Z","updated_at":"2017-10-28T03:03:16.465Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2110475,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, there is. I've been swamped with high priority work in the last couple of days but I'll plan to take a closer look at your report on Monday. So far it looks like a valid bug report, thanks.","automated_response":false,"created_at":"2017-10-28T18:30:11.422Z","updated_at":"2017-10-28T18:30:11.422Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2112563,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Okay, I opened https://trac.torproject.org/projects/tor/ticket/24056, thanks.","automated_response":false,"created_at":"2017-10-30T11:17:33.978Z","updated_at":"2017-10-30T11:17:33.978Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"xiaoyinl","url":"/xiaoyinl"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2112566,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-30T11:19:23.127Z","updated_at":"2017-10-30T11:19:23.127Z","actor":{"url":"/torproject","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Tor"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"torproject","collaborator":{"username":"xiaoyinl","url":"/xiaoyinl"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2112567,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-10-30T11:20:06.511Z","updated_at":"2017-10-30T11:20:06.511Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":88307,"new_severity_id":89533},"actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2115725,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the bounty!","automated_response":false,"created_at":"2017-10-30T23:08:19.077Z","updated_at":"2017-10-30T23:08:19.077Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4890360,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-05-21T07:38:22.446Z","updated_at":"2019-05-21T07:38:22.446Z","first_to_agree":true,"actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4891118,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-05-21T08:48:31.618Z","updated_at":"2019-05-21T08:48:31.618Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4891119,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-05-21T08:48:31.682Z","updated_at":"2019-05-21T08:48:31.682Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4901406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @geko, would you mind if I request a CVE ID for this bug via MITRE?","automated_response":false,"created_at":"2019-05-22T11:43:42.070Z","updated_at":"2019-05-22T11:43:42.070Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4910865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fine with me. Not sure if MITRE would give a CVE ID for that issue, though.","automated_response":false,"created_at":"2019-05-23T15:05:03.679Z","updated_at":"2019-05-23T15:05:03.679Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4941364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"MITRE assigned [CVE-2019-12383](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12383) to this issue.","automated_response":false,"created_at":"2019-05-28T14:45:18.866Z","updated_at":"2019-05-28T14:45:18.866Z","actor":{"username":"xiaoyinl","cleared":true,"url":"/xiaoyinl","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/322/771e7ba50572621c57e02f8eed8f23fc362c4e52_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}