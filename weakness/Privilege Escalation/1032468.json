{"id":1032468,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDMyNDY4","url":"https://hackerone.com/reports/1032468","title":"Read-only application can publish/delete fleets","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-12T12:32:59.699Z","submitted_at":"2020-11-12T12:32:59.749Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ryotak","url":"/ryotak","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-01-04T17:05:39.356Z","bug_reporter_agreed_on_going_public_at":"2020-12-18T06:54:51.354Z","team_member_agreed_on_going_public_at":"2021-01-04T17:05:39.259Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nTwitter released [Fleet](https://blog.twitter.com/ja_jp/topics/product/2020/ntroducing-fleets-new-way-to-join-the-conversation-jp.html) yesterday. This feature is working with few APIs, and these APIs are missing permission checks.\n\n## Description:\nIn `/fleets/v1/create` of `https://api.twitter.com`, there is no check to whether if the application has permission to write to the account. `/fleets/v1/delete` has also this issue.\n\n\n## Steps To Reproduce:\n\n  1. Install [twurl](https://github.com/twitter/twurl).\n  1. Authenticate as a read-only application.\n  1. Execute following command: `twurl /fleets/v1/create -X POST --header 'Content-Type: application/json' -d '{\"text\":\"Hey yo\"}'`\n  1. A fleet with `Hey yo` text will be created.\n\n## Supporting Material/References:\n{F1075380}\n\n## Impact\n\nThe read-only application can publish fleets without getting Write permission. This issue has a similar impact to #434763","bounty_amount":"7700.0","formatted_bounty":"$7,700","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1075380,"file_name":"2020-11-12_21-28-47.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7g8GjuEbSqNMGdNhirX9ux3y?response-content-disposition=attachment%3B%20filename%3D%222020-11-12_21-28-47.mp4%22%3B%20filename%2A%3DUTF-8%27%272020-11-12_21-28-47.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131803Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d04069acee4f7be4543b74b260e063ab1ed5176ec705312613e7239716a71a33","file_size":3100117,"type":"video/mp4"}],"allow_singular_disclosure_at":"2021-01-17T06:54:51.437Z","allow_singular_disclosure_after":-23091792.449507877,"singular_disclosure_allowed":true,"vote_count":387,"voters":["blackhat201319","yssk","th3hidd3nmist","rivalsec","birdbird314","pyrrhon","sw33tlie","tolga","dee-see","akichia","and 377 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":1062,"asset_type":"URL","asset_identifier":"*.twitter.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9808139,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report @ryotak,\n\nWe are investigating the behavior you described and will get back to you when we have more information.\n\nThank you for thinking of Twitter security","automated_response":false,"created_at":"2020-11-13T00:32:11.981Z","updated_at":"2020-11-13T00:32:11.981Z","actor":{"username":"bugtriage-sophia","cleared":false,"url":"/bugtriage-sophia","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9820343,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2020-11-14T00:13:11.634Z","updated_at":"2020-11-14T00:13:11.634Z","actor":{"username":"agoldman","cleared":false,"url":"/agoldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9850279,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\nWe are still waiting on payouts panel.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2020-11-18T00:15:19.457Z","updated_at":"2020-11-18T00:15:19.457Z","actor":{"username":"agoldman","cleared":false,"url":"/agoldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ryotak","url":"/ryotak"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9850306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @agoldman\nThank you for the update!\n\nYes, it has been fixed by returning 401 when 3rd party application called Fleet related APIs.\nIt was faster than I expected. Thanks :)\n{F1083924}\n\n(I'd like to know how long does payout takes as I have a resolved report that hasn't been rewarded for 2 months.)\n\nRegards,\nRyotaK","automated_response":false,"created_at":"2020-11-18T00:21:27.977Z","updated_at":"2020-11-18T00:21:27.977Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1083924,"filename":"twitter-401.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ADBqS2znEqY1sCgj5xRp9LE7?response-content-disposition=attachment%3B%20filename%3D%22twitter-401.png%22%3B%20filename%2A%3DUTF-8%27%27twitter-401.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131803Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=27b2062e9bcaac51d552691f6d259be1e1263b1e0d003e9814688d46baebe11a"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9883253,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Normally we have payouts panel to calibrate rewards weekly but thanksgiving will likely delay.","automated_response":false,"created_at":"2020-11-20T22:14:21.641Z","updated_at":"2020-11-20T22:14:21.641Z","actor":{"username":"agoldman","cleared":false,"url":"/agoldman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9884303,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @agoldman\nThank you for your response!\n\nI understood how the panel works, but is it normal for resolved reports to remain unpaid for two months?\nI think something went wrong in the panel, should I mention report ID here?\n\nRegards,\nRyotaK","automated_response":false,"created_at":"2020-11-21T04:44:23.629Z","updated_at":"2020-11-21T04:44:57.046Z","actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10099396,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","automated_response":false,"created_at":"2020-12-14T16:46:11.083Z","updated_at":"2020-12-14T16:46:11.083Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"7700.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"ryotak","url":"/ryotak"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10140057,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello Twitter team,\nThank you for the bounty!\n\nAs I want to publish this report, can you disclosure it, please?\n\nRegards,\nRyotaK","automated_response":false,"created_at":"2020-12-18T06:54:51.374Z","updated_at":"2020-12-18T06:54:51.374Z","first_to_agree":true,"actor":{"username":"ryotak","cleared":false,"url":"/ryotak","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1120781,"filename":"fleet_from_api.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zx0hy7m7v0n8tcidqlkmxuaqa72o?response-content-disposition=attachment%3B%20filename%3D%22fleet_from_api.png%22%3B%20filename%2A%3DUTF-8%27%27fleet_from_api.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131804Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4300eb15df24998ab8041b01efec2bf50d9e7bb450439cab473edf92b98fb9d0"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10265477,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-01-04T17:05:39.286Z","updated_at":"2021-01-04T17:05:39.286Z","actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10265478,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-01-04T17:05:39.385Z","updated_at":"2021-01-04T17:05:39.385Z","actor":{"username":"petrilli","cleared":false,"url":"/petrilli","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/270/e17bf41da2f7dc28ecbf5c996c5a98efd95bd67c_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":25902,"category":"researcher","content":"If you want to read my write-up in Japanese, you can visit [my blog](https://blog.ryotak.me/post/twitter-privesc).\n\n## TL;DR\nI found a flaw that allows a read-only application to publish/delete fleets while creating [an unofficial API document](https://gist.github.com/Ry0taK/005b79eccb4297469a09696dae9fa3c6) for the Fleet API.\n\n### New feature - Fleet\nTwitter [released](https://blog.twitter.com/ja_jp/topics/product/2020/ntroducing-fleets-new-way-to-join-the-conversation-jp.html) a feature named `Fleet` in Japan on November 10th.\nA day later, I got an update for my Twitter for Android.\nSince I was bored and trying to find something to do, I decided to reverse engineer it.\n\n### Try to analyze\nTwitter for Android is written in Java like a normal Android app, and although it is obfuscated, it is not so difficult to analyze.\nTherefore, I decompiled it using [`apktool`] (https://ibotpeaches.github.io/Apktool/),[`dex2jar`] (https://github.com/pxb1988/dex2jar), and [`CFR`] (https://www.benf.org/other/cfr/) to make it somewhat readable state. (I won't go into the details of decompiling here, but if you google it, many resources will come out, so please refer to that.)\nWe can't analyze the API without knowing the endpoint name, so I used `grep` to find the` .java` file that contains the string `fleet`, then I found a file that contains `/fleets/v1/user_fleets`.\nWhen I examined the files in the same directory, I found other strings that seemed to be other endpoints, so I analyzed them and wrote the documentation in Gist.\n\n### During verification...\nAfter that, while checking the contents of Gist, I found that hitting the fleet-related API while authenticating as a third-party application worked fine.\nI thought \"Isn't this good news for the creators of unofficial Twitter clients?\", so I wrote [more detailed API documentation](https://gist.github.com/Ry0taK/005b79eccb4297469a09696dae9fa3c6).\nBefore publishing, I was verifying that the contents of this Gist are correct, but when I sent a request to `POST /fleets/v1/create` as an application with only read permission, a fleet was created.\n{F1120781}\n\n### Is this a vulnerability?\nAt first, I thought that I had accidentally given write permission to my application, so I checked the permission, but apparently, only read permission was given.\nAt this point, I started thinking \"is this a vulnerability?\", but I couldn't confirm it, so I decided to investigate a little deeper.\nAs a result, in the normal Twitter API (`POST /1.1/statuses/update.json`, etc.), the permission of the application was checked before the API processing started (it is natural), but apparently, the fleet-related endpoint wasn't. It turns out that these APIs do not perform permission checks.\n\n```json\n{\n     \"request\": \"\\/1.1\\/statuses\\/update.json\",\n     \"error\": \"Read-only application cannot POST.\"\n}\n```\n\n### Let's report it!\nSince it turned out to be a vulnerability, I decided to postpone the release of the fleet-related API document and reported it to Twitter.\nThe report was made on November 12th, and it was fixed on November 18th (I think it was actually a few days before the 18th), which was a very impressive remediation speed.\nUnfortunately, the fact that the fleet-related API could be used by a third-party application itself was a problem, and it was fixed by changing the fleet-related API so that it would not be hit by a third-party application anymore :(\n\n### After the report\nThree days after Twitter fixed the vulnerability, there was a person who analyzed the fleet's API and [tweeted](https://twitter.com/donk_enby/status/1330078983350837248) that the fleet's image was not deleted from the CDN even after 24 hours. As it  looks like the period that could be used to implement the fleet function was very short, I felt sorry for the developer inside Twitter.\n\n### Conclusion\nThis report shows the importance of constantly checking for new features and that even the large companies create vulnerabilities.\nIf you have any questions, send a message to [@ryotkak](https://twitter.com/ryotkak) on Twitter.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":569456,"username":"ryotak","name":"RyotaK","bio":"","cleared":false,"website":"https://blog.ryotak.me","location":"","created_at":"2019-04-04T07:16:31.098Z","url":"https://hackerone.com/ryotak","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}