{"id":1294492,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjk0NDky","url":"https://hackerone.com/reports/1294492","title":"DNS Miconfiguration Leads to Subdomain Takeover  - max1.liveplan.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2021-08-07T11:45:21.778Z","submitted_at":"2021-08-07T11:45:21.845Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"melbadry9","url":"/melbadry9","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/347/379/509314872bfbaa1a79051729c1826de2ccc8677f_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42327,"url":"https://hackerone.com/palo_alto_software","handle":"palo_alto_software","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/327/6b83191758494b9c630b6ba94f088d0c78829602_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/327/6b83191758494b9c630b6ba94f088d0c78829602_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Palo Alto Software","twitter_handle":"","website":"https://paloalto.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2021-09-08T16:45:30.915Z","bug_reporter_agreed_on_going_public_at":"2021-08-09T16:45:18.172Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nThe issue happens due to using EC2 public DNS instead of using Elastic IPs as `CNAME` record. This report is simliar to report #1069795\n \n## Misconfiguration\n\n- DNS Records\n\n```json\n{\n  \"host\": \"max1.liveplan.com\",\n  \"resolver\": [\n    \"1.0.0.1:53\"\n  ],\n  \"a\": [\n    \"54.68.121.128\"\n  ],\n  \"cname\": [\n    \"ec2-54-68-121-128.us-west-2.compute.amazonaws.com\"\n  ],\n  \"status_code\": \"NOERROR\",\n  \"timestamp\": \"2021-08-07T13:41:48.3522806+02:00\"     \n}\n```\n\n- If the EC2 instance is killed or terminated and the DNS was not updated this will lead to creating a dangling DNS record for the subdomain.\n- The EC2 IP will be released to AWS IPs pool, This mean it's possible to assign the IP to new EC2 instance.\n\n## PoC\n\n- SSL Certificate Data pulled from `https://max1.liveplan.com` on date `7/8/2021 - 1:40PM`.\n- Data was pulled using [SSLEnum](https://github.com/melbadry9/SSLEnum)\n\n```json\n{\n  \"name\": \"max1.liveplan.com\",\n  \"org\": [],\n  \"cn\": [\n    \"*.test.tugo.com\"\n  ],\n  \"alt_doms\": [\n    \"*.test.tugo.com\",        \n    \"*.dev.tugo.com\",\n    \"*.uat.tugo.com\"\n  ],\n  \"dangling\": true\n}\n```\n\n- This does prove that `max1.liveplan.com` is currently taken over by  someone.\n\n{F1403387}\n \n## Fix\n- Use Elastic IPs instead of the public DNS of EC2 instance or clear DNS records for mentioned subdomain\n\n## Supporting Material/References:\n- https://blog.melbadry9.xyz/dangling-dns/aws/ddns-ec2-current-state\n\n## Impact\n\n- This could allow the takeover of the EC2 instance IP that will lead to subdomain takeover.","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1403387,"file_name":"Screenshot_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mc1uqvn61tquvc3pxdtu3g29ldn2?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_1.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133705Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=66fa466f0d785c7fcd2ab5a45b886bfec37f45d91b0455bffeb8d7f1e7741312","file_size":64844,"type":"image/png"}],"allow_singular_disclosure_at":"2021-09-08T16:45:18.237Z","allow_singular_disclosure_after":-2839907.198020702,"singular_disclosure_allowed":true,"vote_count":9,"voters":["run_win","akashhamal0x01","theblackmask","pucukubi","meispi","thespian","chux","iankit","vijaytithani"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":12894434,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2021-08-09T15:57:31.495Z","updated_at":"2021-08-09T15:57:31.495Z","actor":{"username":"staffors","cleared":false,"url":"/staffors","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AcHK4sXdMg6i5MGGWMQNUCKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12894475,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I deleted the max1 DNS entry. Thanks for the report!","automated_response":false,"created_at":"2021-08-09T15:57:51.743Z","updated_at":"2021-08-09T15:57:51.743Z","actor":{"username":"staffors","cleared":false,"url":"/staffors","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AcHK4sXdMg6i5MGGWMQNUCKG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"melbadry9","url":"/melbadry9"},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":12896114,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-08-09T16:45:18.193Z","updated_at":"2021-08-09T16:45:18.193Z","first_to_agree":true,"actor":{"username":"melbadry9","cleared":false,"url":"/melbadry9","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/347/379/509314872bfbaa1a79051729c1826de2ccc8677f_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13370713,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-09-08T16:45:30.972Z","updated_at":"2021-09-08T16:45:30.972Z","actor":{"url":"/palo_alto_software","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/327/6b83191758494b9c630b6ba94f088d0c78829602_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Palo Alto Software"}},"genius_execution_id":null,"team_handle":"palo_alto_software","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}