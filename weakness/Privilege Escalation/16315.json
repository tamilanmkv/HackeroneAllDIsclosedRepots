{"id":16315,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjMxNQ==","url":"https://hackerone.com/reports/16315","title":"Abusing VCS control on phabricator","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-06-13T12:49:59.335Z","submitted_at":"2014-06-13T12:49:59.335Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunnelshade","url":"/tunnelshade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-06-13T15:04:00.726Z","bug_reporter_agreed_on_going_public_at":"2014-06-13T15:04:00.623Z","team_member_agreed_on_going_public_at":"2014-06-13T14:30:00.270Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"My reporting skills suck but I tried to make a clear report. Please let me know if you need any further clarifications","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-13T14:25:13.580Z","allow_singular_disclosure_after":-228698585.12650743,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":72673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This report doesn't seem to have any information in it. Am I missing something?","automated_response":false,"created_at":"2014-06-13T12:51:02.547Z","updated_at":"2014-06-13T12:51:02.547Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am really sorry, the file didn't get uploaded","automated_response":false,"created_at":"2014-06-13T12:51:32.471Z","updated_at":"2014-06-13T12:51:32.471Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":11277,"filename":"phabricator.pdf","type":"application/pdf","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/011/277/593d3073b3d41213754c7d1357e2b5d65f2f4988/phabricator.pdf?response-content-disposition=attachment%3B%20filename%3D%22phabricator.pdf%22%3B%20filename%2A%3DUTF-8%27%27phabricator.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134818Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=950199ddcdcf6802f09a9cde2502f89b58289089c542c470f382b7e0d9390126"}],"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72683,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks! This looks legitimate to me.\n\nAn attacker who can create repositories could also use a similar attack to read some \"rABC\" that they don't have permission to view: they can create a new \"rXYZ\" with `file:///var/phabricator/repo/ABC` as the clone URI, then read the contents of the secret repository.\n\n(This is mitigated to some degree because you must be able to create or edit repositories to perform these attacks, and those actions are usually/by default restricted to administrators. But once you have those permissions, this incorrectly allows you to escalate.)\n\nI'm going to fix this by disabling `file://`URIs for both remotes and mirrors, since I'm not aware of any legitimate use cases for either one in modern Phabricator (long in the past, we supported use cases where you imported a repository already present on disk, but have moved away from this).","automated_response":false,"created_at":"2014-06-13T13:07:42.806Z","updated_at":"2014-06-13T13:07:42.806Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For this attack, user **need not** have create/edit access to repos. He can have edit access to just one repository.\n\nSimple fix: Might be to disable file:/// protocol\n\nComplicated fix: To use permissions.\n\nI hope you got what I wanted to convey. Btw very quick and awesome response :)","automated_response":false,"created_at":"2014-06-13T13:10:37.548Z","updated_at":"2014-06-13T13:13:15.289Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should fix the issue, by disabling `file://` in new and edited repositories and mirrors:\n\nhttps://secure.phabricator.com/D9513","automated_response":false,"created_at":"2014-06-13T13:59:20.920Z","updated_at":"2014-06-13T13:59:20.920Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, You are the best guys to whom I have reported bugs. BTW\n```\nConfiguring mirroring to a file:// URI to place files on disk or overwrite another repository. This is not particularly severe.\n```\n\nI think ability to overwrite a repo even when you don't have write privs is kind of severe :P","automated_response":false,"created_at":"2014-06-13T14:02:56.233Z","updated_at":"2014-06-13T14:03:26.638Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's much worse to be able to read a repository you shouldn't have access to than to destroy a repository.\n\nDestroying a repository is just inconvenient: it needs to be restored from backup, but you should lose only a small amount of data in the worst case.","automated_response":false,"created_at":"2014-06-13T14:06:27.463Z","updated_at":"2014-06-13T14:06:27.463Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72711,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To silently commit backdoor into a repository is really dangerous right??\n\nAttacker can hide a commit (a backdoor possibly) and make the overwrited git repo look as usual","automated_response":false,"created_at":"2014-06-13T14:08:43.318Z","updated_at":"2014-06-13T14:10:38.880Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You can only append to repositories which are imported (vs hosted) -- the commit hooks will prevent mirroring otherwise. And Phabricator won't serve imported repositories to users, so your change shouldn't be able to propagate to users.\n\nYour changes will be overwritten when the repository is next pulled, too (although conceivably you could keep mirroring).","automated_response":false,"created_at":"2014-06-13T14:20:47.026Z","updated_at":"2014-06-13T14:20:47.026Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72716,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should be fixed in HEAD:\n\nhttps://secure.phabricator.com/rPd401036bd82b28053372af546162c63768e65562\n\nThanks for the report, and let us know if you catch anything else.","automated_response":false,"created_at":"2014-06-13T14:25:13.606Z","updated_at":"2014-06-13T14:25:13.606Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tunnelshade","url":"/tunnelshade"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"+ Phabricator served the modified one when I tried to clone\n+ If mirrors are enabled bi directional, this change is pushed to the mirror as well, instead of pulling. (Eg; See this https://github.com/foss-iitbhu/tunnelshade-test-repo/, was the initial one from which the main repo was imported, but when the main repo got overwritten, see how even the github repo changed(Changes were pushed by phabricator))\n+ Will this be eligible for bounty?","automated_response":false,"created_at":"2014-06-13T14:25:59.562Z","updated_at":"2014-06-13T14:27:51.893Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72718,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This issue has high severity (permission bypass of repositories). However, it is somewhat mitigated  by the high level of access required (you must have an account which can create or edit repositories, and in the default configuration only administrators can take these actions).","automated_response":false,"created_at":"2014-06-13T14:27:59.935Z","updated_at":"2014-06-13T14:27:59.935Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"600.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"tunnelshade","url":"/tunnelshade"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72719,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This can be disclosed at any time, as the fix is already in public source control.","automated_response":false,"created_at":"2014-06-13T14:30:00.286Z","updated_at":"2014-06-13T14:30:00.286Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":72732,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2014-06-13T15:04:00.642Z","updated_at":"2014-06-13T15:04:00.642Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":72733,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-06-13T15:04:00.740Z","updated_at":"2014-06-13T15:04:00.740Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}