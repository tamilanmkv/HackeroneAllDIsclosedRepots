{"id":16392,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM5Mg==","url":"https://hackerone.com/reports/16392","title":"Abusing daemon logs for Privilege escalation under certain scenarios","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-06-14T03:09:35.523Z","submitted_at":"2014-06-14T03:09:35.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tunnelshade","url":"/tunnelshade","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-06-18T13:44:53.500Z","bug_reporter_agreed_on_going_public_at":"2014-06-18T13:44:53.406Z","team_member_agreed_on_going_public_at":"2014-06-18T12:40:24.138Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Setup Needed\r\n\r\n+ A normal user account\r\n+ A momentary disruption of mail services\r\n\r\n# Replication steps\r\n\r\n+ Login as **normal user**\r\n+ Wait for **momentary disruption** of mail services\r\n+ Use **Password Reset Link** for admin mail address\r\n+ BOOM!!!\r\n+ You can see the password reset link in the daemon logs because of interrupted mail service (check the screenshot)\r\n+ Click on the link and upgrade to **Admin**\r\n\r\n# Attack Scenarios\r\n\r\n(Virtually unlimited) \r\nA moment misconfiguration of \r\n+ Mail configuration\r\n+ Firewall settings\r\n+ Mail Service down\r\netc.. etc.. (we just need a moment :P)\r\n\r\nI actually discovered this bug when gmail rejected my smtp credentials to prevent suspicious login :P.\r\n\r\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":11310,"file_name":"daemon-log.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/011/310/ec99a49702274bb318c374bf0126da733d40409c/daemon-log.png?response-content-disposition=attachment%3B%20filename%3D%22daemon-log.png%22%3B%20filename%2A%3DUTF-8%27%27daemon-log.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4W3YS5FD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134846Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIGFHTfvNreCpBEx6ma8SNDd1vDDIfs0%2Bg65AmwngiTYQAiAlnCpBqU%2FBhidkHb7BIm1B5mCQRUOVIXp%2BQseSrlRN5iqDBAju%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMMkyyP6srRKwJnYw5KtcDHeBEJsk4F2SMjLLnKF6VZQ8gTH0LrxcCVqXSMNgZR1F18PpwhYbU8Qwfn4rOecOjc%2FGfNk3djcauIei8aKCcLnzshwHWQSvd29UhjSLaczWwVEte3ncX5%2F7TLBeg7zRQpsc0zFB20Cm8vF8Z5NfsChYhN7bulkH%2FDfJw16%2BYS1fZkQzhsF%2FUaEP8JAGkMj5v5WOr%2FLnx6%2FMMhK6%2BsDFWaIeUhAxulEbhuEZZ6dgcu1gqMyUwcg6D9rjwyKS9mTsUA%2BHVlKPil1lPtr7SxO3tf2vD8Cw7bLkyy75qgFHEvuDCUCELKpXfBVH6PD30xPvCzrVd0fptlqCTt6Cpd5I3iyyU9RW0SJyHzyBPACEpWDB8exeuJzM7TEeRFCbnl0%2FkfEHmTDCBuuqKxE7cVRG87tuNtO3iVLpOhHCzOtUoK2Il4kvMh2HPZMpvYIGHtynKBM%2BIh69sGJa0yvDoN%2FRI6PAGM02ZolRkS4bZfQfYm7fOPbpLxrQWbSljfYgc7qbAOT56FKw4Ty4wTdxJVV1NLklUpTvIFuc4wqfUdZCvpJj%2BZaH0CSm%2FQv7WX13ukuacZxFgzkAlzUArGS2%2FgJQFovV4hCQKUkAlBpn1fxDFCB%2FBfj2XYH0lMJ7wkIsGOqYBZLVkkm4v7ciHR6x1EZfGmDDAlA8GWCaRs%2B7p4f0zSrCh5MwJxKYAhCMitoCHTMbKlCWaIdMl5rpmPNjCa3GtIbMpvdZUwpN0EhEKHvK6WgKkHhzE8vZn5llsPReTP2V7t22qBXykSYg%2BgK2etoazMxx4eBGAB7YXcUmHU%2FW%2FCsmGlbwbgrQPl3suOkp4ARb2LIsd96p9ZA9i%2BG4DSDrVOakuIKwh2Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b4e1f89f3ae8d6a1fcb65295d091d10edc60e527d09a7a9cb6cda3a6f15802b5","file_size":92043,"type":"image/png"}],"allow_singular_disclosure_at":"2014-07-18T12:40:24.218Z","allow_singular_disclosure_after":-228272902.61285165,"singular_disclosure_allowed":true,"vote_count":1,"voters":["zonestc"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":73262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed by this change, which censors values from logs:\n\nhttps://secure.phabricator.com/D9540\n\nHowever, we probably need to remove logs from the web UI entirely to really fix this. This is unfortunate because they're very useful for debugging and troubleshooting, but we can't realistically ever blacklist all of the sensitive stuff that can end up there.","automated_response":false,"created_at":"2014-06-15T02:20:35.382Z","updated_at":"2014-06-15T02:20:35.382Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":74006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, logs leak too much info and it is practically difficult to blacklist everything, so you can either keep log access for just **admins** or make it an admin **granted privilege**. Triage?","automated_response":false,"created_at":"2014-06-16T17:06:07.056Z","updated_at":"2014-06-16T17:12:19.537Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75214,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed in HEAD:\n\nhttps://secure.phabricator.com/rPHUe57d872cbe61686bf215520b0158cdf1f5dce26a\n\nI've filed this to keep track of removing the UI entirely:\n\nhttps://secure.phabricator.com/T5405","automated_response":false,"created_at":"2014-06-18T12:36:35.185Z","updated_at":"2014-06-18T12:36:35.185Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tunnelshade","url":"/tunnelshade"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75215,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This attack requires an account, depends on an external service failure, requires an install have username/password authentication configured, indirectly alerts administrators by sending them password reset emails, and is mitigated by two-factor auth if it's in use.","automated_response":false,"created_at":"2014-06-18T12:39:22.379Z","updated_at":"2014-06-18T12:39:22.379Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"tunnelshade","url":"/tunnelshade"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75216,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This can be disclosed at any time, the fix is in public version control.","automated_response":false,"created_at":"2014-06-18T12:40:24.154Z","updated_at":"2014-06-18T12:40:24.154Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":75231,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Keep it up guys, you rock \u0026 phabricator too :)","automated_response":false,"created_at":"2014-06-18T13:44:53.422Z","updated_at":"2014-06-18T13:44:53.422Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75232,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2014-06-18T13:44:53.515Z","updated_at":"2014-06-18T13:44:53.515Z","actor":{"username":"tunnelshade","cleared":false,"url":"/tunnelshade","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/337/040c0014777b24c31cc889d346f3a196b5ddcad5_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}