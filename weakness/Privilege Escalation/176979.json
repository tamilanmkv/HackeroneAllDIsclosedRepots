{"id":176979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzY5Nzk=","url":"https://hackerone.com/reports/176979","title":"Authentication Issue","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-10-20T08:27:36.425Z","submitted_at":"2016-10-20T08:27:36.425Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugdiscloseguys","url":"/bugdiscloseguys","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-01-05T23:08:09.038Z","bug_reporter_agreed_on_going_public_at":"2016-12-13T03:57:52.091Z","team_member_agreed_on_going_public_at":"2017-01-05T23:08:09.000Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello there,\nI noticed while creating Recurring payment while 2FA is enabled it asks a user to enter verification code.\nSo when someone confirm the Reccuring payment a request is sent to :\n\n```\nPOST /recurring_payments/58087a3d6861ee015644fc48/confirm HTTP/1.1\nHost: beta.coinbase.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:51.0) Gecko/20100101 Firefox/51.0\nAccept: */*;q=0.5, text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://beta.coinbase.com/recurring_payments\nX-NewRelic-ID: XA4HVVZTGwIAVFVXBAAG\nX-CSRF-Token: /hSt/DD82VwI6ks+4P0VTHTDULz5EhHKowGAGfryWcVCZd47s+rQZDCgr70pJK4EeFHkKWRd0SJbVq1K64IZLA==\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 28\nCookie: __utma=117893787.1205167212.1468114999.1475980536.1476020583.48; __utmz=117893787.1475796788.43.5.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=https%3A%2F%2Fwww.coinbase.com%2Fusers%2Ffa1f4606a31526801960b8c5703e2fa3%2Fverify; _coinbase=SDhMZytnck5TRi9McEMvMnpzY09OcjhJSlZ3TTZwYlFpWEZWcVlXcW13a1UzL3ZwdVFpdUlBd3RJSXBnSEhnOXZNZkExS1EyQXNNMitWSDVtQVpMVTdrdFRZTGFPRkVFMjZUbGZpVUhaYXA2aFdZa2hmWk55c0JzODM3ZzR0cHFTTmF1RHduOGhuZHFoOExDQ3craFdBWlJDalpOckhISlVtdzArWVMvdy9VSzJ2ZG9tejVIN3FQZXltSTlpeHRMd1VnNVRJL296b0tCT2VkWDlhaVJTWlU0ZkJDVkpPVFVwVXBnY09SVE5tcHVsYXNyMzdmUDdLS0NEbUhPSnI1d2ptM2JFcHFEQ0xQK1VCOWxMZXJFVG9HNlR1MnJXVk9TNjJuczlMN2NQdytWQnVuenZQeVI0bTF0dEc4b0FnWVY0WVZOcUVqOXE1RjYxVUVHV2pXSEdmTDVaYXI4dGNuVFhLb3JJb1N6eGwyMXNPSDRzWXRXNGhMd3l6aS8vSmp1bE94VlVYcit3UEVjc1JaKzVQalFlQzZuNnZLcDMwRE95UHR3MEpIUk1XZnliRlNSRWljR0NjN1JjUG90czd4UVY1TUp4YURJMkc5QUkrMGtiNVduSTc4WE9DT1ZsYzRKUERlNXAwakxQWWZlM2lQWDhydis5RStmYlAvVmtWS1h1OVhNTEtxSHNLOHkxa0hsOHkxaGpUdU1NdDJkRE1qU1EweEc0QVBKTEVnVjhvWlJQNFZiQ2pLYzRMYTNteUJjb1prMmIwRmtaMVlZc0w1aStBN3BkVEVqQXUxbDR0M2hITlN2SG1NVTQ3ZmZjT3QzamJERWY0RFIwSE5QL0tkTC0tdklic3RLUW1PZGhMNUErbUduRHNvQT09--d62907cee478b842f0368b067911107b93901fd5; df=730203b840afd60662e0f702672e42c0; ba=Mozilla%2F5.0%20(Macintosh%3B%20Intel%20Mac%20OS%20X%2010.11%3B%20rv%3A51.0)%20Gecko%2F20100101%20Firefox%2F51.0%23Intel%20Mac%20OS%20X%2010.11%234%2320100101%2320161019004013%23en-US%7C-330%23-330%23Thu%20Jan%2001%201970%2005%3A30%3A00%20GMT%2B0530%20(IST)%231%2F1%2F1970%2C%205%3A30%3A00%20AM%7C1280%23800%231280%23773%231%2324%230%2363%7C92f0112e7e19a58c900cddb7a717071a%23eca2166361dcd2ed64208e3d3543f751%23747b82b0027818ce808067ac0bb5118c%23383d750ac35ce7f8529ea4feefe52bd5%2390043fe540993e69ecde6102236dee71%7C%7CAAAAwBMBMpARDHcHAAhAAAAAAOQFaY6AAg%3D%3D; wcsid=2LddXtSmHNylLs5x1T41E46ICJKMJ18e; hblid=EdBhoju3s0gWxyDX1T41E46ICJk0KMTy; _oklv=1476950540058%2C2LddXtSmHNylLs5x1T41E46ICJKMJ18e; _okdetect=%7B%22token%22%3A%2214769450025350%22%2C%22proto%22%3A%22https%3A%22%2C%22host%22%3A%22beta.coinbase.com%22%7D; olfsk=olfsk6806335012267972; _okbk=cd4%3Dtrue%2Cvi5%3D0%2Cvi4%3D1476945007028%2Cvi3%3Dactive%2Cvi2%3Dfalse%2Cvi1%3Dfalse%2Ccd8%3Dchat%2Ccd6%3D0%2Ccd5%3Daway%2Ccd3%3Dfalse%2Ccd2%3D0%2Ccd1%3D0%2C; _ok=8678-140-10-4291; _ga=GA1.3.1205167212.1468114999; __cfduid=d18d5c640e53cb87b90006494522c47431476945463; _ga=GA1.2.1205167212.1468114999; __ssid=b49e9a04-f751-4f59-a56f-845e27fe3277; mp_mixpanel__c=316; sft=7f8f7e817da5d65688adc609f2c7405d; address_58086c598ace9202b6531de0=580878636861ee03a644fc45; _gat=1; mp_7c112173efca4899213c618484d8f5fe_mixpanel=%7B%22distinct_id%22%3A%20%2257e87cd8694c037037f2b78b%22%2C%22country_code%22%3A%20%22IN%22%2C%22REACT%22%3A%20true%7D; request_method=POST; _gali=recurring_payments_modal\nConnection: keep-alive\n\nutf8=%E2%9C%93\u0026_method=patch\n```\nNow when someone delete this reccuring payment there is no such option to restore it and note that for re-creating it you need a VERIFICATION CODE.\nBut if someone repeat the request which was obtained while confirming payment the reccuring payment is restored to particular payment ID.\n\nThanks\nGod is great \u003c3\n\n**Please mark it as informative if you dont believe its a security threat for you**\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-01-12T03:57:52.149Z","allow_singular_disclosure_after":-149766932.1426377,"singular_disclosure_allowed":true,"vote_count":22,"voters":["bugdiscloseguys","mpz","madrobot","eveeez","r3y","ak1t4","kiraak-boy","t4ym","exception","alfredsaonoy","and 12 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1258420,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-10-20T17:57:33.097Z","updated_at":"2016-10-20T17:57:33.097Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":3241,"new_severity_id":3353},"actor":{"username":"coinbase5293","cleared":false,"url":"/coinbase5293","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258429,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Interesting find @bugdiscloseguys.\n\nCapturing this request, considering this is under TLS would be very difficult. Additionally the possibility of this being useful to an attacker is very low since this was a previously authorized recurring payment.\n\nNone the less, I believe this is a valid defense in depth issue and so I will award a $100 bounty. It should be fixed soon.\n\nThank you for your work!\n\n","automated_response":false,"created_at":"2016-10-20T18:01:25.567Z","updated_at":"2016-10-20T18:01:25.567Z","actor":{"username":"coinbase5293","cleared":false,"url":"/coinbase5293","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258431,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-10-20T18:01:45.475Z","updated_at":"2016-10-20T18:01:45.475Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258432,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-10-20T18:02:01.894Z","updated_at":"2016-10-20T18:02:01.894Z","actor":{"username":"coinbase5293","cleared":false,"url":"/coinbase5293","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sir i respect your decision but i guess the amount for this particular report is low as it somehow effect the finacial transaction.","automated_response":false,"created_at":"2016-10-20T18:03:50.388Z","updated_at":"2016-10-20T18:03:50.388Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All we need is the transaction ID.","automated_response":false,"created_at":"2016-10-20T18:04:24.543Z","updated_at":"2016-10-20T18:04:24.543Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The chance of such a recurring payment being useful for an attacker is very low and somehow, post compromise, the attacker would need to know a transaction ID which is not known unless they had access to the account while the recurring payment was active.\n\nI do not believe this is a serious threat.\n\nI did forget that we are doubling bounties for beta.coinbase.com though.\nAwarding another $100.","automated_response":false,"created_at":"2016-10-20T22:27:10.409Z","updated_at":"2016-10-20T22:27:10.409Z","actor":{"username":"coinbase5293","cleared":false,"url":"/coinbase5293","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258878,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Bonus for beta.coinbase.com promotion.","automated_response":false,"created_at":"2016-10-20T22:27:29.101Z","updated_at":"2016-10-20T22:27:29.101Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1258880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks alot 😬","automated_response":false,"created_at":"2016-10-20T22:28:44.080Z","updated_at":"2016-10-20T22:28:44.080Z","actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1264975,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-10-24T18:29:52.511Z","updated_at":"2016-10-24T18:29:52.511Z","actor":{"username":"coinbase5293","cleared":false,"url":"/coinbase5293","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugdiscloseguys","url":"/bugdiscloseguys"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1360544,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-13T03:57:52.111Z","updated_at":"2016-12-13T03:57:52.111Z","first_to_agree":true,"actor":{"username":"bugdiscloseguys","cleared":true,"url":"/bugdiscloseguys","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xVUwqLPZMRzBgybFxVY3ec6o/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1402920,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-05T23:08:09.015Z","updated_at":"2017-01-05T23:08:09.015Z","actor":{"username":"cbphilip","cleared":false,"url":"/cbphilip","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1402921,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-05T23:08:09.053Z","updated_at":"2017-01-05T23:08:09.053Z","actor":{"username":"cbphilip","cleared":false,"url":"/cbphilip","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}