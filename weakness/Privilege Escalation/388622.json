{"id":388622,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODg2MjI=","url":"https://hackerone.com/reports/388622","title":"Subdomain takeover on wfmnarptpc.starbucks.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-30T22:20:33.463Z","submitted_at":"2018-07-30T22:20:33.463Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xpatrik","url":"/0xpatrik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-08-09T21:09:10.902Z","bug_reporter_agreed_on_going_public_at":"2018-08-03T03:54:41.643Z","team_member_agreed_on_going_public_at":"2018-08-09T21:09:10.480Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nthis is pretty serious security issue in some context, so please act as fast as possible.\n\nOverview:\nOne of the starbucks.com subdomains is pointing to Azure, which has unclaimed CNAME record. ANYONE is able to own starbucks.com subdomain at the moment.\n\nThis vulnerability is called subdomain takeover. You can read more about it here:\n\nhttps://0xpatrik.com/subdomain-takeover-basics/\n\nDetails:\nwfmnarptpc.starbucks.com has CNAME to s00149tmppcrpt.trafficmanager.net. However, s00149tmppcrpt.trafficmanager.net is not registered in Azure cloud anymore and thus can be registered by anyone. After registering the TrafficManager Profile in Azure portal, the person doing so has full control over content on wfmnarptpc.starbucks.com.\n\nPoC:\nhttp://wfmnarptpc.starbucks.com/poc.html\n\n Mitigation:\nRemove the CNAME record from starbucks.com DNS zone completely.\nClaim it back in Azure portal after I release it\nRegards,\n\nPatrik Hudak\n\n## Impact\n\nSubdomain takeover is abused for several purposes:\n\nMalware distribution\nPhishing / Spear phishing\nXSS\nAuthentication bypass\n...\nList goes on and on. Since some certificate authorities (Let's Encrypt) require only domain verification, SSL certificate can be easily generated.","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":326554,"file_name":"Screen_Shot_2018-07-31_at_00.19.53.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/326/554/b48a033bdde923485cd413390893a01b8db6b7bb/Screen_Shot_2018-07-31_at_00.19.53.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-07-31_at_00.19.53.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-07-31_at_00.19.53.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145417Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=8086ee1b4ce185ba40470ebcadf80f614ef769802cad138f67b43f2b38cde513","file_size":16342,"type":"image/png"}],"allow_singular_disclosure_at":"2018-09-02T03:54:41.862Z","allow_singular_disclosure_after":-98103575.73015839,"singular_disclosure_allowed":true,"vote_count":84,"voters":["pyrrhon","0xpatrik","badf00d","checkm50","msultan","vavkamil","seczi","michiel","muon4","s_p_q_r","and 74 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":13008,"asset_type":"OTHER","asset_identifier":"Other non domain specific items","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3121525,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We have received your report.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**","automated_response":false,"created_at":"2018-07-31T10:22:36.502Z","updated_at":"2018-07-31T10:22:36.502Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3123994,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @0xpatrik , Thanks for your report. We are following up with our internal team to remove the DNS record as a fix to the issue. We will get back once we receive an update so you can release the claimed traffic manager name. Once again, Thanks for your submission!\n\n@ristretto","automated_response":false,"created_at":"2018-07-31T22:17:44.718Z","updated_at":"2018-07-31T22:17:44.718Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3123997,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-07-31T22:17:59.335Z","updated_at":"2018-07-31T22:17:59.335Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Starbucks"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"0xpatrik","url":"/0xpatrik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3135322,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @0xpatrik , We have confirmed that the issue has been fixed, so the report is being closed. Please let us know if you find any further issues. Thanks for your report!\n\n@ristretto","automated_response":false,"created_at":"2018-08-03T00:32:06.314Z","updated_at":"2018-08-03T00:32:06.314Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"0xpatrik","url":"/0xpatrik"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3135607,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-08-03T03:54:41.738Z","updated_at":"2018-08-03T03:54:41.738Z","first_to_agree":true,"actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3158359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","automated_response":false,"created_at":"2018-08-07T23:11:53.357Z","updated_at":"2018-08-07T23:11:53.357Z","actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168310,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @0xpatrik, We will disclose the report, Can you please release the \"s00149tmppcrpt\" traffic manager account that you have claimed?\n\nThanks!\n@ristretto","automated_response":false,"created_at":"2018-08-09T18:35:20.666Z","updated_at":"2018-08-09T18:35:20.666Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I released that last week.","automated_response":false,"created_at":"2018-08-09T18:45:12.855Z","updated_at":"2018-08-09T18:45:12.855Z","actor":{"username":"0xpatrik","cleared":false,"url":"/0xpatrik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, Thanks for confirming!\n\n@ristretto","automated_response":false,"created_at":"2018-08-09T21:09:02.194Z","updated_at":"2018-08-09T21:09:02.194Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3168999,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-08-09T21:09:10.574Z","updated_at":"2018-08-09T21:09:10.574Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3169000,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-08-09T21:09:10.949Z","updated_at":"2018-08-09T21:09:10.949Z","actor":{"username":"ristretto","cleared":false,"url":"/ristretto","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3701897,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","automated_response":false,"created_at":"2018-11-23T20:12:56.140Z","updated_at":"2018-11-23T20:12:56.140Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"Other non domain specific items","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":9758,"category":"researcher","content":"Subdomain takeover possible on one of Starbucks's subdomain. The subdomain pointed to Microsoft Azure Traffic Manager which was no longer registered under Azure.\n\nDetailed write-up: https://0xpatrik.com/subdomain-takeover-starbucks-ii/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":165612,"username":"0xpatrik","name":"Patrik Hudak","bio":"(Automation x AI)²","cleared":false,"website":"https://0xpatrik.com","location":"","created_at":"2017-05-06T21:13:08.252Z","url":"https://hackerone.com/0xpatrik","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/PB6Ser89s4PYXAMkpC66nbdo/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}