{"id":43065,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzA2NQ==","url":"https://hackerone.com/reports/43065","title":"Fabric.io - an app admin can delete team members from other user apps","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-09T04:26:42.758Z","submitted_at":"2015-01-09T04:26:42.758Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-09T02:31:28.332Z","bug_reporter_agreed_on_going_public_at":"2015-02-07T02:31:17.517Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible for an app admin to delete all the team members from other apps for which he doesn't have access.\r\n\r\nTo reproduce the attack, create two apps and add different user roles as below, \r\n\r\nVictimApp  - Aliceadmin, Alicemember \r\n\r\nHackerApp - Hackeradmin, Hackermember\r\n\r\nBefore proceeding with the attack, log into fabric.io as Aliceadmin and grab the VictimApp id and account ids.\r\n\r\nVictimApp id: 54ad5e03a25bb8136b000002\r\nAliceadmin id: 54aa4c616bb166b8f300134a\r\nAlicemember id: 54af48304d8f5b12ff0000fd\r\n\r\nCase 1:  Deleting other app team members\r\n\r\n-\u003e Log into fabric.io as Hackeradmin.\r\n-\u003e Navigate to settings-\u003eapps-\u003eHackerApp-\u003eTeam member link.\r\n-\u003e Click on x symbol corresponding to Hackermember to remove him from HackerApp. Intercept this request using burp proxy.\r\n\r\n\tProxy shows a similar request as below,\r\n\r\n\tDELETE /accounts/54aa37d8f61d7749430127ee?admin=true\u0026app_id=54aeafc28bfc55053d000028 HTTP/1.1\r\n\tHost: fabric.io\r\n\r\n-\u003e In the intercepted request change the account id, app id to other app user and remove admin parameter.\r\n \r\nFor example, Alicemember - account id: 54aa4c616bb166b8f300134a, VictimApp id: 54ad5e03a25bb8136b000002\r\n\r\n\tModified request is,\r\n\r\n\tDELETE /accounts/54aa4c616bb166b8f300134a?app_id=54ad5e03a25bb8136b000002 HTTP/1.1\r\n\tHost: fabric.io\r\n\r\n-\u003e Send the modified request to the server and it removes Alicemember from VictimApp.\r\n-\u003e To confirm, login as Aliceadmin and look at the VictimApp team members.\r\n\r\nThough Hackeradmin does not have access to VictimApp, he successfully deleted VictimApp team member.\r\n\r\nCase 2: DOS\r\n\r\nAliceadmin is the only user in VictimApp. If there is only one user in the app, fabric does not allow to leave the app. However, by following the steps provided above, it is possible to delete Aliceadmin account from the app. Now, VictimApp is not accessible to anyone and Aliceadmin can't log into Fabric with his password (Reset password also does not work - it shows success but does not send the reset link in email).\r\n\r\nTo successfully perform the attack, attacker has to know the app id and corresponding account ids. Possible scenarios are, \r\n\r\n-\u003e Hackeradmin might be a member of VictimApp initially and later his access is removed. He might have noted down (or have some logs) VictimApp id and all other account ids.\r\n-\u003e Hackeradmin can obtain the victim account ids by sending an invitation to the victim email id (account id displayed in the response). Later, he can perform a bruteforce on the app id.\r\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-03-09T02:31:18.045Z","allow_singular_disclosure_after":-208096104.4464205,"singular_disclosure_allowed":true,"vote_count":1,"voters":["eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":307075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Created a POC video - http://youtu.be/Q7F8r6Cg3tM","automated_response":false,"created_at":"2015-01-09T15:11:27.854Z","updated_at":"2015-01-09T15:11:27.854Z","actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":307316,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-01-09T20:47:42.459Z","updated_at":"2015-01-09T20:47:42.459Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":314584,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned weâ€™ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2015-01-21T02:31:52.176Z","updated_at":"2015-01-21T02:31:52.176Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318171,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-01-26T19:02:22.022Z","updated_at":"2015-01-26T19:02:22.022Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":327340,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-02-07T02:31:17.581Z","updated_at":"2015-02-07T02:31:17.581Z","first_to_agree":true,"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":348773,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-03-09T02:31:28.418Z","updated_at":"2015-03-09T02:31:28.418Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}