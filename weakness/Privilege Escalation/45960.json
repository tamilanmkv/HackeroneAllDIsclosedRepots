{"id":45960,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTk2MA==","url":"https://hackerone.com/reports/45960","title":"CRITICAL vulnerability - Insecure Direct Object Reference - Unauthorized access to `Videos` of Channel whose privacy is set to `Private`.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-01-31T17:31:10.992Z","submitted_at":"2015-01-31T17:31:10.992Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"coolboss","url":"/coolboss","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-18T13:16:59.917Z","bug_reporter_agreed_on_going_public_at":"2015-03-14T07:30:06.073Z","team_member_agreed_on_going_public_at":"2015-03-18T13:16:58.612Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nThis time I found a IDOR(Insecure Direct Object Reference) vulnerability. It allows an attacker to get unauthorized access to `Videos` of Channel whose privacy is set to `Only moderators and people I choose` without being a member.\r\nIn simple words, we can access videos of private channel without being member of it.\r\n\r\nProof Of Concept:\r\n===============\r\n1. See this channel ---\u003e https://vimeo.com/channels/870575\r\nWhen opened it will show an error ---\u003e \r\n`Private Channel\r\nSorry, this Channel is private. You do not have permission to view this Channel.`\r\n\r\n2. Now, I have a video placed there. Follow the steps to get access to my video.\r\n\r\n3.  Go to ---\u003e https://vimeo.com/tools/widget/montage\r\n(Use burp proxy and intercept the request mades.)\r\n\r\n1st request ---\u003e  https://vimeo.com/tools/widget/montage\r\n2nd request ---\u003e `https://vimeo.com/tools/widget/montage?widget=1\u0026preview=1\u0026user_id=36807051\u0026badge_stream=channel\u0026badge_channel=870575\u0026badge_album=3231945\u0026badge_layout=horizontal\u0026badge_quantity=6\u0026show_titles=no\u0026badge_size=80`\r\n###Note `badge_channel` parameter to any value.\r\n\r\nOpen this link ---\u003e https://vimeo.com/tools/widget/montage?widget=1\u0026preview=1\u0026user_id=36807051\u0026badge_stream=channel\u0026badge_channel=870575\u0026badge_album=3231945\u0026badge_layout=horizontal\u0026badge_quantity=6\u0026show_titles=no\u0026badge_size=80\r\n\r\nYou will be shown my videos. Now keep enumerating `badge_channel={any valid value}`, it will get you access to any videos.\r\n\r\n4. Game over ...! :D\r\n5. This very dangerous as we can access any videos.\r\n\r\n\r\nVideo POC : ---\u003e http://youtu.be/vRAtxovcfHs (It is an unlisted video on youtube.)\r\n\r\nHope to see this patched quickly. :-)\r\n\r\nRegards,\r\nPranav\r\n\r\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-13T07:30:07.323Z","allow_singular_disclosure_after":-205054327.6379481,"singular_disclosure_allowed":true,"vote_count":2,"voters":["rashedul_css","wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":322049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nPlease be logged into your account and then use the link ---\u003e https://vimeo.com/tools/widget/montage?widget=1\u0026preview=1\u0026user_id=36807051\u0026badge_stream=channel\u0026badge_channel=870575\u0026badge_album=3231945\u0026badge_layout=horizontal\u0026badge_quantity=6\u0026show_titles=no\u0026badge_size=80\n\nKeep enumerating `badge_channel={any valid value}` you will get access to all videos.\n\nThanks,\nPranav","automated_response":false,"created_at":"2015-01-31T17:36:56.517Z","updated_at":"2015-01-31T17:36:56.517Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":322050,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI just found that `access controls` are missing on that request.\n\nLink looks like ---\u003e `https://vimeo.com/tools/widget/montage?widget=1\u0026preview=1\u0026user_id=36807051\u0026badge_stream=channel\u0026badge_channel=870575\u0026badge_album=3231945\u0026badge_layout=horizontal\u0026badge_quantity=6\u0026show_titles=no\u0026badge_size=80`\n\nNote the `user_id=36807051`. This works for any valid user_id.\n\nSo, adding access checks i.e checking if `user_id` is a member of `badge_channel`(channel) will be a simple patch here. Thus, protecting unauthorized access to videos of private channel.\n\nThanks,\nPranav","automated_response":false,"created_at":"2015-01-31T17:46:21.477Z","updated_at":"2015-01-31T17:46:21.477Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340294,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@pranav_hivarekar, I've confirmed that you can make thumbnails/widgets for any arbitrary video - but you can't actually view any of these videos correct?  (When I click on these icons I get a \"Protected Video\" page). Let me know if I'm missing something!","automated_response":false,"created_at":"2015-02-25T22:41:43.450Z","updated_at":"2015-02-25T22:41:43.450Z","actor":{"username":"mandatory","cleared":false,"url":"/mandatory","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340295,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@pranav_hivarekar, I've confirmed that you can make thumbnails/widgets for any arbitrary video - but you can't actually view any of these videos correct?  (When I click on these icons I get a \"Protected Video\" page). Let me know if I'm missing something!","automated_response":false,"created_at":"2015-02-25T22:41:43.951Z","updated_at":"2015-02-25T22:41:43.951Z","actor":{"username":"mandatory","cleared":false,"url":"/mandatory","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340745,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi Matthew,\n\nI guess you are slightly wrong. ;)\n\nOn my account, I have added one private video ... so user having password can access the video. It looks you don't have password so it is showing you \"Private Video\" page.\n\nNow, try this link ---\u003e \u003chttps://vimeo.com/tools/widget/montage?widget=1\u0026preview=1\u0026user_id=36807051\u0026badge_stream=channel\u0026badge_channel=870575\u0026badge_album=3231945\u0026badge_layout=horizontal\u0026badge_quantity=6\u0026show_titles=no\u0026badge_size=80\u003e\n\nClick on the second video and not the first.(Note: first video is by default made private by the owner.)\n\nYou can access the second video. 2nd video is shared in Channel whose privacy is set to `Only moderators and people I choose` without being a member.\nIn simple words, we can access videos of private channel without being member of it.\n\nYou can re-watch the same video ---\u003e \u003chttp://youtu.be/vRAtxovcfHs\u003e (It is an unlisted video on youtube.)\u003e\n\nI hope now you get it. :-)\n\nThanks,\nPranav","automated_response":false,"created_at":"2015-02-26T13:58:24.713Z","updated_at":"2015-02-26T13:59:19.479Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340746,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just keep enumerating `badge_channel` parameter in the link I posted. It will show videos present on that channel. And you can access all videos.","automated_response":false,"created_at":"2015-02-26T13:59:56.304Z","updated_at":"2015-02-26T13:59:56.304Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think the only potential security risk here is you could see which clips are in a private group. Based on the examples you've shown here these are public videos, so I don't think there's any real privilege escalation here other than being able to see what's in a private channel. ","automated_response":false,"created_at":"2015-02-26T16:38:45.909Z","updated_at":"2015-02-26T16:38:45.909Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340913,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I believe this is fixed can you confirm?","automated_response":false,"created_at":"2015-02-26T16:39:17.645Z","updated_at":"2015-02-26T16:39:17.645Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"coolboss","url":"/coolboss"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nNo more working. Looks to be fIxed for me.\n\nThanks,\nPranav","automated_response":false,"created_at":"2015-02-26T16:44:55.490Z","updated_at":"2015-02-26T16:44:55.490Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":342088,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks!","automated_response":false,"created_at":"2015-02-27T16:42:39.416Z","updated_at":"2015-02-27T16:42:39.416Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Vimeo"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"coolboss","url":"/coolboss"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":343378,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks ...! :-)","automated_response":false,"created_at":"2015-02-28T18:02:32.681Z","updated_at":"2015-02-28T18:02:32.681Z","actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":354458,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-03-14T07:30:06.306Z","updated_at":"2015-03-14T07:30:06.306Z","first_to_agree":true,"actor":{"username":"coolboss","cleared":true,"url":"/coolboss","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GcQXHyfvnbR42mccVCF6Qk3s/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-03-18T13:16:59.100Z","updated_at":"2015-03-18T13:16:59.100Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357550,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-03-18T13:16:59.969Z","updated_at":"2015-03-18T13:16:59.969Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}