{"id":484420,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODQ0MjA=","url":"https://hackerone.com/reports/484420","title":"Subdomain takeover on usclsapipma.cv.ford.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-23T05:09:30.817Z","submitted_at":"2019-01-23T05:09:30.817Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"march","url":"/march","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35812,"url":"https://hackerone.com/ford","handle":"ford","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/812/579c6f8d1b50ac569b2403e9a2508f5ac334e4ec_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/812/579c6f8d1b50ac569b2403e9a2508f5ac334e4ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ford","twitter_handle":"","website":"http://ford.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-24T23:26:15.015Z","bug_reporter_agreed_on_going_public_at":"2019-02-22T23:26:12.930Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Ford H1 team,\n\nI want to report a Subdomain takeover vulnerability in this report, a pretty serious security issue in some context.\n\n##Overview:\nOne of the ford.com subdomains is pointing to Azure, which has unclaimed CNAME record. ANYONE is able to own ford.com subdomain at the moment.\n\nThis vulnerability is called subdomain takeover. You can read more about it here:\n\nhttps://blog.sweepatic.com/subdomain-takeover-principles/\nhttps://labs.detectify.com/tag/hostile-subdomain-takeover/\nhttps://hackerone.com/reports/325336\n\n##Details:\nusclsapipma.cv.ford.com has CNAME usclsapipma.trafficmanager.net wich has a CNAME to feuscspma3fcvapi.eastus.cloudapp.azure.com. However, feuscspma3fcvapi.eastus.cloudapp.azure.com is not registered in Azure cloudapp Virtual machine anymore and thus can be registered as FQDN for a easus VM by anyone. After registering the Cloud App Virtual Machine in Azure portal, the person doing so has full control over traffic on dynatraceppeast01.cf.ford.com (so, not only HTTP/HTTPS but also mails traffic, etc, since we have full control over the virtual machine and it's OS).\n\n##Mitigation:\nRemove the CNAME record from ford.com DNS zone completely.\nOR\nClaim it back in Azure portal\n\n##Files : \nAzure-check-availability.png -\u003e Screenshot of the Azure website api \"check availability\" for the \"eastus\" cloudapp virtual machine. on the link, you can see the location \"eastus\" part of the fqdn ad the DomainNameLabel \"feuscspma3fcvapi\" part of the FQDN, and the \"available : true\" response for this fqdn.\ndns-proof.png -\u003e Result of a \"dig\" command for this domains, showing the \"NXDOMAIN\" reponse for the CNAME entry of the ford subdomain.\n\nCheers,\n\nMarch_42\n\n## Impact\n\nSubdomain takeover can be abused to do several things like :\n\nMalware distribution\nPhishing / Spear phishing\nXSS\nAuthentication bypass\nLegitimate mail sending and receiving on behalf of ford subdomain\n...\nList goes on and on.","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":410943,"file_name":"Azure-check-availability.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/410/943/7f0d28c84df73ae2a8c727ed3579b113047799fd/Azure-check-availability.png?response-content-disposition=attachment%3B%20filename%3D%22Azure-check-availability.png%22%3B%20filename%2A%3DUTF-8%27%27Azure-check-availability.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150449Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=7b7fe314486abd0d50fbb3b4b63edf9e52bbc15bfea1591bf6ed6cdf7c29a4bc","file_size":76853,"type":"image/png"},{"id":410944,"file_name":"dns-proof.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/410/944/205409789a8c5fb8cadf300f185f0352070e46c0/dns-proof.png?response-content-disposition=attachment%3B%20filename%3D%22dns-proof.png%22%3B%20filename%2A%3DUTF-8%27%27dns-proof.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150449Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=a3c1c770981f7593aa8171e5024d9b7823745861a8d51f315f504d2c2fac3097","file_size":85167,"type":"image/png"}],"allow_singular_disclosure_at":"2019-03-24T23:26:12.978Z","allow_singular_disclosure_after":-80494716.49848762,"singular_disclosure_allowed":true,"vote_count":96,"voters":["checkm50","d0kkillo","fousekis","sumgr0","cyber_humans","spam404","martinbydefault","dhakal_ananda","ali","hughesey","and 86 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":17626,"asset_type":"URL","asset_identifier":"*.ford.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4021894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My bad, i've made a mistake on this report, on \"detail\" section. here is the corrected part\n\n##Detail \n[...]\nAfter registering the Cloud App Virtual Machine in Azure portal, the person doing so has full control over traffic on ~~dynatraceppeast01.cf.ford.com~~  **usclsapipma.cv.ford.com** (so, not only HTTP/HTTPS but also mails traffic, etc, since we have full control over the virtual machine and it's OS).","automated_response":false,"created_at":"2019-01-23T05:12:07.803Z","updated_at":"2019-01-23T05:12:07.803Z","actor":{"username":"march","cleared":false,"url":"/march","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4022267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @march,\n\nThanks for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@lasagna ","automated_response":false,"created_at":"2019-01-23T08:17:11.678Z","updated_at":"2019-01-23T08:17:11.678Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4022269,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Can you upload a PoC page to prove your claim?","automated_response":false,"created_at":"2019-01-23T08:17:40.843Z","updated_at":"2019-01-23T08:17:40.843Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4025966,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @lasagna , here it is : http://usclsapipma.cv.ford.com/BHJAed55oazeDAZ02dDZ.txt\n\nTell me when i can shut down the Azure virtual, Azure price is relatively high.","automated_response":false,"created_at":"2019-01-23T18:11:25.120Z","updated_at":"2019-01-23T18:11:25.120Z","actor":{"username":"march","cleared":false,"url":"/march","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4026181,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Ford Motor Company appreciates your participation in our vulnerability disclosure program. We have received your submission and begun the process of remediation. We will strive to keep you informed of significant updates until remediation is complete.","automated_response":false,"created_at":"2019-01-23T18:43:39.153Z","updated_at":"2019-01-23T18:43:39.153Z","actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4026221,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-23T18:48:41.730Z","updated_at":"2019-01-23T18:48:41.730Z","additional_data":{"old_severity":"Critical (9.8)","new_severity":"High","old_severity_id":284714,"new_severity_id":285095},"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4026672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @lasagna ! Can you provide me the CVSS parameters you used to re-calculate From critical to high (if you have set via CVSS calculator, of course) ?\nIt's because i'm no totally sure at first how to classify this type of vulnerability and I want to improve the quality of my future report and correctly set the CVSS score at first post :)\n\nSame for \"Weakness\" also, since i'm not really sure that \"privilege escalation\" is the most appropriate weakness, since the \"Subdomain takeover\" (or at least \"DNS misconfiguration\", or something like that) are not available choice.\n\nThanks to you !\n\nCheers,\n\nMarch","automated_response":false,"created_at":"2019-01-23T20:05:40.808Z","updated_at":"2019-01-23T20:05:40.808Z","actor":{"username":"march","cleared":false,"url":"/march","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4187294,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ford Motor Company would again like to thank you for your participation in our vulnerability disclosure program. We have addressed your finding and moved this action to resolved. If you believe further remediation steps are required to resolve, please let us know as soon as possible. We appreciate the role you have played in helping to make Ford online services safer.","automated_response":false,"created_at":"2019-02-21T16:30:29.689Z","updated_at":"2019-02-21T16:30:29.689Z","actor":{"username":"b879cfa5bd63d89303a7b68","cleared":false,"url":"/b879cfa5bd63d89303a7b68","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"march","url":"/march"},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4195206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ! It's fixed ! Entry got deleted from ford's dns.","automated_response":false,"created_at":"2019-02-22T23:26:09.139Z","updated_at":"2019-02-22T23:26:09.139Z","actor":{"username":"march","cleared":false,"url":"/march","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4195207,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-02-22T23:26:12.952Z","updated_at":"2019-02-22T23:26:12.952Z","first_to_agree":true,"actor":{"username":"march","cleared":false,"url":"/march","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/588/be034e3969b8da4cf1ee07642861d19cb6944e12_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4382067,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-24T23:26:15.046Z","updated_at":"2019-03-24T23:26:15.046Z","actor":{"url":"/ford","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/812/579c6f8d1b50ac569b2403e9a2508f5ac334e4ec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ford"}},"genius_execution_id":null,"team_handle":"ford","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}