{"id":508493,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDg0OTM=","url":"https://hackerone.com/reports/508493","title":"Group admins can remove arbitrary data from \"data\" directory (including admin data)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-03-12T15:48:46.756Z","submitted_at":"2019-03-12T15:48:46.756Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"leonklingele","url":"/leonklingele","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15624"],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-12T15:15:22.336Z","bug_reporter_agreed_on_going_public_at":"2019-07-13T15:15:21.660Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Steps to reproduce:\n\n1. Create a new user and make him an admin of an arbitrary group\n2. Log in as this new user\n3. Create a new user \"files_external\", \"appdata_{random-data}\", ..\n4. Delete this user\n\nResult: The data/files_external / data/appdata{..} folder is removed.\n\nSolution: Prevent creation of users if data/{new-user-uid} is either\na file or a folder. In addition, prevent deletion of users where the\nuser data directory (data/{user}) contains other files and folders\nthan \"files\" (where the user data is stored).\n\n## Impact\n\nGroup admin can remove arbitrary data from \"data\" directory","vulnerability_information_html":"\u003cp\u003eSteps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new user and make him an admin of an arbitrary group\u003c/li\u003e\n\u003cli\u003eLog in as this new user\u003c/li\u003e\n\u003cli\u003eCreate a new user \u0026quot;files_external\u0026quot;, \u0026quot;appdata_{random-data}\u0026quot;, ..\u003c/li\u003e\n\u003cli\u003eDelete this user\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eResult: The data/files_external / data/appdata{..} folder is removed.\u003c/p\u003e\n\n\u003cp\u003eSolution: Prevent creation of users if data/{new-user-uid} is either\u003cbr\u003e\na file or a folder. In addition, prevent deletion of users where the\u003cbr\u003e\nuser data directory (data/{user}) contains other files and folders\u003cbr\u003e\nthan \u0026quot;files\u0026quot; (where the user data is stored).\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eGroup admin can remove arbitrary data from \u0026quot;data\u0026quot; directory\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-12T15:15:21.750Z","allow_singular_disclosure_after":-43599411.360468246,"singular_disclosure_allowed":true,"vote_count":29,"voters":["secator","sameerphad72","dhakal_ananda","arpeetrathii","brodie_codie","eveeez","japz","cryptographer","prindead","mohamedabogewela","and 19 more..."],"severity":{"rating":"high","score":8.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4308695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-03-12T15:48:47.418Z","updated_at":"2019-03-12T15:48:47.418Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4314888,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey Leon,\n\nRight yes we should do more sanity checks here. For now I have a PR that checks for the troublesome names. https://github.com/nextcloud/server/pull/14652\n\nChecking for the actual folders is a bit more tricky (but we'll discuss internally). As for example with objectstores etc it also needs to work.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHey Leon,\u003c/p\u003e\n\n\u003cp\u003eRight yes we should do more sanity checks here. For now I have a PR that checks for the troublesome names. \u003ca title=\"https://github.com/nextcloud/server/pull/14652\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F14652\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/14652\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eChecking for the actual folders is a bit more tricky (but we\u0026#39;ll discuss internally). As for example with objectstores etc it also needs to work.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T09:07:05.997Z","updated_at":"2019-03-13T09:07:05.997Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4429406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that – as explained in https://hackerone.com/reports/508491 – if Apache is used, the `.htaccess` file can be removed and therefore files inside the `data/` directory can be accessed. Even worse, arbitrary PHP code can be executed with permissions of the webserver user (e.g. `www-data`) by accessing `.php` files in a user directory.\nThis now qualifies for a \"Gaining remote code execution on the server as a non-admin user. (i.e. RCE)\" bounty.\n\nThe fix has not been released yet. Please do so. Thanks!","markdown_message":"\u003cp\u003ePlease note that – as explained in \u003ca title=\"https://hackerone.com/reports/508491\" href=\"https://hackerone.com/reports/508491\"\u003ehttps://hackerone.com/reports/508491\u003c/a\u003e – if Apache is used, the \u003ccode\u003e.htaccess\u003c/code\u003e file can be removed and therefore files inside the \u003ccode\u003edata/\u003c/code\u003e directory can be accessed. Even worse, arbitrary PHP code can be executed with permissions of the webserver user (e.g. \u003ccode\u003ewww-data\u003c/code\u003e) by accessing \u003ccode\u003e.php\u003c/code\u003e files in a user directory.\u003cbr\u003e\nThis now qualifies for a \u0026quot;Gaining remote code execution on the server as a non-admin user. (i.e. RCE)\u0026quot; bounty.\u003c/p\u003e\n\n\u003cp\u003eThe fix has not been released yet. Please do so. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-31T21:06:46.305Z","updated_at":"2019-03-31T21:06:46.305Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4542192,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What's the rationale for not including the fix in v15.0.7 (most recent stable) and v14.0.10 (most recent oldstable)? What kind of patches _do_ qualify for that if this one doesn't?","markdown_message":"\u003cp\u003eWhat\u0026#39;s the rationale for not including the fix in v15.0.7 (most recent stable) and v14.0.10 (most recent oldstable)? What kind of patches \u003cu\u003edo\u003c/u\u003e qualify for that if this one doesn\u0026#39;t?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T18:39:30.525Z","updated_at":"2019-04-11T18:39:30.525Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4542276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Backports are pending. That totally slipped","markdown_message":"\u003cp\u003eBackports are pending. That totally slipped\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-11T18:57:39.099Z","updated_at":"2019-04-11T18:57:39.099Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5087005,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Now that the fix is included in a release of every supported version, can this ticket be disclosed?","markdown_message":"\u003cp\u003eNow that the fix is included in a release of every supported version, can this ticket be disclosed?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-14T01:27:43.224Z","updated_at":"2019-06-14T01:27:43.224Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5156883,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-06-21T09:04:46.360Z","updated_at":"2019-06-21T09:04:46.360Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"leonklingele","url":"/leonklingele"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5156891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, sorry we are running low on capacity atm.\nI will clarify the reward next week in our contributor week and we will then proceed normally with our procedure.","markdown_message":"\u003cp\u003eYes, sorry we are running low on capacity atm.\u003cbr\u003e\nI will clarify the reward next week in our contributor week and we will then proceed normally with our procedure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-21T09:06:11.135Z","updated_at":"2019-06-21T09:06:11.135Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5267106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey – nice! And sure, here's my data:\n\nName: Leon Klingele\nEmail address: █████████","markdown_message":"\u003cp\u003eHey – nice! And sure, here\u0026#39;s my data:\u003c/p\u003e\n\n\u003cp\u003eName: Leon Klingele\u003cbr\u003e\nEmail address: █████████\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-07T13:30:54.992Z","updated_at":"2019-08-12T15:44:21.680Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5315344,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-13T15:15:21.698Z","updated_at":"2019-07-13T15:15:21.698Z","first_to_agree":true,"actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5556871,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-12T15:15:22.357Z","updated_at":"2019-08-12T15:15:22.357Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5916209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Another three months have passed, any news on this?","markdown_message":"\u003cp\u003eAnother three months have passed, any news on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-29T16:42:57.952Z","updated_at":"2019-09-29T16:42:57.952Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6407871,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-26T08:51:52.915Z","updated_at":"2019-11-26T08:51:52.915Z","additional_data":{"old_severity":"High","new_severity":"High (8.4)","old_severity_id":314897,"new_severity_id":575746},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6408530,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-26T09:15:28.672Z","updated_at":"2019-11-26T09:15:28.672Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"leonklingele","url":"/leonklingele"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6419144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! This report still looks far more severe than classified / awarded.\n\n### The obvious\n\nIt allows group admins to read, delete and modify arbitrary user data (see below), even those of admins and other group admins. This was partly illustrated in the initial report.\n\n### The not-so-obvious\n\nIt also allows for a privilege escalation to the webserver user (e.g. `www-data`) by all admins and group admins under Apache, even if set up following the official install instructions[0]. Please see my previous comment @ https://hackerone.com/reports/508493#activity-4429406 in that regard.\n\nThis can be abused in countless ways, for example:\n\n- log/steal user passwords (Nextcloud login, mail — if configured, etc.)\n- abuse the server for mail spam, phishing, cryptocurrency miners, etc.\n\nPlease confirm that you were aware of the this privilege escalation when assessing the issue.\n\n[0]: https://docs.nextcloud.com/server/17/admin_manual/installation/source_installation.html#apache-web-server-configuration","markdown_message":"\u003cp\u003eThanks! This report still looks far more severe than classified / awarded.\u003c/p\u003e\n\n\u003ch3 id=\"the-obvious\"\u003eThe obvious\u003c/h3\u003e\n\n\u003cp\u003eIt allows group admins to read, delete and modify arbitrary user data (see below), even those of admins and other group admins. This was partly illustrated in the initial report.\u003c/p\u003e\n\n\u003ch3 id=\"the-not-so-obvious\"\u003eThe not-so-obvious\u003c/h3\u003e\n\n\u003cp\u003eIt also allows for a privilege escalation to the webserver user (e.g. \u003ccode\u003ewww-data\u003c/code\u003e) by all admins and group admins under Apache, even if set up following the official install instructions\u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.nextcloud.com%2Fserver%2F17%2Fadmin_manual%2Finstallation%2Fsource_installation.html%23apache-web-server-configuration\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Please see my previous comment @ \u003ca title=\"https://hackerone.com/reports/508493#activity-4429406\" href=\"https://hackerone.com/reports/508493#activity-4429406\"\u003ehttps://hackerone.com/reports/508493#activity-4429406\u003c/a\u003e in that regard.\u003c/p\u003e\n\n\u003cp\u003eThis can be abused in countless ways, for example:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003elog/steal user passwords (Nextcloud login, mail — if configured, etc.)\u003c/li\u003e\n\u003cli\u003eabuse the server for mail spam, phishing, cryptocurrency miners, etc.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlease confirm that you were aware of the this privilege escalation when assessing the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-27T08:58:52.458Z","updated_at":"2019-11-27T08:58:52.458Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6419450,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Leon,\n\nI am totally aware of the not-so-obvious part. However admins have Remote-Code-Execution by default as they can install any malicious source code as an app from the appstore with just one click.\nWith this they can run any code as www-data independent whether the data directory is moved outside of the webroot or not, whether apache or nginx is used, etc.\n\nSo from my understanding it boils down to be able to break the instance by accident rather then intend.","markdown_message":"\u003cp\u003eHi Leon,\u003c/p\u003e\n\n\u003cp\u003eI am totally aware of the not-so-obvious part. However admins have Remote-Code-Execution by default as they can install any malicious source code as an app from the appstore with just one click.\u003cbr\u003e\nWith this they can run any code as www-data independent whether the data directory is moved outside of the webroot or not, whether apache or nginx is used, etc.\u003c/p\u003e\n\n\u003cp\u003eSo from my understanding it boils down to be able to break the instance by accident rather then intend.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-27T09:52:00.492Z","updated_at":"2019-11-27T09:52:00.492Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6419740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Joas and thank you for your response.\n\n\u003eHowever admins have Remote-Code-Execution by default as they can install any malicious source code as an app from the appstore with just one click.\n\nWhile this is true you didn't mention _group_ admins. It's clearly a privilege escalation for them, no? What makes them any different than regular administrators?","markdown_message":"\u003cp\u003eHi Joas and thank you for your response.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eHowever admins have Remote-Code-Execution by default as they can install any malicious source code as an app from the appstore with just one click.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWhile this is true you didn\u0026#39;t mention \u003cu\u003egroup\u003c/u\u003e admins. It\u0026#39;s clearly a privilege escalation for them, no? What makes them any different than regular administrators?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-27T10:51:16.113Z","updated_at":"2019-11-27T10:51:41.958Z","actor":{"username":"leonklingele","cleared":false,"url":"/leonklingele","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}