{"id":689314,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODkzMTQ=","url":"https://hackerone.com/reports/689314","title":"Project Template functionality can be used to copy private project data, such as repository, confidential issues, snippets, and merge requests","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-09-06T05:40:41.068Z","submitted_at":"2019-09-06T05:40:41.068Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-11-27T10:02:44.156Z","bug_reporter_agreed_on_going_public_at":"2019-10-11T17:25:06.264Z","team_member_agreed_on_going_public_at":"2019-11-27T10:02:44.060Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I've found a three minor vulnerabilities which, when combined, allow an attacker to copy private repositories, confidential issues, private snippets, and then some. I'll go through the code path to explain the vulnerabilities and how they are combined. See the **Proof of Concept** section if you want to reproduce it immediately.\n\nLet's start at the `ProjectsController` of EE, which is prepended to `app/controllers/projects_controller.rb` in an EE instance. \n\n**ee/app/controllers/ee/projects_controller.rb**\n```ruby\noverride :project_params_attributes\n    def project_params_attributes\n      super + project_params_ee\n    end\n\ndef project_params_ee\n  attrs = %i[\n    # ...\n    use_custom_template\n    # ...\n    group_with_project_templates_id\n  ]\n\n  # ...\n\n  attrs\nend\n```\n\nThis method defines what parameters can be passed by the user. The two notable parameters here are `use_custom_template` and `group_with_project_templates_id`. This method appends the result value of `project_params_attributes` method in `app/controllers/projects_controller.rb` on line 351, which specifies all the CE attributes a user can provide when creating a project. The CE controller allows the `template_name` parameter to be passed, too. This means that these three parameters can be passed to the `Projects::CreateService` in the `create` method:\n\n**app/controllers/projects_controller.rb**\n```ruby\ndef create\n  @project = ::Projects::CreateService.new(current_user, project_params(attributes: project_params_create_attributes)).execute\n\n  # ...\nend\n\n# ...\n\ndef project_params_attributes\n  [\n    # ...\n    :template_name,\n    # ...\n  ]\n```\n\nIn EE, the `EE:Projects::CreateService` is prepended to the `Projects::CreateService`. The prepended EE code contains logic to validate the `use_custom_template` and `group_with_project_templates_id` parameters.\n\n**ee/app/services/ee/projects/create_service.rb**\n```ruby\ndef execute\n  # ...\n\n  group_with_project_templates_id = params.delete(:group_with_project_templates_id) if params[:template_name].blank?\n\n  # ...\n\n    validate_namespace_used_with_template(project, group_with_project_templates_id)\nend\n\n# ...\n\ndef validate_namespace_used_with_template(project, group_with_project_templates_id)\n  return unless project.group\n\n  subgroup_with_templates_id = group_with_project_templates_id || params[:group_with_project_templates_id]\n  return if subgroup_with_templates_id.blank?\n\n  templates_owner = ::Group.find(subgroup_with_templates_id).parent\n\n  unless templates_owner.self_and_descendants.exists?(id: project.namespace_id)\n    project.errors.add(:namespace, _(\"is not a descendant of the Group owning the template\"))\n  end\nend\n```\n\nThe code above is where the first vulnerability can be found. In a normal situation, a Project Template can only be copied to a namespace (group) that is a descendant of the project template. However, the `validate_namespace_used_with_template` method returns a `nil` value when the project is **not** being created for a group (`return unless project.group`). This means that if a `group_with_project_templates_id` is given for a project that is created in a `User` namespace, the authorization / validation logic is never executed. This means that the `use_custom_template` and `group_with_project_templates_id` parameters remain to be set on the instance variable `params`.\n\nBecause the EE code is prepended, the `execute` method is executed before the `Projects::CreateService` is called. Because the EE class its validation logic is bypassed, the `execute` method of the `Projects::CreateService` class is called:\n\n**app/services/projects/create_service.rb**\n```ruby\ndef execute\n  if @params[:template_name].present?\n    return ::Projects::CreateFromTemplateService.new(current_user, params).execute\n  end\n\n  # ...\nend\n```\n\nWhen a `template_name` is given, instead of executing the normal execution flow, the result of `Projects::CreateFromTemplateService` is returned. The CE code for this class isn't very important. The EE class contains the logic that is worth checking out:\n\n**ee/app/services/ee/projects/create_from_template_service.rb**\n```ruby\ndef execute\n  return super unless use_custom_template?\n\n  override_params = params.dup\n  params[:custom_template] = template_project if template_project\n\n  ::Projects::GitlabProjectsImportService.new(current_user, params, override_params).execute\nend\n\nprivate\n\ndef use_custom_template?\n  # ...\n    template_name \u0026\u0026\n      ::Gitlab::Utils.to_boolean(params.delete(:use_custom_template)) \u0026\u0026\n      ::Gitlab::CurrentSettings.custom_project_templates_enabled?\n  # ...\nend\n\ndef template_project\n  # ...\n    current_user.available_custom_project_templates(search: template_name, subgroup_id: subgroup_id)\n                .first\n  # ...\nend\n\ndef subgroup_id\n  params[:group_with_project_templates_id].presence\nend\n```\n\nThis class does a couple of things: it makes sure a custom template name is given, that it should use the given template name, and that the GitLab instance has custom project templates enabled. For what it's worth: gitlab.com has this setting enabled. When it passes those checks, the `template_project` method is invoked. Here is the definition of the `available_custom_project_templates` method:\n\n**ee/app/models/ee/user.rb**\n```ruby\ndef available_custom_project_templates(search: nil, subgroup_id: nil)\n  templates = ::Gitlab::CurrentSettings.available_custom_project_templates(subgroup_id)\n\n  ::ProjectsFinder.new(current_user: self,\n                       project_ids_relation: templates,\n                       params: { search: search, sort: 'name_asc' })\n                  .execute\nend\n```\n\nThis method requires two parameters: `search` and `subgroup_id`. The first one is the `template_name` the user passes, the second one `group_with_project_templates_id`. The `templates` variable gets its value based on the following method definition:\n\n**ee/app/models/ee/application_setting.rb**\n```ruby\ndef available_custom_project_templates(subgroup_id = nil)\n  group_id = subgroup_id || custom_project_templates_group_id\n\n  return ::Project.none unless group_id\n\n  ::Project.where(namespace_id: group_id) \nend\n```\n\nThis method will return all `Project` models based on the `namespace_id` that is provided in the `subgroup_id` parameter. This is then passed to the `ProjectsFinder` in the `available_custom_project_templates` method on the `User` model. This is where the second vulnerability can be found. The `ProjectsFinder` uses an initial collection, which consists of the projects the authenticated user can access. However, it does **not** check the access level of the user. This means that any project that is public, but has Repository, Issue, Snippets (etc.) access disabled for Guests, will be returned by the `available_custom_project_templates` method on the `User` model. In a perfect world, it seems that this method would limit the projects that can be returned based on the user's permissions for said projects.\n\nIf we go back to the `EE:Projects::CreateFromTemplateService` file, you can see that the `template_project` will return the first project that is returned by the `available_custom_project_templates` method. This means that `params[:custom_template]` may contain a `Project` model that the user is not authorized to see everything for. The `EE::Projects::CreateFromTemplateService` class then calls the `Projects::GitlabProjectsImportService` class with the updated parameters.\n\n**ee/app/services/ee/projects/gitlab_projects_import_service.rb**\n```ruby\ndef execute\n  super.tap do |project|\n    if project.saved? \u0026\u0026 custom_template\n      custom_template.add_export_job(current_user: current_user,\n                                     after_export_strategy: export_strategy(project))\n    end\n  end\nend\n\nprivate\n\noverride :prepare_import_params\ndef prepare_import_params\n  super\n\n  if custom_template\n    params[:import_type] = 'gitlab_custom_project_template'\n  end\nend\n\ndef custom_template\n  strong_memoize(:custom_template) do\n    params.delete(:custom_template)\n  end\nend\n\ndef export_strategy(project) \n Gitlab::ImportExport::AfterExportStrategies::CustomTemplateExportImportStrategy.new(export_into_project_id: project.id)\nend\n```\n\nThis EE class is prepended, but uses `super.tap` to call the CE code (`super`) and then taps into the result of the CE code. If `params[:custom_template]` has been set and the project was successfully saved by the `super` call, an export job is scheduled for the `custom_template` that was returned by the `ProjectsFinder`. It's worth nothing that at this point the user may not be authorized to see the code, issues, etc., of the project. Additionally, an export strategy is passed that imports the export file in the newly created project.\n\nThis is where the third vulnerability can be found. When an export job is scheduled, it assumes the user is authorized to make the export. Ideally, the Sidekiq job (`ProjectExportWorker`) that is scheduled would do an authorization check to make sure that the user is authorized to export the project. This would also avoid a TOCTOU issue where the user schedules a job when the queue is clogged / Sidekiq workers are paused and would leave the project before the job is executed. When the export is created, it'll automatically be imported in the project that the user has full access to.\n\nCombined, these vulnerabilities results in an attacker being able to obtain any confidential information that is included in a project export. This vulnerability **only** works for public projects with limited access levels for repositories, issues, pipelines, merge requests (and more) that belong to a group. A good example of this would be `gitlab-org`, `gitlab-data`, `gitlab-com`, on gitlab.com. There are plenty of repositories, such as https://gitlab.com/gitlab-com/finance (see below), that are public but don't expose the repository, issues, and merge requests.\n\n{F576178}\n\n# Proof of Concept\nTo reproduce this vulnerability:\n\n* sign in as a normal user and create a group, let's assume this is group ID 1\n* within this group, create a public project named `test_project`\n* under **Settings \u003e General** update the **Visibility, project features, permissions** to only allow Issues, Repository, Wiki, and Snippets to be seen by **Only Project Members**:\n\n{F576180}\n\n* sign into another account and go to http://instance/projects/new\n* create a new project and intercept the request, it'll look something like this (I've left out unimportant parameters):\n\n```\nPOST /projects HTTP/1.1\nHost: instance\n...\n\n----------506740453\nContent-Disposition: form-data; name=\"project[use_custom_template]\"\n\nfalse\n----------506740453\nContent-Disposition: form-data; name=\"project[template_name]\"\n\n----------506740453\nContent-Disposition: form-data; name=\"project[group_with_project_templates_id]\"\n\n----------506740453\nContent-Disposition: form-data; name=\"project[name]\"\n\nproject_name\n----------506740453\nContent-Disposition: form-data; name=\"project[namespace_id]\"\n\n1\n----------506740453\nContent-Disposition: form-data; name=\"project[path]\"\n\nproject_name\n----------506740453--\n```\n\n* in this request, change `use_custom_template` to `true`, the `template_name` to the name the victim gave to the project (`test_project`), and `group_with_project_templates_id` to the group ID of the public group the victim created (`1`). When forwarded, the server will respond with a redirect and, when followed, show a page indicating that the project is being imported:\n\n{F576184}\n\nDepending on the size of the project and how busy the queues are, it can take a couple of minutes to generate the export of the project and then import it to the new project. Come back in a couple minutes and find the repository, confidential issues, private snippets, merge requests, CI pipelines, and more being copied to the attacker's project.\n\n**Redacted copy of `gitlab-com/finance`**\n{F576189}\n\n## Impact\n\nAny access level that has been put in place for projects the user can access can be bypassed using this vulnerability. According to the documentation, this means that the following information can be obtained:\n\n* Project and wiki repositories\n* Project uploads\n* Project configuration, including services\n* Issues with comments, merge requests with diffs and comments, labels, milestones, snippets, and other project entities\n* LFS objects\n* Issue Boards\n\n{F576190}","bounty_amount":"12000.0","formatted_bounty":"$12,000","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":576178,"file_name":"Screen_Shot_2019-09-05_at_10.08.18_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YJg2MxMjQFVWz8m31AMTNF2n?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-09-05_at_10.08.18_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-09-05_at_10.08.18_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=756cb436808b9ad59b06c9cd45e63261a22361dbdcbcb2dc3d1be74452ad7b17","file_size":42822,"type":"image/png"},{"id":576180,"file_name":"Screen_Shot_2019-09-05_at_10.13.21_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/56DQDWBuNn7wzkMA2XHp4Hav?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-09-05_at_10.13.21_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-09-05_at_10.13.21_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=30c878a1a2442d6f2c02db9e0dc97fa7e393f0e606e5310e62f8b7ce89a2a877","file_size":77342,"type":"image/png"},{"id":576184,"file_name":"Screen_Shot_2019-09-05_at_10.17.09_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7iEDiBFgHrATxZkkAtqhmNhR?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-09-05_at_10.17.09_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-09-05_at_10.17.09_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=baef847e9f01e1aaf78a164c511e59c716b999894d07d053fd599fae5d78b1bc","file_size":14209,"type":"image/png"},{"id":576189,"file_name":"Screen_Shot_2019-09-05_at_10.19.15_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/U4T78d2Ai7e5K5WrkV3tQn2D?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-09-05_at_10.19.15_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-09-05_at_10.19.15_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ecc44ec7328f45cdb1e9c7eedea9a168b7faef54b8003dbb7e80d68f3edbf1fc","file_size":81598,"type":"image/png"},{"id":576190,"file_name":"cat.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7cGEg6PnngXDrDJvUgGvLtdx?response-content-disposition=attachment%3B%20filename%3D%22cat.gif%22%3B%20filename%2A%3DUTF-8%27%27cat.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3f2a0b0074752160011532047c2417f6a33deb8310083bf27673efc04dc76b5a","file_size":743883,"type":"image/gif"}],"allow_singular_disclosure_at":null,"vote_count":431,"voters":["honoki","overjt","mirchr","feedadad","mvalle","act1on3","pyrrhon","sky003","arm4nd0","physuru","and 421 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":5744177,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 10 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-09-06T06:19:30.933Z","updated_at":"2019-09-06T06:19:30.933Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5746089,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @jobert,\n\nThank you for this amazing report.\n\nWe have verified this finding and our engineering team is working on a fix ASAP.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab-ce/issues/67109. \n\nBest regards,\nGitLab Security Team","automated_response":false,"created_at":"2019-09-06T11:40:17.687Z","updated_at":"2019-09-06T11:40:17.687Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5751989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert  ,\n\nWe've deployed a hotpatch on production, can you verify if this mitigates the immediate problem?\n\nThanks again!\nJames\n","automated_response":false,"created_at":"2019-09-07T03:39:09.501Z","updated_at":"2019-09-07T03:39:09.501Z","actor":{"username":"jritchey","cleared":false,"url":"/jritchey","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5752039,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @jobert,\n\nThe GitLab issue created from your report is currently scheduled for 2019-09-22.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2019-09-07T04:20:25.001Z","updated_at":"2019-09-07T04:20:25.001Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5754418,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jritchey and @jmatos_bgtvf - I'm not able to reproduce the security vulnerability anymore. Great turnaround time! When I tried to reproduce it, I'm seeing an error when creating the project.\n\n{F577306}\n\nI've also tried working around the patch by adding myself as a Guest of a subgroup and a Developer of the parent and then trying to export a confidential issue of a Project in the subgroup (not available by default for Guest users). However, because permissions trickle down to its descendants, I'm automatically granted Developer rights on the subgroup as well.\n\nIf you have code available somewhere, I'm happy to check that out, too.","automated_response":false,"created_at":"2019-09-07T19:09:28.954Z","updated_at":"2019-09-07T19:09:28.954Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"attachments":[{"id":577306,"filename":"Screen_Shot_2019-09-07_at_11.57.32_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RhHaHgvzySezVW2Z5LdBqDcr?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-09-07_at_11.57.32_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-09-07_at_11.57.32_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d77dcf764cfce39e2f5e5dcdb137e02811333fe2759c48c04b85ba25fbf5fdfb"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5759908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert - thanks for validating. Attached is the code change to fix the vuln. Do you see any problem?\n\nThanks,\nDennis\n\n","automated_response":false,"created_at":"2019-09-09T09:04:41.073Z","updated_at":"2019-09-09T09:04:41.073Z","actor":{"username":"dappelt","cleared":false,"url":"/dappelt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":578278,"filename":"Screenshot_2019-09-09_at_11.00.42.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gxM2aJyoPibDWR3N3FyCsVQY?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2019-09-09_at_11.00.42.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2019-09-09_at_11.00.42.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZV3IBMDT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T151756Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIHx%2BIgfH0%2FRLQqbPD5vv6PNps92HY0yneL0kxkNwZHOyAiALrXRJqTvQQGm0xEkYGCB0kbPjUCCkzSeRztvcuetAYyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIM5FTPTB1nK4gXIBLuKtcDHmLbKhsWpyXKgWy1fAYOf0DZEqCEqF9ns7RwihS1bFM9%2BSDXYY0CmIqutWQhK5asoL8jbJZ39%2FJ2eai2SoxTlg3PhjMpNNSUfPFgauwX6vt%2FoeK9VnB1Hmqg6bCNA62qIJPnlTONluGngv604Y6CnYL9Se%2B%2BjgOpqhqmIOX9KlzGAoRM0Ci%2BrWGdELH8Q66bSHmapdLHPWMoGBEj%2BeruK3oCs%2BDaUQ1aE%2FEQ8R5PgqLM3Pq6DrZV9PlFixmkikk8SpDcsFEiT0Zw0gsy2qPz3z3BHAEuG64GguAhIs5FvYP7HbdpPv7rQz4QSDXgN3SIbVD0A4kcV1iNQpZyiw2rmdxuUWIk46d%2FT0u%2B7j9yAdfpDuPVKPDHJD35k0pB6VLe7RtlSwwvcDUa7LL6FJxvOPpupIMPSy51BJl9%2Bf8022a6pcy263zeRDGJjALAc6brW%2BvQoDUu%2FQP%2BdxwOLZvXCyyGJp2%2BK86jg8qU%2FLWZ4DVeR3bIO1n7Fw%2B53iFlBIMatC3ZSLlV1J7dSDCk74u6OWvql%2Brvb6q%2Bj8NHQK6luFckQV%2B9okMhTYuNniW3sHS8rjyNrrGhP8vMtxMzink9EL%2FmU0Oxusg2wmaXCDfIKpDDmspvZQv8MJ%2F%2FkIsGOqYBaz2hfRV48KDU0Mx0UomuXdEWK6oszm51EnI%2FeSepVmINgIWWggB7gENawN0rgfpMSIqQjB%2BpErtoDw1jNWaknZlAG9GLkCZ49lNHNirjr7iPk7LouunUzSZjaag8Yc19L8BAWjyLZnHXpqUZQRBSoqOcAoct3F46M7AzK2ewXHmh7aKY3cfAQTu9yVTJd2CDpuLtlyUDUa37BJ8%2F84puzgJS34jmeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1680f3e64340560a45844540d0fc152a65f591118d32ab2c64b7648c30f87939"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5761930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jobert,\n\nThis is the fix for the 1st vulnerability of your exploit chain. We have created 2 other issues with lower priority for the 2 other vulnerabilities you used (https://gitlab.com/gitlab-org/gitlab-ee/issues/14861 and https://gitlab.com/gitlab-org/gitlab-ee/issues/14860).\n\nDo not hesitate to let us know if you believe fixing first only this vulnerability is a bad idea.\n\nThank you again,\nJeremy","automated_response":false,"created_at":"2019-09-09T13:22:57.788Z","updated_at":"2019-09-09T13:22:57.788Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5765846,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dappelt and @jmatos_bgtvf - thanks for sending over the code. It didn't help me identify a bypass for the original vulnerabilities that I reported, but it did point out a potential new one. A new `Project` model gets initialized with `params`, which may lead to a mass-assignment vulnerability. E.g. the `namespace_id` validation hasn't run yet when that code gets executed, which means that if someone would provide a `namespace_id` that doesn't belong to them, the view will render with a `@project` instance variable that, if it'd call `namespace`, would return a namespace the user may not be authorized to see. I personally wouldn't rely on that logic, so you might want to stay away from initializing the model with the raw parameters *or* run the additional authorization checks before initializing the model. Hope that helps!","automated_response":false,"created_at":"2019-09-09T20:22:18.546Z","updated_at":"2019-09-09T20:22:18.546Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5780728,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-09-11T15:42:44.407Z","updated_at":"2019-09-11T15:42:44.407Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"12000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"jobert","url":"/jobert"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5780872,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @jobert,\n\nThank you again for the excellent report! Your finding has been mitigated in GitLab versions 12.2.5, 12.1.9, and 12.0.9, and we are awarding a $12,000 bounty. Congratulations!\n\nThe mitigation put is a revised version of the fix put in place on Friday. As Jeremy noted, we still have two more outstanding issues related to the report. We are planning to make all of the GitLab issues public once they are all fixed.\n\nFor this report, we are going to mark as Resolved since the primary impact is mitigated. We do request that we hold off on making it public in 30 days since it includes some outstanding vulns. What do you think?\n\nPlease let us know if you find that the revised patch does not mitigate your finding.\n\nWe look forward to your next report!\n\nBest regards,\nEthan\nSecurity Team | GitLab Inc.\n\n\n","automated_response":false,"created_at":"2019-09-11T16:09:01.778Z","updated_at":"2019-09-11T16:09:01.778Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5780888,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @estrike - thanks for the bounty, much appreciated! Holding off on the disclosure until the other issues are remediated is fine with me. Let's check in again in 30 days to see where you're at. Let me know if you need any additional reviews, happy to help.","automated_response":false,"created_at":"2019-09-11T16:13:53.582Z","updated_at":"2019-09-11T16:13:53.582Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6017279,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @estrike - hope all is well! It's been 30 days since the release of the security advisory and the new version. Requesting disclosure as per your last comment. Thanks!","automated_response":false,"created_at":"2019-10-11T17:25:06.298Z","updated_at":"2019-10-11T17:25:06.298Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6018217,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert ,\n\nI just checked the remaining two issues, and unfortunately they are still open. We will review those with the development team, to get those fixes scheduled. I am not going to disclose or cancel the disclosure request at the moment, in hopes that we can get them addressed within the 30 day window. We will keep you updated here as we progress towards getting them fixed. Thank you for your patience as we work towards mitigating each of the findings in this report.\n\nBest Regards,\nEthan","automated_response":false,"created_at":"2019-10-11T19:21:38.313Z","updated_at":"2019-10-11T19:21:38.313Z","actor":{"username":"estrike","cleared":false,"url":"/estrike","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6413735,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @estrike - is there an update you can provide on the remaining tickets? Let me know if there's anything I can help with here. Thanks!","automated_response":false,"created_at":"2019-11-26T16:26:55.199Z","updated_at":"2019-11-26T16:26:55.199Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6419493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jobert,\n\nApologies for the delay as the 2 lower priority issues have not been addressed yet.\nIn order not to wait further, we have decided to accept disclosure.\n\nThank you again for this amazing report.\n\nBest Regards,\nJeremy","automated_response":false,"created_at":"2019-11-27T10:01:49.641Z","updated_at":"2019-11-27T10:01:49.641Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6419498,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-27T10:02:44.091Z","updated_at":"2019-11-27T10:02:44.091Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6419499,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-11-27T10:02:44.181Z","updated_at":"2019-11-27T10:02:44.181Z","actor":{"username":"jmatos_bgtvf","cleared":false,"url":"/jmatos_bgtvf","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}