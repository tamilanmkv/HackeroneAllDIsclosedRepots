{"id":790634,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTA2MzQ=","url":"https://hackerone.com/reports/790634","title":"When you call your branch the same name as a git hash, it could be checked out by dependents","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-02-07T16:49:44.872Z","submitted_at":"2020-02-07T16:49:44.872Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"retroplasma","url":"/retroplasma","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-08-19T21:09:21.671Z","bug_reporter_agreed_on_going_public_at":"2021-08-19T21:04:39.786Z","team_member_agreed_on_going_public_at":"2021-08-19T21:09:21.479Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nIf we call a branch the same name like a git hash then the moment it's checked out somewhere, git prefers the branch name.\nSo let's say the git hash is \"e91803d442559d6efb63102b10c919e10901b01d\".\nAnd someone referenced that hash in their program.\nNow the developer or a hacker with access to the repo can create a branch named \"e91803d442559d6efb63102b10c919e10901b01d\".\nGit will checkout the branch and not the hash when someone puts \"git checkout e91803d442559d6efb63102b10c919e10901b01d\".\nGitHub prevents users from pushing branches that are the same name as hashes, but GitLab does not.\n\n### Steps to reproduce\n\n(Step-by-step guide to reproduce the issue, including:)\n\n1. Take a hash of a commit A\n2. Go to any other commit B\n3. Create a branch that is named the same as the hash from commit A\n4. Push\n5. If someone references the hash in their program, their \"git checkout\" will checkout commit B. Because it will use the branch name instead of the hash\n\n\n### Impact\n\nReferencing a hash isn't secure anymore. It would reference a branch that has completely different data.\ngit shows a warning but \"git checkout {...}\" is often used.\n\n### Examples\n\nAny project that refs a git ref\n\n### What is the current *bug* behavior?\n\nGitlab accepts pushed branches that are 40-char hexadecimals\n\n### What is the expected *correct* behavior?\n\nGitlab shouldn't accept pushed branches that are 40-char hexadecimals (like Github does9\n\n### Relevant logs and/or screenshots\n\n-\n\n### Output of checks\n\n-\n\n#### Results of GitLab environment info\n\n-\n\n## Impact\n\nRedirect pinned refrs of libraries if there is control of a library. A referenced hash won't point to a hash anymore. An attacker can make the branch which has the hash's name contain any other data.","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":72,"name":"Resource Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":39,"voters":["arw9234","th3hidd3nmist","pyrrhon","n1m0","w31rd0","fqdn","cupc4k3","bl4de","ali","mattberg","and 29 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6990109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i dont know how to confirm hackerone's \"human augmented signal\" nag, but the issue is real","automated_response":false,"created_at":"2020-02-07T17:01:16.900Z","updated_at":"2020-02-07T17:02:59.013Z","actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6990916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @retroplasma,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 7 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-02-07T18:05:56.281Z","updated_at":"2020-02-07T18:05:56.281Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6992694,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @retroplasma,\n\nThank you for submitting this report.\n\n\u003e Git will checkout the branch and not the hash when someone puts \"git checkout e91803d442559d6efb63102b10c919e10901b01d\".\n\nI am not able to reproduce this, when I `git checkout hash` I get the commit and not the branch. What version of git are you using (`git --version`)?\n\nAre you able to build a public repository on GitLab that would demonstrate the behavior you described? It would be very helpful for triage and for the engineering team.\n\nThank you,\nDominic\nSecurity Team | GitLab","automated_response":false,"created_at":"2020-02-07T22:37:00.894Z","updated_at":"2020-02-07T22:37:00.894Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6992745,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-02-07T22:49:43.309Z","updated_at":"2020-02-07T22:49:43.309Z","additional_data":{"added_weaknesses":[{"id":72,"name":"Resource Injection"}],"removed_weaknesses":[]},"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6997657,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dcouture,\n\nhere's the version:\n```\n$ git --version\ngit version 2.21.1 (Apple Git-122.3)\n```\n\nCommands to reproduce:\n```\n$ mkdir demo\n$ cd demo\n$ git init\nInitialized empty Git repository\n$ echo hi \u003e file\n$ git add file\n$ git commit -m initial\n[master (root-commit) 11f072f] initial\n 1 file changed, 1 insertion(+)\n create mode 100644 file\n$ echo ho \u003e file\n$ git add file\n$ git checkout -b A\nM\tfile\nSwitched to a new branch 'A'\n$ git commit -m modify\n[A 8c469aa] modify\n 1 file changed, 1 insertion(+), 1 deletion(-)\n$ git rev-parse HEAD\n8c469aaf789ed8e666d77a152fe2b542693463c2\n$ git checkout master\nSwitched to branch 'master'\n$ echo huh \u003e file\n$ git add file\n$ git checkout -b 8c469aaf789ed8e666d77a152fe2b542693463c2\nM\tfile\nSwitched to a new branch '8c469aaf789ed8e666d77a152fe2b542693463c2'\n$ git commit -m modify2\n[8c469aaf789ed8e666d77a152fe2b542693463c2 48e67f3] modify2\n 1 file changed, 1 insertion(+), 1 deletion(-)\n$ git checkout master\nSwitched to branch 'master'\n$ cat file\nhi\n$ git checkout 8c469aaf789ed8e666d77a152fe2b542693463c2\nwarning: refname '8c469aaf789ed8e666d77a152fe2b542693463c2' is ambiguous.\nGit normally never creates a ref that ends with 40 hex characters\nbecause it will be ignored when you just specify 40-hex. These refs\nmay be created by mistake. For example,\n\n  git checkout -b $br $(git rev-parse ...)\n\nwhere \"$br\" is somehow empty and a 40-hex ref is created. Please\nexamine these refs and maybe delete them. Turn this message off by\nrunning \"git config advice.objectNameWarning false\"\nSwitched to branch '8c469aaf789ed8e666d77a152fe2b542693463c2'\n$ cat file\nhuh\n```\n\nAn example remote repo pushed (push not possible with github, but gitlab). The cloned repo behaves like local one after branches are tracked:\nhttps://gitlab.com/retroplasma/demo-790634/\n","automated_response":false,"created_at":"2020-02-08T20:56:59.758Z","updated_at":"2020-02-08T20:56:59.758Z","actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6997663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Github response: `remote: error: GH002: Sorry, branch or tag names consisting of 40 hex characters are not allowed.`","automated_response":false,"created_at":"2020-02-08T20:58:54.855Z","updated_at":"2020-02-08T20:58:54.855Z","actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7011600,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-02-10T20:27:15.277Z","updated_at":"2020-02-10T20:27:15.277Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":627064,"new_severity_id":629264},"actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7011601,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team.  We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/issues/202690.  This issue will be made public 30 days following the release of a patch.\n\nGiven the severity of the report, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nThe severity was changed to medium because doing this requires having the `Developer` role on the project which greatly limits the number of people who can execute the attack.\n\nBest regards,\nSecurity Team | GitLab Inc.","automated_response":false,"created_at":"2020-02-10T20:27:18.014Z","updated_at":"2020-02-10T20:27:18.014Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7011605,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Initial $1000 on triage","automated_response":false,"created_at":"2020-02-10T20:27:39.870Z","updated_at":"2020-02-10T20:27:39.870Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"retroplasma","url":"/retroplasma"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7025167,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, thank you! :)","automated_response":false,"created_at":"2020-02-11T21:43:06.417Z","updated_at":"2020-02-11T21:43:06.417Z","actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7215320,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@dcouture on a side note: The UI seems a bit confused in this case whether it's on the branch or on the hash: https://gitlab.com/retroplasma/demo-790634/-/tree/861ff139929c0a9dcb7ca69fbe59c0752ce4bfd3. It shows the file contents from the hash commit, but it also says that it's on the branch (in the dropdown) and on the commit hash from the URL at the same time. Gitlab file edit mode is similar.","automated_response":false,"created_at":"2020-03-04T10:16:34.296Z","updated_at":"2020-03-04T10:20:53.960Z","actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7227214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @retroplasma,\n\nThank you for the additional details, I've added them to our internal issue.\n\nBest regards,\nDominic\nSecurity Team | GitLab ","automated_response":false,"created_at":"2020-03-04T17:36:19.889Z","updated_at":"2020-03-04T17:36:19.889Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7406007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @retroplasma,\n\nThe issue you reported is currently scheduled to be fixed by 2020-06-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-03-24T04:06:36.250Z","updated_at":"2020-03-24T04:06:36.250Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8058357,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @retroplasma,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nWe will continue to keep you updated via HackerOne as a fix is scheduled.\n\nBest regards,\nDominic\nSecurity Team | GitLab Inc.\n","automated_response":false,"created_at":"2020-05-20T12:55:57.677Z","updated_at":"2020-05-20T12:55:57.677Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"retroplasma","url":"/retroplasma"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8475622,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @retroplasma,\n\nThe issue you reported is currently scheduled to be fixed by 2020-07-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","automated_response":true,"created_at":"2020-07-02T04:21:30.892Z","updated_at":"2020-07-02T04:21:30.892Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8866453,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @retroplasma,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.2.3. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nVitor\nGitLab Security Team","automated_response":false,"created_at":"2020-08-06T15:04:01.611Z","updated_at":"2020-08-06T15:04:01.611Z","actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"retroplasma","url":"/retroplasma"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13078140,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this?","automated_response":false,"created_at":"2021-08-19T21:04:39.818Z","updated_at":"2021-08-19T21:04:39.818Z","first_to_agree":true,"actor":{"username":"retroplasma","cleared":false,"url":"/retroplasma","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13078184,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2021-08-19T21:09:21.507Z","updated_at":"2021-08-19T21:09:21.507Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13078186,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-08-19T21:09:21.725Z","updated_at":"2021-08-19T21:09:21.725Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}