{"id":363815,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjM4MTU=","url":"https://hackerone.com/reports/363815","title":"Blind SQL injection and making any profile comments from any users to disappear using \"like\" function (2 in 1 issues)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-06-09T21:20:53.964Z","submitted_at":"2018-06-09T21:20:53.964Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24231,"url":"https://hackerone.com/tube8","handle":"tube8","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/231/560f66744dedfa26f5f87d042a1caf6bef28d673_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/231/560f66744dedfa26f5f87d042a1caf6bef28d673_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tube8","twitter_handle":"Tube8","website":"https://www.tube8.com","about":"Tube 8 offers the world's best porn videos, entirely free and always updating them every day."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-11T15:27:20.936Z","bug_reporter_agreed_on_going_public_at":"2019-07-11T01:40:35.344Z","team_member_agreed_on_going_public_at":"2019-07-11T15:27:20.837Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-10T01:40:35.429Z","allow_singular_disclosure_after":-43819413.13585714,"singular_disclosure_allowed":true,"vote_count":203,"voters":["sultancad","kapytein","bluething","hunter","mashoud1122","teuvokas","spam404","base_64","lady_bug","sameerphad72","and 193 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":3801,"asset_type":"URL","asset_identifier":"https://www.tube8.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2862650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-09T21:38:34.428Z","updated_at":"2018-06-09T21:38:34.428Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874132,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T14:33:05.314Z","updated_at":"2018-06-12T14:33:05.314Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874456,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T16:41:04.224Z","updated_at":"2018-06-12T16:55:52.920Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874471,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T16:43:16.913Z","updated_at":"2018-06-12T16:50:35.904Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2874552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T17:17:54.492Z","updated_at":"2018-06-12T17:20:54.748Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2875850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-12T22:02:30.463Z","updated_at":"2018-06-12T22:02:30.463Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2885200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-14T18:58:31.882Z","updated_at":"2018-06-14T18:58:31.882Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2886293,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-14T21:34:27.835Z","updated_at":"2018-06-14T21:34:27.835Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2886581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-14T22:48:57.351Z","updated_at":"2018-06-14T23:02:30.151Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2907780,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-19T15:32:18.692Z","updated_at":"2018-06-19T15:32:18.692Z","actor":{"url":"/tube8","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/231/560f66744dedfa26f5f87d042a1caf6bef28d673_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Tube8"}},"bounty_amount":"2500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tube8","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2909100,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-19T21:21:42.604Z","updated_at":"2018-06-19T21:21:42.604Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2925793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-23T17:10:13.726Z","updated_at":"2018-06-23T17:10:13.726Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3373724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-22T22:42:26.771Z","updated_at":"2018-09-22T22:42:33.238Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4292224,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-09T19:42:21.572Z","updated_at":"2019-03-09T19:42:21.572Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5095482,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-14T15:45:10.081Z","updated_at":"2019-06-14T15:45:10.081Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5296378,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-11T01:40:35.374Z","updated_at":"2019-07-11T01:40:35.374Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5301170,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-11T15:27:20.867Z","updated_at":"2019-07-11T15:27:20.867Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5301171,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-11T15:27:20.964Z","updated_at":"2019-07-11T15:27:20.964Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5671438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T07:41:02.940Z","updated_at":"2019-08-27T07:41:02.940Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5672676,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T09:57:54.932Z","updated_at":"2019-08-27T09:57:54.932Z","additional_data":{},"actor":{"username":"cmorpheus","cleared":false,"url":"/cmorpheus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/381/e44d86a2e5e37d44b767b173e0d925e018b53d57_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tube8","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":17167,"category":"team","content":"Researcher found a blind SQL injection in the profile comment Like functionality, executing on the second request made for a given comment (dislikes).","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eResearcher found a blind SQL injection in the profile comment Like functionality, executing on the second request made for a given comment (dislikes).\u003c/p\u003e\n"},{"id":17156,"category":"researcher","content":"##Summary\nThe injection was found manually, used discovery methods are basically the same as described in this awesome article by @gerben_javado: https://gerbenjavado.com/manual-sql-injection-discovery-tips/\nThere was some kind of caching in place that hardened sqli identification (after each caching event we had to reproduce issue with different comment - it also made the injection undetectable by the scanners, because after several test requests response will be cached and couldn't be used to determine presence of sqli, so attacker needs to exploit this manually or write custom script or tamper for sqlmap).\n##POC\n```\nhttps://www.tube8.com/ajax2/likeProfileComment/?profile_id=70418291\u0026comment_id=291751-sleep(5)\u0026hash=f42ffae0449536cfd0419826f3adf136\nor\nhttps://www.tube8.com/ajax2/likeProfileComment/?profile_id=70418291\u0026comment_id=291751-benchmark(1000000000,1-1)\u0026hash=f42ffae0449536cfd0419826f3adf136\n```\nIt worked on each **second** request (so it is actually bSQLi using **dislike**, the first request was making **like** and wasn't vulnerable). Also, after each successful SQLi test, the request appeared to be cached and vulnerability could be reproduced again only with different `comment_id` for some time. As a side effect, the comment could disappear for a few minutes.\nWhy `-sleep(5)`, `-benchmark(1000000000,1-1)` payloads were used? I suspected that `comment_id` was processed as integer and was unescaped in the query so `int-sleep(t)` is a valid construction whatever the full query is, which doesn't require various quote/parenthesis tests for the quick manual confirmation. I found it also useful when WAF/filters block the quotes.\n\nThe severity was set to High because I propose Critical only for content injections:)\n\nThanks to the team for the awesome communication and the bounty!","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe injection was found manually, used discovery methods are basically the same as described in this awesome article by \u003ca href=\"/gerben_javado\"\u003e@gerben_javado\u003c/a\u003e: \u003ca title=\"https://gerbenjavado.com/manual-sql-injection-discovery-tips/\" href=\"/redirect?url=https%3A%2F%2Fgerbenjavado.com%2Fmanual-sql-injection-discovery-tips%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gerbenjavado.com/manual-sql-injection-discovery-tips/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThere was some kind of caching in place that hardened sqli identification (after each caching event we had to reproduce issue with different comment - it also made the injection undetectable by the scanners, because after several test requests response will be cached and couldn\u0026#39;t be used to determine presence of sqli, so attacker needs to exploit this manually or write custom script or tamper for sqlmap).\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://www.tube8.com/ajax2/likeProfileComment/?profile_id=70418291\u0026amp;comment_id=291751-sleep(5)\u0026amp;hash=f42ffae0449536cfd0419826f3adf136\nor\nhttps://www.tube8.com/ajax2/likeProfileComment/?profile_id=70418291\u0026amp;comment_id=291751-benchmark(1000000000,1-1)\u0026amp;hash=f42ffae0449536cfd0419826f3adf136\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt worked on each \u003cstrong\u003esecond\u003c/strong\u003e request (so it is actually bSQLi using \u003cstrong\u003edislike\u003c/strong\u003e, the first request was making \u003cstrong\u003elike\u003c/strong\u003e and wasn\u0026#39;t vulnerable). Also, after each successful SQLi test, the request appeared to be cached and vulnerability could be reproduced again only with different \u003ccode\u003ecomment_id\u003c/code\u003e for some time. As a side effect, the comment could disappear for a few minutes.\u003cbr\u003e\nWhy \u003ccode\u003e-sleep(5)\u003c/code\u003e, \u003ccode\u003e-benchmark(1000000000,1-1)\u003c/code\u003e payloads were used? I suspected that \u003ccode\u003ecomment_id\u003c/code\u003e was processed as integer and was unescaped in the query so \u003ccode\u003eint-sleep(t)\u003c/code\u003e is a valid construction whatever the full query is, which doesn\u0026#39;t require various quote/parenthesis tests for the quick manual confirmation. I found it also useful when WAF/filters block the quotes.\u003c/p\u003e\n\n\u003cp\u003eThe severity was set to High because I propose Critical only for content injections:)\u003c/p\u003e\n\n\u003cp\u003eThanks to the team for the awesome communication and the bounty!\u003c/p\u003e\n"}]}