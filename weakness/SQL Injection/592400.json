{"id":592400,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTI0MDA=","url":"https://hackerone.com/reports/592400","title":"Blind SQLi leading to RCE, from Unauthenticated access to a test API Webservice","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-05-29T18:28:22.745Z","submitted_at":"2019-05-29T18:28:22.745Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geek_jeremy","url":"/geek_jeremy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-07-22T23:24:57.091Z","bug_reporter_agreed_on_going_public_at":"2019-06-25T00:37:54.738Z","team_member_agreed_on_going_public_at":"2019-07-22T23:24:56.948Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-07-25T00:37:54.878Z","allow_singular_disclosure_after":-45208256.754612595,"singular_disclosure_allowed":true,"vote_count":213,"voters":["sustenance","jarom","sp1d3rs","sultancad","secator","mashoud1122","bl4de","spam404","base_64","yashrs","and 203 more..."],"severity":{"rating":"critical","score":9.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":{"databaseId":12995,"asset_type":"OTHER","asset_identifier":"Other assets","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4952937,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T09:04:13.242Z","updated_at":"2019-05-30T09:04:13.242Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4952955,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T09:06:00.925Z","updated_at":"2019-05-30T09:06:00.925Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4953579,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T09:59:42.307Z","updated_at":"2019-05-30T09:59:42.307Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4953701,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T10:44:00.559Z","updated_at":"2019-05-30T10:44:00.559Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4953712,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T10:48:40.001Z","updated_at":"2019-05-30T10:48:40.001Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"old_scope":"www.starbucks.com.cn","new_scope":"Other assets","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4953873,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T11:42:09.011Z","updated_at":"2019-05-30T11:42:09.011Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4954641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T14:24:31.733Z","updated_at":"2019-05-30T14:24:31.733Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4954680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T14:34:17.248Z","updated_at":"2019-05-30T14:34:17.248Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4957321,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T22:49:33.678Z","updated_at":"2019-05-30T22:49:33.678Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4957329,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-30T22:51:28.126Z","updated_at":"2019-05-30T22:51:28.126Z","additional_data":{},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4957909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-31T03:22:07.323Z","updated_at":"2019-05-31T03:22:07.323Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4965252,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-01T08:22:33.693Z","updated_at":"2019-06-01T08:22:33.693Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4965825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-01T11:16:34.568Z","updated_at":"2019-06-01T11:16:34.568Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4970536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-03T01:15:31.979Z","updated_at":"2019-06-03T01:15:31.979Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4984470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-03T18:53:08.820Z","updated_at":"2019-06-03T18:53:08.820Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4989806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-04T03:50:27.835Z","updated_at":"2019-06-04T03:50:27.835Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5085411,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-13T20:14:59.619Z","updated_at":"2019-06-13T20:14:59.619Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"4000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"geek_jeremy","url":"/geek_jeremy"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5088058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-14T02:41:08.914Z","updated_at":"2019-06-14T02:41:08.914Z","actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5179758,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-24T16:04:13.933Z","updated_at":"2019-06-24T16:04:13.933Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"geek_jeremy","url":"/geek_jeremy"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5185000,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-25T00:37:54.783Z","updated_at":"2019-06-25T00:37:54.783Z","first_to_agree":true,"actor":{"username":"geek_jeremy","cleared":false,"url":"/geek_jeremy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/BSowC8js7eN6Q66cyqMVedfa/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5192387,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-25T16:19:09.951Z","updated_at":"2019-06-25T16:19:09.951Z","additional_data":{},"actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5392418,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-22T23:24:56.987Z","updated_at":"2019-07-22T23:24:56.987Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5392419,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-22T23:24:57.115Z","updated_at":"2019-07-22T23:24:57.115Z","actor":{"username":"tealeaf","cleared":false,"url":"/tealeaf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/288/393/1ac76d5540516a68330a902a1d125dbebfdc2258_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":17409,"category":"team","content":"@geek_jeremy, at the same time as other hackers who submitted their own reports, discovered a browsable WSDL service on an API endpoint under the starbucks.com.cn domain, running on a non-standard port.\n@geek_jeremy demonstrated that the service had several functions that executed without any authentication at all, allowing the listing of users, passwords and other personal information. Fortunately, this was a test service, executing on test data, and as a result, this alone did not constitute a vulnerability worth rewarding.\n@geek_jeremy also demonstrated that the service had at least one blind SQLi vulnerability, allowing him to not only access the database behind the service, but also to execute commands through the xp_cmdshell function. The \"ping\" command was used to demonstrate this safely without causing bad effects to the service. Because this was a Remote Code Execution (RCE) on a production server, even though it was reached through a test instance, this was awarded as a Critical vulnerability.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/geek_jeremy\"\u003e@geek_jeremy\u003c/a\u003e, at the same time as other hackers who submitted their own reports, discovered a browsable WSDL service on an API endpoint under the starbucks.com.cn domain, running on a non-standard port.\u003cbr\u003e\n\u003ca href=\"/geek_jeremy\"\u003e@geek_jeremy\u003c/a\u003e demonstrated that the service had several functions that executed without any authentication at all, allowing the listing of users, passwords and other personal information. Fortunately, this was a test service, executing on test data, and as a result, this alone did not constitute a vulnerability worth rewarding.\u003cbr\u003e\n\u003ca href=\"/geek_jeremy\"\u003e@geek_jeremy\u003c/a\u003e also demonstrated that the service had at least one blind SQLi vulnerability, allowing him to not only access the database behind the service, but also to execute commands through the xp_cmdshell function. The \u0026quot;ping\u0026quot; command was used to demonstrate this safely without causing bad effects to the service. Because this was a Remote Code Execution (RCE) on a production server, even though it was reached through a test instance, this was awarded as a Critical vulnerability.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}