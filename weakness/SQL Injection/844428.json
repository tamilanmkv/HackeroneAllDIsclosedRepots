{"id":844428,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NDQ0Mjg=","url":"https://hackerone.com/reports/844428","title":"[www.zomato.com] Abusing LocalParams (city) to Inject SOLR query","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-04-09T18:33:10.236Z","submitted_at":"2020-04-09T18:33:10.236Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zzzhacker13","url":"/zzzhacker13","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-10T13:23:11.806Z","bug_reporter_agreed_on_going_public_at":"2020-08-10T13:15:14.719Z","team_member_agreed_on_going_public_at":"2020-08-10T13:23:11.649Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Hi Team! ;)\n\nI Found an **limited** ``SOLR Injection`` by Abusing LocalParams (``city``) in ``/webapi/searchapi.php``, **Therefore Please respect my decision to mark this report as** ``Medium`` **instead of** ``High`` **(Based on the fact the code is Vulnerable even if it's hard to exploit).**\n\n- Request (adding single Backslash):\n\n```http\nGET /webapi/searchapi.php?city=51\\ HTTP/1.1\nHost: www.zomato.com\nConnection: close\nAccept: application/json\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/80.0.3987.149 Safari/537.36\nAccept-Encoding: gzip, deflate\nAccept-Language: en\n```\n\n- Response:\n\n```http\nHTTP/1.1 500 Internal Server Error\n```\n- Request (adding double Backslashes):\n\n```http\nGET /webapi/searchapi.php?city=51\\\\ HTTP/1.1\nHost: www.zomato.com\nConnection: close\nAccept: application/json\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/80.0.3987.149 Safari/537.36\nAccept-Encoding: gzip, deflate\nAccept-Language: en\n```\n\n- Response:\n\n```http\nHTTP/1.1 200 OK\n```\n\n**As you can see - adding single Backslash** ``\\`` **will break the SOLR query but by adding double Backslashes** ``\\\\`` **(closing it) will execute the SOLR query properly, Therefore this isn't an \"Exception\" - it's a valid SOLR Injection!!**\n\n- Source: **https://portswigger.net/research/backslash-powered-scanning-hunting-unknown-vulnerability-classes**\n\n## Impact\n\n**\"By exploiting 'Solr (local) Parameters Injection,' it is possible to at least modify or view all the data within the Solr cluster, or even exploit known vulnerabilities to achieve remote code execution.\"**\n\n- Source: **\"https://www.veracode.com/blog/security-news/new-research-apache-solr-parameter-injection\"**","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["rahulkadavil_","ms-13","dastan_9408","sa1tama0","zzzhacker13","ahak","v13rsba","null_type","vallikkv"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7600886,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-04-09T18:34:43.614Z","updated_at":"2020-04-09T18:34:43.614Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":686550,"new_severity_id":686551},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7600911,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @zzzhacker13 - Thanks for your submission.\n\nAs per the current prevention measures in place, this doesn't seems to be exploitable. In case you're able to demonstrate an exploit, we would be happy to increase the severity and reward accordingly.\n\nPrateek","automated_response":false,"created_at":"2020-04-09T18:37:24.762Z","updated_at":"2020-04-09T18:37:24.762Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7600941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zzzhacker13 - Moreover, we're not going to fix this right away (until next 24 hours), and will give you an opportunity to showcase the impact. We will adjust the severity based on your findings.\n\nGood Luck and Happy Hacking!\n\nPrateek","automated_response":false,"created_at":"2020-04-09T18:39:48.017Z","updated_at":"2020-04-09T18:39:48.017Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7601084,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi mate @prateek_0490-zomato ;)\n\n**I'm not good enough in** ``SOLR`` **to Exploit it, anyway i really disagree from the** ``severity`` **you chosen.**\n\n- **Zomato low vulnerabilities:**\n\n```\nDirectory listings\nXSS - POST based XSS (with CSRF bypass)\nLack of HTTPS on dynamic pages (judged on a case-by-case basis)\nServer information page (no credentials)\n```\n\n**You can't compare unexploitable** ``query Injection`` **to** ``Directory listing``.\n**Anyway in case i will not get any reward, Please fix it and let me close the report myself.**\n\nThank you for the fast response,\nRegards @zzzhacker13\n","automated_response":false,"created_at":"2020-04-09T18:49:19.379Z","updated_at":"2020-04-09T18:51:06.512Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7601105,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! @prateek_0490-zomato\n## I will Try ;)","automated_response":false,"created_at":"2020-04-09T18:52:12.612Z","updated_at":"2020-04-09T18:52:12.612Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7601172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zzzhacker13 - It's always not about the Scope, there has been instances when we have gone beyond our bounty limit and rewarded max bounties to researchers for some exceptional reports.\n\nI'm just saying for this particular function, we're having enough measures in place to prevent abuse although I wouldn't say it's complete but that at least prevents the exploitation. We've even rewarded you for Solr Injection in the past, where we internally found out that it could have been abused easily even though you were not able to provide enough details in that report on the impact side.\n\n\u003e Anyway in case i will not get any reward, Please fix it and let me close the report myself.\n\nOnce we fix this, we will mark the report as resolved and you will anyways get points.\n\nBut if you're able to come up with an impact here, happy to increase the severity and reward accordingly.\n\nPrateek","automated_response":false,"created_at":"2020-04-09T19:02:28.736Z","updated_at":"2020-04-09T19:02:28.736Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7601358,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@prateek_0490-zomato **Firstly, Thank you, really :)**\n\n### Here is what we know:\n\nAfter we digging about it today looks like it's ``Blind injection`` so we can't really know if the Injection code has been executed in the ``SOLR query``.\n\n- **I think that one of them should work (I can't know for sure):**\n\n```\n/webapi/searchapi.php?city=51\\{!dismax}\n/webapi/searchapi.php?city=51\\{dismax}\n/webapi/searchapi.php?city=51\\!dismax\n/webapi/searchapi.php?city=51\\dismax\n/webapi/searchapi.php?city=51\\{!dismax\\}\n/webapi/searchapi.php?city=51\\{\\!dismax\\}\n```\n\nWhy I'm starting with ``51\\`` ? Because this part will break the ``SOLR query`` and right after it will be the Injection code ``{!dismax}``\n\n- **We can also try this (direct):**\n\n```\n/webapi/searchapi.php?city=dismax\n/webapi/searchapi.php?city=!dismax\n/webapi/searchapi.php?city={!dismax}\n```\n\nThank you again! hope you will confirm after investigate about it.\n\nKind regards, @zzzhacker13","automated_response":false,"created_at":"2020-04-09T19:23:52.278Z","updated_at":"2020-04-09T19:24:39.496Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7608013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prateek_0490-zomato ;)\n\nI Found a **new limited** ``SOLR Injection``,  by Abusing **another** LocalParams.\n\nSo instead of opening new report with **low** Severity (**and i will not get any reward again**) i was thinking to add it to the current report and you will change the Severity to **Medium\\High** (**2** ``SOLR Injection`` in a **single report!**), \n\nI really think it's fair given the fact that ``SOLR Injection`` is an **High vulnerability** and in the **current situation i will not get any reward after week of hard work..**\n\n**Anyway it's your decision mate**, hope you will appreciate my hard work ;)\n\nThank you very much, Kind regards @zzzhacker13","automated_response":false,"created_at":"2020-04-10T00:03:12.124Z","updated_at":"2020-04-10T00:03:12.124Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7677354,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Resolved?\n\n@prateek_0490-zomato ","automated_response":false,"created_at":"2020-04-15T22:21:27.261Z","updated_at":"2020-04-15T22:21:27.261Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7723526,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @zzzhacker13 - This has been fixed.\n\nPrateek","automated_response":false,"created_at":"2020-04-20T11:30:58.477Z","updated_at":"2020-04-20T11:30:58.477Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zzzhacker13","url":"/zzzhacker13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7723632,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"As per our current payout structure, this doesn't qualifies for the reward due to the low severity but we will reward you a small bonus seeing the reports you've reported in the past which will keep you interested in our program.\n\nHappy Hacking!","automated_response":false,"created_at":"2020-04-20T11:36:52.822Z","updated_at":"2020-04-20T11:36:52.822Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"zzzhacker13","url":"/zzzhacker13"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7732751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Thank you so much guys,","automated_response":false,"created_at":"2020-04-21T04:08:03.627Z","updated_at":"2020-04-21T04:08:03.627Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893662,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-10T13:15:14.735Z","updated_at":"2020-08-10T13:15:14.735Z","first_to_agree":true,"actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893783,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-10T13:23:11.709Z","updated_at":"2020-08-10T13:23:11.709Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8893784,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-08-10T13:23:11.841Z","updated_at":"2020-08-10T13:23:11.841Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}