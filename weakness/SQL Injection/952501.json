{"id":952501,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTI1MDE=","url":"https://hackerone.com/reports/952501","title":"Solr Injection in `user_id` parameter at :/v2/leaderboard_v2.json","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-08-06T12:48:16.278Z","submitted_at":"2020-08-06T12:48:16.328Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zzzhacker13","url":"/zzzhacker13","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-10T07:50:05.409Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-08-07T06:59:19.892Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":67,"name":"SQL Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":130,"voters":["zzero","jensec","xploiterr","mvc","mashoud1122","newbipath12","base_64","sameerphad72","ali","n4sty","and 120 more..."],"severity":{"rating":"critical","score":9.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8864900,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-08-06T12:48:26.693Z","updated_at":"2020-08-06T12:48:26.693Z","additional_data":{},"actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8864926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T12:50:47.804Z","updated_at":"2020-08-06T12:50:47.804Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8864936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T12:52:00.598Z","updated_at":"2020-08-06T12:52:00.598Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8865339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T13:26:28.140Z","updated_at":"2020-08-06T13:26:28.140Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8865508,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-08-06T13:42:30.208Z","updated_at":"2020-08-06T13:42:30.208Z","additional_data":{},"actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8865512,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-08-06T13:42:41.811Z","updated_at":"2020-08-06T13:42:41.811Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8867930,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-08-06T17:21:14.309Z","updated_at":"2020-08-06T17:21:14.309Z","additional_data":{},"actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8867954,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T17:23:01.269Z","updated_at":"2020-08-06T17:23:01.269Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868071,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-08-06T17:36:02.475Z","updated_at":"2020-08-06T17:36:02.475Z","actor":{"username":"bhelpuri","cleared":false,"url":"/bhelpuri","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/g3Kn3gcnRpWzd3WLm6qbE24t/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8868089,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T17:39:31.032Z","updated_at":"2020-08-06T17:39:31.032Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868116,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-08-06T17:42:59.410Z","updated_at":"2020-08-06T17:42:59.410Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Zomato"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"zzzhacker13","url":"/zzzhacker13"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8868149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-06T17:46:36.425Z","updated_at":"2020-08-06T17:46:36.425Z","actor":{"username":"zzzhacker13","cleared":false,"url":"/zzzhacker13","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/EDKodYArUp4pWfyihgQX3RCw/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871716,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2020-08-07T06:41:54.609Z","updated_at":"2020-08-07T06:41:54.609Z","additional_data":{},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871801,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-08-07T06:58:27.686Z","updated_at":"2020-08-07T06:58:27.686Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zzzhacker13","url":"/zzzhacker13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8871806,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-08-07T06:59:19.911Z","updated_at":"2020-08-07T06:59:19.911Z","first_to_agree":true,"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8890708,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2020-08-10T07:50:05.336Z","updated_at":"2020-08-10T07:50:05.336Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":23937,"category":"team","content":"@zzzhacker13 identified a Solr Injection on the `user_id` parameter at `:/v2/leaderboard_v2.json`. Our team analyzed internally and found that only `fq={injection}` was possible on the `Solr` endpoint, hence the `Solr injection` was of low impact since there was no way to escalate it to exfiltrate data, one could have just changed the filter query but it wasn't possible to update the fields or anything with these methods.\n\nAfter the report from @zzzhacker13, the team started analyzing the endpoint and discovered an `SQLi` (boolean based blind SQLi) on another parameter in the same codebase. We went ahead and fixed the issue. The `SQL injection`, however, was critical as per our internal metrics, hence we considered this to be critical because it was discovered as an indirect effect of this report and rewarded the max bounty as per our policies.\n\n|  Action | Timeline (6 Aug, 2020)  |\n|---|---|\n|  Reported |  18:18 IST  |  \n|  Investigation started | 18:23 IST   |  \n|  Report validated |   18:30 IST  |\n|  Initial contact |   18:56 IST  |\n|  SQLi identified (internally) |    19:08 IST  |\n|  Triaged |   19:12 IST   |\n| Patch PR released and merged |   19:40 IST  |\n|  Patch deployed |   22:00 IST  |\n|  Severity updated |   22:51 IST  |\n|  Rewarded |   23:12 IST  |\n\nThanks,\nZomato Security Team","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":250599,"username":"prateek_0490-zomato","name":"Prateek Tiwari","bio":"","cleared":false,"website":null,"location":"","created_at":"2018-03-13T12:07:13.776Z","url":"https://hackerone.com/prateek_0490-zomato","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}