{"id":1018568,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDE4NTY4","url":"https://hackerone.com/reports/1018568","title":"Server Side Request Forgery in 'Jabber settings' in Admin Control Panel","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-10-26T02:08:22.155Z","submitted_at":"2020-10-26T02:08:22.204Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"they","url":"/they","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8936,"url":"https://hackerone.com/phpbb","handle":"phpbb","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/qv48zkf423avl8lwrpzkjsh87o74/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c?response-content-disposition=inline%3B%20filename%3D%22176697.png%22%3B%20filename%2A%3DUTF-8%27%27176697.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=130edcf5109edeee6c3e80dee1478ec068d1818b89365f32eb242baa2eaf34bb","medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/qv48zkf423avl8lwrpzkjsh87o74/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c?response-content-disposition=inline%3B%20filename%3D%22176697.png%22%3B%20filename%2A%3DUTF-8%27%27176697.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1d8af2bf6323da369b214c90d54e9ce8e6ef6d7d411e1fef22a800f3bf77bfb8"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"phpBB","twitter_handle":"phpbb","website":"https://www.phpbb.com","about":"phpBB is the world's most popular free and open source forum software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-20T17:04:13.089Z","bug_reporter_agreed_on_going_public_at":"2020-12-10T23:13:54.164Z","team_member_agreed_on_going_public_at":"2020-12-20T17:04:13.006Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Overview\nThe 'Jabber settings' panel inside the Administrator Control Panel can be used to access resources that would otherwise only be accessible by the host machine, including resources/services hosted on the `localhost` interface. This can be performed by setting the 'jabber server' parameter to the desired IP address, such as `127.0.0.1` and the port to the desired port. In some cases, service type/version numbers can be gathered as well as this information is printed to screen.\n\n## How to trigger\nSet 'jabber server' to 127.0.0.1\nSet 'Jabber port' to whatever port you want to check.\nCheck the 'Enabled' radio button\nClick submit\n\nIf the port is closed, you will see a socket error message 'Connection refused' error like this:\n{F1051582}\n\nSome such as mysqld simply return:\n\u003e Could not authorize on Jabber server.\n\n## Example Recording\nI have hosted an internal sshd service on `127.0.0.1:2222` to demonstrate that software type and version information is returned to the Administrator Control Panel. I am `ssh`'d into `phpbb-ubuntu`, which is running the aforementioned sshd service in debug mode so you can see the request hit. \n{F1051590}\n\n## Setup info\nBase OS: Ubuntu 20.04.1\nphpbb Version: 3.3.1\n{F1051573}\n\n## Impact\n\nAn attacker could use this to interact with and enumerate services and resources on behalf of the host machine (including resources hosted on the `localhost` interface). This can be used to port scan and, in some cases, perform service versioning/enumeration on the `localhost` interface as well as on machines hosted on the same network as the phpbb host machine.","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1051573,"file_name":"version.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/i2EqFVEjWyrQ91iQbf1LkeJJ?response-content-disposition=attachment%3B%20filename%3D%22version.png%22%3B%20filename%2A%3DUTF-8%27%27version.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4441a3203ba30979e0cd27aa9dc311d9b82628b05cdbbb382b26d23a6464d345","file_size":61539,"type":"image/png"},{"id":1051576,"file_name":"howtotrigger.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hLTPTB5ZmmtHS6XXTPgDdqDc?response-content-disposition=attachment%3B%20filename%3D%22howtotrigger.png%22%3B%20filename%2A%3DUTF-8%27%27howtotrigger.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=def5ce2e4fec6e716326447988e63cb14908da5776d1c3955148fa0aa7b7b253","file_size":180489,"type":"image/png"},{"id":1051582,"file_name":"conn_refused.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FGevTXaM6T67pcAuew7qdqqx?response-content-disposition=attachment%3B%20filename%3D%22conn_refused.png%22%3B%20filename%2A%3DUTF-8%27%27conn_refused.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=416826e91c8f5f41e4ce714a3fa19781ad9a8efe47c5d5121abf140021a6439e","file_size":18282,"type":"image/png"},{"id":1051590,"file_name":"recording-1603676588353.webm","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Rp5vt3rpiJ8HLyBFec3VJSig?response-content-disposition=attachment%3B%20filename%3D%22recording-1603676588353.webm%22%3B%20filename%2A%3DUTF-8%27%27recording-1603676588353.webm\u0026response-content-type=video%2Fwebm\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVJI3TZP5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T131656Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHQaCXVzLXdlc3QtMiJHMEUCIDDOenL7uY4or83Q1QkoD3xFl3uQkVICTxz%2FSDsIuWn2AiEA6%2FBWebe5fWUS9x04VtqSrFyJrrJX9Wzed2z5QiFgezgqgwQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDH%2Fcd6CfZMtsGgbHGSrXAymgqTqfvaCT83Vkk5pwapbWccEe%2BTtGThweNvSHf8FWkbmUnw2%2BMW8gqDcDNfGz7tEqv52qONc53GYs0r8D4W05T9cQ0uJtgIqBt4OmGkISCOluU2WykgPIXNEjqYkmh5zHooyqwoU4aWAvfbkbpMVL9O0nweFS83%2BqHqg3OXHtztd3WIO7FAtaIQ%2BDUZpyi%2B0a6zYS63Ic2i25q%2F413QAdfE21IQe9RLjfzNve6b8NLPdujPpkD5MvBg8opZAcnhH3rst0f02RrXBCwMAlbK6eiAdI%2FzxadkB6vJ9FtNU65o45iqF45d%2BYmfZJlOFMAVeS2pbeBJdGI7Fl7Z2hiMv0eHtvGwtxj3crYZJWjN69sMxNPs09KcOtApNPAFwGOGCcmDvm1areMVntxdnNYOlBWv0Aq3wyIXZsHHz8lX9tMjmv61dmZYvcByrfDvKW9exhQBN91h%2F%2BbxVbw80KEhIU5ipL2I5om6%2B6BoUggVA6Zd8rRJTc%2Fnn4LxgieuXFRKE4YsS3SCif0QZM6U80f0hPAJ0yiZeJUwXPDeGE0VCDJ5xmoacd5KWtjrjLbalrb5cz74c83ZZVOwv00icAbZKCzCMp4PLt5n7snHsnET8g6Tc7A6HNeDDY0ZCLBjqlARSrOasljqaSB8W9wmwFFWOUexc%2FyrrCODPiZEQKPd3A4ujWW2tnvxuhmbVhX2LLKdYUWL%2BqV7PXCjSBr8z9e13VbLgHltUO2EekXZyt0zUO0YHMr%2B%2B3y2ykh6QETPea4u6xBc1fOLSy9BKwigrMcXLVPZQgcLcQ07YofmFon1WVZYXr3Y0Iu6F%2Fi5W2fPKhu6dNiq1Z9eaTAlzThXI9e%2BPtktaqIg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=83f2864bd61cb1f641ef50fd72f70b7da4ec76f4d6ff0fef0283bf563c4484d3","file_size":17506144,"type":"video/webm"}],"allow_singular_disclosure_at":"2021-01-09T23:13:54.204Z","allow_singular_disclosure_after":-23724182.332398996,"singular_disclosure_allowed":true,"vote_count":8,"voters":["prophet","bibekshah","ali","sodium_","demonia","sahil__soni","naty060911","cufflio"],"severity":{"rating":"low","score":3.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":12184,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/phpbb/phpbb","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":9630867,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for your extremely detailed report. We will examine and follow up soon.","automated_response":false,"created_at":"2020-10-26T02:56:09.018Z","updated_at":"2020-10-26T02:56:09.018Z","actor":{"username":"marshalrusty","cleared":false,"url":"/marshalrusty","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9631697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @they and thanks for your report!\n\nDo you have a suggestion on how to fix this issue, while still allowing to use this Jabber functionality? \n(on any server, either locally or remote)\n\nThanks!","automated_response":false,"created_at":"2020-10-26T07:23:45.520Z","updated_at":"2020-10-26T07:23:45.520Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9631699,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2020-10-26T07:24:03.180Z","updated_at":"2020-10-26T07:24:03.180Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9635824,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @derky,\n\nI thought about this while reporting because it is possible someone runs a jabber server on the same machine. I do think this is the edge case vs the norm, whereas I think it is much more likely someone is made an admin on a board without access to the underlying OS. So, a couple of my suggestions from that perspective:\n\nInitial thoughts are to use predefined error messages by default that don't immediately give away the service version or a definitive \"yes/no\" and allow for more descriptive messages via a `JABBER_DEBUG` config setting.\n\nAnother more thorough option would be to block `localhost` connections by default and have an `ALLOW_LIST` or similar that can be set either in `functions_jabber.php` or `config.php` where an admin with local access can add `127.0.0.1` or `localhost`. A step further would be also having a `BLOCK_LIST` that could be configured to not allow connections to specific subnets or IP's.  Would probably not be too bad to even detect a `localhost` connection attempt and return a specific error message saying:\n\u003e Localhost jabber connections must be allowed via `config.php`. Contact the server administrator for assistance.\n\nWhich would still make a fairly decent end user experience directing them towards the solution. Again, this just addresses the access control boundary that may be in place between an admin with local access vs an admin without local access.\n\nI will continue to think about it and comment with any other thoughts that I come up with...\n\nThanks for the quick replies!","automated_response":false,"created_at":"2020-10-26T13:20:55.655Z","updated_at":"2020-10-26T13:20:55.655Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9651765,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"To start with your thorough suggestion, unfortunately trying to prevent connections to localhost is incredibly hard (if not impossible) because of all the possibilities. To a name a few options that all point to 127.0.0.1:\nhttp://2130706433\nhttp://0x7f000001\nhttp://0177.0.0.01\nhttp://127.1\nhttp://localtest.me\n\nJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\n \nI do agree that we can limit the error message by only saying the connection to the Jabber server failed. To fix the access control boundary we could limit this page to only allow admins with \"founder\" permissions. So it's not possible to fix this SSRF while still allowing Jabber, but we could change this as further hardening.\n\n\n\n\n\n","automated_response":false,"created_at":"2020-10-27T18:53:18.877Z","updated_at":"2020-10-27T18:53:18.877Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9653422,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @derky,\n\nYea, I am familiar with those, and that was another thing I considered. One thing I did want to mention was the possibility of resolving the provided hostname/ip and then validating it as an ipv4 or ipv6 address. A quick suggestion I threw together is:\n\n```\n$x = gethostbyname('0x7f000001');\n$is_valid = filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) || filter_var($x, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6);\n\nif((!$is_valid) || ($x ==\"127.0.0.1\")){\n print $x.\" is not valid\";\n}else{\n  print $x.\" is valid\";\n}\n```\n\nObviously more work can be done there (I am not a PHP developer by any stretch...), but that seemed to catch those edge cases, though I know there are probably infinity of them. But, it would catch the majority of what might come your way.\n\nThanks!","automated_response":false,"created_at":"2020-10-27T21:16:58.861Z","updated_at":"2020-10-27T21:16:58.861Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9654476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eJabber functionality basically comes down to a server side request. The same actually applies for configuring an SMTP server.\n\nAlso wanted to say that I do agree with this.","automated_response":false,"created_at":"2020-10-28T01:07:34.115Z","updated_at":"2020-10-28T01:07:34.115Z","actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9697647,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your responses. We've discussed this internally and decided that we will limit the verbosity of the error messages as part of hardening.","automated_response":false,"created_at":"2020-11-01T21:51:05.512Z","updated_at":"2020-11-01T21:51:05.512Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10067902,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-12-10T22:12:39.988Z","updated_at":"2020-12-10T22:12:39.988Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10067913,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Cory,\n\nThis was fixed by limiting communication content in the following release: https://www.phpbb.com/community/viewtopic.php?f=14\u0026t=2573416\n\nThanks for your report!","automated_response":false,"created_at":"2020-12-10T22:15:17.768Z","updated_at":"2020-12-10T22:15:17.768Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"they","url":"/they"},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10068143,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome! Thanks for crediting me in the release!","automated_response":false,"created_at":"2020-12-10T23:13:54.180Z","updated_at":"2020-12-10T23:13:54.180Z","first_to_agree":true,"actor":{"username":"they","cleared":false,"url":"/they","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/616/322/bc24f5c863623aa0bf7a3fb07937278a20f803bd_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10158308,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-12-20T17:04:13.026Z","updated_at":"2020-12-20T17:04:13.026Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10158309,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-12-20T17:04:13.111Z","updated_at":"2020-12-20T17:04:13.111Z","actor":{"username":"derky","cleared":false,"url":"/derky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/907/f036459fa3c07e2220101c28c05c93f09ffb85ee_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phpbb","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}