{"id":191216,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTEyMTY=","url":"https://hackerone.com/reports/191216","title":"SSRF via git Repo by URL Abuse","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2016-12-14T19:59:53.158Z","submitted_at":"2016-12-14T19:59:53.158Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pwnisher","url":"/pwnisher","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/834/cb8dfbf20e924397f137df7bae89c1fd7160903c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-28T18:11:33.802Z","bug_reporter_agreed_on_going_public_at":"2017-11-28T08:13:49.782Z","team_member_agreed_on_going_public_at":"2017-11-28T18:11:33.568Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi team ,\n\nFirst things first, awesome work with \u003c3 Gitlab \n\n######Description :\nWhen creating a repository there is an option to pull existing repo from github by providing your github repos url endpoint, then a request is made to that url endpoint to fetch data and create repo on github fair enough till here. But the issue i wanna address here is that you are **not validating that the URL provided by user** this lets any malicious user request any arbitrary url on the internet and use gitlabs server to connect back to him.\n\n######Steps to Reproduce : \n\n1. Create a repo\n2. Click on git repo by url option \n3. Enter url of your public server and create a repo\n4. Now if you access your servers access logs you will find \n\n``` http\n 40.84.0.225 - - [14/Dec/2016 11:36:33] \"GET /info/refs?service=git-upload-pack HTTP/1.1\" 404 - \n```  \nWhich is requested by gitlab when creating the repo.\n\n######POC:\n\n\u003e\u003eAs a poc i simply port forwarded port  **4444** on my router and started simple HTTP server and listened on 4444 to check for incoming connections, by doing the steps mentioned above i got a GET request from **40.84.0.225**  , images for the same are attached for reference.\n\n\n######Impact:\n\nSuccessful attack on this issue can lead to the following:\n\n* Port scan intranet and external Internet facing servers\n* Fingerprint internal (non-Internet exposed) network aware services\n* Perform banner grabbing\n* Run code on reachable machines\n* Enumerate and attack services that are running on these hosts\n\nAlthough i have not tested for any of these yet, this issue can still be misused to use this endpoint to initiate port scans or dos on other servers on the internet, as the hits will be going from your endpoint.\n\n\n**Cheers!** \n####*Siddhu*","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":143574,"file_name":"1.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/143/574/e3062e9d32836238b2a73161247250bc5d8d53aa/1.PNG?response-content-disposition=attachment%3B%20filename%3D%221.PNG%22%3B%20filename%2A%3DUTF-8%27%271.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135740Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6c42f88af8dd28dcdfa9e96445a46f709a44c3c76a910f97b6db3ab5287c524c","file_size":38336,"type":"image/png"},{"id":143575,"file_name":"2.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/143/575/7087b6d0619ff536adae0085e57bcdd8a13c9b10/2.PNG?response-content-disposition=attachment%3B%20filename%3D%222.PNG%22%3B%20filename%2A%3DUTF-8%27%272.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37UF4D7L%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T135740Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDcM3lUhy%2FyutAdh7f9Zl5mn2Zda9VBqjjsjW3Kqrv9QwIgUJ2GHCBNkuHHHes2KRvisdQVMMh95CwiTU1b1a8oiokqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHKDnseTm0Y%2FhEGv3yrXA%2FXiDUmXXuSyACHOE8HgYRKJ853f1jlwT5AZyK%2Bn5Rt9XrHAopi0fcxoVA3YLQiUzIRWerqTfQlxKYwQmwbXGaNCwOPcuqFnbA0BdiKSoxDZE9%2BAkspI1mhMQLJ5wo08jfzFr75Qd1ChW9WiheW%2FVktOteHAt9aVxqi8Jvt13Vf4hmtjfTIpZbkNbUwjNFSoAAwBiHX%2BPEoNCL2q146kWmH7JQAs46LWWfXpHtaLM0X3j2%2F6OQqcpbbmgNP0iT6G9a5CgaIGBxJLuLkH61YbKPWXwaC8TDE%2FcU3kcKLfZT6PzgvqrUkbtY5Kq12QUSQPRc2p%2F86btY7j%2BbuW2LsLo%2BL8HwPZQqX0Iwg4kPN1oiWkCvCy4C8hJ68%2FJ8V55%2FQGsfNluyoo9N2h%2FImpLRFogGkjCwXw%2FgUm6fVgz6E210lLzFwkpnwSJZD%2FmcaRmUjl0tSuVxctc0XFzksnocu0a7yIDYpb5K7QrxkzD9IKguldIb6P28mU%2Fl%2BNGbXsLagjza5LYY9EpOydfi%2FbJ8psqdp5cmRFbVoWgz8FXZfOtIY%2FL3SbVyc%2FP82wug%2BNvDZV%2F2QhkY%2F5Fq39DFzTJIx0r5IdBfCunO3HvICfVBNCYCOfN%2FEieFXqKzCx75CLBjqlAcuPL4Bcyw7zjajAhspfsc9g22ftBZvRbPtEOifPINRBbT8HbfsijeCJ%2FT7%2BiuoRxWH6OAFtoz80KZDnQALizDt0DzDKgU%2BjEVmWT15an6I5BVjXF4imwZ56XB97AG2TQY%2BkX%2BOj43cXPZZUP6Xqk6lMktc4Sg6T1MBZFmFR8tg4anCMnG6QFQm48IyEtEycWqfvTMqOwqddlUOWnUeoAp%2FGIOm9YQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=773374690ef0de7a34d2c862c756edf55fec9a151a7aa2d071d156edfe8fc644","file_size":8381,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["eveeez","sa1tama0"],"severity":{"rating":"medium","score":6.6,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1365064,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @intercept9, thanks for the report.\n\nWe have an open issue for this problem already: #135937. To be honest, it's not an easy problem to solve given the way GitLab imports projects. We hope to have a patch out very soon.","automated_response":false,"created_at":"2016-12-14T20:30:28.265Z","updated_at":"2016-12-14T20:30:28.265Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1365099,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i was thinking a regex check for https://github.com as a starting would be sufficient , i want to know how you guys gonna patch this , anyways thanks a lot for replaying back soon, will come back with better bugs soon  :)\n\nWith love on Gitlab  ","automated_response":false,"created_at":"2016-12-14T20:49:52.666Z","updated_at":"2016-12-14T20:49:52.666Z","actor":{"username":"pwnisher","cleared":false,"url":"/pwnisher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/834/cb8dfbf20e924397f137df7bae89c1fd7160903c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1365304,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You're right that that would probably work for GitHub imports. We're working on a patch for all other types of imports as well.\n\nHappy Hunting!","automated_response":false,"created_at":"2016-12-14T22:36:33.855Z","updated_at":"2016-12-14T22:36:33.855Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2185843,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-28T08:13:49.809Z","updated_at":"2017-11-28T08:13:49.809Z","first_to_agree":true,"actor":{"username":"pwnisher","cleared":false,"url":"/pwnisher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/834/cb8dfbf20e924397f137df7bae89c1fd7160903c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187179,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-28T18:11:33.595Z","updated_at":"2017-11-28T18:11:33.595Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187180,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-28T18:11:33.830Z","updated_at":"2017-11-28T18:11:33.830Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}